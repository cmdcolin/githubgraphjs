var yF=e=>{throw TypeError(e)};var hq=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var jx=(e,t,n)=>t.has(e)||yF("Cannot "+n);var ce=(e,t,n)=>(jx(e,t,"read from private field"),n?n.call(e):t.get(e)),Os=(e,t,n)=>t.has(e)?yF("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),an=(e,t,n,r)=>(jx(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),rt=(e,t,n)=>(jx(e,t,"access private method"),n);var Ux=(e,t,n,r)=>({set _(i){an(e,t,i,n)},get _(){return ce(e,t,r)}});var E_e=hq((uke,fF)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function yy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var nD={exports:{}},vy={},rD={exports:{}},Ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kp=Symbol.for("react.element"),pq=Symbol.for("react.portal"),gq=Symbol.for("react.fragment"),mq=Symbol.for("react.strict_mode"),yq=Symbol.for("react.profiler"),vq=Symbol.for("react.provider"),xq=Symbol.for("react.context"),wq=Symbol.for("react.forward_ref"),bq=Symbol.for("react.suspense"),Eq=Symbol.for("react.memo"),Sq=Symbol.for("react.lazy"),vF=Symbol.iterator;function _q(e){return e===null||typeof e!="object"?null:(e=vF&&e[vF]||e["@@iterator"],typeof e=="function"?e:null)}var iD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},oD=Object.assign,sD={};function _f(e,t,n){this.props=e,this.context=t,this.refs=sD,this.updater=n||iD}_f.prototype.isReactComponent={};_f.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_f.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function aD(){}aD.prototype=_f.prototype;function r_(e,t,n){this.props=e,this.context=t,this.refs=sD,this.updater=n||iD}var i_=r_.prototype=new aD;i_.constructor=r_;oD(i_,_f.prototype);i_.isPureReactComponent=!0;var xF=Array.isArray,uD=Object.prototype.hasOwnProperty,o_={current:null},lD={key:!0,ref:!0,__self:!0,__source:!0};function cD(e,t,n){var r,i={},o=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)uD.call(t,r)&&!lD.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var u=Array(a),l=0;l<a;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:kp,type:e,key:o,ref:s,props:i,_owner:o_.current}}function kq(e,t){return{$$typeof:kp,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function s_(e){return typeof e=="object"&&e!==null&&e.$$typeof===kp}function $q(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var wF=/\/+/g;function Wx(e,t){return typeof e=="object"&&e!==null&&e.key!=null?$q(""+e.key):t.toString(36)}function Am(e,t,n,r,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case kp:case pq:s=!0}}if(s)return s=e,i=i(s),e=r===""?"."+Wx(s,0):r,xF(i)?(n="",e!=null&&(n=e.replace(wF,"$&/")+"/"),Am(i,t,n,"",function(l){return l})):i!=null&&(s_(i)&&(i=kq(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(wF,"$&/")+"/")+e)),t.push(i)),1;if(s=0,r=r===""?".":r+":",xF(e))for(var a=0;a<e.length;a++){o=e[a];var u=r+Wx(o,a);s+=Am(o,t,n,u,i)}else if(u=_q(e),typeof u=="function")for(e=u.call(e),a=0;!(o=e.next()).done;)o=o.value,u=r+Wx(o,a++),s+=Am(o,t,n,u,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function Sg(e,t,n){if(e==null)return e;var r=[],i=0;return Am(e,r,"","",function(o){return t.call(n,o,i++)}),r}function Cq(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var qn={current:null},Fm={transition:null},Aq={ReactCurrentDispatcher:qn,ReactCurrentBatchConfig:Fm,ReactCurrentOwner:o_};function fD(){throw Error("act(...) is not supported in production builds of React.")}Ee.Children={map:Sg,forEach:function(e,t,n){Sg(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Sg(e,function(){t++}),t},toArray:function(e){return Sg(e,function(t){return t})||[]},only:function(e){if(!s_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ee.Component=_f;Ee.Fragment=gq;Ee.Profiler=yq;Ee.PureComponent=r_;Ee.StrictMode=mq;Ee.Suspense=bq;Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Aq;Ee.act=fD;Ee.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=oD({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=o_.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(u in t)uD.call(t,u)&&!lD.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&a!==void 0?a[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){a=Array(u);for(var l=0;l<u;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:kp,type:e.type,key:i,ref:o,props:r,_owner:s}};Ee.createContext=function(e){return e={$$typeof:xq,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:vq,_context:e},e.Consumer=e};Ee.createElement=cD;Ee.createFactory=function(e){var t=cD.bind(null,e);return t.type=e,t};Ee.createRef=function(){return{current:null}};Ee.forwardRef=function(e){return{$$typeof:wq,render:e}};Ee.isValidElement=s_;Ee.lazy=function(e){return{$$typeof:Sq,_payload:{_status:-1,_result:e},_init:Cq}};Ee.memo=function(e,t){return{$$typeof:Eq,type:e,compare:t===void 0?null:t}};Ee.startTransition=function(e){var t=Fm.transition;Fm.transition={};try{e()}finally{Fm.transition=t}};Ee.unstable_act=fD;Ee.useCallback=function(e,t){return qn.current.useCallback(e,t)};Ee.useContext=function(e){return qn.current.useContext(e)};Ee.useDebugValue=function(){};Ee.useDeferredValue=function(e){return qn.current.useDeferredValue(e)};Ee.useEffect=function(e,t){return qn.current.useEffect(e,t)};Ee.useId=function(){return qn.current.useId()};Ee.useImperativeHandle=function(e,t,n){return qn.current.useImperativeHandle(e,t,n)};Ee.useInsertionEffect=function(e,t){return qn.current.useInsertionEffect(e,t)};Ee.useLayoutEffect=function(e,t){return qn.current.useLayoutEffect(e,t)};Ee.useMemo=function(e,t){return qn.current.useMemo(e,t)};Ee.useReducer=function(e,t,n){return qn.current.useReducer(e,t,n)};Ee.useRef=function(e){return qn.current.useRef(e)};Ee.useState=function(e){return qn.current.useState(e)};Ee.useSyncExternalStore=function(e,t,n){return qn.current.useSyncExternalStore(e,t,n)};Ee.useTransition=function(){return qn.current.useTransition()};Ee.version="18.3.1";rD.exports=Ee;var Qn=rD.exports;const ua=yy(Qn);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fq=Qn,Mq=Symbol.for("react.element"),Tq=Symbol.for("react.fragment"),Nq=Object.prototype.hasOwnProperty,Oq=Fq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Rq={key:!0,ref:!0,__self:!0,__source:!0};function dD(e,t,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)Nq.call(t,r)&&!Rq.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:Mq,type:e,key:o,ref:s,props:i,_owner:Oq.current}}vy.Fragment=Tq;vy.jsx=dD;vy.jsxs=dD;nD.exports=vy;var Se=nD.exports,Uw={},hD={exports:{}},Or={},pD={exports:{}},gD={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(T,O){var j=T.length;T.push(O);e:for(;0<j;){var X=j-1>>>1,re=T[X];if(0<i(re,O))T[X]=O,T[j]=re,j=X;else break e}}function n(T){return T.length===0?null:T[0]}function r(T){if(T.length===0)return null;var O=T[0],j=T.pop();if(j!==O){T[0]=j;e:for(var X=0,re=T.length,we=re>>>1;X<we;){var he=2*(X+1)-1,Re=T[he],Nt=he+1,Dr=T[Nt];if(0>i(Re,j))Nt<re&&0>i(Dr,Re)?(T[X]=Dr,T[Nt]=j,X=Nt):(T[X]=Re,T[he]=j,X=he);else if(Nt<re&&0>i(Dr,j))T[X]=Dr,T[Nt]=j,X=Nt;else break e}}return O}function i(T,O){var j=T.sortIndex-O.sortIndex;return j!==0?j:T.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var u=[],l=[],c=1,f=null,d=3,h=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(T){for(var O=n(l);O!==null;){if(O.callback===null)r(l);else if(O.startTime<=T)r(l),O.sortIndex=O.expirationTime,t(u,O);else break;O=n(l)}}function w(T){if(g=!1,x(T),!p)if(n(u)!==null)p=!0,N(b);else{var O=n(l);O!==null&&P(w,O.startTime-T)}}function b(T,O){p=!1,g&&(g=!1,m(_),_=-1),h=!0;var j=d;try{for(x(O),f=n(u);f!==null&&(!(f.expirationTime>O)||T&&!C());){var X=f.callback;if(typeof X=="function"){f.callback=null,d=f.priorityLevel;var re=X(f.expirationTime<=O);O=e.unstable_now(),typeof re=="function"?f.callback=re:f===n(u)&&r(u),x(O)}else r(u);f=n(u)}if(f!==null)var we=!0;else{var he=n(l);he!==null&&P(w,he.startTime-O),we=!1}return we}finally{f=null,d=j,h=!1}}var S=!1,E=null,_=-1,k=5,$=-1;function C(){return!(e.unstable_now()-$<k)}function R(){if(E!==null){var T=e.unstable_now();$=T;var O=!0;try{O=E(!0,T)}finally{O?A():(S=!1,E=null)}}else S=!1}var A;if(typeof v=="function")A=function(){v(R)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,F=M.port2;M.port1.onmessage=R,A=function(){F.postMessage(null)}}else A=function(){y(R,0)};function N(T){E=T,S||(S=!0,A())}function P(T,O){_=y(function(){T(e.unstable_now())},O)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(T){T.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,N(b))},e.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<T?Math.floor(1e3/T):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(T){switch(d){case 1:case 2:case 3:var O=3;break;default:O=d}var j=d;d=O;try{return T()}finally{d=j}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(T,O){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var j=d;d=T;try{return O()}finally{d=j}},e.unstable_scheduleCallback=function(T,O,j){var X=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?X+j:X):j=X,T){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=j+re,T={id:c++,callback:O,priorityLevel:T,startTime:j,expirationTime:re,sortIndex:-1},j>X?(T.sortIndex=j,t(l,T),n(u)===null&&T===n(l)&&(g?(m(_),_=-1):g=!0,P(w,j-X))):(T.sortIndex=re,t(u,T),p||h||(p=!0,N(b))),T},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(T){var O=d;return function(){var j=d;d=O;try{return T.apply(this,arguments)}finally{d=j}}}})(gD);pD.exports=gD;var Dq=pD.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pq=Qn,Ar=Dq;function q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mD=new Set,Mh={};function vl(e,t){Rc(e,t),Rc(e+"Capture",t)}function Rc(e,t){for(Mh[e]=t,e=0;e<t.length;e++)mD.add(t[e])}var ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ww=Object.prototype.hasOwnProperty,Lq=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bF={},EF={};function zq(e){return Ww.call(EF,e)?!0:Ww.call(bF,e)?!1:Lq.test(e)?EF[e]=!0:(bF[e]=!0,!1)}function Iq(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Bq(e,t,n,r){if(t===null||typeof t>"u"||Iq(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Hn(e,t,n,r,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var nn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){nn[e]=new Hn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];nn[t]=new Hn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){nn[e]=new Hn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){nn[e]=new Hn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){nn[e]=new Hn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){nn[e]=new Hn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){nn[e]=new Hn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){nn[e]=new Hn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){nn[e]=new Hn(e,5,!1,e.toLowerCase(),null,!1,!1)});var a_=/[\-:]([a-z])/g;function u_(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(a_,u_);nn[t]=new Hn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(a_,u_);nn[t]=new Hn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(a_,u_);nn[t]=new Hn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){nn[e]=new Hn(e,1,!1,e.toLowerCase(),null,!1,!1)});nn.xlinkHref=new Hn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){nn[e]=new Hn(e,1,!1,e.toLowerCase(),null,!0,!0)});function l_(e,t,n,r){var i=nn.hasOwnProperty(t)?nn[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Bq(t,n,i,r)&&(n=null),r||i===null?zq(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Es=Pq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_g=Symbol.for("react.element"),Jl=Symbol.for("react.portal"),ec=Symbol.for("react.fragment"),c_=Symbol.for("react.strict_mode"),qw=Symbol.for("react.profiler"),yD=Symbol.for("react.provider"),vD=Symbol.for("react.context"),f_=Symbol.for("react.forward_ref"),Hw=Symbol.for("react.suspense"),Vw=Symbol.for("react.suspense_list"),d_=Symbol.for("react.memo"),Is=Symbol.for("react.lazy"),xD=Symbol.for("react.offscreen"),SF=Symbol.iterator;function Jf(e){return e===null||typeof e!="object"?null:(e=SF&&e[SF]||e["@@iterator"],typeof e=="function"?e:null)}var ut=Object.assign,qx;function Nd(e){if(qx===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);qx=t&&t[1]||""}return`
`+qx+e}var Hx=!1;function Vx(e,t){if(!e||Hx)return"";Hx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var u=`
`+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=s&&0<=a);break}}}finally{Hx=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Nd(e):""}function jq(e){switch(e.tag){case 5:return Nd(e.type);case 16:return Nd("Lazy");case 13:return Nd("Suspense");case 19:return Nd("SuspenseList");case 0:case 2:case 15:return e=Vx(e.type,!1),e;case 11:return e=Vx(e.type.render,!1),e;case 1:return e=Vx(e.type,!0),e;default:return""}}function Gw(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ec:return"Fragment";case Jl:return"Portal";case qw:return"Profiler";case c_:return"StrictMode";case Hw:return"Suspense";case Vw:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vD:return(e.displayName||"Context")+".Consumer";case yD:return(e._context.displayName||"Context")+".Provider";case f_:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case d_:return t=e.displayName||null,t!==null?t:Gw(e.type)||"Memo";case Is:t=e._payload,e=e._init;try{return Gw(e(t))}catch{}}return null}function Uq(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gw(t);case 8:return t===c_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function wD(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Wq(e){var t=wD(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function kg(e){e._valueTracker||(e._valueTracker=Wq(e))}function bD(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=wD(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function f0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Yw(e,t){var n=t.checked;return ut({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function _F(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Sa(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ED(e,t){t=t.checked,t!=null&&l_(e,"checked",t,!1)}function Xw(e,t){ED(e,t);var n=Sa(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Qw(e,t.type,n):t.hasOwnProperty("defaultValue")&&Qw(e,t.type,Sa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function kF(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Qw(e,t,n){(t!=="number"||f0(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Od=Array.isArray;function vc(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Sa(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Kw(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(q(91));return ut({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $F(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(q(92));if(Od(n)){if(1<n.length)throw Error(q(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Sa(n)}}function SD(e,t){var n=Sa(t.value),r=Sa(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function CF(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function _D(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zw(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?_D(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var $g,kD=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for($g=$g||document.createElement("div"),$g.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=$g.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Th(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ah={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qq=["Webkit","ms","Moz","O"];Object.keys(ah).forEach(function(e){qq.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ah[t]=ah[e]})});function $D(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ah.hasOwnProperty(e)&&ah[e]?(""+t).trim():t+"px"}function CD(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=$D(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var Hq=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jw(e,t){if(t){if(Hq[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(q(62))}}function eb(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tb=null;function h_(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var nb=null,xc=null,wc=null;function AF(e){if(e=Ap(e)){if(typeof nb!="function")throw Error(q(280));var t=e.stateNode;t&&(t=Sy(t),nb(e.stateNode,e.type,t))}}function AD(e){xc?wc?wc.push(e):wc=[e]:xc=e}function FD(){if(xc){var e=xc,t=wc;if(wc=xc=null,AF(e),t)for(e=0;e<t.length;e++)AF(t[e])}}function MD(e,t){return e(t)}function TD(){}var Gx=!1;function ND(e,t,n){if(Gx)return e(t,n);Gx=!0;try{return MD(e,t,n)}finally{Gx=!1,(xc!==null||wc!==null)&&(TD(),FD())}}function Nh(e,t){var n=e.stateNode;if(n===null)return null;var r=Sy(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(q(231,t,typeof n));return n}var rb=!1;if(ps)try{var ed={};Object.defineProperty(ed,"passive",{get:function(){rb=!0}}),window.addEventListener("test",ed,ed),window.removeEventListener("test",ed,ed)}catch{rb=!1}function Vq(e,t,n,r,i,o,s,a,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var uh=!1,d0=null,h0=!1,ib=null,Gq={onError:function(e){uh=!0,d0=e}};function Yq(e,t,n,r,i,o,s,a,u){uh=!1,d0=null,Vq.apply(Gq,arguments)}function Xq(e,t,n,r,i,o,s,a,u){if(Yq.apply(this,arguments),uh){if(uh){var l=d0;uh=!1,d0=null}else throw Error(q(198));h0||(h0=!0,ib=l)}}function xl(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function OD(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function FF(e){if(xl(e)!==e)throw Error(q(188))}function Qq(e){var t=e.alternate;if(!t){if(t=xl(e),t===null)throw Error(q(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return FF(i),e;if(o===r)return FF(i),t;o=o.sibling}throw Error(q(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(q(189))}}if(n.alternate!==r)throw Error(q(190))}if(n.tag!==3)throw Error(q(188));return n.stateNode.current===n?e:t}function RD(e){return e=Qq(e),e!==null?DD(e):null}function DD(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=DD(e);if(t!==null)return t;e=e.sibling}return null}var PD=Ar.unstable_scheduleCallback,MF=Ar.unstable_cancelCallback,Kq=Ar.unstable_shouldYield,Zq=Ar.unstable_requestPaint,yt=Ar.unstable_now,Jq=Ar.unstable_getCurrentPriorityLevel,p_=Ar.unstable_ImmediatePriority,LD=Ar.unstable_UserBlockingPriority,p0=Ar.unstable_NormalPriority,eH=Ar.unstable_LowPriority,zD=Ar.unstable_IdlePriority,xy=null,co=null;function tH(e){if(co&&typeof co.onCommitFiberRoot=="function")try{co.onCommitFiberRoot(xy,e,void 0,(e.current.flags&128)===128)}catch{}}var Ai=Math.clz32?Math.clz32:iH,nH=Math.log,rH=Math.LN2;function iH(e){return e>>>=0,e===0?32:31-(nH(e)/rH|0)|0}var Cg=64,Ag=4194304;function Rd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function g0(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Rd(a):(o&=s,o!==0&&(r=Rd(o)))}else s=n&~i,s!==0?r=Rd(s):o!==0&&(r=Rd(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ai(t),i=1<<n,r|=e[n],t&=~i;return r}function oH(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sH(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-Ai(o),a=1<<s,u=i[s];u===-1?(!(a&n)||a&r)&&(i[s]=oH(a,t)):u<=t&&(e.expiredLanes|=a),o&=~a}}function ob(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ID(){var e=Cg;return Cg<<=1,!(Cg&4194240)&&(Cg=64),e}function Yx(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function $p(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ai(t),e[t]=n}function aH(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Ai(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}function g_(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ai(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Be=0;function BD(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var jD,m_,UD,WD,qD,sb=!1,Fg=[],la=null,ca=null,fa=null,Oh=new Map,Rh=new Map,Vs=[],uH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function TF(e,t){switch(e){case"focusin":case"focusout":la=null;break;case"dragenter":case"dragleave":ca=null;break;case"mouseover":case"mouseout":fa=null;break;case"pointerover":case"pointerout":Oh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rh.delete(t.pointerId)}}function td(e,t,n,r,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},t!==null&&(t=Ap(t),t!==null&&m_(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function lH(e,t,n,r,i){switch(t){case"focusin":return la=td(la,e,t,n,r,i),!0;case"dragenter":return ca=td(ca,e,t,n,r,i),!0;case"mouseover":return fa=td(fa,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Oh.set(o,td(Oh.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Rh.set(o,td(Rh.get(o)||null,e,t,n,r,i)),!0}return!1}function HD(e){var t=Cu(e.target);if(t!==null){var n=xl(t);if(n!==null){if(t=n.tag,t===13){if(t=OD(n),t!==null){e.blockedOn=t,qD(e.priority,function(){UD(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Mm(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ab(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);tb=r,n.target.dispatchEvent(r),tb=null}else return t=Ap(n),t!==null&&m_(t),e.blockedOn=n,!1;t.shift()}return!0}function NF(e,t,n){Mm(e)&&n.delete(t)}function cH(){sb=!1,la!==null&&Mm(la)&&(la=null),ca!==null&&Mm(ca)&&(ca=null),fa!==null&&Mm(fa)&&(fa=null),Oh.forEach(NF),Rh.forEach(NF)}function nd(e,t){e.blockedOn===t&&(e.blockedOn=null,sb||(sb=!0,Ar.unstable_scheduleCallback(Ar.unstable_NormalPriority,cH)))}function Dh(e){function t(i){return nd(i,e)}if(0<Fg.length){nd(Fg[0],e);for(var n=1;n<Fg.length;n++){var r=Fg[n];r.blockedOn===e&&(r.blockedOn=null)}}for(la!==null&&nd(la,e),ca!==null&&nd(ca,e),fa!==null&&nd(fa,e),Oh.forEach(t),Rh.forEach(t),n=0;n<Vs.length;n++)r=Vs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Vs.length&&(n=Vs[0],n.blockedOn===null);)HD(n),n.blockedOn===null&&Vs.shift()}var bc=Es.ReactCurrentBatchConfig,m0=!0;function fH(e,t,n,r){var i=Be,o=bc.transition;bc.transition=null;try{Be=1,y_(e,t,n,r)}finally{Be=i,bc.transition=o}}function dH(e,t,n,r){var i=Be,o=bc.transition;bc.transition=null;try{Be=4,y_(e,t,n,r)}finally{Be=i,bc.transition=o}}function y_(e,t,n,r){if(m0){var i=ab(e,t,n,r);if(i===null)i2(e,t,r,y0,n),TF(e,r);else if(lH(i,e,t,n,r))r.stopPropagation();else if(TF(e,r),t&4&&-1<uH.indexOf(e)){for(;i!==null;){var o=Ap(i);if(o!==null&&jD(o),o=ab(e,t,n,r),o===null&&i2(e,t,r,y0,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else i2(e,t,r,null,n)}}var y0=null;function ab(e,t,n,r){if(y0=null,e=h_(r),e=Cu(e),e!==null)if(t=xl(e),t===null)e=null;else if(n=t.tag,n===13){if(e=OD(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return y0=e,null}function VD(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Jq()){case p_:return 1;case LD:return 4;case p0:case eH:return 16;case zD:return 536870912;default:return 16}default:return 16}}var Ks=null,v_=null,Tm=null;function GD(){if(Tm)return Tm;var e,t=v_,n=t.length,r,i="value"in Ks?Ks.value:Ks.textContent,o=i.length;for(e=0;e<n&&t[e]===i[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===i[o-r];r++);return Tm=i.slice(e,1<r?1-r:void 0)}function Nm(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Mg(){return!0}function OF(){return!1}function Rr(e){function t(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Mg:OF,this.isPropagationStopped=OF,this}return ut(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Mg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Mg)},persist:function(){},isPersistent:Mg}),t}var kf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},x_=Rr(kf),Cp=ut({},kf,{view:0,detail:0}),hH=Rr(Cp),Xx,Qx,rd,wy=ut({},Cp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:w_,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==rd&&(rd&&e.type==="mousemove"?(Xx=e.screenX-rd.screenX,Qx=e.screenY-rd.screenY):Qx=Xx=0,rd=e),Xx)},movementY:function(e){return"movementY"in e?e.movementY:Qx}}),RF=Rr(wy),pH=ut({},wy,{dataTransfer:0}),gH=Rr(pH),mH=ut({},Cp,{relatedTarget:0}),Kx=Rr(mH),yH=ut({},kf,{animationName:0,elapsedTime:0,pseudoElement:0}),vH=Rr(yH),xH=ut({},kf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wH=Rr(xH),bH=ut({},kf,{data:0}),DF=Rr(bH),EH={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},SH={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_H={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kH(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_H[e])?!!t[e]:!1}function w_(){return kH}var $H=ut({},Cp,{key:function(e){if(e.key){var t=EH[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Nm(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?SH[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:w_,charCode:function(e){return e.type==="keypress"?Nm(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Nm(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),CH=Rr($H),AH=ut({},wy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),PF=Rr(AH),FH=ut({},Cp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:w_}),MH=Rr(FH),TH=ut({},kf,{propertyName:0,elapsedTime:0,pseudoElement:0}),NH=Rr(TH),OH=ut({},wy,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),RH=Rr(OH),DH=[9,13,27,32],b_=ps&&"CompositionEvent"in window,lh=null;ps&&"documentMode"in document&&(lh=document.documentMode);var PH=ps&&"TextEvent"in window&&!lh,YD=ps&&(!b_||lh&&8<lh&&11>=lh),LF=" ",zF=!1;function XD(e,t){switch(e){case"keyup":return DH.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function QD(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var tc=!1;function LH(e,t){switch(e){case"compositionend":return QD(t);case"keypress":return t.which!==32?null:(zF=!0,LF);case"textInput":return e=t.data,e===LF&&zF?null:e;default:return null}}function zH(e,t){if(tc)return e==="compositionend"||!b_&&XD(e,t)?(e=GD(),Tm=v_=Ks=null,tc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return YD&&t.locale!=="ko"?null:t.data;default:return null}}var IH={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function IF(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!IH[e.type]:t==="textarea"}function KD(e,t,n,r){AD(r),t=v0(t,"onChange"),0<t.length&&(n=new x_("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ch=null,Ph=null;function BH(e){u4(e,0)}function by(e){var t=ic(e);if(bD(t))return e}function jH(e,t){if(e==="change")return t}var ZD=!1;if(ps){var Zx;if(ps){var Jx="oninput"in document;if(!Jx){var BF=document.createElement("div");BF.setAttribute("oninput","return;"),Jx=typeof BF.oninput=="function"}Zx=Jx}else Zx=!1;ZD=Zx&&(!document.documentMode||9<document.documentMode)}function jF(){ch&&(ch.detachEvent("onpropertychange",JD),Ph=ch=null)}function JD(e){if(e.propertyName==="value"&&by(Ph)){var t=[];KD(t,Ph,e,h_(e)),ND(BH,t)}}function UH(e,t,n){e==="focusin"?(jF(),ch=t,Ph=n,ch.attachEvent("onpropertychange",JD)):e==="focusout"&&jF()}function WH(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return by(Ph)}function qH(e,t){if(e==="click")return by(t)}function HH(e,t){if(e==="input"||e==="change")return by(t)}function VH(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ni=typeof Object.is=="function"?Object.is:VH;function Lh(e,t){if(Ni(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Ww.call(t,i)||!Ni(e[i],t[i]))return!1}return!0}function UF(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function WF(e,t){var n=UF(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=UF(n)}}function e4(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?e4(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function t4(){for(var e=window,t=f0();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=f0(e.document)}return t}function E_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function GH(e){var t=t4(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&e4(n.ownerDocument.documentElement,n)){if(r!==null&&E_(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=WF(n,o);var s=WF(n,r);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var YH=ps&&"documentMode"in document&&11>=document.documentMode,nc=null,ub=null,fh=null,lb=!1;function qF(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;lb||nc==null||nc!==f0(r)||(r=nc,"selectionStart"in r&&E_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),fh&&Lh(fh,r)||(fh=r,r=v0(ub,"onSelect"),0<r.length&&(t=new x_("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=nc)))}function Tg(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var rc={animationend:Tg("Animation","AnimationEnd"),animationiteration:Tg("Animation","AnimationIteration"),animationstart:Tg("Animation","AnimationStart"),transitionend:Tg("Transition","TransitionEnd")},e2={},n4={};ps&&(n4=document.createElement("div").style,"AnimationEvent"in window||(delete rc.animationend.animation,delete rc.animationiteration.animation,delete rc.animationstart.animation),"TransitionEvent"in window||delete rc.transitionend.transition);function Ey(e){if(e2[e])return e2[e];if(!rc[e])return e;var t=rc[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in n4)return e2[e]=t[n];return e}var r4=Ey("animationend"),i4=Ey("animationiteration"),o4=Ey("animationstart"),s4=Ey("transitionend"),a4=new Map,HF="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ua(e,t){a4.set(e,t),vl(t,[e])}for(var t2=0;t2<HF.length;t2++){var n2=HF[t2],XH=n2.toLowerCase(),QH=n2[0].toUpperCase()+n2.slice(1);Ua(XH,"on"+QH)}Ua(r4,"onAnimationEnd");Ua(i4,"onAnimationIteration");Ua(o4,"onAnimationStart");Ua("dblclick","onDoubleClick");Ua("focusin","onFocus");Ua("focusout","onBlur");Ua(s4,"onTransitionEnd");Rc("onMouseEnter",["mouseout","mouseover"]);Rc("onMouseLeave",["mouseout","mouseover"]);Rc("onPointerEnter",["pointerout","pointerover"]);Rc("onPointerLeave",["pointerout","pointerover"]);vl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vl("onBeforeInput",["compositionend","keypress","textInput","paste"]);vl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KH=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dd));function VF(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Xq(r,t,void 0,e),e.currentTarget=null}function u4(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],u=a.instance,l=a.currentTarget;if(a=a.listener,u!==o&&i.isPropagationStopped())break e;VF(i,a,l),o=u}else for(s=0;s<r.length;s++){if(a=r[s],u=a.instance,l=a.currentTarget,a=a.listener,u!==o&&i.isPropagationStopped())break e;VF(i,a,l),o=u}}}if(h0)throw e=ib,h0=!1,ib=null,e}function Xe(e,t){var n=t[pb];n===void 0&&(n=t[pb]=new Set);var r=e+"__bubble";n.has(r)||(l4(t,e,2,!1),n.add(r))}function r2(e,t,n){var r=0;t&&(r|=4),l4(n,e,r,t)}var Ng="_reactListening"+Math.random().toString(36).slice(2);function zh(e){if(!e[Ng]){e[Ng]=!0,mD.forEach(function(n){n!=="selectionchange"&&(KH.has(n)||r2(n,!1,e),r2(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ng]||(t[Ng]=!0,r2("selectionchange",!1,t))}}function l4(e,t,n,r){switch(VD(t)){case 1:var i=fH;break;case 4:i=dH;break;default:i=y_}n=i.bind(null,t,n,e),i=void 0,!rb||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function i2(e,t,n,r,i){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Cu(a),s===null)return;if(u=s.tag,u===5||u===6){r=o=s;continue e}a=a.parentNode}}r=r.return}ND(function(){var l=o,c=h_(n),f=[];e:{var d=a4.get(e);if(d!==void 0){var h=x_,p=e;switch(e){case"keypress":if(Nm(n)===0)break e;case"keydown":case"keyup":h=CH;break;case"focusin":p="focus",h=Kx;break;case"focusout":p="blur",h=Kx;break;case"beforeblur":case"afterblur":h=Kx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=RF;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=gH;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=MH;break;case r4:case i4:case o4:h=vH;break;case s4:h=NH;break;case"scroll":h=hH;break;case"wheel":h=RH;break;case"copy":case"cut":case"paste":h=wH;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=PF}var g=(t&4)!==0,y=!g&&e==="scroll",m=g?d!==null?d+"Capture":null:d;g=[];for(var v=l,x;v!==null;){x=v;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,m!==null&&(w=Nh(v,m),w!=null&&g.push(Ih(v,w,x)))),y)break;v=v.return}0<g.length&&(d=new h(d,p,null,n,c),f.push({event:d,listeners:g}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&n!==tb&&(p=n.relatedTarget||n.fromElement)&&(Cu(p)||p[gs]))break e;if((h||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?Cu(p):null,p!==null&&(y=xl(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(g=RF,w="onMouseLeave",m="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(g=PF,w="onPointerLeave",m="onPointerEnter",v="pointer"),y=h==null?d:ic(h),x=p==null?d:ic(p),d=new g(w,v+"leave",h,n,c),d.target=y,d.relatedTarget=x,w=null,Cu(c)===l&&(g=new g(m,v+"enter",p,n,c),g.target=x,g.relatedTarget=y,w=g),y=w,h&&p)t:{for(g=h,m=p,v=0,x=g;x;x=Ll(x))v++;for(x=0,w=m;w;w=Ll(w))x++;for(;0<v-x;)g=Ll(g),v--;for(;0<x-v;)m=Ll(m),x--;for(;v--;){if(g===m||m!==null&&g===m.alternate)break t;g=Ll(g),m=Ll(m)}g=null}else g=null;h!==null&&GF(f,d,h,g,!1),p!==null&&y!==null&&GF(f,y,p,g,!0)}}e:{if(d=l?ic(l):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var b=jH;else if(IF(d))if(ZD)b=HH;else{b=WH;var S=UH}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(b=qH);if(b&&(b=b(e,l))){KD(f,b,n,c);break e}S&&S(e,d,l),e==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&Qw(d,"number",d.value)}switch(S=l?ic(l):window,e){case"focusin":(IF(S)||S.contentEditable==="true")&&(nc=S,ub=l,fh=null);break;case"focusout":fh=ub=nc=null;break;case"mousedown":lb=!0;break;case"contextmenu":case"mouseup":case"dragend":lb=!1,qF(f,n,c);break;case"selectionchange":if(YH)break;case"keydown":case"keyup":qF(f,n,c)}var E;if(b_)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else tc?XD(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(YD&&n.locale!=="ko"&&(tc||_!=="onCompositionStart"?_==="onCompositionEnd"&&tc&&(E=GD()):(Ks=c,v_="value"in Ks?Ks.value:Ks.textContent,tc=!0)),S=v0(l,_),0<S.length&&(_=new DF(_,e,null,n,c),f.push({event:_,listeners:S}),E?_.data=E:(E=QD(n),E!==null&&(_.data=E)))),(E=PH?LH(e,n):zH(e,n))&&(l=v0(l,"onBeforeInput"),0<l.length&&(c=new DF("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:l}),c.data=E))}u4(f,t)})}function Ih(e,t,n){return{instance:e,listener:t,currentTarget:n}}function v0(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Nh(e,n),o!=null&&r.unshift(Ih(e,o,i)),o=Nh(e,t),o!=null&&r.push(Ih(e,o,i))),e=e.return}return r}function Ll(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function GF(e,t,n,r,i){for(var o=t._reactName,s=[];n!==null&&n!==r;){var a=n,u=a.alternate,l=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&l!==null&&(a=l,i?(u=Nh(n,o),u!=null&&s.unshift(Ih(n,u,a))):i||(u=Nh(n,o),u!=null&&s.push(Ih(n,u,a)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var ZH=/\r\n?/g,JH=/\u0000|\uFFFD/g;function YF(e){return(typeof e=="string"?e:""+e).replace(ZH,`
`).replace(JH,"")}function Og(e,t,n){if(t=YF(t),YF(e)!==t&&n)throw Error(q(425))}function x0(){}var cb=null,fb=null;function db(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var hb=typeof setTimeout=="function"?setTimeout:void 0,eV=typeof clearTimeout=="function"?clearTimeout:void 0,XF=typeof Promise=="function"?Promise:void 0,tV=typeof queueMicrotask=="function"?queueMicrotask:typeof XF<"u"?function(e){return XF.resolve(null).then(e).catch(nV)}:hb;function nV(e){setTimeout(function(){throw e})}function o2(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Dh(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Dh(t)}function da(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function QF(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var $f=Math.random().toString(36).slice(2),io="__reactFiber$"+$f,Bh="__reactProps$"+$f,gs="__reactContainer$"+$f,pb="__reactEvents$"+$f,rV="__reactListeners$"+$f,iV="__reactHandles$"+$f;function Cu(e){var t=e[io];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gs]||n[io]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=QF(e);e!==null;){if(n=e[io])return n;e=QF(e)}return t}e=n,n=e.parentNode}return null}function Ap(e){return e=e[io]||e[gs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ic(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(q(33))}function Sy(e){return e[Bh]||null}var gb=[],oc=-1;function Wa(e){return{current:e}}function Ze(e){0>oc||(e.current=gb[oc],gb[oc]=null,oc--)}function Ge(e,t){oc++,gb[oc]=e.current,e.current=t}var _a={},kn=Wa(_a),nr=Wa(!1),Vu=_a;function Dc(e,t){var n=e.type.contextTypes;if(!n)return _a;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function rr(e){return e=e.childContextTypes,e!=null}function w0(){Ze(nr),Ze(kn)}function KF(e,t,n){if(kn.current!==_a)throw Error(q(168));Ge(kn,t),Ge(nr,n)}function c4(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(q(108,Uq(e)||"Unknown",i));return ut({},n,r)}function b0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_a,Vu=kn.current,Ge(kn,e),Ge(nr,nr.current),!0}function ZF(e,t,n){var r=e.stateNode;if(!r)throw Error(q(169));n?(e=c4(e,t,Vu),r.__reactInternalMemoizedMergedChildContext=e,Ze(nr),Ze(kn),Ge(kn,e)):Ze(nr),Ge(nr,n)}var Vo=null,_y=!1,s2=!1;function f4(e){Vo===null?Vo=[e]:Vo.push(e)}function oV(e){_y=!0,f4(e)}function qa(){if(!s2&&Vo!==null){s2=!0;var e=0,t=Be;try{var n=Vo;for(Be=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Vo=null,_y=!1}catch(i){throw Vo!==null&&(Vo=Vo.slice(e+1)),PD(p_,qa),i}finally{Be=t,s2=!1}}return null}var sc=[],ac=0,E0=null,S0=0,Ir=[],Br=0,Gu=null,Ko=1,Zo="";function yu(e,t){sc[ac++]=S0,sc[ac++]=E0,E0=e,S0=t}function d4(e,t,n){Ir[Br++]=Ko,Ir[Br++]=Zo,Ir[Br++]=Gu,Gu=e;var r=Ko;e=Zo;var i=32-Ai(r)-1;r&=~(1<<i),n+=1;var o=32-Ai(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Ko=1<<32-Ai(t)+i|n<<i|r,Zo=o+e}else Ko=1<<o|n<<i|r,Zo=e}function S_(e){e.return!==null&&(yu(e,1),d4(e,1,0))}function __(e){for(;e===E0;)E0=sc[--ac],sc[ac]=null,S0=sc[--ac],sc[ac]=null;for(;e===Gu;)Gu=Ir[--Br],Ir[Br]=null,Zo=Ir[--Br],Ir[Br]=null,Ko=Ir[--Br],Ir[Br]=null}var _r=null,wr=null,et=!1,xi=null;function h4(e,t){var n=Wr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function JF(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,_r=e,wr=da(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,_r=e,wr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Gu!==null?{id:Ko,overflow:Zo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Wr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,_r=e,wr=null,!0):!1;default:return!1}}function mb(e){return(e.mode&1)!==0&&(e.flags&128)===0}function yb(e){if(et){var t=wr;if(t){var n=t;if(!JF(e,t)){if(mb(e))throw Error(q(418));t=da(n.nextSibling);var r=_r;t&&JF(e,t)?h4(r,n):(e.flags=e.flags&-4097|2,et=!1,_r=e)}}else{if(mb(e))throw Error(q(418));e.flags=e.flags&-4097|2,et=!1,_r=e}}}function eM(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;_r=e}function Rg(e){if(e!==_r)return!1;if(!et)return eM(e),et=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!db(e.type,e.memoizedProps)),t&&(t=wr)){if(mb(e))throw p4(),Error(q(418));for(;t;)h4(e,t),t=da(t.nextSibling)}if(eM(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){wr=da(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}wr=null}}else wr=_r?da(e.stateNode.nextSibling):null;return!0}function p4(){for(var e=wr;e;)e=da(e.nextSibling)}function Pc(){wr=_r=null,et=!1}function k_(e){xi===null?xi=[e]:xi.push(e)}var sV=Es.ReactCurrentBatchConfig;function id(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(q(309));var r=n.stateNode}if(!r)throw Error(q(147,e));var i=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(q(284));if(!n._owner)throw Error(q(290,e))}return e}function Dg(e,t){throw e=Object.prototype.toString.call(t),Error(q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function tM(e){var t=e._init;return t(e._payload)}function g4(e){function t(m,v){if(e){var x=m.deletions;x===null?(m.deletions=[v],m.flags|=16):x.push(v)}}function n(m,v){if(!e)return null;for(;v!==null;)t(m,v),v=v.sibling;return null}function r(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function i(m,v){return m=ma(m,v),m.index=0,m.sibling=null,m}function o(m,v,x){return m.index=x,e?(x=m.alternate,x!==null?(x=x.index,x<v?(m.flags|=2,v):x):(m.flags|=2,v)):(m.flags|=1048576,v)}function s(m){return e&&m.alternate===null&&(m.flags|=2),m}function a(m,v,x,w){return v===null||v.tag!==6?(v=h2(x,m.mode,w),v.return=m,v):(v=i(v,x),v.return=m,v)}function u(m,v,x,w){var b=x.type;return b===ec?c(m,v,x.props.children,w,x.key):v!==null&&(v.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Is&&tM(b)===v.type)?(w=i(v,x.props),w.ref=id(m,v,x),w.return=m,w):(w=Im(x.type,x.key,x.props,null,m.mode,w),w.ref=id(m,v,x),w.return=m,w)}function l(m,v,x,w){return v===null||v.tag!==4||v.stateNode.containerInfo!==x.containerInfo||v.stateNode.implementation!==x.implementation?(v=p2(x,m.mode,w),v.return=m,v):(v=i(v,x.children||[]),v.return=m,v)}function c(m,v,x,w,b){return v===null||v.tag!==7?(v=Du(x,m.mode,w,b),v.return=m,v):(v=i(v,x),v.return=m,v)}function f(m,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return v=h2(""+v,m.mode,x),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case _g:return x=Im(v.type,v.key,v.props,null,m.mode,x),x.ref=id(m,null,v),x.return=m,x;case Jl:return v=p2(v,m.mode,x),v.return=m,v;case Is:var w=v._init;return f(m,w(v._payload),x)}if(Od(v)||Jf(v))return v=Du(v,m.mode,x,null),v.return=m,v;Dg(m,v)}return null}function d(m,v,x,w){var b=v!==null?v.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return b!==null?null:a(m,v,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case _g:return x.key===b?u(m,v,x,w):null;case Jl:return x.key===b?l(m,v,x,w):null;case Is:return b=x._init,d(m,v,b(x._payload),w)}if(Od(x)||Jf(x))return b!==null?null:c(m,v,x,w,null);Dg(m,x)}return null}function h(m,v,x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(x)||null,a(v,m,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case _g:return m=m.get(w.key===null?x:w.key)||null,u(v,m,w,b);case Jl:return m=m.get(w.key===null?x:w.key)||null,l(v,m,w,b);case Is:var S=w._init;return h(m,v,x,S(w._payload),b)}if(Od(w)||Jf(w))return m=m.get(x)||null,c(v,m,w,b,null);Dg(v,w)}return null}function p(m,v,x,w){for(var b=null,S=null,E=v,_=v=0,k=null;E!==null&&_<x.length;_++){E.index>_?(k=E,E=null):k=E.sibling;var $=d(m,E,x[_],w);if($===null){E===null&&(E=k);break}e&&E&&$.alternate===null&&t(m,E),v=o($,v,_),S===null?b=$:S.sibling=$,S=$,E=k}if(_===x.length)return n(m,E),et&&yu(m,_),b;if(E===null){for(;_<x.length;_++)E=f(m,x[_],w),E!==null&&(v=o(E,v,_),S===null?b=E:S.sibling=E,S=E);return et&&yu(m,_),b}for(E=r(m,E);_<x.length;_++)k=h(E,m,_,x[_],w),k!==null&&(e&&k.alternate!==null&&E.delete(k.key===null?_:k.key),v=o(k,v,_),S===null?b=k:S.sibling=k,S=k);return e&&E.forEach(function(C){return t(m,C)}),et&&yu(m,_),b}function g(m,v,x,w){var b=Jf(x);if(typeof b!="function")throw Error(q(150));if(x=b.call(x),x==null)throw Error(q(151));for(var S=b=null,E=v,_=v=0,k=null,$=x.next();E!==null&&!$.done;_++,$=x.next()){E.index>_?(k=E,E=null):k=E.sibling;var C=d(m,E,$.value,w);if(C===null){E===null&&(E=k);break}e&&E&&C.alternate===null&&t(m,E),v=o(C,v,_),S===null?b=C:S.sibling=C,S=C,E=k}if($.done)return n(m,E),et&&yu(m,_),b;if(E===null){for(;!$.done;_++,$=x.next())$=f(m,$.value,w),$!==null&&(v=o($,v,_),S===null?b=$:S.sibling=$,S=$);return et&&yu(m,_),b}for(E=r(m,E);!$.done;_++,$=x.next())$=h(E,m,_,$.value,w),$!==null&&(e&&$.alternate!==null&&E.delete($.key===null?_:$.key),v=o($,v,_),S===null?b=$:S.sibling=$,S=$);return e&&E.forEach(function(R){return t(m,R)}),et&&yu(m,_),b}function y(m,v,x,w){if(typeof x=="object"&&x!==null&&x.type===ec&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case _g:e:{for(var b=x.key,S=v;S!==null;){if(S.key===b){if(b=x.type,b===ec){if(S.tag===7){n(m,S.sibling),v=i(S,x.props.children),v.return=m,m=v;break e}}else if(S.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Is&&tM(b)===S.type){n(m,S.sibling),v=i(S,x.props),v.ref=id(m,S,x),v.return=m,m=v;break e}n(m,S);break}else t(m,S);S=S.sibling}x.type===ec?(v=Du(x.props.children,m.mode,w,x.key),v.return=m,m=v):(w=Im(x.type,x.key,x.props,null,m.mode,w),w.ref=id(m,v,x),w.return=m,m=w)}return s(m);case Jl:e:{for(S=x.key;v!==null;){if(v.key===S)if(v.tag===4&&v.stateNode.containerInfo===x.containerInfo&&v.stateNode.implementation===x.implementation){n(m,v.sibling),v=i(v,x.children||[]),v.return=m,m=v;break e}else{n(m,v);break}else t(m,v);v=v.sibling}v=p2(x,m.mode,w),v.return=m,m=v}return s(m);case Is:return S=x._init,y(m,v,S(x._payload),w)}if(Od(x))return p(m,v,x,w);if(Jf(x))return g(m,v,x,w);Dg(m,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,v!==null&&v.tag===6?(n(m,v.sibling),v=i(v,x),v.return=m,m=v):(n(m,v),v=h2(x,m.mode,w),v.return=m,m=v),s(m)):n(m,v)}return y}var Lc=g4(!0),m4=g4(!1),_0=Wa(null),k0=null,uc=null,$_=null;function C_(){$_=uc=k0=null}function A_(e){var t=_0.current;Ze(_0),e._currentValue=t}function vb(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ec(e,t){k0=e,$_=uc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(er=!0),e.firstContext=null)}function Kr(e){var t=e._currentValue;if($_!==e)if(e={context:e,memoizedValue:t,next:null},uc===null){if(k0===null)throw Error(q(308));uc=e,k0.dependencies={lanes:0,firstContext:e}}else uc=uc.next=e;return t}var Au=null;function F_(e){Au===null?Au=[e]:Au.push(e)}function y4(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,F_(t)):(n.next=i.next,i.next=n),t.interleaved=n,ms(e,r)}function ms(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Bs=!1;function M_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function v4(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function os(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ha(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Fe&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,ms(e,n)}return i=r.interleaved,i===null?(t.next=t,F_(r)):(t.next=i.next,i.next=t),r.interleaved=t,ms(e,n)}function Om(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,g_(e,n)}}function nM(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=t:o=o.next=t}else i=o=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function $0(e,t,n,r){var i=e.updateQueue;Bs=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var u=a,l=u.next;u.next=null,s===null?o=l:s.next=l,s=u;var c=e.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==s&&(a===null?c.firstBaseUpdate=l:a.next=l,c.lastBaseUpdate=u))}if(o!==null){var f=i.baseState;s=0,c=l=u=null,a=o;do{var d=a.lane,h=a.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(d=t,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){f=p.call(h,f,d);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(h,f,d):p,d==null)break e;f=ut({},f,d);break e;case 2:Bs=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else h={eventTime:h,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(l=c=h,u=f):c=c.next=h,s|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(u=f),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);Xu|=s,e.lanes=s,e.memoizedState=f}}function rM(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(q(191,i));i.call(r)}}}var Fp={},fo=Wa(Fp),jh=Wa(Fp),Uh=Wa(Fp);function Fu(e){if(e===Fp)throw Error(q(174));return e}function T_(e,t){switch(Ge(Uh,t),Ge(jh,e),Ge(fo,Fp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Zw(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Zw(t,e)}Ze(fo),Ge(fo,t)}function zc(){Ze(fo),Ze(jh),Ze(Uh)}function x4(e){Fu(Uh.current);var t=Fu(fo.current),n=Zw(t,e.type);t!==n&&(Ge(jh,e),Ge(fo,n))}function N_(e){jh.current===e&&(Ze(fo),Ze(jh))}var ot=Wa(0);function C0(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var a2=[];function O_(){for(var e=0;e<a2.length;e++)a2[e]._workInProgressVersionPrimary=null;a2.length=0}var Rm=Es.ReactCurrentDispatcher,u2=Es.ReactCurrentBatchConfig,Yu=0,at=null,St=null,Rt=null,A0=!1,dh=!1,Wh=0,aV=0;function un(){throw Error(q(321))}function R_(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ni(e[n],t[n]))return!1;return!0}function D_(e,t,n,r,i,o){if(Yu=o,at=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Rm.current=e===null||e.memoizedState===null?fV:dV,e=n(r,i),dh){o=0;do{if(dh=!1,Wh=0,25<=o)throw Error(q(301));o+=1,Rt=St=null,t.updateQueue=null,Rm.current=hV,e=n(r,i)}while(dh)}if(Rm.current=F0,t=St!==null&&St.next!==null,Yu=0,Rt=St=at=null,A0=!1,t)throw Error(q(300));return e}function P_(){var e=Wh!==0;return Wh=0,e}function eo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?at.memoizedState=Rt=e:Rt=Rt.next=e,Rt}function Zr(){if(St===null){var e=at.alternate;e=e!==null?e.memoizedState:null}else e=St.next;var t=Rt===null?at.memoizedState:Rt.next;if(t!==null)Rt=t,St=e;else{if(e===null)throw Error(q(310));St=e,e={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},Rt===null?at.memoizedState=Rt=e:Rt=Rt.next=e}return Rt}function qh(e,t){return typeof t=="function"?t(e):t}function l2(e){var t=Zr(),n=t.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=e;var r=St,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,u=null,l=o;do{var c=l.lane;if((Yu&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var f={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(a=u=f,s=r):u=u.next=f,at.lanes|=c,Xu|=c}l=l.next}while(l!==null&&l!==o);u===null?s=r:u.next=a,Ni(r,t.memoizedState)||(er=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do o=i.lane,at.lanes|=o,Xu|=o,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function c2(e){var t=Zr(),n=t.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);Ni(o,t.memoizedState)||(er=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function w4(){}function b4(e,t){var n=at,r=Zr(),i=t(),o=!Ni(r.memoizedState,i);if(o&&(r.memoizedState=i,er=!0),r=r.queue,L_(_4.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||Rt!==null&&Rt.memoizedState.tag&1){if(n.flags|=2048,Hh(9,S4.bind(null,n,r,i,t),void 0,null),Ut===null)throw Error(q(349));Yu&30||E4(n,t,i)}return i}function E4(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=at.updateQueue,t===null?(t={lastEffect:null,stores:null},at.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function S4(e,t,n,r){t.value=n,t.getSnapshot=r,k4(t)&&$4(e)}function _4(e,t,n){return n(function(){k4(t)&&$4(e)})}function k4(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ni(e,n)}catch{return!0}}function $4(e){var t=ms(e,1);t!==null&&Fi(t,e,1,-1)}function iM(e){var t=eo();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qh,lastRenderedState:e},t.queue=e,e=e.dispatch=cV.bind(null,at,e),[t.memoizedState,e]}function Hh(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=at.updateQueue,t===null?(t={lastEffect:null,stores:null},at.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function C4(){return Zr().memoizedState}function Dm(e,t,n,r){var i=eo();at.flags|=e,i.memoizedState=Hh(1|t,n,void 0,r===void 0?null:r)}function ky(e,t,n,r){var i=Zr();r=r===void 0?null:r;var o=void 0;if(St!==null){var s=St.memoizedState;if(o=s.destroy,r!==null&&R_(r,s.deps)){i.memoizedState=Hh(t,n,o,r);return}}at.flags|=e,i.memoizedState=Hh(1|t,n,o,r)}function oM(e,t){return Dm(8390656,8,e,t)}function L_(e,t){return ky(2048,8,e,t)}function A4(e,t){return ky(4,2,e,t)}function F4(e,t){return ky(4,4,e,t)}function M4(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function T4(e,t,n){return n=n!=null?n.concat([e]):null,ky(4,4,M4.bind(null,t,e),n)}function z_(){}function N4(e,t){var n=Zr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&R_(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function O4(e,t){var n=Zr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&R_(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function R4(e,t,n){return Yu&21?(Ni(n,t)||(n=ID(),at.lanes|=n,Xu|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,er=!0),e.memoizedState=n)}function uV(e,t){var n=Be;Be=n!==0&&4>n?n:4,e(!0);var r=u2.transition;u2.transition={};try{e(!1),t()}finally{Be=n,u2.transition=r}}function D4(){return Zr().memoizedState}function lV(e,t,n){var r=ga(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},P4(e))L4(t,n);else if(n=y4(e,t,n,r),n!==null){var i=zn();Fi(n,e,r,i),z4(n,t,r)}}function cV(e,t,n){var r=ga(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(P4(e))L4(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Ni(a,s)){var u=t.interleaved;u===null?(i.next=i,F_(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}n=y4(e,t,i,r),n!==null&&(i=zn(),Fi(n,e,r,i),z4(n,t,r))}}function P4(e){var t=e.alternate;return e===at||t!==null&&t===at}function L4(e,t){dh=A0=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function z4(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,g_(e,n)}}var F0={readContext:Kr,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},fV={readContext:Kr,useCallback:function(e,t){return eo().memoizedState=[e,t===void 0?null:t],e},useContext:Kr,useEffect:oM,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Dm(4194308,4,M4.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Dm(4194308,4,e,t)},useInsertionEffect:function(e,t){return Dm(4,2,e,t)},useMemo:function(e,t){var n=eo();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=eo();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=lV.bind(null,at,e),[r.memoizedState,e]},useRef:function(e){var t=eo();return e={current:e},t.memoizedState=e},useState:iM,useDebugValue:z_,useDeferredValue:function(e){return eo().memoizedState=e},useTransition:function(){var e=iM(!1),t=e[0];return e=uV.bind(null,e[1]),eo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=at,i=eo();if(et){if(n===void 0)throw Error(q(407));n=n()}else{if(n=t(),Ut===null)throw Error(q(349));Yu&30||E4(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,oM(_4.bind(null,r,o,e),[e]),r.flags|=2048,Hh(9,S4.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=eo(),t=Ut.identifierPrefix;if(et){var n=Zo,r=Ko;n=(r&~(1<<32-Ai(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Wh++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=aV++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},dV={readContext:Kr,useCallback:N4,useContext:Kr,useEffect:L_,useImperativeHandle:T4,useInsertionEffect:A4,useLayoutEffect:F4,useMemo:O4,useReducer:l2,useRef:C4,useState:function(){return l2(qh)},useDebugValue:z_,useDeferredValue:function(e){var t=Zr();return R4(t,St.memoizedState,e)},useTransition:function(){var e=l2(qh)[0],t=Zr().memoizedState;return[e,t]},useMutableSource:w4,useSyncExternalStore:b4,useId:D4,unstable_isNewReconciler:!1},hV={readContext:Kr,useCallback:N4,useContext:Kr,useEffect:L_,useImperativeHandle:T4,useInsertionEffect:A4,useLayoutEffect:F4,useMemo:O4,useReducer:c2,useRef:C4,useState:function(){return c2(qh)},useDebugValue:z_,useDeferredValue:function(e){var t=Zr();return St===null?t.memoizedState=e:R4(t,St.memoizedState,e)},useTransition:function(){var e=c2(qh)[0],t=Zr().memoizedState;return[e,t]},useMutableSource:w4,useSyncExternalStore:b4,useId:D4,unstable_isNewReconciler:!1};function pi(e,t){if(e&&e.defaultProps){t=ut({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function xb(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ut({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var $y={isMounted:function(e){return(e=e._reactInternals)?xl(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=zn(),i=ga(e),o=os(r,i);o.payload=t,n!=null&&(o.callback=n),t=ha(e,o,i),t!==null&&(Fi(t,e,i,r),Om(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=zn(),i=ga(e),o=os(r,i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=ha(e,o,i),t!==null&&(Fi(t,e,i,r),Om(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=zn(),r=ga(e),i=os(n,r);i.tag=2,t!=null&&(i.callback=t),t=ha(e,i,r),t!==null&&(Fi(t,e,r,n),Om(t,e,r))}};function sM(e,t,n,r,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,s):t.prototype&&t.prototype.isPureReactComponent?!Lh(n,r)||!Lh(i,o):!0}function I4(e,t,n){var r=!1,i=_a,o=t.contextType;return typeof o=="object"&&o!==null?o=Kr(o):(i=rr(t)?Vu:kn.current,r=t.contextTypes,o=(r=r!=null)?Dc(e,i):_a),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=$y,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function aM(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&$y.enqueueReplaceState(t,t.state,null)}function wb(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},M_(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=Kr(o):(o=rr(t)?Vu:kn.current,i.context=Dc(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(xb(e,t,o,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&$y.enqueueReplaceState(i,i.state,null),$0(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Ic(e,t){try{var n="",r=t;do n+=jq(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function f2(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function bb(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var pV=typeof WeakMap=="function"?WeakMap:Map;function B4(e,t,n){n=os(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){T0||(T0=!0,Tb=r),bb(e,t)},n}function j4(e,t,n){n=os(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){bb(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){bb(e,t),typeof r!="function"&&(pa===null?pa=new Set([this]):pa.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function uM(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new pV;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=AV.bind(null,e,t,n),t.then(e,e))}function lM(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function cM(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=os(-1,1),t.tag=2,ha(n,t,1))),n.lanes|=1),e)}var gV=Es.ReactCurrentOwner,er=!1;function Tn(e,t,n,r){t.child=e===null?m4(t,null,n,r):Lc(t,e.child,n,r)}function fM(e,t,n,r,i){n=n.render;var o=t.ref;return Ec(t,i),r=D_(e,t,n,r,o,i),n=P_(),e!==null&&!er?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ys(e,t,i)):(et&&n&&S_(t),t.flags|=1,Tn(e,t,r,i),t.child)}function dM(e,t,n,r,i){if(e===null){var o=n.type;return typeof o=="function"&&!V_(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,U4(e,t,o,r,i)):(e=Im(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Lh,n(s,r)&&e.ref===t.ref)return ys(e,t,i)}return t.flags|=1,e=ma(o,r),e.ref=t.ref,e.return=t,t.child=e}function U4(e,t,n,r,i){if(e!==null){var o=e.memoizedProps;if(Lh(o,r)&&e.ref===t.ref)if(er=!1,t.pendingProps=r=o,(e.lanes&i)!==0)e.flags&131072&&(er=!0);else return t.lanes=e.lanes,ys(e,t,i)}return Eb(e,t,n,r,i)}function W4(e,t,n){var r=t.pendingProps,i=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ge(cc,mr),mr|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ge(cc,mr),mr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Ge(cc,mr),mr|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ge(cc,mr),mr|=r;return Tn(e,t,i,n),t.child}function q4(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Eb(e,t,n,r,i){var o=rr(n)?Vu:kn.current;return o=Dc(t,o),Ec(t,i),n=D_(e,t,n,r,o,i),r=P_(),e!==null&&!er?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ys(e,t,i)):(et&&r&&S_(t),t.flags|=1,Tn(e,t,n,i),t.child)}function hM(e,t,n,r,i){if(rr(n)){var o=!0;b0(t)}else o=!1;if(Ec(t,i),t.stateNode===null)Pm(e,t),I4(t,n,r),wb(t,n,r,i),r=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var u=s.context,l=n.contextType;typeof l=="object"&&l!==null?l=Kr(l):(l=rr(n)?Vu:kn.current,l=Dc(t,l));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||u!==l)&&aM(t,s,r,l),Bs=!1;var d=t.memoizedState;s.state=d,$0(t,r,s,i),u=t.memoizedState,a!==r||d!==u||nr.current||Bs?(typeof c=="function"&&(xb(t,n,c,r),u=t.memoizedState),(a=Bs||sM(t,n,a,r,d,u,l))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),s.props=r,s.state=u,s.context=l,r=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,v4(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:pi(t.type,a),s.props=l,f=t.pendingProps,d=s.context,u=n.contextType,typeof u=="object"&&u!==null?u=Kr(u):(u=rr(n)?Vu:kn.current,u=Dc(t,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==f||d!==u)&&aM(t,s,r,u),Bs=!1,d=t.memoizedState,s.state=d,$0(t,r,s,i);var p=t.memoizedState;a!==f||d!==p||nr.current||Bs?(typeof h=="function"&&(xb(t,n,h,r),p=t.memoizedState),(l=Bs||sM(t,n,l,r,d,p,u)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,u)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=u,r=l):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Sb(e,t,n,r,o,i)}function Sb(e,t,n,r,i,o){q4(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return i&&ZF(t,n,!1),ys(e,t,o);r=t.stateNode,gV.current=t;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=Lc(t,e.child,null,o),t.child=Lc(t,null,a,o)):Tn(e,t,a,o),t.memoizedState=r.state,i&&ZF(t,n,!0),t.child}function H4(e){var t=e.stateNode;t.pendingContext?KF(e,t.pendingContext,t.pendingContext!==t.context):t.context&&KF(e,t.context,!1),T_(e,t.containerInfo)}function pM(e,t,n,r,i){return Pc(),k_(i),t.flags|=256,Tn(e,t,n,r),t.child}var _b={dehydrated:null,treeContext:null,retryLane:0};function kb(e){return{baseLanes:e,cachePool:null,transitions:null}}function V4(e,t,n){var r=t.pendingProps,i=ot.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Ge(ot,i&1),e===null)return yb(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=r.children,e=r.fallback,o?(r=t.mode,o=t.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Fy(s,r,0,null),e=Du(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=kb(n),t.memoizedState=_b,e):I_(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return mV(e,t,s,r,a,i,n);if(o){o=r.fallback,s=t.mode,i=e.child,a=i.sibling;var u={mode:"hidden",children:r.children};return!(s&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=ma(i,u),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=ma(a,o):(o=Du(o,s,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,s=e.child.memoizedState,s=s===null?kb(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~n,t.memoizedState=_b,r}return o=e.child,e=o.sibling,r=ma(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function I_(e,t){return t=Fy({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Pg(e,t,n,r){return r!==null&&k_(r),Lc(t,e.child,null,n),e=I_(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function mV(e,t,n,r,i,o,s){if(n)return t.flags&256?(t.flags&=-257,r=f2(Error(q(422))),Pg(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Fy({mode:"visible",children:r.children},i,0,null),o=Du(o,i,s,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Lc(t,e.child,null,s),t.child.memoizedState=kb(s),t.memoizedState=_b,o);if(!(t.mode&1))return Pg(e,t,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(q(419)),r=f2(o,r,void 0),Pg(e,t,s,r)}if(a=(s&e.childLanes)!==0,er||a){if(r=Ut,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,ms(e,i),Fi(r,e,i,-1))}return H_(),r=f2(Error(q(421))),Pg(e,t,s,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=FV.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,wr=da(i.nextSibling),_r=t,et=!0,xi=null,e!==null&&(Ir[Br++]=Ko,Ir[Br++]=Zo,Ir[Br++]=Gu,Ko=e.id,Zo=e.overflow,Gu=t),t=I_(t,r.children),t.flags|=4096,t)}function gM(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),vb(e.return,t,n)}function d2(e,t,n,r,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function G4(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Tn(e,t,r.children,n),r=ot.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gM(e,n,t);else if(e.tag===19)gM(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ge(ot,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&C0(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),d2(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&C0(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}d2(t,!0,n,null,o);break;case"together":d2(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Pm(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ys(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Xu|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(q(153));if(t.child!==null){for(e=t.child,n=ma(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ma(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function yV(e,t,n){switch(t.tag){case 3:H4(t),Pc();break;case 5:x4(t);break;case 1:rr(t.type)&&b0(t);break;case 4:T_(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ge(_0,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ge(ot,ot.current&1),t.flags|=128,null):n&t.child.childLanes?V4(e,t,n):(Ge(ot,ot.current&1),e=ys(e,t,n),e!==null?e.sibling:null);Ge(ot,ot.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return G4(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ge(ot,ot.current),r)break;return null;case 22:case 23:return t.lanes=0,W4(e,t,n)}return ys(e,t,n)}var Y4,$b,X4,Q4;Y4=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};$b=function(){};X4=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Fu(fo.current);var o=null;switch(n){case"input":i=Yw(e,i),r=Yw(e,r),o=[];break;case"select":i=ut({},i,{value:void 0}),r=ut({},r,{value:void 0}),o=[];break;case"textarea":i=Kw(e,i),r=Kw(e,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=x0)}Jw(n,r);var s;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Mh.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var u=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&u!==a&&(u!=null||a!=null))if(l==="style")if(a){for(s in a)!a.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&a[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(o||(o=[]),o.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(o=o||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Mh.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&Xe("scroll",e),o||a===u||(o=[])):(o=o||[]).push(l,u))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}};Q4=function(e,t,n,r){n!==r&&(t.flags|=4)};function od(e,t){if(!et)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ln(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function vV(e,t,n){var r=t.pendingProps;switch(__(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(t),null;case 1:return rr(t.type)&&w0(),ln(t),null;case 3:return r=t.stateNode,zc(),Ze(nr),Ze(kn),O_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Rg(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,xi!==null&&(Rb(xi),xi=null))),$b(e,t),ln(t),null;case 5:N_(t);var i=Fu(Uh.current);if(n=t.type,e!==null&&t.stateNode!=null)X4(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(q(166));return ln(t),null}if(e=Fu(fo.current),Rg(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[io]=t,r[Bh]=o,e=(t.mode&1)!==0,n){case"dialog":Xe("cancel",r),Xe("close",r);break;case"iframe":case"object":case"embed":Xe("load",r);break;case"video":case"audio":for(i=0;i<Dd.length;i++)Xe(Dd[i],r);break;case"source":Xe("error",r);break;case"img":case"image":case"link":Xe("error",r),Xe("load",r);break;case"details":Xe("toggle",r);break;case"input":_F(r,o),Xe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Xe("invalid",r);break;case"textarea":$F(r,o),Xe("invalid",r)}Jw(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Og(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Og(r.textContent,a,e),i=["children",""+a]):Mh.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Xe("scroll",r)}switch(n){case"input":kg(r),kF(r,o,!0);break;case"textarea":kg(r),CF(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=x0)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=_D(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[io]=t,e[Bh]=r,Y4(e,t,!1,!1),t.stateNode=e;e:{switch(s=eb(n,r),n){case"dialog":Xe("cancel",e),Xe("close",e),i=r;break;case"iframe":case"object":case"embed":Xe("load",e),i=r;break;case"video":case"audio":for(i=0;i<Dd.length;i++)Xe(Dd[i],e);i=r;break;case"source":Xe("error",e),i=r;break;case"img":case"image":case"link":Xe("error",e),Xe("load",e),i=r;break;case"details":Xe("toggle",e),i=r;break;case"input":_F(e,r),i=Yw(e,r),Xe("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=ut({},r,{value:void 0}),Xe("invalid",e);break;case"textarea":$F(e,r),i=Kw(e,r),Xe("invalid",e);break;default:i=r}Jw(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var u=a[o];o==="style"?CD(e,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&kD(e,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Th(e,u):typeof u=="number"&&Th(e,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Mh.hasOwnProperty(o)?u!=null&&o==="onScroll"&&Xe("scroll",e):u!=null&&l_(e,o,u,s))}switch(n){case"input":kg(e),kF(e,r,!1);break;case"textarea":kg(e),CF(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Sa(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?vc(e,!!r.multiple,o,!1):r.defaultValue!=null&&vc(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=x0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ln(t),null;case 6:if(e&&t.stateNode!=null)Q4(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(q(166));if(n=Fu(Uh.current),Fu(fo.current),Rg(t)){if(r=t.stateNode,n=t.memoizedProps,r[io]=t,(o=r.nodeValue!==n)&&(e=_r,e!==null))switch(e.tag){case 3:Og(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Og(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[io]=t,t.stateNode=r}return ln(t),null;case 13:if(Ze(ot),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(et&&wr!==null&&t.mode&1&&!(t.flags&128))p4(),Pc(),t.flags|=98560,o=!1;else if(o=Rg(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(q(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(q(317));o[io]=t}else Pc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ln(t),o=!1}else xi!==null&&(Rb(xi),xi=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||ot.current&1?$t===0&&($t=3):H_())),t.updateQueue!==null&&(t.flags|=4),ln(t),null);case 4:return zc(),$b(e,t),e===null&&zh(t.stateNode.containerInfo),ln(t),null;case 10:return A_(t.type._context),ln(t),null;case 17:return rr(t.type)&&w0(),ln(t),null;case 19:if(Ze(ot),o=t.memoizedState,o===null)return ln(t),null;if(r=(t.flags&128)!==0,s=o.rendering,s===null)if(r)od(o,!1);else{if($t!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=C0(e),s!==null){for(t.flags|=128,od(o,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ge(ot,ot.current&1|2),t.child}e=e.sibling}o.tail!==null&&yt()>Bc&&(t.flags|=128,r=!0,od(o,!1),t.lanes=4194304)}else{if(!r)if(e=C0(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),od(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!et)return ln(t),null}else 2*yt()-o.renderingStartTime>Bc&&n!==1073741824&&(t.flags|=128,r=!0,od(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(n=o.last,n!==null?n.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=yt(),t.sibling=null,n=ot.current,Ge(ot,r?n&1|2:n&1),t):(ln(t),null);case 22:case 23:return q_(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?mr&1073741824&&(ln(t),t.subtreeFlags&6&&(t.flags|=8192)):ln(t),null;case 24:return null;case 25:return null}throw Error(q(156,t.tag))}function xV(e,t){switch(__(t),t.tag){case 1:return rr(t.type)&&w0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return zc(),Ze(nr),Ze(kn),O_(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return N_(t),null;case 13:if(Ze(ot),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(q(340));Pc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ze(ot),null;case 4:return zc(),null;case 10:return A_(t.type._context),null;case 22:case 23:return q_(),null;case 24:return null;default:return null}}var Lg=!1,mn=!1,wV=typeof WeakSet=="function"?WeakSet:Set,ee=null;function lc(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){dt(e,t,r)}else n.current=null}function Cb(e,t,n){try{n()}catch(r){dt(e,t,r)}}var mM=!1;function bV(e,t){if(cb=m0,e=t4(),E_(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,u=-1,l=0,c=0,f=e,d=null;t:for(;;){for(var h;f!==n||i!==0&&f.nodeType!==3||(a=s+i),f!==o||r!==0&&f.nodeType!==3||(u=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===e)break t;if(d===n&&++l===i&&(a=s),d===o&&++c===r&&(u=s),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}n=a===-1||u===-1?null:{start:a,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(fb={focusedElem:e,selectionRange:n},m0=!1,ee=t;ee!==null;)if(t=ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ee=e;else for(;ee!==null;){t=ee;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,y=p.memoizedState,m=t.stateNode,v=m.getSnapshotBeforeUpdate(t.elementType===t.type?g:pi(t.type,g),y);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(w){dt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,ee=e;break}ee=t.return}return p=mM,mM=!1,p}function hh(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&Cb(t,n,o)}i=i.next}while(i!==r)}}function Cy(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Ab(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function K4(e){var t=e.alternate;t!==null&&(e.alternate=null,K4(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[io],delete t[Bh],delete t[pb],delete t[rV],delete t[iV])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Z4(e){return e.tag===5||e.tag===3||e.tag===4}function yM(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Z4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fb(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=x0));else if(r!==4&&(e=e.child,e!==null))for(Fb(e,t,n),e=e.sibling;e!==null;)Fb(e,t,n),e=e.sibling}function Mb(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Mb(e,t,n),e=e.sibling;e!==null;)Mb(e,t,n),e=e.sibling}var Yt=null,mi=!1;function Rs(e,t,n){for(n=n.child;n!==null;)J4(e,t,n),n=n.sibling}function J4(e,t,n){if(co&&typeof co.onCommitFiberUnmount=="function")try{co.onCommitFiberUnmount(xy,n)}catch{}switch(n.tag){case 5:mn||lc(n,t);case 6:var r=Yt,i=mi;Yt=null,Rs(e,t,n),Yt=r,mi=i,Yt!==null&&(mi?(e=Yt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Yt.removeChild(n.stateNode));break;case 18:Yt!==null&&(mi?(e=Yt,n=n.stateNode,e.nodeType===8?o2(e.parentNode,n):e.nodeType===1&&o2(e,n),Dh(e)):o2(Yt,n.stateNode));break;case 4:r=Yt,i=mi,Yt=n.stateNode.containerInfo,mi=!0,Rs(e,t,n),Yt=r,mi=i;break;case 0:case 11:case 14:case 15:if(!mn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Cb(n,t,s),i=i.next}while(i!==r)}Rs(e,t,n);break;case 1:if(!mn&&(lc(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){dt(n,t,a)}Rs(e,t,n);break;case 21:Rs(e,t,n);break;case 22:n.mode&1?(mn=(r=mn)||n.memoizedState!==null,Rs(e,t,n),mn=r):Rs(e,t,n);break;default:Rs(e,t,n)}}function vM(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new wV),t.forEach(function(r){var i=MV.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function li(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:Yt=a.stateNode,mi=!1;break e;case 3:Yt=a.stateNode.containerInfo,mi=!0;break e;case 4:Yt=a.stateNode.containerInfo,mi=!0;break e}a=a.return}if(Yt===null)throw Error(q(160));J4(o,s,i),Yt=null,mi=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(l){dt(i,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)e6(t,e),t=t.sibling}function e6(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(li(t,e),Xi(e),r&4){try{hh(3,e,e.return),Cy(3,e)}catch(g){dt(e,e.return,g)}try{hh(5,e,e.return)}catch(g){dt(e,e.return,g)}}break;case 1:li(t,e),Xi(e),r&512&&n!==null&&lc(n,n.return);break;case 5:if(li(t,e),Xi(e),r&512&&n!==null&&lc(n,n.return),e.flags&32){var i=e.stateNode;try{Th(i,"")}catch(g){dt(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=n!==null?n.memoizedProps:o,a=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&ED(i,o),eb(a,s);var l=eb(a,o);for(s=0;s<u.length;s+=2){var c=u[s],f=u[s+1];c==="style"?CD(i,f):c==="dangerouslySetInnerHTML"?kD(i,f):c==="children"?Th(i,f):l_(i,c,f,l)}switch(a){case"input":Xw(i,o);break;case"textarea":SD(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?vc(i,!!o.multiple,h,!1):d!==!!o.multiple&&(o.defaultValue!=null?vc(i,!!o.multiple,o.defaultValue,!0):vc(i,!!o.multiple,o.multiple?[]:"",!1))}i[Bh]=o}catch(g){dt(e,e.return,g)}}break;case 6:if(li(t,e),Xi(e),r&4){if(e.stateNode===null)throw Error(q(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){dt(e,e.return,g)}}break;case 3:if(li(t,e),Xi(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Dh(t.containerInfo)}catch(g){dt(e,e.return,g)}break;case 4:li(t,e),Xi(e);break;case 13:li(t,e),Xi(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(U_=yt())),r&4&&vM(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(mn=(l=mn)||c,li(t,e),mn=l):li(t,e),Xi(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!c&&e.mode&1)for(ee=e,c=e.child;c!==null;){for(f=ee=c;ee!==null;){switch(d=ee,h=d.child,d.tag){case 0:case 11:case 14:case 15:hh(4,d,d.return);break;case 1:lc(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,n=d.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){dt(r,n,g)}}break;case 5:lc(d,d.return);break;case 22:if(d.memoizedState!==null){wM(f);continue}}h!==null?(h.return=d,ee=h):wM(f)}c=c.sibling}e:for(c=null,f=e;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,l?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=f.stateNode,u=f.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=$D("display",s))}catch(g){dt(e,e.return,g)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(g){dt(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:li(t,e),Xi(e),r&4&&vM(e);break;case 21:break;default:li(t,e),Xi(e)}}function Xi(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Z4(n)){var r=n;break e}n=n.return}throw Error(q(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Th(i,""),r.flags&=-33);var o=yM(e);Mb(e,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=yM(e);Fb(e,a,s);break;default:throw Error(q(161))}}catch(u){dt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function EV(e,t,n){ee=e,t6(e)}function t6(e,t,n){for(var r=(e.mode&1)!==0;ee!==null;){var i=ee,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Lg;if(!s){var a=i.alternate,u=a!==null&&a.memoizedState!==null||mn;a=Lg;var l=mn;if(Lg=s,(mn=u)&&!l)for(ee=i;ee!==null;)s=ee,u=s.child,s.tag===22&&s.memoizedState!==null?bM(i):u!==null?(u.return=s,ee=u):bM(i);for(;o!==null;)ee=o,t6(o),o=o.sibling;ee=i,Lg=a,mn=l}xM(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,ee=o):xM(e)}}function xM(e){for(;ee!==null;){var t=ee;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:mn||Cy(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!mn)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:pi(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&rM(t,o,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}rM(t,s,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Dh(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}mn||t.flags&512&&Ab(t)}catch(d){dt(t,t.return,d)}}if(t===e){ee=null;break}if(n=t.sibling,n!==null){n.return=t.return,ee=n;break}ee=t.return}}function wM(e){for(;ee!==null;){var t=ee;if(t===e){ee=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ee=n;break}ee=t.return}}function bM(e){for(;ee!==null;){var t=ee;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Cy(4,t)}catch(u){dt(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(u){dt(t,i,u)}}var o=t.return;try{Ab(t)}catch(u){dt(t,o,u)}break;case 5:var s=t.return;try{Ab(t)}catch(u){dt(t,s,u)}}}catch(u){dt(t,t.return,u)}if(t===e){ee=null;break}var a=t.sibling;if(a!==null){a.return=t.return,ee=a;break}ee=t.return}}var SV=Math.ceil,M0=Es.ReactCurrentDispatcher,B_=Es.ReactCurrentOwner,Yr=Es.ReactCurrentBatchConfig,Fe=0,Ut=null,bt=null,Jt=0,mr=0,cc=Wa(0),$t=0,Vh=null,Xu=0,Ay=0,j_=0,ph=null,Kn=null,U_=0,Bc=1/0,qo=null,T0=!1,Tb=null,pa=null,zg=!1,Zs=null,N0=0,gh=0,Nb=null,Lm=-1,zm=0;function zn(){return Fe&6?yt():Lm!==-1?Lm:Lm=yt()}function ga(e){return e.mode&1?Fe&2&&Jt!==0?Jt&-Jt:sV.transition!==null?(zm===0&&(zm=ID()),zm):(e=Be,e!==0||(e=window.event,e=e===void 0?16:VD(e.type)),e):1}function Fi(e,t,n,r){if(50<gh)throw gh=0,Nb=null,Error(q(185));$p(e,n,r),(!(Fe&2)||e!==Ut)&&(e===Ut&&(!(Fe&2)&&(Ay|=n),$t===4&&Gs(e,Jt)),ir(e,r),n===1&&Fe===0&&!(t.mode&1)&&(Bc=yt()+500,_y&&qa()))}function ir(e,t){var n=e.callbackNode;sH(e,t);var r=g0(e,e===Ut?Jt:0);if(r===0)n!==null&&MF(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&MF(n),t===1)e.tag===0?oV(EM.bind(null,e)):f4(EM.bind(null,e)),tV(function(){!(Fe&6)&&qa()}),n=null;else{switch(BD(r)){case 1:n=p_;break;case 4:n=LD;break;case 16:n=p0;break;case 536870912:n=zD;break;default:n=p0}n=l6(n,n6.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function n6(e,t){if(Lm=-1,zm=0,Fe&6)throw Error(q(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=g0(e,e===Ut?Jt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=O0(e,r);else{t=r;var i=Fe;Fe|=2;var o=i6();(Ut!==e||Jt!==t)&&(qo=null,Bc=yt()+500,Ru(e,t));do try{$V();break}catch(a){r6(e,a)}while(!0);C_(),M0.current=o,Fe=i,bt!==null?t=0:(Ut=null,Jt=0,t=$t)}if(t!==0){if(t===2&&(i=ob(e),i!==0&&(r=i,t=Ob(e,i))),t===1)throw n=Vh,Ru(e,0),Gs(e,r),ir(e,yt()),n;if(t===6)Gs(e,r);else{if(i=e.current.alternate,!(r&30)&&!_V(i)&&(t=O0(e,r),t===2&&(o=ob(e),o!==0&&(r=o,t=Ob(e,o))),t===1))throw n=Vh,Ru(e,0),Gs(e,r),ir(e,yt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(q(345));case 2:vu(e,Kn,qo);break;case 3:if(Gs(e,r),(r&130023424)===r&&(t=U_+500-yt(),10<t)){if(g0(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){zn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=hb(vu.bind(null,e,Kn,qo),t);break}vu(e,Kn,qo);break;case 4:if(Gs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-Ai(r);o=1<<s,s=t[s],s>i&&(i=s),r&=~o}if(r=i,r=yt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*SV(r/1960))-r,10<r){e.timeoutHandle=hb(vu.bind(null,e,Kn,qo),r);break}vu(e,Kn,qo);break;case 5:vu(e,Kn,qo);break;default:throw Error(q(329))}}}return ir(e,yt()),e.callbackNode===n?n6.bind(null,e):null}function Ob(e,t){var n=ph;return e.current.memoizedState.isDehydrated&&(Ru(e,t).flags|=256),e=O0(e,t),e!==2&&(t=Kn,Kn=n,t!==null&&Rb(t)),e}function Rb(e){Kn===null?Kn=e:Kn.push.apply(Kn,e)}function _V(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Ni(o(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Gs(e,t){for(t&=~j_,t&=~Ay,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ai(t),r=1<<n;e[n]=-1,t&=~r}}function EM(e){if(Fe&6)throw Error(q(327));Sc();var t=g0(e,0);if(!(t&1))return ir(e,yt()),null;var n=O0(e,t);if(e.tag!==0&&n===2){var r=ob(e);r!==0&&(t=r,n=Ob(e,r))}if(n===1)throw n=Vh,Ru(e,0),Gs(e,t),ir(e,yt()),n;if(n===6)throw Error(q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,vu(e,Kn,qo),ir(e,yt()),null}function W_(e,t){var n=Fe;Fe|=1;try{return e(t)}finally{Fe=n,Fe===0&&(Bc=yt()+500,_y&&qa())}}function Qu(e){Zs!==null&&Zs.tag===0&&!(Fe&6)&&Sc();var t=Fe;Fe|=1;var n=Yr.transition,r=Be;try{if(Yr.transition=null,Be=1,e)return e()}finally{Be=r,Yr.transition=n,Fe=t,!(Fe&6)&&qa()}}function q_(){mr=cc.current,Ze(cc)}function Ru(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,eV(n)),bt!==null)for(n=bt.return;n!==null;){var r=n;switch(__(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&w0();break;case 3:zc(),Ze(nr),Ze(kn),O_();break;case 5:N_(r);break;case 4:zc();break;case 13:Ze(ot);break;case 19:Ze(ot);break;case 10:A_(r.type._context);break;case 22:case 23:q_()}n=n.return}if(Ut=e,bt=e=ma(e.current,null),Jt=mr=t,$t=0,Vh=null,j_=Ay=Xu=0,Kn=ph=null,Au!==null){for(t=0;t<Au.length;t++)if(n=Au[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Au=null}return e}function r6(e,t){do{var n=bt;try{if(C_(),Rm.current=F0,A0){for(var r=at.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}A0=!1}if(Yu=0,Rt=St=at=null,dh=!1,Wh=0,B_.current=null,n===null||n.return===null){$t=1,Vh=t,bt=null;break}e:{var o=e,s=n.return,a=n,u=t;if(t=Jt,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=a,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=lM(s);if(h!==null){h.flags&=-257,cM(h,s,a,o,t),h.mode&1&&uM(o,l,t),t=h,u=l;var p=t.updateQueue;if(p===null){var g=new Set;g.add(u),t.updateQueue=g}else p.add(u);break e}else{if(!(t&1)){uM(o,l,t),H_();break e}u=Error(q(426))}}else if(et&&a.mode&1){var y=lM(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),cM(y,s,a,o,t),k_(Ic(u,a));break e}}o=u=Ic(u,a),$t!==4&&($t=2),ph===null?ph=[o]:ph.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var m=B4(o,u,t);nM(o,m);break e;case 1:a=u;var v=o.type,x=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(pa===null||!pa.has(x)))){o.flags|=65536,t&=-t,o.lanes|=t;var w=j4(o,a,t);nM(o,w);break e}}o=o.return}while(o!==null)}s6(n)}catch(b){t=b,bt===n&&n!==null&&(bt=n=n.return);continue}break}while(!0)}function i6(){var e=M0.current;return M0.current=F0,e===null?F0:e}function H_(){($t===0||$t===3||$t===2)&&($t=4),Ut===null||!(Xu&268435455)&&!(Ay&268435455)||Gs(Ut,Jt)}function O0(e,t){var n=Fe;Fe|=2;var r=i6();(Ut!==e||Jt!==t)&&(qo=null,Ru(e,t));do try{kV();break}catch(i){r6(e,i)}while(!0);if(C_(),Fe=n,M0.current=r,bt!==null)throw Error(q(261));return Ut=null,Jt=0,$t}function kV(){for(;bt!==null;)o6(bt)}function $V(){for(;bt!==null&&!Kq();)o6(bt)}function o6(e){var t=u6(e.alternate,e,mr);e.memoizedProps=e.pendingProps,t===null?s6(e):bt=t,B_.current=null}function s6(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=xV(n,t),n!==null){n.flags&=32767,bt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{$t=6,bt=null;return}}else if(n=vV(n,t,mr),n!==null){bt=n;return}if(t=t.sibling,t!==null){bt=t;return}bt=t=e}while(t!==null);$t===0&&($t=5)}function vu(e,t,n){var r=Be,i=Yr.transition;try{Yr.transition=null,Be=1,CV(e,t,n,r)}finally{Yr.transition=i,Be=r}return null}function CV(e,t,n,r){do Sc();while(Zs!==null);if(Fe&6)throw Error(q(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(q(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(aH(e,o),e===Ut&&(bt=Ut=null,Jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zg||(zg=!0,l6(p0,function(){return Sc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Yr.transition,Yr.transition=null;var s=Be;Be=1;var a=Fe;Fe|=4,B_.current=null,bV(e,n),e6(n,e),GH(fb),m0=!!cb,fb=cb=null,e.current=n,EV(n),Zq(),Fe=a,Be=s,Yr.transition=o}else e.current=n;if(zg&&(zg=!1,Zs=e,N0=i),o=e.pendingLanes,o===0&&(pa=null),tH(n.stateNode),ir(e,yt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(T0)throw T0=!1,e=Tb,Tb=null,e;return N0&1&&e.tag!==0&&Sc(),o=e.pendingLanes,o&1?e===Nb?gh++:(gh=0,Nb=e):gh=0,qa(),null}function Sc(){if(Zs!==null){var e=BD(N0),t=Yr.transition,n=Be;try{if(Yr.transition=null,Be=16>e?16:e,Zs===null)var r=!1;else{if(e=Zs,Zs=null,N0=0,Fe&6)throw Error(q(331));var i=Fe;for(Fe|=4,ee=e.current;ee!==null;){var o=ee,s=o.child;if(ee.flags&16){var a=o.deletions;if(a!==null){for(var u=0;u<a.length;u++){var l=a[u];for(ee=l;ee!==null;){var c=ee;switch(c.tag){case 0:case 11:case 15:hh(8,c,o)}var f=c.child;if(f!==null)f.return=c,ee=f;else for(;ee!==null;){c=ee;var d=c.sibling,h=c.return;if(K4(c),c===l){ee=null;break}if(d!==null){d.return=h,ee=d;break}ee=h}}}var p=o.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}ee=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,ee=s;else e:for(;ee!==null;){if(o=ee,o.flags&2048)switch(o.tag){case 0:case 11:case 15:hh(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,ee=m;break e}ee=o.return}}var v=e.current;for(ee=v;ee!==null;){s=ee;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,ee=x;else e:for(s=v;ee!==null;){if(a=ee,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Cy(9,a)}}catch(b){dt(a,a.return,b)}if(a===s){ee=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,ee=w;break e}ee=a.return}}if(Fe=i,qa(),co&&typeof co.onPostCommitFiberRoot=="function")try{co.onPostCommitFiberRoot(xy,e)}catch{}r=!0}return r}finally{Be=n,Yr.transition=t}}return!1}function SM(e,t,n){t=Ic(n,t),t=B4(e,t,1),e=ha(e,t,1),t=zn(),e!==null&&($p(e,1,t),ir(e,t))}function dt(e,t,n){if(e.tag===3)SM(e,e,n);else for(;t!==null;){if(t.tag===3){SM(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(pa===null||!pa.has(r))){e=Ic(n,e),e=j4(t,e,1),t=ha(t,e,1),e=zn(),t!==null&&($p(t,1,e),ir(t,e));break}}t=t.return}}function AV(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=zn(),e.pingedLanes|=e.suspendedLanes&n,Ut===e&&(Jt&n)===n&&($t===4||$t===3&&(Jt&130023424)===Jt&&500>yt()-U_?Ru(e,0):j_|=n),ir(e,t)}function a6(e,t){t===0&&(e.mode&1?(t=Ag,Ag<<=1,!(Ag&130023424)&&(Ag=4194304)):t=1);var n=zn();e=ms(e,t),e!==null&&($p(e,t,n),ir(e,n))}function FV(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),a6(e,n)}function MV(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(t),a6(e,n)}var u6;u6=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||nr.current)er=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return er=!1,yV(e,t,n);er=!!(e.flags&131072)}else er=!1,et&&t.flags&1048576&&d4(t,S0,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Pm(e,t),e=t.pendingProps;var i=Dc(t,kn.current);Ec(t,n),i=D_(null,t,r,e,i,n);var o=P_();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,rr(r)?(o=!0,b0(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,M_(t),i.updater=$y,t.stateNode=i,i._reactInternals=t,wb(t,r,e,n),t=Sb(null,t,r,!0,o,n)):(t.tag=0,et&&o&&S_(t),Tn(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Pm(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=NV(r),e=pi(r,e),i){case 0:t=Eb(null,t,r,e,n);break e;case 1:t=hM(null,t,r,e,n);break e;case 11:t=fM(null,t,r,e,n);break e;case 14:t=dM(null,t,r,pi(r.type,e),n);break e}throw Error(q(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:pi(r,i),Eb(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:pi(r,i),hM(e,t,r,i,n);case 3:e:{if(H4(t),e===null)throw Error(q(387));r=t.pendingProps,o=t.memoizedState,i=o.element,v4(e,t),$0(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=Ic(Error(q(423)),t),t=pM(e,t,r,n,i);break e}else if(r!==i){i=Ic(Error(q(424)),t),t=pM(e,t,r,n,i);break e}else for(wr=da(t.stateNode.containerInfo.firstChild),_r=t,et=!0,xi=null,n=m4(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Pc(),r===i){t=ys(e,t,n);break e}Tn(e,t,r,n)}t=t.child}return t;case 5:return x4(t),e===null&&yb(t),r=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,db(r,i)?s=null:o!==null&&db(r,o)&&(t.flags|=32),q4(e,t),Tn(e,t,s,n),t.child;case 6:return e===null&&yb(t),null;case 13:return V4(e,t,n);case 4:return T_(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Lc(t,null,r,n):Tn(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:pi(r,i),fM(e,t,r,i,n);case 7:return Tn(e,t,t.pendingProps,n),t.child;case 8:return Tn(e,t,t.pendingProps.children,n),t.child;case 12:return Tn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Ge(_0,r._currentValue),r._currentValue=s,o!==null)if(Ni(o.value,s)){if(o.children===i.children&&!nr.current){t=ys(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=os(-1,n&-n),u.tag=2;var l=o.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),vb(o.return,n,t),a.lanes|=n;break}u=u.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(q(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),vb(s,n,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Tn(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ec(t,n),i=Kr(i),r=r(i),t.flags|=1,Tn(e,t,r,n),t.child;case 14:return r=t.type,i=pi(r,t.pendingProps),i=pi(r.type,i),dM(e,t,r,i,n);case 15:return U4(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:pi(r,i),Pm(e,t),t.tag=1,rr(r)?(e=!0,b0(t)):e=!1,Ec(t,n),I4(t,r,i),wb(t,r,i,n),Sb(null,t,r,!0,e,n);case 19:return G4(e,t,n);case 22:return W4(e,t,n)}throw Error(q(156,t.tag))};function l6(e,t){return PD(e,t)}function TV(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wr(e,t,n,r){return new TV(e,t,n,r)}function V_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function NV(e){if(typeof e=="function")return V_(e)?1:0;if(e!=null){if(e=e.$$typeof,e===f_)return 11;if(e===d_)return 14}return 2}function ma(e,t){var n=e.alternate;return n===null?(n=Wr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Im(e,t,n,r,i,o){var s=2;if(r=e,typeof e=="function")V_(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case ec:return Du(n.children,i,o,t);case c_:s=8,i|=8;break;case qw:return e=Wr(12,n,t,i|2),e.elementType=qw,e.lanes=o,e;case Hw:return e=Wr(13,n,t,i),e.elementType=Hw,e.lanes=o,e;case Vw:return e=Wr(19,n,t,i),e.elementType=Vw,e.lanes=o,e;case xD:return Fy(n,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case yD:s=10;break e;case vD:s=9;break e;case f_:s=11;break e;case d_:s=14;break e;case Is:s=16,r=null;break e}throw Error(q(130,e==null?e:typeof e,""))}return t=Wr(s,n,t,i),t.elementType=e,t.type=r,t.lanes=o,t}function Du(e,t,n,r){return e=Wr(7,e,r,t),e.lanes=n,e}function Fy(e,t,n,r){return e=Wr(22,e,r,t),e.elementType=xD,e.lanes=n,e.stateNode={isHidden:!1},e}function h2(e,t,n){return e=Wr(6,e,null,t),e.lanes=n,e}function p2(e,t,n){return t=Wr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function OV(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yx(0),this.expirationTimes=Yx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yx(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function G_(e,t,n,r,i,o,s,a,u){return e=new OV(e,t,n,a,u),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Wr(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},M_(o),e}function RV(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jl,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function c6(e){if(!e)return _a;e=e._reactInternals;e:{if(xl(e)!==e||e.tag!==1)throw Error(q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(rr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(q(171))}if(e.tag===1){var n=e.type;if(rr(n))return c4(e,n,t)}return t}function f6(e,t,n,r,i,o,s,a,u){return e=G_(n,r,!0,e,i,o,s,a,u),e.context=c6(null),n=e.current,r=zn(),i=ga(n),o=os(r,i),o.callback=t??null,ha(n,o,i),e.current.lanes=i,$p(e,i,r),ir(e,r),e}function My(e,t,n,r){var i=t.current,o=zn(),s=ga(i);return n=c6(n),t.context===null?t.context=n:t.pendingContext=n,t=os(o,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ha(i,t,s),e!==null&&(Fi(e,i,s,o),Om(e,i,s)),s}function R0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function _M(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Y_(e,t){_M(e,t),(e=e.alternate)&&_M(e,t)}function DV(){return null}var d6=typeof reportError=="function"?reportError:function(e){console.error(e)};function X_(e){this._internalRoot=e}Ty.prototype.render=X_.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(q(409));My(e,t,null,null)};Ty.prototype.unmount=X_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Qu(function(){My(null,e,null,null)}),t[gs]=null}};function Ty(e){this._internalRoot=e}Ty.prototype.unstable_scheduleHydration=function(e){if(e){var t=WD();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Vs.length&&t!==0&&t<Vs[n].priority;n++);Vs.splice(n,0,e),n===0&&HD(e)}};function Q_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ny(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function kM(){}function PV(e,t,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var l=R0(s);o.call(l)}}var s=f6(t,r,e,0,null,!1,!1,"",kM);return e._reactRootContainer=s,e[gs]=s.current,zh(e.nodeType===8?e.parentNode:e),Qu(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=R0(u);a.call(l)}}var u=G_(e,0,!1,null,null,!1,!1,"",kM);return e._reactRootContainer=u,e[gs]=u.current,zh(e.nodeType===8?e.parentNode:e),Qu(function(){My(t,u,n,r)}),u}function Oy(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var u=R0(s);a.call(u)}}My(t,s,e,i)}else s=PV(n,t,e,i,r);return R0(s)}jD=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Rd(t.pendingLanes);n!==0&&(g_(t,n|1),ir(t,yt()),!(Fe&6)&&(Bc=yt()+500,qa()))}break;case 13:Qu(function(){var r=ms(e,1);if(r!==null){var i=zn();Fi(r,e,1,i)}}),Y_(e,1)}};m_=function(e){if(e.tag===13){var t=ms(e,134217728);if(t!==null){var n=zn();Fi(t,e,134217728,n)}Y_(e,134217728)}};UD=function(e){if(e.tag===13){var t=ga(e),n=ms(e,t);if(n!==null){var r=zn();Fi(n,e,t,r)}Y_(e,t)}};WD=function(){return Be};qD=function(e,t){var n=Be;try{return Be=e,t()}finally{Be=n}};nb=function(e,t,n){switch(t){case"input":if(Xw(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Sy(r);if(!i)throw Error(q(90));bD(r),Xw(r,i)}}}break;case"textarea":SD(e,n);break;case"select":t=n.value,t!=null&&vc(e,!!n.multiple,t,!1)}};MD=W_;TD=Qu;var LV={usingClientEntryPoint:!1,Events:[Ap,ic,Sy,AD,FD,W_]},sd={findFiberByHostInstance:Cu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zV={bundleType:sd.bundleType,version:sd.version,rendererPackageName:sd.rendererPackageName,rendererConfig:sd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Es.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=RD(e),e===null?null:e.stateNode},findFiberByHostInstance:sd.findFiberByHostInstance||DV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ig=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ig.isDisabled&&Ig.supportsFiber)try{xy=Ig.inject(zV),co=Ig}catch{}}Or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LV;Or.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Q_(t))throw Error(q(200));return RV(e,t,null,n)};Or.createRoot=function(e,t){if(!Q_(e))throw Error(q(299));var n=!1,r="",i=d6;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=G_(e,1,!1,null,null,n,!1,r,i),e[gs]=t.current,zh(e.nodeType===8?e.parentNode:e),new X_(t)};Or.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(q(188)):(e=Object.keys(e).join(","),Error(q(268,e)));return e=RD(t),e=e===null?null:e.stateNode,e};Or.flushSync=function(e){return Qu(e)};Or.hydrate=function(e,t,n){if(!Ny(t))throw Error(q(200));return Oy(null,e,t,!0,n)};Or.hydrateRoot=function(e,t,n){if(!Q_(e))throw Error(q(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=d6;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=f6(t,null,e,1,n??null,i,!1,o,s),e[gs]=t.current,zh(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Ty(t)};Or.render=function(e,t,n){if(!Ny(t))throw Error(q(200));return Oy(null,e,t,!1,n)};Or.unmountComponentAtNode=function(e){if(!Ny(e))throw Error(q(40));return e._reactRootContainer?(Qu(function(){Oy(null,null,e,!1,function(){e._reactRootContainer=null,e[gs]=null})}),!0):!1};Or.unstable_batchedUpdates=W_;Or.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ny(n))throw Error(q(200));if(e==null||e._reactInternals===void 0)throw Error(q(38));return Oy(e,t,n,!1,r)};Or.version="18.3.1-next-f1338f8080-20240426";function h6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h6)}catch(e){console.error(e)}}h6(),hD.exports=Or;var IV=hD.exports,$M=IV;Uw.createRoot=$M.createRoot,Uw.hydrateRoot=$M.hydrateRoot;var p6={exports:{}},BV="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",jV=BV,UV=jV;function g6(){}function m6(){}m6.resetWarningCache=g6;var WV=function(){function e(r,i,o,s,a,u){if(u!==UV){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:m6,resetWarningCache:g6};return n.PropTypes=n,n};p6.exports=WV();var qV=p6.exports;const CM=yy(qV),AM={};function Db(e,t){e===void 0&&(e=AM),t===void 0&&(t=AM);const n=Object.keys(e),r=Object.keys(t);return e===t||n.length===r.length&&n.every(i=>e[i]===t[i])}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var HV=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),VV=Object.prototype.hasOwnProperty;function Pb(e,t){return VV.call(e,t)}function Lb(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)Pb(e,i)&&r.push(i);return r}function br(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function zb(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function xu(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function y6(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Ib(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Ib(e[t]))return!0}else if(typeof e=="object"){for(var r=Lb(e),i=r.length,o=0;o<i;o++)if(Ib(e[r[o]]))return!0}}return!1}function FM(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var v6=function(e){HV(t,e);function t(n,r,i,o,s){var a=this.constructor,u=e.call(this,FM(n,{name:r,index:i,operation:o,tree:s}))||this;return u.name=r,u.index=i,u.operation=o,u.tree=s,Object.setPrototypeOf(u,a.prototype),u.message=FM(n,{name:r,index:i,operation:o,tree:s}),u}return t}(Error),ft=v6,GV=br,fc={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=D0(n,this.path);r&&(r=br(r));var i=Pu(n,{op:"remove",path:this.from}).removed;return Pu(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=D0(n,this.from);return Pu(n,{op:"add",path:this.path,value:br(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Gh(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},YV={add:function(e,t,n){return zb(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:fc.move,copy:fc.copy,test:fc.test,_get:fc._get};function D0(e,t){if(t=="")return e;var n={op:"_get",path:t};return Pu(e,n),n.value}function Pu(e,t,n,r,i,o){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):P0(t,0)),t.path===""){var s={newDocument:e};if(t.op==="add")return s.newDocument=t.value,s;if(t.op==="replace")return s.newDocument=t.value,s.removed=e,s;if(t.op==="move"||t.op==="copy")return s.newDocument=D0(e,t.from),t.op==="move"&&(s.removed=e),s;if(t.op==="test"){if(s.test=Gh(e,t.value),s.test===!1)throw new ft("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s.newDocument=e,s}else{if(t.op==="remove")return s.removed=e,s.newDocument=null,s;if(t.op==="_get")return t.value=e,s;if(n)throw new ft("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return s}}else{r||(e=br(e));var a=t.path||"",u=a.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=P0;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=y6(h)),i&&(h=="__proto__"||h=="prototype"&&c>0&&u[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!zb(h))throw new ft("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);zb(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new ft("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var s=YV[t.op].call(t,l,h,e);if(s.test===!1)throw new ft("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}}else if(c>=f){var s=fc[t.op].call(t,l,h,e);if(s.test===!1)throw new ft("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new ft("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function Ry(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new ft("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=br(e));for(var o=new Array(t.length),s=0,a=t.length;s<a;s++)o[s]=Pu(e,t[s],n,!0,i,s),e=o[s].newDocument;return o.newDocument=e,o}function XV(e,t,n){var r=Pu(e,t);if(r.test===!1)throw new ft("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function P0(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new ft("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(fc[e.op]){if(typeof e.path!="string")throw new ft("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new ft('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new ft("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new ft("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Ib(e.value))throw new ft("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new ft("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new ft("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var s={op:"_get",path:e.from,value:void 0},a=x6([s],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new ft("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new ft("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function x6(e,t,n){try{if(!Array.isArray(e))throw new ft("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Ry(br(t),br(e),n||!0);else{n=n||P0;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof ft)return i;throw i}}function Gh(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,o,s;if(n&&r){if(o=e.length,o!=t.length)return!1;for(i=o;i--!==0;)if(!Gh(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var a=Object.keys(e);if(o=a.length,o!==Object.keys(t).length)return!1;for(i=o;i--!==0;)if(!t.hasOwnProperty(a[i]))return!1;for(i=o;i--!==0;)if(s=a[i],!Gh(e[s],t[s]))return!1;return!0}return e!==e&&t!==t}const QV=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:ft,_areEquals:Gh,applyOperation:Pu,applyPatch:Ry,applyReducer:XV,deepClone:GV,getValueByPointer:D0,validate:x6,validator:P0},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var K_=new WeakMap,KV=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),ZV=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function JV(e){return K_.get(e)}function eG(e,t){return e.observers.get(t)}function tG(e,t){e.observers.delete(t.callback)}function nG(e,t){t.unobserve()}function rG(e,t){var n=[],r,i=JV(e);if(!i)i=new KV(e),K_.set(e,i);else{var o=eG(i,t);r=o&&o.observer}if(r)return r;if(r={},i.value=br(e),t){r.callback=t,r.next=null;var s=function(){Bb(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(s)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=n,r.object=e,r.unobserve=function(){Bb(r),clearTimeout(r.next),tG(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new ZV(t,r)),r}function Bb(e,t){t===void 0&&(t=!1);var n=K_.get(e.object);Z_(n.value,e.object,e.patches,"",t),e.patches.length&&Ry(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function Z_(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=Lb(t),s=Lb(e),a=!1,u=s.length-1;u>=0;u--){var l=s[u],c=e[l];if(Pb(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?Z_(c,f,n,r+"/"+xu(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+xu(l),value:br(c)}),n.push({op:"replace",path:r+"/"+xu(l),value:br(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+xu(l),value:br(c)}),n.push({op:"remove",path:r+"/"+xu(l)}),a=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!a&&o.length==s.length))for(var u=0;u<o.length;u++){var l=o[u];!Pb(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+xu(l),value:br(t[l])})}}}function iG(e,t,n){n===void 0&&(n=!1);var r=[];return Z_(e,t,r,"",n),r}const oG=Object.freeze(Object.defineProperty({__proto__:null,compare:iG,generate:Bb,observe:rG,unobserve:nG},Symbol.toStringTag,{value:"Module"}));Object.assign({},QV,oG,{JsonPatchError:v6,deepClone:br,escapePathComponent:xu,unescapePathComponent:y6});var sG=/("(?:[^\\"]|\\.)*")|[:,]/g,aG=function(t,n){var r,i,o;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,o=n.replacer,function s(a,u,l){var c,f,d,h,p,g,y,m,v,x,w,b;if(a&&typeof a.toJSON=="function"&&(a=a.toJSON()),w=JSON.stringify(a,o),w===void 0)return w;if(y=i-u.length-l,w.length<=y&&(v=w.replace(sG,function(S,E){return E||S+" "}),v.length<=y))return v;if(o!=null&&(a=JSON.parse(w),o=void 0),typeof a=="object"&&a!==null){if(m=u+r,d=[],f=0,Array.isArray(a))for(x="[",c="]",y=a.length;f<y;f++)d.push(s(a[f],m,f===y-1?0:1)||"null");else for(x="{",c="}",g=Object.keys(a),y=g.length;f<y;f++)h=g[f],p=JSON.stringify(h)+": ",b=s(a[h],m,p.length+(f===y-1?0:1)),b!==void 0&&d.push(p+b);if(d.length>0)return[x,r+d.join(`,
`+m),c].join(`
`+u)}return w}(t,"",0)};const g2=yy(aG);function hr(e,t,n){return e.fields=t||[],e.fname=n,e}function gt(e){return e==null?null:e.fname}function bn(e){return e==null?null:e.fields}function w6(e){return e.length===1?uG(e[0]):lG(e)}const uG=e=>function(t){return t[e]},lG=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function z(e){throw Error(e)}function Co(e){const t=[],n=e.length;let r=null,i=0,o="",s,a,u;e=e+"";function l(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(u=e[a],u==="\\")o+=e.substring(s,a++),s=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;s===i&&u==='"'||s===i&&u==="'"?(s=a+1,r=u):u==="."&&!i?a>s?l():s=a+1:u==="["?(a>s&&l(),i=s=a+1):u==="]"&&(i||z("Access path missing open bracket: "+e),i>0&&l(),i=0,s=a+1)}return i&&z("Access path missing closing bracket: "+e),r&&z("Access path missing closing quote: "+e),a>s&&(a++,l()),t}function Jr(e,t,n){const r=Co(e);return e=r.length===1?r[0]:e,hr((n&&n.get||w6)(r),[e],t||e)}const Mp=Jr("id"),$n=hr(e=>e,[],"identity"),Ys=hr(()=>0,[],"zero"),Cf=hr(()=>1,[],"one"),ei=hr(()=>!0,[],"true"),Ps=hr(()=>!1,[],"false");function cG(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const b6=0,J_=1,ek=2,E6=3,S6=4;function tk(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cG,r=e||b6;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=J_&&n(t||"error","ERROR",arguments),this},warn(){return r>=ek&&n(t||"warn","WARN",arguments),this},info(){return r>=E6&&n(t||"log","INFO",arguments),this},debug(){return r>=S6&&n(t||"log","DEBUG",arguments),this}}}var I=Array.isArray;function Q(e){return e===Object(e)}const MM=e=>e!=="__proto__";function Af(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((r,i)=>{for(const o in i)if(o==="signals")r.signals=fG(r.signals,i.signals);else{const s=o==="legend"?{layout:1}:o==="style"?!0:null;Ff(r,o,i[o],s)}return r},{})}function Ff(e,t,n,r){if(!MM(t))return;let i,o;if(Q(n)&&!I(n)){o=Q(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?Ff(o,i,n[i]):MM(i)&&(o[i]=n[i])}else e[t]=n}function fG(e,t){if(e==null)return t;const n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function $e(e){return e[e.length-1]}function vn(e){return e==null||e===""?null:+e}const _6=e=>t=>e*Math.exp(t),k6=e=>t=>Math.log(e*t),$6=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),C6=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,L0=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Dy(e,t,n,r){const i=n(e[0]),o=n($e(e)),s=(o-i)*t;return[r(i-s),r(o-s)]}function A6(e,t){return Dy(e,t,vn,$n)}function F6(e,t){var n=Math.sign(e[0]);return Dy(e,t,k6(n),_6(n))}function M6(e,t,n){return Dy(e,t,L0(n),L0(1/n))}function T6(e,t,n){return Dy(e,t,$6(n),C6(n))}function Py(e,t,n,r,i){const o=r(e[0]),s=r($e(e)),a=t!=null?r(t):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function nk(e,t,n){return Py(e,t,n,vn,$n)}function rk(e,t,n){const r=Math.sign(e[0]);return Py(e,t,n,k6(r),_6(r))}function z0(e,t,n,r){return Py(e,t,n,L0(r),L0(1/r))}function ik(e,t,n,r){return Py(e,t,n,$6(r),C6(r))}function N6(e){return 1+~~(new Date(e).getMonth()/3)}function O6(e){return 1+~~(new Date(e).getUTCMonth()/3)}function K(e){return e!=null?I(e)?e:[e]:[]}function R6(e,t,n){let r=e[0],i=e[1],o;return i<r&&(o=i,i=r,r=o),o=i-r,o>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-o),r+o]}function ge(e){return typeof e=="function"}const dG="descending";function ok(e,t,n){n=n||{},t=K(t)||[];const r=[],i=[],o={},s=n.comparator||hG;return K(e).forEach((a,u)=>{a!=null&&(r.push(t[u]===dG?-1:1),i.push(a=ge(a)?a:Jr(a,null,n)),(bn(a)||[]).forEach(l=>o[l]=1))}),i.length===0?null:hr(s(i,r),Object.keys(o))}const Ly=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),hG=(e,t)=>e.length===1?pG(e[0],t[0]):gG(e,t,e.length),pG=(e,t)=>function(n,r){return Ly(e(n),e(r))*t},gG=(e,t,n)=>(t.push(0),function(r,i){let o,s=0,a=-1;for(;s===0&&++a<n;)o=e[a],s=Ly(o(r),o(i));return s*t[a]});function Cn(e){return ge(e)?e:()=>e}function sk(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function pe(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function vo(e,t){let n=0,r,i,o,s;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(o=s=i;n<r;++n)i=e[n],i!=null&&(i<o&&(o=i),i>s&&(s=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(o=s=i;n<r;++n)i=t(e[n]),i!=null&&(i<o&&(o=i),i>s&&(s=i))}return[o,s]}function D6(e,t){const n=e.length;let r=-1,i,o,s,a,u;if(t==null){for(;++r<n;)if(o=e[r],o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=e[r],o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}else{for(;++r<n;)if(o=t(e[r],r,e),o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=t(e[r],r,e),o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}return[a,u]}const mG=Object.prototype.hasOwnProperty;function ae(e,t){return mG.call(e,t)}const Bg={};function Mf(e){let t={},n;function r(o){return ae(t,o)&&t[o]!==Bg}const i={size:0,empty:0,object:t,has:r,get(o){return r(o)?t[o]:void 0},set(o,s){return r(o)||(++i.size,t[o]===Bg&&--i.empty),t[o]=s,this},delete(o){return r(o)&&(--i.size,++i.empty,t[o]=Bg),this},clear(){i.size=i.empty=0,i.object=t={}},test(o){return arguments.length?(n=o,i):n},clean(){const o={};let s=0;for(const a in t){const u=t[a];u!==Bg&&(!n||!n(u))&&(o[a]=u,++s)}i.size=s,i.empty=0,i.object=t=o}};return e&&Object.keys(e).forEach(o=>{i.set(o,e[o])}),i}function P6(e,t,n,r,i,o){if(!n&&n!==0)return o;const s=+n;let a=e[0],u=$e(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=s?r:c<=s?i:o}function G(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),pe(r,n)}function dc(e,t,n,r){let i=t[0],o=t[t.length-1],s;return i>o&&(s=i,i=o,o=s),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=o:e<o)}function Ha(e){return typeof e=="boolean"}function ya(e){return Object.prototype.toString.call(e)==="[object Date]"}function L6(e){return e&&ge(e[Symbol.iterator])}function Ae(e){return typeof e=="number"}function z6(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Z(e){return typeof e=="string"}function ak(e,t,n){e&&(e=t?K(e).map(a=>a.replace(/\\(.)/g,"$1")):K(e));const r=e&&e.length,i=n&&n.get||w6,o=a=>i(t?[a]:Co(a));let s;if(!r)s=function(){return""};else if(r===1){const a=o(e[0]);s=function(u){return""+a(u)}}else{const a=e.map(o);s=function(u){let l=""+a[0](u),c=0;for(;++c<r;)l+="|"+a[c](u);return l}}return hr(s,e,"key")}function I6(e,t){const n=e[0],r=$e(e),i=+t;return i?i===1?r:n+i*(r-n):n}const yG=1e4;function B6(e){e=+e||yG;let t,n,r;const i=()=>{t={},n={},r=0},o=(s,a)=>(++r>e&&(n=t,t={},r=1),t[s]=a);return i(),{clear:i,has:s=>ae(t,s)||ae(n,s),get:s=>ae(t,s)?t[s]:ae(n,s)?o(s,n[s]):void 0,set:(s,a)=>ae(t,s)?t[s]=a:o(s,a)}}function j6(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const s=r||new t.constructor(i+o);let a=0,u=0,l=0;for(;a<i&&u<o;++l)s[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<i;++a,++l)s[l]=t[a];for(;u<o;++u,++l)s[l]=n[u];return s}function Pd(e,t){let n="";for(;--t>=0;)n+=e;return n}function U6(e,t,n,r){const i=n||" ",o=e+"",s=t-o.length;return s<=0?o:r==="left"?Pd(i,s)+o:r==="center"?Pd(i,~~(s/2))+o+Pd(i,Math.ceil(s/2)):o+Pd(i,s)}function Tp(e){return e&&$e(e)-e[0]||0}function V(e){return I(e)?"["+e.map(V)+"]":Q(e)||Z(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function uk(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const vG=e=>Ae(e)||ya(e)?e:Date.parse(e);function lk(e,t){return t=t||vG,e==null||e===""?null:t(e)}function ck(e){return e==null||e===""?null:e+""}function Oi(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function W6(e,t,n,r){const i=r??"",o=e+"",s=o.length,a=Math.max(0,t-i.length);return s<=t?o:n==="left"?i+o.slice(s-a):n==="center"?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function js(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const o=t(e[i]);o&&n(o,i,e)}}else e.forEach(n)}var TM={},m2={},y2=34,ad=10,v2=13;function q6(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function xG(e,t){var n=q6(e);return function(r,i){return t(n(r),i,e)}}function NM(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Yn(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function wG(e){return e<0?"-"+Yn(-e,6):e>9999?"+"+Yn(e,6):Yn(e,4)}function bG(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":wG(e.getUTCFullYear())+"-"+Yn(e.getUTCMonth()+1,2)+"-"+Yn(e.getUTCDate(),2)+(i?"T"+Yn(t,2)+":"+Yn(n,2)+":"+Yn(r,2)+"."+Yn(i,3)+"Z":r?"T"+Yn(t,2)+":"+Yn(n,2)+":"+Yn(r,2)+"Z":n||t?"T"+Yn(t,2)+":"+Yn(n,2)+"Z":"")}function EG(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,g=i(f,function(y,m){if(h)return h(y,m-1);p=y,h=d?xG(y,d):q6(y)});return g.columns=p||[],g}function i(f,d){var h=[],p=f.length,g=0,y=0,m,v=p<=0,x=!1;f.charCodeAt(p-1)===ad&&--p,f.charCodeAt(p-1)===v2&&--p;function w(){if(v)return m2;if(x)return x=!1,TM;var S,E=g,_;if(f.charCodeAt(E)===y2){for(;g++<p&&f.charCodeAt(g)!==y2||f.charCodeAt(++g)===y2;);return(S=g)>=p?v=!0:(_=f.charCodeAt(g++))===ad?x=!0:_===v2&&(x=!0,f.charCodeAt(g)===ad&&++g),f.slice(E+1,S-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(S=g++))===ad)x=!0;else if(_===v2)x=!0,f.charCodeAt(g)===ad&&++g;else if(_!==n)continue;return f.slice(E,S)}return v=!0,f.slice(E,p)}for(;(m=w())!==m2;){for(var b=[];m!==TM&&m!==m2;)b.push(m),m=w();d&&(b=d(b,y++))==null||h.push(b)}return h}function o(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function s(f,d){return d==null&&(d=NM(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function a(f,d){return d==null&&(d=NM(f)),o(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?bG(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:s,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function SG(e){return e}function _G(e){if(e==null)return SG;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*r+o,f[1]=(n+=a[1])*i+s;l<c;)f[l]=a[l],++l;return f}}function kG(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function $G(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return OM(e,n)})}:OM(e,t)}function OM(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,o=H6(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:o}:r==null?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function H6(e,t){var n=_G(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&kG(f,p)}function o(c){return n(c)}function s(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=s(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=s(c.arcs);break;case"MultiLineString":d=c.arcs.map(s);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function CG(e,t){var n={},r={},i={},o=[],s=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++s],t[s]=l,t[c]=d)}),t.forEach(function(l){var c=a(l),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=r[d]){delete r[p.start];var g=p===h?h:h.concat(p);r[g.start=h.start]=i[g.end=p.end]=g}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var y=p===h?h:p.concat(h);r[y.start=p.start]=i[y.end=h.end]=y}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),o.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||o.push([l])}),o}function AG(e){return H6(e,FG.apply(this,arguments))}function FG(e,t,n){var r,i,o;if(arguments.length>1)r=MG(e,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:CG(e,r)}}function MG(e,t,n){var r=[],i=[],o;function s(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:o})}function a(f){f.forEach(s)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}function ss(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function TG(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Tf(e){let t,n,r;e.length!==2?(t=ss,n=(a,u)=>ss(e(a),u),r=(a,u)=>e(a)-u):(t=e===ss||e===TG?e:NG,n=e,r=e);function i(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){const f=i(a,u,l,c-1);return f>l&&r(a[f-1],u)>-r(a[f],u)?f-1:f}return{left:i,center:s,right:o}}function NG(){return 0}function V6(e){return e===null?NaN:+e}function*OG(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const G6=Tf(ss),ka=G6.right,RG=G6.left;Tf(V6).center;function DG(e,t){let n=0,r,i=0,o=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i));else{let s=-1;for(let a of e)(a=t(a,++s,e))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i))}if(n>1)return o/(n-1)}function PG(e,t){const n=DG(e,t);return n&&Math.sqrt(n)}class In{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],s=t+o,a=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);a&&(n[r++]=a),t=s}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,s=0;if(n>0){for(s=t[--n];n>0&&(r=s,i=t[--n],s=r+i,o=i-(s-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=s+i,i==r-s&&(s=r))}return s}}class RM extends Map{constructor(t,n=Q6){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(jb(this,t))}has(t){return super.has(jb(this,t))}set(t,n){return super.set(Y6(this,t),n)}delete(t){return super.delete(X6(this,t))}}class I0 extends Set{constructor(t,n=Q6){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(jb(this,t))}add(t){return super.add(Y6(this,t))}delete(t){return super.delete(X6(this,t))}}function jb({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Y6({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function X6({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function Q6(e){return e!==null&&typeof e=="object"?e.valueOf():e}function LG(e,t){return Array.from(t,n=>e[n])}function zG(e=ss){if(e===ss)return K6;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function K6(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const IG=Math.sqrt(50),BG=Math.sqrt(10),jG=Math.sqrt(2);function B0(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=IG?10:o>=BG?5:o>=jG?2:1;let a,u,l;return i<0?(l=Math.pow(10,-i)/s,a=Math.round(e*l),u=Math.round(t*l),a/l<e&&++a,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*s,a=Math.round(e/l),u=Math.round(t/l),a*l<e&&++a,u*l>t&&--u),u<a&&.5<=n&&n<2?B0(e,t,n*2):[a,u,l]}function Ub(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,o,s]=r?B0(t,e,n):B0(e,t,n);if(!(o>=i))return[];const a=o-i+1,u=new Array(a);if(r)if(s<0)for(let l=0;l<a;++l)u[l]=(o-l)/-s;else for(let l=0;l<a;++l)u[l]=(o-l)*s;else if(s<0)for(let l=0;l<a;++l)u[l]=(i+l)/-s;else for(let l=0;l<a;++l)u[l]=(i+l)*s;return u}function Wb(e,t,n){return t=+t,e=+e,n=+n,B0(e,t,n)[2]}function $a(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?Wb(t,e,n):Wb(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Lu(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function qb(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function Z6(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?K6:zG(i);r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(r,Math.floor(t+(u-l)*f/u+d));Z6(e,t,h,p,i)}const o=e[t];let s=n,a=r;for(ud(e,n,t),i(e[r],o)>0&&ud(e,n,r);s<a;){for(ud(e,s,a),++s,--a;i(e[s],o)<0;)++s;for(;i(e[a],o)>0;)--a}i(e[n],o)===0?ud(e,n,a):(++a,ud(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function ud(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Hb(e,t,n){if(e=Float64Array.from(OG(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return qb(e);if(t>=1)return Lu(e);var r,i=(r-1)*t,o=Math.floor(i),s=Lu(Z6(e,o).subarray(0,o+1)),a=qb(e.subarray(o+1));return s+(a-s)*(i-o)}}function J6(e,t,n=V6){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e),a=+n(e[o+1],o+1,e);return s+(a-s)*(i-o)}}function UG(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function eP(e,t){return Hb(e,.5,t)}function*WG(e){for(const t of e)yield*t}function tP(e){return Array.from(WG(e))}function Er(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function nP(e,t){let n=0;for(let r of e)(r=+r)&&(n+=r);return n}function qG(e,...t){e=new I0(e),t=t.map(HG);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e}function HG(e){return e instanceof I0?e:new I0(e)}function VG(...e){const t=new I0;for(const n of e)for(const r of n)t.add(r);return t}function GG(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function j0(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function jc(e){return e=j0(Math.abs(e)),e?e[1]:NaN}function YG(e,t){return function(n,r){for(var i=n.length,o=[],s=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),o.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}function XG(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var QG=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ku(e){if(!(t=QG.exec(e)))throw new Error("invalid format: "+e);var t;return new fk({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Ku.prototype=fk.prototype;function fk(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}fk.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function KG(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var rP;function ZG(e,t){var n=j0(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(rP=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+j0(e,Math.max(0,t+o-1))[0]}function DM(e,t){var n=j0(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const PM={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:GG,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>DM(e*100,t),r:DM,s:ZG,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function LM(e){return e}var zM=Array.prototype.map,IM=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function iP(e){var t=e.grouping===void 0||e.thousands===void 0?LM:YG(zM.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?LM:XG(zM.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=Ku(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,y=f.zero,m=f.width,v=f.comma,x=f.precision,w=f.trim,b=f.type;b==="n"?(v=!0,b="g"):PM[b]||(x===void 0&&(x=12),w=!0,b="g"),(y||d==="0"&&h==="=")&&(y=!0,d="0",h="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",E=g==="$"?r:/[%p]/.test(b)?s:"",_=PM[b],k=/[defgprs%]/.test(b);x=x===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function $(C){var R=S,A=E,M,F,N;if(b==="c")A=_(C)+A,C="";else{C=+C;var P=C<0||1/C<0;if(C=isNaN(C)?u:_(Math.abs(C),x),w&&(C=KG(C)),P&&+C==0&&p!=="+"&&(P=!1),R=(P?p==="("?p:a:p==="-"||p==="("?"":p)+R,A=(b==="s"?IM[8+rP/3]:"")+A+(P&&p==="("?")":""),k){for(M=-1,F=C.length;++M<F;)if(N=C.charCodeAt(M),48>N||N>57){A=(N===46?i+C.slice(M+1):C.slice(M))+A,C=C.slice(0,M);break}}}v&&!y&&(C=t(C,1/0));var T=R.length+C.length+A.length,O=T<m?new Array(m-T+1).join(d):"";switch(v&&y&&(C=t(O+C,O.length?m-A.length:1/0),O=""),h){case"<":C=R+C+A+O;break;case"=":C=R+O+C+A;break;case"^":C=O.slice(0,T=O.length>>1)+R+C+A+O.slice(T);break;default:C=O+R+C+A;break}return o(C)}return $.toString=function(){return f+""},$}function c(f,d){var h=l((f=Ku(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(jc(d)/3)))*3,g=Math.pow(10,-p),y=IM[8+p/3];return function(m){return h(g*m)+y}}return{format:l,formatPrefix:c}}var jg,zy,dk;JG({thousands:",",grouping:[3],currency:["$",""]});function JG(e){return jg=iP(e),zy=jg.format,dk=jg.formatPrefix,jg}function oP(e){return Math.max(0,-jc(Math.abs(e)))}function sP(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(jc(t)/3)))*3-jc(Math.abs(e)))}function aP(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,jc(t)-jc(e))+1}const x2=new Date,w2=new Date;function Mt(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{const s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=(o,s)=>(t(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,a)=>{const u=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return u;let l;do u.push(l=new Date(+o)),t(o,a),e(o);while(l<o&&o<s);return u},i.filter=o=>Mt(s=>{if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););}),n&&(i.count=(o,s)=>(x2.setTime(+o),w2.setTime(+s),e(x2),e(w2),Math.floor(n(x2,w2))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?s=>r(s)%o===0:s=>i.count(0,s)%o===0):i)),i}const Uc=Mt(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Uc.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Mt(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Uc);Uc.range;const Jo=1e3,qr=Jo*60,es=qr*60,vs=es*24,hk=vs*7,BM=vs*30,b2=vs*365,ts=Mt(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Jo)},(e,t)=>(t-e)/Jo,e=>e.getUTCSeconds());ts.range;const Iy=Mt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Jo)},(e,t)=>{e.setTime(+e+t*qr)},(e,t)=>(t-e)/qr,e=>e.getMinutes());Iy.range;const By=Mt(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*qr)},(e,t)=>(t-e)/qr,e=>e.getUTCMinutes());By.range;const jy=Mt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Jo-e.getMinutes()*qr)},(e,t)=>{e.setTime(+e+t*es)},(e,t)=>(t-e)/es,e=>e.getHours());jy.range;const Uy=Mt(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*es)},(e,t)=>(t-e)/es,e=>e.getUTCHours());Uy.range;const as=Mt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*qr)/vs,e=>e.getDate()-1);as.range;const va=Mt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/vs,e=>e.getUTCDate()-1);va.range;const uP=Mt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/vs,e=>Math.floor(e/vs));uP.range;function wl(e){return Mt(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*qr)/hk)}const Nf=wl(0),U0=wl(1),eY=wl(2),tY=wl(3),Wc=wl(4),nY=wl(5),rY=wl(6);Nf.range;U0.range;eY.range;tY.range;Wc.range;nY.range;rY.range;function bl(e){return Mt(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/hk)}const Of=bl(0),W0=bl(1),iY=bl(2),oY=bl(3),qc=bl(4),sY=bl(5),aY=bl(6);Of.range;W0.range;iY.range;oY.range;qc.range;sY.range;aY.range;const Yh=Mt(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Yh.range;const Xh=Mt(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Xh.range;const xo=Mt(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());xo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Mt(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});xo.range;const wo=Mt(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());wo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Mt(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});wo.range;function lP(e,t,n,r,i,o){const s=[[ts,1,Jo],[ts,5,5*Jo],[ts,15,15*Jo],[ts,30,30*Jo],[o,1,qr],[o,5,5*qr],[o,15,15*qr],[o,30,30*qr],[i,1,es],[i,3,3*es],[i,6,6*es],[i,12,12*es],[r,1,vs],[r,2,2*vs],[n,1,hk],[t,1,BM],[t,3,3*BM],[e,1,b2]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=Tf(([,,y])=>y).right(s,d);if(h===s.length)return e.every($a(l/b2,c/b2,f));if(h===0)return Uc.every(Math.max($a(l,c,f),1));const[p,g]=s[d/s[h-1][2]<s[h][2]/d?h-1:h];return p.every(g)}return[a,u]}const[uY,lY]=lP(wo,Xh,Of,uP,Uy,By),[cY,fY]=lP(xo,Yh,Nf,as,jy,Iy),en="year",ar="quarter",En="month",Ct="week",ur="date",yn="day",bo="dayofyear",Fr="hours",Mr="minutes",ti="seconds",Ri="milliseconds",pk=[en,ar,En,Ct,ur,yn,bo,Fr,Mr,ti,Ri],E2=pk.reduce((e,t,n)=>(e[t]=1+n,e),{});function gk(e){const t=K(e).slice(),n={};return t.length||z("Missing time unit."),t.forEach(i=>{ae(E2,i)?n[i]=1:z(`Invalid time unit: ${i}.`)}),(n[Ct]||n[yn]?1:0)+(n[ar]||n[En]||n[ur]?1:0)+(n[bo]?1:0)>1&&z(`Incompatible time units: ${e}`),t.sort((i,o)=>E2[i]-E2[o]),t}const dY={[en]:"%Y ",[ar]:"Q%q ",[En]:"%b ",[ur]:"%d ",[Ct]:"W%U ",[yn]:"%a ",[bo]:"%j ",[Fr]:"%H:00",[Mr]:"00:%M",[ti]:":%S",[Ri]:".%L",[`${en}-${En}`]:"%Y-%m ",[`${en}-${En}-${ur}`]:"%Y-%m-%d ",[`${Fr}-${Mr}`]:"%H:%M"};function cP(e,t){const n=pe({},dY,t),r=gk(e),i=r.length;let o="",s=0,a,u;for(s=0;s<i;)for(a=r.length;a>s;--a)if(u=r.slice(s,a).join("-"),n[u]!=null){o+=n[u],s=a;break}return o.trim()}const Eu=new Date;function mk(e){return Eu.setFullYear(e),Eu.setMonth(0),Eu.setDate(1),Eu.setHours(0,0,0,0),Eu}function fP(e){return hP(new Date(e))}function dP(e){return Vb(new Date(e))}function hP(e){return as.count(mk(e.getFullYear())-1,e)}function Vb(e){return Nf.count(mk(e.getFullYear())-1,e)}function Gb(e){return mk(e).getDay()}function hY(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(-1,t,n,r,i,o,s);return a.setFullYear(e),a}return new Date(e,t,n,r,i,o,s)}function pP(e){return mP(new Date(e))}function gP(e){return Yb(new Date(e))}function mP(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return va.count(t-1,e)}function Yb(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Of.count(t-1,e)}function Xb(e){return Eu.setTime(Date.UTC(e,0,1)),Eu.getUTCDay()}function pY(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,r,i,o,s));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,r,i,o,s))}function yP(e,t,n,r,i){const o=t||1,s=$e(e),a=(m,v,x)=>(x=x||m,gY(n[x],r[x],m===s&&o,v)),u=new Date,l=Oi(e),c=l[en]?a(en):Cn(2012),f=l[En]?a(En):l[ar]?a(ar):Ys,d=l[Ct]&&l[yn]?a(yn,1,Ct+yn):l[Ct]?a(Ct,1):l[yn]?a(yn,1):l[ur]?a(ur,1):l[bo]?a(bo,1):Cf,h=l[Fr]?a(Fr):Ys,p=l[Mr]?a(Mr):Ys,g=l[ti]?a(ti):Ys,y=l[Ri]?a(Ri):Ys;return function(m){u.setTime(+m);const v=c(u);return i(v,f(u),d(u,v),h(u),p(u),g(u),y(u))}}function gY(e,t,n,r){const i=n<=1?e:r?(o,s)=>r+n*Math.floor((e(o,s)-r)/n):(o,s)=>n*Math.floor(e(o,s)/n);return t?(o,s)=>t(i(o,s),s):i}function Hc(e,t,n){return t+e*7-(n+6)%7}const mY={[en]:e=>e.getFullYear(),[ar]:e=>Math.floor(e.getMonth()/3),[En]:e=>e.getMonth(),[ur]:e=>e.getDate(),[Fr]:e=>e.getHours(),[Mr]:e=>e.getMinutes(),[ti]:e=>e.getSeconds(),[Ri]:e=>e.getMilliseconds(),[bo]:e=>hP(e),[Ct]:e=>Vb(e),[Ct+yn]:(e,t)=>Hc(Vb(e),e.getDay(),Gb(t)),[yn]:(e,t)=>Hc(1,e.getDay(),Gb(t))},yY={[ar]:e=>3*e,[Ct]:(e,t)=>Hc(e,0,Gb(t))};function vP(e,t){return yP(e,t||1,mY,yY,hY)}const vY={[en]:e=>e.getUTCFullYear(),[ar]:e=>Math.floor(e.getUTCMonth()/3),[En]:e=>e.getUTCMonth(),[ur]:e=>e.getUTCDate(),[Fr]:e=>e.getUTCHours(),[Mr]:e=>e.getUTCMinutes(),[ti]:e=>e.getUTCSeconds(),[Ri]:e=>e.getUTCMilliseconds(),[bo]:e=>mP(e),[Ct]:e=>Yb(e),[yn]:(e,t)=>Hc(1,e.getUTCDay(),Xb(t)),[Ct+yn]:(e,t)=>Hc(Yb(e),e.getUTCDay(),Xb(t))},xY={[ar]:e=>3*e,[Ct]:(e,t)=>Hc(e,0,Xb(t))};function xP(e,t){return yP(e,t||1,vY,xY,pY)}const wY={[en]:xo,[ar]:Yh.every(3),[En]:Yh,[Ct]:Nf,[ur]:as,[yn]:as,[bo]:as,[Fr]:jy,[Mr]:Iy,[ti]:ts,[Ri]:Uc},bY={[en]:wo,[ar]:Xh.every(3),[En]:Xh,[Ct]:Of,[ur]:va,[yn]:va,[bo]:va,[Fr]:Uy,[Mr]:By,[ti]:ts,[Ri]:Uc};function Rf(e){return wY[e]}function Df(e){return bY[e]}function wP(e,t,n){return e?e.offset(t,n):void 0}function bP(e,t,n){return wP(Rf(e),t,n)}function EP(e,t,n){return wP(Df(e),t,n)}function SP(e,t,n,r){return e?e.range(t,n,r):void 0}function _P(e,t,n,r){return SP(Rf(e),t,n,r)}function kP(e,t,n,r){return SP(Df(e),t,n,r)}const Ld=1e3,zd=Ld*60,Id=zd*60,Wy=Id*24,EY=Wy*7,jM=Wy*30,Qb=Wy*365,$P=[en,En,ur,Fr,Mr,ti,Ri],Bd=$P.slice(0,-1),jd=Bd.slice(0,-1),Ud=jd.slice(0,-1),SY=Ud.slice(0,-1),_Y=[en,Ct],UM=[en,En],CP=[en],ld=[[Bd,1,Ld],[Bd,5,5*Ld],[Bd,15,15*Ld],[Bd,30,30*Ld],[jd,1,zd],[jd,5,5*zd],[jd,15,15*zd],[jd,30,30*zd],[Ud,1,Id],[Ud,3,3*Id],[Ud,6,6*Id],[Ud,12,12*Id],[SY,1,Wy],[_Y,1,EY],[UM,1,jM],[UM,3,3*jM],[CP,1,Qb]];function AP(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(Tp(t))/n;let i=Tf(a=>a[2]).right(ld,r),o,s;return i===ld.length?(o=CP,s=$a(t[0]/Qb,t[1]/Qb,n)):i?(i=ld[r/ld[i-1][2]<ld[i][2]/r?i-1:i],o=i[0],s=i[1]):(o=$P,s=Math.max($a(t[0],t[1],n),1)),{units:o,step:s}}function S2(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function _2(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function cd(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function FP(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,u=e.shortMonths,l=fd(i),c=dd(i),f=fd(o),d=dd(o),h=fd(s),p=dd(s),g=fd(a),y=dd(a),m=fd(u),v=dd(u),x={a:P,A:T,b:O,B:j,c:null,d:YM,e:YM,f:GY,g:rX,G:oX,H:qY,I:HY,j:VY,L:MP,m:YY,M:XY,p:X,q:re,Q:KM,s:ZM,S:QY,u:KY,U:ZY,V:JY,w:eX,W:tX,x:null,X:null,y:nX,Y:iX,Z:sX,"%":QM},w={a:we,A:he,b:Re,B:Nt,c:null,d:XM,e:XM,f:cX,g:wX,G:EX,H:aX,I:uX,j:lX,L:NP,m:fX,M:dX,p:Dr,q:Ns,Q:KM,s:ZM,S:hX,u:pX,U:gX,V:mX,w:yX,W:vX,x:null,X:null,y:xX,Y:bX,Z:SX,"%":QM},b={a:$,A:C,b:R,B:A,c:M,d:VM,e:VM,f:BY,g:HM,G:qM,H:GM,I:GM,j:PY,L:IY,m:DY,M:LY,p:k,q:RY,Q:UY,s:WY,S:zY,u:FY,U:MY,V:TY,w:AY,W:NY,x:F,X:N,y:HM,Y:qM,Z:OY,"%":jY};x.x=S(n,x),x.X=S(r,x),x.c=S(t,x),w.x=S(n,w),w.X=S(r,w),w.c=S(t,w);function S(J,me){return function(ve){var H=[],Gt=-1,Le=0,sn=J.length,Ot,Yi,Eg;for(ve instanceof Date||(ve=new Date(+ve));++Gt<sn;)J.charCodeAt(Gt)===37&&(H.push(J.slice(Le,Gt)),(Yi=WM[Ot=J.charAt(++Gt)])!=null?Ot=J.charAt(++Gt):Yi=Ot==="e"?" ":"0",(Eg=me[Ot])&&(Ot=Eg(ve,Yi)),H.push(Ot),Le=Gt+1);return H.push(J.slice(Le,Gt)),H.join("")}}function E(J,me){return function(ve){var H=cd(1900,void 0,1),Gt=_(H,J,ve+="",0),Le,sn;if(Gt!=ve.length)return null;if("Q"in H)return new Date(H.Q);if("s"in H)return new Date(H.s*1e3+("L"in H?H.L:0));if(me&&!("Z"in H)&&(H.Z=0),"p"in H&&(H.H=H.H%12+H.p*12),H.m===void 0&&(H.m="q"in H?H.q:0),"V"in H){if(H.V<1||H.V>53)return null;"w"in H||(H.w=1),"Z"in H?(Le=_2(cd(H.y,0,1)),sn=Le.getUTCDay(),Le=sn>4||sn===0?W0.ceil(Le):W0(Le),Le=va.offset(Le,(H.V-1)*7),H.y=Le.getUTCFullYear(),H.m=Le.getUTCMonth(),H.d=Le.getUTCDate()+(H.w+6)%7):(Le=S2(cd(H.y,0,1)),sn=Le.getDay(),Le=sn>4||sn===0?U0.ceil(Le):U0(Le),Le=as.offset(Le,(H.V-1)*7),H.y=Le.getFullYear(),H.m=Le.getMonth(),H.d=Le.getDate()+(H.w+6)%7)}else("W"in H||"U"in H)&&("w"in H||(H.w="u"in H?H.u%7:"W"in H?1:0),sn="Z"in H?_2(cd(H.y,0,1)).getUTCDay():S2(cd(H.y,0,1)).getDay(),H.m=0,H.d="W"in H?(H.w+6)%7+H.W*7-(sn+5)%7:H.w+H.U*7-(sn+6)%7);return"Z"in H?(H.H+=H.Z/100|0,H.M+=H.Z%100,_2(H)):S2(H)}}function _(J,me,ve,H){for(var Gt=0,Le=me.length,sn=ve.length,Ot,Yi;Gt<Le;){if(H>=sn)return-1;if(Ot=me.charCodeAt(Gt++),Ot===37){if(Ot=me.charAt(Gt++),Yi=b[Ot in WM?me.charAt(Gt++):Ot],!Yi||(H=Yi(J,ve,H))<0)return-1}else if(Ot!=ve.charCodeAt(H++))return-1}return H}function k(J,me,ve){var H=l.exec(me.slice(ve));return H?(J.p=c.get(H[0].toLowerCase()),ve+H[0].length):-1}function $(J,me,ve){var H=h.exec(me.slice(ve));return H?(J.w=p.get(H[0].toLowerCase()),ve+H[0].length):-1}function C(J,me,ve){var H=f.exec(me.slice(ve));return H?(J.w=d.get(H[0].toLowerCase()),ve+H[0].length):-1}function R(J,me,ve){var H=m.exec(me.slice(ve));return H?(J.m=v.get(H[0].toLowerCase()),ve+H[0].length):-1}function A(J,me,ve){var H=g.exec(me.slice(ve));return H?(J.m=y.get(H[0].toLowerCase()),ve+H[0].length):-1}function M(J,me,ve){return _(J,t,me,ve)}function F(J,me,ve){return _(J,n,me,ve)}function N(J,me,ve){return _(J,r,me,ve)}function P(J){return s[J.getDay()]}function T(J){return o[J.getDay()]}function O(J){return u[J.getMonth()]}function j(J){return a[J.getMonth()]}function X(J){return i[+(J.getHours()>=12)]}function re(J){return 1+~~(J.getMonth()/3)}function we(J){return s[J.getUTCDay()]}function he(J){return o[J.getUTCDay()]}function Re(J){return u[J.getUTCMonth()]}function Nt(J){return a[J.getUTCMonth()]}function Dr(J){return i[+(J.getUTCHours()>=12)]}function Ns(J){return 1+~~(J.getUTCMonth()/3)}return{format:function(J){var me=S(J+="",x);return me.toString=function(){return J},me},parse:function(J){var me=E(J+="",!1);return me.toString=function(){return J},me},utcFormat:function(J){var me=S(J+="",w);return me.toString=function(){return J},me},utcParse:function(J){var me=E(J+="",!0);return me.toString=function(){return J},me}}}var WM={"-":"",_:" ",0:"0"},Ht=/^\s*\d+/,kY=/^%/,$Y=/[\\^$*+?|[\]().{}]/g;function Ne(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function CY(e){return e.replace($Y,"\\$&")}function fd(e){return new RegExp("^(?:"+e.map(CY).join("|")+")","i")}function dd(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function AY(e,t,n){var r=Ht.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function FY(e,t,n){var r=Ht.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function MY(e,t,n){var r=Ht.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function TY(e,t,n){var r=Ht.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function NY(e,t,n){var r=Ht.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function qM(e,t,n){var r=Ht.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function HM(e,t,n){var r=Ht.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function OY(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function RY(e,t,n){var r=Ht.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function DY(e,t,n){var r=Ht.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function VM(e,t,n){var r=Ht.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function PY(e,t,n){var r=Ht.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function GM(e,t,n){var r=Ht.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function LY(e,t,n){var r=Ht.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function zY(e,t,n){var r=Ht.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function IY(e,t,n){var r=Ht.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function BY(e,t,n){var r=Ht.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function jY(e,t,n){var r=kY.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function UY(e,t,n){var r=Ht.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function WY(e,t,n){var r=Ht.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function YM(e,t){return Ne(e.getDate(),t,2)}function qY(e,t){return Ne(e.getHours(),t,2)}function HY(e,t){return Ne(e.getHours()%12||12,t,2)}function VY(e,t){return Ne(1+as.count(xo(e),e),t,3)}function MP(e,t){return Ne(e.getMilliseconds(),t,3)}function GY(e,t){return MP(e,t)+"000"}function YY(e,t){return Ne(e.getMonth()+1,t,2)}function XY(e,t){return Ne(e.getMinutes(),t,2)}function QY(e,t){return Ne(e.getSeconds(),t,2)}function KY(e){var t=e.getDay();return t===0?7:t}function ZY(e,t){return Ne(Nf.count(xo(e)-1,e),t,2)}function TP(e){var t=e.getDay();return t>=4||t===0?Wc(e):Wc.ceil(e)}function JY(e,t){return e=TP(e),Ne(Wc.count(xo(e),e)+(xo(e).getDay()===4),t,2)}function eX(e){return e.getDay()}function tX(e,t){return Ne(U0.count(xo(e)-1,e),t,2)}function nX(e,t){return Ne(e.getFullYear()%100,t,2)}function rX(e,t){return e=TP(e),Ne(e.getFullYear()%100,t,2)}function iX(e,t){return Ne(e.getFullYear()%1e4,t,4)}function oX(e,t){var n=e.getDay();return e=n>=4||n===0?Wc(e):Wc.ceil(e),Ne(e.getFullYear()%1e4,t,4)}function sX(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ne(t/60|0,"0",2)+Ne(t%60,"0",2)}function XM(e,t){return Ne(e.getUTCDate(),t,2)}function aX(e,t){return Ne(e.getUTCHours(),t,2)}function uX(e,t){return Ne(e.getUTCHours()%12||12,t,2)}function lX(e,t){return Ne(1+va.count(wo(e),e),t,3)}function NP(e,t){return Ne(e.getUTCMilliseconds(),t,3)}function cX(e,t){return NP(e,t)+"000"}function fX(e,t){return Ne(e.getUTCMonth()+1,t,2)}function dX(e,t){return Ne(e.getUTCMinutes(),t,2)}function hX(e,t){return Ne(e.getUTCSeconds(),t,2)}function pX(e){var t=e.getUTCDay();return t===0?7:t}function gX(e,t){return Ne(Of.count(wo(e)-1,e),t,2)}function OP(e){var t=e.getUTCDay();return t>=4||t===0?qc(e):qc.ceil(e)}function mX(e,t){return e=OP(e),Ne(qc.count(wo(e),e)+(wo(e).getUTCDay()===4),t,2)}function yX(e){return e.getUTCDay()}function vX(e,t){return Ne(W0.count(wo(e)-1,e),t,2)}function xX(e,t){return Ne(e.getUTCFullYear()%100,t,2)}function wX(e,t){return e=OP(e),Ne(e.getUTCFullYear()%100,t,2)}function bX(e,t){return Ne(e.getUTCFullYear()%1e4,t,4)}function EX(e,t){var n=e.getUTCDay();return e=n>=4||n===0?qc(e):qc.ceil(e),Ne(e.getUTCFullYear()%1e4,t,4)}function SX(){return"+0000"}function QM(){return"%"}function KM(e){return+e}function ZM(e){return Math.floor(+e/1e3)}var zl,yk,RP,vk,DP;_X({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function _X(e){return zl=FP(e),yk=zl.format,RP=zl.parse,vk=zl.utcFormat,DP=zl.utcParse,zl}function Wd(e){const t={};return n=>t[n]||(t[n]=e(n))}function kX(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=$X(r,i);const s=o<r.length?r.slice(o):"";for(;--o>i;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+s}}function $X(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function PP(e){const t=Wd(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=Ku(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return kX(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,o,s){s=Ku(s??",f");const a=$a(r,i,o),u=Math.max(Math.abs(r),Math.abs(i));let l;if(s.precision==null)switch(s.type){case"s":return isNaN(l=sP(a,u))||(s.precision=l),n(s,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=aP(a,u))||(s.precision=l-(s.type==="e"));break}case"f":case"%":{isNaN(l=oP(a))||(s.precision=l-(s.type==="%")*2);break}}return t(s)}}}let Kb;LP();function LP(){return Kb=PP({format:zy,formatPrefix:dk})}function zP(e){return PP(iP(e))}function q0(e){return arguments.length?Kb=zP(e):Kb}function JM(e,t,n){n=n||{},Q(n)||z(`Invalid time multi-format specifier: ${n}`);const r=t(ti),i=t(Mr),o=t(Fr),s=t(ur),a=t(Ct),u=t(En),l=t(ar),c=t(en),f=e(n[Ri]||".%L"),d=e(n[ti]||":%S"),h=e(n[Mr]||"%I:%M"),p=e(n[Fr]||"%I %p"),g=e(n[ur]||n[yn]||"%a %d"),y=e(n[Ct]||"%b %d"),m=e(n[En]||"%B"),v=e(n[ar]||"%B"),x=e(n[en]||"%Y");return w=>(r(w)<w?f:i(w)<w?d:o(w)<w?h:s(w)<w?p:u(w)<w?a(w)<w?g:y:c(w)<w?l(w)<w?m:v:x)(w)}function IP(e){const t=Wd(e.format),n=Wd(e.utcFormat);return{timeFormat:r=>Z(r)?t(r):JM(t,Rf,r),utcFormat:r=>Z(r)?n(r):JM(n,Df,r),timeParse:Wd(e.parse),utcParse:Wd(e.utcParse)}}let Zb;BP();function BP(){return Zb=IP({format:yk,parse:RP,utcFormat:vk,utcParse:DP})}function jP(e){return IP(FP(e))}function Qh(e){return arguments.length?Zb=jP(e):Zb}const Jb=(e,t)=>pe({},e,t);function UP(e,t){const n=e?zP(e):q0(),r=t?jP(t):Qh();return Jb(n,r)}function xk(e,t){const n=arguments.length;return n&&n!==2&&z("defaultLocale expects either zero or two arguments."),n?Jb(q0(e),Qh(t)):Jb(q0(),Qh())}function CX(){return LP(),BP(),xk()}const AX=/^(data:|([A-Za-z]+:)?\/\/)/,FX=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,MX=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,eT="file://";function TX(e,t){return n=>({options:n||{},sanitize:OX,load:NX,fileAccess:!!t,file:RX(t),http:PX(e)})}async function NX(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function OX(e,t){t=pe({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,s;const a=FX.test(e.replace(MX,""));(e==null||typeof e!="string"||!a)&&z("Sanitize failure, invalid URI: "+V(e));const u=AX.test(e);return(s=t.baseURL)&&!u&&(!e.startsWith("/")&&!s.endsWith("/")&&(e="/"+e),e=s+e),o=(i=e.startsWith(eT))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(eT.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function RX(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,o)=>{i?r(i):n(o)})}):DX}async function DX(){z("No file system access.")}function PX(e){return e?async function(t,n){const r=pe({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?ge(o[i])?o[i]():o.text():z(o.status+""+o.statusText)}:LX}async function LX(){z("No HTTP fetch method available.")}const zX=e=>e!=null&&e===e,IX=e=>e==="true"||e==="false"||e===!0||e===!1,BX=e=>!Number.isNaN(Date.parse(e)),WP=e=>!Number.isNaN(+e)&&!(e instanceof Date),jX=e=>WP(e)&&Number.isInteger(+e),eE={boolean:uk,integer:vn,number:vn,date:lk,string:ck,unknown:$n},Ug=[IX,jX,WP,BX],UX=["boolean","integer","number","date"];function qP(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=Ug.length,i=Ug.map((o,s)=>s+1);for(let o=0,s=0,a,u;o<n;++o)for(u=t?e[o][t]:e[o],a=0;a<r;++a)if(i[a]&&zX(u)&&!Ug[a](u)&&(i[a]=0,++s,s===Ug.length))return"string";return UX[i.reduce((o,s)=>o===0?s:o,0)-1]}function HP(e,t){return t.reduce((n,r)=>(n[r]=qP(e,r),n),{})}function tT(e){const t=function(n,r){const i={delimiter:e};return wk(n,r?pe(r,i):i)};return t.responseType="text",t}function wk(e,t){return t.header&&(e=t.header.map(V).join(t.delimiter)+`
`+e),EG(t.delimiter).parse(e+"")}wk.responseType="text";function WX(e){return typeof Buffer=="function"&&ge(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function bk(e,t){const n=t&&t.property?Jr(t.property):$n;return Q(e)&&!WX(e)?qX(n(e),t):n(JSON.parse(e))}bk.responseType="json";function qX(e,t){return!I(e)&&L6(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const HX={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function VP(e,t){let n,r,i,o;return e=bk(e,t),t&&t.feature?(n=$G,i=t.feature):t&&t.mesh?(n=AG,i=t.mesh,o=HX[t.filter]):z("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):z("Invalid TopoJSON object: "+i),r&&r.features||[r]}VP.responseType="json";const Bm={dsv:wk,csv:tT(","),tsv:tT("	"),json:bk,topojson:VP};function Ek(e,t){return arguments.length>1?(Bm[e]=t,this):ae(Bm,e)?Bm[e]:null}function GP(e){const t=Ek(e);return t&&t.responseType||"text"}function YP(e,t,n,r){t=t||{};const i=Ek(t.type||"json");return i||z("Unknown data format type: "+t.type),e=i(e,t),t.parse&&VX(e,t.parse,n,r),ae(e,"columns")&&delete e.columns,e}function VX(e,t,n,r){if(!e.length)return;const i=Qh();n=n||i.timeParse,r=r||i.utcParse;let o=e.columns||Object.keys(e[0]),s,a,u,l,c,f;t==="auto"&&(t=HP(e,o)),o=Object.keys(t);const d=o.map(h=>{const p=t[h];let g,y;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),y=g[1],(y[0]==="'"&&y[y.length-1]==="'"||y[0]==='"'&&y[y.length-1]==='"')&&(y=y.slice(1,-1)),(g[0]==="utc"?r:n)(y);if(!eE[p])throw Error("Illegal format pattern: "+h+":"+p);return eE[p]});for(u=0,c=e.length,f=o.length;u<c;++u)for(s=e[u],l=0;l<f;++l)a=o[l],s[a]=d[l](s[a])}const qy=TX(typeof fetch<"u"&&fetch,null);function Hy(e){const t=e||$n,n=[],r={};return n.add=i=>{const o=t(i);return r[o]||(r[o]=1,n.push(i)),n},n.remove=i=>{const o=t(i);if(r[o]){r[o]=0;const s=n.indexOf(i);s>=0&&n.splice(s,1)}return n},n}async function jm(e,t){try{await t(e)}catch(n){e.error(n)}}const XP=Symbol("vega_id");let GX=1;function Vy(e){return!!(e&&oe(e))}function oe(e){return e[XP]}function QP(e,t){return e[XP]=t,e}function De(e){const t=e===Object(e)?e:{data:e};return oe(t)?t:QP(t,GX++)}function Sk(e){return Gy(e,De({}))}function Gy(e,t){for(const n in e)t[n]=e[n];return t}function KP(e,t){return QP(t,oe(e))}function El(e,t){return e?t?(n,r)=>e(n,r)||oe(t(n))-oe(t(r)):(n,r)=>e(n,r)||oe(n)-oe(r):null}function ZP(e){return e&&e.constructor===Sl}function Sl(){const e=[],t=[],n=[],r=[],i=[];let o=null,s=!1;return{constructor:Sl,insert(a){const u=K(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){const u=ge(a)?r:t,l=K(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){const c={field:u,value:Cn(l)};return ge(a)?(c.filter=a,i.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return ge(a)?i.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return o=a,this},reflow(){return s=!0,this},pulse(a,u){const l={},c={};let f,d,h,p,g,y;for(f=0,d=u.length;f<d;++f)l[oe(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[oe(g)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],u.forEach(v=>{p(v)&&(l[oe(v)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],y=oe(g),l[y]?l[y]=1:a.add.push(De(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[oe(g)]<0&&a.rem.push(g);function m(v,x,w){w?v[x]=w(v):a.encode=x,s||(c[oe(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,y=l[oe(g)],y>0&&(m(g,p,h.value),a.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,u.forEach(v=>{p(v)&&l[oe(v)]>0&&m(v,h.field,h.value)}),a.modifies(h.field);if(s)a.mod=t.length||r.length?u.filter(v=>l[oe(v)]>0):u.slice();else for(y in c)a.mod.push(c[y]);return(o||o==null&&(t.length||r.length))&&a.clean(!0),a}}}const Um="_:mod:_";function Yy(){Object.defineProperty(this,Um,{writable:!0,value:{}})}Yy.prototype={set(e,t,n,r){const i=this,o=i[e],s=i[Um];return t!=null&&t>=0?(o[t]!==n||r)&&(o[t]=n,s[t+":"+e]=-1,s[e]=-1):(o!==n||r)&&(i[e]=n,s[e]=I(n)?1+n.length:-1),i},modified(e,t){const n=this[Um];if(arguments.length){if(I(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Um]={},this}};let YX=0;const XX="pulse",QX=new Yy,KX=1,ZX=2;function He(e,t,n,r){this.id=++YX,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function nT(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}He.prototype={targets(){return this._targets||(this._targets=Hy(Mp))},set(e){return this.value!==e?(this.value=e,1):0},skip:nT(KX),modified:nT(ZX),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new Yy,i=this._argops=this._argops||[],o=[];let s,a,u,l;const c=(f,d,h)=>{h instanceof He?(h!==this&&(t&&h.targets().add(this),o.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(s in e)if(a=e[s],s===XX)K(a).forEach(f=>{f instanceof He?f!==this&&(f.targets().add(this),o.push(f)):z("Pulse parameters must be operator instances.")}),this.source=a;else if(I(a))for(r.set(s,-1,Array(u=a.length)),l=0;l<u;++l)c(s,l,a[l]);else c(s,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){const t=this._argval||QX,n=this._argops;let r,i,o,s;if(n){const a=n.length;for(i=0;i<a;++i)r=n[i],o=r.op,s=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,s);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function JX(e,t,n,r){let i=1,o;return e instanceof He?o=e:e&&e.prototype instanceof He?o=new e:ge(e)?o=new He(null,e):(i=0,o=new He(e,t)),this.rank(o),i&&(r=n,n=t),n&&this.connect(o,o.parameters(n,r)),this.touch(o),o}function eQ(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let tQ=0;function Xy(e,t,n){this.id=++tQ,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Ls(e,t,n){return new Xy(e,t,n)}Xy.prototype={_filter:ei,_apply:$n,targets(){return this._targets||(this._targets=Hy(Mp))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Ls(e);return this.targets().add(t),t},apply(e){const t=Ls(null,e);return this.targets().add(t),t},merge(){const e=Ls();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Ls();return this.targets().add(Ls(null,null,sk(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(Ls(null,null,()=>n=!0)),t.targets().add(Ls(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=ei,this._targets=null}};function nQ(e,t,n,r){const i=this,o=Ls(n,r),s=function(l){l.dataflow=i;try{o.receive(l)}catch(c){i.error(c)}finally{i.run()}};let a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=K(e);const u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,s);return o}function rQ(e,t){const n=this.locale();return YP(e,t,n.timeParse,n.utcParse)}function iQ(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function oQ(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:GP(t&&t.type)});try{i=n.parse(i,t)}catch(o){r=-2,n.warn("Data ingestion failed",e,o)}}catch(o){r=-1,n.warn("Loading failed",e,o)}return{data:i,status:r}}async function sQ(e,t,n){const r=this,i=r._pending||aQ(r);i.requests+=1;const o=await r.request(t,n);return r.pulse(e,r.changeset().remove(ei).insert(o.data||[])),i.done(),o}function aQ(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const uQ={skip:!0};function lQ(e,t,n,r,i){return(e instanceof He?fQ:cQ)(this,e,t,n,r,i),this}function cQ(e,t,n,r,i,o){const s=pe({},o,uQ);let a,u;ge(n)||(n=Cn(n)),r===void 0?a=l=>e.touch(n(l)):ge(r)?(u=new He(null,r,i,!1),a=l=>{u.evaluate(l);const c=n(l),f=u.value;ZP(f)?e.pulse(c,f,o):e.update(c,f,s)}):a=l=>e.update(n(l),r,s),t.apply(a)}function fQ(e,t,n,r,i,o){if(r===void 0)t.targets().add(n);else{const s=o||{},a=new He(null,dQ(n,r),i,!1);a.modified(s.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function dQ(e,t){return t=ge(t)?t:Cn(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function hQ(e){e.rank=++this._rank}function pQ(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&z("Cycle detected in dataflow graph.")}const H0={},to=1,Us=2,Ho=4,gQ=to|Us,rT=to|Ho,Il=to|Us|Ho,iT=8,hd=16,oT=32,sT=64;function xa(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function k2(e,t){const n=[];return js(e,t,r=>n.push(r)),n}function aT(e,t){const n={};return e.visit(t,r=>{n[oe(r)]=1}),r=>n[oe(r)]?null:r}function Wg(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}xa.prototype={StopPropagation:H0,ADD:to,REM:Us,MOD:Ho,ADD_REM:gQ,ADD_MOD:rT,ALL:Il,REFLOW:iT,SOURCE:hd,NO_SOURCE:oT,NO_FIELDS:sT,fork(e){return new xa(this.dataflow).init(this,e)},clone(){const e=this.fork(Il);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Il|hd)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new xa(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&sT)&&(n.fields=e.fields),t&to?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Us?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Ho?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&oT?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Il;return t&to&&this.add.length||t&Us&&this.rem.length||t&Ho&&this.mod.length},reflow(e){if(e)return this.fork(Il).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Ho,aT(this,to))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return I(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?I(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&to&&(n.addF=Wg(n.addF,t)),e&Us&&(n.remF=Wg(n.remF,t)),e&Ho&&(n.modF=Wg(n.modF,t)),e&hd&&(n.srcF=Wg(n.srcF,t)),n},materialize(e){e=e||Il;const t=this;return e&to&&t.addF&&(t.add=k2(t.add,t.addF),t.addF=null),e&Us&&t.remF&&(t.rem=k2(t.rem,t.remF),t.remF=null),e&Ho&&t.modF&&(t.mod=k2(t.mod,t.modF),t.modF=null),e&hd&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&hd)return js(n.source,n.srcF,r),n;e&to&&js(n.add,n.addF,r),e&Us&&js(n.rem,n.remF,r),e&Ho&&js(n.mod,n.modF,r);const i=n.source;if(e&iT&&i){const o=n.add.length+n.mod.length;o===i.length||(o?js(i,aT(n,rT),r):js(i,n.srcF,r))}return n}};function _k(e,t,n,r){const i=this;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const s of n)if(s.stamp===t){if(s.fields){const a=i.fields||(i.fields={});for(const u in s.fields)a[u]=1}s.changed(i.ADD)&&(o|=i.ADD),s.changed(i.REM)&&(o|=i.REM),s.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}G(_k,xa,{fork(e){const t=new xa(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?I(e)?e.some(r=>n[r]):n[e]:0},filter(){z("MultiPulse does not support filtering.")},materialize(){z("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});async function mQ(e,t,n){const r=this,i=[];if(r._pulse)return JP(r);if(r._pending&&await r._pending,t&&await jm(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new xa(r,o,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=Hy(Mp);let s=0,a,u,l;try{for(;r._heap.size()>0;){if(a=r._heap.pop(),a.rank!==a.qrank){r._enqueue(a,!0);continue}u=a.run(r._getPulse(a,e)),u.then?u=await u:u.async&&(i.push(u.async),u=H0),u!==H0&&a._targets&&a._targets.forEach(c=>r._enqueue(c)),++s}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${s} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await jm(r,c[f].callback)}return n&&await jm(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function yQ(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function vQ(e,t,n){return this._pulse?JP(this):(this.evaluate(e,t,n),this)}function xQ(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function JP(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function wQ(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function bQ(e,t){const n=e.source,r=this._clock;return n&&I(n)?new _k(this,r,n.map(i=>i.pulse),t):this._input[e.id]||EQ(this._pulse,n&&n.pulse)}function EQ(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==H0&&(e.source=t.source),e)}const kk={skip:!1,force:!1};function SQ(e,t){const n=t||kk;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function _Q(e,t,n){const r=n||kk;return(e.set(t)||r.force)&&this.touch(e,r),this}function kQ(e,t,n){this.touch(e,n||kk);const r=new xa(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function $Q(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),eL(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,CQ(t,0,e)):r=n,r}}}function eL(e,t,n,r){let i,o;const s=e[n];for(;n>t;){if(o=n-1>>1,i=e[o],r(s,i)<0){e[n]=i,n=o;continue}break}return e[n]=s}function CQ(e,t,n){const r=t,i=e.length,o=e[t];let s=(t<<1)+1,a;for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],t=s,s=(t<<1)+1;return e[t]=o,eL(e,r,t,n)}function _c(){this.logger(tk()),this.logLevel(J_),this._clock=0,this._rank=0,this._locale=xk();try{this._loader=qy()}catch{}this._touched=Hy(Mp),this._input={},this._pulse=null,this._heap=$Q((e,t)=>e.qrank-t.qrank),this._postrun=[]}function pd(e){return function(){return this._log[e].apply(this,arguments)}}_c.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:pd("error"),warn:pd("warn"),info:pd("info"),debug:pd("debug"),logLevel:pd("level"),cleanThreshold:1e4,add:JX,connect:eQ,rank:hQ,rerank:pQ,pulse:kQ,touch:SQ,update:_Q,changeset:Sl,ingest:iQ,parse:rQ,preload:sQ,request:oQ,events:nQ,on:lQ,evaluate:mQ,run:vQ,runAsync:yQ,runAfter:xQ,_enqueue:wQ,_getPulse:bQ};function D(e,t){He.call(this,e,null,t)}G(D,He,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Vc={};function tL(e){const t=nL(e);return t&&t.Definition||null}function nL(e){return e=e&&e.toLowerCase(),ae(Vc,e)?Vc[e]:null}function*rL(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function $k(e,t,n){const r=Float64Array.from(rL(e,n));return r.sort(ss),t.map(i=>J6(r,i))}function Ck(e,t){return $k(e,[.25,.5,.75],t)}function Ak(e,t){const n=e.length,r=PG(e,t),i=Ck(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function iL(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o=e.extent[0],s=e.extent[1],a,u,l,c,f,d;const h=e.span||s-o||Math.abs(o)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/a)>t;)a*=n;for(f=0,d=i.length;f<d;++f)c=a/i[f],c>=l&&h/c<=t&&(a=c)}c=Math.log(a);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/a+g)*a,o=o<c?c-a:c,s=Math.ceil(s/a)*a),{start:o,stop:s===o?o+a:s,step:a}}var ni=Math.random;function AQ(e){ni=e}function oL(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(rL(e,r)),o=i.length,s=t;let a,u,l,c;for(l=0,c=Array(s);l<s;++l){for(a=0,u=0;u<o;++u)a+=i[~~(ni()*o)];c[l]=a/o}return c.sort(ss),[Hb(c,n/2),Hb(c,1-n/2)]}function sL(e,t,n,r){r=r||(d=>d);const i=e.length,o=new Float64Array(i);let s=0,a=1,u=r(e[0]),l=u,c=u+t,f;for(;a<i;++a){if(f=r(e[a]),f>=c){for(l=(u+l)/2;s<a;++s)o[s]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;s<a;++s)o[s]=l;return n?FQ(o,t+t/4):o}function FQ(e,t){const n=e.length;let r=0,i=1,o,s;for(;e[r]===e[i];)++i;for(;i<n;){for(o=i+1;e[i]===e[o];)++o;if(e[i]-e[i-1]<t){for(s=i+(r+o-i-i>>1);s<i;)e[s++]=e[i];for(;s>i;)e[s--]=e[r]}r=i,i=o}return e}function MQ(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function TQ(e,t){t==null&&(t=e,e=0);let n,r,i;const o={min(s){return arguments.length?(n=s||0,i=r-n,o):n},max(s){return arguments.length?(r=s||0,i=r-n,o):r},sample(){return n+Math.floor(i*ni())},pdf(s){return s===Math.floor(s)&&s>=n&&s<r?1/i:0},cdf(s){const a=Math.floor(s);return a<n?0:a>=r?1:(a-n+1)/i},icdf(s){return s>=0&&s<=1?n-1+Math.floor(s*i):NaN}};return o.min(e).max(t)}const aL=Math.sqrt(2*Math.PI),NQ=Math.SQRT2;let gd=NaN;function Qy(e,t){e=e||0,t=t??1;let n=0,r=0,i,o;if(gd===gd)n=gd,gd=NaN;else{do n=ni()*2-1,r=ni()*2-1,i=n*n+r*r;while(i===0||i>1);o=Math.sqrt(-2*Math.log(i)/i),n*=o,gd=r*o}return e+n*t}function Fk(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*aL)}function Ky(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let o;if(i>37)o=0;else{const s=Math.exp(-i*i/2);let a;i<7.07106781186547?(a=.0352624965998911*i+.700383064443688,a=a*i+6.37396220353165,a=a*i+33.912866078383,a=a*i+112.079291497871,a=a*i+221.213596169931,a=a*i+220.206867912376,o=s*a,a=.0883883476483184*i+1.75566716318264,a=a*i+16.064177579207,a=a*i+86.7807322029461,a=a*i+296.564248779674,a=a*i+637.333633378831,a=a*i+793.826512519948,a=a*i+440.413735824752,o=o/a):(a=i+.65,a=i+4/a,a=i+3/a,a=i+2/a,a=i+1/a,o=s/a/2.506628274631)}return r>0?1-o:o}function Zy(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*NQ*OQ(2*e-1)}function OQ(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function Mk(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>Qy(n,r),pdf:o=>Fk(o,n,r),cdf:o=>Ky(o,n,r),icdf:o=>Zy(o,n,r)};return i.mean(e).stdev(t)}function Tk(e,t){const n=Mk();let r=0;const i={data(o){return arguments.length?(e=o,r=o?o.length:0,i.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=Ak(e)),i):t},sample(){return e[~~(ni()*r)]+t*n.sample()},pdf(o){let s=0,a=0;for(;a<r;++a)s+=n.pdf((o-e[a])/t);return s/t/r},cdf(o){let s=0,a=0;for(;a<r;++a)s+=n.cdf((o-e[a])/t);return s/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function Nk(e,t){return e=e||0,t=t??1,Math.exp(e+Qy()*t)}function Ok(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*aL*e)}function Rk(e,t,n){return Ky(Math.log(e),t,n)}function Dk(e,t,n){return Math.exp(Zy(e,t,n))}function uL(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>Nk(n,r),pdf:o=>Ok(o,n,r),cdf:o=>Rk(o,n,r),icdf:o=>Dk(o,n,r)};return i.mean(e).stdev(t)}function lL(e,t){let n=0,r;function i(s){const a=[];let u=0,l;for(l=0;l<n;++l)u+=a[l]=s[l]==null?1:+s[l];for(l=0;l<n;++l)a[l]/=u;return a}const o={weights(s){return arguments.length?(r=i(t=s||[]),o):t},distributions(s){return arguments.length?(s?(n=s.length,e=s):(n=0,e=[]),o.weights(t)):e},sample(){const s=ni();let a=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(s<u){a=e[l];break}return a.sample()},pdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].pdf(s);return a},cdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].cdf(s);return a},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function Pk(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*ni()}function Lk(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function zk(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Ik(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function cL(e,t){let n,r;const i={min(o){return arguments.length?(n=o||0,i):n},max(o){return arguments.length?(r=o??1,i):r},sample:()=>Pk(n,r),pdf:o=>Lk(o,n,r),cdf:o=>zk(o,n,r),icdf:o=>Ik(o,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function Bk(e,t,n){let r=0,i=0;for(const o of e){const s=n(o);t(o)==null||s==null||isNaN(s)||(r+=(s-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function Np(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function Jy(e,t,n,r){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,o=new Float64Array(i),s=new Float64Array(i);let a=0,u=0,l=0,c,f,d;for(d of e)o[a]=c=+t(d),s[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<i;++a)o[a]-=u,s[a]-=l;return[o,s,u,l]}function Op(e,t,n,r){let i=-1,o,s;for(const a of e)o=t(a),s=n(a),o!=null&&(o=+o)>=o&&s!=null&&(s=+s)>=s&&r(o,s,++i)}function Pf(e,t,n,r,i){let o=0,s=0;return Op(e,t,n,(a,u)=>{const l=u-i(a),c=u-r;o+=l*l,s+=c*c}),1-o/s}function jk(e,t,n){let r=0,i=0,o=0,s=0,a=0;Op(e,t,n,(c,f)=>{++a,r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const u=Np(r,i,o,s),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Pf(e,t,n,i,l)}}function fL(e,t,n){let r=0,i=0,o=0,s=0,a=0;Op(e,t,n,(c,f)=>{++a,c=Math.log(c),r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const u=Np(r,i,o,s),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Pf(e,t,n,i,l)}}function dL(e,t,n){const[r,i,o,s]=Jy(e,t,n);let a=0,u=0,l=0,c=0,f=0,d,h,p;Op(e,t,n,(v,x)=>{d=r[f++],h=Math.log(x),p=d*x,a+=(x*h-a)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,y]=Np(u/s,a/s,l/s,c/s),m=v=>Math.exp(g+y*(v-o));return{coef:[Math.exp(g-y*o),y],predict:m,rSquared:Pf(e,t,n,s,m)}}function hL(e,t,n){let r=0,i=0,o=0,s=0,a=0,u=0;Op(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,r+=(h-r)/u,i+=(p-i)/u,o+=(h*p-o)/u,s+=(h*h-s)/u,a+=(d-a)/u});const l=Np(r,i,o,s),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Pf(e,t,n,a,c)}}function Uk(e,t,n){const[r,i,o,s]=Jy(e,t,n),a=r.length;let u=0,l=0,c=0,f=0,d=0,h,p,g,y;for(h=0;h<a;)p=r[h],g=i[h++],y=p*p,u+=(y-u)/h,l+=(y*p-l)/h,c+=(y*y-c)/h,f+=(p*g-f)/h,d+=(y*g-d)/h;const m=c-u*u,v=u*m-l*l,x=(d*u-f*l)/v,w=(f*m-d*l)/v,b=-x*u,S=E=>(E=E-o,x*E*E+w*E+b+s);return{coef:[b-w*o+x*o*o+s,w-2*x*o,x],predict:S,rSquared:Pf(e,t,n,s,S)}}function pL(e,t,n,r){if(r===0)return Bk(e,t,n);if(r===1)return jk(e,t,n);if(r===2)return Uk(e,t,n);const[i,o,s,a]=Jy(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,g,y;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d)*o[p];for(l.push(g),y=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d+h);y[h]=g}c.push(y)}c.push(l);const m=DQ(c),v=x=>{x-=s;let w=a+m[0]+m[1]*x+m[2]*x*x;for(d=3;d<f;++d)w+=m[d]*Math.pow(x,d);return w};return{coef:RQ(f,m,-s,a),predict:v,rSquared:Pf(e,t,n,a,v)}}function RQ(e,t,n,r){const i=Array(e);let o,s,a,u;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(a=t[o],u=1,i[o]+=a,s=1;s<=o;++s)u*=(o+1-s)/s,i[o-s]+=a*Math.pow(n,s)*u;return i[0]+=r,i}function DQ(e){const t=e.length-1,n=[];let r,i,o,s,a;for(r=0;r<t;++r){for(s=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][s])&&(s=i);for(o=r;o<t+1;++o)a=e[o][r],e[o][r]=e[o][s],e[o][s]=a;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(a=0,o=i+1;o<t;++o)a+=e[o][i]*n[o];n[i]=(e[t][i]-a)/e[i][i]}return n}const uT=2,lT=1e-12;function gL(e,t,n,r){const[i,o,s,a]=Jy(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=uT;){const p=[0,l-1];for(let y=0;y<u;++y){const m=i[y],v=p[0],x=p[1],w=m-i[v]>i[x]-m?v:x;let b=0,S=0,E=0,_=0,k=0;const $=1/Math.abs(i[w]-m||1);for(let A=v;A<=x;++A){const M=i[A],F=o[A],N=PQ(Math.abs(m-M)*$)*d[A],P=M*N;b+=N,S+=P,E+=F*N,_+=F*P,k+=M*P}const[C,R]=Np(S/b,E/b,_/b,k/b);c[y]=C+R*m,f[y]=Math.abs(o[y]-c[y]),LQ(i,y+1,p)}if(h===uT)break;const g=eP(f);if(Math.abs(g)<lT)break;for(let y=0,m,v;y<u;++y)m=f[y]/(6*g),d[y]=m>=1?lT:(v=1-m*m)*v}return zQ(i,c,s,a)}function PQ(e){return(e=1-e*e*e)*e*e}function LQ(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}function zQ(e,t,n,r){const i=e.length,o=[];let s=0,a=0,u=[],l;for(;s<i;++s)l=e[s]+n,u[0]===l?u[1]+=(t[s]-u[1])/++a:(a=0,u[1]+=r,u=[l,t[s]],o.push(u));return u[1]+=r,o}const IQ=.5*Math.PI/180;function ev(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=g=>[g,e(g)],o=t[0],s=t[1],a=s-o,u=a/r,l=[i(o)],c=[];if(n===r){for(let g=1;g<r;++g)l.push(i(o+g/n*a));return l.push(i(s)),l}else{c.push(i(s));for(let g=n;--g>0;)c.push(i(o+g/n*a))}let f=l[0],d=c[c.length-1];const h=1/a,p=BQ(f[1],c);for(;d;){const g=i((f[0]+d[0])/2);g[0]-f[0]>=u&&jQ(f,g,d,h,p)>IQ?c.push(g):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function BQ(e,t){let n=e,r=e;const i=t.length;for(let o=0;o<i;++o){const s=t[o][1];s<n&&(n=s),s>r&&(r=s)}return 1/(r-n)}function jQ(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),s=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-s)}function UQ(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function tE(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:UQ(e)}function mL(e,t,n){return n||e+(t?"_"+t:"")}const $2=()=>{},WQ={init:$2,add:$2,rem:$2,idx:0},Kh={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},Rp=Object.keys(Kh).filter(e=>e!=="__count__");function qQ(e,t){return(n,r)=>pe({name:e,aggregate_param:r,out:n||e},WQ,t)}[...Rp,"__count__"].forEach(e=>{Kh[e]=qQ(e,Kh[e])});function yL(e,t,n){return Kh[e](n,t)}function vL(e,t){return e.idx-t.idx}function HQ(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{r.req&&r.req.forEach(i=>{t[i]||n(t[i]=Kh[i]())})};return e.forEach(n),Object.values(t).sort(vL)}function VQ(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.aggregate_param==null?e.init(this):e.init(this,e.aggregate_param))}function GQ(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function YQ(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function XQ(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function xL(e,t){const n=t||$n,r=HQ(e),i=e.slice().sort(vL);function o(s){this._ops=r,this._out=i,this.cell=s,this.init()}return o.prototype.init=VQ,o.prototype.add=GQ,o.prototype.rem=YQ,o.prototype.set=XQ,o.prototype.get=n,o.fields=e.map(s=>s.out),o}function Wk(e){this._key=e?Jr(e):oe,this.reset()}const on=Wk.prototype;on.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};on.add=function(e){this._add.push(e)};on.rem=function(e){this._rem.push(e)};on.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),s={};let a,u,l;for(a=0;a<i;++a)s[n(t[a])]=1;for(a=0,u=0;a<r;++a)s[n(l=e[a])]?s[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o};on.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,o;for(;--r>=0;)o=e(t[r])+"",ae(n,o)||(n[o]=1,++i);return i};on.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=D6(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};on.argmin=function(e){return this.extent(e)[0]||{}};on.argmax=function(e){return this.extent(e)[1]||{}};on.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};on.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};on.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Ck(this.values(),e),this._get=e),this._q};on.q1=function(e){return this.quartile(e)[0]};on.q2=function(e){return this.quartile(e)[1]};on.q3=function(e){return this.quartile(e)[2]};on.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=oL(this.values(),1e3,.05,e),this._get=e),this._ci};on.ci0=function(e){return this.ci(e)[0]};on.ci1=function(e){return this.ci(e)[1]};function Ca(e){D.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Ca.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Rp},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};G(Ca,D,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):Object.create(null),t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function o(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}o(e._prev),o(t);function s(a,u,l){const c=n[l],f=r[l++];for(const d in f){const h=a?a+"|"+d:d;u[c]=f[d],l<i?s(h,u,l):t[h]||e.cell(h,u)}}s("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(v){const x=K(bn(v)),w=x.length;let b=0,S;for(;b<w;++b)r[S=x[b]]||(r[S]=1,t.push(S))}this._dims=K(e.groupby),this._dnames=this._dims.map(v=>{const x=gt(v);return i(v),n.push(x),x}),this.cellkey=e.key?e.key:tE(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],s=e.ops||["count"],a=e.aggregate_params||[null],u=e.as||[],l=o.length,c={};let f,d,h,p,g,y,m;for(l!==s.length&&z("Unmatched number of fields and aggregate ops."),m=0;m<l;++m){if(f=o[m],d=s[m],h=a[m]||null,f==null&&d!=="count"&&z("Null aggregate field specified."),g=gt(f),y=mL(d,g,u[m]),n.push(y),d==="count"){this._counts.push(y);continue}p=c[g],p||(i(f),p=c[g]=[],p.field=f,this._measures.push(p)),d!=="count"&&(this._countOnly=!1),p.push(yL(d,h,y))}return this._measures=this._measures.map(v=>xL(v,v.field)),Object.create(null)},cellkey:tE(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let o=0;o<i;++o)n.agg[o]=new r[o](n)}return n.store&&(n.data=new Wk),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let s=0;s<i;++s)o[n[s]]=r[s](e);return t?KP(t.tuple,o):De(o)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,o=r.length;i<o;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,s=e.rem,a=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&s.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?s:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const QQ=1e-14;function qk(e){D.call(this,null,e)}qk.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};G(qk,D,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,o=r.step,s=e.as||["bin0","bin1"],a=s[0],u=s[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(bn(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[a]=f,c[u]=f==null?null:i+o*(1+(f-i)/o)}:c=>c[a]=r(c)),t.modifies(n?s:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=iL(e),r=n.step;let i=n.start,o=i+Math.ceil((n.stop-i)/r)*r,s,a;(s=e.anchor)!=null&&(a=s-(i+r*Math.floor((s-i)/r)),i+=a,o+=a);const u=function(l){let c=vn(t(l));return c==null?null:c<i?-1/0:c>o?1/0:(c=Math.max(i,Math.min(c,o-r)),i+r*Math.floor(QQ+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=hr(u,bn(t),e.name||"bin_"+gt(t))}});function wL(e,t,n){const r=e;let i=t||[],o=n||[],s={},a=0;return{add:u=>o.push(u),remove:u=>s[r(u)]=++a,size:()=>i.length,data:(u,l)=>(a&&(i=i.filter(c=>!s[r(c)]),s={},a=0),l&&u&&i.sort(u),o.length&&(i=u?j6(u,i,o.sort(u)):i.concat(o),o=[]),i)}}function Hk(e){D.call(this,[],e)}Hk.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};G(Hk,D,{transform(e,t){const n=t.fork(t.ALL),r=wL(oe,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(El(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function bL(e){He.call(this,null,KQ,e)}G(bL,He);function KQ(e){return this.value&&!e.modified()?this.value:ok(e.fields,e.orders)}function Vk(e){D.call(this,null,e)}Vk.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function ZQ(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}G(Vk,D,{transform(e,t){const n=f=>d=>{for(var h=ZQ(a(d),e.case,o)||[],p,g=0,y=h.length;g<y;++g)s.test(p=h[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,s=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],s=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,l;for(a in n)u=r[a],l=n[a]||0,!u&&l?(r[a]=u=De({}),u[i]=a,u[o]=l,s.add.push(u)):l===0?(u&&s.rem.push(u),n[a]=null,r[a]=null):u[o]!==l&&(u[o]=l,s.mod.push(u));return s.modifies(t)}});function Gk(e){D.call(this,null,e)}Gk.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};G(Gk,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],s=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return s?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=JQ(a,i,o,e.filter||ei)):n.mod=a,n.source=this.value,n.modifies(r)}});function JQ(e,t,n,r){for(var i=[],o={},s=e.length,a=0,u,l;a<s;++a)for(o[t]=l=e[a],u=0;u<s;++u)o[n]=e[u],r(o)&&(i.push(De(o)),o={},o[t]=l);return i}const cT={kde:Tk,mixture:lL,normal:Mk,lognormal:uL,uniform:cL},eK="distributions",fT="function",tK="field";function EL(e,t){const n=e[fT];ae(cT,n)||z("Unknown distribution function: "+n);const r=cT[n]();for(const i in e)i===tK?r.data((e.from||t()).map(e[i])):i===eK?r[i](e[i].map(o=>EL(o,t))):typeof r[i]===fT&&r[i](e[i]);return r}function Yk(e){D.call(this,null,e)}const SL=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],nK={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:SL},{name:"weights",type:"number",array:!0}]};Yk.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:SL.concat(nK)},{name:"as",type:"string",array:!0,default:["value","density"]}]};G(Yk,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=EL(e.distribution,rK(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let s=e.method||"pdf";s!=="pdf"&&s!=="cdf"&&z("Invalid density method: "+s),!e.extent&&!r.data&&z("Missing density extent parameter."),s=r[s];const a=e.as||["value","density"],u=e.extent||vo(r.data()),l=ev(s,u,i,o).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],De(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function rK(e){return()=>e.materialize(e.SOURCE).source}function _L(e,t){return e?e.map((n,r)=>t[r]||gt(n)):null}function Xk(e,t,n){const r=[],i=f=>f(u);let o,s,a,u,l,c;if(t==null)r.push(e.map(n));else for(o={},s=0,a=e.length;s<a;++s)u=e[s],l=t.map(i),c=o[l],c||(o[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}const kL="bin";function Qk(e){D.call(this,null,e)}Qk.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:kL}]};const iK=(e,t)=>Tp(vo(e,t))/30;G(Qk,D,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=Xk(t.source,e.groupby,$n),i=e.smooth||!1,o=e.field,s=e.step||iK(n,o),a=El((p,g)=>o(p)-o(g)),u=e.as||kL,l=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const p=r[d].sort(a);h=-1;for(const g of sL(p,s,i,o))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:s},t.reflow(!0).modifies(u)}});function $L(e){He.call(this,null,oK,e),this.modified(!0)}G($L,He);function oK(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:hr(n=>t(n,e),bn(t),gt(t))}function Kk(e){D.call(this,[void 0,void 0],e)}Kk.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};G(Kk,D,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],s=n[1];if((i||o==null)&&(o=1/0,s=-1/0),t.visit(i?t.SOURCE:t.ADD,a=>{const u=vn(r(a));u!=null&&(u<o&&(o=u),u>s&&(s=u))}),!Number.isFinite(o)||!Number.isFinite(s)){let a=gt(r);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}});function Zk(e,t){He.call(this,e),this.parent=t,this.count=0}G(Zk,He,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function tv(e){D.call(this,{},e),this._keys=Mf();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}G(tv,D,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let o=ae(i,e)&&i[e],s,a;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(a=r||(a=this._group[e])&&a.tuple,s=n.dataflow,o=new Zk(n.fork(n.NO_SOURCE),this),s.add(o).connect(t(s,e,a)),i[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,s=e.modified("key"),a=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=oe(u),c=o.get(l);c!==void 0&&(o.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);o.set(oe(u),l),a(l).add(u)}),s||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=oe(u),c=o.get(l),f=r(u);c===f?a(f).mod(u):(o.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(o.get(oe(u))).mod(u)}),s&&t.visit(t.REFLOW,u=>{const l=oe(u),c=o.get(l),f=r(u);c!==f&&(o.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function CL(e){He.call(this,null,sK,e)}G(CL,He);function sK(e){return this.value&&!e.modified()?this.value:I(e.name)?K(e.name).map(t=>Jr(t)):Jr(e.name,e.as)}function Jk(e){D.call(this,Mf(),e)}Jk.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};G(Jk,D,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,s=i.rem,a=i.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=oe(f);r.has(d)?r.delete(d):s.push(f)}),t.visit(t.ADD,f=>{u(f,e)?o.push(f):r.set(oe(f),1)});function c(f){const d=oe(f),h=u(f,e),p=r.get(d);h&&p?(r.delete(d),o.push(f)):!h&&!p?(r.set(d,1),s.push(f)):l&&h&&!p&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function e$(e){D.call(this,[],e)}e$.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};G(e$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=_L(r,e.as||[]),o=e.index||null,s=i.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=r.map(p=>p(a)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=Sk(a),f=0;f<s;++f)d[i[f]]=(h=u[f][c])==null?null:h;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}});function t$(e){D.call(this,[],e)}t$.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};G(t$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(gt),o=e.as||["key","value"],s=o[0],a=o[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Sk(l),f[s]=i[c],f[a]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});function n$(e){D.call(this,null,e)}n$.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};G(n$,D,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,s=>s[r]=n(s,e))}});function AL(e){D.call(this,[],e)}G(AL,D,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,o=e.size-i.length,s,a,u;if(o>0){for(s=[];--o>=0;)s.push(u=De(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(s):s}else a=i.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,i=i.slice(-o);return n.source=this.value=i,n}});const qg={value:"value",median:eP,mean:UG,min:qb,max:Lu},aK=[];function r$(e){D.call(this,[],e)}r$.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function uK(e){var t=e.method||qg.value,n;if(qg[t]==null)z("Unrecognized imputation method: "+t);else return t===qg.value?(n=e.value!==void 0?e.value:0,()=>n):qg[t]}function lK(e){const t=e.field;return n=>n?t(n):NaN}G(r$,D,{transform(e,t){var n=t.fork(t.ALL),r=uK(e),i=lK(e),o=gt(e.field),s=gt(e.key),a=(e.groupby||[]).map(gt),u=cK(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,g,y,m,v,x,w,b;for(y=0,x=u.length;y<x;++y)for(d=u[y],p=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(g=u.domain[v],b={_impute:!0},m=0,w=p.length;m<w;++m)b[a[m]]=p[m];b[s]=g,b[o]=Number.isNaN(h)?h=r(d,i):h,l.push(De(b))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function cK(e,t,n,r){var i=m=>m(y),o=[],s=r?r.slice():[],a={},u={},l,c,f,d,h,p,g,y;for(s.forEach((m,v)=>a[m]=v+1),d=0,g=e.length;d<g;++d)y=e[d],p=n(y),h=a[p]||(a[p]=s.push(p)),c=(l=t?t.map(i):aK)+"",(f=u[c])||(f=u[c]=[],o.push(f),f.values=l),f[h-1]=y;return o.domain=s,o}function i$(e){Ca.call(this,e)}i$.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Rp},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};G(i$,Ca,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(i=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{pe(o,i[n.cellkey(o)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function o$(e){D.call(this,null,e)}o$.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};G(o$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Xk(r,e.groupby,e.field),o=(e.groupby||[]).map(gt),s=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&z("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=vo(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=Tk(h,s)[a],g=e.counts?h.length:1,y=c||vo(h);ev(p,y,f,d).forEach(m=>{const v={};for(let x=0;x<o.length;++x)v[o[x]]=h.dims[x];v[u[0]]=m[0],v[u[1]]=m[1]*g,l.push(De(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function FL(e){He.call(this,null,fK,e)}G(FL,He);function fK(e){return this.value&&!e.modified()?this.value:ak(e.fields,e.flat)}function ML(e){D.call(this,[],e),this._pending=null}G(ML,D,{transform(e,t){const n=t.dataflow;return this._pending?C2(this,t,this._pending):dK(e)?t.StopPropagation:e.values?C2(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=K(i.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(r=>C2(this,t,K(r.data)))}});function dK(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function C2(e,t,n){n.forEach(De);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function s$(e){D.call(this,{},e)}s$.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};G(s$,D,{transform(e,t){const n=e.fields,r=e.index,i=e.values,o=e.default==null?null:e.default,s=e.modified(),a=n.length;let u=s?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return i?(d=i.length,a>1&&!c&&z('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&z('The "as" parameter has too few output field names.'),c=c||i.map(gt),f=function(p){for(var g=0,y=0,m,v;g<a;++g)if(v=r.get(n[g](p)),v==null)for(m=0;m<d;++m,++y)p[c[y]]=o;else for(m=0;m<d;++m,++y)p[c[y]]=i[m](v)}):(c||z("Missing output field names."),f=function(p){for(var g=0,y;g<a;++g)y=r.get(n[g](p)),p[c[g]]=y??o}),s?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function TL(e){He.call(this,null,hK,e)}G(TL,He);function hK(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,o,s;for(o=0;o<n;++o)s=t[o],s[0]<r&&(r=s[0]),s[1]>i&&(i=s[1]);return[r,i]}function NL(e){He.call(this,null,pK,e)}G(NL,He);function pK(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function OL(e){D.call(this,null,e)}G(OL,D,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function a$(e){Ca.call(this,e)}a$.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Rp,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};G(a$,Ca,{_transform:Ca.prototype.transform,transform(e,t){return this._transform(gK(e,t),t)}});function gK(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",o=bn(n).concat(bn(r)),s=yK(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:s.map(()=>i),fields:s.map(a=>mK(a,n,r,o)),as:s.map(a=>a+""),modified:e.modified.bind(e)}}function mK(e,t,n,r){return hr(i=>t(i)===e?n(i):NaN,r,e+"")}function yK(e,t,n){const r={},i=[];return n.visit(n.SOURCE,o=>{const s=e(o);r[s]||(r[s]=1,i.push(s))}),i.sort(Ly),t?i.slice(0,t):i}function RL(e){tv.call(this,e)}G(RL,tv,{transform(e,t){const n=e.subflow,r=e.field,i=o=>this.subflow(oe(o),n,t,o);return(e.modified("field")||r&&t.modified(bn(r)))&&z("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,o=>{const s=i(o);r(o).forEach(a=>s.mod(a))}),t.visit(t.ADD,o=>{const s=i(o);r(o).forEach(a=>s.add(De(a)))}),t.visit(t.REM,o=>{const s=i(o);r(o).forEach(a=>s.rem(a))})):(t.visit(t.MOD,o=>i(o).mod(o)),t.visit(t.ADD,o=>i(o).add(o)),t.visit(t.REM,o=>i(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function u$(e){D.call(this,null,e)}u$.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};G(u$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=_L(e.fields,e.as||[]),o=r?(a,u)=>vK(a,u,r,i):Gy;let s;return this.value?s=this.value:(t=t.addAll(),s=this.value={}),t.visit(t.REM,a=>{const u=oe(a);n.rem.push(s[u]),s[u]=null}),t.visit(t.ADD,a=>{const u=o(a,De({}));s[oe(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(o(a,s[oe(a)]))}),n}});function vK(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}function DL(e){D.call(this,null,e)}G(DL,D,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function l$(e){D.call(this,null,e)}l$.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const xK=1e-14;G(l$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,o=Xk(i,e.groupby,e.field),s=(e.groupby||[]).map(gt),a=[],u=e.step||.01,l=e.probs||Er(u/2,1-xK,u),c=l.length;return o.forEach(f=>{const d=$k(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<s.length;++g)p[s[g]]=f.dims[g];p[r[0]]=l[h],p[r[1]]=d[h],a.push(De(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function PL(e){D.call(this,null,e)}G(PL,D,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const o=oe(i);n.rem.push(r[o]),r[o]=null}),t.visit(t.ADD,i=>{const o=Sk(i);r[oe(i)]=o,n.add.push(o)}),t.visit(t.MOD,i=>{const o=r[oe(i)];for(const s in i)o[s]=i[s],n.modifies(s);n.mod.push(o)})),n}});function c$(e){D.call(this,[],e),this.count=0}c$.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};G(c$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce((c,f)=>(c[oe(f)]=1,c),{});let s=this.value,a=this.count,u=0;function l(c){let f,d;s.length<i?s.push(c):(d=~~((a+1)*ni()),d<s.length&&d>=u&&(f=s[d],o[oe(f)]&&n.rem.push(f),s[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=oe(c);o[f]&&(o[f]=-1,n.rem.push(c)),--a}),s=s.filter(c=>o[oe(c)]!==-1)),(t.rem.length||r)&&s.length<i&&t.source&&(u=a=s.length,t.visit(t.SOURCE,c=>{o[oe(c)]||l(c)}),u=-1),r&&s.length>i){const c=s.length-i;for(let f=0;f<c;++f)o[oe(s[f])]=-1,n.rem.push(s[f]);s=s.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[oe(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=s.filter(c=>!o[oe(c)])),this.count=a,this.value=n.source=s,n}});function f$(e){D.call(this,null,e)}f$.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};G(f$,D,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Er(e.start,e.stop,e.step||1).map(i=>{const o={};return o[r]=i,De(o)}),n.add=t.add.concat(this.value),n}});function LL(e){D.call(this,null,e),this.modified(!0)}G(LL,D,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function d$(e){D.call(this,null,e)}const zL=["unit0","unit1"];d$.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:pk,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:zL}]};G(d$,D,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",o=this._floor(e,t),s=(i?Df:Rf)(o.unit).offset,a=e.as||zL,u=a[0],l=a[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(bn(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let y,m;g==null?(p[u]=null,r&&(p[l]=null)):(p[u]=y=m=o(g),r&&(p[l]=m=s(y,c)),y<f&&(f=y),m>d&&(d=m))}),o.start=f,o.stop=d,t.modifies(r?a:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:AP({extent:e.extent||vo(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=gk(r),s=this.value||{},a=(n?xP:vP)(o,i);return a.unit=$e(o),a.units=o,a.step=i,a.start=s.start,a.stop=s.stop,this.value=a}});function IL(e){D.call(this,Mf(),e)}G(IL,D,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,o=a=>i.set(r(a),a);let s=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,a=>i.delete(r(a))),t.visit(t.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function BL(e){D.call(this,null,e)}G(BL,D,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(El(e.sort)):t.source).map(e.field))}});function wK(e,t,n,r){const i=Zh[e](t,n);return{init:i.init||Ys,update:function(o,s){s[r]=i.next(o)}}}const Zh={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=Zh.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||z("ntile num must be greater than zero.");const n=Zh.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||z("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=bK(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function bK(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const EK=Object.keys(Zh);function jL(e){const t=K(e.ops),n=K(e.fields),r=K(e.params),i=K(e.aggregate_params),o=K(e.as),s=this.outputs=[],a=this.windows=[],u={},l={},c=[],f=[];let d=!0;function h(p){K(bn(p)).forEach(g=>u[g]=1)}h(e.sort),t.forEach((p,g)=>{const y=n[g],m=r[g],v=i[g]||null,x=gt(y),w=mL(p,x,o[g]);if(h(y),s.push(w),ae(Zh,p))a.push(wK(p,y,m,w));else{if(y==null&&p!=="count"&&z("Null aggregate field specified."),p==="count"){c.push(w);return}d=!1;let b=l[x];b||(b=l[x]=[],b.field=y,f.push(b)),b.push(yL(p,v,w))}}),(c.length||f.length)&&(this.cell=SK(f,c,d)),this.inputs=Object.keys(u)}const UL=jL.prototype;UL.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};UL.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let s;if(n){for(s=e.p0;s<e.i0;++s)n.rem(i[s]);for(s=e.p1;s<e.i1;++s)n.add(i[s]);n.set(t)}for(s=0;s<o;++s)r[s].update(e,t)};function SK(e,t,n){e=e.map(u=>xL(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),s=0;s<i;++s)o[s]=new e[s](r);if(r.store)var a=r.data=new Wk;return r.add=function(u){if(r.num+=1,!n){a&&a.add(u);for(let l=0;l<i;++l)o[l].add(o[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){a&&a.rem(u);for(let l=0;l<i;++l)o[l].rem(o[l].get(u),u)}},r.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=o.length;l<c;++l)o[l].set(u)},r.init=function(){r.num=0,a&&a.reset();for(let u=0;u<i;++u)o[u].init()},r}function h$(e){D.call(this,{},e),this._mlen=0,this._mods=[]}h$.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:EK.concat(Rp)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};G(h$,D,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=El(e.sort),i=tE(e.groupby),o=a=>this.group(i(a));let s=this.state;(!s||n)&&(s=this.state=new jL(e)),n||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,a=>o(a).add(a))):(t.visit(t.REM,a=>o(a).remove(a)),t.visit(t.ADD,a=>o(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)_K(this._mods[a],s,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(s.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=wL(oe),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function _K(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,s=r.frame||[null,0],a=e.data(n),u=a.length,l=o?Tf(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||Cn(-1)};t.init();for(let f=0;f<u;++f)kK(c,s,f,u),o&&$K(c,l),t.update(c,a[f])}function kK(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function $K(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,s=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<s&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}const CK=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Ca,bin:qk,collect:Hk,compare:bL,countpattern:Vk,cross:Gk,density:Yk,dotbin:Qk,expression:$L,extent:Kk,facet:tv,field:CL,filter:Jk,flatten:e$,fold:t$,formula:n$,generate:AL,impute:r$,joinaggregate:i$,kde:o$,key:FL,load:ML,lookup:s$,multiextent:TL,multivalues:NL,params:OL,pivot:a$,prefacet:RL,project:u$,proxy:DL,quantile:l$,relay:PL,sample:c$,sequence:f$,sieve:LL,subflow:Zk,timeunit:d$,tupleindex:IL,values:BL,window:h$},Symbol.toStringTag,{value:"Module"}));function Pe(e){return function(){return e}}const dT=Math.abs,cn=Math.atan2,su=Math.cos,AK=Math.max,A2=Math.min,Qi=Math.sin,Mu=Math.sqrt,dn=1e-12,Gc=Math.PI,V0=Gc/2,WL=2*Gc;function FK(e){return e>1?0:e<-1?Gc:Math.acos(e)}function hT(e){return e>=1?V0:e<=-1?-V0:Math.asin(e)}const nE=Math.PI,rE=2*nE,wu=1e-6,MK=rE-wu;function qL(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function TK(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return qL;const n=10**t;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let p$=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?qL:TK(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,o,s){this._append`C${+t},${+n},${+r},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(t,n,r,i,o){if(t=+t,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,u=r-t,l=i-n,c=s-t,f=a-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>wu)if(!(Math.abs(f*u-l*c)>wu)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let h=r-s,p=i-a,g=u*u+l*l,y=h*h+p*p,m=Math.sqrt(g),v=Math.sqrt(d),x=o*Math.tan((nE-Math.acos((g+d-y)/(2*m*v)))/2),w=x/v,b=x/m;Math.abs(w-1)>wu&&this._append`L${t+w*c},${n+w*f}`,this._append`A${o},${o},0,0,${+(f*h>c*p)},${this._x1=t+b*u},${this._y1=n+b*l}`}}arc(t,n,r,i,o,s){if(t=+t,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),u=r*Math.sin(i),l=t+a,c=n+u,f=1^s,d=s?i-o:o-i;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>wu||Math.abs(this._y1-c)>wu)&&this._append`L${l},${c}`,r&&(d<0&&(d=d%rE+rE),d>MK?this._append`A${r},${r},0,1,${f},${t-a},${n-u}A${r},${r},0,1,${f},${this._x1=l},${this._y1=c}`:d>wu&&this._append`A${r},${r},0,${+(d>=nE)},${f},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function nv(){return new p$}nv.prototype=p$.prototype;function rv(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new p$(t)}function NK(e){return e.innerRadius}function OK(e){return e.outerRadius}function RK(e){return e.startAngle}function DK(e){return e.endAngle}function PK(e){return e&&e.padAngle}function LK(e,t,n,r,i,o,s,a){var u=n-e,l=r-t,c=s-i,f=a-o,d=f*u-c*l;if(!(d*d<dn))return d=(c*(t-o)-f*(e-i))/d,[e+d*u,t+d*l]}function Hg(e,t,n,r,i,o,s){var a=e-n,u=t-r,l=(s?o:-o)/Mu(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,p=n+c,g=r+f,y=(d+p)/2,m=(h+g)/2,v=p-d,x=g-h,w=v*v+x*x,b=i-o,S=d*g-p*h,E=(x<0?-1:1)*Mu(AK(0,b*b*w-S*S)),_=(S*x-v*E)/w,k=(-S*v-x*E)/w,$=(S*x+v*E)/w,C=(-S*v+x*E)/w,R=_-y,A=k-m,M=$-y,F=C-m;return R*R+A*A>M*M+F*F&&(_=$,k=C),{cx:_,cy:k,x01:-c,y01:-f,x11:_*(i/b-1),y11:k*(i/b-1)}}function zK(){var e=NK,t=OK,n=Pe(0),r=null,i=RK,o=DK,s=PK,a=null,u=rv(l);function l(){var c,f,d=+e.apply(this,arguments),h=+t.apply(this,arguments),p=i.apply(this,arguments)-V0,g=o.apply(this,arguments)-V0,y=dT(g-p),m=g>p;if(a||(a=c=u()),h<d&&(f=h,h=d,d=f),!(h>dn))a.moveTo(0,0);else if(y>WL-dn)a.moveTo(h*su(p),h*Qi(p)),a.arc(0,0,h,p,g,!m),d>dn&&(a.moveTo(d*su(g),d*Qi(g)),a.arc(0,0,d,g,p,m));else{var v=p,x=g,w=p,b=g,S=y,E=y,_=s.apply(this,arguments)/2,k=_>dn&&(r?+r.apply(this,arguments):Mu(d*d+h*h)),$=A2(dT(h-d)/2,+n.apply(this,arguments)),C=$,R=$,A,M;if(k>dn){var F=hT(k/d*Qi(_)),N=hT(k/h*Qi(_));(S-=F*2)>dn?(F*=m?1:-1,w+=F,b-=F):(S=0,w=b=(p+g)/2),(E-=N*2)>dn?(N*=m?1:-1,v+=N,x-=N):(E=0,v=x=(p+g)/2)}var P=h*su(v),T=h*Qi(v),O=d*su(b),j=d*Qi(b);if($>dn){var X=h*su(x),re=h*Qi(x),we=d*su(w),he=d*Qi(w),Re;if(y<Gc)if(Re=LK(P,T,we,he,X,re,O,j)){var Nt=P-Re[0],Dr=T-Re[1],Ns=X-Re[0],J=re-Re[1],me=1/Qi(FK((Nt*Ns+Dr*J)/(Mu(Nt*Nt+Dr*Dr)*Mu(Ns*Ns+J*J)))/2),ve=Mu(Re[0]*Re[0]+Re[1]*Re[1]);C=A2($,(d-ve)/(me-1)),R=A2($,(h-ve)/(me+1))}else C=R=0}E>dn?R>dn?(A=Hg(we,he,P,T,h,R,m),M=Hg(X,re,O,j,h,R,m),a.moveTo(A.cx+A.x01,A.cy+A.y01),R<$?a.arc(A.cx,A.cy,R,cn(A.y01,A.x01),cn(M.y01,M.x01),!m):(a.arc(A.cx,A.cy,R,cn(A.y01,A.x01),cn(A.y11,A.x11),!m),a.arc(0,0,h,cn(A.cy+A.y11,A.cx+A.x11),cn(M.cy+M.y11,M.cx+M.x11),!m),a.arc(M.cx,M.cy,R,cn(M.y11,M.x11),cn(M.y01,M.x01),!m))):(a.moveTo(P,T),a.arc(0,0,h,v,x,!m)):a.moveTo(P,T),!(d>dn)||!(S>dn)?a.lineTo(O,j):C>dn?(A=Hg(O,j,X,re,d,-C,m),M=Hg(P,T,we,he,d,-C,m),a.lineTo(A.cx+A.x01,A.cy+A.y01),C<$?a.arc(A.cx,A.cy,C,cn(A.y01,A.x01),cn(M.y01,M.x01),!m):(a.arc(A.cx,A.cy,C,cn(A.y01,A.x01),cn(A.y11,A.x11),!m),a.arc(0,0,d,cn(A.cy+A.y11,A.cx+A.x11),cn(M.cy+M.y11,M.cx+M.x11),m),a.arc(M.cx,M.cy,C,cn(M.y11,M.x11),cn(M.y01,M.x01),!m))):a.arc(0,0,d,b,w,m)}if(a.closePath(),c)return a=null,c+""||null}return l.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Gc/2;return[su(f)*c,Qi(f)*c]},l.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Pe(+c),l):e},l.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Pe(+c),l):t},l.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Pe(+c),l):n},l.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Pe(+c),l):r},l.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:Pe(+c),l):i},l.endAngle=function(c){return arguments.length?(o=typeof c=="function"?c:Pe(+c),l):o},l.padAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Pe(+c),l):s},l.context=function(c){return arguments.length?(a=c??null,l):a},l}function HL(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function VL(e){this._context=e}VL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function g$(e){return new VL(e)}function GL(e){return e[0]}function YL(e){return e[1]}function XL(e,t){var n=Pe(!0),r=null,i=g$,o=null,s=rv(a);e=typeof e=="function"?e:e===void 0?GL:Pe(e),t=typeof t=="function"?t:t===void 0?YL:Pe(t);function a(u){var l,c=(u=HL(u)).length,f,d=!1,h;for(r==null&&(o=i(h=s())),l=0;l<=c;++l)!(l<c&&n(f=u[l],l,u))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(f,l,u),+t(f,l,u));if(h)return o=null,h+""||null}return a.x=function(u){return arguments.length?(e=typeof u=="function"?u:Pe(+u),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:Pe(+u),a):t},a.defined=function(u){return arguments.length?(n=typeof u=="function"?u:Pe(!!u),a):n},a.curve=function(u){return arguments.length?(i=u,r!=null&&(o=i(r)),a):i},a.context=function(u){return arguments.length?(u==null?r=o=null:o=i(r=u),a):r},a}function QL(e,t,n){var r=null,i=Pe(!0),o=null,s=g$,a=null,u=rv(l);e=typeof e=="function"?e:e===void 0?GL:Pe(+e),t=typeof t=="function"?t:Pe(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?YL:Pe(+n);function l(f){var d,h,p,g=(f=HL(f)).length,y,m=!1,v,x=new Array(g),w=new Array(g);for(o==null&&(a=s(v=u())),d=0;d<=g;++d){if(!(d<g&&i(y=f[d],d,f))===m)if(m=!m)h=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=d-1;p>=h;--p)a.point(x[p],w[p]);a.lineEnd(),a.areaEnd()}m&&(x[d]=+e(y,d,f),w[d]=+t(y,d,f),a.point(r?+r(y,d,f):x[d],n?+n(y,d,f):w[d]))}if(v)return a=null,v+""||null}function c(){return XL().defined(i).curve(s).context(o)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:Pe(+f),r=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Pe(+f),l):e},l.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Pe(+f),l):r},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:Pe(+f),n=null,l):t},l.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Pe(+f),l):t},l.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Pe(+f),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(r).y(t)},l.defined=function(f){return arguments.length?(i=typeof f=="function"?f:Pe(!!f),l):i},l.curve=function(f){return arguments.length?(s=f,o!=null&&(a=s(o)),l):s},l.context=function(f){return arguments.length?(f==null?o=a=null:a=s(o=f),l):o},l}const IK={draw(e,t){const n=Mu(t/Gc);e.moveTo(n,0),e.arc(0,0,n,0,WL)}};function BK(e,t){let n=null,r=rv(i);e=typeof e=="function"?e:Pe(e||IK),t=typeof t=="function"?t:Pe(t===void 0?64:+t);function i(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return i.type=function(o){return arguments.length?(e=typeof o=="function"?o:Pe(o),i):e},i.size=function(o){return arguments.length?(t=typeof o=="function"?o:Pe(+o),i):t},i.context=function(o){return arguments.length?(n=o??null,i):n},i}function Aa(){}function G0(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function iv(e){this._context=e}iv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:G0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:G0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function jK(e){return new iv(e)}function KL(e){this._context=e}KL.prototype={areaStart:Aa,areaEnd:Aa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:G0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function UK(e){return new KL(e)}function ZL(e){this._context=e}ZL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:G0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function WK(e){return new ZL(e)}function JL(e,t){this._basis=new iv(e),this._beta=t}JL.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,s=t[n]-i,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+u*o),this._beta*t[a]+(1-this._beta)*(i+u*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const qK=function e(t){function n(r){return t===1?new iv(r):new JL(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function Y0(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function m$(e,t){this._context=e,this._k=(1-t)/6}m$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Y0(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Y0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const HK=function e(t){function n(r){return new m$(r,t)}return n.tension=function(r){return e(+r)},n}(0);function y$(e,t){this._context=e,this._k=(1-t)/6}y$.prototype={areaStart:Aa,areaEnd:Aa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Y0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const VK=function e(t){function n(r){return new y$(r,t)}return n.tension=function(r){return e(+r)},n}(0);function v$(e,t){this._context=e,this._k=(1-t)/6}v$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Y0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const GK=function e(t){function n(r){return new v$(r,t)}return n.tension=function(r){return e(+r)},n}(0);function x$(e,t,n){var r=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>dn){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>dn){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,s=(s*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,s,e._x2,e._y2)}function ez(e,t){this._context=e,this._alpha=t}ez.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:x$(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const YK=function e(t){function n(r){return t?new ez(r,t):new m$(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function tz(e,t){this._context=e,this._alpha=t}tz.prototype={areaStart:Aa,areaEnd:Aa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:x$(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const XK=function e(t){function n(r){return t?new tz(r,t):new y$(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function nz(e,t){this._context=e,this._alpha=t}nz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:x$(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const QK=function e(t){function n(r){return t?new nz(r,t):new v$(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function rz(e){this._context=e}rz.prototype={areaStart:Aa,areaEnd:Aa,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function KK(e){return new rz(e)}function pT(e){return e<0?-1:1}function gT(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(pT(o)+pT(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function mT(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function F2(e,t,n){var r=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,i+a*t,o-a,s-a*n,o,s)}function X0(e){this._context=e}X0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:F2(this,this._t0,mT(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,F2(this,mT(this,n=gT(this,e,t)),n);break;default:F2(this,this._t0,n=gT(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function iz(e){this._context=new oz(e)}(iz.prototype=Object.create(X0.prototype)).point=function(e,t){X0.prototype.point.call(this,t,e)};function oz(e){this._context=e}oz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function ZK(e){return new X0(e)}function JK(e){return new iz(e)}function sz(e){this._context=e}sz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=yT(e),i=yT(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function yT(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),s=new Array(n);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,s[t]-=r*s[t-1];for(i[n-1]=s[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function eZ(e){return new sz(e)}function ov(e,t){this._context=e,this._t=t}ov.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function tZ(e){return new ov(e,.5)}function nZ(e){return new ov(e,0)}function rZ(e){return new ov(e,1)}function wa(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const iZ=()=>typeof Image<"u"?Image:null;function Ao(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Va(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const iE=Symbol("implicit");function w$(){var e=new RM,t=[],n=[],r=iE;function i(o){let s=e.get(o);if(s===void 0){if(r!==iE)return r;e.set(o,s=t.push(o)-1)}return n[s%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new RM;for(const s of o)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return w$(t,n).unknown(r)},Ao.apply(i,arguments),i}function Lf(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Dp(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ga(){}var Zu=.7,Yc=1/Zu,kc="\\s*([+-]?\\d+)\\s*",Jh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ho="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oZ=/^#([0-9a-f]{3,8})$/,sZ=new RegExp(`^rgb\\(${kc},${kc},${kc}\\)$`),aZ=new RegExp(`^rgb\\(${ho},${ho},${ho}\\)$`),uZ=new RegExp(`^rgba\\(${kc},${kc},${kc},${Jh}\\)$`),lZ=new RegExp(`^rgba\\(${ho},${ho},${ho},${Jh}\\)$`),cZ=new RegExp(`^hsl\\(${Jh},${ho},${ho}\\)$`),fZ=new RegExp(`^hsla\\(${Jh},${ho},${ho},${Jh}\\)$`),vT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Lf(Ga,ep,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:xT,formatHex:xT,formatHex8:dZ,formatHsl:hZ,formatRgb:wT,toString:wT});function xT(){return this.rgb().formatHex()}function dZ(){return this.rgb().formatHex8()}function hZ(){return az(this).formatHsl()}function wT(){return this.rgb().formatRgb()}function ep(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=oZ.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?bT(t):n===3?new Lt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Vg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Vg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=sZ.exec(e))?new Lt(t[1],t[2],t[3],1):(t=aZ.exec(e))?new Lt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=uZ.exec(e))?Vg(t[1],t[2],t[3],t[4]):(t=lZ.exec(e))?Vg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=cZ.exec(e))?_T(t[1],t[2]/100,t[3]/100,1):(t=fZ.exec(e))?_T(t[1],t[2]/100,t[3]/100,t[4]):vT.hasOwnProperty(e)?bT(vT[e]):e==="transparent"?new Lt(NaN,NaN,NaN,0):null}function bT(e){return new Lt(e>>16&255,e>>8&255,e&255,1)}function Vg(e,t,n,r){return r<=0&&(e=t=n=NaN),new Lt(e,t,n,r)}function b$(e){return e instanceof Ga||(e=ep(e)),e?(e=e.rgb(),new Lt(e.r,e.g,e.b,e.opacity)):new Lt}function Fa(e,t,n,r){return arguments.length===1?b$(e):new Lt(e,t,n,r??1)}function Lt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Lf(Lt,Fa,Dp(Ga,{brighter(e){return e=e==null?Yc:Math.pow(Yc,e),new Lt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Zu:Math.pow(Zu,e),new Lt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Lt(zu(this.r),zu(this.g),zu(this.b),Q0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ET,formatHex:ET,formatHex8:pZ,formatRgb:ST,toString:ST}));function ET(){return`#${Tu(this.r)}${Tu(this.g)}${Tu(this.b)}`}function pZ(){return`#${Tu(this.r)}${Tu(this.g)}${Tu(this.b)}${Tu((isNaN(this.opacity)?1:this.opacity)*255)}`}function ST(){const e=Q0(this.opacity);return`${e===1?"rgb(":"rgba("}${zu(this.r)}, ${zu(this.g)}, ${zu(this.b)}${e===1?")":`, ${e})`}`}function Q0(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function zu(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Tu(e){return e=zu(e),(e<16?"0":"")+e.toString(16)}function _T(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ei(e,t,n,r)}function az(e){if(e instanceof Ei)return new Ei(e.h,e.s,e.l,e.opacity);if(e instanceof Ga||(e=ep(e)),!e)return new Ei;if(e instanceof Ei)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(t===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-t)/a+2:s=(t-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new Ei(s,a,u,e.opacity)}function K0(e,t,n,r){return arguments.length===1?az(e):new Ei(e,t,n,r??1)}function Ei(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Lf(Ei,K0,Dp(Ga,{brighter(e){return e=e==null?Yc:Math.pow(Yc,e),new Ei(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zu:Math.pow(Zu,e),new Ei(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Lt(M2(e>=240?e-240:e+120,i,r),M2(e,i,r),M2(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Ei(kT(this.h),Gg(this.s),Gg(this.l),Q0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Q0(this.opacity);return`${e===1?"hsl(":"hsla("}${kT(this.h)}, ${Gg(this.s)*100}%, ${Gg(this.l)*100}%${e===1?")":`, ${e})`}`}}));function kT(e){return e=(e||0)%360,e<0?e+360:e}function Gg(e){return Math.max(0,Math.min(1,e||0))}function M2(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const uz=Math.PI/180,lz=180/Math.PI,Z0=18,cz=.96422,fz=1,dz=.82521,hz=4/29,$c=6/29,pz=3*$c*$c,gZ=$c*$c*$c;function gz(e){if(e instanceof po)return new po(e.l,e.a,e.b,e.opacity);if(e instanceof ns)return mz(e);e instanceof Lt||(e=b$(e));var t=R2(e.r),n=R2(e.g),r=R2(e.b),i=T2((.2225045*t+.7168786*n+.0606169*r)/fz),o,s;return t===n&&n===r?o=s=i:(o=T2((.4360747*t+.3850649*n+.1430804*r)/cz),s=T2((.0139322*t+.0971045*n+.7141733*r)/dz)),new po(116*i-16,500*(o-i),200*(i-s),e.opacity)}function J0(e,t,n,r){return arguments.length===1?gz(e):new po(e,t,n,r??1)}function po(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Lf(po,J0,Dp(Ga,{brighter(e){return new po(this.l+Z0*(e??1),this.a,this.b,this.opacity)},darker(e){return new po(this.l-Z0*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=cz*N2(t),e=fz*N2(e),n=dz*N2(n),new Lt(O2(3.1338561*t-1.6168667*e-.4906146*n),O2(-.9787684*t+1.9161415*e+.033454*n),O2(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function T2(e){return e>gZ?Math.pow(e,1/3):e/pz+hz}function N2(e){return e>$c?e*e*e:pz*(e-hz)}function O2(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function R2(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function mZ(e){if(e instanceof ns)return new ns(e.h,e.c,e.l,e.opacity);if(e instanceof po||(e=gz(e)),e.a===0&&e.b===0)return new ns(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*lz;return new ns(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function e1(e,t,n,r){return arguments.length===1?mZ(e):new ns(e,t,n,r??1)}function ns(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function mz(e){if(isNaN(e.h))return new po(e.l,0,0,e.opacity);var t=e.h*uz;return new po(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Lf(ns,e1,Dp(Ga,{brighter(e){return new ns(this.h,this.c,this.l+Z0*(e??1),this.opacity)},darker(e){return new ns(this.h,this.c,this.l-Z0*(e??1),this.opacity)},rgb(){return mz(this).rgb()}}));var yz=-.14861,E$=1.78277,S$=-.29227,sv=-.90649,tp=1.97294,$T=tp*sv,CT=tp*E$,AT=E$*S$-sv*yz;function yZ(e){if(e instanceof Iu)return new Iu(e.h,e.s,e.l,e.opacity);e instanceof Lt||(e=b$(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(AT*r+$T*t-CT*n)/(AT+$T-CT),o=r-i,s=(tp*(n-i)-S$*o)/sv,a=Math.sqrt(s*s+o*o)/(tp*i*(1-i)),u=a?Math.atan2(s,o)*lz-120:NaN;return new Iu(u<0?u+360:u,a,i,e.opacity)}function oE(e,t,n,r){return arguments.length===1?yZ(e):new Iu(e,t,n,r??1)}function Iu(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Lf(Iu,oE,Dp(Ga,{brighter(e){return e=e==null?Yc:Math.pow(Yc,e),new Iu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zu:Math.pow(Zu,e),new Iu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*uz,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Lt(255*(t+n*(yz*r+E$*i)),255*(t+n*(S$*r+sv*i)),255*(t+n*(tp*r)),this.opacity)}}));function vz(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}function xz(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return vz((n-r/t)*t,s,i,o,a)}}function wz(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return vz((n-r/t)*t,i,o,s,a)}}const av=e=>()=>e;function bz(e,t){return function(n){return e+n*t}}function vZ(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function uv(e,t){var n=t-e;return n?bz(e,n>180||n<-180?n-360*Math.round(n/360):n):av(isNaN(e)?t:e)}function xZ(e){return(e=+e)==1?zt:function(t,n){return n-t?vZ(t,n,e):av(isNaN(t)?n:t)}}function zt(e,t){var n=t-e;return n?bz(e,n):av(isNaN(e)?t:e)}const sE=function e(t){var n=xZ(t);function r(i,o){var s=n((i=Fa(i)).r,(o=Fa(o)).r),a=n(i.g,o.g),u=n(i.b,o.b),l=zt(i.opacity,o.opacity);return function(c){return i.r=s(c),i.g=a(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function Ez(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s)a=Fa(t[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=e(r),i=e(i),o=e(o),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=o(u),a+""}}}var wZ=Ez(xz),bZ=Ez(wz);function _$(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function Sz(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function EZ(e,t){return(Sz(t)?_$:_z)(e,t)}function _z(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=Ya(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}function kz(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function wi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function $z(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Ya(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var aE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,D2=new RegExp(aE.source,"g");function SZ(e){return function(){return e}}function _Z(e){return function(t){return e(t)+""}}function Cz(e,t){var n=aE.lastIndex=D2.lastIndex=0,r,i,o,s=-1,a=[],u=[];for(e=e+"",t=t+"";(r=aE.exec(e))&&(i=D2.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:wi(r,i)})),n=D2.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?_Z(u[0].x):SZ(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function Ya(e,t){var n=typeof t,r;return t==null||n==="boolean"?av(t):(n==="number"?wi:n==="string"?(r=ep(t))?(t=r,sE):Cz:t instanceof ep?sE:t instanceof Date?kz:Sz(t)?_$:Array.isArray(t)?_z:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?$z:wi)(e,t)}function kZ(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function $Z(e,t){var n=uv(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function Pp(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var FT=180/Math.PI,uE={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Az(e,t,n,r,i,o){var s,a,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*FT,skewX:Math.atan(u)*FT,scaleX:s,scaleY:a}}var Yg;function CZ(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?uE:Az(t.a,t.b,t.c,t.d,t.e,t.f)}function AZ(e){return e==null||(Yg||(Yg=document.createElementNS("http://www.w3.org/2000/svg","g")),Yg.setAttribute("transform",e),!(e=Yg.transform.baseVal.consolidate()))?uE:(e=e.matrix,Az(e.a,e.b,e.c,e.d,e.e,e.f))}function Fz(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:wi(l,f)},{i:g-2,x:wi(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function s(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:wi(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:wi(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(i(h)+"scale(",null,",",null,")");p.push({i:g-4,x:wi(l,f)},{i:g-2,x:wi(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),s(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,g=d.length,y;++p<g;)f[(y=d[p]).i]=y.x(h);return f.join("")}}}var FZ=Fz(CZ,"px, ","px)","deg)"),MZ=Fz(AZ,", ",")",")"),TZ=1e-12;function MT(e){return((e=Math.exp(e))+1/e)/2}function NZ(e){return((e=Math.exp(e))-1/e)/2}function OZ(e){return((e=Math.exp(2*e))-1)/(e+1)}const RZ=function e(t,n,r){function i(o,s){var a=o[0],u=o[1],l=o[2],c=s[0],f=s[1],d=s[2],h=c-a,p=f-u,g=h*h+p*p,y,m;if(g<TZ)m=Math.log(d/l)/t,y=function(E){return[a+E*h,u+E*p,l*Math.exp(t*E*m)]};else{var v=Math.sqrt(g),x=(d*d-l*l+r*g)/(2*l*n*v),w=(d*d-l*l-r*g)/(2*d*n*v),b=Math.log(Math.sqrt(x*x+1)-x),S=Math.log(Math.sqrt(w*w+1)-w);m=(S-b)/t,y=function(E){var _=E*m,k=MT(b),$=l/(n*v)*(k*OZ(t*_+b)-NZ(b));return[a+$*h,u+$*p,l*k/MT(t*_+b)]}}return y.duration=m*1e3*t/Math.SQRT2,y}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,u=a*a;return e(s,a,u)},i}(Math.SQRT2,2,4);function Mz(e){return function(t,n){var r=e((t=K0(t)).h,(n=K0(n)).h),i=zt(t.s,n.s),o=zt(t.l,n.l),s=zt(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=o(a),t.opacity=s(a),t+""}}}const DZ=Mz(uv);var PZ=Mz(zt);function LZ(e,t){var n=zt((e=J0(e)).l,(t=J0(t)).l),r=zt(e.a,t.a),i=zt(e.b,t.b),o=zt(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=r(s),e.b=i(s),e.opacity=o(s),e+""}}function Tz(e){return function(t,n){var r=e((t=e1(t)).h,(n=e1(n)).h),i=zt(t.c,n.c),o=zt(t.l,n.l),s=zt(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=o(a),t.opacity=s(a),t+""}}}const zZ=Tz(uv);var IZ=Tz(zt);function Nz(e){return function t(n){n=+n;function r(i,o){var s=e((i=oE(i)).h,(o=oE(o)).h),a=zt(i.s,o.s),u=zt(i.l,o.l),l=zt(i.opacity,o.opacity);return function(c){return i.h=s(c),i.s=a(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}const BZ=Nz(uv);var jZ=Nz(zt);function k$(e,t){t===void 0&&(t=e,e=Ya);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(s){var a=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return o[a](s-a)}}function UZ(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const WZ=Object.freeze(Object.defineProperty({__proto__:null,interpolate:Ya,interpolateArray:EZ,interpolateBasis:xz,interpolateBasisClosed:wz,interpolateCubehelix:BZ,interpolateCubehelixLong:jZ,interpolateDate:kz,interpolateDiscrete:kZ,interpolateHcl:zZ,interpolateHclLong:IZ,interpolateHsl:DZ,interpolateHslLong:PZ,interpolateHue:$Z,interpolateLab:LZ,interpolateNumber:wi,interpolateNumberArray:_$,interpolateObject:$z,interpolateRgb:sE,interpolateRgbBasis:wZ,interpolateRgbBasisClosed:bZ,interpolateRound:Pp,interpolateString:Cz,interpolateTransformCss:FZ,interpolateTransformSvg:MZ,interpolateZoom:RZ,piecewise:k$,quantize:UZ},Symbol.toStringTag,{value:"Module"}));function qZ(e){return function(){return e}}function lE(e){return+e}var TT=[0,1];function tr(e){return e}function cE(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:qZ(isNaN(t)?NaN:.5)}function HZ(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function VZ(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=cE(i,r),o=n(s,o)):(r=cE(r,i),o=n(o,s)),function(a){return o(r(a))}}function GZ(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=cE(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(a){var u=ka(e,a,1,r)-1;return o[u](i[u](a))}}function Lp(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function lv(){var e=TT,t=TT,n=Ya,r,i,o,s=tr,a,u,l;function c(){var d=Math.min(e.length,t.length);return s!==tr&&(s=HZ(e[0],e[d-1])),a=d>2?GZ:VZ,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(u||(u=a(e.map(r),t,n)))(r(s(d)))}return f.invert=function(d){return s(i((l||(l=a(t,e.map(r),wi)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,lE),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Pp,c()},f.clamp=function(d){return arguments.length?(s=d?!0:tr,c()):s!==tr},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return r=d,i=h,c()}}function Oz(){return lv()(tr,tr)}function Rz(e,t,n,r){var i=$a(e,t,n),o;switch(r=Ku(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=sP(i,s))&&(r.precision=o),dk(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=aP(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=oP(i))&&(r.precision=o-(r.type==="%")*2);break}}return zy(r)}function _l(e){var t=e.domain;return e.ticks=function(n){var r=t();return Ub(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return Rz(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,s=r[i],a=r[o],u,l,c=10;for(a<s&&(l=s,s=a,a=l,l=i,i=o,o=l);c-- >0;){if(l=Wb(s,a,n),l===u)return r[i]=s,r[o]=a,t(r);if(l>0)s=Math.floor(s/l)*l,a=Math.ceil(a/l)*l;else if(l<0)s=Math.ceil(s*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function Dz(){var e=Oz();return e.copy=function(){return Lp(e,Dz())},Ao.apply(e,arguments),_l(e)}function Pz(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,lE),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Pz(e).unknown(t)},e=arguments.length?Array.from(e,lE):[0,1],_l(n)}function Lz(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],s;return o<i&&(s=n,n=r,r=s,s=i,i=o,o=s),e[n]=t.floor(i),e[r]=t.ceil(o),e}function NT(e){return Math.log(e)}function OT(e){return Math.exp(e)}function YZ(e){return-Math.log(-e)}function XZ(e){return-Math.exp(-e)}function QZ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function KZ(e){return e===10?QZ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function ZZ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function RT(e){return(t,n)=>-e(-t,n)}function $$(e){const t=e(NT,OT),n=t.domain;let r=10,i,o;function s(){return i=ZZ(r),o=KZ(r),n()[0]<0?(i=RT(i),o=RT(o),e(YZ,XZ)):e(NT,OT),t}return t.base=function(a){return arguments.length?(r=+a,s()):r},t.domain=function(a){return arguments.length?(n(a),s()):n()},t.ticks=a=>{const u=n();let l=u[0],c=u[u.length-1];const f=c<l;f&&([l,c]=[c,l]);let d=i(l),h=i(c),p,g;const y=a==null?10:+a;let m=[];if(!(r%1)&&h-d<y){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1;p<r;++p)if(g=d<0?p/o(-d):p*o(d),!(g<l)){if(g>c)break;m.push(g)}}else for(;d<=h;++d)for(p=r-1;p>=1;--p)if(g=d>0?p/o(-d):p*o(d),!(g<l)){if(g>c)break;m.push(g)}m.length*2<y&&(m=Ub(l,c,y))}else m=Ub(d,h,Math.min(h-d,y)).map(o);return f?m.reverse():m},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=r===10?"s":","),typeof u!="function"&&(!(r%1)&&(u=Ku(u)).precision==null&&(u.trim=!0),u=zy(u)),a===1/0)return u;const l=Math.max(1,r*a/t.ticks().length);return c=>{let f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=()=>n(Lz(n(),{floor:a=>o(Math.floor(i(a))),ceil:a=>o(Math.ceil(i(a)))})),t}function zz(){const e=$$(lv()).domain([1,10]);return e.copy=()=>Lp(e,zz()).base(e.base()),Ao.apply(e,arguments),e}function DT(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function PT(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function C$(e){var t=1,n=e(DT(t),PT(t));return n.constant=function(r){return arguments.length?e(DT(t=+r),PT(t)):t},_l(n)}function Iz(){var e=C$(lv());return e.copy=function(){return Lp(e,Iz()).constant(e.constant())},Ao.apply(e,arguments)}function LT(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function JZ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function eJ(e){return e<0?-e*e:e*e}function A$(e){var t=e(tr,tr),n=1;function r(){return n===1?e(tr,tr):n===.5?e(JZ,eJ):e(LT(n),LT(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},_l(t)}function F$(){var e=A$(lv());return e.copy=function(){return Lp(e,F$()).exponent(e.exponent())},Ao.apply(e,arguments),e}function tJ(){return F$.apply(null,arguments).exponent(.5)}function Bz(){var e=[],t=[],n=[],r;function i(){var s=0,a=Math.max(1,t.length);for(n=new Array(a-1);++s<a;)n[s-1]=J6(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?r:t[ka(n,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ss),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(r=s,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return Bz().domain(e).range(t).unknown(r)},Ao.apply(o,arguments)}function jz(){var e=0,t=1,n=1,r=[.5],i=[0,1],o;function s(u){return u!=null&&u<=u?i[ka(r,u,0,n)]:o}function a(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return s}return s.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},s.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,a()):i.slice()},s.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},s.unknown=function(u){return arguments.length&&(o=u),s},s.thresholds=function(){return r.slice()},s.copy=function(){return jz().domain([e,t]).range(i).unknown(o)},Ao.apply(_l(s),arguments)}function Uz(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[ka(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return Uz().domain(e).range(t).unknown(n)},Ao.apply(i,arguments)}function nJ(e){return new Date(e)}function rJ(e){return e instanceof Date?+e:+new Date(+e)}function M$(e,t,n,r,i,o,s,a,u,l){var c=Oz(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),y=l("%I %p"),m=l("%a %d"),v=l("%b %d"),x=l("%B"),w=l("%Y");function b(S){return(u(S)<S?h:a(S)<S?p:s(S)<S?g:o(S)<S?y:r(S)<S?i(S)<S?m:v:n(S)<S?x:w)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,rJ)):d().map(nJ)},c.ticks=function(S){var E=d();return e(E[0],E[E.length-1],S??10)},c.tickFormat=function(S,E){return E==null?b:l(E)},c.nice=function(S){var E=d();return(!S||typeof S.range!="function")&&(S=t(E[0],E[E.length-1],S??10)),S?d(Lz(E,S)):c},c.copy=function(){return Lp(c,M$(e,t,n,r,i,o,s,a,u,l))},c}function iJ(){return Ao.apply(M$(cY,fY,xo,Yh,Nf,as,jy,Iy,ts,yk).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function oJ(){return Ao.apply(M$(uY,lY,wo,Xh,Of,va,Uy,By,ts,vk).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function cv(){var e=0,t=1,n,r,i,o,s=tr,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:s(i===0?.5:(f=(o(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(s=f,l):s};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,s=f(h,p),l):[s(0),s(1)]}}return l.range=c(Ya),l.rangeRound=c(Pp),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return o=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function Xa(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function T$(){var e=_l(cv()(tr));return e.copy=function(){return Xa(e,T$())},Va.apply(e,arguments)}function Wz(){var e=$$(cv()).domain([1,10]);return e.copy=function(){return Xa(e,Wz()).base(e.base())},Va.apply(e,arguments)}function qz(){var e=C$(cv());return e.copy=function(){return Xa(e,qz()).constant(e.constant())},Va.apply(e,arguments)}function N$(){var e=A$(cv());return e.copy=function(){return Xa(e,N$()).exponent(e.exponent())},Va.apply(e,arguments)}function sJ(){return N$.apply(null,arguments).exponent(.5)}function fv(){var e=0,t=.5,n=1,r=1,i,o,s,a,u,l=tr,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-o)*(r*g<r*o?a:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),o=c(t=+t),s=c(n=+n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function p(g){return function(y){var m,v,x;return arguments.length?([m,v,x]=y,l=k$(g,[m,v,x]),h):[l(0),l(.5),l(1)]}}return h.range=p(Ya),h.rangeRound=p(Pp),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,i=g(e),o=g(t),s=g(n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,h}}function Hz(){var e=_l(fv()(tr));return e.copy=function(){return Xa(e,Hz())},Va.apply(e,arguments)}function Vz(){var e=$$(fv()).domain([.1,1,10]);return e.copy=function(){return Xa(e,Vz()).base(e.base())},Va.apply(e,arguments)}function Gz(){var e=C$(fv());return e.copy=function(){return Xa(e,Gz()).constant(e.constant())},Va.apply(e,arguments)}function O$(){var e=A$(fv());return e.copy=function(){return Xa(e,O$()).exponent(e.exponent())},Va.apply(e,arguments)}function aJ(){return O$.apply(null,arguments).exponent(.5)}function Fo(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const uJ=Fo("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),lJ=Fo("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),cJ=Fo("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),fJ=Fo("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),dJ=Fo("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),hJ=Fo("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),pJ=Fo("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),gJ=Fo("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),mJ=Fo("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),yJ=Fo("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function R$(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const vJ="identity",Xc="linear",xs="log",zp="pow",Ip="sqrt",dv="symlog",Ju="time",el="utc",go="sequential",zf="diverging",Qc="quantile",hv="quantize",pv="threshold",D$="ordinal",fE="point",Yz="band",P$="bin-ordinal",Tt="continuous",Bp="discrete",jp="discretizing",si="interpolating",L$="temporal";function xJ(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function wJ(e){return function(t){const n=e.range();let r=t[0],i=t[1],o=-1,s,a,u,l;for(i<r&&(a=r,r=i,i=a),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(o<0&&(o=u),s=u);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[s]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function z$(){const e=w$().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,o,s=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=R$(f,a,u);let g=r[d-0];i=(h-g)/(p||1),s&&(i=Math.floor(i)),g+=(h-g-i*(f-a))*l,o=i*(1-a),s&&(g=Math.round(g),o=Math.round(o));const y=Er(f).map(m=>g+i*m);return n(d?y.reverse():y)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],s=!0,c()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(s=!!f,c()):s},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],y=+f[1],m,v,x;if(!(g!==g||y!==y)&&(y<g&&(x=g,g=y,y=x),!(y<h[0]||g>r[1-d])))return m=Math.max(0,ka(h,g)-1),v=g===y?m:ka(h,y)-1,g-h[m]>o+1e-10&&++m,d&&(x=m,m=p-v,v=p-x),m>v?void 0:t().slice(m,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return z$().domain(t()).range(r).round(s).paddingInner(a).paddingOuter(u).align(l)},c()}function Xz(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return Xz(t())},e}function bJ(){return Xz(z$().paddingInner(1))}var EJ=Array.prototype.map;function SJ(e){return EJ.call(e,vn)}const _J=Array.prototype.slice;function Qz(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(ka(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=SJ(r),n):e.slice()},n.range=function(r){return arguments.length?(t=_J.call(r),n):t.slice()},n.tickFormat=function(r,i){return Rz(e[0],$e(e),r??10,i)},n.copy=function(){return Qz().domain(n.domain()).range(n.range())},n}const t1=new Map,Kz=Symbol("vega_scale");function Zz(e){return e[Kz]=!0,e}function kJ(e){return e&&e[Kz]===!0}function $J(e,t,n){const r=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?xJ(o):o.invertExtent?wJ(o):void 0),o.type=e,Zz(o)};return r.metadata=Oi(K(n)),r}function Oe(e,t,n){return arguments.length>1?(t1.set(e,$J(e,t,n)),this):Jz(e)?t1.get(e):void 0}Oe(vJ,Pz);Oe(Xc,Dz,Tt);Oe(xs,zz,[Tt,xs]);Oe(zp,F$,Tt);Oe(Ip,tJ,Tt);Oe(dv,Iz,Tt);Oe(Ju,iJ,[Tt,L$]);Oe(el,oJ,[Tt,L$]);Oe(go,T$,[Tt,si]);Oe(`${go}-${Xc}`,T$,[Tt,si]);Oe(`${go}-${xs}`,Wz,[Tt,si,xs]);Oe(`${go}-${zp}`,N$,[Tt,si]);Oe(`${go}-${Ip}`,sJ,[Tt,si]);Oe(`${go}-${dv}`,qz,[Tt,si]);Oe(`${zf}-${Xc}`,Hz,[Tt,si]);Oe(`${zf}-${xs}`,Vz,[Tt,si,xs]);Oe(`${zf}-${zp}`,O$,[Tt,si]);Oe(`${zf}-${Ip}`,aJ,[Tt,si]);Oe(`${zf}-${dv}`,Gz,[Tt,si]);Oe(Qc,Bz,[jp,Qc]);Oe(hv,jz,jp);Oe(pv,Uz,jp);Oe(P$,Qz,[Bp,jp]);Oe(D$,w$,Bp);Oe(Yz,z$,Bp);Oe(fE,bJ,Bp);function Jz(e){return t1.has(e)}function kl(e,t){const n=t1.get(e);return n&&n.metadata[t]}function I$(e){return kl(e,Tt)}function Kc(e){return kl(e,Bp)}function dE(e){return kl(e,jp)}function e8(e){return kl(e,xs)}function CJ(e){return kl(e,L$)}function t8(e){return kl(e,si)}function n8(e){return kl(e,Qc)}const AJ=["clamp","base","constant","exponent"];function r8(e,t){const n=t[0],r=$e(t)-n;return function(i){return e(n+i*r)}}function gv(e,t,n){return k$(B$(t||"rgb",n),e)}function i8(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function o8(e,t,n){const r=n-t;let i,o,s;return!r||!Number.isFinite(r)?Cn(.5):(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),s=Oe(o)().domain([t,n]).range([0,1]),AJ.forEach(a=>e[a]?s[a](e[a]()):0),s)}function B$(e,t){const n=WZ[FJ(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function FJ(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const MJ={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},TJ={accent:lJ,category10:uJ,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:cJ,observable10:fJ,paired:dJ,pastel1:hJ,pastel2:pJ,set1:gJ,set2:mJ,set3:yJ,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function s8(e){if(I(e))return e;const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function a8(e,t){for(const n in e)j$(n,t(e[n]))}const zT={};a8(TJ,s8);a8(MJ,e=>gv(s8(e)));function j$(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(zT[e]=t,this):zT[e]}const Wm="symbol",NJ="discrete",OJ="gradient",RJ=e=>I(e)?e.map(t=>String(t)):String(e),DJ=(e,t)=>e[1]-t[1],PJ=(e,t)=>t[1]-e[1];function U$(e,t,n){let r;return Ae(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(Tp(e.domain())/n||1)+1))),Q(t)&&(r=t.step,t=t.interval),Z(t)&&(t=e.type===Ju?Rf(t):e.type==el?Df(t):z("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function u8(e,t,n){let r=e.range(),i=r[0],o=$e(r),s=DJ;if(i>o&&(r=o,o=i,i=r,s=PJ),i=Math.floor(i),o=Math.ceil(o),t=t.map(a=>[a,e(a)]).filter(a=>i<=a[1]&&a[1]<=o).sort(s).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],$e(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function W$(e,t){return e.bins?u8(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function l8(e,t,n,r,i,o){const s=t.type;let a=RJ;if(s===Ju||i===Ju)a=e.timeFormat(r);else if(s===el||i===el)a=e.utcFormat(r);else if(e8(s)){const u=e.formatFloat(r);if(o||t.bins)a=u;else{const l=c8(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(a=e.format(r));return a}function c8(e,t,n){const r=W$(e,t),i=e.base(),o=Math.log(i),s=Math.max(1,i*t/r.length),a=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/o));return l*i<i-.5&&(l*=i),l<=s};return n?r.filter(a):a}const hE={[Qc]:"quantiles",[hv]:"thresholds",[pv]:"domain"},f8={[Qc]:"quantiles",[hv]:"domain"};function d8(e,t){return e.bins?IJ(e.bins):e.type===xs?c8(e,t,!0):hE[e.type]?zJ(e[hE[e.type]]()):W$(e,t)}function LJ(e,t,n){const r=t[f8[t.type]](),i=r.length;let o=i>1?r[1]-r[0]:r[0],s;for(s=1;s<i;++s)o=Math.min(o,r[s]-r[s-1]);return e.formatSpan(0,o,3*10,n)}function zJ(e){const t=[-1/0].concat(e);return t.max=1/0,t}function IJ(e){const t=e.slice(0,-1);return t.max=$e(e),t}const BJ=e=>hE[e.type]||e.bins;function h8(e,t,n,r,i,o,s){const a=f8[t.type]&&o!==Ju&&o!==el?LJ(e,t,i):l8(e,t,n,i,o,s);return r===Wm&&BJ(t)?jJ(a):r===NJ?UJ(a):WJ(a)}const jJ=e=>(t,n,r)=>{const i=IT(r[n+1],IT(r.max,1/0)),o=BT(t,e),s=BT(i,e);return o&&s?o+"  "+s:s?"< "+s:" "+o},IT=(e,t)=>e??t,UJ=e=>(t,n)=>n?e(t):null,WJ=e=>t=>e(t),BT=(e,t)=>Number.isFinite(e)?t(e):null;function qJ(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+$e(t),o=i-r;if(e.type===pv){const s=n?o/n:.1;r-=s,i+=s,o=i-r}return s=>(s-r)/o}function HJ(e,t,n,r){const i=r||t.type;return Z(n)&&CJ(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===Ju?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===el?e.utcFormat("%A, %d %B %Y, %X UTC"):h8(e,t,5,null,n,r,!0)}function p8(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=HJ(e,t,n.format,n.formatType);if(dE(t.type)){const o=d8(t).slice(1).map(i),s=o.length;return`${s} boundar${s===1?"y":"ies"}: ${o.join(", ")}`}else if(Kc(t.type)){const o=t.domain(),s=o.length,a=s>r?o.slice(0,r-2).map(i).join(", ")+", ending with "+o.slice(-1).map(i):o.map(i).join(", ");return`${s} value${s===1?"":"s"}: ${a}`}else{const o=t.domain();return`values from ${i(o[0])} to ${i($e(o))}`}}let g8=0;function VJ(){g8=0}const n1="p_";function q$(e){return e&&e.gradient}function m8(e,t,n){const r=e.gradient;let i=e.id,o=r==="radial"?n1:"";return i||(i=e.id="gradient_"+g8++,r==="radial"?(e.x1=Ki(e.x1,.5),e.y1=Ki(e.y1,.5),e.r1=Ki(e.r1,0),e.x2=Ki(e.x2,.5),e.y2=Ki(e.y2,.5),e.r2=Ki(e.r2,.5),o=n1):(e.x1=Ki(e.x1,0),e.y1=Ki(e.y1,0),e.x2=Ki(e.x2,1),e.y2=Ki(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function Ki(e,t){return e??t}function y8(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,o){return n.push({offset:i,color:o}),r}}}const jT={basis:{curve:jK},"basis-closed":{curve:UK},"basis-open":{curve:WK},bundle:{curve:qK,tension:"beta",value:.85},cardinal:{curve:HK,tension:"tension",value:0},"cardinal-open":{curve:GK,tension:"tension",value:0},"cardinal-closed":{curve:VK,tension:"tension",value:0},"catmull-rom":{curve:YK,tension:"alpha",value:.5},"catmull-rom-closed":{curve:XK,tension:"alpha",value:.5},"catmull-rom-open":{curve:QK,tension:"alpha",value:.5},linear:{curve:g$},"linear-closed":{curve:KK},monotone:{horizontal:JK,vertical:ZK},natural:{curve:eZ},step:{curve:tZ},"step-after":{curve:rZ},"step-before":{curve:nZ}};function H$(e,t,n){var r=ae(jT,e)&&jT[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const GJ={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},YJ=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,XJ=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,QJ=/^((\s+,?\s*)|(,\s*))/,KJ=/^[01]/;function Zc(e){const t=[];return(e.match(YJ)||[]).forEach(r=>{let i=r[0];const o=i.toLowerCase(),s=GJ[o],a=ZJ(o,s,r.slice(1).trim()),u=a.length;if(u<s||u&&u%s!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...a.slice(0,s)]),u!==s){o==="m"&&(i=i==="M"?"L":"l");for(let l=s;l<u;l+=s)t.push([i,...a.slice(l,l+s)])}}),t}function ZJ(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let o=0;o<t;++o){const s=e==="a"&&(o===3||o===4)?KJ:XJ,a=n.slice(i).match(s);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const u=n.slice(i).match(QJ);u!==null&&(i+=u[0].length)}return r}const Ma=Math.PI/180,JJ=1e-14,Su=Math.PI/2,oo=Math.PI*2,Bl=Math.sqrt(3)/2;var P2={},L2={},v8=[].join;function eee(e,t,n,r,i,o,s,a,u){const l=v8.call(arguments);if(P2[l])return P2[l];const c=s*Ma,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(a-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(a-e)*.5;let g=h*h/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const y=d/n,m=f/n,v=-f/r,x=d/r,w=y*a+m*u,b=v*a+x*u,S=y*e+m*t,E=v*e+x*t;let k=1/((S-w)*(S-w)+(E-b)*(E-b))-.25;k<0&&(k=0);let $=Math.sqrt(k);o==i&&($=-$);const C=.5*(w+S)-$*(E-b),R=.5*(b+E)+$*(S-w),A=Math.atan2(b-R,w-C);let F=Math.atan2(E-R,S-C)-A;F<0&&o===1?F+=oo:F>0&&o===0&&(F-=oo);const N=Math.ceil(Math.abs(F/(Su+.001))),P=[];for(let T=0;T<N;++T){const O=A+T*F/N,j=A+(T+1)*F/N;P[T]=[C,R,O,j,n,r,f,d]}return P2[l]=P}function tee(e){const t=v8.call(e);if(L2[t])return L2[t];var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7];const c=l*s,f=-u*a,d=u*s,h=l*a,p=Math.cos(i),g=Math.sin(i),y=Math.cos(o),m=Math.sin(o),v=.5*(o-i),x=Math.sin(v*.5),w=8/3*x*x/Math.sin(v),b=n+p-w*g,S=r+g+w*p,E=n+y,_=r+m,k=E+w*m,$=_-w*y;return L2[t]=[c*b+f*S,d*b+h*S,c*k+f*$,d*k+h*$,c*E+f*_,d*E+h*_]}const Pr=["l",0,0,0,0,0,0,0];function nee(e,t,n){const r=Pr[0]=e[0];if(r==="a"||r==="A")Pr[1]=t*e[1],Pr[2]=n*e[2],Pr[3]=e[3],Pr[4]=e[4],Pr[5]=e[5],Pr[6]=t*e[6],Pr[7]=n*e[7];else if(r==="h"||r==="H")Pr[1]=t*e[1];else if(r==="v"||r==="V")Pr[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)Pr[i]=(i%2==1?t:n)*e[i];return Pr}function np(e,t,n,r,i,o){var s,a=null,u=0,l=0,c=0,f=0,d,h,p,g,y=0,m=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),o==null&&(o=i),e.beginPath&&e.beginPath();for(var v=0,x=t.length;v<x;++v){switch(s=t[v],(i!==1||o!==1)&&(s=nee(s,i,o)),s[0]){case"l":u+=s[1],l+=s[2],e.lineTo(u+n,l+r);break;case"L":u=s[1],l=s[2],e.lineTo(u+n,l+r);break;case"h":u+=s[1],e.lineTo(u+n,l+r);break;case"H":u=s[1],e.lineTo(u+n,l+r);break;case"v":l+=s[1],e.lineTo(u+n,l+r);break;case"V":l=s[1],e.lineTo(u+n,l+r);break;case"m":u+=s[1],l+=s[2],y=u,m=l,e.moveTo(u+n,l+r);break;case"M":u=s[1],l=s[2],y=u,m=l,e.moveTo(u+n,l+r);break;case"c":d=u+s[5],h=l+s[6],c=u+s[3],f=l+s[4],e.bezierCurveTo(u+s[1]+n,l+s[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=s[5],l=s[6],c=s[3],f=s[4],e.bezierCurveTo(s[1]+n,s[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+s[3],h=l+s[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+s[1]+n,l+s[2]+r,d+n,h+r),c=u+s[1],f=l+s[2],u=d,l=h;break;case"S":d=s[3],h=s[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,s[1]+n,s[2]+r,d+n,h+r),u=d,l=h,c=s[1],f=s[2];break;case"q":d=u+s[3],h=l+s[4],c=u+s[1],f=l+s[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=s[3],h=s[4],e.quadraticCurveTo(s[1]+n,s[2]+r,d+n,h+r),u=d,l=h,c=s[1],f=s[2];break;case"t":d=u+s[1],h=l+s[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-p,f=2*l-g):a[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+s[1],f=l+s[2];break;case"T":d=s[1],h=s[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":UT(e,u+n,l+r,[s[1],s[2],s[3],s[4],s[5],s[6]+u+n,s[7]+l+r]),u+=s[6],l+=s[7];break;case"A":UT(e,u+n,l+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),u=s[6],l=s[7];break;case"z":case"Z":u=y,l=m,e.closePath();break}a=s}}function UT(e,t,n,r){const i=eee(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){const s=tee(i[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}const WT=.5773502691896257,qT={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,oo)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bl*n,i=r-n*WT,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bl*n,i=r-n*WT;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bl*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bl*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bl*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bl*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function x8(e){return ae(qT,e)?qT[e]:ree(e)}var z2={};function ree(e){if(!ae(z2,e)){const t=Zc(e);z2[e]={draw:function(n,r){np(n,t,0,0,Math.sqrt(r)/2)}}}return z2[e]}const Ds=.448084975506;function iee(e){return e.x}function oee(e){return e.y}function see(e){return e.width}function aee(e){return e.height}function Bo(e){return typeof e=="function"?e:()=>+e}function Xg(e,t,n){return Math.max(t,Math.min(e,n))}function w8(){var e=iee,t=oee,n=see,r=aee,i=Bo(0),o=i,s=i,a=i,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),y=+n.call(this,c),m=+r.call(this,c),v=Math.min(y,m)/2,x=Xg(+i.call(this,c),0,v),w=Xg(+o.call(this,c),0,v),b=Xg(+s.call(this,c),0,v),S=Xg(+a.call(this,c),0,v);if(u||(u=h=nv()),x<=0&&w<=0&&b<=0&&S<=0)u.rect(p,g,y,m);else{var E=p+y,_=g+m;u.moveTo(p+x,g),u.lineTo(E-w,g),u.bezierCurveTo(E-Ds*w,g,E,g+Ds*w,E,g+w),u.lineTo(E,_-S),u.bezierCurveTo(E,_-Ds*S,E-Ds*S,_,E-S,_),u.lineTo(p+b,_),u.bezierCurveTo(p+Ds*b,_,p,_-Ds*b,p,_-b),u.lineTo(p,g+x),u.bezierCurveTo(p,g+Ds*x,p+Ds*x,g,p+x,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=Bo(c),l):e},l.y=function(c){return arguments.length?(t=Bo(c),l):t},l.width=function(c){return arguments.length?(n=Bo(c),l):n},l.height=function(c){return arguments.length?(r=Bo(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=Bo(c),o=f!=null?Bo(f):i,a=d!=null?Bo(d):i,s=h!=null?Bo(h):o,l):i},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function b8(){var e,t,n,r,i=null,o,s,a,u;function l(f,d,h){const p=h/2;if(o){var g=a-d,y=f-s;if(g||y){var m=Math.hypot(g,y),v=(g/=m)*u,x=(y/=m)*u,w=Math.atan2(y,g);i.moveTo(s-v,a-x),i.lineTo(f-g*p,d-y*p),i.arc(f,d,p,w-Math.PI,w),i.lineTo(s+v,a+x),i.arc(s,a,u,w,w+Math.PI)}else i.arc(f,d,p,0,oo);i.closePath()}else o=1;s=f,a=d,u=p}function c(f){var d,h=f.length,p,g=!1,y;for(i==null&&(i=y=nv()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===g&&(g=!g)&&(o=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(y)return i=null,y+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function Up(e,t){return e??t}const Wp=e=>e.x||0,qp=e=>e.y||0,uee=e=>e.width||0,lee=e=>e.height||0,cee=e=>(e.x||0)+(e.width||0),fee=e=>(e.y||0)+(e.height||0),dee=e=>e.startAngle||0,hee=e=>e.endAngle||0,pee=e=>e.padAngle||0,gee=e=>e.innerRadius||0,mee=e=>e.outerRadius||0,yee=e=>e.cornerRadius||0,vee=e=>Up(e.cornerRadiusTopLeft,e.cornerRadius)||0,xee=e=>Up(e.cornerRadiusTopRight,e.cornerRadius)||0,wee=e=>Up(e.cornerRadiusBottomRight,e.cornerRadius)||0,bee=e=>Up(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Eee=e=>Up(e.size,64),See=e=>e.size||1,mv=e=>e.defined!==!1,_ee=e=>x8(e.shape||"circle"),kee=zK().startAngle(dee).endAngle(hee).padAngle(pee).innerRadius(gee).outerRadius(mee).cornerRadius(yee),$ee=QL().x(Wp).y1(qp).y0(fee).defined(mv),Cee=QL().y(qp).x1(Wp).x0(cee).defined(mv),Aee=XL().x(Wp).y(qp).defined(mv),Fee=w8().x(Wp).y(qp).width(uee).height(lee).cornerRadius(vee,xee,wee,bee),Mee=BK().type(_ee).size(Eee),Tee=b8().x(Wp).y(qp).defined(mv).size(See);function V$(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Nee(e,t){return kee.context(e)(t)}function Oee(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?Cee:$ee).curve(H$(r,n.orient,n.tension)).context(e)(t)}function Ree(e,t){const n=t[0],r=n.interpolate||"linear";return Aee.curve(H$(r,n.orient,n.tension)).context(e)(t)}function If(e,t,n,r){return Fee.context(e)(t,n,r)}function Dee(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Pee(e,t){return Mee.context(e)(t)}function Lee(e,t){return Tee.context(e)(t)}var E8=1;function S8(){E8=1}function G$(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+E8++),s=i.clipping[o]||(i.clipping[o]={id:o});return ge(r)?s.path=r(null):V$(n)?s.path=If(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function Et(e){this.clear(),e&&this.union(e)}Et.prototype={clone(){return new Et(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*r-u*i+l,u*r+a*i+c,a*r-u*s+l,u*r+a*s+c,a*o-u*i+l,u*o+a*i+c,a*o-u*s+l,u*o+a*s+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function yv(e){this.mark=e,this.bounds=this.bounds||new Et}function vv(e){yv.call(this,e),this.items=this.items||[]}G(vv,yv);class _8{constructor(t){this._pending=0,this._loader=t||qy()}pending(){return this._pending}sanitizeURL(t){const n=this;return HT(n),n._loader.sanitize(t,{context:"href"}).then(r=>(md(n),r)).catch(()=>(md(n),null))}loadImage(t){const n=this,r=iZ();return HT(n),n._loader.sanitize(t,{context:"image"}).then(i=>{const o=i.href;if(!o||!r)throw{url:o};const s=new r,a=ae(i,"crossOrigin")?i.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>md(n),s.onerror=()=>md(n),s.src=o,s}).catch(i=>(md(n),{complete:!1,width:0,height:0,src:i&&i.url||""}))}ready(){const t=this;return new Promise(n=>{function r(i){t.pending()?setTimeout(()=>{r(!0)},10):n(i)}r(!1)})}}function HT(e){e._pending+=1}function md(e){e._pending-=1}function Ss(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?zee(t,r):0))}return e}function zee(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const Iee=oo-1e-8;let xv,qm,Hm,Nu,pE,Vm,gE,mE;const Js=(e,t)=>xv.add(e,t),Gm=(e,t)=>Js(qm=e,Hm=t),VT=e=>Js(e,xv.y1),GT=e=>Js(xv.x1,e),_u=(e,t)=>pE*e+gE*t,ku=(e,t)=>Vm*e+mE*t,I2=(e,t)=>Js(_u(e,t),ku(e,t)),B2=(e,t)=>Gm(_u(e,t),ku(e,t));function Hp(e,t){return xv=e,t?(Nu=t*Ma,pE=mE=Math.cos(Nu),Vm=Math.sin(Nu),gE=-Vm):(pE=mE=1,Nu=Vm=gE=0),Bee}const Bee={beginPath(){},closePath(){},moveTo:B2,lineTo:B2,rect(e,t,n,r){Nu?(I2(e+n,t),I2(e+n,t+r),I2(e,t+r),B2(e,t)):(Js(e+n,t+r),Gm(e,t))},quadraticCurveTo(e,t,n,r){const i=_u(e,t),o=ku(e,t),s=_u(n,r),a=ku(n,r);YT(qm,i,s,VT),YT(Hm,o,a,GT),Gm(s,a)},bezierCurveTo(e,t,n,r,i,o){const s=_u(e,t),a=ku(e,t),u=_u(n,r),l=ku(n,r),c=_u(i,o),f=ku(i,o);XT(qm,s,u,c,VT),XT(Hm,a,l,f,GT),Gm(c,f)},arc(e,t,n,r,i,o){if(r+=Nu,i+=Nu,qm=n*Math.cos(i)+e,Hm=n*Math.sin(i)+t,Math.abs(i-r)>Iee)Js(e-n,t-n),Js(e+n,t+n);else{const s=l=>Js(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(s(r),s(i),i!==r)if(r=r%oo,r<0&&(r+=oo),i=i%oo,i<0&&(i+=oo),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=oo,a=r-r%Su,u=0;u<4&&a>i;++u,a-=Su)s(a);else for(a=r-r%Su+Su,u=0;u<4&&a<i;++u,a=a+Su)s(a)}}};function YT(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function XT(e,t,n,r,i){const o=r-e+3*t-3*n,s=e+n-2*t,a=e-t;let u=0,l=0,c;Math.abs(o)>JJ?(c=s*s+a*o,c>=0&&(c=Math.sqrt(c),u=(-s+c)/o,l=(-s-c)/o)):u=.5*a/s,0<u&&u<1&&i(QT(u,e,t,n,r)),0<l&&l<1&&i(QT(l,e,t,n,r))}function QT(e,t,n,r,i){const o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*r+a*e*i}var ba=(ba=wa(1,1))?ba.getContext("2d"):null;const yE=new Et;function Y$(e){return function(t,n){if(!ba)return!0;e(ba,t),yE.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:s}=yE;for(let a=i;a<=s;++a)for(let u=r;u<=o;++u)if(ba.isPointInPath(u,a))return!0;return!1}}function X$(e,t){return t.contains(e.x||0,e.y||0)}function k8(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(yE.set(n,r,n+i,r+o))}function $8(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:r;return hc(t,n,r,i,o)}function hc(e,t,n,r,i){const{x1:o,y1:s,x2:a,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,p,g,y;for(y=0;y<4;++y){if(y===0&&(h=-l,p=-(o-t)),y===1&&(h=l,p=a-t),y===2&&(h=-c,p=-(s-n)),y===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function Jc(e,t){e.globalCompositeOperation=t.blend||"source-over"}function fi(e,t){return e??t}function KT(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function jee(e,t,n){const r=n.width(),i=n.height();let o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+fi(t.x1,.5)*r,n.y1+fi(t.y1,.5)*i,Math.max(r,i)*fi(t.r1,0),n.x1+fi(t.x2,.5)*r,n.y1+fi(t.y2,.5)*i,Math.max(r,i)*fi(t.r2,.5));else{const s=fi(t.x1,0),a=fi(t.y1,0),u=fi(t.x2,1),l=fi(t.y2,0);if(s===u||a===l||r===i)o=e.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+u*r,n.y1+l*i);else{const c=wa(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=KT(f.createLinearGradient(s,a,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return KT(o,t.stops)}function C8(e,t,n){return q$(n)?jee(e,n,t.bounds):n}function r1(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=C8(e,t,t.fill),!0):!1}var Uee=[];function ef(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=C8(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Uee),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function Wee(e,t){return e.zindex-t.zindex||e.index-t.index}function Q$(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,o;for(i=0,o=t.length;i<o;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(Wee)}function Di(e,t){var n=e.items,r,i;if(!n||!n.length)return;const o=Q$(e);if(o&&o.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=o}for(r=0,i=n.length;r<i;++r)t(n[r])}function i1(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const o=Q$(e);for(o&&o.length&&(n=o),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===o){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function K$(e){return function(t,n,r){Di(n,i=>{(!r||r.intersects(i.bounds))&&A8(e,t,i,i)})}}function qee(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&A8(e,t,n.items[0],n.items)}}function A8(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Jc(t,n),n.fill&&r1(t,n,i)&&t.fill(),n.stroke&&ef(t,n,i)&&t.stroke()))}function wv(e){return e=e||ei,function(t,n,r,i,o,s){return r*=t.pixelRatio,i*=t.pixelRatio,i1(n,a=>{const u=a.bounds;if(!(u&&!u.contains(o,s)||!u)&&e(t,a,r,i,o,s))return a})}}function Vp(e,t){return function(n,r,i,o){var s=Array.isArray(r)?r[0]:r,a=t??s.fill,u=s.stroke&&n.isPointInStroke,l,c;return u&&(l=s.strokeWidth,c=s.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:a&&n.isPointInPath(i,o)||u&&n.isPointInStroke(i,o)}}function Z$(e){return wv(Vp(e))}function Bu(e,t){return"translate("+e+","+t+")"}function J$(e){return"rotate("+e+")"}function Hee(e,t){return"scale("+e+","+t+")"}function F8(e){return Bu(e.x||0,e.y||0)}function Vee(e){return Bu(e.x||0,e.y||0)+(e.angle?" "+J$(e.angle):"")}function Gee(e){return Bu(e.x||0,e.y||0)+(e.angle?" "+J$(e.angle):"")+(e.scaleX||e.scaleY?" "+Hee(e.scaleX||1,e.scaleY||1):"")}function eC(e,t,n){function r(s,a){s("transform",Vee(a)),s("d",t(null,a))}function i(s,a){return t(Hp(s,a.angle),a),Ss(s,a).translate(a.x||0,a.y||0)}function o(s,a){var u=a.x||0,l=a.y||0,c=a.angle||0;s.translate(u,l),c&&s.rotate(c*=Ma),s.beginPath(),t(s,a),c&&s.rotate(-c),s.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:K$(o),pick:Z$(o),isect:n||Y$(o)}}var Yee=eC("arc",Nee);function Xee(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,o=1/0,s,a;--i>=0;)e[i].defined!==!1&&(a=Math.abs(e[i][r]-n),a<o&&(o=a,s=e[i]));return s}function Qee(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,o,s;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],o=e[r].y-t[1],s=i*i+o*o,s<n))return e[r];return null}function Kee(e,t){for(var n=e.length,r,i,o;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],o=r*r+i*i,r=e[n].size||1,o<r*r))return e[n];return null}function tC(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(Hp(u),c),Ss(u,c[0]))}function o(u,l){u.beginPath(),t(u,l)}const s=Vp(o);function a(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,s(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:qee(o),pick:a,isect:X$,tip:n}}var Zee=tC("area",Oee,Xee);function Jee(e,t){var n=t.clip;e.save(),ge(n)?(e.beginPath(),n(e),e.clip()):M8(e,t.group)}function M8(e,t){e.beginPath(),V$(t)?If(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function T8(e){const t=fi(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function ete(e,t){e("transform",F8(t))}function N8(e,t){const n=T8(t);e("d",If(null,t,n,n))}function tte(e,t){e("class","background"),e("aria-hidden",!0),N8(e,t)}function nte(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?N8(e,t):e("d","")}function rte(e,t,n){const r=t.clip?G$(n,t,t):null;e("clip-path",r)}function ite(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Ss(e,t),e.translate(t.x||0,t.y||0)}function rp(e,t,n,r){const i=T8(t);e.beginPath(),If(e,t,(n||0)+i,(r||0)+i)}const ote=Vp(rp),ste=Vp(rp,!1),ate=Vp(rp,!0);function ute(e,t,n,r){Di(t,i=>{const o=i.x||0,s=i.y||0,a=i.strokeForeground,u=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&u&&(rp(e,i,o,s),Jc(e,i),i.fill&&r1(e,i,u)&&e.fill(),i.stroke&&!a&&ef(e,i,u)&&e.stroke()),e.save(),e.translate(o,s),i.clip&&M8(e,i),n&&n.translate(-o,-s),Di(i,l=>{(l.marktype==="group"||r==null||r.includes(l.marktype))&&this.draw(e,l,n,r)}),n&&n.translate(o,s),e.restore(),a&&i.stroke&&u&&(rp(e,i,o,s),Jc(e,i),ef(e,i,u)&&e.stroke())})}function lte(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const s=n*e.pixelRatio,a=r*e.pixelRatio;return i1(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,o))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(i<c||i>h||o<f||o>p))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,g&&V$(u)&&!ate(e,u,s,a))return e.restore(),null;const y=u.strokeForeground,m=t.interactive!==!1;return m&&y&&u.stroke&&ste(e,u,s,a)?(e.restore(),u):(l=i1(u,v=>cte(v,c,f)?this.pick(v,n,r,c,f):null),!l&&m&&(u.fill||!y&&u.stroke)&&ote(e,u,s,a)&&(l=u),e.restore(),l||null)})}function cte(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var fte={type:"group",tag:"g",nested:!1,attr:ete,bound:ite,draw:ute,pick:lte,isect:k8,content:rte,background:tte,foreground:nte},ip={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function nC(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function rC(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function iC(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function bv(e,t){return e==="center"?t/2:e==="right"?t:0}function Ev(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function dte(e,t,n){const r=nC(t,n),i=rC(t,r),o=iC(t,r),s=(t.x||0)-bv(t.align,i),a=(t.y||0)-Ev(t.baseline,o),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,ip["xmlns:xlink"],"xlink:href"),e("transform",Bu(s,a)),e("width",i),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function hte(e,t){const n=t.image,r=rC(t,n),i=iC(t,n),o=(t.x||0)-bv(t.align,r),s=(t.y||0)-Ev(t.baseline,i);return e.set(o,s,o+r,s+i)}function pte(e,t,n){Di(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=nC(r,this);let o=rC(r,i),s=iC(r,i);if(o===0||s===0)return;let a=(r.x||0)-bv(r.align,o),u=(r.y||0)-Ev(r.baseline,s),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,u+=(s-d)/2,s=d):(d=s*c,a+=(o-d)/2,o=d))),(i.complete||i.toDataURL)&&(Jc(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,a,u,o,s))})}var gte={type:"image",tag:"image",nested:!1,attr:dte,bound:hte,draw:pte,pick:wv(),isect:ei,get:nC,xOffset:bv,yOffset:Ev},mte=tC("line",Ree,Qee);function yte(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",Gee(t)),e("d",t.path)}function Ym(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*Ma,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Zc(n)).path=n),a&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(a),np(e,u,0,0,o,s),e.rotate(-a),e.translate(-r,-i)):np(e,u,r,i,o,s)}function vte(e,t){return Ym(Hp(e,t.angle),t)?e.set(0,0,0,0):Ss(e,t,!0)}var xte={type:"path",tag:"path",nested:!1,attr:yte,bound:vte,draw:K$(Ym),pick:Z$(Ym),isect:Y$(Ym)};function wte(e,t){e("d",If(null,t))}function bte(e,t){var n,r;return Ss(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function ZT(e,t){e.beginPath(),If(e,t)}var Ete={type:"rect",tag:"path",nested:!1,attr:wte,bound:bte,draw:K$(ZT),pick:Z$(ZT),isect:k8};function Ste(e,t){e("transform",F8(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function _te(e,t){var n,r;return Ss(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function O8(e,t,n){var r,i,o,s;return t.stroke&&ef(e,t,n)?(r=t.x||0,i=t.y||0,o=t.x2!=null?t.x2:r,s=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,s),!0):!1}function kte(e,t,n){Di(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&O8(e,r,i)&&(Jc(e,r),e.stroke())}})}function $te(e,t,n,r){return e.isPointInStroke?O8(e,t,1)&&e.isPointInStroke(n,r):!1}var Cte={type:"rule",tag:"line",nested:!1,attr:Ste,bound:_te,draw:kte,pick:wv($te),isect:$8},Ate=eC("shape",Dee),Fte=eC("symbol",Pee,X$);const JT=B6();var kr={height:Mo,measureWidth:oC,estimateWidth:o1,width:o1,canvas:R8};R8(!0);function R8(e){kr.width=e&&ba?oC:o1}function o1(e,t){return D8(Na(e,t),Mo(e))}function D8(e,t){return~~(.8*e.length*t)}function oC(e,t){return Mo(e)<=0||!(t=Na(e,t))?0:P8(t,Sv(e))}function P8(e,t){const n=`(${t}) ${e}`;let r=JT.get(n);return r===void 0&&(ba.font=t,r=ba.measureText(e).width,JT.set(n,r)),r}function Mo(e){return e.fontSize!=null?+e.fontSize||0:11}function Ta(e){return e.lineHeight!=null?e.lineHeight:Mo(e)+2}function Mte(e){return I(e)?e.length>1?e:e[0]:e}function Gp(e){return Mte(e.lineBreak&&e.text&&!I(e.text)?e.text.split(e.lineBreak):e.text)}function sC(e){const t=Gp(e);return(I(t)?t.length-1:0)*Ta(e)}function Na(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Nte(e,n):n}function Tte(e){if(kr.width===oC){const t=Sv(e);return n=>P8(n,t)}else if(kr.width===o1){const t=Mo(e);return n=>D8(n,t)}else return t=>kr.width(e,t)}function Nte(e,t){var n=+e.limit,r=Tte(e);if(r(t)<n)return t;var i=e.ellipsis||"",o=e.dir==="rtl",s=0,a=t.length,u;if(n-=r(i),o){for(;s<a;)u=s+a>>>1,r(t.slice(u))>n?s=u+1:a=u;return i+t.slice(s)}else{for(;s<a;)u=1+(s+a>>>1),r(t.slice(0,u))<n?s=u:a=u-1;return t.slice(0,s)+i}}function Yp(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Sv(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Mo(e)+"px "+Yp(e,t)}function aC(e){var t=e.baseline,n=Mo(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Ta(e):t==="line-bottom"?.29*n-.5*Ta(e):0)}const Ote={left:"start",center:"middle",right:"end"},mh=new Et;function _v(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-Su,t+=r*Math.cos(i),n+=r*Math.sin(i)),mh.x1=t,mh.y1=n,mh}function Rte(e,t){var n=t.dx||0,r=(t.dy||0)+aC(t),i=_v(t),o=i.x1,s=i.y1,a=t.angle||0,u;e("text-anchor",Ote[t.align]||"start"),a?(u=Bu(o,s)+" "+J$(a),(n||r)&&(u+=" "+Bu(n,r))):u=Bu(o+n,s+r),e("transform",u)}function uC(e,t,n){var r=kr.height(t),i=t.align,o=_v(t),s=o.x1,a=o.y1,u=t.dx||0,l=(t.dy||0)+aC(t)-Math.round(.8*r),c=Gp(t),f;if(I(c)?(r+=Ta(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,kr.width(t,h)),0)):f=kr.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=s,l+=a,u+f,l+r),t.angle&&!n)e.rotate(t.angle*Ma,s,a);else if(n===2)return e.rotatedPoints(t.angle*Ma,s,a);return e}function Dte(e,t,n){Di(t,r=>{var i=r.opacity==null?1:r.opacity,o,s,a,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=Sv(r),e.textAlign=r.align||"left",o=_v(r),s=o.x1,a=o.y1,r.angle&&(e.save(),e.translate(s,a),e.rotate(r.angle*Ma),s=a=0),s+=r.dx||0,a+=(r.dy||0)+aC(r),c=Gp(r),Jc(e,r),I(c))for(l=Ta(r),u=0;u<c.length;++u)f=Na(r,c[u]),r.fill&&r1(e,r,i)&&e.fillText(f,s,a),r.stroke&&ef(e,r,i)&&e.strokeText(f,s,a),a+=l;else f=Na(r,c),r.fill&&r1(e,r,i)&&e.fillText(f,s,a),r.stroke&&ef(e,r,i)&&e.strokeText(f,s,a);r.angle&&e.restore()}})}function Pte(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=_v(t),a=s.x1,u=s.y1,l=uC(mh,t,1),c=-t.angle*Ma,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(a-f*a+d*u),p=d*i+f*o+(u-d*a-f*u);return l.contains(h,p)}function Lte(e,t){const n=uC(mh,e,2);return hc(t,n[0],n[1],n[2],n[3])||hc(t,n[0],n[1],n[4],n[5])||hc(t,n[4],n[5],n[6],n[7])||hc(t,n[2],n[3],n[6],n[7])}var zte={type:"text",tag:"text",nested:!1,attr:Rte,bound:uC,draw:Dte,pick:wv(Pte),isect:Lte},Ite=tC("trail",Lee,Kee),Tr={arc:Yee,area:Zee,group:fte,image:gte,line:mte,path:xte,rect:Ete,rule:Cte,shape:Ate,symbol:Fte,text:zte,trail:Ite};function vE(e,t,n){var r=Tr[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Et),e,n)}var eN={mark:null};function L8(e,t,n){var r=Tr[e.marktype],i=r.bound,o=e.items,s=o&&o.length,a,u,l,c;if(r.nested)return s?l=o[0]:(eN.mark=e,l=eN),c=vE(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Et,s)for(a=0,u=o.length;a<u;++a)t.union(vE(o[a],i,n));return e.bounds=t}const Bte=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function z8(e,t){return JSON.stringify(e,Bte,t)}function I8(e){const t=typeof e=="string"?JSON.parse(e):e;return B8(t)}function B8(e){var t=e.marktype,n=e.items,r,i,o;if(n)for(i=0,o=n.length;i<o;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&B8(n[i]);return t&&L8(e),e}class j8{constructor(t){arguments.length?this.root=I8(t):(this.root=tN({marktype:"group",name:"root",role:"frame"}),this.root.items=[new vv(this.root)])}toJSON(t){return z8(this.root,t||0)}mark(t,n,r){n=n||this.root.items[0];const i=tN(t,n);return n.items[r]=i,i.zindex&&(i.group.zdirty=!0),i}}function tN(e,t){const n={bounds:new Et,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function ea(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function lC(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function kt(e,t,n,r){var i=e.childNodes[t],o;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(o=i||null,i=ea(e.ownerDocument,n,r),e.insertBefore(i,o)),i}function jr(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function U8(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function kv(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function jte(e,t,n,r){var i=e&&e.mark,o,s;if(i&&(o=Tr[i.marktype]).tip){for(s=kv(t,n),s[0]-=r[0],s[1]-=r[1];e=e.mark.group;)s[0]-=e.x||0,s[1]-=e.y||0;e=o.tip(i.items,s)}return e}let cC=class{constructor(t,n){this._active=null,this._handlers={},this._loader=t||qy(),this._tooltip=n||Ute}initialize(t,n,r){return this._el=t,this._obj=r||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,n,r){for(let i=t?t.length:0;--i>=0;)if(t[i].type===n&&(!r||t[i].handler===r))return i;return-1}handlers(t){const n=this._handlers,r=[];if(t)r.push(...n[this.eventName(t)]);else for(const i in n)r.push(...n[i]);return r}eventName(t){const n=t.indexOf(".");return n<0?t:t.slice(0,n)}handleHref(t,n,r){this._loader.sanitize(r,{context:"href"}).then(i=>{const o=new MouseEvent(t.type,t),s=ea(null,"a");for(const a in i)s.setAttribute(a,i[a]);s.dispatchEvent(o)}).catch(()=>{})}handleTooltip(t,n,r){if(n&&n.tooltip!=null){n=jte(n,t,this.canvas(),this._origin);const i=r&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,t,n,i)}}getItemBoundingClientRect(t){const n=this.canvas();if(!n)return;const r=n.getBoundingClientRect(),i=this._origin,o=t.bounds,s=o.width(),a=o.height();let u=o.x1+i[0]+r.left,l=o.y1+i[1]+r.top;for(;t.mark&&(t=t.mark.group);)u+=t.x||0,l+=t.y||0;return{x:u,y:l,width:s,height:a,left:u,top:l,right:u+s,bottom:l+a}}};function Ute(e,t,n,r){e.element().setAttribute("title",r||"")}class Xp{constructor(t){this._el=null,this._bgcolor=null,this._loader=new _8(t)}initialize(t,n,r,i,o){return this._el=t,this.resize(n,r,i,o)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)}resize(t,n,r,i){return this._width=t,this._height=n,this._origin=r||[0,0],this._scale=i||1,this}dirty(){}render(t,n){const r=this;return r._call=function(){r._render(t,n)},r._call(),r._call=null,r}_render(){}renderAsync(t,n){const r=this.render(t,n);return this._ready?this._ready.then(()=>r):Promise.resolve(r)}_load(t,n){var r=this,i=r._loader[t](n);if(!r._ready){const o=r._call;r._ready=r._loader.ready().then(s=>{s&&o(),r._ready=null})}return i}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}}const Wte="keydown",qte="keypress",Hte="keyup",W8="dragenter",Xm="dragleave",q8="dragover",xE="pointerdown",Vte="pointerup",s1="pointermove",Qm="pointerout",H8="pointerover",wE="mousedown",Gte="mouseup",V8="mousemove",a1="mouseout",G8="mouseover",u1="click",Yte="dblclick",Xte="wheel",Y8="mousewheel",l1="touchstart",c1="touchmove",f1="touchend",Qte=[Wte,qte,Hte,W8,Xm,q8,xE,Vte,s1,Qm,H8,wE,Gte,V8,a1,G8,u1,Yte,Xte,Y8,l1,c1,f1],bE=s1,yh=a1,EE=u1;class Qp extends cC{constructor(t,n){super(t,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=Qte,this.pointermove=rN([s1,V8],[H8,G8],[Qm,a1]),this.dragover=rN([q8],[W8],[Xm]),this.pointerout=iN([Qm,a1]),this.dragleave=iN([Xm])}initialize(t,n,r){return this._canvas=t&&lC(t,"canvas"),[u1,wE,xE,s1,Qm,Xm].forEach(i=>nN(this,i)),super.initialize(t,n,r)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(Y8,t)}pointerdown(t){this._down=this._active,this.fire(xE,t)}mousedown(t){this._down=this._active,this.fire(wE,t)}click(t){this._down===this._active&&(this.fire(u1,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(l1,t,!0)}touchmove(t){this.fire(c1,t,!0)}touchend(t){this.fire(f1,t,!0),this._touch=null}fire(t,n,r){const i=r?this._touch:this._active,o=this._handlers[t];if(n.vegaType=t,t===EE&&i&&i.href?this.handleHref(n,i,i.href):(t===bE||t===yh)&&this.handleTooltip(n,i,t!==yh),o)for(let s=0,a=o.length;s<a;++s)o[s].handler.call(this._obj,n,i)}on(t,n){const r=this.eventName(t),i=this._handlers;return this._handlerIndex(i[r],t,n)<0&&(nN(this,t),(i[r]||(i[r]=[])).push({type:t,handler:n})),this}off(t,n){const r=this.eventName(t),i=this._handlers[r],o=this._handlerIndex(i,t,n);return o>=0&&i.splice(o,1),this}pickEvent(t){const n=kv(t,this._canvas),r=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-r[0],n[1]-r[1])}pick(t,n,r,i,o){const s=this.context();return Tr[t.marktype].pick.call(this,s,t,n,r,i,o)}}const Kte=e=>e===l1||e===c1||e===f1?[l1,c1,f1]:[e];function nN(e,t){Kte(t).forEach(n=>Zte(e,n))}function Zte(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function qd(e,t,n){t.forEach(r=>e.fire(r,n))}function rN(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i?qd(this,e,r):((!i||!i.exit)&&qd(this,n,r),this._active=o,qd(this,t,r),qd(this,e,r))}}function iN(e){return function(t){qd(this,e,t),this._active=null}}function Jte(){return typeof window<"u"&&window.devicePixelRatio||1}function ene(e,t,n,r,i,o){const s=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=s?Jte():i;e.width=t*u,e.height=n*u;for(const l in o)a[l]=o[l];return s&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*r[0],u*r[1]),e}class d1 extends Xp{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new Et,this._tempb=new Et}initialize(t,n,r,i,o,s){return this._options=s||{},this._canvas=this._options.externalContext?null:wa(1,1,this._options.type),t&&this._canvas&&(jr(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,n,r,i,o)}resize(t,n,r,i){if(super.resize(t,n,r,i),this._canvas)ene(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const o=this._options.externalContext;o||z("CanvasRenderer is missing a valid canvas or context"),o.scale(this._scale,this._scale),o.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){const n=this._tempb.clear().union(t.bounds);let r=t.mark.group;for(;r;)n.translate(r.x||0,r.y||0),r=r.mark.group;this._dirty.union(n)}_render(t,n){const r=this.context(),i=this._origin,o=this._width,s=this._height,a=this._dirty,u=tne(i,o,s);r.save();const l=this._redraw||a.empty()?(this._redraw=!1,u.expand(1)):nne(r,u.intersect(a),i);return this.clear(-i[0],-i[1],o,s),this.draw(r,t,l,n),r.restore(),a.clear(),this}draw(t,n,r,i){if(n.marktype!=="group"&&i!=null&&!i.includes(n.marktype))return;const o=Tr[n.marktype];n.clip&&Jee(t,n),o.draw.call(this,t,n,r,i),n.clip&&t.restore()}clear(t,n,r,i){const o=this._options,s=this.context();o.type!=="pdf"&&!o.externalContext&&s.clearRect(t,n,r,i),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(t,n,r,i))}}const tne=(e,t,n)=>new Et().set(0,0,t,n).translate(-e[0],-e[1]);function nne(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}class X8 extends cC{constructor(t,n){super(t,n);const r=this;r._hrefHandler=j2(r,(i,o)=>{o&&o.href&&r.handleHref(i,o,o.href)}),r._tooltipHandler=j2(r,(i,o)=>{r.handleTooltip(i,o,i.type!==yh)})}initialize(t,n,r){let i=this._svg;return i&&(i.removeEventListener(EE,this._hrefHandler),i.removeEventListener(bE,this._tooltipHandler),i.removeEventListener(yh,this._tooltipHandler)),this._svg=i=t&&lC(t,"svg"),i&&(i.addEventListener(EE,this._hrefHandler),i.addEventListener(bE,this._tooltipHandler),i.addEventListener(yh,this._tooltipHandler)),super.initialize(t,n,r)}canvas(){return this._svg}on(t,n){const r=this.eventName(t),i=this._handlers;if(this._handlerIndex(i[r],t,n)<0){const s={type:t,handler:n,listener:j2(this,n)};(i[r]||(i[r]=[])).push(s),this._svg&&this._svg.addEventListener(r,s.listener)}return this}off(t,n){const r=this.eventName(t),i=this._handlers[r],o=this._handlerIndex(i,t,n);return o>=0&&(this._svg&&this._svg.removeEventListener(r,i[o].listener),i.splice(o,1)),this}}const j2=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)},Q8="aria-hidden",fC="aria-label",dC="role",hC="aria-roledescription",K8="graphics-object",pC="graphics-symbol",Z8=(e,t,n)=>({[dC]:e,[hC]:t,[fC]:n||void 0}),rne=Oi(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),oN={axis:{desc:"axis",caption:sne},legend:{desc:"legend",caption:ane},"title-text":{desc:"title",caption:e=>`Title text '${aN(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${aN(e)}'`}},sN={ariaRole:dC,ariaRoleDescription:hC,description:fC};function J8(e,t){const n=t.aria===!1;if(e(Q8,n||void 0),n||t.description==null)for(const r in sN)e(sN[r],void 0);else{const r=t.mark.marktype;e(fC,t.description),e(dC,t.ariaRole||(r==="group"?K8:pC)),e(hC,t.ariaRoleDescription||`${r} mark`)}}function eI(e){return e.aria===!1?{[Q8]:!0}:rne[e.role]?null:oN[e.role]?one(e,oN[e.role]):ine(e)}function ine(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return Z8(n?K8:pC,`${t} mark container`,e.description)}function one(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return Z8(t.role||pC,t.desc,n.description||r(n))}catch{return null}}function aN(e){return K(e.text).join(" ")}function sne(e){const t=e.datum,n=e.orient,r=t.title?tI(e):null,i=e.context,o=i.scales[t.scale].value,s=i.dataflow.locale(),a=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Kc(a)?"discrete":a} scale with ${p8(s,o,e)}`}function ane(e){const t=e.datum,n=t.title?tI(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),s=e.context,a=s.scales[i[o[0]]].value,u=s.dataflow.locale();return lne(r)+(n?` titled '${n}'`:"")+` for ${une(o)} with ${p8(u,a,e)}`}function tI(e){try{return K($e(e.items).items[0].text).join(" ")}catch{return null}}function une(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+$e(e)}function lne(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const nI=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),cne=e=>nI(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function gC(){let e="",t="",n="";const r=[],i=()=>t=n="",o=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},s=(u,l)=>(l!=null&&(t+=` ${u}="${cne(l)}"`),a),a={open(u){o(u),t="<"+u;for(var l=arguments.length,c=new Array(l>1?l-1:0),f=1;f<l;f++)c[f-1]=arguments[f];for(const d of c)for(const h in d)s(h,d[h]);return a},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),a},attr:s,text:u=>(n+=nI(u),a),toString:()=>e};return a}const rI=e=>iI(gC(),e)+"";function iI(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const r of n)r.nodeType===3?e.text(r.nodeValue):iI(e,r)}return e.close()}const h1={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},p1={blend:"mix-blend-mode"},oI={fill:"none","stroke-miterlimit":10},yd=0,uN="http://www.w3.org/2000/xmlns/",_t=ip.xmlns;class mC extends Xp{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,n,r,i,o){return this._defs={},this._clearDefs(),t&&(this._svg=kt(t,0,"svg",_t),this._svg.setAttributeNS(uN,"xmlns",_t),this._svg.setAttributeNS(uN,"xmlns:xlink",ip["xmlns:xlink"]),this._svg.setAttribute("version",ip.version),this._svg.setAttribute("class","marks"),jr(t,1),this._root=kt(this._svg,yd,"g",_t),ta(this._root,oI),jr(this._svg,yd+1)),this.background(this._bgcolor),super.initialize(t,n,r,i,o)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,n,r,i){return super.resize(t,n,r,i),this._svg&&(ta(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const t=this._svg,n=this._bgcolor;if(!t)return null;let r;n&&(t.removeAttribute("style"),r=kt(t,yd,"rect",_t),ta(r,{width:this._width,height:this._height,fill:n}));const i=rI(t);return n&&(t.removeChild(r),this._svg.style.setProperty("background-color",n)),i}_render(t,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,n),jr(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const n=++this._dirtyID;let r,i,o,s,a,u,l;for(a=0,u=t.length;a<u;++a)if(r=t[a],i=r.mark,i.marktype!==o&&(o=i.marktype,s=Tr[o]),i.zdirty&&i.dirty!==n&&(this._dirtyAll=!1,lN(r,n),i.items.forEach(c=>{c.dirty=n})),!i.zdirty){if(r.exit){s.nested&&i.items.length?(l=i.items[0],l._svg&&this._update(s,l._svg,l)):r._svg&&(l=r._svg.parentNode,l&&l.removeChild(r._svg)),r._svg=null;continue}r=s.nested?i.items[0]:r,r._update!==n&&(!r._svg||!r._svg.ownerSVGElement?(this._dirtyAll=!1,lN(r,n)):this._update(s,r._svg,r),r._update=n)}return!this._dirtyAll}mark(t,n,r,i){if(!this.isDirty(n))return n._svg;const o=this._svg,s=n.marktype,a=Tr[s],u=n.interactive===!1?"none":null,l=a.tag==="g",c=cN(n,t,r,"g",o);if(s!=="group"&&i!=null&&!i.includes(s))return jr(c,0),n._svg;c.setAttribute("class",U8(n));const f=eI(n);for(const g in f)Mn(c,g,f[g]);l||Mn(c,"pointer-events",u),Mn(c,"clip-path",n.clip?G$(this,n,n.group):null);let d=null,h=0;const p=g=>{const y=this.isDirty(g),m=cN(g,c,d,a.tag,o);y&&(this._update(a,m,g),l&&hne(this,m,g,i)),d=m,++h};return a.nested?n.items.length&&p(n.items[0]):Di(n,p),jr(c,h),c}_update(t,n,r){rs=n,pn=n.__values__,J8(vh,r),t.attr(vh,r,this);const i=gne[t.type];i&&i.call(this,t,n,r),rs&&this.style(rs,r)}style(t,n){if(n!=null){for(const r in h1){let i=r==="font"?Yp(n):n[r];if(i===pn[r])continue;const o=h1[r];i==null?t.removeAttribute(o):(q$(i)&&(i=m8(i,this._defs.gradient,sI())),t.setAttribute(o,i+"")),pn[r]=i}for(const r in p1)Km(t,p1[r],n[r])}}defs(){const t=this._svg,n=this._defs;let r=n.el,i=0;for(const o in n.gradient)r||(n.el=r=kt(t,yd+1,"defs",_t)),i=fne(r,n.gradient[o],i);for(const o in n.clipping)r||(n.el=r=kt(t,yd+1,"defs",_t)),i=dne(r,n.clipping[o],i);r&&(i===0?(t.removeChild(r),n.el=null):jr(r,i))}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}}function lN(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function fne(e,t,n){let r,i,o;if(t.gradient==="radial"){let s=kt(e,n++,"pattern",_t);ta(s,{id:n1+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),s=kt(s,0,"rect",_t),ta(s,{width:1,height:1,fill:`url(${sI()}#${t.id})`}),e=kt(e,n++,"radialGradient",_t),ta(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=kt(e,n++,"linearGradient",_t),ta(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=kt(e,r,"stop",_t),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return jr(e,r),n}function dne(e,t,n){let r;return e=kt(e,n,"clipPath",_t),e.setAttribute("id",t.id),t.path?(r=kt(e,0,"path",_t),r.setAttribute("d",t.path)):(r=kt(e,0,"rect",_t),ta(r,{x:0,y:0,width:t.width,height:t.height})),jr(e,1),n+1}function hne(e,t,n,r){t=t.lastChild.previousSibling;let i,o=0;Di(n,s=>{i=e.mark(t,s,i,r),++o}),jr(t,1+o)}function cN(e,t,n,r,i){let o=e._svg,s;if(!o&&(s=t.ownerDocument,o=ea(s,r,_t),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},r==="g"))){const a=ea(s,"path",_t);o.appendChild(a),a.__data__=e;const u=ea(s,"g",_t);o.appendChild(u),u.__data__=e;const l=ea(s,"path",_t);o.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(o.ownerSVGElement!==i||pne(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function pne(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let rs=null,pn=null;const gne={group(e,t,n){const r=rs=t.childNodes[2];pn=r.__values__,e.foreground(vh,n,this),pn=t.__values__,rs=t.childNodes[1],e.content(vh,n,this);const i=rs=t.childNodes[0];e.background(vh,n,this);const o=n.mark.interactive===!1?"none":null;if(o!==pn.events&&(Mn(r,"pointer-events",o),Mn(i,"pointer-events",o),pn.events=o),n.strokeForeground&&n.stroke){const s=n.fill;Mn(r,"display",null),this.style(i,n),Mn(i,"stroke",null),s&&(n.fill=null),pn=r.__values__,this.style(r,n),s&&(n.fill=s),rs=null}else Mn(r,"display","none")},image(e,t,n){n.smooth===!1?(Km(t,"image-rendering","optimizeSpeed"),Km(t,"image-rendering","pixelated")):Km(t,"image-rendering",null)},text(e,t,n){const r=Gp(n);let i,o,s,a;I(r)?(o=r.map(u=>Na(n,u)),i=o.join(`
`),i!==pn.text&&(jr(t,0),s=t.ownerDocument,a=Ta(n),o.forEach((u,l)=>{const c=ea(s,"tspan",_t);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),pn.text=i)):(o=Na(n,r),o!==pn.text&&(t.textContent=o,pn.text=o)),Mn(t,"font-family",Yp(n)),Mn(t,"font-size",Mo(n)+"px"),Mn(t,"font-style",n.fontStyle),Mn(t,"font-variant",n.fontVariant),Mn(t,"font-weight",n.fontWeight)}};function vh(e,t,n){t!==pn[e]&&(n?mne(rs,e,t,n):Mn(rs,e,t),pn[e]=t)}function Km(e,t,n){n!==pn[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),pn[t]=n)}function ta(e,t){for(const n in t)Mn(e,n,t[n])}function Mn(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function mne(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function sI(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}class aI extends Xp{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){const n=gC();n.open("svg",pe({},ip,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const r=this._bgcolor;return r&&r!=="transparent"&&r!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:r}).close(),n.open("g",oI,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){const r=Tr[n.marktype],i=r.tag,o=[J8,r.attr];t.open("g",{class:U8(n),"clip-path":n.clip?G$(this,n,n.group):null},eI(n),{"pointer-events":i!=="g"&&n.interactive===!1?"none":null});const s=a=>{const u=this.href(a);if(u&&t.open("a",u),t.open(i,this.attr(n,a,o,i!=="g"?i:null)),i==="text"){const l=Gp(a);if(I(l)){const c={x:0,dy:Ta(a)};for(let f=0;f<l.length;++f)t.open("tspan",f?c:null).text(Na(a,l[f])).close()}else t.text(Na(a,l))}else if(i==="g"){const l=a.strokeForeground,c=a.fill,f=a.stroke;l&&f&&(a.stroke=null),t.open("path",this.attr(n,a,r.background,"bgrect")).close(),t.open("g",this.attr(n,a,r.content)),Di(a,d=>this.mark(t,d)),t.close(),l&&f?(c&&(a.fill=null),a.stroke=f,t.open("path",this.attr(n,a,r.foreground,"bgrect")).close(),c&&(a.fill=c)):t.open("path",this.attr(n,a,r.foreground,"bgfore")).close()}t.close(),u&&t.close()};return r.nested?n.items&&n.items.length&&s(n.items[0]):Di(n,s),t.close()}href(t){const n=t.href;let r;if(n){if(r=this._hrefs&&this._hrefs[n])return r;this.sanitizeURL(n).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[n]=i})}return null}attr(t,n,r,i){const o={},s=(a,u,l,c)=>{o[c||a]=u};return Array.isArray(r)?r.forEach(a=>a(s,n,this)):r(s,n,this),i&&yne(o,n,t,i,this._defs),o}defs(t){const n=this._defs.gradient,r=this._defs.clipping;if(Object.keys(n).length+Object.keys(r).length!==0){t.open("defs");for(const o in n){const s=n[o],a=s.stops;s.gradient==="radial"?(t.open("pattern",{id:n1+o,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+o+")"}).close(),t.close(),t.open("radialGradient",{id:o,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):t.open("linearGradient",{id:o,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let u=0;u<a.length;++u)t.open("stop",{offset:a[u].offset,"stop-color":a[u].color}).close();t.close()}for(const o in r){const s=r[o];t.open("clipPath",{id:o}),s.path?t.open("path",{d:s.path}).close():t.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),t.close()}t.close()}}}function yne(e,t,n,r,i){let o;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=Yp(t),e["font-size"]=Mo(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const s in h1){let a=t[s];const u=h1[s];a==="transparent"&&(u==="fill"||u==="stroke")||a!=null&&(q$(a)&&(a=m8(a,i.gradient,"")),e[u]=a)}for(const s in p1){const a=t[s];a!=null&&(o=o||[],o.push(`${p1[s]}: ${a};`))}return o&&(e.style=o.join(" ")),e}const yi={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function vne(e){yi.svgMarkTypes=e.svgMarkTypes??["text"],yi.svgOnTop=e.svgOnTop??!0,yi.debug=e.debug??!1}class SE extends Xp{constructor(t){super(t),this._svgRenderer=new mC(t),this._canvasRenderer=new d1(t)}initialize(t,n,r,i,o){this._root_el=kt(t,0,"div");const s=kt(this._root_el,0,"div"),a=kt(this._root_el,1,"div");return this._root_el.style.position="relative",yi.debug||(s.style.height="100%",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.height="100%",a.style.width="100%"),this._svgEl=yi.svgOnTop?a:s,this._canvasEl=yi.svgOnTop?s:a,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,r,i,o),this._svgRenderer.initialize(this._svgEl,n,r,i,o),super.initialize(t,n,r,i,o)}dirty(t){return yi.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,n){const i=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(o=>!yi.svgMarkTypes.includes(o));this._svgRenderer.render(t,yi.svgMarkTypes),this._canvasRenderer.render(t,i)}resize(t,n,r,i){return super.resize(t,n,r,i),this._svgRenderer.resize(t,n,r,i),this._canvasRenderer.resize(t,n,r,i),this}background(t){return yi.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}class uI extends Qp{constructor(t,n){super(t,n)}initialize(t,n,r){const i=kt(kt(t,0,"div"),yi.svgOnTop?0:1,"div");return super.initialize(i,n,r)}}const lI="canvas",cI="hybrid",fI="png",dI="svg",hI="none",na={Canvas:lI,PNG:fI,SVG:dI,Hybrid:cI,None:hI},tl={};tl[lI]=tl[fI]={renderer:d1,headless:d1,handler:Qp};tl[dI]={renderer:mC,headless:aI,handler:X8};tl[cI]={renderer:SE,headless:SE,handler:uI};tl[hI]={};function $v(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(tl[e]=t,this):tl[e]}function pI(e,t,n){const r=[],i=new Et().union(t),o=e.marktype;return o?gI(e,i,n,r):o==="group"?mI(e,i,n,r):z("Intersect scene must be mark node or group item.")}function gI(e,t,n,r){if(xne(e,t,n)){const i=e.items,o=e.marktype,s=i.length;let a=0;if(o==="group")for(;a<s;++a)mI(i[a],t,n,r);else for(const u=Tr[o].isect;a<s;++a){const l=i[a];yI(l,t,u)&&r.push(l)}}return r}function xne(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function mI(e,t,n,r){n&&n(e.mark)&&yI(e,t,Tr.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const s=e.x||0,a=e.y||0;t.translate(-s,-a);for(let u=0;u<o;++u)gI(i[u],t,n,r);t.translate(s,a)}return r}function yI(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const U2=new Et;function vI(e){const t=e.clip;if(ge(t))t(Hp(U2.clear()));else if(t)U2.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(U2)}const wne=1e-9;function yC(e,t,n){return e===t?!0:n==="path"?xI(e,t):e instanceof Date&&t instanceof Date?+e==+t:Ae(e)&&Ae(t)?Math.abs(e-t)<=wne:!e||!t||!Q(e)&&!Q(t)?e==t:bne(e,t)}function xI(e,t){return yC(Zc(e),Zc(t))}function bne(e,t){var n=Object.keys(e),r=Object.keys(t),i,o;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),o=n.length-1;o>=0;o--)if(n[o]!=r[o])return!1;for(o=n.length-1;o>=0;o--)if(i=n[o],!yC(e[i],t[i],i))return!1;return typeof e==typeof t}function Ene(){S8(),VJ()}const tf="top",Si="left",_i="right",Oa="bottom",Sne="top-left",_ne="top-right",kne="bottom-left",$ne="bottom-right",vC="start",_E="middle",Nn="end",Cne="x",Ane="y",Cv="group",xC="axis",wC="title",Fne="frame",Mne="scope",bC="legend",wI="row-header",bI="row-footer",EI="row-title",SI="column-header",_I="column-footer",kI="column-title",Tne="padding",Nne="symbol",$I="fit",CI="fit-x",AI="fit-y",One="pad",EC="none",Qg="all",kE="each",SC="flush",ra="column",ia="row";function FI(e){D.call(this,null,e)}G(FI,D,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=Tr[i],s=o.bound;let a=r.bounds,u;if(o.nested)r.items.length&&n.dirty(r.items[0]),a=Kg(r,s),r.items.forEach(l=>{l.bounds.clear().union(a)});else if(i===Cv||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),r.items.forEach(l=>a.union(Kg(l,s))),r.role){case xC:case bC:case wC:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(Kg(l,s))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(Kg(l,s))}),u&&(a.clear(),r.items.forEach(l=>a.union(l.bounds)));return vI(r),t.modifies("bounds")}});function Kg(e,t,n){return t(e.bounds.clear(),e,n)}const fN=":vega_identifier:";function _C(e){D.call(this,0,e)}_C.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};G(_C,D,{transform(e,t){const n=Rne(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,o=>o[r]=o[r]||++i),n.set(this.value=i),t}});function Rne(e){return e._signals[fN]||(e._signals[fN]=e.add(0))}function MI(e){D.call(this,null,e)}G(MI,D,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,Dne(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===Cv?vv:yv;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function Dne(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function TI(e){D.call(this,null,e)}const dN={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!NI(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},NI=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),hN=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,o;n<r;i=o,++n)if(NI(i,o=e[n].bounds,t))return!0},Pne=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},Lne=(e,t,n)=>{var r=e.range(),i=new Et;return t===tf||t===Oa?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),o=>i.encloses(o.bounds)},pN=e=>(e.forEach(t=>t.opacity=1),e),gN=(e,t)=>e.reflow(t.modified()).modifies("opacity");G(TI,D,{transform(e,t){const n=dN[e.method]||dN.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,o,s;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(pN(i),t=gN(t,e)),t;if(i=i.filter(Pne),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),o=pN(i),t=gN(t,e),o.length>=3&&hN(o,r)){do o=n(o,r);while(o.length>=3&&hN(o,r));o.length<3&&!$e(i).opacity&&(o.length>1&&($e(o).opacity=0),$e(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(s=Lne(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{s(u)||(u.opacity=0)}));const a=o[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function OI(e){D.call(this,null,e)}G(OI,D,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const hn=new Et;function pc(e,t,n){return e[t]===n?0:(e[t]=n,1)}function zne(e){var t=e.items[0].orient;return t===Si||t===_i}function Ine(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Bne(e,t,n,r){var i=t.items[0],o=i.datum,s=i.translate!=null?i.translate:.5,a=i.orient,u=Ine(o),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=o.title&&i.items[u[2]].items[0],g=i.titlePadding,y=i.bounds,m=p&&sC(p),v=0,x=0,w,b;switch(hn.clear().union(y),y.clear(),(w=u[0])>-1&&y.union(i.items[w].bounds),(w=u[1])>-1&&y.union(i.items[w].bounds),a){case tf:v=f||0,x=-c,b=Math.max(d,Math.min(h,-y.y1)),y.add(0,-b).add(l,0),p&&Zg(e,p,b,g,m,0,-1,y);break;case Si:v=-c,x=f||0,b=Math.max(d,Math.min(h,-y.x1)),y.add(-b,0).add(0,l),p&&Zg(e,p,b,g,m,1,-1,y);break;case _i:v=n+c,x=f||0,b=Math.max(d,Math.min(h,y.x2)),y.add(0,0).add(b,l),p&&Zg(e,p,b,g,m,1,1,y);break;case Oa:v=f||0,x=r+c,b=Math.max(d,Math.min(h,y.y2)),y.add(0,0).add(l,b),p&&Zg(e,p,b,g,0,0,1,y);break;default:v=i.x,x=i.y}return Ss(y.translate(v,x),i),pc(i,"x",v+s)|pc(i,"y",x+s)&&(i.bounds=hn,e.dirty(i),i.bounds=y,e.dirty(i)),i.mark.bounds.clear().union(y)}function Zg(e,t,n,r,i,o,s,a){const u=t.bounds;if(t.auto){const l=s*(n+i+r);let c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}const mN=(e,t)=>Math.floor(Math.min(e,t)),yN=(e,t)=>Math.ceil(Math.max(e,t));function jne(e){var t=e.items,n=t.length,r=0,i,o;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],o=i.items,i.marktype===Cv)switch(i.role){case xC:case bC:case wC:break;case wI:s.rowheaders.push(...o);break;case bI:s.rowfooters.push(...o);break;case SI:s.colheaders.push(...o);break;case _I:s.colfooters.push(...o);break;case EI:s.rowtitle=o[0];break;case kI:s.coltitle=o[0];break;default:s.marks.push(...o)}return s}function Une(e){return new Et().set(0,0,e.width||0,e.height||0)}function Wne(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Je(e,t,n){const r=Q(e)?e[t]:e;return r??(n!==void 0?n:0)}function vN(e){return e<0?Math.ceil(-e):0}function RI(e,t,n){var r=!n.nodirty,i=n.bounds===SC?Une:Wne,o=hn.set(0,0,0,0),s=Je(n.align,ra),a=Je(n.align,ia),u=Je(n.padding,ra),l=Je(n.padding,ia),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,y=Array(d),m=Array(f),v=0,x=Array(d),w=Array(d),b=Array(d),S,E,_,k,$,C,R,A,M,F,N;for(E=0;E<c;++E)p[E]=0;for(E=0;E<f;++E)m[E]=0;for(E=0;E<d;++E)C=t[E],$=b[E]=i(C),C.x=C.x||0,x[E]=0,C.y=C.y||0,w[E]=0,_=E%c,k=~~(E/c),g=Math.max(g,R=Math.ceil($.x2)),v=Math.max(v,A=Math.ceil($.y2)),p[_]=Math.max(p[_],R),m[k]=Math.max(m[k],A),h[E]=u+vN($.x1),y[E]=l+vN($.y1),r&&e.dirty(t[E]);for(E=0;E<d;++E)E%c===0&&(h[E]=0),E<c&&(y[E]=0);if(s===kE)for(_=1;_<c;++_){for(N=0,E=_;E<d;E+=c)N<h[E]&&(N=h[E]);for(E=_;E<d;E+=c)h[E]=N+p[_-1]}else if(s===Qg){for(N=0,E=0;E<d;++E)E%c&&N<h[E]&&(N=h[E]);for(E=0;E<d;++E)E%c&&(h[E]=N+g)}else for(s=!1,_=1;_<c;++_)for(E=_;E<d;E+=c)h[E]+=p[_-1];if(a===kE)for(k=1;k<f;++k){for(N=0,E=k*c,S=E+c;E<S;++E)N<y[E]&&(N=y[E]);for(E=k*c;E<S;++E)y[E]=N+m[k-1]}else if(a===Qg){for(N=0,E=c;E<d;++E)N<y[E]&&(N=y[E]);for(E=c;E<d;++E)y[E]=N+v}else for(a=!1,k=1;k<f;++k)for(E=k*c,S=E+c;E<S;++E)y[E]+=m[k-1];for(M=0,E=0;E<d;++E)M=h[E]+(E%c?M:0),x[E]+=M-t[E].x;for(_=0;_<c;++_)for(F=0,E=_;E<d;E+=c)F+=y[E],w[E]+=F-t[E].y;if(s&&Je(n.center,ra)&&f>1)for(E=0;E<d;++E)$=s===Qg?g:p[E%c],M=$-b[E].x2-t[E].x-x[E],M>0&&(x[E]+=M/2);if(a&&Je(n.center,ia)&&c!==1)for(E=0;E<d;++E)$=a===Qg?v:m[~~(E/c)],F=$-b[E].y2-t[E].y-w[E],F>0&&(w[E]+=F/2);for(E=0;E<d;++E)o.union(b[E].translate(x[E],w[E]));switch(M=Je(n.anchor,Cne),F=Je(n.anchor,Ane),Je(n.anchor,ra)){case Nn:M-=o.width();break;case _E:M-=o.width()/2}switch(Je(n.anchor,ia)){case Nn:F-=o.height();break;case _E:F-=o.height()/2}for(M=Math.round(M),F=Math.round(F),o.clear(),E=0;E<d;++E)t[E].mark.bounds.clear();for(E=0;E<d;++E)C=t[E],C.x+=x[E]+=M,C.y+=w[E]+=F,o.union(C.mark.bounds.union(C.bounds.translate(x[E],w[E]))),r&&e.dirty(C);return o}function qne(e,t,n){var r=jne(t),i=r.marks,o=n.bounds===SC?Hne:Vne,s=n.offset,a=n.columns||i.length,u=a<=0?1:Math.ceil(i.length/a),l=u*a,c,f,d,h,p,g,y;const m=RI(e,i,n);m.empty()&&m.set(0,0,0,0),r.rowheaders&&(g=Je(n.headerBand,ia,null),c=Jg(e,r.rowheaders,i,a,u,-Je(s,"rowHeader"),mN,0,o,"x1",0,a,1,g)),r.colheaders&&(g=Je(n.headerBand,ra,null),f=Jg(e,r.colheaders,i,a,a,-Je(s,"columnHeader"),mN,1,o,"y1",0,1,a,g)),r.rowfooters&&(g=Je(n.footerBand,ia,null),d=Jg(e,r.rowfooters,i,a,u,Je(s,"rowFooter"),yN,0,o,"x2",a-1,a,1,g)),r.colfooters&&(g=Je(n.footerBand,ra,null),h=Jg(e,r.colfooters,i,a,a,Je(s,"columnFooter"),yN,1,o,"y2",l-a,1,a,g)),r.rowtitle&&(p=Je(n.titleAnchor,ia),y=Je(s,"rowTitle"),y=p===Nn?d+y:c-y,g=Je(n.titleBand,ia,.5),xN(e,r.rowtitle,y,0,m,g)),r.coltitle&&(p=Je(n.titleAnchor,ra),y=Je(s,"columnTitle"),y=p===Nn?h+y:f-y,g=Je(n.titleBand,ra,.5),xN(e,r.coltitle,y,1,m,g))}function Hne(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function Vne(e,t){return e.bounds[t]}function Jg(e,t,n,r,i,o,s,a,u,l,c,f,d,h){var p=n.length,g=0,y=0,m,v,x,w,b,S,E,_,k;if(!p)return g;for(m=c;m<p;m+=f)n[m]&&(g=s(g,u(n[m],l)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=o,v=0,w=t.length;v<w;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(m=c,v=0,w=t.length;v<w;++v,m+=f){for(S=t[v],b=S.mark.bounds,x=m;x>=0&&(E=n[x])==null;x-=d);a?(_=h==null?E.x:Math.round(E.bounds.x1+h*E.bounds.width()),k=g):(_=g,k=h==null?E.y:Math.round(E.bounds.y1+h*E.bounds.height())),b.union(S.bounds.translate(_-(S.x||0),k-(S.y||0))),S.x=_,S.y=k,e.dirty(S),y=s(y,b[l])}return y}function xN(e,t,n,r,i,o){if(t){e.dirty(t);var s=n,a=n;r?s=Math.round(i.x1+o*i.width()):a=Math.round(i.y1+o*i.height()),t.bounds.translate(s-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=s,t.y=a,e.dirty(t)}}function Gne(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function Yne(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function Xne(e,t,n,r,i,o,s){const a=Gne(n,t),u=Yne(e,a("offset",0)),l=a("anchor",vC),c=l===Nn?1:l===_E?.5:0,f={align:kE,bounds:a("bounds",SC),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case Si:f.anchor={x:Math.floor(r.x1)-u,column:Nn,y:c*(s||r.height()+2*r.y1),row:l};break;case _i:f.anchor={x:Math.ceil(r.x2)+u,y:c*(s||r.height()+2*r.y1),row:l};break;case tf:f.anchor={y:Math.floor(i.y1)-u,row:Nn,x:c*(o||i.width()+2*i.x1),column:l};break;case Oa:f.anchor={y:Math.ceil(i.y2)+u,x:c*(o||i.width()+2*i.x1),column:l};break;case Sne:f.anchor={x:u,y:u};break;case _ne:f.anchor={x:o-u,y:u,column:Nn};break;case kne:f.anchor={x:u,y:s-u,row:Nn};break;case $ne:f.anchor={x:o-u,y:s-u,column:Nn,row:Nn};break}return f}function Qne(e,t){var n=t.items[0],r=n.datum,i=n.orient,o=n.bounds,s=n.x,a=n.y,u,l;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),Zne(e,n,n.items[0].items[0]),o=Kne(n,o),u=2*n.padding,l=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),l=Math.ceil(o.height()+l)),r.type===Nne&&Jne(n.items[0].items[0].items[0].items),i!==EC&&(n.x=s=0,n.y=a=0),n.width=u,n.height=l,Ss(o.set(s,a,s+u,a+l),n),n.mark.bounds.clear().union(o),n}function Kne(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function Zne(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(!t.datum.title)(i||o)&&vd(e,n,i,o);else{var s=t.items[1].items[0],a=s.anchor,u=t.titlePadding||0,l=r-s.x,c=r-s.y;switch(s.orient){case Si:i+=Math.ceil(s.bounds.width())+u;break;case _i:case Oa:break;default:o+=s.bounds.height()+u}switch((i||o)&&vd(e,n,i,o),s.orient){case Si:c+=jl(t,n,s,a,1,1);break;case _i:l+=jl(t,n,s,Nn,0,0)+u,c+=jl(t,n,s,a,1,1);break;case Oa:l+=jl(t,n,s,a,0,0),c+=jl(t,n,s,Nn,-1,0,1)+u;break;default:l+=jl(t,n,s,a,0,0)}(l||c)&&vd(e,s,l,c),(l=Math.round(s.bounds.x1-r))<0&&(vd(e,n,-l,0),vd(e,s,-l,0))}}function jl(e,t,n,r,i,o,s){const a=e.datum.type!=="symbol",u=n.datum.vgrad,l=a&&(o||!u)&&!s?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&o?c:0,d=u&&o?0:c,h=i<=0?0:sC(n);return Math.round(r===vC?f:r===Nn?d-h:.5*(c-h))}function vd(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function Jne(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function ere(e,t,n,r,i){var o=t.items[0],s=o.frame,a=o.orient,u=o.anchor,l=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],h=a===Si||a===_i?r:n,p=0,g=0,y=0,m=0,v=0,x;if(s!==Cv?a===Si?(p=i.y2,h=i.y1):a===_i?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):a===Si&&(p=r,h=0),x=u===vC?p:u===Nn?h:(p+h)/2,d&&d.text){switch(a){case tf:case Oa:v=f.bounds.height()+c;break;case Si:m=f.bounds.width()+c;break;case _i:m=-f.bounds.width()-c;break}hn.clear().union(d.bounds),hn.translate(m-(d.x||0),v-(d.y||0)),pc(d,"x",m)|pc(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(hn),d.mark.bounds.clear().union(hn),e.dirty(d)),hn.clear().union(d.bounds)}else hn.clear();switch(hn.union(f.bounds),a){case tf:g=x,y=i.y1-hn.height()-l;break;case Si:g=i.x1-hn.width()-l,y=x;break;case _i:g=i.x2+hn.width()+l,y=x;break;case Oa:g=x,y=i.y2+l;break;default:g=o.x,y=o.y}return pc(o,"x",g)|pc(o,"y",y)&&(hn.translate(g,y),e.dirty(o),o.bounds.clear().union(hn),t.bounds.clear().union(hn),e.dirty(o)),o.bounds}function DI(e){D.call(this,null,e)}G(DI,D,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&qne(n,r,e.layout),nre(n,r,e)}),tre(e.mark.group)?t.reflow():t}});function tre(e){return e&&e.mark.role!=="legend-entry"}function nre(e,t,n){var r=t.items,i=Math.max(0,t.width||0),o=Math.max(0,t.height||0),s=new Et().set(0,0,i,o),a=s.clone(),u=s.clone(),l=[],c,f,d,h,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case xC:h=zne(f)?a:u,h.union(Bne(e,f,i,o));break;case wC:c=f;break;case bC:l.push(Qne(e,f));break;case Fne:case Mne:case wI:case bI:case EI:case SI:case _I:case kI:a.union(f.bounds),u.union(f.bounds);break;default:s.union(f.bounds)}if(l.length){const y={};l.forEach(m=>{d=m.orient||_i,d!==EC&&(y[d]||(y[d]=[])).push(m)});for(const m in y){const v=y[m];RI(e,v,Xne(v,m,n.legends,a,u,i,o))}l.forEach(m=>{const v=m.bounds;if(v.equals(m._bounds)||(m.bounds=m._bounds,e.dirty(m),m.bounds=v,e.dirty(m)),n.autosize&&(n.autosize.type===$I||n.autosize.type===CI||n.autosize.type===AI))switch(m.orient){case Si:case _i:s.add(v.x1,0).add(v.x2,0);break;case tf:case Oa:s.add(0,v.y1).add(0,v.y2)}else s.union(v)})}s.union(a).union(u),c&&s.union(ere(e,c,i,o,s)),t.clip&&s.set(0,0,t.width||0,t.height||0),rre(e,t,s,n)}function rre(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let s=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===Tne){const p=e.padding();s-=p.left+p.right,a-=p.top+p.bottom}o===EC?(l=0,f=0,u=s,c=a):o===$I?(u=Math.max(0,s-l-d),c=Math.max(0,a-f-h)):o===CI?(u=Math.max(0,s-l-d),a=c+f+h):o===AI?(s=u+l+d,c=Math.max(0,a-f-h)):o===One&&(s=u+l+d,a=c+f+h),e._resizeView(s,a,u,c,[l,f],i.resize)}const ire=Object.freeze(Object.defineProperty({__proto__:null,bound:FI,identifier:_C,mark:MI,overlap:TI,render:OI,viewlayout:DI},Symbol.toStringTag,{value:"Module"}));function PI(e){D.call(this,null,e)}G(PI,D,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,s=e.count==null?e.values?e.values.length:10:e.count,a=U$(o,s,e.minstep),u=e.format||l8(n,o,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?u8(o,e.values,a):W$(o,a);return i&&(r.rem=i),i=l.map((c,f)=>De({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(De({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function LI(e){D.call(this,null,e)}function ore(){return De({})}function sre(e){const t=Mf().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}G(LI,D,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||ore,o=e.key||oe,s=this.value;return I(r.encode)&&(r.encode=null),s&&(e.modified("key")||t.modified(o))&&z("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=sre(o)),t.visit(t.ADD,a=>{const u=o(a);let l=s.get(u);l?l.exit?(s.empty--,r.add.push(l)):r.mod.push(l):(l=i(a),s.set(u,l),r.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{const u=o(a),l=s.get(u);l&&(l.datum=a,r.mod.push(l))}),t.visit(t.REM,a=>{const u=o(a),l=s.get(u);a===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),r}});function zI(e){D.call(this,null,e)}G(zI,D,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(I(o))if(n.changed()||o.every(f=>i[f]))o=o[0],n.encode=null;else return t.StopPropagation;var s=o==="enter",a=i.update||Ps,u=i.enter||Ps,l=i.exit||Ps,c=(o&&!s?i[o]:a)||Ps;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==Ps&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Ps&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),s||c!==Ps){const f=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function II(e){D.call(this,[],e)}G(II,D,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.type||Wm,s=e.scale,a=+e.limit,u=U$(s,e.count==null?5:e.count,e.minstep),l=!!e.values||o===Wm,c=e.format||h8(n,s,u,o,e.formatSpecifier,e.formatType,l),f=e.values||d8(s,u),d,h,p,g,y;return i&&(r.rem=i),o===Wm?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,a-1),y=!0):i=f,ge(p=e.size)?(!e.values&&s(i[0])===0&&(i=i.slice(1)),g=i.reduce((m,v)=>Math.max(m,p(v,e)),0)):p=Cn(g=p||8),i=i.map((m,v)=>De({index:v,label:c(m,v,i),value:m,offset:g,size:p(m,e)})),y&&(y=f[i.length],i.push(De({index:i.length,label:`${f.length-i.length} entries`,value:y,offset:g,size:p(y,e)})))):o===OJ?(d=s.domain(),h=o8(s,d[0],$e(d)),f.length<3&&!e.values&&d[0]!==$e(d)&&(f=[d[0],$e(d)]),i=f.map((m,v)=>De({index:v,label:c(m,v,f),value:m,perc:h(m)}))):(p=f.length-1,h=qJ(s),i=f.map((m,v)=>De({index:v,label:c(m,v,f),value:m,perc:v?h(m):0,perc2:v===p?1:h(f[v+1])}))),r.source=i,r.add=i,this.value=i,r}});const are=e=>e.source.x,ure=e=>e.source.y,lre=e=>e.target.x,cre=e=>e.target.y;function kC(e){D.call(this,{},e)}kC.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};G(kC,D,{transform(e,t){var n=e.sourceX||are,r=e.sourceY||ure,i=e.targetX||lre,o=e.targetY||cre,s=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=wN.get(u+"-"+a)||wN.get(u);return l||z("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[s]=l(n(c),r(c),i(c),o(c))}),t.reflow(e.modified()).modifies(s)}});const BI=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,fre=(e,t,n,r)=>BI(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),jI=(e,t,n,r)=>{var i=n-e,o=r-t,s=Math.hypot(i,o)/2,a=180*Math.atan2(o,i)/Math.PI;return"M"+e+","+t+"A"+s+","+s+" "+a+" 0 1 "+n+","+r},dre=(e,t,n,r)=>jI(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),UI=(e,t,n,r)=>{const i=n-e,o=r-t,s=.2*(i+o),a=.2*(o-i);return"M"+e+","+t+"C"+(e+s)+","+(t+a)+" "+(n+a)+","+(r-s)+" "+n+","+r},hre=(e,t,n,r)=>UI(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),pre=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,gre=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,mre=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*s+","+t*a+"L"+r*s+","+r*a},yre=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},vre=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},xre=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*o+"C"+u*i+","+u*o+" "+u*s+","+u*a+" "+r*s+","+r*a},wN=Mf({line:BI,"line-radial":fre,arc:jI,"arc-radial":dre,curve:UI,"curve-radial":hre,"orthogonal-horizontal":pre,"orthogonal-vertical":gre,"orthogonal-radial":mre,"diagonal-horizontal":yre,"diagonal-vertical":vre,"diagonal-radial":xre});function $C(e){D.call(this,null,e)}$C.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};G($C,D,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],o=e.field||Cf,s=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(o),c=l.length,f=s,d=(a-s)/nP(l),h=Er(c),p,g,y;for(e.sort&&h.sort((m,v)=>l[m]-l[v]),p=0;p<c;++p)y=l[h[p]],g=u[h[p]],g[r]=f,g[i]=f+=y*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const wre=5;function bre(e){const t=e.type;return!e.bins&&(t===Xc||t===zp||t===Ip)}function WI(e){return I$(e)&&e!==go}const Ere=Oi(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function qI(e){D.call(this,null,e),this.modified(!0)}G(qI,D,{transform(e,t){var n=t.dataflow,r=this.value,i=Sre(e);(!r||i!==r.type)&&(this.value=r=Oe(i)());for(i in e)if(!Ere[i]){if(i==="padding"&&WI(r.type))continue;ge(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return Fre(r,e,Are(r,e,kre(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Sre(e){var t=e.type,n="",r;return t===go?go+"-"+Xc:(_re(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?go+"-":r===3?zf+"-":""),(n+t||Xc).toLowerCase())}function _re(e){const t=e.type;return I$(t)&&t!==Ju&&t!==el&&(e.scheme||e.range&&e.range.length&&e.range.every(Z))}function kre(e,t,n){const r=$re(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,o=e.type,s=t.zero||t.zero===void 0&&bre(e),a,u;if(!i)return 0;if((s||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(i=i.slice()).length-1||1,s&&(i[0]>0&&(i[0]=0),i[a]<0&&(i[a]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>i[a]?a+1:u<i[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return WI(o)&&t.padding&&i[0]!==$e(i)&&(i=Cre(o,i,t.range,t.padding,t.exponent,t.constant)),e.domain(HI(o,i,n)),o===D$&&e.unknown(t.domainImplicit?iE:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&U$(e,t.nice)||null),i.length}function $re(e,t,n){return t?(e.domain(HI(e.type,t,n)),t.length):-1}function Cre(e,t,n,r,i,o){var s=Math.abs($e(n)-n[0]),a=s/(s-2*r),u=e===xs?rk(t,null,a):e===Ip?z0(t,null,a,.5):e===zp?z0(t,null,a,i||1):e===dv?ik(t,null,a,o||1):nk(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function HI(e,t,n){if(e8(e)){var r=Math.abs(t.reduce((i,o)=>i+(o<0?-1:o>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+V(t))}return t}function Are(e,t,n){let r=t.bins;if(r&&!I(r)){const i=e.domain(),o=i[0],s=$e(i),a=r.step;let u=r.start==null?o:r.start,l=r.stop==null?s:r.stop;a||z("Scale bins parameter missing step property."),u<o&&(u=a*Math.ceil(o/a)),l>s&&(l=a*Math.floor(s/a)),r=Er(u,l+a/2,a)}return r?e.bins=r:e.bins&&delete e.bins,e.type===P$&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function Fre(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(t.rangeStep!=null)o=Mre(r,t,n);else if(t.scheme&&(o=Tre(r,t,n),ge(o))){if(e.interpolator)return e.interpolator(o);z(`Scale type ${r} does not support interpolating color schemes.`)}if(o&&t8(r))return e.interpolator(gv($E(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(B$(t.interpolate,t.interpolateGamma)):ge(e.round)?e.round(i):ge(e.rangeRound)&&e.interpolate(i?Pp:Ya),o&&e.range($E(o,t.reverse))}function Mre(e,t,n){e!==Yz&&e!==fE&&z("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===fE?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*R$(n,i,r)]}function Tre(e,t,n){var r=t.schemeExtent,i,o;return I(t.scheme)?o=gv(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),o=j$(i),o||z(`Unrecognized scheme name: ${t.scheme}`)),n=e===pv?n+1:e===P$?n-1:e===Qc||e===hv?+t.schemeCount||wre:n,t8(e)?bN(o,r,t.reverse):ge(o)?i8(bN(o,r),n):e===D$?o:o.slice(0,n)}function bN(e,t,n){return ge(e)&&(t||n)?r8(e,$E(t||[0,1],n)):e}function $E(e,t){return t?e.slice().reverse():e}function VI(e){D.call(this,null,e)}G(VI,D,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(El(e.sort)),this.modified(n),t}});const EN="zero",GI="center",YI="normalize",XI=["y0","y1"];function CC(e){D.call(this,null,e)}CC.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:EN,values:[EN,GI,YI]},{name:"as",type:"string",array:!0,length:2,default:XI}]};G(CC,D,{transform(e,t){var n=e.as||XI,r=n[0],i=n[1],o=El(e.sort),s=e.field||Cf,a=e.offset===GI?Nre:e.offset===YI?Ore:Rre,u,l,c,f;for(u=Dre(t.source,e.groupby,o,s),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,s,r,i);return t.reflow(e.modified()).modifies(n)}});function Nre(e,t,n,r,i){for(var o=(t-e.sum)/2,s=e.length,a=0,u;a<s;++a)u=e[a],u[r]=o,u[i]=o+=Math.abs(n(u))}function Ore(e,t,n,r,i){for(var o=1/e.sum,s=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[r]=s,c[i]=s=o*(l+=Math.abs(n(c)))}function Rre(e,t,n,r,i){for(var o=0,s=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=+n(c),l<0?(c[r]=s,c[i]=s+=l):(c[r]=o,c[i]=o+=l)}function Dre(e,t,n,r){var i=[],o=g=>g(c),s,a,u,l,c,f,d,h,p;if(t==null)i.push(e.slice());else for(s={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(o),d=s[f],d||(s[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,l=i.length;f<l;++f){for(d=i[f],a=0,h=0,u=d.length;a<u;++a)h+=Math.abs(r(d[a]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}const Pre=Object.freeze(Object.defineProperty({__proto__:null,axisticks:PI,datajoin:LI,encode:zI,legendentries:II,linkpath:kC,pie:$C,scale:qI,sortitems:VI,stack:CC},Symbol.toStringTag,{value:"Module"}));var ue=1e-6,g1=1e-12,xe=Math.PI,ht=xe/2,m1=xe/4,jn=xe*2,mt=180/xe,ye=xe/180,ke=Math.abs,Bf=Math.atan,ri=Math.atan2,le=Math.cos,em=Math.ceil,QI=Math.exp,CE=Math.hypot,y1=Math.log,W2=Math.pow,se=Math.sin,Hr=Math.sign||function(e){return e>0?1:e<0?-1:0},Un=Math.sqrt,AC=Math.tan;function KI(e){return e>1?0:e<-1?xe:Math.acos(e)}function lr(e){return e>1?ht:e<-1?-ht:Math.asin(e)}function Kt(){}function v1(e,t){e&&_N.hasOwnProperty(e.type)&&_N[e.type](e,t)}var SN={Feature:function(e,t){v1(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)v1(n[r].geometry,t)}},_N={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){AE(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)AE(n[r],t,0)},Polygon:function(e,t){kN(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)kN(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)v1(n[r],t)}};function AE(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function kN(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)AE(e[n],t,1);t.polygonEnd()}function Xo(e,t){e&&SN.hasOwnProperty(e.type)?SN[e.type](e,t):v1(e,t)}var x1=new In,w1=new In,ZI,JI,FE,ME,TE,Eo={point:Kt,lineStart:Kt,lineEnd:Kt,polygonStart:function(){x1=new In,Eo.lineStart=Lre,Eo.lineEnd=zre},polygonEnd:function(){var e=+x1;w1.add(e<0?jn+e:e),this.lineStart=this.lineEnd=this.point=Kt},sphere:function(){w1.add(jn)}};function Lre(){Eo.point=Ire}function zre(){e9(ZI,JI)}function Ire(e,t){Eo.point=e9,ZI=e,JI=t,e*=ye,t*=ye,FE=e,ME=le(t=t/2+m1),TE=se(t)}function e9(e,t){e*=ye,t*=ye,t=t/2+m1;var n=e-FE,r=n>=0?1:-1,i=r*n,o=le(t),s=se(t),a=TE*s,u=ME*o+a*le(i),l=a*r*se(i);x1.add(ri(l,u)),FE=e,ME=o,TE=s}function Bre(e){return w1=new In,Xo(e,Eo),w1*2}function b1(e){return[ri(e[1],e[0]),lr(e[2])]}function nl(e){var t=e[0],n=e[1],r=le(n);return[r*le(t),r*se(t),se(n)]}function tm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function nf(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function q2(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function nm(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function E1(e){var t=Un(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var it,Zn,ct,vr,bu,t9,n9,Cc,xh,Ws,ws,Go={point:NE,lineStart:$N,lineEnd:CN,polygonStart:function(){Go.point=i9,Go.lineStart=jre,Go.lineEnd=Ure,xh=new In,Eo.polygonStart()},polygonEnd:function(){Eo.polygonEnd(),Go.point=NE,Go.lineStart=$N,Go.lineEnd=CN,x1<0?(it=-(ct=180),Zn=-(vr=90)):xh>ue?vr=90:xh<-ue&&(Zn=-90),ws[0]=it,ws[1]=ct},sphere:function(){it=-(ct=180),Zn=-(vr=90)}};function NE(e,t){Ws.push(ws=[it=e,ct=e]),t<Zn&&(Zn=t),t>vr&&(vr=t)}function r9(e,t){var n=nl([e*ye,t*ye]);if(Cc){var r=nf(Cc,n),i=[r[1],-r[0],0],o=nf(i,r);E1(o),o=b1(o);var s=e-bu,a=s>0?1:-1,u=o[0]*mt*a,l,c=ke(s)>180;c^(a*bu<u&&u<a*e)?(l=o[1]*mt,l>vr&&(vr=l)):(u=(u+360)%360-180,c^(a*bu<u&&u<a*e)?(l=-o[1]*mt,l<Zn&&(Zn=l)):(t<Zn&&(Zn=t),t>vr&&(vr=t))),c?e<bu?yr(it,e)>yr(it,ct)&&(ct=e):yr(e,ct)>yr(it,ct)&&(it=e):ct>=it?(e<it&&(it=e),e>ct&&(ct=e)):e>bu?yr(it,e)>yr(it,ct)&&(ct=e):yr(e,ct)>yr(it,ct)&&(it=e)}else Ws.push(ws=[it=e,ct=e]);t<Zn&&(Zn=t),t>vr&&(vr=t),Cc=n,bu=e}function $N(){Go.point=r9}function CN(){ws[0]=it,ws[1]=ct,Go.point=NE,Cc=null}function i9(e,t){if(Cc){var n=e-bu;xh.add(ke(n)>180?n+(n>0?360:-360):n)}else t9=e,n9=t;Eo.point(e,t),r9(e,t)}function jre(){Eo.lineStart()}function Ure(){i9(t9,n9),Eo.lineEnd(),ke(xh)>ue&&(it=-(ct=180)),ws[0]=it,ws[1]=ct,Cc=null}function yr(e,t){return(t-=e)<0?t+360:t}function Wre(e,t){return e[0]-t[0]}function AN(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function qre(e){var t,n,r,i,o,s,a;if(vr=ct=-(it=Zn=1/0),Ws=[],Xo(e,Go),n=Ws.length){for(Ws.sort(Wre),t=1,r=Ws[0],o=[r];t<n;++t)i=Ws[t],AN(r,i[0])||AN(r,i[1])?(yr(r[0],i[1])>yr(r[0],r[1])&&(r[1]=i[1]),yr(i[0],r[1])>yr(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,n=o.length-1,t=0,r=o[n];t<=n;r=i,++t)i=o[t],(a=yr(r[1],i[0]))>s&&(s=a,it=i[0],ct=r[1])}return Ws=ws=null,it===1/0||Zn===1/0?[[NaN,NaN],[NaN,NaN]]:[[it,Zn],[ct,vr]]}var Hd,S1,_1,k1,$1,C1,A1,F1,OE,RE,DE,o9,s9,On,Rn,Dn,ki={sphere:Kt,point:FC,lineStart:FN,lineEnd:MN,polygonStart:function(){ki.lineStart=Gre,ki.lineEnd=Yre},polygonEnd:function(){ki.lineStart=FN,ki.lineEnd=MN}};function FC(e,t){e*=ye,t*=ye;var n=le(t);Kp(n*le(e),n*se(e),se(t))}function Kp(e,t,n){++Hd,_1+=(e-_1)/Hd,k1+=(t-k1)/Hd,$1+=(n-$1)/Hd}function FN(){ki.point=Hre}function Hre(e,t){e*=ye,t*=ye;var n=le(t);On=n*le(e),Rn=n*se(e),Dn=se(t),ki.point=Vre,Kp(On,Rn,Dn)}function Vre(e,t){e*=ye,t*=ye;var n=le(t),r=n*le(e),i=n*se(e),o=se(t),s=ri(Un((s=Rn*o-Dn*i)*s+(s=Dn*r-On*o)*s+(s=On*i-Rn*r)*s),On*r+Rn*i+Dn*o);S1+=s,C1+=s*(On+(On=r)),A1+=s*(Rn+(Rn=i)),F1+=s*(Dn+(Dn=o)),Kp(On,Rn,Dn)}function MN(){ki.point=FC}function Gre(){ki.point=Xre}function Yre(){a9(o9,s9),ki.point=FC}function Xre(e,t){o9=e,s9=t,e*=ye,t*=ye,ki.point=a9;var n=le(t);On=n*le(e),Rn=n*se(e),Dn=se(t),Kp(On,Rn,Dn)}function a9(e,t){e*=ye,t*=ye;var n=le(t),r=n*le(e),i=n*se(e),o=se(t),s=Rn*o-Dn*i,a=Dn*r-On*o,u=On*i-Rn*r,l=CE(s,a,u),c=lr(l),f=l&&-c/l;OE.add(f*s),RE.add(f*a),DE.add(f*u),S1+=c,C1+=c*(On+(On=r)),A1+=c*(Rn+(Rn=i)),F1+=c*(Dn+(Dn=o)),Kp(On,Rn,Dn)}function Qre(e){Hd=S1=_1=k1=$1=C1=A1=F1=0,OE=new In,RE=new In,DE=new In,Xo(e,ki);var t=+OE,n=+RE,r=+DE,i=CE(t,n,r);return i<g1&&(t=C1,n=A1,r=F1,S1<ue&&(t=_1,n=k1,r=$1),i=CE(t,n,r),i<g1)?[NaN,NaN]:[ri(n,t)*mt,lr(r/i)*mt]}function PE(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function LE(e,t){return ke(e)>xe&&(e-=Math.round(e/jn)*jn),[e,t]}LE.invert=LE;function u9(e,t,n){return(e%=jn)?t||n?PE(NN(e),ON(t,n)):NN(e):t||n?ON(t,n):LE}function TN(e){return function(t,n){return t+=e,ke(t)>xe&&(t-=Math.round(t/jn)*jn),[t,n]}}function NN(e){var t=TN(e);return t.invert=TN(-e),t}function ON(e,t){var n=le(e),r=se(e),i=le(t),o=se(t);function s(a,u){var l=le(u),c=le(a)*l,f=se(a)*l,d=se(u),h=d*n+c*r;return[ri(f*i-h*o,c*n-d*r),lr(h*i+f*o)]}return s.invert=function(a,u){var l=le(u),c=le(a)*l,f=se(a)*l,d=se(u),h=d*i-f*o;return[ri(f*i+d*o,c*n+h*r),lr(h*n-c*r)]},s}function Kre(e){e=u9(e[0]*ye,e[1]*ye,e.length>2?e[2]*ye:0);function t(n){return n=e(n[0]*ye,n[1]*ye),n[0]*=mt,n[1]*=mt,n}return t.invert=function(n){return n=e.invert(n[0]*ye,n[1]*ye),n[0]*=mt,n[1]*=mt,n},t}function Zre(e,t,n,r,i,o){if(n){var s=le(t),a=se(t),u=r*n;i==null?(i=t+r*jn,o=t-u/2):(i=RN(s,i),o=RN(s,o),(r>0?i<o:i>o)&&(i+=r*jn));for(var l,c=i;r>0?c>o:c<o;c-=u)l=b1([s,-a*le(c),-a*se(c)]),e.point(l[0],l[1])}}function RN(e,t){t=nl(t),t[0]-=e,E1(t);var n=KI(-t[1]);return((-t[2]<0?-n:n)+jn-ue)%jn}function l9(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Kt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Zm(e,t){return ke(e[0]-t[0])<ue&&ke(e[1]-t[1])<ue}function rm(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function c9(e,t,n,r,i){var o=[],s=[],a,u;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,y=p[0],m=p[g],v;if(Zm(y,m)){if(!y[2]&&!m[2]){for(i.lineStart(),a=0;a<g;++a)i.point((y=p[a])[0],y[1]);i.lineEnd();return}m[0]+=2*ue}o.push(v=new rm(y,p,null,!0)),s.push(v.o=new rm(y,null,v,!1)),o.push(v=new rm(m,p,null,!1)),s.push(v.o=new rm(m,null,v,!0))}}),!!o.length){for(s.sort(t),DN(o),DN(s),a=0,u=s.length;a<u;++a)s[a].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,u=c.length;a<u;++a)i.point((f=c[a])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,a=c.length-1;a>=0;--a)i.point((f=c[a])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function DN(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function H2(e){return ke(e[0])<=xe?e[0]:Hr(e[0])*((ke(e[0])+xe)%jn-xe)}function Jre(e,t){var n=H2(t),r=t[1],i=se(r),o=[se(n),-le(n),0],s=0,a=0,u=new In;i===1?r=ht+ue:i===-1&&(r=-ht-ue);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],p=H2(h),g=h[1]/2+m1,y=se(g),m=le(g),v=0;v<d;++v,p=w,y=S,m=E,h=x){var x=f[v],w=H2(x),b=x[1]/2+m1,S=se(b),E=le(b),_=w-p,k=_>=0?1:-1,$=k*_,C=$>xe,R=y*S;if(u.add(ri(R*k*se($),m*E+R*le($))),s+=C?_+k*jn:_,C^p>=n^w>=n){var A=nf(nl(h),nl(x));E1(A);var M=nf(o,A);E1(M);var F=(C^_>=0?-1:1)*lr(M[2]);(r>F||r===F&&(A[0]||A[1]))&&(a+=C^_>=0?1:-1)}}return(s<-ue||s<ue&&u<-g1)^a&1}function f9(e,t,n,r){return function(i){var o=t(i),s=l9(),a=t(s),u=!1,l,c,f,d={point:h,lineStart:g,lineEnd:y,polygonStart:function(){d.point=m,d.lineStart=v,d.lineEnd=x,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=y,c=tP(c);var w=Jre(l,r);c.length?(u||(i.polygonStart(),u=!0),c9(c,tie,w,n,i)):w&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(w,b){e(w,b)&&i.point(w,b)}function p(w,b){o.point(w,b)}function g(){d.point=p,o.lineStart()}function y(){d.point=h,o.lineEnd()}function m(w,b){f.push([w,b]),a.point(w,b)}function v(){a.lineStart(),f=[]}function x(){m(f[0][0],f[0][1]),a.lineEnd();var w=a.clean(),b=s.result(),S,E=b.length,_,k,$;if(f.pop(),l.push(f),f=null,!!E){if(w&1){if(k=b[0],(_=k.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),S=0;S<_;++S)i.point(($=k[S])[0],$[1]);i.lineEnd()}return}E>1&&w&2&&b.push(b.pop().concat(b.shift())),c.push(b.filter(eie))}}return d}}function eie(e){return e.length>1}function tie(e,t){return((e=e.x)[0]<0?e[1]-ht-ue:ht-e[1])-((t=t.x)[0]<0?t[1]-ht-ue:ht-t[1])}const PN=f9(function(){return!0},nie,iie,[-xe,-ht]);function nie(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,s){var a=o>0?xe:-xe,u=ke(o-t);ke(u-xe)<ue?(e.point(t,n=(n+s)/2>0?ht:-ht),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(o,n),i=0):r!==a&&u>=xe&&(ke(t-r)<ue&&(t-=r*ue),ke(o-a)<ue&&(o-=a*ue),n=rie(t,n,o,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),i=0),e.point(t=o,n=s),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function rie(e,t,n,r){var i,o,s=se(e-n);return ke(s)>ue?Bf((se(t)*(o=le(r))*se(n)-se(r)*(i=le(t))*se(e))/(i*o*s)):(t+r)/2}function iie(e,t,n,r){var i;if(e==null)i=n*ht,r.point(-xe,i),r.point(0,i),r.point(xe,i),r.point(xe,0),r.point(xe,-i),r.point(0,-i),r.point(-xe,-i),r.point(-xe,0),r.point(-xe,i);else if(ke(e[0]-t[0])>ue){var o=e[0]<t[0]?xe:-xe;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function oie(e){var t=le(e),n=2*ye,r=t>0,i=ke(t)>ue;function o(c,f,d,h){Zre(h,e,n,d,c,f)}function s(c,f){return le(c)*le(f)>t}function a(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(y,m){var v=[y,m],x,w=s(y,m),b=r?w?0:l(y,m):w?l(y+(y<0?xe:-xe),m):0;if(!f&&(p=h=w)&&c.lineStart(),w!==h&&(x=u(f,v),(!x||Zm(f,x)||Zm(v,x))&&(v[2]=1)),w!==h)g=0,w?(c.lineStart(),x=u(v,f),c.point(x[0],x[1])):(x=u(f,v),c.point(x[0],x[1],2),c.lineEnd()),f=x;else if(i&&f&&r^w){var S;!(b&d)&&(S=u(v,f,!0))&&(g=0,r?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}w&&(!f||!Zm(f,v))&&c.point(v[0],v[1]),f=v,h=w,d=b},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function u(c,f,d){var h=nl(c),p=nl(f),g=[1,0,0],y=nf(h,p),m=tm(y,y),v=y[0],x=m-v*v;if(!x)return!d&&c;var w=t*m/x,b=-t*v/x,S=nf(g,y),E=nm(g,w),_=nm(y,b);q2(E,_);var k=S,$=tm(E,k),C=tm(k,k),R=$*$-C*(tm(E,E)-1);if(!(R<0)){var A=Un(R),M=nm(k,(-$-A)/C);if(q2(M,E),M=b1(M),!d)return M;var F=c[0],N=f[0],P=c[1],T=f[1],O;N<F&&(O=F,F=N,N=O);var j=N-F,X=ke(j-xe)<ue,re=X||j<ue;if(!X&&T<P&&(O=P,P=T,T=O),re?X?P+T>0^M[1]<(ke(M[0]-F)<ue?P:T):P<=M[1]&&M[1]<=T:j>xe^(F<=M[0]&&M[0]<=N)){var we=nm(k,(-$+A)/C);return q2(we,E),[M,b1(we)]}}}function l(c,f){var d=r?e:xe-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return f9(s,a,o,r?[0,-e]:[-xe,e-xe])}function sie(e,t,n,r,i,o){var s=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,d=u-s,h=l-a,p;if(p=n-s,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-s,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=o-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=s+c*d,e[1]=a+c*h),f<1&&(t[0]=s+f*d,t[1]=a+f*h),!0}}}}}var Vd=1e9,im=-Vd;function d9(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function o(l,c,f,d){var h=0,p=0;if(l==null||(h=s(l,f))!==(p=s(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function s(l,c){return ke(l[0]-e)<ue?c>0?0:3:ke(l[0]-n)<ue?c>0?2:1:ke(l[1]-t)<ue?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=s(l,1),d=s(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=l9(),d,h,p,g,y,m,v,x,w,b,S,E={point:_,lineStart:R,lineEnd:A,polygonStart:$,polygonEnd:C};function _(F,N){i(F,N)&&c.point(F,N)}function k(){for(var F=0,N=0,P=h.length;N<P;++N)for(var T=h[N],O=1,j=T.length,X=T[0],re,we,he=X[0],Re=X[1];O<j;++O)re=he,we=Re,X=T[O],he=X[0],Re=X[1],we<=r?Re>r&&(he-re)*(r-we)>(Re-we)*(e-re)&&++F:Re<=r&&(he-re)*(r-we)<(Re-we)*(e-re)&&--F;return F}function $(){c=f,d=[],h=[],S=!0}function C(){var F=k(),N=S&&F,P=(d=tP(d)).length;(N||P)&&(l.polygonStart(),N&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),P&&c9(d,a,F,o,l),l.polygonEnd()),c=l,d=h=p=null}function R(){E.point=M,h&&h.push(p=[]),b=!0,w=!1,v=x=NaN}function A(){d&&(M(g,y),m&&w&&f.rejoin(),d.push(f.result())),E.point=_,w&&c.lineEnd()}function M(F,N){var P=i(F,N);if(h&&p.push([F,N]),b)g=F,y=N,m=P,b=!1,P&&(c.lineStart(),c.point(F,N));else if(P&&w)c.point(F,N);else{var T=[v=Math.max(im,Math.min(Vd,v)),x=Math.max(im,Math.min(Vd,x))],O=[F=Math.max(im,Math.min(Vd,F)),N=Math.max(im,Math.min(Vd,N))];sie(T,O,e,t,n,r)?(w||(c.lineStart(),c.point(T[0],T[1])),c.point(O[0],O[1]),P||c.lineEnd(),S=!1):P&&(c.lineStart(),c.point(F,N),S=!1)}v=F,x=N,w=P}return E}}function LN(e,t,n){var r=Er(e,t-ue,n).concat(t);return function(i){return r.map(function(o){return[i,o]})}}function zN(e,t,n){var r=Er(e,t-ue,n).concat(t);return function(i){return r.map(function(o){return[o,i]})}}function aie(){var e,t,n,r,i,o,s,a,u=10,l=u,c=90,f=360,d,h,p,g,y=2.5;function m(){return{type:"MultiLineString",coordinates:v()}}function v(){return Er(em(r/c)*c,n,c).map(p).concat(Er(em(a/f)*f,s,f).map(g)).concat(Er(em(t/u)*u,e,u).filter(function(x){return ke(x%c)>ue}).map(d)).concat(Er(em(o/l)*l,i,l).filter(function(x){return ke(x%f)>ue}).map(h))}return m.lines=function(){return v().map(function(x){return{type:"LineString",coordinates:x}})},m.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(s).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},m.extent=function(x){return arguments.length?m.extentMajor(x).extentMinor(x):m.extentMinor()},m.extentMajor=function(x){return arguments.length?(r=+x[0][0],n=+x[1][0],a=+x[0][1],s=+x[1][1],r>n&&(x=r,r=n,n=x),a>s&&(x=a,a=s,s=x),m.precision(y)):[[r,a],[n,s]]},m.extentMinor=function(x){return arguments.length?(t=+x[0][0],e=+x[1][0],o=+x[0][1],i=+x[1][1],t>e&&(x=t,t=e,e=x),o>i&&(x=o,o=i,i=x),m.precision(y)):[[t,o],[e,i]]},m.step=function(x){return arguments.length?m.stepMajor(x).stepMinor(x):m.stepMinor()},m.stepMajor=function(x){return arguments.length?(c=+x[0],f=+x[1],m):[c,f]},m.stepMinor=function(x){return arguments.length?(u=+x[0],l=+x[1],m):[u,l]},m.precision=function(x){return arguments.length?(y=+x,d=LN(o,i,90),h=zN(t,e,y),p=LN(a,s,90),g=zN(r,n,y),m):y},m.extentMajor([[-180,-90+ue],[180,90-ue]]).extentMinor([[-180,-80-ue],[180,80+ue]])}const op=e=>e;var V2=new In,zE=new In,h9,p9,IE,BE,Qo={point:Kt,lineStart:Kt,lineEnd:Kt,polygonStart:function(){Qo.lineStart=uie,Qo.lineEnd=cie},polygonEnd:function(){Qo.lineStart=Qo.lineEnd=Qo.point=Kt,V2.add(ke(zE)),zE=new In},result:function(){var e=V2/2;return V2=new In,e}};function uie(){Qo.point=lie}function lie(e,t){Qo.point=g9,h9=IE=e,p9=BE=t}function g9(e,t){zE.add(BE*e-IE*t),IE=e,BE=t}function cie(){g9(h9,p9)}var rf=1/0,M1=rf,sp=-rf,T1=sp,N1={point:fie,lineStart:Kt,lineEnd:Kt,polygonStart:Kt,polygonEnd:Kt,result:function(){var e=[[rf,M1],[sp,T1]];return sp=T1=-(M1=rf=1/0),e}};function fie(e,t){e<rf&&(rf=e),e>sp&&(sp=e),t<M1&&(M1=t),t>T1&&(T1=t)}var jE=0,UE=0,Gd=0,O1=0,R1=0,gc=0,WE=0,qE=0,Yd=0,m9,y9,so,ao,Ur={point:rl,lineStart:IN,lineEnd:BN,polygonStart:function(){Ur.lineStart=pie,Ur.lineEnd=gie},polygonEnd:function(){Ur.point=rl,Ur.lineStart=IN,Ur.lineEnd=BN},result:function(){var e=Yd?[WE/Yd,qE/Yd]:gc?[O1/gc,R1/gc]:Gd?[jE/Gd,UE/Gd]:[NaN,NaN];return jE=UE=Gd=O1=R1=gc=WE=qE=Yd=0,e}};function rl(e,t){jE+=e,UE+=t,++Gd}function IN(){Ur.point=die}function die(e,t){Ur.point=hie,rl(so=e,ao=t)}function hie(e,t){var n=e-so,r=t-ao,i=Un(n*n+r*r);O1+=i*(so+e)/2,R1+=i*(ao+t)/2,gc+=i,rl(so=e,ao=t)}function BN(){Ur.point=rl}function pie(){Ur.point=mie}function gie(){v9(m9,y9)}function mie(e,t){Ur.point=v9,rl(m9=so=e,y9=ao=t)}function v9(e,t){var n=e-so,r=t-ao,i=Un(n*n+r*r);O1+=i*(so+e)/2,R1+=i*(ao+t)/2,gc+=i,i=ao*e-so*t,WE+=i*(so+e),qE+=i*(ao+t),Yd+=i*3,rl(so=e,ao=t)}function x9(e){this._context=e}x9.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,jn);break}}},result:Kt};var HE=new In,G2,w9,b9,Xd,Qd,ap={point:Kt,lineStart:function(){ap.point=yie},lineEnd:function(){G2&&E9(w9,b9),ap.point=Kt},polygonStart:function(){G2=!0},polygonEnd:function(){G2=null},result:function(){var e=+HE;return HE=new In,e}};function yie(e,t){ap.point=E9,w9=Xd=e,b9=Qd=t}function E9(e,t){Xd-=e,Qd-=t,HE.add(Un(Xd*Xd+Qd*Qd)),Xd=e,Qd=t}let jN,D1,UN,WN;class qN{constructor(t){this._append=t==null?S9:vie(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==UN||this._append!==D1){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,UN=r,D1=this._append,WN=this._,this._=i}this._+=WN;break}}}result(){const t=this._;return this._="",t.length?t:null}}function S9(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function vie(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return S9;if(t!==jN){const n=10**t;jN=t,D1=function(i){let o=1;this._+=i[0];for(const s=i.length;o<s;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}return D1}function _9(e,t){let n=3,r=4.5,i,o;function s(a){return a&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),Xo(a,i(o))),o.result()}return s.area=function(a){return Xo(a,i(Qo)),Qo.result()},s.measure=function(a){return Xo(a,i(ap)),ap.result()},s.bounds=function(a){return Xo(a,i(N1)),N1.result()},s.centroid=function(a){return Xo(a,i(Ur)),Ur.result()},s.projection=function(a){return arguments.length?(i=a==null?(e=null,op):(e=a).stream,s):e},s.context=function(a){return arguments.length?(o=a==null?(t=null,new qN(n)):new x9(t=a),typeof r!="function"&&o.pointRadius(r),s):t},s.pointRadius=function(a){return arguments.length?(r=typeof a=="function"?a:(o.pointRadius(+a),+a),s):r},s.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);n=u}return t===null&&(o=new qN(n)),s},s.projection(e).digits(n).context(t)}function Av(e){return function(t){var n=new VE;for(var r in e)n[r]=e[r];return n.stream=t,n}}function VE(){}VE.prototype={constructor:VE,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function MC(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Xo(n,e.stream(N1)),t(N1.result()),r!=null&&e.clipExtent(r),e}function Fv(e,t,n){return MC(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),a=+t[0][0]+(i-s*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(o-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,u])},n)}function TC(e,t,n){return Fv(e,[[0,0],t],n)}function NC(e,t,n){return MC(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),s=(i-o*(r[1][0]+r[0][0]))/2,a=-o*r[0][1];e.scale(150*o).translate([s,a])},n)}function OC(e,t,n){return MC(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),s=-o*r[0][0],a=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,a])},n)}var HN=16,xie=le(30*ye);function VN(e,t){return+t?bie(e,t):wie(e)}function wie(e){return Av({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function bie(e,t){function n(r,i,o,s,a,u,l,c,f,d,h,p,g,y){var m=l-r,v=c-i,x=m*m+v*v;if(x>4*t&&g--){var w=s+d,b=a+h,S=u+p,E=Un(w*w+b*b+S*S),_=lr(S/=E),k=ke(ke(S)-1)<ue||ke(o-f)<ue?(o+f)/2:ri(b,w),$=e(k,_),C=$[0],R=$[1],A=C-r,M=R-i,F=v*A-m*M;(F*F/x>t||ke((m*A+v*M)/x-.5)>.3||s*d+a*h+u*p<xie)&&(n(r,i,o,s,a,u,C,R,k,w/=E,b/=E,S,g,y),y.point(C,R),n(C,R,k,w,b,S,l,c,f,d,h,p,g,y))}}return function(r){var i,o,s,a,u,l,c,f,d,h,p,g,y={point:m,lineStart:v,lineEnd:w,polygonStart:function(){r.polygonStart(),y.lineStart=b},polygonEnd:function(){r.polygonEnd(),y.lineStart=v}};function m(_,k){_=e(_,k),r.point(_[0],_[1])}function v(){f=NaN,y.point=x,r.lineStart()}function x(_,k){var $=nl([_,k]),C=e(_,k);n(f,d,c,h,p,g,f=C[0],d=C[1],c=_,h=$[0],p=$[1],g=$[2],HN,r),r.point(f,d)}function w(){y.point=m,r.lineEnd()}function b(){v(),y.point=S,y.lineEnd=E}function S(_,k){x(i=_,k),o=f,s=d,a=h,u=p,l=g,y.point=x}function E(){n(f,d,c,h,p,g,o,s,i,a,u,l,HN,r),y.lineEnd=w,w()}return y}}var Eie=Av({point:function(e,t){this.stream.point(e*ye,t*ye)}});function Sie(e){return Av({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function _ie(e,t,n,r,i){function o(s,a){return s*=r,a*=i,[t+e*s,n-e*a]}return o.invert=function(s,a){return[(s-t)/e*r,(n-a)/e*i]},o}function GN(e,t,n,r,i,o){if(!o)return _ie(e,t,n,r,i);var s=le(o),a=se(o),u=s*e,l=a*e,c=s/e,f=a/e,d=(a*n-s*t)/e,h=(a*t+s*n)/e;function p(g,y){return g*=r,y*=i,[u*g-l*y+t,n-l*g-u*y]}return p.invert=function(g,y){return[r*(c*g-f*y+d),i*(h-f*g-c*y)]},p}function To(e){return k9(function(){return e})()}function k9(e){var t,n=150,r=480,i=250,o=0,s=0,a=0,u=0,l=0,c,f=0,d=1,h=1,p=null,g=PN,y=null,m,v,x,w=op,b=.5,S,E,_,k,$;function C(F){return _(F[0]*ye,F[1]*ye)}function R(F){return F=_.invert(F[0],F[1]),F&&[F[0]*mt,F[1]*mt]}C.stream=function(F){return k&&$===F?k:k=Eie(Sie(c)(g(S(w($=F)))))},C.preclip=function(F){return arguments.length?(g=F,p=void 0,M()):g},C.postclip=function(F){return arguments.length?(w=F,y=m=v=x=null,M()):w},C.clipAngle=function(F){return arguments.length?(g=+F?oie(p=F*ye):(p=null,PN),M()):p*mt},C.clipExtent=function(F){return arguments.length?(w=F==null?(y=m=v=x=null,op):d9(y=+F[0][0],m=+F[0][1],v=+F[1][0],x=+F[1][1]),M()):y==null?null:[[y,m],[v,x]]},C.scale=function(F){return arguments.length?(n=+F,A()):n},C.translate=function(F){return arguments.length?(r=+F[0],i=+F[1],A()):[r,i]},C.center=function(F){return arguments.length?(o=F[0]%360*ye,s=F[1]%360*ye,A()):[o*mt,s*mt]},C.rotate=function(F){return arguments.length?(a=F[0]%360*ye,u=F[1]%360*ye,l=F.length>2?F[2]%360*ye:0,A()):[a*mt,u*mt,l*mt]},C.angle=function(F){return arguments.length?(f=F%360*ye,A()):f*mt},C.reflectX=function(F){return arguments.length?(d=F?-1:1,A()):d<0},C.reflectY=function(F){return arguments.length?(h=F?-1:1,A()):h<0},C.precision=function(F){return arguments.length?(S=VN(E,b=F*F),M()):Un(b)},C.fitExtent=function(F,N){return Fv(C,F,N)},C.fitSize=function(F,N){return TC(C,F,N)},C.fitWidth=function(F,N){return NC(C,F,N)},C.fitHeight=function(F,N){return OC(C,F,N)};function A(){var F=GN(n,0,0,d,h,f).apply(null,t(o,s)),N=GN(n,r-F[0],i-F[1],d,h,f);return c=u9(a,u,l),E=PE(t,N),_=PE(c,E),S=VN(E,b),M()}function M(){return k=$=null,C}return function(){return t=e.apply(this,arguments),C.invert=t.invert&&R,A()}}function RC(e){var t=0,n=xe/3,r=k9(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*ye,n=o[1]*ye):[t*mt,n*mt]},i}function kie(e){var t=le(e);function n(r,i){return[r*t,se(i)/t]}return n.invert=function(r,i){return[r/t,lr(i*t)]},n}function $ie(e,t){var n=se(e),r=(n+se(t))/2;if(ke(r)<ue)return kie(e);var i=1+n*(2*r-n),o=Un(i)/r;function s(a,u){var l=Un(i-2*r*se(u))/r;return[l*se(a*=r),o-l*le(a)]}return s.invert=function(a,u){var l=o-u,c=ri(a,ke(l))*Hr(l);return l*r<0&&(c-=xe*Hr(a)*Hr(l)),[c/r,lr((i-(a*a+l*l)*r*r)/(2*r))]},s}function P1(){return RC($ie).scale(155.424).center([0,33.6442])}function $9(){return P1().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Cie(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function Aie(){var e,t,n=$9(),r,i=P1().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,s=P1().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,r.point(h,p),u||(o.point(h,p),u)||(a.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,y=(d[1]-p[1])/h;return(y>=.12&&y<.234&&g>=-.425&&g<-.214?i:y>=.166&&y<.234&&g>=-.214&&g<-.115?s:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=Cie([n.stream(t=d),i.stream(d),s.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),s.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),s.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),o=i.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+ue,g+.12*h+ue],[p-.214*h-ue,g+.234*h-ue]]).stream(l),a=s.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+ue,g+.166*h+ue],[p-.115*h-ue,g+.234*h-ue]]).stream(l),f()},c.fitExtent=function(d,h){return Fv(c,d,h)},c.fitSize=function(d,h){return TC(c,d,h)},c.fitWidth=function(d,h){return NC(c,d,h)},c.fitHeight=function(d,h){return OC(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function C9(e){return function(t,n){var r=le(t),i=le(n),o=e(r*i);return o===1/0?[2,0]:[o*i*se(t),o*se(n)]}}function Zp(e){return function(t,n){var r=Un(t*t+n*n),i=e(r),o=se(i),s=le(i);return[ri(t*o,r*s),lr(r&&n*o/r)]}}var A9=C9(function(e){return Un(2/(1+e))});A9.invert=Zp(function(e){return 2*lr(e/2)});function Fie(){return To(A9).scale(124.75).clipAngle(180-.001)}var F9=C9(function(e){return(e=KI(e))&&e/se(e)});F9.invert=Zp(function(e){return e});function Mie(){return To(F9).scale(79.4188).clipAngle(180-.001)}function Mv(e,t){return[e,y1(AC((ht+t)/2))]}Mv.invert=function(e,t){return[e,2*Bf(QI(t))-ht]};function Tie(){return M9(Mv).scale(961/jn)}function M9(e){var t=To(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,s=null,a,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?s=a=u=l=null:(s=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):s==null?null:[[s,a],[u,l]]};function c(){var f=xe*r(),d=t(Kre(t.rotate()).invert([0,0]));return o(s==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Mv?[[Math.max(d[0]-f,s),a],[Math.min(d[0]+f,u),l]]:[[s,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return c()}function om(e){return AC((ht+e)/2)}function Nie(e,t){var n=le(e),r=e===t?se(e):y1(n/le(t))/y1(om(t)/om(e)),i=n*W2(om(e),r)/r;if(!r)return Mv;function o(s,a){i>0?a<-ht+ue&&(a=-ht+ue):a>ht-ue&&(a=ht-ue);var u=i/W2(om(a),r);return[u*se(r*s),i-u*le(r*s)]}return o.invert=function(s,a){var u=i-a,l=Hr(r)*Un(s*s+u*u),c=ri(s,ke(u))*Hr(u);return u*r<0&&(c-=xe*Hr(s)*Hr(u)),[c/r,2*Bf(W2(i/l,1/r))-ht]},o}function Oie(){return RC(Nie).scale(109.5).parallels([30,30])}function L1(e,t){return[e,t]}L1.invert=L1;function Rie(){return To(L1).scale(152.63)}function Die(e,t){var n=le(e),r=e===t?se(e):(n-le(t))/(t-e),i=n/r+e;if(ke(r)<ue)return L1;function o(s,a){var u=i-a,l=r*s;return[u*se(l),i-u*le(l)]}return o.invert=function(s,a){var u=i-a,l=ri(s,ke(u))*Hr(u);return u*r<0&&(l-=xe*Hr(s)*Hr(u)),[l/r,i-Hr(r)*Un(s*s+u*u)]},o}function Pie(){return RC(Die).scale(131.154).center([0,13.9389])}var wh=1.340264,bh=-.081106,Eh=893e-6,Sh=.003796,z1=Un(3)/2,Lie=12;function T9(e,t){var n=lr(z1*se(t)),r=n*n,i=r*r*r;return[e*le(n)/(z1*(wh+3*bh*r+i*(7*Eh+9*Sh*r))),n*(wh+bh*r+i*(Eh+Sh*r))]}T9.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,o=0,s,a,u;o<Lie&&(a=n*(wh+bh*r+i*(Eh+Sh*r))-t,u=wh+3*bh*r+i*(7*Eh+9*Sh*r),n-=s=a/u,r=n*n,i=r*r*r,!(ke(s)<g1));++o);return[z1*e*(wh+3*bh*r+i*(7*Eh+9*Sh*r))/le(n),lr(se(n)/z1)]};function zie(){return To(T9).scale(177.158)}function N9(e,t){var n=le(t),r=le(e)*n;return[n*se(e)/r,se(t)/r]}N9.invert=Zp(Bf);function Iie(){return To(N9).scale(144.049).clipAngle(60)}function Bie(){var e=1,t=0,n=0,r=1,i=1,o=0,s,a,u=null,l,c,f,d=1,h=1,p=Av({point:function(w,b){var S=x([w,b]);this.stream.point(S[0],S[1])}}),g=op,y,m;function v(){return d=e*r,h=e*i,y=m=null,x}function x(w){var b=w[0]*d,S=w[1]*h;if(o){var E=S*s-b*a;b=b*s+S*a,S=E}return[b+t,S+n]}return x.invert=function(w){var b=w[0]-t,S=w[1]-n;if(o){var E=S*s+b*a;b=b*s-S*a,S=E}return[b/d,S/h]},x.stream=function(w){return y&&m===w?y:y=p(g(m=w))},x.postclip=function(w){return arguments.length?(g=w,u=l=c=f=null,v()):g},x.clipExtent=function(w){return arguments.length?(g=w==null?(u=l=c=f=null,op):d9(u=+w[0][0],l=+w[0][1],c=+w[1][0],f=+w[1][1]),v()):u==null?null:[[u,l],[c,f]]},x.scale=function(w){return arguments.length?(e=+w,v()):e},x.translate=function(w){return arguments.length?(t=+w[0],n=+w[1],v()):[t,n]},x.angle=function(w){return arguments.length?(o=w%360*ye,a=se(o),s=le(o),v()):o*mt},x.reflectX=function(w){return arguments.length?(r=w?-1:1,v()):r<0},x.reflectY=function(w){return arguments.length?(i=w?-1:1,v()):i<0},x.fitExtent=function(w,b){return Fv(x,w,b)},x.fitSize=function(w,b){return TC(x,w,b)},x.fitWidth=function(w,b){return NC(x,w,b)},x.fitHeight=function(w,b){return OC(x,w,b)},x}function O9(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}O9.invert=function(e,t){var n=t,r=25,i;do{var o=n*n,s=o*o;n-=i=(n*(1.007226+o*(.015085+s*(-.044475+.028874*o-.005916*s)))-t)/(1.007226+o*(.015085*3+s*(-.044475*7+.028874*9*o-.005916*11*s)))}while(ke(i)>ue&&--r>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function jie(){return To(O9).scale(175.295)}function R9(e,t){return[le(t)*se(e),se(t)]}R9.invert=Zp(lr);function Uie(){return To(R9).scale(249.5).clipAngle(90+ue)}function D9(e,t){var n=le(t),r=1+le(e)*n;return[n*se(e)/r,se(t)/r]}D9.invert=Zp(function(e){return 2*Bf(e)});function Wie(){return To(D9).scale(250).clipAngle(142)}function P9(e,t){return[y1(AC((ht+t)/2)),-e]}P9.invert=function(e,t){return[-t,2*Bf(QI(e))-ht]};function qie(){var e=M9(P9),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var Hie=Math.abs,GE=Math.cos,I1=Math.sin,Vie=1e-6,L9=Math.PI,YE=L9/2,YN=Gie(2);function XN(e){return e>1?YE:e<-1?-YE:Math.asin(e)}function Gie(e){return e>0?Math.sqrt(e):0}function Yie(e,t){var n=e*I1(t),r=30,i;do t-=i=(t+I1(t)-n)/(1+GE(t));while(Hie(i)>Vie&&--r>0);return t/2}function Xie(e,t,n){function r(i,o){return[e*i*GE(o=Yie(n,o)),t*I1(o)]}return r.invert=function(i,o){return o=XN(o/t),[i/(e*GE(o)),XN((2*o+I1(2*o))/n)]},r}var Qie=Xie(YN/YE,YN,L9);function Kie(){return To(Qie).scale(169.529)}const Zie=_9(),XE=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Jie(e,t){return function n(){const r=t();return r.type=e,r.path=_9().projection(r),r.copy=r.copy||function(){const i=n();return XE.forEach(o=>{r[o]&&i[o](r[o]())}),i.path.pointRadius(r.path.pointRadius()),i},Zz(r)}}function DC(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(B1[e]=Jie(e,t),this):B1[e]||null}function z9(e){return e&&e.path||Zie}const B1={albers:$9,albersusa:Aie,azimuthalequalarea:Fie,azimuthalequidistant:Mie,conicconformal:Oie,conicequalarea:P1,conicequidistant:Pie,equalEarth:zie,equirectangular:Rie,gnomonic:Iie,identity:Bie,mercator:Tie,mollweide:Kie,naturalEarth1:jie,orthographic:Uie,stereographic:Wie,transversemercator:qie};for(const e in B1)DC(e,B1[e]);function eoe(){}const jo=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function I9(){var e=1,t=1,n=a;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return o(u,l,d=>{n(d,u,l),toe(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(noe((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function o(u,l,c){var f=[],d=[],h,p,g,y,m,v;for(h=p=-1,y=u[0]>=l,jo[y<<1].forEach(x);++h<e-1;)g=y,y=u[h+1]>=l,jo[g|y<<1].forEach(x);for(jo[y<<0].forEach(x);++p<t-1;){for(h=-1,y=u[p*e+e]>=l,m=u[p*e]>=l,jo[y<<1|m<<2].forEach(x);++h<e-1;)g=y,y=u[p*e+e+h+1]>=l,v=m,m=u[p*e+h+1]>=l,jo[g|y<<1|m<<2|v<<3].forEach(x);jo[y|m<<3].forEach(x)}for(h=-1,m=u[p*e]>=l,jo[m<<2].forEach(x);++h<e-1;)v=m,m=u[p*e+h+1]>=l,jo[m<<2|v<<3].forEach(x);jo[m<<3].forEach(x);function x(w){var b=[w[0][0]+h,w[0][1]+p],S=[w[1][0]+h,w[1][1]+p],E=s(b),_=s(S),k,$;(k=d[E])?($=f[_])?(delete d[k.end],delete f[$.start],k===$?(k.ring.push(S),c(k.ring)):f[k.start]=d[$.end]={start:k.start,end:$.end,ring:k.ring.concat($.ring)}):(delete d[k.end],k.ring.push(S),d[k.end=_]=k):(k=f[_])?($=d[E])?(delete f[k.start],delete d[$.end],k===$?(k.ring.push(S),c(k.ring)):f[$.start]=d[k.end]={start:$.start,end:k.end,ring:$.ring.concat(k.ring)}):(delete f[k.start],k.ring.unshift(b),f[k.start=E]=k):f[E]=d[_]={start:E,end:_,ring:[b,S]}}}function s(u){return u[0]*2+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,y,m=l[g*e+p];d>0&&d<e&&p===d&&(y=l[g*e+p-1],f[0]=d+(c-y)/(m-y)-.5),h>0&&h<t&&g===h&&(y=l[(g-1)*e+p],f[1]=h+(c-y)/(m-y)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||z("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?a:eoe,r):n===a},r}function toe(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function noe(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=roe(e,t[n]))return i;return 0}function roe(e,t){for(var n=t[0],r=t[1],i=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var u=e[o],l=u[0],c=u[1],f=e[a],d=f[0],h=f[1];if(ioe(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function ioe(e,t,n){var r;return ooe(e,t,n)&&soe(e[r=+(e[0]===t[0])],n[r],t[r])}function ooe(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function soe(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function B9(e,t,n){return function(r){var i=vo(r),o=n?Math.min(i[0],0):i[0],s=i[1],a=s-o,u=t?$a(o,s,e):a/(e+1);return Er(o+u,s,u)}}function PC(e){D.call(this,null,e)}PC.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};G(PC,D,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||$n,o=I9().smooth(e.smooth!==!1),s=e.thresholds||aoe(r,i,e),a=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=o.size([c.width,c.height])(c.values,I(s)?s:s(c.values));uoe(f,c,l,e),f.forEach(d=>{u.push(Gy(l,De(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function aoe(e,t,n){const r=B9(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>Lu(t(i).values)))}function uoe(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;if(ge(i)&&(i=i(n,r)),ge(o)&&(o=o(n,r)),(i===1||i==null)&&!o)return;const s=(Ae(i)?i:i[0])||1,a=(Ae(i)?i:i[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach(j9(t,s,a,u,l))}function j9(e,t,n,r,i){const o=e.x1||0,s=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+r,f[1]=(f[1]-s)*n+i}return function(f){return f.coordinates.forEach(u),f}}function QN(e,t,n){const r=e>=0?e:Ak(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function Y2(e){return ge(e)?e:Cn(+e)}function U9(){var e=u=>u[0],t=u=>u[1],n=Cf,r=[-1,-1],i=960,o=500,s=2;function a(u,l){const c=QN(r[0],u,e)>>s,f=QN(r[1],u,t)>>s,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>s),g=2*h+(o>>s),y=new Float32Array(p*g),m=new Float32Array(p*g);let v=y;u.forEach(w=>{const b=d+(+e(w)>>s),S=h+(+t(w)>>s);b>=0&&b<p&&S>=0&&S<g&&(y[b+S*p]+=+n(w))}),c>0&&f>0?(Ul(p,g,y,m,c),Wl(p,g,m,y,f),Ul(p,g,y,m,c),Wl(p,g,m,y,f),Ul(p,g,y,m,c),Wl(p,g,m,y,f)):c>0?(Ul(p,g,y,m,c),Ul(p,g,m,y,c),Ul(p,g,y,m,c),v=m):f>0&&(Wl(p,g,y,m,f),Wl(p,g,m,y,f),Wl(p,g,y,m,f),v=m);const x=l?Math.pow(2,-2*s):1/nP(v);for(let w=0,b=p*g;w<b;++w)v[w]*=x;return{values:v,scale:1<<s,width:p,height:g,x1:d,y1:h,x2:d+(i>>s),y2:h+(o>>s)}}return a.x=function(u){return arguments.length?(e=Y2(u),a):e},a.y=function(u){return arguments.length?(t=Y2(u),a):t},a.weight=function(u){return arguments.length?(n=Y2(u),a):n},a.size=function(u){if(!arguments.length)return[i,o];var l=+u[0],c=+u[1];return l>=0&&c>=0||z("invalid size"),i=l,o=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||z("invalid cell size"),s=Math.floor(Math.log(u)/Math.LN2),a):1<<s},a.bandwidth=function(u){return arguments.length?(u=K(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&z("invalid bandwidth"),r=u,a):r},a}function Ul(e,t,n,r,i){const o=(i<<1)+1;for(let s=0;s<t;++s)for(let a=0,u=0;a<e+i;++a)a<e&&(u+=n[a+s*e]),a>=i&&(a>=o&&(u-=n[a-o+s*e]),r[a-i+s*e]=u/Math.min(a+1,e-1+o-a,o))}function Wl(e,t,n,r,i){const o=(i<<1)+1;for(let s=0;s<e;++s)for(let a=0,u=0;a<t+i;++a)a<t&&(u+=n[s+a*e]),a>=i&&(a>=o&&(u-=n[s+(a-o)*e]),r[s+(a-i)*e]=u/Math.min(a+1,t-1+o-a,o))}function LC(e){D.call(this,null,e)}LC.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const loe=["x","y","weight","size","cellSize","bandwidth"];function W9(e,t){return loe.forEach(n=>t[n]!=null?e[n](t[n]):0),e}G(LC,D,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=coe(r,e.groupby),o=(e.groupby||[]).map(gt),s=W9(U9(),e),a=e.as||"grid",u=[];function l(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return u=i.map(c=>De(l({[a]:s(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function coe(e,t){var n=[],r=c=>c(a),i,o,s,a,u,l;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function zC(e){D.call(this,null,e)}zC.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};G(zC,D,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=I9().smooth(e.smooth!==!1),i=e.values,o=e.thresholds||B9(e.count||10,e.nice,!!i),s=e.size,a,u;return i||(i=t.materialize(t.SOURCE).source,a=W9(U9(),e)(i,!0),u=j9(a,a.scale||1,a.scale||1,0,0),s=[a.width,a.height],i=a.values),o=I(o)?o:o(i),i=r.size(s)(i,o),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(De),n}});const QE="Feature",IC="FeatureCollection",foe="MultiPoint";function BC(e){D.call(this,null,e)}BC.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};G(BC,D,{transform(e,t){var n=this._features,r=this._points,i=e.fields,o=i&&i[0],s=i&&i[1],a=e.geojson||!i&&$n,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(bn(a))||o&&t.modified(bn(o))||s&&t.modified(bn(s)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),a&&t.visit(u,c=>n.push(a(c))),o&&s&&(t.visit(u,c=>{var f=o(c),d=s(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:QE,geometry:{type:foe,coordinates:r}})),this.value={type:IC,features:n}}});function jC(e){D.call(this,null,e)}jC.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};G(jC,D,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||$n,o=e.as||"path",s=n.SOURCE;!r||e.modified()?(this.value=r=z9(e.projection),n.materialize().reflow()):s=i===$n||t.modified(i.fields)?n.ADD_MOD:n.ADD;const a=doe(r,e.pointRadius);return n.visit(s,u=>u[o]=r(i(u))),r.pointRadius(a),n.modifies(o)}});function doe(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function UC(e){D.call(this,null,e)}UC.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};G(UC,D,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],o=e.as||["x","y"],s=o[0],a=o[1],u;function l(c){const f=n([r(c),i(c)]);f?(c[s]=f[0],c[a]=f[1]):(c[s]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(o)}});function WC(e){D.call(this,null,e)}WC.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};G(WC,D,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return(!r||e.modified())&&(this.value=r=hoe(z9(e.projection),e.field||Jr("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,s=>s[i]=r),n.modifies(i)}});function hoe(e,t,n){const r=n==null?i=>e(t(i)):i=>{var o=e.pointRadius(),s=e.pointRadius(n)(t(i));return e.pointRadius(o),s};return r.context=i=>(e.context(i),r),r}function qC(e){D.call(this,[],e),this.generator=aie()}qC.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};G(qC,D,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const o in e)ge(r[o])&&r[o](e[o]);return i=r(),n.length?t.mod.push(KP(n[0],i)):t.add.push(De(i)),n[0]=i,t}});function HC(e){D.call(this,null,e)}HC.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};G(HC,D,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||$n,o=goe(e.opacity,e),s=poe(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?Lu(n.map(l=>Lu(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=pe({},l,u);r||(f.$max=Lu(c.values||[])),l[a]=moe(c,f,s.dep?s:Cn(s(f)),o.dep?o:Cn(o(f)))}),t.reflow(!0).modifies(a)}});function poe(e,t){let n;return ge(e)?(n=r=>Fa(e(r,t)),n.dep=q9(e)):n=Cn(Fa(e||"#888")),n}function goe(e,t){let n;return ge(e)?(n=r=>e(r,t),n.dep=q9(e)):e?n=Cn(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function q9(e){if(!ge(e))return!1;const t=Oi(bn(e));return t.$x||t.$y||t.$value||t.$max}function moe(e,t,n,r){const i=e.width,o=e.height,s=e.x1||0,a=e.y1||0,u=e.x2||i,l=e.y2||o,c=e.values,f=c?y=>c[y]:Ys,d=wa(u-s,l-a),h=d.getContext("2d"),p=h.getImageData(0,0,u-s,l-a),g=p.data;for(let y=a,m=0;y<l;++y){t.$y=y-a;for(let v=s,x=y*i;v<u;++v,m+=4){t.$x=v-s,t.$value=f(v+x);const w=n(t);g[m+0]=w.r,g[m+1]=w.g,g[m+2]=w.b,g[m+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}function H9(e){D.call(this,null,e),this.modified(!0)}G(H9,D,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=voe(e.type),XE.forEach(r=>{e[r]!=null&&KN(n,r,e[r])})):XE.forEach(r=>{e.modified(r)&&KN(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&yoe(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function yoe(e,t){const n=xoe(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function voe(e){const t=DC((e||"mercator").toLowerCase());return t||z("Unrecognized projection type: "+e),t()}function KN(e,t,n){ge(e[t])&&e[t](n)}function xoe(e){return e=K(e),e.length===1?e[0]:{type:IC,features:e.reduce((t,n)=>t.concat(woe(n)),[])}}function woe(e){return e.type===IC?e.features:K(e).filter(t=>t!=null).map(t=>t.type===QE?t:{type:QE,geometry:t})}const boe=Object.freeze(Object.defineProperty({__proto__:null,contour:zC,geojson:BC,geopath:jC,geopoint:UC,geoshape:WC,graticule:qC,heatmap:HC,isocontour:PC,kde2d:LC,projection:H9},Symbol.toStringTag,{value:"Module"}));function Eoe(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var o,s=n.length,a,u=0,l=0;for(o=0;o<s;++o)a=n[o],u+=a.x,l+=a.y;for(u=(u/s-e)*r,l=(l/s-t)*r,o=0;o<s;++o)a=n[o],a.x-=u,a.y-=l}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(e=+o,i):e},i.y=function(o){return arguments.length?(t=+o,i):t},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function Soe(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return V9(this.cover(t,n),t,n,e)}function V9(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o=e._root,s={data:r},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,g,y,m,v;if(!o)return e._root=s,e;for(;o.length;)if((g=t>=(f=(a+l)/2))?a=f:l=f,(y=n>=(d=(u+c)/2))?u=d:c=d,i=o,!(o=o[m=y<<1|g]))return i[m]=s,e;if(h=+e._x.call(null,o.data),p=+e._y.call(null,o.data),t===h&&n===p)return s.next=o,i?i[m]=s:e._root=s,e;do i=i?i[m]=new Array(4):e._root=new Array(4),(g=t>=(f=(a+l)/2))?a=f:l=f,(y=n>=(d=(u+c)/2))?u=d:c=d;while((m=y<<1|g)===(v=(p>=d)<<1|h>=f));return i[v]=o,i[m]=s,e}function _oe(e){var t,n,r=e.length,i,o,s=new Array(r),a=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(s[n]=i,a[n]=o,i<u&&(u=i),i>c&&(c=i),o<l&&(l=o),o>f&&(f=o));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)V9(this,s[n],a[n],e[n]);return this}function koe(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var s=i-n||1,a=this._root,u,l;n>e||e>=i||r>t||t>=o;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=a,a=u,s*=2,l){case 0:i=n+s,o=r+s;break;case 1:n=i-s,o=r+s;break;case 2:i=n+s,r=o-s;break;case 3:n=i-s,r=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function $oe(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Coe(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Pn(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Aoe(e,t,n){var r,i=this._x0,o=this._y0,s,a,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new Pn(h,i,o,c,f)),n==null?n=1/0:(i=e-n,o=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(s=p.x0)>c||(a=p.y0)>f||(u=p.x1)<i||(l=p.y1)<o))if(h.length){var y=(s+u)/2,m=(a+l)/2;d.push(new Pn(h[3],y,m,u,l),new Pn(h[2],s,m,y,l),new Pn(h[1],y,a,u,m),new Pn(h[0],s,a,y,m)),(g=(t>=m)<<1|e>=y)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var v=e-+this._x.call(null,h.data),x=t-+this._y.call(null,h.data),w=v*v+x*x;if(w<n){var b=Math.sqrt(n=w);i=e-b,o=t-b,c=e+b,f=t+b,r=h.data}}return r}function Foe(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,o,s=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,g,y,m;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(s+u)/2))?s=d:u=d,(g=f>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[y=g<<1|p]))return this;if(!n.length)break;(t[y+1&3]||t[y+2&3]||t[y+3&3])&&(r=t,m=y)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):t?(o?t[y]=o:delete t[y],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[m]=n:this._root=n),this):(this._root=o,this)}function Moe(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Toe(){return this._root}function Noe(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Ooe(e){var t=[],n,r=this._root,i,o,s,a,u;for(r&&t.push(new Pn(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,o=n.x0,s=n.y0,a=n.x1,u=n.y1)&&r.length){var l=(o+a)/2,c=(s+u)/2;(i=r[3])&&t.push(new Pn(i,l,c,a,u)),(i=r[2])&&t.push(new Pn(i,o,c,l,u)),(i=r[1])&&t.push(new Pn(i,l,s,a,c)),(i=r[0])&&t.push(new Pn(i,o,s,l,c))}return this}function Roe(e){var t=[],n=[],r;for(this._root&&t.push(new Pn(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var o,s=r.x0,a=r.y0,u=r.x1,l=r.y1,c=(s+u)/2,f=(a+l)/2;(o=i[0])&&t.push(new Pn(o,s,a,c,f)),(o=i[1])&&t.push(new Pn(o,c,a,u,f)),(o=i[2])&&t.push(new Pn(o,s,f,c,l)),(o=i[3])&&t.push(new Pn(o,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Doe(e){return e[0]}function Poe(e){return arguments.length?(this._x=e,this):this._x}function Loe(e){return e[1]}function zoe(e){return arguments.length?(this._y=e,this):this._y}function VC(e,t,n){var r=new GC(t??Doe,n??Loe,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function GC(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function ZN(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Vn=VC.prototype=GC.prototype;Vn.copy=function(){var e=new GC(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=ZN(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=ZN(r));return e};Vn.add=Soe;Vn.addAll=_oe;Vn.cover=koe;Vn.data=$oe;Vn.extent=Coe;Vn.find=Aoe;Vn.remove=Foe;Vn.removeAll=Moe;Vn.root=Toe;Vn.size=Noe;Vn.visit=Ooe;Vn.visitAfter=Roe;Vn.x=Poe;Vn.y=zoe;function Ln(e){return function(){return e}}function oa(e){return(e()-.5)*1e-6}function Ioe(e){return e.x+e.vx}function Boe(e){return e.y+e.vy}function joe(e){var t,n,r,i=1,o=1;typeof e!="function"&&(e=Ln(e==null?1:+e));function s(){for(var l,c=t.length,f,d,h,p,g,y,m=0;m<o;++m)for(f=VC(t,Ioe,Boe).visitAfter(a),l=0;l<c;++l)d=t[l],g=n[d.index],y=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(v);function v(x,w,b,S,E){var _=x.data,k=x.r,$=g+k;if(_){if(_.index>d.index){var C=h-_.x-_.vx,R=p-_.y-_.vy,A=C*C+R*R;A<$*$&&(C===0&&(C=oa(r),A+=C*C),R===0&&(R=oa(r),A+=R*R),A=($-(A=Math.sqrt(A)))/A*i,d.vx+=(C*=A)*($=(k*=k)/(y+k)),d.vy+=(R*=A)*$,_.vx-=C*($=1-$),_.vy-=R*$)}return}return w>h+$||S<h-$||b>p+$||E<p-$}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return s.initialize=function(l,c){t=l,r=c,u()},s.iterations=function(l){return arguments.length?(o=+l,s):o},s.strength=function(l){return arguments.length?(i=+l,s):i},s.radius=function(l){return arguments.length?(e=typeof l=="function"?l:Ln(+l),u(),s):e},s}function Uoe(e){return e.index}function JN(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Woe(e){var t=Uoe,n=f,r,i=Ln(30),o,s,a,u,l,c=1;e==null&&(e=[]);function f(y){return 1/Math.min(a[y.source.index],a[y.target.index])}function d(y){for(var m=0,v=e.length;m<c;++m)for(var x=0,w,b,S,E,_,k,$;x<v;++x)w=e[x],b=w.source,S=w.target,E=S.x+S.vx-b.x-b.vx||oa(l),_=S.y+S.vy-b.y-b.vy||oa(l),k=Math.sqrt(E*E+_*_),k=(k-o[x])/k*y*r[x],E*=k,_*=k,S.vx-=E*($=u[x]),S.vy-=_*$,b.vx+=E*($=1-$),b.vy+=_*$}function h(){if(s){var y,m=s.length,v=e.length,x=new Map(s.map((b,S)=>[t(b,S,s),b])),w;for(y=0,a=new Array(m);y<v;++y)w=e[y],w.index=y,typeof w.source!="object"&&(w.source=JN(x,w.source)),typeof w.target!="object"&&(w.target=JN(x,w.target)),a[w.source.index]=(a[w.source.index]||0)+1,a[w.target.index]=(a[w.target.index]||0)+1;for(y=0,u=new Array(v);y<v;++y)w=e[y],u[y]=a[w.source.index]/(a[w.source.index]+a[w.target.index]);r=new Array(v),p(),o=new Array(v),g()}}function p(){if(s)for(var y=0,m=e.length;y<m;++y)r[y]=+n(e[y],y,e)}function g(){if(s)for(var y=0,m=e.length;y<m;++y)o[y]=+i(e[y],y,e)}return d.initialize=function(y,m){s=y,l=m,h()},d.links=function(y){return arguments.length?(e=y,h(),d):e},d.id=function(y){return arguments.length?(t=y,d):t},d.iterations=function(y){return arguments.length?(c=+y,d):c},d.strength=function(y){return arguments.length?(n=typeof y=="function"?y:Ln(+y),p(),d):n},d.distance=function(y){return arguments.length?(i=typeof y=="function"?y:Ln(+y),g(),d):i},d}var qoe={value:()=>{}};function G9(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Jm(n)}function Jm(e){this._=e}function Hoe(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Jm.prototype=G9.prototype={constructor:Jm,on:function(e,t){var n=this._,r=Hoe(e+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(e=r[o]).type)&&(i=Voe(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=r[o]).type)n[i]=eO(n[i],e.name,t);else if(t==null)for(i in n)n[i]=eO(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Jm(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function Voe(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function eO(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=qoe,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var of=0,Kd=0,xd=0,Y9=1e3,j1,Zd,U1=0,il=0,Tv=0,up=typeof performance=="object"&&performance.now?performance:Date,X9=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function YC(){return il||(X9(Goe),il=up.now()+Tv)}function Goe(){il=0}function W1(){this._call=this._time=this._next=null}W1.prototype=Q9.prototype={constructor:W1,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?YC():+n)+(t==null?0:+t),!this._next&&Zd!==this&&(Zd?Zd._next=this:j1=this,Zd=this),this._call=e,this._time=n,KE()},stop:function(){this._call&&(this._call=null,this._time=1/0,KE())}};function Q9(e,t,n){var r=new W1;return r.restart(e,t,n),r}function Yoe(){YC(),++of;for(var e=j1,t;e;)(t=il-e._time)>=0&&e._call.call(void 0,t),e=e._next;--of}function tO(){il=(U1=up.now())+Tv,of=Kd=0;try{Yoe()}finally{of=0,Qoe(),il=0}}function Xoe(){var e=up.now(),t=e-U1;t>Y9&&(Tv-=t,U1=e)}function Qoe(){for(var e,t=j1,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:j1=n);Zd=e,KE(r)}function KE(e){if(!of){Kd&&(Kd=clearTimeout(Kd));var t=e-il;t>24?(e<1/0&&(Kd=setTimeout(tO,e-up.now()-Tv)),xd&&(xd=clearInterval(xd))):(xd||(U1=up.now(),xd=setInterval(Xoe,Y9)),of=1,X9(tO))}}function Koe(e,t,n){var r=new W1,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(o,s,a){s=+s,a=a==null?YC():+a,r._restart(function u(l){l+=i,r._restart(u,i+=s,a),o(l)},s,a)},r.restart(e,t,n),r)}const Zoe=1664525,Joe=1013904223,nO=4294967296;function ese(){let e=1;return()=>(e=(Zoe*e+Joe)%nO)/nO}function tse(e){return e.x}function nse(e){return e.y}var rse=10,ise=Math.PI*(3-Math.sqrt(5));function ose(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,u=Q9(f),l=G9("tick","end"),c=ese();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(g){var y,m=e.length,v;g===void 0&&(g=1);for(var x=0;x<g;++x)for(n+=(o-n)*i,a.forEach(function(w){w(n)}),y=0;y<m;++y)v=e[y],v.fx==null?v.x+=v.vx*=s:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=s:(v.y=v.fy,v.vy=0);return t}function h(){for(var g=0,y=e.length,m;g<y;++g){if(m=e[g],m.index=g,m.fx!=null&&(m.x=m.fx),m.fy!=null&&(m.y=m.fy),isNaN(m.x)||isNaN(m.y)){var v=rse*Math.sqrt(.5+g),x=g*ise;m.x=v*Math.cos(x),m.y=v*Math.sin(x)}(isNaN(m.vx)||isNaN(m.vy))&&(m.vx=m.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),a.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(o=+g,t):o},velocityDecay:function(g){return arguments.length?(s=1-g,t):1-s},randomSource:function(g){return arguments.length?(c=g,a.forEach(p),t):c},force:function(g,y){return arguments.length>1?(y==null?a.delete(g):a.set(g,p(y)),t):a.get(g)},find:function(g,y,m){var v=0,x=e.length,w,b,S,E,_;for(m==null?m=1/0:m*=m,v=0;v<x;++v)E=e[v],w=g-E.x,b=y-E.y,S=w*w+b*b,S<m&&(_=E,m=S);return _},on:function(g,y){return arguments.length>1?(l.on(g,y),t):l.on(g)}}}function sse(){var e,t,n,r,i=Ln(-30),o,s=1,a=1/0,u=.81;function l(h){var p,g=e.length,y=VC(e,tse,nse).visitAfter(f);for(r=h,p=0;p<g;++p)t=e[p],y.visit(d)}function c(){if(e){var h,p=e.length,g;for(o=new Array(p),h=0;h<p;++h)g=e[h],o[g.index]=+i(g,h,e)}}function f(h){var p=0,g,y,m=0,v,x,w;if(h.length){for(v=x=w=0;w<4;++w)(g=h[w])&&(y=Math.abs(g.value))&&(p+=g.value,m+=y,v+=y*g.x,x+=y*g.y);h.x=v/m,h.y=x/m}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=o[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,y){if(!h.value)return!0;var m=h.x-t.x,v=h.y-t.y,x=y-p,w=m*m+v*v;if(x*x/u<w)return w<a&&(m===0&&(m=oa(n),w+=m*m),v===0&&(v=oa(n),w+=v*v),w<s&&(w=Math.sqrt(s*w)),t.vx+=m*h.value*r/w,t.vy+=v*h.value*r/w),!0;if(h.length||w>=a)return;(h.data!==t||h.next)&&(m===0&&(m=oa(n),w+=m*m),v===0&&(v=oa(n),w+=v*v),w<s&&(w=Math.sqrt(s*w)));do h.data!==t&&(x=o[h.data.index]*r/w,t.vx+=m*x,t.vy+=v*x);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(i=typeof h=="function"?h:Ln(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.distanceMax=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function ase(e){var t=Ln(.1),n,r,i;typeof e!="function"&&(e=Ln(e==null?0:+e));function o(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Ln(+a),s(),o):t},o.x=function(a){return arguments.length?(e=typeof a=="function"?a:Ln(+a),s(),o):e},o}function use(e){var t=Ln(.1),n,r,i;typeof e!="function"&&(e=Ln(e==null?0:+e));function o(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Ln(+a),s(),o):t},o.y=function(a){return arguments.length?(e=typeof a=="function"?a:Ln(+a),s(),o):e},o}const rO={center:Eoe,collide:joe,nbody:sse,link:Woe,x:ase,y:use},Jd="forces",ZE=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],lse=["static","iterations"],K9=["x","y","vx","vy"];function XC(e){D.call(this,null,e)}XC.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:K9}]};G(XC,D,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(ZE),o=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&Z9(n,e,0,t)):(this.value=n=fse(t.source,e),n.on("tick",cse(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(lse)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,u=0,l=a.length,c;u<l;++u)if(c=a[u],!(c.name!==Jd||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,o=r.length,s;i<o;++i)if(r[i].name==="links"&&(s=r[i].op.source)){n.pulse(s,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(K9)}});function cse(e,t){return()=>e.touch(t).run()}function fse(e,t){const n=ose(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),Z9(n,t,!0).on("end",()=>o=!0)}function Z9(e,t,n,r){var i=K(t.forces),o,s,a,u;for(o=0,s=ZE.length;o<s;++o)a=ZE[o],a!==Jd&&t.modified(a)&&e[a](t[a]);for(o=0,s=i.length;o<s;++o)u=Jd+o,a=n||t.modified(Jd,o)?hse(i[o]):r&&dse(i[o],r)?e.force(u):null,a&&e.force(u,a);for(s=e.numForces||0;o<s;++o)e.force(Jd+o,null);return e.numForces=i.length,e}function dse(e,t){var n,r;for(n in e)if(ge(r=e[n])&&t.modified(bn(r)))return 1;return 0}function hse(e){var t,n;ae(rO,e.force)||z("Unrecognized force: "+e.force),t=rO[e.force]();for(n in e)ge(t[n])&&pse(t[n],e[n],e);return t}function pse(e,t,n){e(ge(t)?r=>t(r,n):t)}const gse=Object.freeze(Object.defineProperty({__proto__:null,force:XC},Symbol.toStringTag,{value:"Module"}));function mse(e,t){return e.parent===t.parent?1:2}function yse(e){return e.reduce(vse,0)/e.length}function vse(e,t){return e+t.x}function xse(e){return 1+e.reduce(wse,0)}function wse(e,t){return Math.max(e,t.y)}function bse(e){for(var t;t=e.children;)e=t[0];return e}function Ese(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Sse(){var e=mse,t=1,n=1,r=!1;function i(o){var s,a=0;o.eachAfter(function(d){var h=d.children;h?(d.x=yse(h),d.y=xse(h)):(d.x=s?a+=e(d,s):0,d.y=0,s=d)});var u=bse(o),l=Ese(o),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return o.eachAfter(r?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return i.separation=function(o){return arguments.length?(e=o,i):e},i.size=function(o){return arguments.length?(r=!1,t=+o[0],n=+o[1],i):r?null:[t,n]},i.nodeSize=function(o){return arguments.length?(r=!0,t=+o[0],n=+o[1],i):r?[t,n]:null},i}function _se(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function kse(){return this.eachAfter(_se)}function $se(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function Cse(e,t){for(var n=this,r=[n],i,o,s=-1;n=r.pop();)if(e.call(t,n,++s,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Ase(e,t){for(var n=this,r=[n],i=[],o,s,a,u=-1;n=r.pop();)if(i.push(n),o=n.children)for(s=0,a=o.length;s<a;++s)r.push(o[s]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function Fse(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function Mse(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Tse(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Nse(e){for(var t=this,n=Ose(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Ose(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Rse(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Dse(){return Array.from(this)}function Pse(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Lse(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*zse(){var e=this,t,n=[e],r,i,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function QC(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=jse)):t===void 0&&(t=Bse);for(var n=new sf(e),r,i=[n],o,s,a,u;r=i.pop();)if((s=t(r.data))&&(u=(s=Array.from(s)).length))for(r.children=s,a=u-1;a>=0;--a)i.push(o=s[a]=new sf(s[a])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(J9)}function Ise(){return QC(this).eachBefore(Use)}function Bse(e){return e.children}function jse(e){return Array.isArray(e)?e[1]:null}function Use(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function J9(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function sf(e){this.data=e,this.depth=this.height=0,this.parent=null}sf.prototype=QC.prototype={constructor:sf,count:kse,each:$se,eachAfter:Ase,eachBefore:Cse,find:Fse,sum:Mse,sort:Tse,path:Nse,ancestors:Rse,descendants:Dse,leaves:Pse,links:Lse,copy:Ise,[Symbol.iterator]:zse};function e0(e){return e==null?null:e7(e)}function e7(e){if(typeof e!="function")throw new Error;return e}function $u(){return 0}function Kl(e){return function(){return e}}const Wse=1664525,qse=1013904223,iO=4294967296;function Hse(){let e=1;return()=>(e=(Wse*e+qse)%iO)/iO}function Vse(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Gse(e,t){let n=e.length,r,i;for(;n;)i=t()*n--|0,r=e[n],e[n]=e[i],e[i]=r;return e}function Yse(e,t){for(var n=0,r=(e=Gse(Array.from(e),t)).length,i=[],o,s;n<r;)o=e[n],s&&t7(s,o)?++n:(s=Qse(i=Xse(i,o)),n=0);return s}function Xse(e,t){var n,r;if(X2(t,e))return[t];for(n=0;n<e.length;++n)if(sm(t,e[n])&&X2(eh(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(sm(eh(e[n],e[r]),t)&&sm(eh(e[n],t),e[r])&&sm(eh(e[r],t),e[n])&&X2(n7(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function sm(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function t7(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function X2(e,t){for(var n=0;n<t.length;++n)if(!t7(e,t[n]))return!1;return!0}function Qse(e){switch(e.length){case 1:return Kse(e[0]);case 2:return eh(e[0],e[1]);case 3:return n7(e[0],e[1],e[2])}}function Kse(e){return{x:e.x,y:e.y,r:e.r}}function eh(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,s=t.y,a=t.r,u=o-n,l=s-r,c=a-i,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(r+s+l/f*c)/2,r:(f+i+a)/2}}function n7(e,t,n){var r=e.x,i=e.y,o=e.r,s=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-s,h=r-l,p=i-a,g=i-c,y=u-o,m=f-o,v=r*r+i*i-o*o,x=v-s*s-a*a+u*u,w=v-l*l-c*c+f*f,b=h*p-d*g,S=(p*w-g*x)/(b*2)-r,E=(g*y-p*m)/b,_=(h*x-d*w)/(b*2)-i,k=(d*m-h*y)/b,$=E*E+k*k-1,C=2*(o+S*E+_*k),R=S*S+_*_-o*o,A=-(Math.abs($)>1e-6?(C+Math.sqrt(C*C-4*$*R))/(2*$):R/C);return{x:r+S+E*A,y:i+_+k*A,r:A}}function oO(e,t,n){var r=e.x-t.x,i,o,s=e.y-t.y,a,u,l=r*r+s*s;l?(o=t.r+n.r,o*=o,u=e.r+n.r,u*=u,o>u?(i=(l+u-o)/(2*l),a=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-a*s,n.y=e.y-i*s+a*r):(i=(l+o-u)/(2*l),a=Math.sqrt(Math.max(0,o/l-i*i)),n.x=t.x+i*r-a*s,n.y=t.y+i*s+a*r)):(n.x=t.x+n.r,n.y=t.y)}function sO(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function aO(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function am(e){this._=e,this.next=null,this.previous=null}function Zse(e,t){if(!(o=(e=Vse(e)).length))return 0;var n,r,i,o,s,a,u,l,c,f,d;if(n=e[0],n.x=0,n.y=0,!(o>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;oO(r,n,i=e[2]),n=new am(n),r=new am(r),i=new am(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(u=3;u<o;++u){oO(n._,r._,i=e[u]),i=new am(i),l=r.next,c=n.previous,f=r._.r,d=n._.r;do if(f<=d){if(sO(l._,i._)){r=l,n.next=r,r.previous=n,--u;continue e}f+=l._.r,l=l.next}else{if(sO(c._,i._)){n=c,n.next=r,r.previous=n,--u;continue e}d+=c._.r,c=c.previous}while(l!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,s=aO(n);(i=i.next)!==r;)(a=aO(i))<s&&(n=i,s=a);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=Yse(n,t),u=0;u<o;++u)n=e[u],n.x-=i.x,n.y-=i.y;return i.r}function Jse(e){return Math.sqrt(e.value)}function eae(){var e=null,t=1,n=1,r=$u;function i(o){const s=Hse();return o.x=t/2,o.y=n/2,e?o.eachBefore(uO(e)).eachAfter(Q2(r,.5,s)).eachBefore(lO(1)):o.eachBefore(uO(Jse)).eachAfter(Q2($u,1,s)).eachAfter(Q2(r,o.r/Math.min(t,n),s)).eachBefore(lO(Math.min(t,n)/(2*o.r))),o}return i.radius=function(o){return arguments.length?(e=e0(o),i):e},i.size=function(o){return arguments.length?(t=+o[0],n=+o[1],i):[t,n]},i.padding=function(o){return arguments.length?(r=typeof o=="function"?o:Kl(+o),i):r},i}function uO(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function Q2(e,t,n){return function(r){if(i=r.children){var i,o,s=i.length,a=e(r)*t||0,u;if(a)for(o=0;o<s;++o)i[o].r+=a;if(u=Zse(i,n),a)for(o=0;o<s;++o)i[o].r-=a;r.r=u+a}}}function lO(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function r7(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Jp(e,t,n,r,i){for(var o=e.children,s,a=-1,u=o.length,l=e.value&&(r-t)/e.value;++a<u;)s=o[a],s.y0=n,s.y1=i,s.x0=t,s.x1=t+=s.value*l}function tae(){var e=1,t=1,n=0,r=!1;function i(s){var a=s.height+1;return s.x0=s.y0=n,s.x1=e,s.y1=t/a,s.eachBefore(o(t,a)),r&&s.eachBefore(r7),s}function o(s,a){return function(u){u.children&&Jp(u,u.x0,s*(u.depth+1)/a,u.x1,s*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(s){return arguments.length?(r=!!s,i):r},i.size=function(s){return arguments.length?(e=+s[0],t=+s[1],i):[e,t]},i.padding=function(s){return arguments.length?(n=+s,i):n},i}var nae={depth:-1},cO={},K2={};function rae(e){return e.id}function iae(e){return e.parentId}function fO(){var e=rae,t=iae,n;function r(i){var o=Array.from(i),s=e,a=t,u,l,c,f,d,h,p,g,y=new Map;if(n!=null){const m=o.map((w,b)=>oae(n(w,b,i))),v=m.map(dO),x=new Set(m).add("");for(const w of v)x.has(w)||(x.add(w),m.push(w),v.push(dO(w)),o.push(K2));s=(w,b)=>m[b],a=(w,b)=>v[b]}for(c=0,u=o.length;c<u;++c)l=o[c],h=o[c]=new sf(l),(p=s(l,c,i))!=null&&(p+="")&&(g=h.id=p,y.set(g,y.has(g)?cO:h)),(p=a(l,c,i))!=null&&(p+="")&&(h.parent=p);for(c=0;c<u;++c)if(h=o[c],p=h.parent){if(d=y.get(p),!d)throw new Error("missing: "+p);if(d===cO)throw new Error("ambiguous: "+p);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(n!=null){for(;f.data===K2&&f.children.length===1;)f=f.children[0],--u;for(let m=o.length-1;m>=0&&(h=o[m],h.data===K2);--m)h.data=null}if(f.parent=nae,f.eachBefore(function(m){m.depth=m.parent.depth+1,--u}).eachBefore(J9),f.parent=null,u>0)throw new Error("cycle");return f}return r.id=function(i){return arguments.length?(e=e0(i),r):e},r.parentId=function(i){return arguments.length?(t=e0(i),r):t},r.path=function(i){return arguments.length?(n=e0(i),r):n},r}function oae(e){e=`${e}`;let t=e.length;return JE(e,t-1)&&!JE(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function dO(e){let t=e.length;if(t<2)return"";for(;--t>1&&!JE(e,t););return e.slice(0,t)}function JE(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function sae(e,t){return e.parent===t.parent?1:2}function Z2(e){var t=e.children;return t?t[0]:e.t}function J2(e){var t=e.children;return t?t[t.length-1]:e.t}function aae(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function uae(e){for(var t=0,n=0,r=e.children,i=r.length,o;--i>=0;)o=r[i],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function lae(e,t,n){return e.a.parent===t.parent?e.a:n}function t0(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}t0.prototype=Object.create(sf.prototype);function cae(e){for(var t=new t0(e,0),n,r=[t],i,o,s,a;n=r.pop();)if(o=n._.children)for(n.children=new Array(a=o.length),s=a-1;s>=0;--s)r.push(i=n.children[s]=new t0(o[s],s)),i.parent=n;return(t.parent=new t0(null,0)).children=[t],t}function fae(){var e=sae,t=1,n=1,r=null;function i(l){var c=cae(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(s),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var p=f===d?1:e(f,d)/2,g=p-f.x,y=t/(d.x+p+g),m=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+g)*y,v.y=v.depth*m})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){uae(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,h=l,p=c,g=d.parent.children[0],y=d.m,m=h.m,v=p.m,x=g.m,w;p=J2(p),d=Z2(d),p&&d;)g=Z2(g),h=J2(h),h.a=l,w=p.z+v-d.z-y+e(p._,d._),w>0&&(aae(lae(p,l,f),l,w),y+=w,m+=w),v+=p.m,y+=d.m,x+=g.m,m+=h.m;p&&!J2(h)&&(h.t=p,h.m+=v-m),d&&!Z2(g)&&(g.t=d,g.m+=y-x,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function Nv(e,t,n,r,i){for(var o=e.children,s,a=-1,u=o.length,l=e.value&&(i-n)/e.value;++a<u;)s=o[a],s.x0=t,s.x1=r,s.y0=n,s.y1=n+=s.value*l}var i7=(1+Math.sqrt(5))/2;function o7(e,t,n,r,i,o){for(var s=[],a=t.children,u,l,c=0,f=0,d=a.length,h,p,g=t.value,y,m,v,x,w,b,S;c<d;){h=i-n,p=o-r;do y=a[f++].value;while(!y&&f<d);for(m=v=y,b=Math.max(p/h,h/p)/(g*e),S=y*y*b,w=Math.max(v/S,S/m);f<d;++f){if(y+=l=a[f].value,l<m&&(m=l),l>v&&(v=l),S=y*y*b,x=Math.max(v/S,S/m),x>w){y-=l;break}w=x}s.push(u={value:y,dice:h<p,children:a.slice(c,f)}),u.dice?Jp(u,n,r,i,g?r+=p*y/g:o):Nv(u,n,r,g?n+=h*y/g:i,o),g-=y,c=f}return s}const s7=function e(t){function n(r,i,o,s,a){o7(t,r,i,o,s,a)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(i7);function dae(){var e=s7,t=!1,n=1,r=1,i=[0],o=$u,s=$u,a=$u,u=$u,l=$u;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(r7),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,y=d.x1-h,m=d.y1-h;y<p&&(p=y=(p+y)/2),m<g&&(g=m=(g+m)/2),d.x0=p,d.y0=g,d.x1=y,d.y1=m,d.children&&(h=i[d.depth+1]=o(d)/2,p+=l(d)-h,g+=s(d)-h,y-=a(d)-h,m-=u(d)-h,y<p&&(p=y=(p+y)/2),m<g&&(g=m=(g+m)/2),e(d,p,g,y,m))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=e7(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:Kl(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(s=typeof d=="function"?d:Kl(+d),c):s},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:Kl(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:Kl(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:Kl(+d),c):l},c}function hae(e,t,n,r,i){var o=e.children,s,a=o.length,u,l=new Array(a+1);for(l[0]=u=s=0;s<a;++s)l[s+1]=u+=o[s].value;c(0,a,e.value,t,n,r,i);function c(f,d,h,p,g,y,m){if(f>=d-1){var v=o[f];v.x0=p,v.y0=g,v.x1=y,v.y1=m;return}for(var x=l[f],w=h/2+x,b=f+1,S=d-1;b<S;){var E=b+S>>>1;l[E]<w?b=E+1:S=E}w-l[b-1]<l[b]-w&&f+1<b&&--b;var _=l[b]-x,k=h-_;if(y-p>m-g){var $=h?(p*k+y*_)/h:y;c(f,b,_,p,g,$,m),c(b,d,k,$,g,y,m)}else{var C=h?(g*k+m*_)/h:m;c(f,b,_,p,g,y,C),c(b,d,k,p,C,y,m)}}}function pae(e,t,n,r,i){(e.depth&1?Nv:Jp)(e,t,n,r,i)}const gae=function e(t){function n(r,i,o,s,a){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,g=r.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?Jp(l,i,o,s,g?o+=(a-o)*l.value/g:a):Nv(l,i,o,g?i+=(s-i)*l.value/g:s,a),g-=l.value}else r._squarify=u=o7(t,r,i,o,s,a),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(i7);function eS(e,t,n){const r={};return e.each(i=>{const o=i.data;n(o)&&(r[t(o)]=i)}),e.lookup=r,e}function KC(e){D.call(this,null,e)}KC.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const mae=e=>e.values;G(KC,D,{transform(e,t){t.source||z("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each(s=>{s.children&&Vy(s.data)&&i.rem.push(s.data)}),this.value=o=QC({values:K(e.keys).reduce((s,a)=>(s.key(a),s),yae()).entries(i.source)},mae),n&&o.each(s=>{s.children&&(s=De(s.data),i.add.push(s),i.source.push(s))}),eS(o,oe,oe)),i.source.root=o,i}});function yae(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,o){if(o>=e.length)return i;const s=i.length,a=e[o++],u={},l={};let c=-1,f,d,h;for(;++c<s;)f=a(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],o);return l}function r(i,o){if(++o>e.length)return i;const s=[];for(const a in i)s.push({key:a,values:r(i[a],o)});return s}return t}function _s(e){D.call(this,null,e)}const vae=(e,t)=>e.parent===t.parent?1:2;G(_s,D,{transform(e,t){(!t.source||!t.source.root)&&z(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(El(e.sort,s=>s.data)),xae(n,this.params,e),n.separation&&n.separation(e.separation!==!1?vae:Cf);try{this.value=n(i)}catch(s){z(s)}return i.each(s=>wae(s,r,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function xae(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}function wae(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}const tS=["x","y","r","depth","children"];function ZC(e){_s.call(this,e)}ZC.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:tS.length,default:tS}]};G(ZC,_s,{layout:eae,params:["radius","size","padding"],fields:tS});const nS=["x0","y0","x1","y1","depth","children"];function JC(e){_s.call(this,e)}JC.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:nS.length,default:nS}]};G(JC,_s,{layout:tae,params:["size","round","padding"],fields:nS});function eA(e){D.call(this,null,e)}eA.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};G(eA,D,{transform(e,t){t.source||z("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?eS(fO().id(e.key).parentId(e.parentKey)(i.source),e.key,ei):eS(fO()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const hO={tidy:fae,cluster:Sse},rS=["x","y","depth","children"];function tA(e){_s.call(this,e)}tA.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:rS.length,default:rS}]};G(tA,_s,{layout(e){const t=e||"tidy";if(ae(hO,t))return hO[t]();z("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:rS});function nA(e){D.call(this,[],e)}nA.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};G(nA,D,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||z("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,s=>o[oe(s)]=1),r.each(s=>{const a=s.data,u=s.parent&&s.parent.data;u&&o[oe(a)]&&o[oe(u)]&&i.add.push(De({source:u,target:a}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,s=>o[oe(s)]=1),n.forEach(s=>{(o[oe(s.source)]||o[oe(s.target)])&&i.mod.push(s)})),i}});const pO={binary:hae,dice:Jp,slice:Nv,slicedice:pae,squarify:s7,resquarify:gae},iS=["x0","y0","x1","y1","depth","children"];function rA(e){_s.call(this,e)}rA.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:iS.length,default:iS}]};G(rA,_s,{layout(){const e=dae();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ae(pO,t)?e.tile(pO[t]):z("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:iS});const bae=Object.freeze(Object.defineProperty({__proto__:null,nest:KC,pack:ZC,partition:JC,stratify:eA,tree:tA,treelinks:nA,treemap:rA},Symbol.toStringTag,{value:"Module"})),ew=4278190080;function Eae(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function Sae(e,t,n,r,i){const o=e.width,s=e.height,a=r||i,u=wa(o,s).getContext("2d"),l=wa(o,s).getContext("2d"),c=a&&wa(o,s).getContext("2d");n.forEach(_=>n0(u,_,!1)),n0(l,t,!1),a&&n0(c,t,!0);const f=tw(u,o,s),d=tw(l,o,s),h=a&&tw(c,o,s),p=e.bitmap(),g=a&&e.bitmap();let y,m,v,x,w,b,S,E;for(m=0;m<s;++m)for(y=0;y<o;++y)w=m*o+y,b=f[w]&ew,E=d[w]&ew,S=a&&h[w]&ew,(b||S||E)&&(v=e(y),x=e(m),!i&&(b||E)&&p.set(v,x),a&&(b||S)&&g.set(v,x));return[p,g]}function tw(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function n0(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(o=>n0(e,o.items,n))}):Tr[r].draw(e,{items:n?t.map(_ae):t})}function _ae(e){const t=Gy(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const Uo=5,An=31,lp=32,qs=new Uint32Array(lp+1),bi=new Uint32Array(lp+1);bi[0]=0;qs[0]=~bi[0];for(let e=1;e<=lp;++e)bi[e]=bi[e-1]<<1|1,qs[e]=~bi[e];function kae(e,t){const n=new Uint32Array(~~((e*t+lp)/lp));function r(o,s){n[o]|=s}function i(o,s){n[o]&=s}return{array:n,get:(o,s)=>{const a=s*e+o;return n[a>>>Uo]&1<<(a&An)},set:(o,s)=>{const a=s*e+o;r(a>>>Uo,1<<(a&An))},clear:(o,s)=>{const a=s*e+o;i(a>>>Uo,~(1<<(a&An)))},getRange:(o,s,a,u)=>{let l=u,c,f,d,h;for(;l>=s;--l)if(c=l*e+o,f=l*e+a,d=c>>>Uo,h=f>>>Uo,d===h){if(n[d]&qs[c&An]&bi[(f&An)+1])return!0}else{if(n[d]&qs[c&An]||n[h]&bi[(f&An)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(o,s,a,u)=>{let l,c,f,d,h;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>Uo,d=c>>>Uo,f===d)r(f,qs[l&An]&bi[(c&An)+1]);else for(r(f,qs[l&An]),r(d,bi[(c&An)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(o,s,a,u)=>{let l,c,f,d,h;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>Uo,d=c>>>Uo,f===d)i(f,bi[l&An]|qs[(c&An)+1]);else for(i(f,bi[l&An]),i(d,qs[(c&An)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(o,s,a,u)=>o<0||s<0||u>=t||a>=e}}function $ae(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),s=a=>~~((a+n)/r);return s.invert=a=>a*r-n,s.bitmap=()=>kae(i,o),s.ratio=r,s.padding=n,s.width=e,s.height=t,s}function Cae(e,t,n,r){const i=e.width,o=e.height;return function(s){const a=s.datum.datum.items[r].items,u=a.length,l=s.datum.fontSize,c=kr.width(s.datum,s.datum.text);let f=0,d,h,p,g,y,m,v;for(let x=0;x<u;++x)d=a[x].x,p=a[x].y,h=a[x].x2===void 0?d:a[x].x2,g=a[x].y2===void 0?p:a[x].y2,y=(d+h)/2,m=(p+g)/2,v=Math.abs(h-d+g-p),v>=f&&(f=v,s.x=y,s.y=m);return y=c/2,m=l/2,d=s.x-y,h=s.x+y,p=s.y-m,g=s.y+m,s.align="center",d<0&&h<=i?s.align="left":0<=d&&i<h&&(s.align="right"),s.baseline="middle",p<0&&g<=o?s.baseline="top":0<=p&&o<g&&(s.baseline="bottom"),!0}}function q1(e,t,n,r,i,o){let s=n/2;return e-s<0||e+s>i||t-(s=r/2)<0||t+s>o}function sa(e,t,n,r,i,o,s,a){const u=i*o/(r*2),l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return s.outOfBounds(l,f,c,d)||s.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function Aae(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1];function u(l,c,f,d,h){const p=e.invert(l),g=e.invert(c);let y=f,m=o,v;if(!q1(p,g,d,h,i,o)&&!sa(e,p,g,h,d,y,s,a)&&!sa(e,p,g,h,d,h,s,null)){for(;m-y>=1;)v=(y+m)/2,sa(e,p,g,h,d,v,s,a)?m=v:y=v;if(y>f)return[p,g,y,!0]}}return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=kr.width(l.datum,l.datum.text);let p=n?d:0,g=!1,y=!1,m=0,v,x,w,b,S,E,_,k,$,C,R,A,M,F,N,P,T;for(let O=0;O<f;++O){for(v=c[O].x,w=c[O].y,x=c[O].x2===void 0?v:c[O].x2,b=c[O].y2===void 0?w:c[O].y2,v>x&&(T=v,v=x,x=T),w>b&&(T=w,w=b,b=T),$=e(v),R=e(x),C=~~(($+R)/2),A=e(w),F=e(b),M=~~((A+F)/2),_=C;_>=$;--_)for(k=M;k>=A;--k)P=u(_,k,p,h,d),P&&([l.x,l.y,p,g]=P);for(_=C;_<=R;++_)for(k=M;k<=F;++k)P=u(_,k,p,h,d),P&&([l.x,l.y,p,g]=P);!g&&!n&&(N=Math.abs(x-v+b-w),S=(v+x)/2,E=(w+b)/2,N>=m&&!q1(S,E,h,d,i,o)&&!sa(e,S,E,d,h,d,s,null)&&(m=N,l.x=S,l.y=E,y=!0))}return g||y?(S=h/2,E=d/2,s.setRange(e(l.x-S),e(l.y-E),e(l.x+S),e(l.y+E)),l.align="center",l.baseline="middle",!0):!1}}const Fae=[-1,-1,1,1],Mae=[-1,1,-1,1];function Tae(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=kr.width(l.datum,l.datum.text),p=[];let g=n?d:0,y=!1,m=!1,v=0,x,w,b,S,E,_,k,$,C,R,A,M;for(let F=0;F<f;++F){for(x=c[F].x,b=c[F].y,w=c[F].x2===void 0?x:c[F].x2,S=c[F].y2===void 0?b:c[F].y2,p.push([e((x+w)/2),e((b+S)/2)]);p.length;)if([k,$]=p.pop(),!(s.get(k,$)||a.get(k,$)||u.get(k,$))){u.set(k,$);for(let N=0;N<4;++N)E=k+Fae[N],_=$+Mae[N],u.outOfBounds(E,_,E,_)||p.push([E,_]);if(E=e.invert(k),_=e.invert($),C=g,R=o,!q1(E,_,h,d,i,o)&&!sa(e,E,_,d,h,C,s,a)&&!sa(e,E,_,d,h,d,s,null)){for(;R-C>=1;)A=(C+R)/2,sa(e,E,_,d,h,A,s,a)?R=A:C=A;C>g&&(l.x=E,l.y=_,g=C,y=!0)}}!y&&!n&&(M=Math.abs(w-x+S-b),E=(x+w)/2,_=(b+S)/2,M>=v&&!q1(E,_,h,d,i,o)&&!sa(e,E,_,d,h,d,s,null)&&(v=M,l.x=E,l.y=_,m=!0))}return y||m?(E=h/2,_=d/2,s.setRange(e(l.x-E),e(l.y-_),e(l.x+E),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}const Nae=["right","center","left"],Oae=["bottom","middle","top"];function Rae(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1],u=r.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>o)return!1;let d=l.textWidth??0,h,p,g,y,m,v,x,w,b,S,E,_,k,$,C;for(let R=0;R<u;++R){if(h=(n[R]&3)-1,p=(n[R]>>>2&3)-1,g=h===0&&p===0||r[R]<0,y=h&&p?Math.SQRT1_2:1,m=r[R]<0?-1:1,v=c[1+h]+r[R]*h*y,E=c[4+p]+m*f*p/2+r[R]*p*y,w=E-f/2,b=E+f/2,_=e(v),$=e(w),C=e(b),!d)if(gO(_,_,$,C,s,a,v,v,w,b,c,g))d=kr.width(l.datum,l.datum.text);else continue;if(S=v+m*d*h/2,v=S-d/2,x=S+d/2,_=e(v),k=e(x),gO(_,k,$,C,s,a,v,x,w,b,c,g))return l.x=h?h*m<0?x:v:S,l.y=p?p*m<0?b:w:E,l.align=Nae[h*m+1],l.baseline=Oae[p*m+1],s.setRange(_,$,k,C),!0}return!1}}function gO(e,t,n,r,i,o,s,a,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o||i).getRange(e,n,t,r))}const nw=0,rw=4,iw=8,ow=0,sw=1,aw=2,Dae={"top-left":nw+ow,top:nw+sw,"top-right":nw+aw,left:rw+ow,middle:rw+sw,right:rw+aw,"bottom-left":iw+ow,bottom:iw+sw,"bottom-right":iw+aw},Pae={naive:Cae,"reduced-search":Aae,floodfill:Tae};function Lae(e,t,n,r,i,o,s,a,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=zae(r,f),h=Iae(i,f),p=Bae(e[0].datum),g=p==="group"&&e[0].datum.items[u].marktype,y=g==="area",m=jae(p,g,a,u),v=l===null||l===1/0,x=y&&c==="naive";let w=-1,b=-1;const S=e.map($=>{const C=v?kr.width($,$.text):void 0;return w=Math.max(w,C),b=Math.max(b,$.fontSize),{datum:$,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:m($),textWidth:C}});l=l===null||l===1/0?Math.max(w,b)+Math.max(...r):l;const E=$ae(t[0],t[1],l);let _;if(!x){n&&S.sort((R,A)=>n(R.datum,A.datum));let $=!1;for(let R=0;R<h.length&&!$;++R)$=h[R]===5||d[R]<0;const C=(p&&s||y)&&e.map(R=>R.datum);_=o.length||C?Sae(E,C||[],o,$,y):Eae(E,s&&S)}const k=y?Pae[c](E,_,s,u):Rae(E,_,h,d);return S.forEach($=>$.opacity=+k($)),S}function zae(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Iae(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=Dae[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Bae(e){return e&&e.mark&&e.mark.marktype}function jae(e,t,n,r){const i=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>i(o.datum):t==="line"?o=>{const s=o.datum.items[r].items;return i(s.length?s[n==="start"?0:s.length-1]:{x:NaN,y:NaN})}:o=>{const s=o.datum.bounds;return[s.x1,(s.x1+s.x2)/2,s.x2,s.y1,(s.y1+s.y2)/2,s.y2]}:i}const oS=["x","y","opacity","align","baseline"],a7=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function iA(e){D.call(this,null,e)}iA.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:a7},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:oS.length,default:oS}]};G(iA,D,{transform(e,t){function n(o){const s=e[o];return ge(s)&&t.modified(s.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&z("Size parameter should be specified as a [width, height] array.");const i=e.as||oS;return Lae(t.materialize(t.SOURCE).source||[],e.size,e.sort,K(e.offset==null?1:e.offset),K(e.anchor||a7),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{const s=o.datum;s[i[0]]=o.x,s[i[1]]=o.y,s[i[2]]=o.opacity,s[i[3]]=o.align,s[i[4]]=o.baseline}),t.reflow(r).modifies(i)}});const Uae=Object.freeze(Object.defineProperty({__proto__:null,label:iA},Symbol.toStringTag,{value:"Module"}));function u7(e,t){var n=[],r=function(c){return c(a)},i,o,s,a,u,l;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function oA(e){D.call(this,null,e)}oA.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};G(oA,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=u7(r,e.groupby),o=(e.groupby||[]).map(gt),s=o.length,a=e.as||[gt(e.x),gt(e.y)],u=[];i.forEach(l=>{gL(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<s;++d)f[o[d]]=l.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],u.push(De(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const sS={constant:Bk,linear:jk,log:fL,exp:dL,pow:hL,quad:Uk,poly:pL},Wae=(e,t)=>e==="poly"?t:e==="quad"?2:1;function sA(e){D.call(this,null,e)}sA.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(sS)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};G(sA,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=u7(r,e.groupby),o=(e.groupby||[]).map(gt),s=e.method||"linear",a=e.order==null?3:e.order,u=Wae(s,a),l=e.as||[gt(e.x),gt(e.y)],c=sS[s],f=[];let d=e.extent;ae(sS,s)||z("Invalid regression method: "+s),d!=null&&s==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,a);if(e.params){f.push(De({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const y=d||vo(h,e.x),m=v=>{const x={};for(let w=0;w<o.length;++w)x[o[w]]=h.dims[w];x[l[0]]=v[0],x[l[1]]=v[1],f.push(De(x))};s==="linear"||s==="constant"?y.forEach(v=>m([v,g.predict(v)])):ev(g.predict,y,25,200).forEach(m)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const qae=Object.freeze(Object.defineProperty({__proto__:null,loess:oA,regression:sA},Symbol.toStringTag,{value:"Module"})),us=11102230246251565e-32,fn=134217729,Hae=(3+8*us)*us;function uw(e,t,n,r,i){let o,s,a,u,l=t[0],c=r[0],f=0,d=0;c>l==c>-l?(o=l,l=t[++f]):(o=c,c=r[++d]);let h=0;if(f<e&&d<n)for(c>l==c>-l?(s=l+o,a=o-(s-l),l=t[++f]):(s=c+o,a=o-(s-c),c=r[++d]),o=s,a!==0&&(i[h++]=a);f<e&&d<n;)c>l==c>-l?(s=o+l,u=s-o,a=o-(s-u)+(l-u),l=t[++f]):(s=o+c,u=s-o,a=o-(s-u)+(c-u),c=r[++d]),o=s,a!==0&&(i[h++]=a);for(;f<e;)s=o+l,u=s-o,a=o-(s-u)+(l-u),l=t[++f],o=s,a!==0&&(i[h++]=a);for(;d<n;)s=o+c,u=s-o,a=o-(s-u)+(c-u),c=r[++d],o=s,a!==0&&(i[h++]=a);return(o!==0||h===0)&&(i[h++]=o),h}function Vae(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}function eg(e){return new Float64Array(e)}const Gae=(3+16*us)*us,Yae=(2+12*us)*us,Xae=(9+64*us)*us*us,ql=eg(4),mO=eg(8),yO=eg(12),vO=eg(16),Fn=eg(4);function Qae(e,t,n,r,i,o,s){let a,u,l,c,f,d,h,p,g,y,m,v,x,w,b,S,E,_;const k=e-i,$=n-i,C=t-o,R=r-o;w=k*R,d=fn*k,h=d-(d-k),p=k-h,d=fn*R,g=d-(d-R),y=R-g,b=p*y-(w-h*g-p*g-h*y),S=C*$,d=fn*C,h=d-(d-C),p=C-h,d=fn*$,g=d-(d-$),y=$-g,E=p*y-(S-h*g-p*g-h*y),m=b-E,f=b-m,ql[0]=b-(m+f)+(f-E),v=w+m,f=v-w,x=w-(v-f)+(m-f),m=x-S,f=x-m,ql[1]=x-(m+f)+(f-S),_=v+m,f=_-v,ql[2]=v-(_-f)+(m-f),ql[3]=_;let A=Vae(4,ql),M=Yae*s;if(A>=M||-A>=M||(f=e-k,a=e-(k+f)+(f-i),f=n-$,l=n-($+f)+(f-i),f=t-C,u=t-(C+f)+(f-o),f=r-R,c=r-(R+f)+(f-o),a===0&&u===0&&l===0&&c===0)||(M=Xae*s+Hae*Math.abs(A),A+=k*c+R*a-(C*l+$*u),A>=M||-A>=M))return A;w=a*R,d=fn*a,h=d-(d-a),p=a-h,d=fn*R,g=d-(d-R),y=R-g,b=p*y-(w-h*g-p*g-h*y),S=u*$,d=fn*u,h=d-(d-u),p=u-h,d=fn*$,g=d-(d-$),y=$-g,E=p*y-(S-h*g-p*g-h*y),m=b-E,f=b-m,Fn[0]=b-(m+f)+(f-E),v=w+m,f=v-w,x=w-(v-f)+(m-f),m=x-S,f=x-m,Fn[1]=x-(m+f)+(f-S),_=v+m,f=_-v,Fn[2]=v-(_-f)+(m-f),Fn[3]=_;const F=uw(4,ql,4,Fn,mO);w=k*c,d=fn*k,h=d-(d-k),p=k-h,d=fn*c,g=d-(d-c),y=c-g,b=p*y-(w-h*g-p*g-h*y),S=C*l,d=fn*C,h=d-(d-C),p=C-h,d=fn*l,g=d-(d-l),y=l-g,E=p*y-(S-h*g-p*g-h*y),m=b-E,f=b-m,Fn[0]=b-(m+f)+(f-E),v=w+m,f=v-w,x=w-(v-f)+(m-f),m=x-S,f=x-m,Fn[1]=x-(m+f)+(f-S),_=v+m,f=_-v,Fn[2]=v-(_-f)+(m-f),Fn[3]=_;const N=uw(F,mO,4,Fn,yO);w=a*c,d=fn*a,h=d-(d-a),p=a-h,d=fn*c,g=d-(d-c),y=c-g,b=p*y-(w-h*g-p*g-h*y),S=u*l,d=fn*u,h=d-(d-u),p=u-h,d=fn*l,g=d-(d-l),y=l-g,E=p*y-(S-h*g-p*g-h*y),m=b-E,f=b-m,Fn[0]=b-(m+f)+(f-E),v=w+m,f=v-w,x=w-(v-f)+(m-f),m=x-S,f=x-m,Fn[1]=x-(m+f)+(f-S),_=v+m,f=_-v,Fn[2]=v-(_-f)+(m-f),Fn[3]=_;const P=uw(N,yO,4,Fn,vO);return vO[P-1]}function um(e,t,n,r,i,o){const s=(t-o)*(n-i),a=(e-i)*(r-o),u=s-a,l=Math.abs(s+a);return Math.abs(u)>=Gae*l?u:-Qae(e,t,n,r,i,o,l)}const xO=Math.pow(2,-52),lm=new Uint32Array(512);class H1{static from(t,n=tue,r=nue){const i=t.length,o=new Float64Array(i*2);for(let s=0;s<i;s++){const a=t[s];o[2*s]=n(a),o[2*s+1]=r(a)}return new H1(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:o}=this,s=t.length>>1;let a=1/0,u=1/0,l=-1/0,c=-1/0;for(let k=0;k<s;k++){const $=t[2*k],C=t[2*k+1];$<a&&(a=$),C<u&&(u=C),$>l&&(l=$),C>c&&(c=C),this._ids[k]=k}const f=(a+l)/2,d=(u+c)/2;let h,p,g;for(let k=0,$=1/0;k<s;k++){const C=lw(f,d,t[2*k],t[2*k+1]);C<$&&(h=k,$=C)}const y=t[2*h],m=t[2*h+1];for(let k=0,$=1/0;k<s;k++){if(k===h)continue;const C=lw(y,m,t[2*k],t[2*k+1]);C<$&&C>0&&(p=k,$=C)}let v=t[2*p],x=t[2*p+1],w=1/0;for(let k=0;k<s;k++){if(k===h||k===p)continue;const $=Jae(y,m,v,x,t[2*k],t[2*k+1]);$<w&&(g=k,w=$)}let b=t[2*g],S=t[2*g+1];if(w===1/0){for(let C=0;C<s;C++)this._dists[C]=t[2*C]-t[0]||t[2*C+1]-t[1];mc(this._ids,this._dists,0,s-1);const k=new Uint32Array(s);let $=0;for(let C=0,R=-1/0;C<s;C++){const A=this._ids[C],M=this._dists[A];M>R&&(k[$++]=A,R=M)}this.hull=k.subarray(0,$),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(um(y,m,v,x,b,S)<0){const k=p,$=v,C=x;p=g,v=b,x=S,g=k,b=$,S=C}const E=eue(y,m,v,x,b,S);this._cx=E.x,this._cy=E.y;for(let k=0;k<s;k++)this._dists[k]=lw(t[2*k],t[2*k+1],E.x,E.y);mc(this._ids,this._dists,0,s-1),this._hullStart=h;let _=3;r[h]=n[g]=p,r[p]=n[h]=g,r[g]=n[p]=h,i[h]=0,i[p]=1,i[g]=2,o.fill(-1),o[this._hashKey(y,m)]=h,o[this._hashKey(v,x)]=p,o[this._hashKey(b,S)]=g,this.trianglesLen=0,this._addTriangle(h,p,g,-1,-1,-1);for(let k=0,$,C;k<this._ids.length;k++){const R=this._ids[k],A=t[2*R],M=t[2*R+1];if(k>0&&Math.abs(A-$)<=xO&&Math.abs(M-C)<=xO||($=A,C=M,R===h||R===p||R===g))continue;let F=0;for(let j=0,X=this._hashKey(A,M);j<this._hashSize&&(F=o[(X+j)%this._hashSize],!(F!==-1&&F!==r[F]));j++);F=n[F];let N=F,P;for(;P=r[N],um(A,M,t[2*N],t[2*N+1],t[2*P],t[2*P+1])>=0;)if(N=P,N===F){N=-1;break}if(N===-1)continue;let T=this._addTriangle(N,R,r[N],-1,-1,i[N]);i[R]=this._legalize(T+2),i[N]=T,_++;let O=r[N];for(;P=r[O],um(A,M,t[2*O],t[2*O+1],t[2*P],t[2*P+1])<0;)T=this._addTriangle(O,R,P,i[R],-1,i[O]),i[R]=this._legalize(T+2),r[O]=O,_--,O=P;if(N===F)for(;P=n[N],um(A,M,t[2*P],t[2*P+1],t[2*N],t[2*N+1])<0;)T=this._addTriangle(P,R,N,-1,i[N],i[P]),this._legalize(T+2),i[P]=T,r[N]=N,_--,N=P;this._hullStart=n[R]=N,r[N]=n[O]=R,r[R]=O,o[this._hashKey(A,M)]=R,o[this._hashKey(t[2*N],t[2*N+1])]=N}this.hull=new Uint32Array(_);for(let k=0,$=this._hullStart;k<_;k++)this.hull[k]=$,$=r[$];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(Kae(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let o=0,s=0;for(;;){const a=r[t],u=t-t%3;if(s=u+(t+2)%3,a===-1){if(o===0)break;t=lm[--o];continue}const l=a-a%3,c=u+(t+1)%3,f=l+(a+2)%3,d=n[s],h=n[t],p=n[c],g=n[f];if(Zae(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[a]=d;const m=r[f];if(m===-1){let x=this._hullStart;do{if(this._hullTri[x]===f){this._hullTri[x]=t;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(t,m),this._link(a,r[s]),this._link(s,f);const v=l+(a+1)%3;o<lm.length&&(lm[o++]=v)}else{if(o===0)break;t=lm[--o]}}return s}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,o,s){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}function Kae(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function lw(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function Zae(e,t,n,r,i,o,s,a){const u=e-s,l=t-a,c=n-s,f=r-a,d=i-s,h=o-a,p=u*u+l*l,g=c*c+f*f,y=d*d+h*h;return u*(f*y-g*h)-l*(c*y-g*d)+p*(c*h-f*d)<0}function Jae(e,t,n,r,i,o){const s=n-e,a=r-t,u=i-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u),h=(l*c-a*f)*d,p=(s*f-u*c)*d;return h*h+p*p}function eue(e,t,n,r,i,o){const s=n-e,a=r-t,u=i-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u),h=e+(l*c-a*f)*d,p=t+(s*f-u*c)*d;return{x:h,y:p}}function mc(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const o=e[i],s=t[o];let a=i-1;for(;a>=n&&t[e[a]]>s;)e[a+1]=e[a--];e[a+1]=o}else{const i=n+r>>1;let o=n+1,s=r;wd(e,i,o),t[e[n]]>t[e[r]]&&wd(e,n,r),t[e[o]]>t[e[r]]&&wd(e,o,r),t[e[n]]>t[e[o]]&&wd(e,n,o);const a=e[o],u=t[a];for(;;){do o++;while(t[e[o]]<u);do s--;while(t[e[s]]>u);if(s<o)break;wd(e,o,s)}e[n+1]=e[s],e[s]=a,r-o+1>=s-n?(mc(e,t,o,r),mc(e,t,n,s-1)):(mc(e,t,n,s-1),mc(e,t,o,r))}}function wd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function tue(e){return e[0]}function nue(e){return e[1]}const wO=1e-6;class Ou{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,o=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>wO||Math.abs(this._y1-o)>wO)&&(this._+="L"+i+","+o),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=o}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class aS{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let rue=class{constructor(t,[n,r,i,o]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this;let o,s;const a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let g=0,y=0,m=r.length,v,x;g<m;g+=3,y+=2){const w=r[g]*2,b=r[g+1]*2,S=r[g+2]*2,E=t[w],_=t[w+1],k=t[b],$=t[b+1],C=t[S],R=t[S+1],A=k-E,M=$-_,F=C-E,N=R-_,P=(A*N-M*F)*2;if(Math.abs(P)<1e-9){if(o===void 0){o=s=0;for(const O of n)o+=t[O*2],s+=t[O*2+1];o/=n.length,s/=n.length}const T=1e9*Math.sign((o-E)*N-(s-_)*F);v=(E+C)/2-T*N,x=(_+R)/2+T*F}else{const T=1/P,O=A*A+M*M,j=F*F+N*N;v=E+(N*O-M*j)*T,x=_+(A*j-F*O)*T}a[y]=v,a[y+1]=x}let u=n[n.length-1],l,c=u*4,f,d=t[2*u],h,p=t[2*u+1];i.fill(0);for(let g=0;g<n.length;++g)u=n[g],l=c,f=d,h=p,c=u*4,d=t[2*u],p=t[2*u+1],i[l+2]=i[c]=h-p,i[l+3]=i[c+1]=d-f}render(t){const n=t==null?t=new Ou:void 0,{delaunay:{halfedges:r,inedges:i,hull:o},circumcenters:s,vectors:a}=this;if(o.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=s[h],y=s[h+1],m=s[p],v=s[p+1];this._renderSegment(g,y,m,v,t)}let u,l=o[o.length-1];for(let c=0;c<o.length;++c){u=l,l=o[c];const f=Math.floor(i[l]/3)*2,d=s[f],h=s[f+1],p=u*4,g=this._project(d,h,a[p+2],a[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new Ou:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new Ou:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(i[s]!==i[s-2]||i[s+1]!==i[s-1])&&n.lineTo(i[s],i[s+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new aS;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,o){let s;const a=this._regioncode(t,n),u=this._regioncode(r,i);a===0&&u===0?(o.moveTo(t,n),o.lineTo(r,i)):(s=this._clipSegment(t,n,r,i,a,u))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i){e:for(let o=0,s=n.length;o<s;o+=2)for(let a=0,u=i.length;a<u;a+=2)if(n[o]===i[a]&&n[o+1]===i[a+1]&&n[(o+2)%s]===i[(a+u-2)%u]&&n[(o+3)%s]===i[(a+u-1)%u]){yield r;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:o}}=this,s=r[t];if(s===-1)return null;const a=[];let u=s;do{const l=Math.floor(u/3);if(a.push(n[l*2],n[l*2+1]),u=u%3===2?u-2:u+1,o[u]!==t)break;u=i[u]}while(u!==s&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return this._simplify(r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n))}_clipFinite(t,n){const r=n.length;let i=null,o,s,a=n[r-2],u=n[r-1],l,c=this._regioncode(a,u),f,d=0;for(let h=0;h<r;h+=2)if(o=a,s=u,a=n[h],u=n[h+1],l=c,c=this._regioncode(a,u),l===0&&c===0)f=d,d=0,i?i.push(a,u):i=[a,u];else{let p,g,y,m,v;if(l===0){if((p=this._clipSegment(o,s,a,u,l,c))===null)continue;[g,y,m,v]=p}else{if((p=this._clipSegment(a,u,o,s,c,l))===null)continue;[m,v,g,y]=p,f=d,d=this._edgecode(g,y),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(g,y):i=[g,y]}f=d,d=this._edgecode(m,v),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(m,v):i=[m,v]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,o,s){const a=o<s;for(a&&([t,n,r,i,o,s]=[r,i,t,n,s,o]);;){if(o===0&&s===0)return a?[r,i,t,n]:[t,n,r,i];if(o&s)return null;let u,l,c=o||s;c&8?(u=t+(r-t)*(this.ymax-n)/(i-n),l=this.ymax):c&4?(u=t+(r-t)*(this.ymin-n)/(i-n),l=this.ymin):c&2?(l=n+(i-n)*(this.xmax-t)/(r-t),u=this.xmax):(l=n+(i-n)*(this.xmin-t)/(r-t),u=this.xmin),o?(t=u,n=l,o=this._regioncode(t,n)):(r=u,i=l,s=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,o,s){let a=Array.from(n),u;if((u=this._project(a[0],a[1],r,i))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],o,s))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let l=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,r,i,o){for(;n!==r;){let s,a;switch(n){case 5:n=4;continue;case 4:n=6,s=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,s=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,s=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,s=this.xmin,a=this.ymin;break}(i[o]!==s||i[o+1]!==a)&&this.contains(t,s,a)&&(i.splice(o,0,s,a),o+=2)}return o}_project(t,n,r,i){let o=1/0,s,a,u;if(i<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/i)<o&&(u=this.ymin,a=t+(o=s)*r)}else if(i>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/i)<o&&(u=this.ymax,a=t+(o=s)*r)}if(r>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/r)<o&&(a=this.xmax,u=n+(o=s)*i)}else if(r<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/r)<o&&(a=this.xmin,u=n+(o=s)*i)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const r=(n+2)%t.length,i=(n+4)%t.length;(t[n]===t[r]&&t[r]===t[i]||t[n+1]===t[r+1]&&t[r+1]===t[i+1])&&(t.splice(r,2),n-=2)}t.length||(t=null)}return t}};const iue=2*Math.PI,Hl=Math.pow;function oue(e){return e[0]}function sue(e){return e[1]}function aue(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],o=2*t[r+1],s=2*t[r+2];if((n[s]-n[i])*(n[o+1]-n[i+1])-(n[o]-n[i])*(n[s+1]-n[i+1])>1e-10)return!1}return!0}function uue(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class aA{static from(t,n=oue,r=sue,i){return new aA("length"in t?lue(t,n,r,i):Float64Array.from(cue(t,n,r,i)))}constructor(t){this._delaunator=new H1(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&aue(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=uue(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new H1(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=o[u%3===2?u-2:u+1];(r[u]===-1||s[c]===-1)&&(s[c]=u)}for(let u=0,l=i.length;u<l;++u)a[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],s[i[0]]=1,i.length===2&&(s[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(t){return new rue(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:o,triangles:s,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=s[l],l=l%3===2?l-2:l+1,s[l]!==t)return;if(l=o[l],l===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let o;for(;(o=this._step(r,t,n))>=0&&o!==r&&o!==i;)r=o;return o}_step(t,n,r){const{inedges:i,hull:o,_hullIndex:s,halfedges:a,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=Hl(n-l[t*2],2)+Hl(r-l[t*2+1],2);const d=i[t];let h=d;do{let p=u[h];const g=Hl(n-l[p*2],2)+Hl(r-l[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3===2?h-2:h+1,u[h]!==t)break;if(h=a[h],h===-1){if(h=o[(s[t]+1)%o.length],h!==p&&Hl(n-l[h*2],2)+Hl(r-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new Ou:void 0,{points:r,halfedges:i,triangles:o}=this;for(let s=0,a=i.length;s<a;++s){const u=i[s];if(u<s)continue;const l=o[s]*2,c=o[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const r=t==null?t=new Ou:void 0,{points:i}=this;for(let o=0,s=i.length;o<s;o+=2){const a=i[o],u=i[o+1];t.moveTo(a+n,u),t.arc(a,u,n,0,iue)}return r&&r.value()}renderHull(t){const n=t==null?t=new Ou:void 0,{hull:r,points:i}=this,o=r[0]*2,s=r.length;t.moveTo(i[o],i[o+1]);for(let a=1;a<s;++a){const u=2*r[a];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new aS;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new Ou:void 0,{points:i,triangles:o}=this,s=o[t*=3]*2,a=o[t+1]*2,u=o[t+2]*2;return n.moveTo(i[s],i[s+1]),n.lineTo(i[a],i[a+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new aS;return this.renderTriangle(t,n),n.value()}}function lue(e,t,n,r){const i=e.length,o=new Float64Array(i*2);for(let s=0;s<i;++s){const a=e[s];o[s*2]=t.call(r,a,s,e),o[s*2+1]=n.call(r,a,s,e)}return o}function*cue(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}function uA(e){D.call(this,null,e)}uA.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const fue=[-1e5,-1e5,1e5,1e5];G(uA,D,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:fue;const o=this.value=aA.from(r,e.x,e.y).voronoi(i);for(let s=0,a=r.length;s<a;++s){const u=o.cellPolygon(s);r[s][n]=u&&!hue(u)?due(u):null}return t.reflow(e.modified()).modifies(n)}});function due(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}function hue(e){return e.length===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}const pue=Object.freeze(Object.defineProperty({__proto__:null,voronoi:uA},Symbol.toStringTag,{value:"Module"}));var cw=Math.PI/180,th=64,r0=2048;function gue(){var e=[256,256],t,n,r,i,o,s,a,u=l7,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(wa()),g=bue((e[0]>>5)*e[1]),y=null,m=l.length,v=-1,x=[],w=l.map(S=>({text:t(S),font:n(S),style:i(S),weight:o(S),rotate:s(S),size:~~(r(S)+1e-14),padding:a(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S})).sort((S,E)=>E.size-S.size);++v<m;){var b=w[v];b.x=e[0]*(c()+.5)>>1,b.y=e[1]*(c()+.5)>>1,mue(p,b,w,v),b.hasText&&h(g,b,y)&&(x.push(b),y?vue(y,b):y=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}],b.x-=e[0]>>1,b.y-=e[1]>>1)}return x};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(th<<5)/g,p.height=r0/g;var y=p.getContext("2d");return y.fillStyle=y.strokeStyle="red",y.textAlign="center",{context:y,ratio:g}}function h(p,g,y){for(var m=g.x,v=g.y,x=Math.hypot(e[0],e[1]),w=u(e),b=c()<.5?1:-1,S=-b,E,_,k;(E=w(S+=b))&&(_=~~E[0],k=~~E[1],!(Math.min(Math.abs(_),Math.abs(k))>=x));)if(g.x=m+_,g.y=v+k,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!y||!yue(g,p,e[0]))&&(!y||xue(g,y))){for(var $=g.sprite,C=g.width>>5,R=e[0]>>5,A=g.x-(C<<4),M=A&127,F=32-M,N=g.y1-g.y0,P=(g.y+g.y0)*R+(A>>5),T,O=0;O<N;O++){T=0;for(var j=0;j<=C;j++)p[P+j]|=T<<F|(j<C?(T=$[O*C+j])>>>M:0);P+=R}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=au(p),f):n},f.fontStyle=function(p){return arguments.length?(i=au(p),f):i},f.fontWeight=function(p){return arguments.length?(o=au(p),f):o},f.rotate=function(p){return arguments.length?(s=au(p),f):s},f.text=function(p){return arguments.length?(t=au(p),f):t},f.spiral=function(p){return arguments.length?(u=Eue[p]||p,f):u},f.fontSize=function(p){return arguments.length?(r=au(p),f):r},f.padding=function(p){return arguments.length?(a=au(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}function mue(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,(th<<5)/o,r0/o);var s=0,a=0,u=0,l=n.length,c,f,d,h,p;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=i.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*cw),y=Math.cos(t.rotate*cw),m=c*y,v=c*g,x=d*y,w=d*g;c=Math.max(Math.abs(m+w),Math.abs(m-w))+31>>5<<5,d=~~Math.max(Math.abs(v+x),Math.abs(v-x))}else c=c+31>>5<<5;if(d>u&&(u=d),s+c>=th<<5&&(s=0,a+=u,u=0),a+d>=r0)break;i.translate((s+(c>>1))/o,(a+(d>>1))/o),t.rotate&&i.rotate(t.rotate*cw),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=s,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,s+=c}for(var b=i.getImageData(0,0,(th<<5)/o,r0/o).data,S=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)S[h]=0;if(s=t.xoff,s==null)return;a=t.yoff;var E=0,_=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var k=f*p+(h>>5),$=b[(a+p)*(th<<5)+(s+h)<<2]?1<<31-h%32:0;S[k]|=$,E|=$}E?_=p:(t.y0++,d--,p--,a++)}t.y1=t.y0+_,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function yue(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,o=e.x-(i<<4),s=o&127,a=32-s,u=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<a|(d<i?(c=r[f*i+d])>>>s:0))&t[l+d])return!0;l+=n}return!1}function vue(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function xue(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function l7(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function wue(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(o){var s=o<0?-1:1;switch(Math.sqrt(1+4*s*o)-s&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function bue(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function au(e){return typeof e=="function"?e:function(){return e}}var Eue={archimedean:l7,rectangular:wue};const c7=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Sue=["text","font","rotate","fontSize","fontStyle","fontWeight"];function lA(e){D.call(this,gue(),e)}lA.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:c7}]};G(lA,D,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&z("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return ge(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||Sue.some(n)))return;const i=t.materialize(t.SOURCE).source,o=this.value,s=e.as||c7;let a=e.fontSize||14,u;if(ge(a)?u=e.fontSizeRange:a=Cn(a),u){const p=a,g=Oe("sqrt")().domain(vo(i,p)).range(u);a=y=>g(p(y))}i.forEach(p=>{p[s[0]]=NaN,p[s[1]]=NaN,p[s[3]]=0});const l=o.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(ni).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,g,y;p<h;++p)g=l[p],y=g.datum,y[s[0]]=g.x+f,y[s[1]]=g.y+d,y[s[2]]=g.font,y[s[3]]=g.size,y[s[4]]=g.style,y[s[5]]=g.weight,y[s[6]]=g.rotate;return t.reflow(r).modifies(s)}});const _ue=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:lA},Symbol.toStringTag,{value:"Module"})),kue=e=>new Uint8Array(e),$ue=e=>new Uint16Array(e),_h=e=>new Uint32Array(e);function Cue(){let e=8,t=[],n=_h(0),r=cm(0,e),i=cm(0,e);return{data:()=>t,seen:()=>n=Aue(n,t.length),add(o){for(let s=0,a=t.length,u=o.length,l;s<u;++s)l=o[s],l._index=a++,t.push(l)},remove(o,s){const a=t.length,u=Array(a-o),l=t;let c,f,d;for(f=0;!s[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],s[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:o=>i[o]=r[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,s){r[o]|=s},clear(o,s){r[o]&=~s},resize(o,s){const a=r.length;(o>a||s>e)&&(e=Math.max(s,e),r=cm(o,e,r),i=cm(o,e))}}}function Aue(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function cm(e,t,n){const r=(t<257?kue:t<65537?$ue:_h)(e);return n&&r.set(n),r}function bO(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,o){const s=this,a=s.bisect(s.range,i.value),u=i.index,l=a[0],c=a[1],f=u.length;let d;for(d=0;d<l;++d)o[u[d]]|=r;for(d=c;d<f;++d)o[u[d]]|=r;return s}}}function EO(){let e=_h(0),t=[],n=0;function r(a,u,l){if(!u.length)return[];const c=n,f=u.length,d=_h(f);let h=Array(f),p,g,y;for(y=0;y<f;++y)h[y]=a(u[y]),d[y]=y;if(h=Fue(h,d),c)p=t,g=e,t=Array(c+f),e=_h(c+f),Mue(l,p,g,c,h,d,f,t,e);else{if(l>0)for(y=0;y<f;++y)d[y]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function i(a,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a}function o(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]}function s(a,u){let l;return u?l=u.length:(u=t,l=n),[RG(u,a[0],0,l),ka(u,a[1],0,l)]}return{insert:r,remove:i,bisect:s,reindex:o,index:()=>e,size:()=>n}}function Fue(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],o=e[r];return i<o?-1:i>o?1:0}),LG(e,t)}function Mue(e,t,n,r,i,o,s,a,u){let l=0,c=0,f;for(f=0;l<r&&c<s;++f)t[l]<i[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=i[c],u[f]=o[c++]+e);for(;l<r;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<s;++c,++f)a[f]=i[c],u[f]=o[c]+e}function cA(e){D.call(this,Cue(),e),this._indices=null,this._dims=null}cA.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};G(cA,D,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],s=r.length;let a=0,u,l;for(;a<s;++a)u=n[a].fname,l=i[u]||(i[u]=EO()),o.push(bO(l,a,r[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,s=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let g,y,m,v,x,w,b,S,E;if(l.set(u),t.rem.length&&(x=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(w={},v=t.mod,b=0,S=v.length;b<S;++b)w[v[b]._index]=1;for(b=0;b<h;++b)E=r[b],(!s[b]||e.modified("fields",b)||t.modified(E.fields))&&(m=E.fname,(g=p[m])||(o[m]=y=EO(),p[m]=g=y.insert(E,t.source,0)),s[b]=bO(y,b,i[b]).onAdd(g,u));for(b=0,S=a.data().length;b<S;++b)x[b]||(l[b]!==u[b]?f.push(b):w[b]&&u[b]!==c&&d.push(b));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,o=this._dims,s=this._indices,a=e.fields,u={},l=n.add,c=i.size()+r.length,f=o.length;let d=i.size(),h,p,g;i.resize(c,f),i.add(r);const y=i.curr(),m=i.prev(),v=i.all();for(h=0;h<f;++h)p=a[h].fname,g=u[p]||(u[p]=s[p].insert(a[h],r,d)),o[h].onAdd(g,y);for(;d<c;++d)m[d]=v,y[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),s=e.mod;let a,u,l;for(a=0,u=s.length;a<u;++a)l=s[a]._index,i[l]!==o&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,o=i.curr(),s=i.prev(),a=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,s[h]=p=o[h],o[h]=a,p!==a&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const o=i.remove(t,n);for(const s in r)r[s].reindex(o)})},update(e,t,n){const r=this._dims,i=e.query,o=t.stamp,s=r.length;let a=0,u,l;for(n.filters=0,l=0;l<s;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,a=0;l<s;++l)e.modified("query",l)&&(a|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return a},incrementAll(e,t,n,r){const i=this.value,o=i.seen(),s=i.curr(),a=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let y,m,v;if(f<h)for(y=f,m=Math.min(h,d);y<m;++y)v=u[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(f>h)for(y=h,m=Math.min(f,p);y<m;++y)v=u[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;if(d>p)for(y=Math.max(f,p),m=d;y<m;++y)v=u[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(d<p)for(y=Math.max(h,d),m=p;y<m;++y)v=u[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,o=i.curr(),s=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],h=e.one;let p,g,y;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)y=s[p],o[y]^=h,n.push(y);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)y=s[p],o[y]^=h,r.push(y);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)y=s[p],o[y]^=h,n.push(y);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)y=s[p],o[y]^=h,r.push(y);e.range=t.slice()}});function fA(e){D.call(this,null,e)}fA.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};G(fA,D,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if(!(i&n))return t.StopPropagation;const o=t.fork(t.ALL),s=r.data(),a=r.curr(),u=r.prev(),l=c=>a[c]&n?null:s[c];return o.filter(o.MOD,l),i&i-1?(o.filter(o.ADD,c=>{const f=a[c]&n;return!f&&f^u[c]&n?s[c]:null}),o.filter(o.REM,c=>{const f=a[c]&n;return f&&!(f^(f^u[c]&n))?s[c]:null})):(o.filter(o.ADD,l),o.filter(o.REM,c=>(a[c]&n)===i?s[c]:null)),o.filter(o.SOURCE,c=>l(c._index))}});const Tue=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:cA,resolvefilter:fA},Symbol.toStringTag,{value:"Module"})),Nue="RawCode",ol="Literal",Oue="Property",Rue="Identifier",Due="ArrayExpression",Pue="BinaryExpression",f7="CallExpression",Lue="ConditionalExpression",zue="LogicalExpression",Iue="MemberExpression",Bue="ObjectExpression",jue="UnaryExpression";function Bi(e){this.type=e}Bi.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=Uue(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function Uue(e){switch(e.type){case Due:return e.elements;case Pue:case zue:return[e.left,e.right];case f7:return[e.callee].concat(e.arguments);case Lue:return[e.test,e.consequent,e.alternate];case Iue:return[e.object,e.property];case Bue:return e.properties;case Oue:return[e.key,e.value];case jue:return[e.argument];case Rue:case ol:case Nue:default:return[]}}var No,te,L,Sn,ze,Ov=1,tg=2,sl=3,Qa=4,Rv=5,$l=6,Xn=7,ng=8,Wue=9;No={};No[Ov]="Boolean";No[tg]="<end>";No[sl]="Identifier";No[Qa]="Keyword";No[Rv]="Null";No[$l]="Numeric";No[Xn]="Punctuator";No[ng]="String";No[Wue]="RegularExpression";var que="ArrayExpression",Hue="BinaryExpression",Vue="CallExpression",Gue="ConditionalExpression",d7="Identifier",Yue="Literal",Xue="LogicalExpression",Que="MemberExpression",Kue="ObjectExpression",Zue="Property",Jue="UnaryExpression",It="Unexpected token %0",ele="Unexpected number",tle="Unexpected string",nle="Unexpected identifier",rle="Unexpected reserved word",ile="Unexpected end of input",uS="Invalid regular expression",fw="Invalid regular expression: missing /",h7="Octal literals are not allowed in strict mode.",ole="Duplicate data property in object literal not allowed in strict mode",Zt="ILLEGAL",cp="Disabled.",sle=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),ale=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Dv(e,t){if(!e)throw new Error("ASSERT: "+t)}function Yo(e){return e>=48&&e<=57}function dA(e){return"0123456789abcdefABCDEF".includes(e)}function kh(e){return"01234567".includes(e)}function ule(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function fp(e){return e===10||e===13||e===8232||e===8233}function rg(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&sle.test(String.fromCharCode(e))}function V1(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&ale.test(String.fromCharCode(e))}const lle={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function p7(){for(;L<Sn;){const e=te.charCodeAt(L);if(ule(e)||fp(e))++L;else break}}function lS(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)L<Sn&&dA(te[L])?(r=te[L++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Te({},It,Zt);return String.fromCharCode(i)}function cle(){var e,t,n,r;for(e=te[L],t=0,e==="}"&&Te({},It,Zt);L<Sn&&(e=te[L++],!!dA(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Te({},It,Zt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function g7(){var e,t;for(e=te.charCodeAt(L++),t=String.fromCharCode(e),e===92&&(te.charCodeAt(L)!==117&&Te({},It,Zt),++L,e=lS("u"),(!e||e==="\\"||!rg(e.charCodeAt(0)))&&Te({},It,Zt),t=e);L<Sn&&(e=te.charCodeAt(L),!!V1(e));)++L,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),te.charCodeAt(L)!==117&&Te({},It,Zt),++L,e=lS("u"),(!e||e==="\\"||!V1(e.charCodeAt(0)))&&Te({},It,Zt),t+=e);return t}function fle(){var e,t;for(e=L++;L<Sn;){if(t=te.charCodeAt(L),t===92)return L=e,g7();if(V1(t))++L;else break}return te.slice(e,L)}function dle(){var e,t,n;return e=L,t=te.charCodeAt(L)===92?g7():fle(),t.length===1?n=sl:lle.hasOwnProperty(t)?n=Qa:t==="null"?n=Rv:t==="true"||t==="false"?n=Ov:n=sl,{type:n,value:t,start:e,end:L}}function dw(){var e=L,t=te.charCodeAt(L),n,r=te[L],i,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++L,{type:Xn,value:String.fromCharCode(t),start:e,end:L};default:if(n=te.charCodeAt(L+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return L+=2,{type:Xn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:L};case 33:case 61:return L+=2,te.charCodeAt(L)===61&&++L,{type:Xn,value:te.slice(e,L),start:e,end:L}}}if(s=te.substr(L,4),s===">>>=")return L+=4,{type:Xn,value:s,start:e,end:L};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return L+=3,{type:Xn,value:o,start:e,end:L};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".includes(r)||i==="=>")return L+=2,{type:Xn,value:i,start:e,end:L};if(i==="//"&&Te({},It,Zt),"<>=!+-*%&|^/".includes(r))return++L,{type:Xn,value:r,start:e,end:L};Te({},It,Zt)}function hle(e){let t="";for(;L<Sn&&dA(te[L]);)t+=te[L++];return t.length===0&&Te({},It,Zt),rg(te.charCodeAt(L))&&Te({},It,Zt),{type:$l,value:parseInt("0x"+t,16),start:e,end:L}}function ple(e){let t="0"+te[L++];for(;L<Sn&&kh(te[L]);)t+=te[L++];return(rg(te.charCodeAt(L))||Yo(te.charCodeAt(L)))&&Te({},It,Zt),{type:$l,value:parseInt(t,8),octal:!0,start:e,end:L}}function SO(){var e,t,n;if(n=te[L],Dv(Yo(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=L,e="",n!=="."){if(e=te[L++],n=te[L],e==="0"){if(n==="x"||n==="X")return++L,hle(t);if(kh(n))return ple(t);n&&Yo(n.charCodeAt(0))&&Te({},It,Zt)}for(;Yo(te.charCodeAt(L));)e+=te[L++];n=te[L]}if(n==="."){for(e+=te[L++];Yo(te.charCodeAt(L));)e+=te[L++];n=te[L]}if(n==="e"||n==="E")if(e+=te[L++],n=te[L],(n==="+"||n==="-")&&(e+=te[L++]),Yo(te.charCodeAt(L)))for(;Yo(te.charCodeAt(L));)e+=te[L++];else Te({},It,Zt);return rg(te.charCodeAt(L))&&Te({},It,Zt),{type:$l,value:parseFloat(e),start:t,end:L}}function gle(){var e="",t,n,r,i,o=!1;for(t=te[L],Dv(t==="'"||t==='"',"String literal must starts with a quote"),n=L,++L;L<Sn;)if(r=te[L++],r===t){t="";break}else if(r==="\\")if(r=te[L++],!r||!fp(r.charCodeAt(0)))switch(r){case"u":case"x":te[L]==="{"?(++L,e+=cle()):e+=lS(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:kh(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),L<Sn&&kh(te[L])&&(o=!0,i=i*8+"01234567".indexOf(te[L++]),"0123".includes(r)&&L<Sn&&kh(te[L])&&(i=i*8+"01234567".indexOf(te[L++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&te[L]===`
`&&++L;else{if(fp(r.charCodeAt(0)))break;e+=r}return t!==""&&Te({},It,Zt),{type:ng,value:e,octal:o,start:n,end:L}}function mle(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Te({},uS)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Te({},uS)}try{return new RegExp(e,t)}catch{return null}}function yle(){var e,t,n,r,i;for(e=te[L],Dv(e==="/","Regular expression literal must start with a slash"),t=te[L++],n=!1,r=!1;L<Sn;)if(e=te[L++],t+=e,e==="\\")e=te[L++],fp(e.charCodeAt(0))&&Te({},fw),t+=e;else if(fp(e.charCodeAt(0)))Te({},fw);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Te({},fw),i=t.substr(1,t.length-2),{value:i,literal:t}}function vle(){var e,t,n;for(t="",n="";L<Sn&&(e=te[L],!!V1(e.charCodeAt(0)));)++L,e==="\\"&&L<Sn?Te({},It,Zt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Te({},uS,n),{value:n,literal:t}}function xle(){var e,t,n,r;return ze=null,p7(),e=L,t=yle(),n=vle(),r=mle(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:L}}function wle(e){return e.type===sl||e.type===Qa||e.type===Ov||e.type===Rv}function m7(){if(p7(),L>=Sn)return{type:tg,start:L,end:L};const e=te.charCodeAt(L);return rg(e)?dle():e===40||e===41||e===59?dw():e===39||e===34?gle():e===46?Yo(te.charCodeAt(L+1))?SO():dw():Yo(e)?SO():dw()}function Jn(){const e=ze;return L=e.end,ze=m7(),L=e.end,e}function y7(){const e=L;ze=m7(),L=e}function ble(e){const t=new Bi(que);return t.elements=e,t}function _O(e,t,n){const r=new Bi(e==="||"||e==="&&"?Xue:Hue);return r.operator=e,r.left=t,r.right=n,r}function Ele(e,t){const n=new Bi(Vue);return n.callee=e,n.arguments=t,n}function Sle(e,t,n){const r=new Bi(Gue);return r.test=e,r.consequent=t,r.alternate=n,r}function hA(e){const t=new Bi(d7);return t.name=e,t}function nh(e){const t=new Bi(Yue);return t.value=e.value,t.raw=te.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function kO(e,t,n){const r=new Bi(Que);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function _le(e){const t=new Bi(Kue);return t.properties=e,t}function $O(e,t,n){const r=new Bi(Zue);return r.key=t,r.value=n,r.kind=e,r}function kle(e,t){const n=new Bi(Jue);return n.operator=e,n.argument=t,n.prefix=!0,n}function Te(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,s)=>(Dv(s<r.length,"Message reference must be in range"),r[s]));throw n=new Error(i),n.index=L,n.description=i,n}function Pv(e){e.type===tg&&Te(e,ile),e.type===$l&&Te(e,ele),e.type===ng&&Te(e,tle),e.type===sl&&Te(e,nle),e.type===Qa&&Te(e,rle),Te(e,It,e.value)}function _n(e){const t=Jn();(t.type!==Xn||t.value!==e)&&Pv(t)}function Ke(e){return ze.type===Xn&&ze.value===e}function hw(e){return ze.type===Qa&&ze.value===e}function $le(){const e=[];for(L=ze.start,_n("[");!Ke("]");)Ke(",")?(Jn(),e.push(null)):(e.push(al()),Ke("]")||_n(","));return Jn(),ble(e)}function CO(){L=ze.start;const e=Jn();return e.type===ng||e.type===$l?(e.octal&&Te(e,h7),nh(e)):hA(e.value)}function Cle(){var e,t,n,r;if(L=ze.start,e=ze,e.type===sl)return n=CO(),_n(":"),r=al(),$O("init",n,r);if(e.type===tg||e.type===Xn)Pv(e);else return t=CO(),_n(":"),r=al(),$O("init",t,r)}function Ale(){var e=[],t,n,r,i={},o=String;for(L=ze.start,_n("{");!Ke("}");)t=Cle(),t.key.type===d7?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Te({},ole):i[r]=!0,e.push(t),Ke("}")||_n(",");return _n("}"),_le(e)}function Fle(){_n("(");const e=pA();return _n(")"),e}const Mle={if:1};function Tle(){var e,t,n;if(Ke("("))return Fle();if(Ke("["))return $le();if(Ke("{"))return Ale();if(e=ze.type,L=ze.start,e===sl||Mle[ze.value])n=hA(Jn().value);else if(e===ng||e===$l)ze.octal&&Te(ze,h7),n=nh(Jn());else{if(e===Qa)throw new Error(cp);e===Ov?(t=Jn(),t.value=t.value==="true",n=nh(t)):e===Rv?(t=Jn(),t.value=null,n=nh(t)):Ke("/")||Ke("/=")?(n=nh(xle()),y7()):Pv(Jn())}return n}function Nle(){const e=[];if(_n("("),!Ke(")"))for(;L<Sn&&(e.push(al()),!Ke(")"));)_n(",");return _n(")"),e}function Ole(){L=ze.start;const e=Jn();return wle(e)||Pv(e),hA(e.value)}function Rle(){return _n("."),Ole()}function Dle(){_n("[");const e=pA();return _n("]"),e}function Ple(){var e,t,n;for(e=Tle();;)if(Ke("."))n=Rle(),e=kO(".",e,n);else if(Ke("("))t=Nle(),e=Ele(e,t);else if(Ke("["))n=Dle(),e=kO("[",e,n);else break;return e}function AO(){const e=Ple();if(ze.type===Xn&&(Ke("++")||Ke("--")))throw new Error(cp);return e}function i0(){var e,t;if(ze.type!==Xn&&ze.type!==Qa)t=AO();else{if(Ke("++")||Ke("--"))throw new Error(cp);if(Ke("+")||Ke("-")||Ke("~")||Ke("!"))e=Jn(),t=i0(),t=kle(e.value,t);else{if(hw("delete")||hw("void")||hw("typeof"))throw new Error(cp);t=AO()}}return t}function FO(e){let t=0;if(e.type!==Xn&&e.type!==Qa)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Lle(){var e,t,n,r,i,o,s,a,u,l;if(e=ze,u=i0(),r=ze,i=FO(r),i===0)return u;for(r.prec=i,Jn(),t=[e,ze],s=i0(),o=[u,r,s];(i=FO(ze))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),t.pop(),n=_O(a,u,s),o.push(n);r=Jn(),r.prec=i,o.push(r),t.push(ze),n=i0(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=_O(o[l-1].value,o[l-2],n),l-=2;return n}function al(){var e,t,n;return e=Lle(),Ke("?")&&(Jn(),t=al(),_n(":"),n=al(),e=Sle(e,t,n)),e}function pA(){const e=al();if(Ke(","))throw new Error(cp);return e}function gA(e){te=e,L=0,Sn=te.length,ze=null,y7();const t=pA();if(ze.type!==tg)throw new Error("Unexpect token after expression.");return t}var v7={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function x7(e){function t(s,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+s+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(s,a,u){return l=>t(s,l,a,u)}const r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&z("Missing arguments to clamp function."),s.length>3&&z("Too many arguments to clamp function.");const a=s.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:o,test:n("test",o),if:function(s){s.length<3&&z("Missing arguments to if function."),s.length>3&&z("Too many arguments to if function.");const a=s.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function zle(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function w7(e){e=e||{};const t=e.allowed?Oi(e.allowed):{},n=e.forbidden?Oi(e.forbidden):{},r=e.constants||v7,i=(e.functions||x7)(f),o=e.globalvar,s=e.fieldvar,a=ge(o)?o:p=>`${o}["${p}"]`;let u={},l={},c=0;function f(p){if(Z(p))return p;const g=d[p.type];return g==null&&z("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:ae(n,g)?z("Illegal identifier: "+g):ae(r,g)?r[g]:ae(t,g)?g:(u[g]=1,a(g))},MemberExpression:p=>{const g=!p.computed,y=f(p.object);g&&(c+=1);const m=f(p.property);return y===s&&(l[zle(m)]=1),g&&(c-=1),y+(g?"."+m:"["+m+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&z("Illegal callee type: "+p.callee.type);const g=p.callee.name,y=p.arguments,m=ae(i,g)&&i[g];return m||z("Unrecognized function: "+g),ge(m)?m(y):m+"("+y.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=i,h.constants=r,h}const MO=Symbol("vega_selection_getter");function b7(e){return(!e.getter||!e.getter[MO])&&(e.getter=Jr(e.field),e.getter[MO]=!0),e.getter}const mA="intersect",TO="union",Ile="vlMulti",Ble="vlPoint",NO="or",jle="and",ro="_vgsid_",dp=Jr(ro),Ule="E",Wle="R",qle="R-E",Hle="R-LE",Vle="R-RE",G1="index:unit";function OO(e,t){for(var n=t.fields,r=t.values,i=n.length,o=0,s,a;o<i;++o)if(a=n[o],s=b7(a)(e),ya(s)&&(s=vn(s)),ya(r[o])&&(r[o]=vn(r[o])),I(r[o])&&ya(r[o][0])&&(r[o]=r[o].map(vn)),a.type===Ule){if(I(r[o])?r[o].indexOf(s)<0:s!==r[o])return!1}else if(a.type===Wle){if(!dc(s,r[o]))return!1}else if(a.type===Vle){if(!dc(s,r[o],!0,!1))return!1}else if(a.type===qle){if(!dc(s,r[o],!1,!1))return!1}else if(a.type===Hle&&!dc(s,r[o],!1,!0))return!1;return!0}function Gle(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],o=r?r[G1]&&r[G1].value:void 0,s=n===mA,a=i.length,u=0,l,c,f,d,h;u<a;++u)if(l=i[u],o&&s){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=OO(t,l),c[d]=h?-1:++f,h&&o.size===1)return!0;if(!h&&f===o.get(d).count)return!1}else if(h=OO(t,l),s^h)return h;return a&&s}const E7=Tf(dp),Yle=E7.left,Xle=E7.right;function Qle(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r[G1]&&r[G1].value:void 0,s=n===mA,a=dp(t),u=Yle(i,a);if(u===i.length||dp(i[u])!==a)return!1;if(o&&s){if(o.size===1)return!0;if(Xle(i,a)-u<o.size)return!1}return!0}function Kle(e,t){return e.map(n=>pe(t.fields?{values:t.fields.map(r=>b7(r)(n.datum))}:{[ro]:dp(n.datum)},t))}function Zle(e,t,n,r){for(var i=this.context.data[e],o=i?i.values.value:[],s={},a={},u={},l,c,f,d,h,p,g,y,m,v,x=o.length,w=0,b,S;w<x;++w)if(l=o[w],d=l.unit,c=l.fields,f=l.values,c&&f){for(b=0,S=c.length;b<S;++b)h=c[b],g=s[h.field]||(s[h.field]={}),y=g[d]||(g[d]=[]),u[h.field]=m=h.type.charAt(0),v=pw[`${m}_union`],g[d]=v(y,K(f[b]));n&&(y=a[d]||(a[d]=[]),y.push(K(f).reduce((E,_,k)=>(E[c[k].field]=_,E),{})))}else h=ro,p=dp(l),g=s[h]||(s[h]={}),y=g[d]||(g[d]=[]),y.push(p),n&&(y=a[d]||(a[d]=[]),y.push({[ro]:p}));if(t=t||TO,s[ro]?s[ro]=pw[`${ro}_${t}`](...Object.values(s[ro])):Object.keys(s).forEach(E=>{s[E]=Object.keys(s[E]).map(_=>s[E][_]).reduce((_,k)=>_===void 0?k:pw[`${u[E]}_${t}`](_,k))}),o=Object.keys(a),n&&o.length){const E=r?Ble:Ile;s[E]=t===TO?{[NO]:o.reduce((_,k)=>(_.push(...a[k]),_),[])}:{[jle]:o.map(_=>({[NO]:a[_]}))}}return s}var pw={[`${ro}_union`]:VG,[`${ro}_intersect`]:qG,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=vn(t[0]),r=vn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=vn(t[0]),r=vn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const Jle=":",ece="@";function yA(e,t,n,r){t[0].type!==ol&&z("First argument to selection functions must be a string literal.");const i=t[0].value,o=t.length>=2&&$e(t).value,s="unit",a=ece+s,u=Jle+i;o===mA&&!ae(r,a)&&(r[a]=n.getData(i).indataRef(n,s)),ae(r,u)||(r[u]=n.getData(i).tuplesRef())}function S7(e){const t=this.context.data[e];return t?t.values.value:[]}function tce(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function nce(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(ei).insert(t)),1}function rce(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const ig=e=>function(t,n){const r=this.context.dataflow.locale();return t===null?"null":r[e](n)(t)},ice=ig("format"),_7=ig("timeFormat"),oce=ig("utcFormat"),sce=ig("timeParse"),ace=ig("utcParse"),fm=new Date(2e3,0,1);function Lv(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(fm.setYear(2e3),fm.setMonth(e),fm.setDate(t),_7.call(this,fm,n))}function uce(e){return Lv.call(this,e,1,"%B")}function lce(e){return Lv.call(this,e,1,"%b")}function cce(e){return Lv.call(this,0,2+e,"%A")}function fce(e){return Lv.call(this,0,2+e,"%a")}const dce=":",hce="@",cS="%",k7="$";function vA(e,t,n,r){t[0].type!==ol&&z("First argument to data functions must be a string literal.");const i=t[0].value,o=dce+i;if(!ae(o,r))try{r[o]=n.getData(i).tuplesRef()}catch{}}function pce(e,t,n,r){t[0].type!==ol&&z("First argument to indata must be a string literal."),t[1].type!==ol&&z("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,s=hce+o;ae(s,r)||(r[s]=n.getData(i).indataRef(n,o))}function Bn(e,t,n,r){if(t[0].type===ol)RO(n,r,t[0].value);else for(e in n.scales)RO(n,r,e)}function RO(e,t,n){const r=cS+n;if(!ae(t,r))try{t[r]=e.scaleRef(n)}catch{}}function Oo(e,t){if(ge(e))return e;if(Z(e)){const n=t.scales[e];return n&&kJ(n.value)?n.value:void 0}}function gce(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=Bn,n._range=Bn,n._scale=Bn;const r=i=>"_["+(i.type===ol?V(cS+i.value):V(cS)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function xA(e,t){return function(n,r,i){if(n){const o=Oo(n,(i||this).context);return o&&o.path[e](r)}else return t(r)}}const mce=xA("area",Bre),yce=xA("bounds",qre),vce=xA("centroid",Qre);function xce(e,t){const n=Oo(e,(t||this).context);return n&&n.scale()}function wce(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function wA(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function bce(){return wA(this.context.dataflow,"warn",arguments)}function Ece(){return wA(this.context.dataflow,"info",arguments)}function Sce(){return wA(this.context.dataflow,"debug",arguments)}function gw(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function fS(e){const t=Fa(e),n=gw(t.r),r=gw(t.g),i=gw(t.b);return .2126*n+.7152*r+.0722*i}function _ce(e,t){const n=fS(e),r=fS(t),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function kce(){const e=[].slice.call(arguments);return e.unshift({}),pe(...e)}function $7(e,t){return e===t||e!==e&&t!==t?!0:I(e)?I(t)&&e.length===t.length?$ce(e,t):!1:Q(e)&&Q(t)?C7(e,t):!1}function $ce(e,t){for(let n=0,r=e.length;n<r;++n)if(!$7(e[n],t[n]))return!1;return!0}function C7(e,t){for(const n in e)if(!$7(e[n],t[n]))return!1;return!0}function DO(e){return t=>C7(e,t)}function Cce(e,t,n,r,i,o){const s=this.context.dataflow,a=this.context.data[e],u=a.input,l=s.stamp();let c=a.changes,f,d;if(s._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(a.changes=c=s.changeset(),c.stamp=l,s.runAfter(()=>{a.modified=!0,s.pulse(u,c).run()},!0,1)),n&&(f=n===!0?ei:I(n)||Vy(n)?n:DO(n),c.remove(f)),t&&c.insert(t),r&&(f=DO(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in o)c.modify(i,d,o[d]);return 1}function Ace(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)}function Fce(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const PO={};function Mce(e,t){const n=PO[t]||(PO[t]=Jr(t));return I(e)?e.map(n):n(e)}function bA(e){return I(e)||ArrayBuffer.isView(e)?e:null}function EA(e){return bA(e)||(Z(e)?e:null)}function Tce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return bA(e).join(...n)}function Nce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return EA(e).indexOf(...n)}function Oce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return EA(e).lastIndexOf(...n)}function Rce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return EA(e).slice(...n)}function Dce(e,t,n){return ge(n)&&z("Function argument passed to replace."),String(e).replace(t,n)}function Pce(e){return bA(e).slice().reverse()}function Lce(e,t,n){return R$(e||0,t||0,n||0)}function zce(e,t){const n=Oo(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Ice(e,t){const n=Oo(e,(t||this).context);return n?n.copy():void 0}function Bce(e,t){const n=Oo(e,(t||this).context);return n?n.domain():[]}function jce(e,t,n){const r=Oo(e,(n||this).context);return r?I(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function Uce(e,t){const n=Oo(e,(t||this).context);return n&&n.range?n.range():[]}function Wce(e,t,n){const r=Oo(e,(n||this).context);return r?r(t):void 0}function qce(e,t,n,r,i){e=Oo(e,(i||this).context);const o=y8(t,n);let s=e.domain(),a=s[0],u=$e(s),l=$n;return u-a?l=o8(e,a,u):e=(e.interpolator?Oe("sequential")().interpolator(e.interpolator()):Oe("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(s=e.ticks(+r||15),a!==s[0]&&s.unshift(a),u!==$e(s)&&s.push(u)),s.forEach(c=>o.stop(l(c),e(c))),o}function Hce(e,t,n){const r=Oo(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function Vce(e){let t=null;return function(n){return n?np(n,t=t||Zc(e)):e}}const A7=e=>e.data;function F7(e,t){const n=S7.call(t,e);return n.root&&n.root.lookup||{}}function Gce(e,t,n){const r=F7(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(A7):void 0}function Yce(e,t){const n=F7(e,this)[t];return n?n.ancestors().map(A7):void 0}const M7=()=>typeof window<"u"&&window||null;function Xce(){const e=M7();return e?e.screen:{}}function Qce(){const e=M7();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Kce(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function T7(e,t,n){if(!e)return[];const[r,i]=e,o=new Et().set(r[0],r[1],i[0],i[1]),s=n||this.context.dataflow.scenegraph().root;return pI(s,o,Zce(t))}function Zce(e){let t=null;if(e){const n=K(e.marktype),r=K(e.markname);t=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return t}function Jce(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=K(e);const i=e[e.length-1];return i===void 0||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e}function efe(e){return K(e).reduce((t,n,r)=>{let[i,o]=n;return t+=r==0?`M ${i},${o} `:r===e.length-1?" Z":`L ${i},${o} `},"")}function tfe(e,t,n){const{x:r,y:i,mark:o}=n,s=new Et().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[u,l]of t)u<s.x1&&(s.x1=u),u>s.x2&&(s.x2=u),l<s.y1&&(s.y1=l),l>s.y2&&(s.y2=l);return s.translate(r,i),T7([[s.x1,s.y1],[s.x2,s.y2]],e,o).filter(u=>nfe(u.x,u.y,t))}function nfe(e,t,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[s,a]=n[o],[u,l]=n[i];l>t!=a>t&&e<(s-u)*(t-l)/(a-l)+u&&r++}return r&1}const hp={random(){return ni()},cumulativeNormal:Ky,cumulativeLogNormal:Rk,cumulativeUniform:zk,densityNormal:Fk,densityLogNormal:Ok,densityUniform:Lk,quantileNormal:Zy,quantileLogNormal:Dk,quantileUniform:Ik,sampleNormal:Qy,sampleLogNormal:Nk,sampleUniform:Pk,isArray:I,isBoolean:Ha,isDate:ya,isDefined(e){return e!==void 0},isNumber:Ae,isObject:Q,isRegExp:z6,isString:Z,isTuple:Vy,isValid(e){return e!=null&&e===e},toBoolean:uk,toDate(e){return lk(e)},toNumber:vn,toString:ck,indexof:Nce,join:Tce,lastindexof:Oce,replace:Dce,reverse:Pce,slice:Rce,flush:P6,lerp:I6,merge:kce,pad:U6,peek:$e,pluck:Mce,span:Tp,inrange:dc,truncate:W6,rgb:Fa,lab:J0,hcl:e1,hsl:K0,luminance:fS,contrast:_ce,sequence:Er,format:ice,utcFormat:oce,utcParse:ace,utcOffset:EP,utcSequence:kP,timeFormat:_7,timeParse:sce,timeOffset:bP,timeSequence:_P,timeUnitSpecifier:cP,monthFormat:uce,monthAbbrevFormat:lce,dayFormat:cce,dayAbbrevFormat:fce,quarter:N6,utcquarter:O6,week:dP,utcweek:gP,dayofyear:fP,utcdayofyear:pP,warn:bce,info:Ece,debug:Sce,extent(e){return vo(e)},inScope:wce,intersect:T7,clampRange:R6,pinchDistance:Ace,pinchAngle:Fce,screen:Xce,containerSize:Kce,windowSize:Qce,bandspace:Lce,setdata:nce,pathShape:Vce,panLinear:A6,panLog:F6,panPow:M6,panSymlog:T6,zoomLinear:nk,zoomLog:rk,zoomPow:z0,zoomSymlog:ik,encode:rce,modify:Cce,lassoAppend:Jce,lassoPath:efe,intersectLasso:tfe},rfe=["view","item","group","xy","x","y"],ife="event.vega.",N7="this.",SA={},O7={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${V(k7+e)}]`,functions:ofe,constants:v7,visitors:SA},dS=w7(O7);function ofe(e){const t=x7(e);rfe.forEach(n=>t[n]=ife+n);for(const n in hp)t[n]=N7+n;return pe(t,gce(e,hp,SA)),t}function wt(e,t,n){return arguments.length===1?hp[e]:(hp[e]=t,n&&(SA[e]=n),dS&&(dS.functions[e]=N7+e),this)}wt("bandwidth",zce,Bn);wt("copy",Ice,Bn);wt("domain",Bce,Bn);wt("range",Uce,Bn);wt("invert",jce,Bn);wt("scale",Wce,Bn);wt("gradient",qce,Bn);wt("geoArea",mce,Bn);wt("geoBounds",yce,Bn);wt("geoCentroid",vce,Bn);wt("geoShape",Hce,Bn);wt("geoScale",xce,Bn);wt("indata",tce,pce);wt("data",S7,vA);wt("treePath",Gce,vA);wt("treeAncestors",Yce,vA);wt("vlSelectionTest",Gle,yA);wt("vlSelectionIdTest",Qle,yA);wt("vlSelectionResolve",Zle,yA);wt("vlSelectionTuples",Kle);function So(e,t){const n={};let r;try{e=Z(e)?e:V(e)+"",r=gA(e)}catch{z("Expression parse error: "+e)}r.visit(o=>{if(o.type!==f7)return;const s=o.callee.name,a=O7.visitors[s];a&&a(s,o.arguments,t,n)});const i=dS(r);return i.globals.forEach(o=>{const s=k7+o;!ae(n,s)&&t.getSignal(o)&&(n[s]=t.signalRef(o))}),{$expr:pe({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function sfe(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const afe=Oi(["rule"]),LO=Oi(["group","image","rect"]);function ufe(e,t){let n="";return afe[t]||(e.x2&&(e.x?(LO[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(LO[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function _A(e){return(e+"").toLowerCase()}function lfe(e){return _A(e)==="operator"}function cfe(e){return _A(e)==="collect"}function bd(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function ffe(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `}var dfe={operator:(e,t)=>bd(e,["_"],t.code),parameter:(e,t)=>bd(e,["datum","_"],t.code),event:(e,t)=>bd(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return bd(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const s="o["+V(o)+"]";i+=`$=${r[o].code};if(${s}!==$)${s}=$,m=1;`}return i+=ufe(r,n),i+="return m;",bd(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(V).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=(o,s)=>{const a=t[s];let u,l;return o.path?(u=`a${o.path}`,l=`b${o.path}`):((n=n||{})["f"+s]=o,u=`this.f${s}(a)`,l=`this.f${s}(b)`),ffe(u,l,-a,a)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function hfe(e){const t=this;lfe(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function pfe(e){const t=this;if(e.params){const n=t.get(e.id);n||z("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function gfe(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=I(i)?i.map(o=>zO(o,n,t)):zO(i,n,t)}return t}function zO(e,t,n){if(!e||!Q(e))return e;for(let r=0,i=IO.length,o;r<i;++r)if(o=IO[r],ae(e,o.key))return o.parse(e,t,n);return e}var IO=[{key:"$ref",parse:mfe},{key:"$key",parse:vfe},{key:"$expr",parse:yfe},{key:"$field",parse:xfe},{key:"$encode",parse:bfe},{key:"$compare",parse:wfe},{key:"$context",parse:Efe},{key:"$subflow",parse:Sfe},{key:"$tupleid",parse:_fe}];function mfe(e,t){return t.get(e.$ref)||z("Operator not defined: "+e.$ref)}function yfe(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=hr(t.parameterExpression(e.$expr),e.$fields))}function vfe(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=ak(e.$key,e.$flat,t.expr.codegen))}function xfe(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Jr(e.$field,e.$name,t.expr.codegen))}function wfe(e,t){const n="c:"+e.$compare+"_"+e.$order,r=K(e.$compare).map(i=>i&&i.$tupleid?oe:i);return t.fn[n]||(t.fn[n]=ok(r,e.$order,t.expr.codegen))}function bfe(e,t){const n=e.$encode,r={};for(const i in n){const o=n[i];r[i]=hr(t.encodeExpression(o.$expr),o.$fields),r[i].output=o.$output}return r}function Efe(e,t){return t}function Sfe(e,t){const n=e.$subflow;return function(r,i,o){const s=t.fork().parse(n),a=s.get(n.operators[0].id),u=s.signals.parent;return u&&u.set(o),a.detachSubflow=()=>t.detach(s),a}}function _fe(){return oe}function kfe(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(o=>t.get(o)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(o=>t.get(o)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&z("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function $fe(e){var t=this,n=Q(n=e.source)?n.$ref:n,r=t.get(n),i=null,o=e.update,s=void 0;r||z("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(s=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,r,i,o,s)}const Cfe={skip:!0};function Afe(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(o=>{const s=t.signals[o];e.signals(o,s)&&(r[o]=s.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(o=>{const s=t.data[o];e.data(o,s)&&(i[o]=s.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function Ffe(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(o=>{n.update(t.signals[o],i[o],Cfe)}),Object.keys(r||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(ei).insert(r[o]))}),(e.subcontext||[]).forEach((o,s)=>{const a=t.subcontext[s];a&&a.setState(o)})}function R7(e,t,n,r){return new D7(e,t,n,r)}function D7(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||dfe,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function BO(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}D7.prototype=BO.prototype={fork(){const e=new BO(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),cfe(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(r.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),r.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const s=n.data[o]||(n.data[o]={});e.data[o].forEach(a=>s[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[_A(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:sfe,parseOperator:hfe,parseOperatorParameters:pfe,parseParameters:gfe,parseStream:kfe,parseUpdate:$fe,getState:Afe,setState:Ffe};function Mfe(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),P7(t,e.description()))}function P7(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Tfe(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const mw="default";function Nfe(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:mw,item:null}));e.on(e.events("view","pointermove"),t,(n,r)=>{const i=t.value,o=i?Z(i)?i:i.user:mw,s=r.item&&r.item.cursor||null;return i&&o===i.user&&s==i.item?i:{user:o,item:s}}),e.add(null,function(n){let r=n.cursor,i=this.value;return Z(r)||(i=r.item,r=r.user),hS(e,r&&r!==mw?r:i||r),i},{cursor:t})}function hS(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function Y1(e,t){var n=e._runtime.data;return ae(n,t)||z("Unrecognized data set: "+t),n[t]}function Ofe(e,t){return arguments.length<2?Y1(this,e).values.value:zv.call(this,e,Sl().remove(ei).insert(t))}function zv(e,t){ZP(t)||z("Second argument to changes must be a changeset.");const n=Y1(this,e);return n.modified=!0,this.pulse(n.input,t)}function Rfe(e,t){return zv.call(this,e,Sl().insert(t))}function Dfe(e,t){return zv.call(this,e,Sl().remove(t))}function L7(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function z7(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function Iv(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Pfe(e){var t=Iv(e),n=L7(e),r=z7(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(o){e.error(o)}})}function Lfe(e,t,n){var r=e._renderer,i=r&&r.canvas(),o,s,a;return i&&(a=Iv(e),s=t.changedTouches?t.changedTouches[0]:t,o=kv(s,i),o[0]-=a[0],o[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=zfe(e,n,o),t}function zfe(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(s){var a=r,u;if(s){for(u=t;u;u=u.mark.group)if(u.mark.name===s){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function o(s){if(!s)return n;Z(s)&&(s=i(s));const a=n.slice();for(;s;)a[0]-=s.x||0,a[1]-=s.y||0,s=s.mark&&s.mark.group;return a}return{view:Cn(e),item:Cn(t||{}),group:i,xy:o,x:s=>o(s)[0],y:s=>o(s)[1]}}const jO="view",Ife="timer",Bfe="window",jfe={trap:!1};function Ufe(e){const t=pe({defaults:{}},e),n=(r,i)=>{i.forEach(o=>{I(r[o])&&(r[o]=Oi(r[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function I7(e,t,n,r){e._eventListeners.push({type:n,sources:K(t),handler:r})}function Wfe(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function dm(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||Q(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function qfe(e,t,n){var r=this,i=new Xy(n),o=function(l,c){r.runAsync(null,()=>{e===jO&&Wfe(r,t)&&l.preventDefault(),i.receive(Lfe(r,l,c))})},s;if(e===Ife)dm(r,"timer",t)&&r.timer(o,t);else if(e===jO)dm(r,"view",t)&&r.addEventListener(t,o,jfe);else if(e===Bfe?dm(r,"window",t)&&typeof window<"u"&&(s=[window]):typeof document<"u"&&dm(r,"selector",t)&&(s=Array.from(document.querySelectorAll(e))),!s)r.warn("Can not resolve event source: "+e);else{for(var a=0,u=s.length;a<u;++a)s[a].addEventListener(t,o);I7(r,s,t,o)}return i}function UO(e){return e.item}function WO(e){return e.item.mark.source}function qO(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Hfe(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","pointerover",UO),WO,qO(e)),this.on(this.events("view","pointerout",UO),WO,qO(t)),this}function Vfe(){var e=this._tooltip,t=this._timers,n=this._handler.handlers(),r=this._eventListeners,i,o,s,a,u;for(i=t.length;--i>=0;)t[i].stop();for(i=r.length;--i>=0;)for(s=r[i],o=s.sources.length;--o>=0;)s.sources[o].removeEventListener(s.type,s.handler);for(e&&e.call(this,this._handler,null,null,null),i=n.length;--i>=0;)u=n[i].type,a=n[i].handler,this._handler.off(u,a);return this}function $r(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const Gfe="vega-bind",Yfe="vega-bind-name",Xfe="vega-bind-radio";function Qfe(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:s=>{s!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,s)})}},r.debounce&&(i.update=sk(r.debounce,i.update))),(r.input==null&&r.element?Kfe:Jfe)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function Kfe(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),I7(r,t,i,o),e.set=s=>{t.value=s,t.dispatchEvent(Zfe(i))}}function Zfe(e){return typeof Event<"u"?new Event(e):{type:e}}function Jfe(e,t,n,r){const i=r.signal(n.signal),o=$r("div",{class:Gfe}),s=n.input==="radio"?o:o.appendChild($r("label"));s.appendChild($r("span",{class:Yfe},n.name||n.signal)),t.appendChild(o);let a=ede;switch(n.input){case"checkbox":a=tde;break;case"select":a=nde;break;case"radio":a=rde;break;case"range":a=ide;break}a(e,s,n,i)}function ede(e,t,n,r){const i=$r("input");for(const o in n)o!=="signal"&&o!=="element"&&i.setAttribute(o==="input"?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=o=>i.value=o}function tde(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=$r("input",i);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=s=>o.checked=!!s||null}function nde(e,t,n,r){const i=$r("select",{name:n.signal}),o=n.labels||[];n.options.forEach((s,a)=>{const u={value:s};X1(s,r)&&(u.selected=!0),i.appendChild($r("option",u,(o[a]||s)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=s=>{for(let a=0,u=n.options.length;a<u;++a)if(X1(n.options[a],s)){i.selectedIndex=a;return}}}function rde(e,t,n,r){const i=$r("span",{class:Xfe}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map((s,a)=>{const u={type:"radio",name:n.signal,value:s};X1(s,r)&&(u.checked=!0);const l=$r("input",u);l.addEventListener("change",()=>e.update(s));const c=$r("label",{},(o[a]||s)+"");return c.prepend(l),i.appendChild(c),l}),e.set=s=>{const a=e.elements,u=a.length;for(let l=0;l<u;++l)X1(a[l].value,s)&&(a[l].checked=!0)}}function ide(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,s=n.step||$a(o,i,100),a=$r("input",{type:"range",name:n.signal,min:o,max:i,step:s});a.value=r;const u=$r("span",{},+r);t.appendChild(a),t.appendChild(u);const l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function X1(e,t){return e===t||e+""==t+""}function B7(e,t,n,r,i,o){return t=t||new r(e.loader()),t.initialize(n,L7(e),z7(e),Iv(e),i,o).background(e.background())}function kA(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function ode(e,t,n,r){const i=new r(e.loader(),kA(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,Iv(e),e);return t&&t.handlers().forEach(o=>{i.on(o.type,o.handler)}),i}function sde(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=$v(r);e=n._el=e?yw(n,e,!0):null,Mfe(n),o||n.error("Unrecognized renderer type: "+r);const s=o.handler||Qp,a=e?o.renderer:o.headless;return n._renderer=a?B7(n,n._renderer,e,a):null,n._handler=ode(n,n._handler,e,s),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=yw(n,t,!0):e.appendChild($r("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=yw(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{Qfe(n,u.element||t,u)})),n}function yw(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(r){t=null,e.error(r)}return t}const Ed=e=>+e||0,ade=e=>({top:e,bottom:e,left:e,right:e});function HO(e){return Q(e)?{top:Ed(e.top),bottom:Ed(e.bottom),left:Ed(e.left),right:Ed(e.right)}:ade(Ed(e))}async function $A(e,t,n,r){const i=$v(t),o=i&&i.headless;return o||z("Unrecognized renderer type: "+t),await e.runAsync(),B7(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}async function ude(e,t){e!==na.Canvas&&e!==na.SVG&&e!==na.PNG&&z("Unrecognized image type: "+e);const n=await $A(this,e,t);return e===na.SVG?lde(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function lde(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function cde(e,t){return(await $A(this,na.Canvas,e,t)).canvas()}async function fde(e){return(await $A(this,na.SVG,e)).svg()}function dde(e,t,n){return R7(e,Vc,hp,n).parse(t)}function hde(e){var t=this._runtime.scales;return ae(t,e)||z("Unrecognized scale or projection: "+e),t[e].value}var j7="width",U7="height",CA="padding",VO={skip:!0};function W7(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===CA?r.left+r.right:0)}function q7(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===CA?r.top+r.bottom:0)}function pde(e){var t=e._signals,n=t[j7],r=t[U7],i=t[CA];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=W7(e,a.size),o()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=q7(e,a.size),o()},{size:r});const s=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,s.rank=i.rank+1}function gde(e,t,n,r,i,o){this.runAfter(s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal(j7,n,VO),s._resizeWidth.skip(!0)),s.height()!==r&&(a=1,s.signal(U7,r,VO),s._resizeHeight.skip(!0)),s._viewWidth!==e&&(s._resize=1,s._viewWidth=e),s._viewHeight!==t&&(s._resize=1,s._viewHeight=t),(s._origin[0]!==i[0]||s._origin[1]!==i[1])&&(s._resize=1,s._origin=i),a&&s.run("enter"),o&&s.runAfter(u=>u.resize())},!1,1)}function mde(e){return this._runtime.getState(e||{data:yde,signals:vde,recurse:!0})}function yde(e,t){return t.modified&&I(t.input.value)&&!e.startsWith("_:vega:_")}function vde(e,t){return!(e==="parent"||t instanceof Vc.proxy)}function xde(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function wde(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(Koe(n,t))}function bde(e,t,n,r){const i=e.element();i&&i.setAttribute("title",Ede(r))}function Ede(e){return e==null?"":I(e)?H7(e):Q(e)&&!ya(e)?Sde(e):e+""}function Sde(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(I(n)?H7(n):V7(n))}).join(`
`)}function H7(e){return"["+e.map(V7).join(", ")+"]"}function V7(e){return I(e)?"[]":Q(e)&&!ya(e)?"{}":e}function _de(){if(this.renderer()==="canvas"&&this._renderer._canvas){let e=null;const t=()=>{e!=null&&e();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};t()}}function G7(e,t){const n=this;if(t=t||{},_c.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const o=pe({},e.locale,t.locale);n.locale(UP(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||na.Canvas,n._scenegraph=new j8;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||bde,n._redraw=!0,n._handler=new Qp().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Ufe(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=dde(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:pe({},o)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=W7(n,n._width),n._viewHeight=q7(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,pde(n),Tfe(n),Nfe(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio()}function hm(e,t){return ae(e._signals,t)?e._signals[t]:z("Unrecognized signal name: "+V(t))}function Y7(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function GO(e,t,n,r){let i=Y7(n,r);return i||(i=kA(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function YO(e,t,n){const r=Y7(t,n);return r&&t._targets.remove(r),e}G(G7,_c,{async evaluate(e,t,n){if(await _c.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,Pfe(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&jm(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&P7(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=hm(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",HO(e)):HO(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?($v(e)||z("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(_c.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(hm(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:gde,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=kA(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,o;--r>=0;)if(o=n[r].type,i=n[r].handler,e===o&&(t===i||t===i.raw)){this._handler.off(o,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return GO(this,e,hm(this,e),t)},removeSignalListener(e,t){return YO(this,hm(this,e),t)},addDataListener(e,t){return GO(this,e,Y1(this,e).values,t)},removeDataListener(e,t){return YO(this,Y1(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=hS(this,null);this._globalCursor=!!e,t&&hS(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:wde,events:qfe,finalize:Vfe,hover:Hfe,data:Ofe,change:zv,insert:Rfe,remove:Dfe,scale:hde,initialize:sde,toImageURL:ude,toCanvas:cde,toSVG:fde,getState:mde,setState:xde,_watchPixelRatio:_de});const kde="view",Q1="[",K1="]",X7="{",Q7="}",$de=":",K7=",",Cde="@",Ade=">",Fde=/[[\]{}]/,Mde={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Z7,J7;function Ka(e,t,n){return Z7=t||kde,J7=n||Mde,eB(e.trim()).map(pS)}function Tde(e){return J7[e]}function $h(e,t,n,r,i){const o=e.length;let s=0,a;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function eB(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=$h(e,i,K7,Q1+X7,K1+Q7),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function pS(e){return e[0]==="["?Nde(e):Ode(e)}function Nde(e){const t=e.length;let n=1,r;if(n=$h(e,n,K1,Q1,K1),n===t)throw"Empty between selector: "+e;if(r=eB(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Ade)throw"Expected '>' after between selector: "+e;r=r.map(pS);const i=pS(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function Ode(e){const t={source:Z7},n=[];let r=[0,0],i=0,o=0,s=e.length,a=0,u,l;if(e[s-1]===Q7){if(a=e.lastIndexOf(X7),a>=0){try{r=Rde(e.substring(a+1,s-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),s=e.length}else throw"Unmatched right brace: "+e;a=0}if(!s)throw e;if(e[0]===Cde&&(i=++a),u=$h(e,a,$de),u<s&&(n.push(e.substring(o,u).trim()),o=a=++u),a=$h(e,a,Q1),a===s)n.push(e.substring(o,s).trim());else if(n.push(e.substring(o,a).trim()),l=[],o=++a,o===s)throw"Unmatched left bracket: "+e;for(;a<s;){if(a=$h(e,a,K1),a===s)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,a).trim()),a<s-1&&e[++a]!==Q1)throw"Expected left bracket: "+e;o=++a}if(!(s=n.length)||Fde.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],i?t.markname=n[0].slice(1):Tde(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function Rde(e){const t=e.split(K7);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function Dde(e){return Q(e)?e:{type:e||"pad"}}const Sd=e=>+e||0,Pde=e=>({top:e,bottom:e,left:e,right:e});function Lde(e){return Q(e)?e.signal?e:{top:Sd(e.top),bottom:Sd(e.bottom),left:Sd(e.left),right:Sd(e.right)}:Pde(Sd(e))}const Bt=e=>Q(e)&&!I(e)?pe({},e):{value:e};function XO(e,t,n,r){return n!=null?(Q(n)&&!I(n)||I(n)&&n.length&&Q(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function rn(e,t,n){for(const r in t)XO(e,r,t[r]);for(const r in n)XO(e,r,n[r],"update")}function jf(e,t,n){for(const r in t)n&&ae(n,r)||(e[r]=pe(e[r]||{},t[r]));return e}function Zl(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const AA="mark",FA="frame",MA="scope",zde="axis",Ide="axis-domain",Bde="axis-grid",jde="axis-label",Ude="axis-tick",Wde="axis-title",qde="legend",Hde="legend-band",Vde="legend-entry",Gde="legend-gradient",tB="legend-label",Yde="legend-symbol",Xde="legend-title",Qde="title",Kde="title-text",Zde="title-subtitle";function Jde(e,t,n,r,i){const o={},s={};let a,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!Zl(u,e)&&vw(o,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===FA?i.group:n===AA?pe({},i.mark,i[t]):null;for(u in c)l=Zl(u,e)||(u==="fill"||u==="stroke")&&(Zl("fill",e)||Zl("stroke",e)),l||vw(o,u,c[u]);K(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)Zl(h,e)||vw(o,h,d[h])}),e=pe({},e);for(u in o)c=o[u],c.signal?(a=a||{})[u]=c:s[u]=c;return e.enter=pe(s,e.enter),a&&(e.update=pe(a,e.update)),e}function vw(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const nB=e=>Z(e)?V(e):e.signal?`(${e.signal})`:rB(e);function Bv(e){if(e.gradient!=null)return the(e);let t=e.signal?`(${e.signal})`:e.color?ehe(e.color):e.field!=null?rB(e.field):e.value!==void 0?V(e.value):void 0;return e.scale!=null&&(t=nhe(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${o0(e.exponent)})`),e.mult!=null&&(t+=`*${o0(e.mult)}`),e.offset!=null&&(t+=`+${o0(e.offset)}`),e.round&&(t=`round(${t})`),t}const pm=(e,t,n,r)=>`(${e}(${[t,n,r].map(Bv).join(",")})+'')`;function ehe(e){return e.c?pm("hcl",e.h,e.c,e.l):e.h||e.s?pm("hsl",e.h,e.s,e.l):e.l||e.a?pm("lab",e.l,e.a,e.b):e.r||e.g||e.b?pm("rgb",e.r,e.g,e.b):null}function the(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:V(n));for(;t.length&&$e(t)==null;)t.pop();return t.unshift(nB(e.gradient)),`gradient(${t.join(",")})`}function o0(e){return Q(e)?"("+Bv(e)+")":e}function rB(e){return iB(Q(e)?e:{datum:e})}function iB(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):z("Invalid field reference: "+V(e));return e.signal||(r=Z(r)?Co(r).map(V).join("]["):iB(r)),t+"["+r+"]"}function nhe(e,t){const n=nB(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+o0(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function rhe(e){let t="";return e.forEach(n=>{const r=Bv(n);t+=n.test?`(${n.test})?${r}:`:r}),$e(t)===":"&&(t+="null"),t}function oB(e,t,n,r,i,o){const s={};o=o||{},o.encoders={$encode:s},e=Jde(e,t,n,r,i.config);for(const a in e)s[a]=ihe(e[a],t,o,i);return o}function ihe(e,t,n,r){const i={},o={};for(const s in e)e[s]!=null&&(i[s]=she(ohe(e[s]),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function ohe(e){return I(e)?rhe(e):Bv(e)}function she(e,t,n,r){const i=So(e,t);return i.$fields.forEach(o=>r[o]=1),pe(n,i.$params),i.$expr}const ahe="outer",uhe=["value","update","init","react","bind"];function QO(e,t){z(e+' for "outer" push: '+V(t))}function sB(e,t){const n=e.name;if(e.push===ahe)t.signals[n]||QO("No prior signal definition",n),uhe.forEach(r=>{e[r]!==void 0&&QO("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function gS(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function jv(e,t,n,r){return new gS(e,t,n,r)}function Z1(e,t){return jv("operator",e,t)}function ie(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function pp(e,t){return t?{$field:e,$name:t}:{$field:e}}const mS=pp("key");function KO(e,t){return{$compare:e,$order:t}}function lhe(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const che="ascending",fhe="descending";function dhe(e){return Q(e)?(e.order===fhe?"-":"+")+Uv(e.op,e.field):""}function Uv(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const TA="scope",yS="view";function Ft(e){return e&&e.signal}function hhe(e){return e&&e.expr}function s0(e){if(Ft(e))return!0;if(Q(e)){for(const t in e)if(s0(e[t]))return!0}return!1}function vi(e,t){return e??t}function ju(e){return e&&e.signal||e}const ZO="timer";function gp(e,t){return(e.merge?ghe:e.stream?mhe:e.type?yhe:z("Invalid stream specification: "+V(e)))(e,t)}function phe(e){return e===TA?yS:e||yS}function ghe(e,t){const n=e.merge.map(i=>gp(i,t)),r=NA({merge:n},e,t);return t.addStream(r).id}function mhe(e,t){const n=gp(e.stream,t),r=NA({stream:n},e,t);return t.addStream(r).id}function yhe(e,t){let n;e.type===ZO?(n=t.event(ZO,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(phe(e.source),e.type);const r=NA({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function NA(e,t,n){let r=t.between;return r&&(r.length!==2&&z('Stream "between" parameter must have 2 entries: '+V(t)),e.between=[gp(r[0],n),gp(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(vhe(t.marktype,t.markname,t.markrole)),t.source===TA&&r.push("inScope(event.item)"),r.length&&(e.filter=So("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function vhe(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const xhe={code:"_.$value",ast:{type:"Identifier",value:"value"}};function whe(e,t,n){const r=e.encode,i={target:n};let o=e.events,s=e.update,a=[];o||z("Signal update missing events specification."),Z(o)&&(o=Ka(o,t.isSubscope()?TA:yS)),o=K(o).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[Ehe(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),r!=null&&(s&&z("Signal encode and update are mutually exclusive."),s="encode(item(),"+V(r)+")"),i.update=Z(s)?So(s,t):s.expr!=null?So(s.expr,t):s.value!=null?s.value:s.signal!=null?{$expr:xhe,$params:{$value:t.signalRef(s.signal)}}:z("Invalid signal update specification."),e.force&&(i.options={force:!0}),a.forEach(u=>t.addUpdate(pe(bhe(u,t),i)))}function bhe(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):gp(e,t)}}function Ehe(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function She(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?z("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=So(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>whe(i,t,n.id))}const qe=e=>(t,n,r)=>jv(e,n,t||void 0,r),aB=qe("aggregate"),_he=qe("axisticks"),uB=qe("bound"),ji=qe("collect"),JO=qe("compare"),khe=qe("datajoin"),lB=qe("encode"),$he=qe("expression"),Che=qe("facet"),Ahe=qe("field"),Fhe=qe("key"),Mhe=qe("legendentries"),The=qe("load"),Nhe=qe("mark"),Ohe=qe("multiextent"),Rhe=qe("multivalues"),Dhe=qe("overlap"),Phe=qe("params"),cB=qe("prefacet"),Lhe=qe("projection"),zhe=qe("proxy"),Ihe=qe("relay"),fB=qe("render"),Bhe=qe("scale"),Cl=qe("sieve"),jhe=qe("sortitems"),dB=qe("viewlayout"),Uhe=qe("values");let Whe=0;const hB={min:"min",max:"max",count:"sum"};function qhe(e,t){const n=e.type||"linear";Jz(n)||z("Unrecognized scale type: "+V(n)),t.addScale(e.name,{type:n,domain:void 0})}function Hhe(e,t){const n=t.getScale(e.name).params;let r;n.domain=pB(e.domain,e,t),e.range!=null&&(n.range=mB(e,t,n)),e.interpolate!=null&&tpe(e.interpolate,n),e.nice!=null&&(n.nice=epe(e.nice,t)),e.bins!=null&&(n.bins=Jhe(e.bins,t));for(r in e)ae(n,r)||r==="name"||(n[r]=Vr(e[r],t))}function Vr(e,t){return Q(e)?e.signal?t.signalRef(e.signal):z("Unsupported object: "+V(e)):e}function a0(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Vr(n,t))}function Wv(e){z("Can not find data set: "+V(e))}function pB(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&z("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(I(e)?Vhe:e.fields?Yhe:Ghe)(e,t,n)}function Vhe(e,t,n){return e.map(r=>Vr(r,n))}function Ghe(e,t,n){const r=n.getData(e.data);return r||Wv(e.data),Kc(t.type)?r.valuesRef(n,e.field,gB(e.sort,!1)):n8(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Yhe(e,t,n){const r=e.data,i=e.fields.reduce((o,s)=>(s=Z(s)?{data:r,field:s}:I(s)||s.signal?Xhe(s,n):s,o.push(s),o),[]);return(Kc(t.type)?Qhe:n8(t.type)?Khe:Zhe)(e,n,i)}function Xhe(e,t){const n="_:vega:_"+Whe++,r=ji({});if(I(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+V(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Cl({})]),{data:n,field:"data"}}function Qhe(e,t,n){const r=gB(e.sort,!0);let i,o;const s=n.map(l=>{const c=t.getData(l.data);return c||Wv(l.data),c.countsRef(t,l.field,r)}),a={groupby:mS,pulse:s};r&&(i=r.op||"count",o=r.field?Uv(i,r.field):"count",a.ops=[hB[i]],a.fields=[t.fieldRef(o)],a.as=[o]),i=t.add(aB(a));const u=t.add(ji({pulse:ie(i)}));return o=t.add(Uhe({field:mS,sort:t.sortRef(r),pulse:ie(u)})),ie(o)}function gB(e,t){return e&&(!e.field&&!e.op?Q(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?z("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!hB[e.op]&&z("Multiple domain scales can not be sorted using "+e.op)),e}function Khe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||Wv(i.data),o.domainRef(t,i.field)});return ie(t.add(Rhe({values:r})))}function Zhe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||Wv(i.data),o.extentRef(t,i.field)});return ie(t.add(Ohe({extents:r})))}function Jhe(e,t){return e.signal||I(e)?a0(e,t):t.objectProperty(e)}function epe(e,t){return e.signal?t.signalRef(e.signal):Q(e)?{interval:Vr(e.interval),step:Vr(e.step)}:Vr(e)}function tpe(e,t){t.interpolate=Vr(e.type||e),e.gamma!=null&&(t.interpolateGamma=Vr(e.gamma))}function mB(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(Z(i)){if(r&&ae(r,i))return e=pe({},e,{range:r[i]}),mB(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=Kc(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:z("Unrecognized scale range value: "+V(i))}else if(i.scheme){n.scheme=I(i.scheme)?a0(i.scheme,t):Vr(i.scheme,t),i.extent&&(n.schemeExtent=a0(i.extent,t)),i.count&&(n.schemeCount=Vr(i.count,t));return}else if(i.step){n.rangeStep=Vr(i.step,t);return}else{if(Kc(e.type)&&!I(i))return pB(i,e,t);I(i)||z("Unsupported range type: "+V(i))}return i.map(o=>(I(o)?a0:Vr)(o,t))}function npe(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=vS(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=vS(n[i],i,t));t.addProjection(e.name,r)}function vS(e,t,n){return I(e)?e.map(r=>vS(r,t,n)):Q(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:z("Unsupported parameter object: "+V(e)):e}const Ui="top",Uf="left",Wf="right",Ra="bottom",yB="center",rpe="vertical",ipe="start",ope="middle",spe="end",xS="index",OA="label",ape="offset",af="perc",upe="perc2",Xr="value",og="guide-label",RA="guide-title",lpe="group-title",cpe="group-subtitle",eR="symbol",u0="gradient",wS="discrete",bS="size",fpe="shape",dpe="fill",hpe="stroke",ppe="strokeWidth",gpe="strokeDash",mpe="opacity",DA=[bS,fpe,dpe,hpe,ppe,gpe,mpe],sg={name:1,style:1,interactive:1},Ce={value:0},Qr={value:1},qv="group",vB="rect",PA="rule",ype="symbol",Al="text";function mp(e){return e.type=qv,e.interactive=e.interactive||!1,e}function pr(e,t){const n=(r,i)=>vi(e[r],vi(t[r],i));return n.isVertical=r=>rpe===vi(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>vi(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>vi(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>vi(e.columns,vi(t.columns,+n.isVertical(!0))),n}function xB(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function vpe(e,t,n){const r=t.config.style[n];return r&&r[e]}function Hv(e,t,n){return`item.anchor === '${ipe}' ? ${e} : item.anchor === '${spe}' ? ${t} : ${n}`}const LA=Hv(V(Uf),V(Wf),V(yB));function xpe(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},Q(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function wB(e,t){return t?e?Q(e)?Object.assign({},e,{offset:wB(e.offset,t)}):{value:e,offset:t}:t:e}function Nr(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=jf(e.encode,t,sg)):e.interactive=!1,e}function wpe(e,t,n,r){const i=pr(e,n),o=i.isVertical(),s=i.gradientThickness(),a=i.gradientLength();let u,l,c,f,d;o?(l=[0,1],c=[0,0],f=s,d=a):(l=[0,0],c=[1,0],f=a,d=s);const h={enter:u={opacity:Ce,x:Ce,y:Ce,width:Bt(f),height:Bt(d)},update:pe({},u,{opacity:Qr,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:Ce}};return rn(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Nr({type:vB,role:Gde,encode:h},r)}function bpe(e,t,n,r,i){const o=pr(e,n),s=o.isVertical(),a=o.gradientThickness(),u=o.gradientLength();let l,c,f,d,h="";s?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:Ce,fill:{scale:t,field:Xr}};p[l]={signal:h+"datum."+af,mult:u},p[c]=Ce,p[f]={signal:h+"datum."+upe,mult:u},p[d]=Bt(a);const g={enter:p,update:pe({},p,{opacity:Qr}),exit:{opacity:Ce}};return rn(g,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),Nr({type:vB,role:Hde,key:Xr,from:i,encode:g},r)}const Epe=`datum.${af}<=0?"${Uf}":datum.${af}>=1?"${Wf}":"${yB}"`,Spe=`datum.${af}<=0?"${Ra}":datum.${af}>=1?"${Ui}":"${ope}"`;function tR(e,t,n,r){const i=pr(e,t),o=i.isVertical(),s=Bt(i.gradientThickness()),a=i.gradientLength();let u=i("labelOverlap"),l,c,f,d,h="";const p={enter:l={opacity:Ce},update:c={opacity:Qr,text:{field:OA}},exit:{opacity:Ce}};return rn(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:vi(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=c.baseline={signal:Spe},f="y",d="x",h="1-"):(l.align=c.align={signal:Epe},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+af,mult:a},l[d]=c[d]=s,s.offset=vi(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+xS}:void 0,Nr({type:Al,role:tB,style:og,key:Xr,from:r,encode:p,overlap:u},n)}function _pe(e,t,n,r,i){const o=pr(e,t),s=n.entries,a=!!(s&&s.interactive),u=s?s.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${ape} : datum.${bS}`,h=l?Bt(l):{field:bS},p=`datum.${xS}`,g=`max(1, ${i})`;let y,m,v,x,w;h.mult=.5,y={enter:m={opacity:Ce,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Qr,x:m.x,y:m.y},exit:{opacity:Ce}};let b=null,S=null;e.fill||(b=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),rn(y,{fill:o("symbolFillColor",b),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",S),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),DA.forEach($=>{e[$]&&(v[$]=m[$]={scale:e[$],field:Xr})});const E=Nr({type:ype,role:Yde,key:Xr,from:f,clip:l?!0:void 0,encode:y},n.symbols),_=Bt(c);_.offset=o("labelOffset"),y={enter:m={opacity:Ce,x:{signal:d,offset:_},y:h},update:v={opacity:Qr,text:{field:OA},x:m.x,y:m.y},exit:{opacity:Ce}},rn(y,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const k=Nr({type:Al,role:tB,style:og,key:Xr,from:f,encode:y},n.labels);return y={enter:{noBound:{value:!l},width:Ce,height:l?Bt(l):Ce,opacity:Ce},exit:{opacity:Ce},update:v={opacity:Qr,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(x=`ceil(item.mark.items.length / ${g})`,v.row.signal=`${p}%${x}`,v.column.signal=`floor(${p} / ${x})`,w={field:["row",p]}):(v.row.signal=`floor(${p} / ${g})`,v.column.signal=`${p} % ${g}`,w={field:p}),v.column.signal=`(${i})?${v.column.signal}:${p}`,r={facet:{data:r,name:"value",groupby:xS}},mp({role:MA,from:r,encode:jf(y,s,sg),marks:[E,k],name:u,interactive:a,sort:w})}function kpe(e,t){const n=pr(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const zA='item.orient === "left"',IA='item.orient === "right"',Vv=`(${zA} || ${IA})`,$pe=`datum.vgrad && ${Vv}`,Cpe=Hv('"top"','"bottom"','"middle"'),Ape=Hv('"right"','"left"','"center"'),Fpe=`datum.vgrad && ${IA} ? (${Ape}) : (${Vv} && !(datum.vgrad && ${zA})) ? "left" : ${LA}`,Mpe=`item._anchor || (${Vv} ? "middle" : "start")`,Tpe=`${$pe} ? (${zA} ? -90 : 90) : 0`,Npe=`${Vv} ? (datum.vgrad ? (${IA} ? "bottom" : "top") : ${Cpe}) : "top"`;function Ope(e,t,n,r){const i=pr(e,t),o={enter:{opacity:Ce},update:{opacity:Qr,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Ce}};return rn(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:Mpe},angle:{signal:Tpe},align:{signal:Fpe},baseline:{signal:Npe},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Nr({type:Al,role:Xde,style:RA,from:r,encode:o},n)}function Rpe(e,t){let n;return Q(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+nR(e.path)+")":e.sphere&&(n="geoShape("+nR(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function nR(e){return Q(e)&&e.signal?e.signal:V(e)}function bB(e){const t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===qv?MA:t||AA}function Dpe(e){return{marktype:e.type,name:e.name||void 0,role:e.role||bB(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Ppe(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function BA(e,t){const n=tL(e.type);n||z("Unrecognized transform type: "+V(e.type));const r=jv(n.type.toLowerCase(),null,EB(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function EB(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const s=e.params[o];r[s.name]=Lpe(s,t,n)}return r}function Lpe(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return zpe(e,t,n);if(i===void 0){e.required&&z("Missing required "+V(t.type)+" parameter: "+V(e.name));return}else{if(r==="param")return Ipe(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!Ft(i)?i.map(o=>rR(e,o,n)):rR(e,i,n)}function rR(e,t,n){const r=e.type;if(Ft(t))return oR(r)?z("Expression references can not be signals."):xw(r)?n.fieldRef(t):sR(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||xw(r);return i&&Bpe(t)?n.exprRef(t.expr,t.as):i&&jpe(t)?pp(t.field,t.as):oR(r)?So(t,n):Upe(r)?ie(n.getData(t).values):xw(r)?pp(t):sR(r)?n.compareRef(t):t}}function zpe(e,t,n){return Z(t.from)||z('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Ipe(e,t,n){const r=t[e.name];return e.array?(I(r)||z("Expected an array of sub-parameters. Instead: "+V(r)),r.map(i=>iR(e,i,n))):iR(e,r,n)}function iR(e,t,n){const r=e.params.length;let i;for(let s=0;s<r;++s){i=e.params[s];for(const a in i.key)if(i.key[a]!==t[a]){i=null;break}if(i)break}i||z("Unsupported parameter: "+V(t));const o=pe(EB(i,t,n),i.key);return ie(n.add(Phe(o)))}const Bpe=e=>e&&e.expr,jpe=e=>e&&e.field,Upe=e=>e==="data",oR=e=>e==="expr",xw=e=>e==="field",sR=e=>e==="compare";function Wpe(e,t,n){let r,i,o,s,a;return e?(r=e.facet)&&(t||z("Only group marks can be faceted."),r.field!=null?s=a=l0(r,n):(e.data?a=ie(n.getData(e.data).aggregate):(o=BA(pe({type:"aggregate",groupby:K(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=l0(r,n),s=a=ie(n.add(o))),i=n.keyRef(r.groupby,!0))):s=ie(n.add(ji(null,[{}]))),s||(s=l0(e,n)),{key:i,pulse:s,parent:a}}function l0(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ie(t.getData(e.data).output)}function ul(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}ul.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],s=null,a=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=ie(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(s=t[a]);return new ul(e,o,i,r,s)};function SB(e){return Z(e)?e:null}function aR(e,t,n){const r=Uv(n.op,n.field);let i;if(t.ops){for(let o=0,s=t.as.length;o<s;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function _d(e,t,n,r,i,o,s){const a=t[n]||(t[n]={}),u=dhe(o);let l=SB(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=a[l]),!c){const d=o?{field:mS,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:ie(t.output)};u&&(d.sort=e.sortRef(o)),f=e.add(jv(r,void 0,d)),s&&(t.index[i]=f),c=ie(f),l!=null&&(a[l]=c)}return c}ul.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),o=SB(t);let s,a,u;return o!=null&&(e=r.scope,s=i[o]),s?n&&n.field&&aR(e,s.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ie(r.output)},n&&n.field&&aR(e,u,n),a=e.add(aB(u)),s=e.add(ji({pulse:ie(a)})),s={agg:a,ref:ie(s)},o!=null&&(i[o]=s)),s.ref},tuplesRef(){return ie(this.values)},extentRef(e,t){return _d(e,this,"extent","extent",t,!1)},domainRef(e,t){return _d(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return _d(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return _d(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return _d(e,this,"indata","tupleindex",t,!0,!0)}};function qpe(e,t,n){const r=e.from.facet,i=r.name,o=l0(r,t);let s;r.name||z("Facet must have a name: "+V(r)),r.data||z("Facet must reference a data set: "+V(r)),r.field?s=t.add(cB({field:t.fieldRef(r.field),pulse:o})):r.groupby?s=t.add(Che({key:t.keyRef(r.groupby),group:ie(t.proxy(n.parent)),pulse:o})):z("Facet must specify groupby or field: "+V(r));const a=t.fork(),u=a.add(ji()),l=a.add(Cl({pulse:ie(u)}));a.addData(i,new ul(a,u,u,l)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(e).toRuntime()}}function Hpe(e,t,n){const r=t.add(cB({pulse:n.pulse})),i=t.fork();i.add(Cl()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function _B(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,s=e.modify,a=e.values,u=t.add(Z1()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,o,s,a].map(f=>f??"null").join(",")+"),0)",c=So(l,t);u.update=c.$expr,u.params=c.$params}function Gv(e,t){const n=bB(e),r=e.type===qv,i=e.from&&e.from.facet,o=e.overlap;let s=e.layout||n===MA||n===FA,a,u,l,c,f,d,h;const p=n===AA||s||i,g=Wpe(e.from,r,t);u=t.add(khe({key:g.key||(e.key?pp(e.key):void 0),pulse:g.pulse,clean:!r}));const y=ie(u);u=l=t.add(ji({pulse:y})),u=t.add(Nhe({markdef:Dpe(e),interactive:Ppe(e.interactive,t),clip:Rpe(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ie(u)}));const m=ie(u);u=c=t.add(lB(oB(e.encode,e.type,n,e.style,t,{mod:!1,pulse:m}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(S=>{const E=BA(S,t),_=E.metadata;(_.generates||_.changes)&&z("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),E.params.pulse=ie(u),t.add(u=E)}),e.sort&&(u=t.add(jhe({sort:t.compareRef(e.sort),pulse:ie(u)})));const v=ie(u);(i||s)&&(s=t.add(dB({layout:t.objectProperty(e.layout),legends:t.legends,mark:m,pulse:v})),d=ie(s));const x=t.add(uB({mark:m,pulse:d||v}));h=ie(x),r&&(p&&(a=t.operators,a.pop(),s&&a.pop()),t.pushState(v,d||h,y),i?qpe(e,t,g):p?Hpe(e,t,g):t.parse(e),t.popState(),p&&(s&&a.push(s),a.push(x))),o&&(h=Vpe(o,h,t));const w=t.add(fB({pulse:h})),b=t.add(Cl({pulse:ie(w)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new ul(t,l,w,b)),e.on&&e.on.forEach(S=>{(S.insert||S.remove||S.toggle)&&z("Marks only support modify triggers."),_B(S,t,f)}))}function Vpe(e,t,n){const r=e.method,i=e.bound,o=e.separation,s={separation:Ft(o)?n.signalRef(o.signal):o,method:Ft(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(s.sort=n.compareRef({field:e.order})),i){const a=i.tolerance;s.boundTolerance=Ft(a)?n.signalRef(a.signal):+a,s.boundScale=n.scaleRef(i.scale),s.boundOrient=i.orient}return ie(n.add(Dhe(s)))}function Gpe(e,t){const n=t.config.legend,r=e.encode||{},i=pr(e,n),o=r.legend||{},s=o.name||void 0,a=o.interactive,u=o.style,l={};let c=0,f,d,h;DA.forEach(x=>e[x]?(l[x]=e[x],c=c||e[x]):0),c||z("Missing valid scale for legend.");const p=Ype(e,t.scaleType(c)),g={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&i.isVertical()},y=ie(t.add(ji(null,[g]))),m={enter:{x:{value:0},y:{value:0}}},v=ie(t.add(Mhe(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===u0?(h=[wpe(e,c,n,r.gradient),tR(e,n,r.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${ju(i.gradientLength())})/100))`)):p===wS?h=[bpe(e,c,n,r.gradient,v),tR(e,n,r.labels,v)]:(f=kpe(e,n),h=[_pe(e,n,r,v,ju(f.columns))],d.size=Kpe(e,t,h[0].marks)),h=[mp({role:Vde,from:y,encode:m,marks:h,layout:f,interactive:a})],g.title&&h.push(Ope(e,n,r.title,y)),Gv(mp({role:qde,from:y,encode:jf(Qpe(i,e,n),o,sg),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:a,style:u}),t)}function Ype(e,t){let n=e.type||eR;return!e.type&&Xpe(e)===1&&(e.fill||e.stroke)&&(n=I$(t)?u0:dE(t)?wS:eR),n!==u0?n:dE(t)?wS:u0}function Xpe(e){return DA.reduce((t,n)=>t+(e[n]?1:0),0)}function Qpe(e,t,n){const r={enter:{},update:{}};return rn(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function Kpe(e,t,n){const r=ju(uR("size",e,n)),i=ju(uR("strokeWidth",e,n)),o=ju(Zpe(n[1].encode,t,og));return So(`max(ceil(sqrt(${r})+${i}),${o})`,t)}function uR(e,t,n){return t[e]?`scale("${t[e]}",datum)`:xB(e,n[0].encode)}function Zpe(e,t,n){return xB("fontSize",e)||vpe("fontSize",t,n)}const Jpe=`item.orient==="${Uf}"?-90:item.orient==="${Wf}"?90:0`;function ege(e,t){e=Z(e)?{text:e}:e;const n=pr(e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,s=i.interactive,a=i.style,u=[],l={},c=ie(t.add(ji(null,[l])));return u.push(rge(e,n,tge(e),c)),e.subtitle&&u.push(ige(e,n,r.subtitle,c)),Gv(mp({role:Qde,from:c,encode:nge(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),t)}function tge(e){const t=e.encode;return t&&t.title||pe({name:e.name,interactive:e.interactive,style:e.style},t)}function nge(e,t){const n={enter:{},update:{}};return rn(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:LA},angle:{signal:Jpe},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),jf(n,t,sg)}function rge(e,t,n,r){const i={value:0},o=e.text,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return rn(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Nr({type:Al,role:Kde,style:lpe,from:r,encode:s},n)}function ige(e,t,n,r){const i={value:0},o=e.subtitle,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return rn(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Nr({type:Al,role:Zde,style:cpe,from:r,encode:s},n)}function oge(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(BA(r,t))}),e.on&&e.on.forEach(r=>{_B(r,t,e.name)}),t.addDataPipeline(e.name,sge(e,t,n))}function sge(e,t,n){const r=[];let i=null,o=!1,s=!1,a,u,l,c,f;for(e.values?Ft(e.values)||s0(e.format)?(r.push(lR(t,e)),r.push(i=uu())):r.push(i=uu({$ingest:e.values,$format:e.format})):e.url?s0(e.url)||s0(e.format)?(r.push(lR(t,e)),r.push(i=uu())):r.push(i=uu({$request:e.url,$format:e.format})):e.source&&(i=a=K(e.source).map(d=>ie(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=uu()),r.push(c),f.generates&&(s=!0),f.modifies&&!s&&(o=!0),f.source?i=c:f.changes&&(i=null);return a&&(l=a.length-1,r[0]=Ihe({derive:o,pulse:l?a:a[0]}),(o||l)&&r.splice(1,0,uu())),i||r.push(uu()),r.push(Cl({})),r}function uu(e){const t=ji({},e);return t.metadata={source:!0},t}function lR(e,t){return The({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const kB=e=>e===Ra||e===Ui,Yv=(e,t,n)=>Ft(e)?cge(e.signal,t,n):e===Uf||e===Ui?t:n,jt=(e,t,n)=>Ft(e)?uge(e.signal,t,n):kB(e)?t:n,Mi=(e,t,n)=>Ft(e)?lge(e.signal,t,n):kB(e)?n:t,$B=(e,t,n)=>Ft(e)?fge(e.signal,t,n):e===Ui?{value:t}:{value:n},age=(e,t,n)=>Ft(e)?dge(e.signal,t,n):e===Wf?{value:t}:{value:n},uge=(e,t,n)=>CB(`${e} === '${Ui}' || ${e} === '${Ra}'`,t,n),lge=(e,t,n)=>CB(`${e} !== '${Ui}' && ${e} !== '${Ra}'`,t,n),cge=(e,t,n)=>jA(`${e} === '${Uf}' || ${e} === '${Ui}'`,t,n),fge=(e,t,n)=>jA(`${e} === '${Ui}'`,t,n),dge=(e,t,n)=>jA(`${e} === '${Wf}'`,t,n),CB=(e,t,n)=>(t=t!=null?Bt(t):t,n=n!=null?Bt(n):n,cR(t)&&cR(n)?(t=t?t.signal||V(t.value):null,n=n?n.signal||V(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[pe({test:e},t)].concat(n||[])),cR=e=>e==null||Object.keys(e).length===1,jA=(e,t,n)=>({signal:`${e} ? (${yc(t)}) : (${yc(n)})`}),hge=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${Uf}' ? (${yc(r)}) : `:"")+(n!=null?`${e} === '${Ra}' ? (${yc(n)}) : `:"")+(i!=null?`${e} === '${Wf}' ? (${yc(i)}) : `:"")+(t!=null?`${e} === '${Ui}' ? (${yc(t)}) : `:"")+"(null)"}),yc=e=>Ft(e)?e.signal:e==null?null:V(e),pge=(e,t)=>t===0?0:Ft(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},Ac=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Vl(e,t,n,r){let i;if(t&&ae(t,e))return t[e];if(ae(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[RA][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[og][i]}return null}function fR(e){const t={};for(const n of e)if(n)for(const r in n)t[r]=1;return Object.keys(t)}function gge(e,t){var n=t.config,r=n.style,i=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,s=e.orient,a,u,l;if(Ft(s)){const f=fR([n.axisX,n.axisY]),d=fR([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(l of f)a[l]=jt(s,Vl(l,n.axisX,i,r),Vl(l,n.axisY,i,r));u={};for(l of d)u[l]=hge(s.signal,Vl(l,n.axisTop,i,r),Vl(l,n.axisBottom,i,r),Vl(l,n.axisLeft,i,r),Vl(l,n.axisRight,i,r))}else a=s===Ui||s===Ra?n.axisX:n.axisY,u=n["axis"+s[0].toUpperCase()+s.slice(1)];return a||u||o?pe({},i,a,u,o):i}function mge(e,t,n,r){const i=pr(e,t),o=e.orient;let s,a;const u={enter:s={opacity:Ce},update:a={opacity:Qr},exit:{opacity:Ce}};rn(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=dR(e,0),c=dR(e,1);return s.x=a.x=jt(o,l,Ce),s.x2=a.x2=jt(o,c),s.y=a.y=Mi(o,l,Ce),s.y2=a.y2=Mi(o,c),Nr({type:PA,role:Ide,from:r,encode:u},n)}function dR(e,t){return{scale:e.scale,range:t}}function yge(e,t,n,r,i){const o=pr(e,t),s=e.orient,a=e.gridScale,u=Yv(s,1,-1),l=vge(e.offset,u);let c,f,d;const h={enter:c={opacity:Ce},update:d={opacity:Qr},exit:f={opacity:Ce}};rn(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:e.scale,field:Xr,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},g=jt(s,{signal:"height"},{signal:"width"}),y=a?{scale:a,range:0,mult:u,offset:l}:{value:0,offset:l},m=a?{scale:a,range:1,mult:u,offset:l}:pe(g,{mult:u,offset:l});return c.x=d.x=jt(s,p,y),c.y=d.y=Mi(s,p,y),c.x2=d.x2=Mi(s,m),c.y2=d.y2=jt(s,m),f.x=jt(s,p),f.y=Mi(s,p),Nr({type:PA,role:Bde,key:Xr,from:r,encode:h},n)}function vge(e,t){if(t!==1)if(!Q(e))e=Ft(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=pe({},e);for(;n.mult!=null;)if(Q(n.mult))n=n.mult=pe({},n.mult);else return n.mult=Ft(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function xge(e,t,n,r,i,o){const s=pr(e,t),a=e.orient,u=Yv(a,-1,1);let l,c,f;const d={enter:l={opacity:Ce},update:f={opacity:Qr},exit:c={opacity:Ce}};rn(d,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const h=Bt(i);h.mult=u;const p={scale:e.scale,field:Xr,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return f.y=l.y=jt(a,Ce,p),f.y2=l.y2=jt(a,h),c.x=jt(a,p),f.x=l.x=Mi(a,Ce,p),f.x2=l.x2=Mi(a,h),c.y=Mi(a,p),Nr({type:PA,role:Ude,key:Xr,from:r,encode:d},n)}function ww(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function wge(e,t,n,r,i,o){const s=pr(e,t),a=e.orient,u=e.scale,l=Yv(a,-1,1),c=ju(s("labelFlush")),f=ju(s("labelFlushOffset")),d=s("labelAlign"),h=s("labelBaseline");let p=c===0||!!c,g;const y=Bt(i);y.mult=l,y.offset=Bt(s("labelPadding")||0),y.offset.mult=l;const m={scale:u,field:Xr,band:.5,offset:wB(o.offset,s("labelOffset"))},v=jt(a,p?ww(u,c,'"left"','"right"','"center"'):{value:"center"},age(a,"left","right")),x=jt(a,$B(a,"bottom","top"),p?ww(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),w=ww(u,c,`-(${f})`,f,0);p=p&&f;const b={opacity:Ce,x:jt(a,m,y),y:Mi(a,m,y)},S={enter:b,update:g={opacity:Qr,text:{field:OA},x:b.x,y:b.y,align:v,baseline:x},exit:{opacity:Ce,x:b.x,y:b.y}};rn(S,{dx:!d&&p?jt(a,w):null,dy:!h&&p?Mi(a,w):null}),rn(S,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:d,baseline:h});const E=s("labelBound");let _=s("labelOverlap");return _=_||E?{separation:s("labelSeparation"),method:_,order:"datum.index",bound:E?{scale:u,orient:a,tolerance:E}:null}:void 0,g.align!==v&&(g.align=Ac(g.align,v)),g.baseline!==x&&(g.baseline=Ac(g.baseline,x)),Nr({type:Al,role:jde,style:og,key:Xr,from:r,encode:S,overlap:_},n)}function bge(e,t,n,r){const i=pr(e,t),o=e.orient,s=Yv(o,-1,1);let a,u;const l={enter:a={opacity:Ce,anchor:Bt(i("titleAnchor",null)),align:{signal:LA}},update:u=pe({},a,{opacity:Qr,text:Bt(e.title)}),exit:{opacity:Ce}},c={signal:`lerp(range("${e.scale}"), ${Hv(0,1,.5)})`};return u.x=jt(o,c),u.y=Mi(o,c),a.angle=jt(o,Ce,pge(s,90)),a.baseline=jt(o,$B(o,Ra,Ui),{value:Ra}),u.angle=a.angle,u.baseline=a.baseline,rn(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),Ege(i,o,l,n),l.update.align=Ac(l.update.align,a.align),l.update.angle=Ac(l.update.angle,a.angle),l.update.baseline=Ac(l.update.baseline,a.baseline),Nr({type:Al,role:Wde,style:RA,from:r,encode:l},n)}function Ege(e,t,n,r){const i=(a,u)=>a!=null?(n.update[u]=Ac(Bt(a),n.update[u]),!1):!Zl(u,r),o=i(e("titleX"),"x"),s=i(e("titleY"),"y");n.enter.auto=s===o?Bt(s):jt(t,Bt(s),Bt(o))}function Sge(e,t){const n=gge(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,s=i.interactive,a=i.style,u=pr(e,n),l=xpe(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ie(t.add(ji({},[c]))),d=ie(t.add(_he({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(yge(e,n,r.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(xge(e,n,r.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(wge(e,n,r.labels,d,p,l))),c.domain&&h.push(mge(e,n,r.domain,f)),c.title&&h.push(bge(e,n,r.title,f)),Gv(mp({role:zde,from:f,encode:jf(_ge(u,e),i,sg),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:s,style:a}),t)}function _ge(e,t){const n={enter:{},update:{}};return rn(n,{orient:e("orient"),offset:e("offset")||0,position:vi(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function AB(e,t,n){const r=K(e.signals),i=K(e.scales);return n||r.forEach(o=>sB(o,t)),K(e.projections).forEach(o=>npe(o,t)),i.forEach(o=>qhe(o,t)),K(e.data).forEach(o=>oge(o,t)),i.forEach(o=>Hhe(o,t)),(n||r).forEach(o=>She(o,t)),K(e.axes).forEach(o=>Sge(o,t)),K(e.marks).forEach(o=>Gv(o,t)),K(e.legends).forEach(o=>Gpe(o,t)),e.title&&ege(e.title,t),t.parseLambdas(),t}const kge=e=>jf({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function $ge(e,t){const n=t.config,r=ie(t.root=t.add(Z1())),i=Cge(e,n);i.forEach(l=>sB(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(ji()),s=t.add(lB(oB(kge(e.encode),qv,FA,e.style,t,{pulse:ie(o)}))),a=t.add(dB({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:ie(s)}));t.operators.pop(),t.pushState(ie(s),ie(a),null),AB(e,t,i),t.operators.push(a);let u=t.add(uB({mark:r,pulse:ie(a)}));return u=t.add(fB({pulse:ie(u)})),u=t.add(Cl({pulse:ie(u)})),t.addData("root",new ul(t,o,o,u)),t}function kd(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Cge(e,t){const n=s=>vi(e[s],t[s]),r=[kd("background",n("background")),kd("autosize",Dde(n("autosize"))),kd("padding",Lde(n("padding"))),kd("width",n("width")||0),kd("height",n("height")||0)],i=r.reduce((s,a)=>(s[a.name]=a,s),{}),o={};return K(e.signals).forEach(s=>{ae(i,s.name)?s=pe(i[s.name],s):r.push(s),o[s.name]=s}),K(t.signals).forEach(s=>{!ae(o,s.name)&&!ae(i,s.name)&&r.push(s)}),r}function FB(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function hR(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}FB.prototype=hR.prototype={parse(e){return AB(e,this)},fork(){return new hR(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof gS?ie(e):e;return this.add(zhe({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,o){let s,a;r&&(s=r.data||(r.data={}),a=s[i]||(s[i]=[]),a.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(ie(this.add(Cl({pulse:e})))),this._parent.push(t),this._lookup.push(n?ie(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return $e(this._parent)},encode(){return $e(this._encode)},lookup(){return $e(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Z(e))return pp(e,t);e.signal||z("Unsupported field reference: "+V(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=ie(this.add(Ahe(i)))}return r},compareRef(e){let t=!1;const n=o=>Ft(o)?(t=!0,this.signalRef(o.signal)):hhe(o)?(t=!0,this.exprRef(o.expr)):o,r=K(e.field).map(n),i=K(e.order).map(n);return t?ie(this.add(JO({fields:r,orders:i}))):KO(r,i)},keyRef(e,t){let n=!1;const r=o=>Ft(o)?(n=!0,ie(i[o.signal])):o,i=this.signals;return e=K(e).map(r),n?ie(this.add(Fhe({fields:e,flat:t}))):lhe(e,t)},sortRef(e){if(!e)return e;const t=Uv(e.op,e.field),n=e.order||che;return n.signal?ie(this.add(JO({fields:t,orders:this.signalRef(n.signal)}))):KO(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return ae(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&z("Duplicate signal name: "+V(e));const n=t instanceof gS?t:this.add(Z1(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||z("Unrecognized signal name: "+V(e)),this.signals[e]},signalRef(e){return this.signals[e]?ie(this.signals[e]):(ae(this.lambdas,e)||(this.lambdas[e]=this.add(Z1(null))),ie(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=So(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Q(e)?e:this.signalRef(e.signal||UA(e))},exprRef(e,t){const n={expr:So(e,this)};return t&&(n.expr.$name=t),ie(this.add($he(n)))},addBinding(e,t){this.bindings||z("Nested signals do not support binding: "+V(e)),this.bindings.push(pe({signal:e},t))},addScaleProj(e,t){ae(this.scales,e)&&z("Duplicate scale or projection name: "+V(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Bhe(t))},addProjection(e,t){this.addScaleProj(e,Lhe(t))},getScale(e){return this.scales[e]||z("Unrecognized scale name: "+V(e)),this.scales[e]},scaleRef(e){return ie(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ae(this.data,e)&&z("Duplicate data set name: "+V(e)),this.data[e]=t},getData(e){return this.data[e]||z("Undefined data set name: "+V(e)),this.data[e]},addDataPipeline(e,t){return ae(this.data,e)&&z("Duplicate data set name: "+V(e)),this.addData(e,ul.fromEntries(this,t))}};function UA(e){return(I(e)?Age:Fge)(e)}function Age(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(Q(i)?i.signal||UA(i):V(i))}return n+"]"}function Fge(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+V(r)+":"+(Q(i)?i.signal||UA(i):V(i));return t+"}"}function Mge(){const e="sans-serif",r="#4c78a8",i="#000",o="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:s},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function Tge(e,t,n){return Q(e)||z("Input Vega specification must be an object."),t=Af(Mge(),t,e.config),$ge(e,new FB(t,n)).toRuntime()}var Nge="5.30.0";pe(Vc,CK,ire,Pre,boe,gse,Uae,bae,qae,pue,_ue,Tue);const Oge=Object.freeze(Object.defineProperty({__proto__:null,Bounds:Et,CanvasHandler:Qp,CanvasRenderer:d1,DATE:ur,DAY:yn,DAYOFYEAR:bo,Dataflow:_c,Debug:S6,Error:J_,EventStream:Xy,Gradient:y8,GroupItem:vv,HOURS:Fr,Handler:cC,HybridHandler:uI,HybridRenderer:SE,Info:E6,Item:yv,MILLISECONDS:Ri,MINUTES:Mr,MONTH:En,Marks:Tr,MultiPulse:_k,None:b6,Operator:He,Parameters:Yy,Pulse:xa,QUARTER:ar,RenderType:na,Renderer:Xp,ResourceLoader:_8,SECONDS:ti,SVGHandler:X8,SVGRenderer:mC,SVGStringRenderer:aI,Scenegraph:j8,TIME_UNITS:pk,Transform:D,View:G7,WEEK:Ct,Warn:ek,YEAR:en,accessor:hr,accessorFields:bn,accessorName:gt,array:K,ascending:Ly,bandwidthNRD:Ak,bin:iL,bootstrapCI:oL,boundClip:vI,boundContext:Hp,boundItem:vE,boundMark:L8,boundStroke:Ss,changeset:Sl,clampRange:R6,codegenExpression:w7,compare:ok,constant:Cn,cumulativeLogNormal:Rk,cumulativeNormal:Ky,cumulativeUniform:zk,dayofyear:fP,debounce:sk,defaultLocale:xk,definition:tL,densityLogNormal:Ok,densityNormal:Fk,densityUniform:Lk,domChild:kt,domClear:jr,domCreate:ea,domFind:lC,dotbin:sL,error:z,expressionFunction:wt,extend:pe,extent:vo,extentIndex:D6,falsy:Ps,fastmap:Mf,field:Jr,flush:P6,font:Sv,fontFamily:Yp,fontSize:Mo,format:Bm,formatLocale:q0,formats:Ek,hasOwnProperty:ae,id:Mp,identity:$n,inferType:qP,inferTypes:HP,ingest:De,inherits:G,inrange:dc,interpolate:B$,interpolateColors:gv,interpolateRange:r8,intersect:pI,intersectBoxLine:hc,intersectPath:Y$,intersectPoint:X$,intersectRule:$8,isArray:I,isBoolean:Ha,isDate:ya,isFunction:ge,isIterable:L6,isNumber:Ae,isObject:Q,isRegExp:z6,isString:Z,isTuple:Vy,key:ak,lerp:I6,lineHeight:Ta,loader:qy,locale:UP,logger:tk,lruCache:B6,markup:gC,merge:j6,mergeConfig:Af,multiLineOffset:sC,one:Cf,pad:U6,panLinear:A6,panLog:F6,panPow:M6,panSymlog:T6,parse:Tge,parseExpression:gA,parseSelector:Ka,path:nv,pathCurves:H$,pathEqual:xI,pathParse:Zc,pathRectangle:w8,pathRender:np,pathSymbols:x8,pathTrail:b8,peek:$e,point:kv,projection:DC,quantileLogNormal:Dk,quantileNormal:Zy,quantileUniform:Ik,quantiles:$k,quantizeInterpolator:i8,quarter:N6,quartiles:Ck,get random(){return ni},randomInteger:TQ,randomKDE:Tk,randomLCG:MQ,randomLogNormal:uL,randomMixture:lL,randomNormal:Mk,randomUniform:cL,read:YP,regressionConstant:Bk,regressionExp:dL,regressionLinear:jk,regressionLoess:gL,regressionLog:fL,regressionPoly:pL,regressionPow:hL,regressionQuad:Uk,renderModule:$v,repeat:Pd,resetDefaultLocale:CX,resetSVGClipId:S8,resetSVGDefIds:Ene,responseType:GP,runtimeContext:R7,sampleCurve:ev,sampleLogNormal:Nk,sampleNormal:Qy,sampleUniform:Pk,scale:Oe,sceneEqual:yC,sceneFromJSON:I8,scenePickVisit:i1,sceneToJSON:z8,sceneVisit:Di,sceneZOrder:Q$,scheme:j$,serializeXML:rI,setHybridRendererOptions:vne,setRandom:AQ,span:Tp,splitAccessPath:Co,stringValue:V,textMetrics:kr,timeBin:AP,timeFloor:vP,timeFormatLocale:Qh,timeInterval:Rf,timeOffset:bP,timeSequence:_P,timeUnitSpecifier:cP,timeUnits:gk,toBoolean:uk,toDate:lk,toNumber:vn,toSet:Oi,toString:ck,transform:nL,transforms:Vc,truncate:W6,truthy:ei,tupleid:oe,typeParsers:eE,utcFloor:xP,utcInterval:Df,utcOffset:EP,utcSequence:kP,utcdayofyear:pP,utcquarter:O6,utcweek:gP,version:Nge,visitArray:js,week:dP,writeConfig:Ff,zero:Ys,zoomLinear:nk,zoomLog:rk,zoomPow:z0,zoomSymlog:ik},Symbol.toStringTag,{value:"Module"}));function Rge(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var Dge={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},Pge={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},Lge={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const zge=Array.prototype.slice,lu=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,zge.call(t,1))},Ige=(e,t,n,r,i,o,s)=>new Date(e,t||0,n??1,r||0,i||0,o||0,s||0);var Bge={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:Ige,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return lu("join",arguments)},indexof:function(){return lu("indexOf",arguments)},lastindexof:function(){return lu("lastIndexOf",arguments)},slice:function(){return lu("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return lu("substring",arguments,String)},split:function(){return lu("split",arguments,String)},replace:function(){return lu("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const jge=["view","item","group","xy","x","y"],ES=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&ES.add(setImmediate);const Uge={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:Dge[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const i=e(t.property);if(n&&(e.memberDepth-=1),ES.has(r[i])){console.error(`Prevented interpretation of member "${i}" which could lead to insecure code execution`);return}return r[i]},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),r==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||Bge[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>Pge[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>Lge[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,r)=>{e.memberDepth+=1;const i=e(r.key);return e.memberDepth-=1,ES.has(e(r.value))?console.error(`Prevented interpretation of property "${i}" which could lead to insecure code execution`):n[i]=e(r.value),n},{})};function $d(e,t,n,r,i,o){const s=a=>Uge[a.type](s,a);return s.memberDepth=0,s.fn=Object.create(t),s.params=n,s.datum=r,s.event=i,s.item=o,jge.forEach(a=>s.fn[a]=function(){return i.vega[a](...arguments)}),s(e)}var Wge={operator(e,t){const n=t.ast,r=e.functions;return i=>$d(n,r,i)},parameter(e,t){const n=t.ast,r=e.functions;return(i,o)=>$d(n,r,o,i)},event(e,t){const n=t.ast,r=e.functions;return i=>$d(n,r,void 0,void 0,i)},handler(e,t){const n=t.ast,r=e.functions;return(i,o)=>{const s=o.item&&o.item.datum;return $d(n,r,i,s,o)}},encode(e,t){const{marktype:n,channels:r}=t,i=e.functions,o=n==="group"||n==="image"||n==="rect";return(s,a)=>{const u=s.datum;let l=0,c;for(const f in r)c=$d(r[f].ast,i,a,u,void 0,s),s[f]!==c&&(s[f]=c,l=1);return n!=="rule"&&Rge(s,r,o),l}}};const qge="vega-lite",Hge='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',Vge="5.20.1",Gge=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],Yge="https://vega.github.io/vega-lite/",Xge="Vega-Lite is a concise high-level language for interactive visualization.",Qge=["vega","chart","visualization"],Kge="build/vega-lite.js",Zge="build/vega-lite.min.js",Jge="build/vega-lite.min.js",eme="build/src/index",tme="build/src/index.d.ts",nme={vl2pdf:"./bin/vl2pdf",vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},rme=["bin","build","src","vega-lite*","tsconfig.json"],ime={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.mjs","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json",data:"rsync -r node_modules/vega-datasets/data/* site/data","build-editor-preview":"scripts/build-editor-preview.sh",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",format:"eslint . --fix && yarn prettierbase --write",lint:"eslint . && yarn prettierbase --check",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/","watch:test:runtime":"TZ=America/Los_Angeles npx jest --watch test-runtime/ --config test-runtime/jest-config.json",release:"release-it"},ome={type:"git",url:"https://github.com/vega/vega-lite.git"},sme="BSD-3-Clause",ame={url:"https://github.com/vega/vega-lite/issues"},ume={"@babel/core":"^7.24.7","@babel/preset-env":"^7.24.7","@babel/preset-typescript":"^7.24.7","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-alias":"^5.1.0","@rollup/plugin-babel":"^6.0.4","@rollup/plugin-commonjs":"^26.0.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@types/d3":"^7.4.3","@types/jest":"^29.5.12","@types/pako":"^2.0.3","@typescript-eslint/eslint-plugin":"^7.13.0","@typescript-eslint/parser":"^7.13.0",ajv:"^8.16.0","ajv-formats":"^2.1.1",cheerio:"^1.0.0-rc.12","conventional-changelog-cli":"^4.1.0",d3:"^7.9.0","del-cli":"^5.1.0",eslint:"^8.57.0","eslint-config-prettier":"^9.1.0","eslint-plugin-jest":"^27.9.0","eslint-plugin-prettier":"^5.1.3","fast-json-stable-stringify":"~2.1.0","highlight.js":"^11.9.0",jest:"^29.7.0","jest-dev-server":"^10.0.0",mkdirp:"^3.0.1",pako:"^2.1.0",prettier:"^3.3.2",puppeteer:"^15.0.0","release-it":"17.2.1",rollup:"^4.18.0","rollup-plugin-bundle-size":"^1.0.3",serve:"^14.2.3",terser:"^5.31.1","ts-jest":"^29.1.4","ts-json-schema-generator":"^1.5.0",typescript:"~5.4.5","vega-cli":"^5.28.0","vega-datasets":"^2.8.1","vega-embed":"^6.25.0","vega-tooltip":"^0.34.0","yaml-front-matter":"^4.1.1"},lme={"json-stringify-pretty-compact":"~3.0.0",tslib:"~2.6.3","vega-event-selector":"~3.0.1","vega-expression":"~5.1.0","vega-util":"~1.17.2",yargs:"~17.7.2"},cme={vega:"^5.24.0"},fme={node:">=18"},dme="yarn@1.22.19",hme={name:qge,author:Hge,version:Vge,collaborators:Gge,homepage:Yge,description:Xge,keywords:Qge,main:Kge,unpkg:Zge,jsdelivr:Jge,module:eme,types:tme,bin:nme,files:rme,scripts:ime,repository:ome,license:sme,bugs:ame,devDependencies:ume,dependencies:lme,peerDependencies:cme,engines:fme,packageManager:dme};function WA(e){return!!e.or}function qA(e){return!!e.and}function HA(e){return!!e.not}function c0(e,t){if(HA(e))c0(e.not,t);else if(qA(e))for(const n of e.and)c0(n,t);else if(WA(e))for(const n of e.or)c0(n,t);else t(e)}function Fc(e,t){return HA(e)?{not:Fc(e.not,t)}:qA(e)?{and:e.and.map(n=>Fc(n,t))}:WA(e)?{or:e.or.map(n=>Fc(n,t))}:t(e)}const fe=structuredClone;function MB(e){throw new Error(e)}function uf(e,t){const n={};for(const r of t)ae(e,r)&&(n[r]=e[r]);return n}function or(e,t){const n={...e};for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>We(e)).join(",")})`};function _e(e){if(Ae(e))return e;const t=Z(e)?e:We(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function SS(e){return e===!1||e===null}function be(e,t){return e.includes(t)}function lf(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function VA(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function TB(e,...t){for(const n of t)pme(e,n??{});return e}function pme(e,t){for(const n of B(t))Ff(e,n,t[n],!0)}function uo(e,t){const n=[],r={};let i;for(const o of e)i=t(o),!(i in r)&&(r[i]=1,n.push(o));return n}function gme(e,t){const n=B(e),r=B(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}function NB(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function GA(e,t){for(const n of e)if(t.has(n))return!0;return!1}function _S(e){const t=new Set;for(const n of e){const i=Co(n).map((s,a)=>a===0?s:`[${s}]`),o=i.map((s,a)=>i.slice(0,a+1).join(""));for(const s of o)t.add(s)}return t}function YA(e,t){return e===void 0||t===void 0?!0:GA(_S(e),_S(t))}function Ue(e){return B(e).length===0}const B=Object.keys,tn=Object.values,Da=Object.entries;function yp(e){return e===!0||e===!1}function tt(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function Ch(e,t){return HA(e)?`!(${Ch(e.not,t)})`:qA(e)?`(${e.and.map(n=>Ch(n,t)).join(") && (")})`:WA(e)?`(${e.or.map(n=>Ch(n,t)).join(") || (")})`:t(e)}function J1(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&J1(e[n],t)&&delete e[n],Ue(e)}function ag(e){return e.charAt(0).toUpperCase()+e.substr(1)}function XA(e,t="datum"){const n=Co(e),r=[];for(let i=1;i<=n.length;i++){const o=`[${n.slice(0,i).map(V).join("][")}]`;r.push(`${t}${o}`)}return r.join(" && ")}function OB(e,t="datum"){return`${t}[${V(Co(e).join("."))}]`}function mme(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function ii(e){return`${Co(e).map(mme).join("\\.")}`}function ll(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function qf(e){return`${Co(e).join(".")}`}function cf(e){return e?Co(e).length:0}function vt(...e){for(const t of e)if(t!==void 0)return t}let RB=42;function DB(e){const t=++RB;return e?String(e)+t:t}function yme(){RB=42}function PB(e){return LB(e)?e:`__${e}`}function LB(e){return e.startsWith("__")}function vp(e){if(e!==void 0)return(e%360+360)%360}function Xv(e){return Ae(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const pR=Object.getPrototypeOf(structuredClone({}));function Sr(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor.name!==t.constructor.name)return!1;let n,r;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!Sr(e[r],t[r]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(r of e.entries())if(!t.has(r[0]))return!1;for(r of e.entries())if(!Sr(r[1],t.get(r[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(r of e.entries())if(!t.has(r[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==pR.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==pR.toString)return e.toString()===t.toString();const i=Object.keys(e);if(n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!Sr(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function We(e){const t=[];return function n(r){if(r&&r.toJSON&&typeof r.toJSON=="function"&&(r=r.toJSON()),r===void 0)return;if(typeof r=="number")return isFinite(r)?""+r:"null";if(typeof r!="object")return JSON.stringify(r);let i,o;if(Array.isArray(r)){for(o="[",i=0;i<r.length;i++)i&&(o+=","),o+=n(r[i])||"null";return o+"]"}if(r===null)return"null";if(t.includes(r))throw new TypeError("Converting circular structure to JSON");const s=t.push(r)-1,a=Object.keys(r).sort();for(o="",i=0;i<a.length;i++){const u=a[i],l=n(r[u]);l&&(o&&(o+=","),o+=JSON.stringify(u)+":"+l)}return t.splice(s,1),`{${o}}`}(e)}const ls="row",cs="column",Qv="facet",nt="x",Vt="y",Wi="x2",Ro="y2",Za="xOffset",Hf="yOffset",qi="radius",ks="radius2",ai="theta",$s="theta2",Hi="latitude",Vi="longitude",Gi="latitude2",oi="longitude2",cr="color",Do="fill",Po="stroke",fr="shape",Cs="size",Fl="angle",As="opacity",Ja="fillOpacity",eu="strokeOpacity",tu="strokeWidth",nu="strokeDash",ug="text",ff="order",lg="detail",Kv="key",cl="tooltip",Zv="href",Jv="url",ex="description",vme={x:1,y:1,x2:1,y2:1},zB={theta:1,theta2:1,radius:1,radius2:1};function IB(e){return e in zB}const QA={longitude:1,longitude2:1,latitude:1,latitude2:1};function BB(e){switch(e){case Hi:return"y";case Gi:return"y2";case Vi:return"x";case oi:return"x2"}}function jB(e){return e in QA}const xme=B(QA),KA={...vme,...zB,...QA,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function Mc(e){return e===cr||e===Do||e===Po}const UB={row:1,column:1,facet:1},Gr=B(UB),ZA={...KA,...UB},wme=B(ZA),{order:C_e,detail:A_e,tooltip:F_e,...bme}=ZA,{row:M_e,column:T_e,facet:N_e,...Eme}=bme;function Sme(e){return!!Eme[e]}function WB(e){return!!ZA[e]}const _me=[Wi,Ro,Gi,oi,$s,ks];function qB(e){return Ml(e)!==e}function Ml(e){switch(e){case Wi:return nt;case Ro:return Vt;case Gi:return Hi;case oi:return Vi;case $s:return ai;case ks:return qi}return e}function Pa(e){if(IB(e))switch(e){case ai:return"startAngle";case $s:return"endAngle";case qi:return"outerRadius";case ks:return"innerRadius"}return e}function Lo(e){switch(e){case nt:return Wi;case Vt:return Ro;case Hi:return Gi;case Vi:return oi;case ai:return $s;case qi:return ks}}function dr(e){switch(e){case nt:case Wi:return"width";case Vt:case Ro:return"height"}}function HB(e){switch(e){case nt:return"xOffset";case Vt:return"yOffset";case Wi:return"x2Offset";case Ro:return"y2Offset";case ai:return"thetaOffset";case qi:return"radiusOffset";case $s:return"theta2Offset";case ks:return"radius2Offset"}}function tx(e){switch(e){case nt:return"xOffset";case Vt:return"yOffset"}}function kme(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const $me=B(KA),{x:O_e,y:R_e,x2:D_e,y2:P_e,xOffset:L_e,yOffset:z_e,latitude:I_e,longitude:B_e,latitude2:j_e,longitude2:U_e,theta:W_e,theta2:q_e,radius:H_e,radius2:V_e,...JA}=KA,Cme=B(JA),e3={x:1,y:1},Fs=B(e3);function xt(e){return e in e3}const t3={theta:1,radius:1},Ame=B(t3);function nx(e){return e==="width"?nt:Vt}const VB={xOffset:1,yOffset:1};function cg(e){return e in VB}const{text:G_e,tooltip:Y_e,href:X_e,url:Q_e,description:K_e,detail:Z_e,key:J_e,order:eke,...GB}=JA,Fme=B(GB);function Mme(e){return!!JA[e]}function Tme(e){switch(e){case cr:case Do:case Po:case Cs:case fr:case As:case tu:case nu:return!0;case Ja:case eu:case Fl:return!1}}const YB={...e3,...t3,...VB,...GB},n3=B(YB);function zo(e){return!!YB[e]}function Nme(e,t){return Rme(e)[t]}const XB={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:tke,...Ome}=XB;function Rme(e){switch(e){case cr:case Do:case Po:case ex:case lg:case Kv:case cl:case Zv:case ff:case As:case Ja:case eu:case tu:case Qv:case ls:case cs:return XB;case nt:case Vt:case Za:case Hf:case Hi:case Vi:return Ome;case Wi:case Ro:case Gi:case oi:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Cs:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case nu:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case fr:return{point:"always",geoshape:"always"};case ug:return{text:"always"};case Fl:return{point:"always",square:"always",text:"always"};case Jv:return{image:"always"};case ai:return{text:"always",arc:"always"};case qi:return{text:"always",arc:"always"};case $s:case ks:return{arc:"always"}}}function bw(e){switch(e){case nt:case Vt:case ai:case qi:case Za:case Hf:case Cs:case Fl:case tu:case As:case Ja:case eu:case Wi:case Ro:case $s:case ks:return;case Qv:case ls:case cs:case fr:case nu:case ug:case cl:case Zv:case Jv:case ex:return"discrete";case cr:case Do:case Po:return"flexible";case Hi:case Vi:case Gi:case oi:case lg:case Kv:case ff:return}}const Dme={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Pme={count:1,min:1,max:1};function bs(e){return!!e&&!!e.argmin}function ru(e){return!!e&&!!e.argmax}function r3(e){return Z(e)&&!!Dme[e]}const Lme=new Set(["count","valid","missing","distinct"]);function rx(e){return Z(e)&&Lme.has(e)}function zme(e){return Z(e)&&be(["min","max"],e)}const Ime=new Set(["count","sum","distinct","valid","missing"]),Bme=new Set(["mean","average","median","q1","q3","min","max"]);function QB(e){return Ha(e)&&(e=gx(e,void 0)),"bin"+B(e).map(t=>ix(e[t])?tt(`_${t}_${Da(e[t])}`):tt(`_${t}_${e[t]}`)).join("")}function Ye(e){return e===!0||Tl(e)&&!e.binned}function Xt(e){return e==="binned"||Tl(e)&&e.binned===!0}function Tl(e){return Q(e)}function ix(e){return e==null?void 0:e.param}function gR(e){switch(e){case ls:case cs:case Cs:case cr:case Do:case Po:case tu:case As:case Ja:case eu:case fr:return 6;case nu:return 4;default:return 10}}function fg(e){return!!(e!=null&&e.expr)}function gn(e,{level:t}={level:0}){const n=B(e||{}),r={};for(const i of n)r[i]=t===0?xr(e[i]):gn(e[i],{level:t-1});return r}function KB(e){const{anchor:t,frame:n,offset:r,orient:i,angle:o,limit:s,color:a,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p,...g}=e,y={...g,...a?{fill:a}:{}},m={...t?{anchor:t}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...o!==void 0?{angle:o}:{},...s!==void 0?{limit:s}:{}},v={...u?{subtitleColor:u}:{},...l?{subtitleFont:l}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...h?{subtitleLineHeight:h}:{},...p?{subtitlePadding:p}:{}},x=uf(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:y,subtitleMarkConfig:x,nonMarkTitleProperties:m,subtitle:v}}function Hs(e){return Z(e)||I(e)&&Z(e[0])}function ne(e){return!!(e!=null&&e.signal)}function iu(e){return!!e.step}function jme(e){return I(e)?!1:"fields"in e&&!("data"in e)}function Ume(e){return I(e)?!1:"fields"in e&&"data"in e}function is(e){return I(e)?!1:"field"in e&&"data"in e}const Wme={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},qme=B(Wme),Hme={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},kS=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function ZB(e){const t=I(e.condition)?e.condition.map(mR):mR(e.condition);return{...xr(e),condition:t}}function xr(e){if(fg(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function mR(e){if(fg(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function Ve(e){if(fg(e)){const{expr:t,...n}=e;return{signal:t,...n}}return ne(e)?e:e!==void 0?{value:e}:void 0}function $S(e){return ne(e)?e.signal:V(e)}function yR(e){return ne(e)?e.signal:V(e.value)}function $i(e){return ne(e)?e.signal:e==null?null:V(e)}function Vme(e,t,n){for(const r of n){const i=_o(r,t.markDef,t.config);i!==void 0&&(e[r]=Ve(i))}return e}function JB(e){return[].concat(e.type,e.style??[])}function Ie(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:o&&(!i||i===e)?void 0:_o(e,t,n,r)}function _o(e,t,n,{vgChannel:r}={}){return vt(r?ey(e,t,n.style):void 0,ey(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function ey(e,t,n){return ej(e,JB(t),n)}function ej(e,t,n){t=K(t);let r;for(const i of t){const o=n[i];o&&o[e]!==void 0&&(r=o[e])}return r}function tj(e,t){return K(e).reduce((n,r)=>(n.field.push(Y(r,t)),n.order.push(r.sort??"ascending"),n),{field:[],order:[]})}function nj(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(Sr(i,r))return;n.push(r)}),n}function rj(e,t){return Sr(e,t)||!t?e:e?[...K(e),...K(t)].join(", "):t}function ij(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((Hs(n)||ne(n))&&(Hs(r)||ne(r)))return{explicit:e.explicit,value:rj(n,r)};if(Hs(n)||ne(n))return{explicit:e.explicit,value:n};if(Hs(r)||ne(r))return{explicit:e.explicit,value:r};if(!Hs(n)&&!ne(n)&&!Hs(r)&&!ne(r))return{explicit:e.explicit,value:nj(n,r)};throw new Error("It should never reach here")}function i3(e){return`Invalid specification ${We(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const Gme='Autosize "fit" only works for single views and layered views.';function vR(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function xR(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function wR(e){return e?`Dropping "fit-${e}" because spec has discrete ${dr(e)}.`:'Dropping "fit" because spec has discrete size.'}function o3(e){return`Unknown field for ${e}. Cannot calculate view size.`}function bR(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Yme(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Xme(e){return`The "nearest" transform is not supported for ${e} marks.`}function oj(e){return`Selection not supported for ${e} yet.`}function Qme(e){return`Cannot find a selection named "${e}".`}const Kme="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Zme="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",Jme="Legend bindings are only supported for selections over an individual field or encoding channel.";function e0e(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function t0e(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const n0e="The same selection must be used to override scale domains in a layered view.",r0e='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function i0e(e){return`Unknown repeated value "${e}".`}function ER(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const o0e="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function s0e(e){return`Unrecognized parse "${e}".`}function SR(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const a0e="Attempt to add the same child twice.";function u0e(e){return`Ignoring an invalid transform: ${We(e)}.`}const l0e='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function _R(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function c0e(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${We(t)} is overridden by a child projection ${We(n)}.`}const f0e="Arc marks uses theta channel rather than angle, replacing angle with theta.";function d0e(e){return`${e}Offset dropped because ${e} is continuous`}function h0e(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${We(n)}}.`}function sj(e){return`Invalid field type "${e}".`}function p0e(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function g0e(e){return`Invalid aggregation operator "${e}".`}function aj(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function m0e(e){return`Position range does not support relative band size for ${e}.`}function CS(e,t){return`Dropping ${We(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const y0e="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function ox(e,t,n){return`${e} dropped as it is incompatible with "${t}".`}function v0e(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function x0e(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function w0e(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function b0e(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function Ew(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function E0e(e){return`The ${e} for range marks cannot be an expression`}function S0e(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function _0e(e,t){return`Specified orient "${e}" overridden with "${t}".`}function k0e(e){return`Cannot use the scale property "${e}" with non-color channel.`}function $0e(e){return`Cannot use the relative band size with ${e} scale.`}function C0e(e){return`Using unaggregated domain with raw field has no effect (${We(e)}).`}function A0e(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function F0e(e){return`Unaggregated domain is currently unsupported for log scale (${We(e)}).`}function M0e(e){return`Cannot apply size to non-oriented mark "${e}".`}function T0e(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function N0e(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function uj(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function lj(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function O0e(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${We(n)} and ${We(r)}). Using ${We(n)}.`}function R0e(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${We(n)} and ${We(r)}). Using the union of the two domains.`}function D0e(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function P0e(e){return`Dropping sort property ${We(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const kR="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",L0e="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",z0e="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",I0e="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function B0e(e){return`Cannot stack "${e}" if there is already "${e}2".`}function j0e(e){return`Stack is applied to a non-linear scale (${e}).`}function U0e(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function ty(e,t){return`Invalid ${e}: ${We(t)}.`}function W0e(e){return`Dropping day from datetime ${We(e)} as day cannot be combined with other units.`}function q0e(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function H0e(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function V0e(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function $R(e){return`1D error band does not support ${e}.`}function cj(e){return`Channel ${e} is required for "binned" bin.`}function G0e(e){return`Channel ${e} should not be used with "binned" bin.`}function Y0e(e){return`Domain for ${e} is required for threshold scale.`}const fj=tk(ek);let df=fj;function X0e(e){return df=e,df}function Q0e(){return df=fj,df}function U(...e){df.warn(...e)}function K0e(...e){df.debug(...e)}function Nl(e){if(e&&Q(e)){for(const t of a3)if(t in e)return!0}return!1}const dj=["january","february","march","april","may","june","july","august","september","october","november","december"],Z0e=dj.map(e=>e.substr(0,3)),hj=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],J0e=hj.map(e=>e.substr(0,3));function e1e(e){if(Xv(e)&&(e=+e),Ae(e))return e>4&&U(ty("quarter",e)),e-1;throw new Error(ty("quarter",e))}function t1e(e){if(Xv(e)&&(e=+e),Ae(e))return e-1;{const t=e.toLowerCase(),n=dj.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=Z0e.indexOf(r);if(i!==-1)return i;throw new Error(ty("month",e))}}function n1e(e){if(Xv(e)&&(e=+e),Ae(e))return e%7;{const t=e.toLowerCase(),n=hj.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=J0e.indexOf(r);if(i!==-1)return i;throw new Error(ty("day",e))}}function s3(e,t){const n=[];if(t&&e.day!==void 0&&B(e).length>1&&(U(W0e(e)),e=fe(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?t1e(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?e1e(e.quarter):e.quarter;n.push(Ae(r)?r*3:`${r}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?n1e(e.day):e.day;n.push(Ae(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i>"u"?0:i)}return n}function fl(e){const n=s3(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function r1e(e){const n=s3(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function i1e(e){const t=s3(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const pj={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},a3=B(pj);function o1e(e){return!!pj[e]}function Ol(e){return Q(e)?e.binned:gj(e)}function gj(e){return e&&e.startsWith("binned")}function u3(e){return e.startsWith("utc")}function s1e(e){return e.substring(3)}const a1e={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function sx(e){return a3.filter(t=>yj(e,t))}function mj(e){const t=sx(e);return t[t.length-1]}function yj(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function u1e(e,t,{end:n}={end:!1}){const r=XA(t),i=u3(e)?"utc":"";function o(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let s;const a={};for(const u of a3)yj(e,u)&&(a[u]=o(u),s=u);return n&&(a[s]+="+1"),r1e(a)}function vj(e){if(!e)return;const t=sx(e);return`timeUnitSpecifier(${We(t)}, ${We(a1e)})`}function l1e(e,t,n){if(!e)return;const r=vj(e);return`${n||u3(e)?"utc":"time"}Format(${t}, ${r})`}function Wt(e){if(!e)return;let t;return Z(e)?gj(e)?t={unit:e.substring(6),binned:!0}:t={unit:e}:Q(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),u3(t.unit)&&(t.utc=!0,t.unit=s1e(t.unit)),t}function c1e(e){const{utc:t,...n}=Wt(e);return n.unit?(t?"utc":"")+B(n).map(r=>tt(`${r==="unit"?"":`_${r}_`}${n[r]}`)).join(""):(t?"utc":"")+"timeunit"+B(n).map(r=>tt(`_${r}_${n[r]}`)).join("")}function xj(e,t=n=>n){const n=Wt(e),r=mj(n.unit);if(r&&r!=="day"){const i={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:o,part:s}=wj(r,n.step),a={...i,[s]:+i[s]+o};return`${t(fl(a))} - ${t(fl(i))}`}}const f1e={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function d1e(e){return!!f1e[e]}function wj(e,t=1){if(d1e(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function h1e(e){return e==null?void 0:e.param}function l3(e){return!!(e!=null&&e.field)&&e.equal!==void 0}function c3(e){return!!(e!=null&&e.field)&&e.lt!==void 0}function f3(e){return!!(e!=null&&e.field)&&e.lte!==void 0}function d3(e){return!!(e!=null&&e.field)&&e.gt!==void 0}function h3(e){return!!(e!=null&&e.field)&&e.gte!==void 0}function p3(e){if(e!=null&&e.field){if(I(e.range)&&e.range.length===2)return!0;if(ne(e.range))return!0}return!1}function g3(e){return!!(e!=null&&e.field)&&(I(e.oneOf)||I(e.in))}function p1e(e){return!!(e!=null&&e.field)&&e.valid!==void 0}function bj(e){return g3(e)||l3(e)||p3(e)||c3(e)||d3(e)||f3(e)||h3(e)}function Zi(e,t){return mx(e,{timeUnit:t,wrapTime:!0})}function g1e(e,t){return e.map(n=>Zi(n,t))}function Ej(e,t=!0){const{field:n}=e,r=Wt(e.timeUnit),{unit:i,binned:o}=r||{},s=Y(e,{expr:"datum"}),a=i?`time(${o?s:u1e(i,n)})`:s;if(l3(e))return`${a}===${Zi(e.equal,i)}`;if(c3(e)){const u=e.lt;return`${a}<${Zi(u,i)}`}else if(d3(e)){const u=e.gt;return`${a}>${Zi(u,i)}`}else if(f3(e)){const u=e.lte;return`${a}<=${Zi(u,i)}`}else if(h3(e)){const u=e.gte;return`${a}>=${Zi(u,i)}`}else{if(g3(e))return`indexof([${g1e(e.oneOf,i).join(",")}], ${a}) !== -1`;if(p1e(e))return ax(a,e.valid);if(p3(e)){const{range:u}=e,l=ne(u)?{signal:`${u.signal}[0]`}:u[0],c=ne(u)?{signal:`${u.signal}[1]`}:u[1];if(l!==null&&c!==null&&t)return"inrange("+a+", ["+Zi(l,i)+", "+Zi(c,i)+"])";const f=[];return l!==null&&f.push(`${a} >= ${Zi(l,i)}`),c!==null&&f.push(`${a} <= ${Zi(c,i)}`),f.length>0?f.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${We(e)}`)}function ax(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function m1e(e){return bj(e)&&e.timeUnit?{...e,timeUnit:Wt(e.timeUnit)}:e}const dg={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function y1e(e){return e==="quantitative"||e==="temporal"}function Sj(e){return e==="ordinal"||e==="nominal"}const dl=dg.quantitative,m3=dg.ordinal,hf=dg.temporal,y3=dg.nominal,Vf=dg.geojson;function v1e(e){if(e)switch(e=e.toLowerCase(),e){case"q":case dl:return"quantitative";case"t":case hf:return"temporal";case"o":case m3:return"ordinal";case"n":case y3:return"nominal";case Vf:return"geojson"}}const Qt={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},AS={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function x1e(e,t){const n=AS[e],r=AS[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const w1e={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function CR(e){return w1e[e]}const _j=new Set(["linear","log","pow","sqrt","symlog"]),kj=new Set([..._j,"time","utc"]);function $j(e){return _j.has(e)}const Cj=new Set(["quantile","quantize","threshold"]),b1e=new Set([...kj,...Cj,"sequential","identity"]),E1e=new Set(["ordinal","bin-ordinal","point","band"]);function qt(e){return E1e.has(e)}function Pi(e){return b1e.has(e)}function lo(e){return kj.has(e)}function pf(e){return Cj.has(e)}const S1e={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,tickBandPaddingInner:.25,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0};function _1e(e){return!Z(e)&&!!e.name}function Aj(e){return e==null?void 0:e.param}function k1e(e){return e==null?void 0:e.unionWith}function $1e(e){return Q(e)&&"field"in e}const C1e={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:nke,domain:rke,range:ike,rangeMax:oke,rangeMin:ske,scheme:ake,...A1e}=C1e,F1e=B(A1e);function FS(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return lo(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return lo(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return lo(e);case"nice":return lo(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Pi(e)&&!be(["log","time","utc","threshold","quantile"],e)}}function Fj(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Mc(e)?void 0:k0e(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function M1e(e,t){return be([m3,y3],t)?e===void 0||qt(e):t===hf?be([Qt.TIME,Qt.UTC,void 0],e):t===dl?$j(e)||pf(e)||e===void 0:!0}function T1e(e,t,n=!1){if(!zo(e))return!1;switch(e){case nt:case Vt:case Za:case Hf:case ai:case qi:return lo(t)||t==="band"?!0:t==="point"?!n:!1;case Cs:case tu:case As:case Ja:case eu:case Fl:return lo(t)||pf(t)||be(["band","point","ordinal"],t);case cr:case Do:case Po:return t!=="band";case nu:case fr:return t==="ordinal"||pf(t)}}function N1e(e){return Q(e)&&"value"in e}const Gn={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},Mj=Gn.arc,ux=Gn.area,lx=Gn.bar,O1e=Gn.image,cx=Gn.line,fx=Gn.point,R1e=Gn.rect,ny=Gn.rule,Tj=Gn.text,v3=Gn.tick,D1e=Gn.trail,x3=Gn.circle,w3=Gn.square,Nj=Gn.geoshape;function ou(e){return["line","area","trail"].includes(e)}function xp(e){return["rect","bar","image","arc"].includes(e)}const P1e=new Set(B(Gn));function ko(e){return e.type}const L1e=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],z1e=["fill","fillOpacity"],I1e=[...L1e,...z1e],B1e={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},AR=B(B1e),j1e={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],line:["point"],tick:["bandSize","thickness"]},U1e={color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},W1e={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},Oj=B(W1e);function hl(e){return e&&e.band!=null}const q1e={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Rj=5,H1e={binSpacing:1,continuousBandSize:Rj,minBandSize:.25,timeUnitBandPosition:.5},V1e={binSpacing:0,continuousBandSize:Rj,minBandSize:.25,timeUnitBandPosition:.5},G1e={thickness:1};function Y1e(e){return ko(e)?e.type:e}function Dj(e,{isPath:t}){return e===void 0||e==="break-paths-show-path-domains"?t?"break-paths-show-domains":"filter":e===null?"show":e}function b3({markDef:e,config:t,scaleChannel:n,scaleType:r,isCountAggregate:i}){var a,u;if(!r||!Pi(r)||i)return"always-valid";const o=Dj(Ie("invalid",e,t),{isPath:ou(e.type)});return((u=(a=t.scale)==null?void 0:a.invalid)==null?void 0:u[n])!==void 0?"show":o}function X1e(e){return e==="break-paths-filter-domains"||e==="break-paths-show-domains"}function Pj({scaleName:e,scale:t,mode:n}){const r=`domain('${e}')`;if(!t||!e)return;const i=`${r}[0]`,o=`peek(${r})`,s=t.domainHasZero();return s==="definitely"?{scale:e,value:0}:s==="maybe"?{signal:`scale('${e}', inrange(0, ${r}) ? 0 : ${n==="zeroOrMin"?i:o})`}:{signal:`scale('${e}', ${n==="zeroOrMin"?i:o})`}}function Lj({scaleChannel:e,channelDef:t,scale:n,scaleName:r,markDef:i,config:o}){var c;const s=n==null?void 0:n.get("type"),a=zi(t),u=rx(a==null?void 0:a.aggregate),l=b3({scaleChannel:e,markDef:i,config:o,scaleType:s,isCountAggregate:u});if(a&&l==="show"){const f=((c=o.scale.invalid)==null?void 0:c[e])??"zero-or-min";return{test:ax(Y(a,{expr:"datum"}),!1),...Q1e(f,n,r)}}}function Q1e(e,t,n){if(N1e(e)){const{value:r}=e;return ne(r)?{signal:r.signal}:{value:r}}return Pj({scale:t,scaleName:n,mode:"zeroOrMin"})}function E3(e){const{channel:t,channelDef:n,markDef:r,scale:i,scaleName:o,config:s}=e,a=Ml(t),u=S3(e),l=Lj({scaleChannel:a,channelDef:n,scale:i,scaleName:o,markDef:r,config:s});return l!==void 0?[l,u]:u}function K1e(e){const{datum:t}=e;return Nl(t)?fl(t):`${We(t)}`}function Uu(e,t,n,r){const i={};if(t&&(i.scale=t),Io(e)){const{datum:o}=e;Nl(o)?i.signal=fl(o):ne(o)?i.signal=o.signal:fg(o)?i.signal=o.expr:i.value=o}else i.field=Y(e,n);if(r){const{offset:o,band:s}=r;o&&(i.offset=o),s&&(i.band=s)}return i}function ry({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,endSuffix:o="end",bandPosition:s=.5}){const a=!ne(s)&&0<s&&s<1?"datum":void 0,u=Y(t,{expr:a,suffix:i}),l=n!==void 0?Y(n,{expr:a}):Y(t,{suffix:o,expr:a}),c={};if(s===0||s===1){c.scale=e;const f=s===0?u:l;c.field=f}else{const f=ne(s)?`(1-${s.signal}) * ${u} + ${s.signal} * ${l}`:`${1-s} * ${u} + ${s} * ${l}`;c.signal=`scale("${e}", ${f})`}return r&&(c.offset=r),c}function Z1e({scaleName:e,fieldDef:t}){const n=Y(t,{expr:"datum"}),r=Y(t,{expr:"datum",suffix:"end"});return`abs(scale("${e}", ${r}) - scale("${e}", ${n}))`}function S3({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l,bandPosition:c}){if(t){if(de(t)){const f=s==null?void 0:s.get("type");if(Wn(t)){c??(c=La({fieldDef:t,fieldDef2:n,markDef:r,config:i}));const{bin:d,timeUnit:h,type:p}=t;if(Ye(d)||c&&h&&p===hf)return a!=null&&a.impute?Uu(t,o,{binSuffix:"mid"},{offset:u}):c&&!qt(f)?ry({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):Uu(t,o,yg(t,e)?{binSuffix:"range"}:{},{offset:u});if(Xt(d)){if(W(n))return ry({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});U(cj(e===nt?Wi:Ro))}}return Uu(t,o,qt(f)?{binSuffix:"range"}:{},{offset:u,band:f==="band"?c??t.bandPosition??.5:void 0})}else if(Li(t)){const f=t.value,d=u?{offset:u}:{};return{...Ah(e,f),...d}}}return ge(l)&&(l=l()),l&&{...l,...u?{offset:u}:{}}}function Ah(e,t){return be(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:be(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Ve(t)}function pl(e){return e&&e!=="number"&&e!=="time"}function zj(e,t,n){return`${e}(${t}${n?`, ${We(n)}`:""})`}const J1e="  ";function _3({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){var u,l;if(pl(n))return Ci({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});const s=Ij(e,r,i),a=gf(e);if(t===void 0&&n===void 0&&o.customFormatTypes){if(a==="quantitative"){if(i&&o.normalizedNumberFormatType)return Ci({fieldOrDatumDef:e,format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,expr:r,config:o});if(o.numberFormatType)return Ci({fieldOrDatumDef:e,format:o.numberFormat,formatType:o.numberFormatType,expr:r,config:o})}if(a==="temporal"&&o.timeFormatType&&W(e)&&e.timeUnit===void 0)return Ci({fieldOrDatumDef:e,format:o.timeFormat,formatType:o.timeFormatType,expr:r,config:o})}if(yf(e)){const c=tye({field:s,timeUnit:W(e)?(u=Wt(e.timeUnit))==null?void 0:u.unit:void 0,format:t,formatType:o.timeFormatType,rawTimeFormat:o.timeFormat,isUTCScale:Rl(e)&&((l=e.scale)==null?void 0:l.type)===Qt.UTC});return c?{signal:c}:void 0}if(t=MS({type:a,specifiedFormat:t,config:o,normalizeStack:i}),W(e)&&Ye(e.bin)){const c=Y(e,{expr:r,binSuffix:"end"});return{signal:hg(s,c,t,n,o)}}else return t||gf(e)==="quantitative"?{signal:`${Uj(s,t)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function Ij(e,t,n){return W(e)?n?`${Y(e,{expr:t,suffix:"end"})}-${Y(e,{expr:t,suffix:"start"})}`:Y(e,{expr:t}):K1e(e)}function Ci({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:s}){if(s??(s=Ij(e,r,i)),s!=="datum.value"&&W(e)&&Ye(e.bin)){const a=Y(e,{expr:r,binSuffix:"end"});return{signal:hg(s,a,t,n,o)}}return{signal:zj(n,s,t)}}function Bj(e,t,n,r,i,o){var s;if(!(Z(r)&&pl(r))&&!(n===void 0&&r===void 0&&i.customFormatTypes&&gf(e)==="quantitative"&&(i.normalizedNumberFormatType&&mf(e)&&e.stack==="normalize"||i.numberFormatType))){if(mf(e)&&e.stack==="normalize"&&i.normalizedNumberFormat)return MS({type:"quantitative",config:i,normalizeStack:!0});if(yf(e)){const a=W(e)?(s=Wt(e.timeUnit))==null?void 0:s.unit:void 0;return a===void 0&&i.customFormatTypes&&i.timeFormatType?void 0:eye({specifiedFormat:n,timeUnit:a,config:i,omitTimeFormatConfig:o})}return MS({type:t,specifiedFormat:n,config:i})}}function jj(e,t,n){var r;if(e&&(ne(e)||e==="number"||e==="time"))return e;if(yf(t)&&n!=="time"&&n!=="utc")return W(t)&&((r=Wt(t==null?void 0:t.timeUnit))!=null&&r.utc)?"utc":"time"}function MS({type:e,specifiedFormat:t,config:n,normalizeStack:r}){if(Z(t))return t;if(e===dl)return r?n.normalizedNumberFormat:n.numberFormat}function eye({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:r}){return e||(t?{signal:vj(t)}:r?void 0:n.timeFormat)}function Uj(e,t){return`format(${e}, "${t||""}")`}function FR(e,t,n,r){return pl(n)?zj(n,e,t):Uj(e,(Z(t)?t:void 0)??r.numberFormat)}function hg(e,t,n,r,i){if(n===void 0&&r===void 0&&i.customFormatTypes&&i.numberFormatType)return hg(e,t,i.numberFormat,i.numberFormatType,i);const o=FR(e,n,r,i),s=FR(t,n,r,i);return`${ax(e,!1)} ? "null" : ${o} + "${J1e}" + ${s}`}function tye({field:e,timeUnit:t,format:n,formatType:r,rawTimeFormat:i,isUTCScale:o}){return!t||n?!t&&r?`${r}(${e}, '${n}')`:(n=Z(n)?n:i,`${o?"utc":"time"}Format(${e}, '${n}')`):l1e(t,e,o)}const dx="min",nye={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function MR(e){return e in nye}function rye(e){return!!(e!=null&&e.encoding)}function fs(e){return e&&(e.op==="count"||!!e.field)}function Wj(e){return e&&I(e)}function pg(e){return"row"in e||"column"in e}function k3(e){return!!e&&"header"in e}function hx(e){return"facet"in e}function iye(e){return e.param}function oye(e){return e&&!Z(e)&&"repeat"in e}function TR(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:t}}function $3(e){return"sort"in e}function La({fieldDef:e,fieldDef2:t,markDef:n,config:r}){if(de(e)&&e.bandPosition!==void 0)return e.bandPosition;if(W(e)){const{timeUnit:i,bin:o}=e;if(i&&!t)return _o("timeUnitBandPosition",n,r);if(Ye(o))return .5}}function qj({channel:e,fieldDef:t,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:s}){var l,c,f;const a=dr(e),u=Ie(s?"size":a,r,i,{vgChannel:a});if(u!==void 0)return u;if(W(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:_o("timeUnitBandSize",r,i)};if(Ye(h)&&!qt(o))return{band:1}}if(xp(r.type))return o?qt(o)?((l=i[r.type])==null?void 0:l.discreteBandSize)||{band:1}:(c=i[r.type])==null?void 0:c.continuousBandSize:(f=i[r.type])==null?void 0:f.discreteBandSize}function Hj(e,t,n,r){return Ye(e.bin)||e.timeUnit&&Wn(e)&&e.type==="temporal"?La({fieldDef:e,fieldDef2:t,markDef:n,config:r})!==void 0:!1}function Vj(e){return e&&!!e.sort&&!e.field}function gg(e){return e&&"condition"in e}function px(e){const t=e==null?void 0:e.condition;return!!t&&!I(t)&&W(t)}function mg(e){const t=e==null?void 0:e.condition;return!!t&&!I(t)&&de(t)}function sye(e){const t=e==null?void 0:e.condition;return!!t&&(I(t)||Li(t))}function W(e){return e&&(!!e.field||e.aggregate==="count")}function gf(e){return e==null?void 0:e.type}function Io(e){return e&&"datum"in e}function aa(e){return Wn(e)&&!oy(e)||iy(e)}function NR(e){return Wn(e)&&e.type==="quantitative"&&!e.bin||iy(e)}function iy(e){return Io(e)&&Ae(e.datum)}function de(e){return W(e)||Io(e)}function Wn(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function Li(e){return e&&"value"in e&&"value"in e}function Rl(e){return e&&("scale"in e||"sort"in e)}function mf(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Gj(e){return e&&"legend"in e}function Yj(e){return e&&("format"in e||"formatType"in e)}function aye(e){return or(e,["legend","axis","header","scale"])}function uye(e){return"op"in e}function Y(e,t={}){let n=e.field;const r=t.prefix;let i=t.suffix,o="";if(cye(e))n=PB("count");else{let s;if(!t.nofn)if(uye(e))s=e.op;else{const{bin:a,aggregate:u,timeUnit:l}=e;Ye(a)?(s=QB(a),i=(t.binSuffix??"")+(t.suffix??"")):u?ru(u)?(o=`["${n}"]`,n=`argmax_${u.argmax}`):bs(u)?(o=`["${n}"]`,n=`argmin_${u.argmin}`):s=String(u):l&&!Ol(l)&&(s=c1e(l),i=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}s&&(n=n?`${s}_${n}`:s)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),t.forAs?qf(n):t.expr?OB(n,t.expr)+o:ii(n)+o}function oy(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return W(e)&&!!e.bin;case"temporal":return!1}throw new Error(sj(e.type))}function lye(e){var t;return Rl(e)&&pf((t=e.scale)==null?void 0:t.type)}function cye(e){return e.aggregate==="count"}function fye(e,t){var s;const{field:n,bin:r,timeUnit:i,aggregate:o}=e;if(o==="count")return t.countTitle;if(Ye(r))return`${n} (binned)`;if(i&&!Ol(i)){const a=(s=Wt(i))==null?void 0:s.unit;if(a)return`${n} (${sx(a).join("-")})`}else if(o)return ru(o)?`${n} for max ${o.argmax}`:bs(o)?`${n} for min ${o.argmin}`:`${ag(o)} of ${n}`;return n}function dye(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(ru(t))return`${i} for argmax(${t.argmax})`;if(bs(t))return`${i} for argmin(${t.argmin})`;const o=r&&!Ol(r)?Wt(r):void 0,s=t||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||Ye(n)&&"bin";return s?`${s.toUpperCase()}(${i})`:i}const Xj=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return dye(e);default:return fye(e,t)}};let Qj=Xj;function Kj(e){Qj=e}function hye(){Kj(Xj)}function Tc(e,t,{allowDisabling:n,includeDefault:r=!0}){var a;const i=(a=C3(e))==null?void 0:a.title;if(!W(e))return i??e.title;const o=e,s=r?A3(o,t):void 0;return n?vt(i,o.title,s):i??o.title??s}function C3(e){if(mf(e)&&e.axis)return e.axis;if(Gj(e)&&e.legend)return e.legend;if(k3(e)&&e.header)return e.header}function A3(e,t){return Qj(e,t)}function sy(e){if(Yj(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=C3(e)??{},{format:n,formatType:r}=t;return{format:n,formatType:r}}}function pye(e,t){var o;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if($3(e)&&I(e.sort))return"ordinal";const{aggregate:n,bin:r,timeUnit:i}=e;if(i)return"temporal";if(r||n&&!ru(n)&&!bs(n))return"quantitative";if(Rl(e)&&((o=e.scale)!=null&&o.type))switch(AS[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function zi(e){if(W(e))return e;if(px(e))return e.condition}function At(e){if(de(e))return e;if(mg(e))return e.condition}function Zj(e,t,n,r={}){if(Z(e)||Ae(e)||Ha(e)){const i=Z(e)?"string":Ae(e)?"number":"boolean";return U(h0e(t,i,e)),{value:e}}return de(e)?ay(e,t,n,r):mg(e)?{...e,condition:ay(e.condition,t,n,r)}:e}function ay(e,t,n,r){if(Yj(e)){const{format:i,formatType:o,...s}=e;if(pl(o)&&!n.customFormatTypes)return U(_R(t)),ay(s,t,n,r)}else{const i=mf(e)?"axis":Gj(e)?"legend":k3(e)?"header":null;if(i&&e[i]){const{format:o,formatType:s,...a}=e[i];if(pl(s)&&!n.customFormatTypes)return U(_R(t)),ay({...e,[i]:a},t,n,r)}}return W(e)?F3(e,t,r):gye(e)}function gye(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Ae(n)?"quantitative":Z(n)?"nominal":Nl(n)?"temporal":void 0,{...e,type:t}}function F3(e,t,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:o,field:s}=e,a={...e};if(!n&&r&&!r3(r)&&!ru(r)&&!bs(r)&&(U(g0e(r)),delete a.aggregate),i&&(a.timeUnit=Wt(i)),s&&(a.field=`${s}`),Ye(o)&&(a.bin=gx(o,t)),Xt(o)&&!xt(t)&&U(G0e(t)),Wn(a)){const{type:u}=a,l=v1e(u);u!==l&&(a.type=l),u!=="quantitative"&&rx(r)&&(U(p0e(u,r)),a.type="quantitative")}else if(!qB(t)){const u=pye(a,t);a.type=u}if(Wn(a)){const{compatible:u,warning:l}=mye(a,t)||{};u===!1&&U(l)}if($3(a)&&Z(a.sort)){const{sort:u}=a;if(MR(u))return{...a,sort:{encoding:u}};const l=u.substr(1);if(u.charAt(0)==="-"&&MR(l))return{...a,sort:{encoding:l,order:"descending"}}}if(k3(a)){const{header:u}=a;if(u){const{orient:l,...c}=u;if(l)return{...a,header:{...c,labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l}}}}return a}function gx(e,t){return Ha(e)?{maxbins:gR(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:gR(t)}:e}const Gl={compatible:!0};function mye(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ls:case cs:case Qv:return oy(e)?Gl:{compatible:!1,warning:x0e(t)};case nt:case Vt:case Za:case Hf:case cr:case Do:case Po:case ug:case lg:case Kv:case cl:case Zv:case Jv:case Fl:case ai:case qi:case ex:return Gl;case Vi:case oi:case Hi:case Gi:return n!==dl?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Gl;case As:case Ja:case eu:case tu:case Cs:case $s:case ks:case Wi:case Ro:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Gl;case fr:case nu:return!oy(e)&&!lye(e)?{compatible:!1,warning:w0e(t)}:Gl;case ff:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Gl}}function yf(e){const{formatType:t}=sy(e);return t==="time"||!t&&yye(e)}function yye(e){return e&&(e.type==="temporal"||W(e)&&!!e.timeUnit)}function mx(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var u;const o=t&&((u=Wt(t))==null?void 0:u.unit);let s=o||n==="temporal",a;return fg(e)?a=e.expr:ne(e)?a=e.signal:Nl(e)?(s=!0,a=fl(e)):(Z(e)||Ae(e))&&s&&(a=`datetime(${We(e)})`,o1e(o)&&(Ae(e)&&e<1e4||Z(e)&&isNaN(Date.parse(e)))&&(a=fl({[o]:e}))),a?r&&s?`time(${a})`:a:i?void 0:We(e)}function Jj(e,t){const{type:n}=e;return t.map(r=>{const i=W(e)&&!Ol(e.timeUnit)?e.timeUnit:void 0,o=mx(r,{timeUnit:i,type:n,undefinedIfExprNotRequired:!0});return o!==void 0?{signal:o}:r})}function yg(e,t){return Ye(e.bin)?zo(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const OR={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function vg(e){return e==null?void 0:e.condition}const eU=["domain","grid","labels","ticks","title"],vye={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},tU={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},xye={...tU,style:1,labelExpr:1,encoding:1};function RR(e){return!!xye[e]}const wye={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},nU=B(wye);function Ms(e){return"mark"in e}class yx{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Ms(t)?Y1e(t.mark)===this.name:!1}}function Wu(e,t){const n=e&&e[t];return n?I(n)?lf(n,r=>!!r.field):W(n)||px(n):!1}function rU(e,t){const n=e&&e[t];return n?I(n)?lf(n,r=>!!r.field):W(n)||Io(n)||mg(n):!1}function iU(e,t){if(xt(t)){const n=e[t];if((W(n)||Io(n))&&(Sj(n.type)||W(n)&&n.timeUnit)){const r=tx(t);return rU(e,r)}}return!1}function oU(e){return lf(wme,t=>{if(Wu(e,t)){const n=e[t];if(I(n))return lf(n,r=>!!r.aggregate);{const r=zi(n);return r&&!!r.aggregate}}return!1})}function sU(e,t){const n=[],r=[],i=[],o=[],s={};return M3(e,(a,u)=>{if(W(a)){const{field:l,aggregate:c,bin:f,timeUnit:d,...h}=a;if(c||d||f){const p=C3(a),g=p==null?void 0:p.title;let y=Y(a,{forAs:!0});const m={...g?[]:{title:Tc(a,t,{allowDisabling:!0})},...h,field:y};if(c){let v;if(ru(c)?(v="argmax",y=Y({op:"argmax",field:c.argmax},{forAs:!0}),m.field=`${y}.${l}`):bs(c)?(v="argmin",y=Y({op:"argmin",field:c.argmin},{forAs:!0}),m.field=`${y}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const x={op:v,as:y};l&&(x.field=l),o.push(x)}}else if(n.push(y),Wn(a)&&Ye(f)){if(r.push({bin:f,field:l,as:y}),n.push(Y(a,{binSuffix:"end"})),yg(a,u)&&n.push(Y(a,{binSuffix:"range"})),xt(u)){const v={field:`${y}_end`};s[`${u}2`]=v}m.bin="binned",qB(u)||(m.type=dl)}else if(d&&!Ol(d)){i.push({timeUnit:d,field:l,as:y});const v=Wn(a)&&a.type!==hf&&"time";v&&(u===ug||u===cl?m.formatType=v:Mme(u)?m.legend={formatType:v,...m.legend}:xt(u)&&(m.axis={formatType:v,...m.axis}))}s[u]=m}else n.push(l),s[u]=e[u]}else s[u]=e[u]}),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:s}}function bye(e,t,n){const r=Nme(t,n);if(r){if(r==="binned"){const i=e[t===Wi?nt:Vt];return!!(W(i)&&W(e[t])&&Xt(i.bin))}}else return!1;return!0}function Eye(e,t,n,r){const i={};for(const o of B(e))WB(o)||U(v0e(o));for(let o of $me){if(!e[o])continue;const s=e[o];if(cg(o)){const a=kme(o),u=i[a];if(W(u)&&y1e(u.type)&&W(s)&&!u.timeUnit){U(d0e(a));continue}}if(o==="angle"&&t==="arc"&&!e.theta&&(U(f0e),o=ai),!bye(e,o,t)){U(ox(o,t));continue}if(o===Cs&&t==="line"){const a=zi(e[o]);if(a!=null&&a.aggregate){U(y0e);continue}}if(o===cr&&(n?"fill"in e:"stroke"in e)){U(aj("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(o===lg||o===ff&&!I(s)&&!Li(s)||o===cl&&I(s)){if(s){if(o===ff){const a=e[o];if(Vj(a)){i[o]=a;continue}}i[o]=K(s).reduce((a,u)=>(W(u)?a.push(F3(u,o)):U(CS(u,o)),a),[])}}else{if(o===cl&&s===null)i[o]=null;else if(!W(s)&&!Io(s)&&!Li(s)&&!gg(s)&&!ne(s)){U(CS(s,o));continue}i[o]=Zj(s,o,r)}}return i}function vx(e,t){const n={};for(const r of B(e)){const i=Zj(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function Sye(e){const t=[];for(const n of B(e))if(Wu(e,n)){const r=e[n],i=K(r);for(const o of i)W(o)?t.push(o):px(o)&&t.push(o.condition)}return t}function M3(e,t,n){if(e)for(const r of B(e)){const i=e[r];if(I(i))for(const o of i)t.call(n,o,r);else t.call(n,i,r)}}function _ye(e,t,n,r){return e?B(e).reduce((i,o)=>{const s=e[o];return I(s)?s.reduce((a,u)=>t.call(r,a,u,o),i):t.call(r,i,s,o)},n):n}function aU(e,t){return B(t).reduce((n,r)=>{switch(r){case nt:case Vt:case Zv:case ex:case Jv:case Wi:case Ro:case Za:case Hf:case ai:case $s:case qi:case ks:case Hi:case Vi:case Gi:case oi:case ug:case fr:case Fl:case cl:return n;case ff:if(e==="line"||e==="trail")return n;case lg:case Kv:{const i=t[r];if(I(i)||W(i))for(const o of K(i))o.aggregate||n.push(Y(o,{}));return n}case Cs:if(e==="trail")return n;case cr:case Do:case Po:case As:case Ja:case eu:case nu:case tu:{const i=zi(t[r]);return i&&!i.aggregate&&n.push(Y(i,{})),n}}},[])}function kye(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let r,i;if(I(t)){for(const o of t)o.aggregate?(r||(r=[]),r.push(o)):(i||(i=[]),i.push(o));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return I(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function TS(e,t,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};const i=e.map(({fieldPrefix:s,titlePrefix:a})=>{const u=r?` of ${T3(t)}`:"";return{field:s+t.field,type:t.type,title:ne(a)?{signal:`${a}"${escape(u)}"`}:a+u}}),o=Sye(n).map(aye);return{tooltip:[...i,...uo(o,_e)]}}function T3(e){const{title:t,field:n}=e;return vt(t,n)}function N3(e,t,n,r,i){const{scale:o,axis:s}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=T3(n);return uU(e,a,i,{mark:u,encoding:{[t]:{field:`${l}_${n.field}`,type:n.type,...d!==void 0?{title:d}:{},...o!==void 0?{scale:o}:{},...s!==void 0?{axis:s}:{}},...Z(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...r,...f}})}}function uU(e,t,n,r){const{clip:i,color:o,opacity:s}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[{...r,mark:{...n[t],...i?{clip:i}:{},...o?{color:o}:{},...s?{opacity:s}:{},...ko(r.mark)?r.mark:{type:r.mark},style:`${a}-${String(t)}`,...Ha(e[t])?{}:e[t]}}]:[]}function lU(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",o=r[i],s=r[`${i}2`],a=r[`${i}Error`],u=r[`${i}Error2`];return{continuousAxisChannelDef:gm(o,n),continuousAxisChannelDef2:gm(s,n),continuousAxisChannelDefError:gm(a,n),continuousAxisChannelDefError2:gm(u,n),continuousAxis:i}}function gm(e,t){if(e!=null&&e.aggregate){const{aggregate:n,...r}=e;return n!==t&&U(V0e(n,t)),r}else return e}function cU(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(ko(n)&&n.orient)return n.orient;if(aa(i)){if(aa(o)){const s=W(i)&&i.aggregate,a=W(o)&&o.aggregate;if(!s&&a===t)return"vertical";if(!a&&s===t)return"horizontal";if(s===t&&a===t)throw new Error("Both x and y cannot have aggregate");return yf(o)&&!yf(i)?"horizontal":"vertical"}return"horizontal"}else{if(aa(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const uy="boxplot",$ye=["box","median","outliers","rule","ticks"],Cye=new yx(uy,dU);function fU(e){return Ae(e)?"tukey":e}function dU(e,{config:t}){e={...e,encoding:vx(e.encoding,t)};const{mark:n,encoding:r,params:i,projection:o,...s}=e,a=ko(n)?n:{type:n};i&&U(oj("boxplot"));const u=a.extent??t.boxplot.extent,l=Ie("size",a,t),c=a.invalid,f=fU(u),{bins:d,timeUnits:h,transform:p,continuousAxisChannelDef:g,continuousAxis:y,groupby:m,aggregate:v,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:b,customTooltipWithoutAggregatedField:S}=Aye(e,u,t),E=qf(g.field),{color:_,size:k,...$}=x,C=Eg=>N3(a,y,g,Eg,t.boxplot),R=C($),A=C(x),M=(Q(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8",F=C({...$,...k?{size:k}:{},color:{condition:{test:`datum['lower_box_${g.field}'] >= datum['upper_box_${g.field}']`,..._||{value:M}}}}),N=TS([{fieldPrefix:f==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:f==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],g,x),P={type:"tick",color:"black",opacity:1,orient:w,invalid:c,aria:!1},T=f==="min-max"?N:TS([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,x),O=[...R({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:T}),...R({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:T}),...R({partName:"ticks",mark:P,positionPrefix:"lower_whisker",extraEncoding:T}),...R({partName:"ticks",mark:P,positionPrefix:"upper_whisker",extraEncoding:T})],j=[...f!=="tukey"?O:[],...A({partName:"box",mark:{type:"bar",...l?{size:l}:{},orient:b,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:N}),...F({partName:"median",mark:{type:"tick",invalid:c,...Q(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...l?{size:l}:{},orient:w,aria:!1},positionPrefix:"mid_box",extraEncoding:N})];if(f==="min-max")return{...s,transform:(s.transform??[]).concat(p),layer:j};const X=`datum["lower_box_${g.field}"]`,re=`datum["upper_box_${g.field}"]`,we=`(${re} - ${X})`,he=`${X} - ${u} * ${we}`,Re=`${re} + ${u} * ${we}`,Nt=`datum["${g.field}"]`,Dr={joinaggregate:hU(g.field),groupby:m},Ns={transform:[{filter:`(${he} <= ${Nt}) && (${Nt} <= ${Re})`},{aggregate:[{op:"min",field:g.field,as:`lower_whisker_${E}`},{op:"max",field:g.field,as:`upper_whisker_${E}`},{op:"min",field:`lower_box_${g.field}`,as:`lower_box_${E}`},{op:"max",field:`upper_box_${g.field}`,as:`upper_box_${E}`},...v],groupby:m}],layer:O},{tooltip:J,...me}=$,{scale:ve,axis:H}=g,Gt=T3(g),Le=or(H,["title"]),sn=uU(a,"outliers",t.boxplot,{transform:[{filter:`(${Nt} < ${he}) || (${Nt} > ${Re})`}],mark:"point",encoding:{[y]:{field:g.field,type:g.type,...Gt!==void 0?{title:Gt}:{},...ve!==void 0?{scale:ve}:{},...Ue(Le)?{}:{axis:Le}},...me,..._?{color:_}:{},...S?{tooltip:S}:{}}})[0];let Ot;const Yi=[...d,...h,Dr];return sn?Ot={transform:Yi,layer:[sn,Ns]}:(Ot=Ns,Ot.transform.unshift(...Yi)),{...s,layer:[Ot,{transform:p,layer:j}]}}function hU(e){const t=qf(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}]}function Aye(e,t,n){const r=cU(e,uy),{continuousAxisChannelDef:i,continuousAxis:o}=lU(e,r,uy),s=i.field,a=qf(s),u=fU(t),l=[...hU(s),{op:"median",field:s,as:`mid_box_${a}`},{op:"min",field:s,as:(u==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:s,as:(u==="min-max"?"upper_whisker_":"max_")+a}],c=u==="min-max"||u==="tukey"?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],{[o]:f,...d}=e.encoding,{customTooltipWithoutAggregatedField:h,filteredEncoding:p}=kye(d),{bins:g,timeUnits:y,aggregate:m,groupby:v,encoding:x}=sU(p,n),w=r==="vertical"?"horizontal":"vertical",b=r,S=[...g,...y,{aggregate:[...m,...l],groupby:v},...c];return{bins:g,timeUnits:y,transform:S,groupby:v,aggregate:m,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:b,customTooltipWithoutAggregatedField:h}}const O3="errorbar",Fye=["ticks","rule"],Mye=new yx(O3,pU);function pU(e,{config:t}){e={...e,encoding:vx(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:u,tooltipEncoding:l}=gU(e,O3,t);delete o.size;const c=N3(a,i,r,o,t.errorbar),f=a.thickness,d=a.size,h={type:"tick",orient:s,aria:!1,...f!==void 0?{thickness:f}:{},...d!==void 0?{size:d}:{}},p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...f!==void 0?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return{...u,transform:n,...p.length>1?{layer:p}:{...p[0]}}}function Tye(e,t){const{encoding:n}=e;if(Nye(n))return{orient:cU(e,t),inputType:"raw"};const r=Oye(n),i=Rye(n),o=n.x,s=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(de(a)&&de(u))throw new Error(`${t} cannot have both x2 and y2`);if(de(a)){if(aa(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(de(u)){if(aa(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(de(u)&&!de(a))throw new Error(`${t} cannot have xError2 without xError`);if(de(c)&&!de(l))throw new Error(`${t} cannot have yError2 without yError`);if(de(a)&&de(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(de(a)){if(aa(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(de(l)){if(aa(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function Nye(e){return(de(e.x)||de(e.y))&&!de(e.x2)&&!de(e.y2)&&!de(e.xError)&&!de(e.xError2)&&!de(e.yError)&&!de(e.yError2)}function Oye(e){return de(e.x2)||de(e.y2)}function Rye(e){return de(e.xError)||de(e.xError2)||de(e.yError)||de(e.yError2)}function gU(e,t,n){const{mark:r,encoding:i,params:o,projection:s,...a}=e,u=ko(r)?r:{type:r};o&&U(oj(t));const{orient:l,inputType:c}=Tye(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:g}=lU(e,l,t),{errorBarSpecificAggregate:y,postAggregateCalculates:m,tooltipSummary:v,tooltipTitleWithFieldName:x}=Dye(u,f,d,h,p,c,t,n),{[g]:w,[g==="x"?"x2":"y2"]:b,[g==="x"?"xError":"yError"]:S,[g==="x"?"xError2":"yError2"]:E,..._}=i,{bins:k,timeUnits:$,aggregate:C,groupby:R,encoding:A}=sU(_,n),M=[...C,...y],F=c!=="raw"?[]:R,N=TS(v,f,A,x);return{transform:[...a.transform??[],...k,...$,...M.length===0?[]:[{aggregate:M,groupby:F}],...m],groupby:F,continuousAxisChannelDef:f,continuousAxis:g,encodingWithoutContinuousAxis:A,ticksOrient:l==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:a,tooltipEncoding:N}}function Dye(e,t,n,r,i,o,s,a){let u=[],l=[];const c=t.field;let f,d=!1;if(o==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&U(H0e(h,p,s)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:ag(h)},{fieldPrefix:"upper_",titlePrefix:DR(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:DR(h,p,"-")}],d=!0;else{let g,y,m;p==="ci"?(g="mean",y="ci0",m="ci1"):(g="median",y="q1",m="q3"),u=[{op:y,field:c,as:`lower_${c}`},{op:m,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:Tc({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Tc({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Tc({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&U(q0e(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:ll(ll(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function DR(e,t,n){return`${ag(e)} ${n} ${t}`}const R3="errorband",Pye=["band","borders"],Lye=new yx(R3,mU);function mU(e,{config:t}){e={...e,encoding:vx(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:a,tooltipEncoding:u}=gU(e,R3,t),l=s,c=N3(l,i,r,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p={...l.interpolate?{interpolate:l.interpolate}:{},...l.tension&&l.interpolate?{tension:l.tension}:{}};return f?(d={...d,...p,ariaRoleDescription:"errorband"},h={...h,...p,aria:!1}):l.interpolate?U($R("interpolate")):l.tension&&U($R("tension")),{...a,transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]}}const yU={};function D3(e,t,n){const r=new yx(e,t);yU[e]={normalizer:r,parts:n}}function zye(){return B(yU)}D3(uy,dU,$ye);D3(O3,pU,Fye);D3(R3,mU,Pye);const Iye=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],vU={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},xU={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Bye=B(vU),jye=B(xU),Uye={header:1,headerRow:1,headerColumn:1,headerFacet:1},wU=B(Uye),bU=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Wye={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},qye={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Ii="_vgsid_",Hye={point:{on:"click",fields:[Ii],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function P3(e){return e==="legend"||!!(e!=null&&e.legend)}function Sw(e){return P3(e)&&Q(e)}function L3(e){return!!(e!=null&&e.select)}function EU(e){const t=[];for(const n of e||[]){if(L3(n))continue;const{expr:r,bind:i,...o}=n;if(i&&r){const s={...o,bind:i,init:r};t.push(s)}else{const s={...o,...r?{update:r}:{},...i?{bind:i}:{}};t.push(s)}}return t}function Vye(e){return xx(e)||I3(e)||z3(e)}function z3(e){return"concat"in e}function xx(e){return"vconcat"in e}function I3(e){return"hconcat"in e}function SU({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function $o(e){return Q(e)&&e.step!==void 0}function PR(e){return e.view||e.width||e.height}const LR=20,Gye={align:1,bounds:1,center:1,columns:1,spacing:1},Yye=B(Gye);function Xye(e,t,n){const r=n[t],i={},{spacing:o,columns:s}=r;o!==void 0&&(i.spacing=o),s!==void 0&&(hx(e)&&!pg(e.facet)||z3(e))&&(i.columns=s),xx(e)&&(i.columns=1);for(const a of Yye)if(e[a]!==void 0)if(a==="spacing"){const u=e[a];i[a]=Ae(u)?u:{row:u.row??o,column:u.column??o}}else i[a]=e[a];return i}function NS(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function ly(e,t){const n=cy(e,t);return $o(n)?n.step:_U}function cy(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return vt(n,{step:e.step})}const _U=20,Qye={continuousWidth:200,continuousHeight:200,step:_U},Kye={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Qye,mark:U1e,arc:{},area:{},bar:H1e,circle:{},geoshape:{},image:{},line:{},point:{},rect:V1e,rule:{color:"black"},square:{},text:{color:"black"},tick:G1e,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:S1e,projection:{},legend:Wye,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Hye,style:{},title:{},facet:{spacing:LR},concat:{spacing:LR},normalizedNumberFormat:".0%"},Wo=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],zR={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},IR={blue:Wo[0],orange:Wo[1],red:Wo[2],teal:Wo[3],green:Wo[4],yellow:Wo[5],purple:Wo[6],pink:Wo[7],brown:Wo[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Zye(e={}){return{signals:[{name:"color",value:Q(e)?{...IR,...e}:IR}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Jye(e){return{signals:[{name:"fontSize",value:Q(e)?{...zR,...e}:zR}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function eve(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function kU(e){const t=B(e||{}),n={};for(const r of t){const i=e[r];n[r]=vg(i)?ZB(i):xr(i)}return n}function tve(e){const t=B(e),n={};for(const r of t)n[r]=kU(e[r]);return n}const nve=[...Oj,...nU,...wU,"background","padding","legend","lineBreak","scale","style","title","view"];function $U(e={}){const{color:t,font:n,fontSize:r,selection:i,...o}=e,s=Af({},fe(Kye),n?eve(n):{},t?Zye(t):{},r?Jye(r):{},o||{});i&&Ff(s,"selection",i,!0);const a=or(s,nve);for(const u of["background","lineBreak","padding"])s[u]&&(a[u]=xr(s[u]));for(const u of Oj)s[u]&&(a[u]=gn(s[u]));for(const u of nU)s[u]&&(a[u]=kU(s[u]));for(const u of wU)s[u]&&(a[u]=gn(s[u]));if(s.legend&&(a.legend=gn(s.legend)),s.scale){const{invalid:u,...l}=s.scale,c=gn(u,{level:1});a.scale={...gn(l),...B(c).length>0?{invalid:c}:{}}}return s.style&&(a.style=tve(s.style)),s.title&&(a.title=gn(s.title)),s.view&&(a.view=gn(s.view)),a}const rve=new Set(["view",...P1e]),ive=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],ove={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...j1e};function sve(e){e=fe(e);for(const t of ive)delete e[t];if(e.axis)for(const t in e.axis)vg(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of Iye)delete e.legend[t];if(e.mark){for(const t of AR)delete e.mark[t];e.mark.tooltip&&Q(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(EU(e.params)),delete e.params);for(const t of rve){for(const r of AR)delete e[t][r];const n=ove[t];if(n)for(const r of n)delete e[t][r];uve(e,t)}for(const t of zye())delete e[t];ave(e);for(const t in e)Q(e[t])&&Ue(e[t])&&delete e[t];return Ue(e)?void 0:e}function ave(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=KB(e.title);Ue(t)||(e.style["group-title"]={...e.style["group-title"],...t}),Ue(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),Ue(r)?delete e.title:e.title=r}function uve(e,t,n,r){const i=e[t];t==="view"&&(n="cell");const o={...i,...e.style[n??t]};Ue(o)||(e.style[n??t]=o),delete e[t]}function wx(e){return"layer"in e}function lve(e){return"repeat"in e}function cve(e){return!I(e.repeat)&&e.repeat.layer}class B3{map(t,n){return hx(t)?this.mapFacet(t,n):lve(t)?this.mapRepeat(t,n):I3(t)?this.mapHConcat(t,n):xx(t)?this.mapVConcat(t,n):z3(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(wx(t))return this.mapLayer(t,n);if(Ms(t))return this.mapUnit(t,n);throw new Error(i3(t))}mapLayer(t,n){return{...t,layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(r=>this.map(r,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(r=>this.map(r,n))}}mapConcat(t,n){const{concat:r,...i}=t;return{...i,concat:r.map(o=>this.map(o,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const fve={zero:1,center:1,normalize:1};function dve(e){return e in fve}const hve=new Set([Mj,lx,ux,ny,fx,x3,w3,cx,Tj,v3]),pve=new Set([lx,ux,Mj]);function Yl(e){return W(e)&&gf(e)==="quantitative"&&!e.bin}function BR(e,t,{orient:n,type:r}){const i=t==="x"?"y":"radius",o=t==="x"&&["bar","area"].includes(r),s=e[t],a=e[i];if(W(s)&&W(a))if(Yl(s)&&Yl(a)){if(s.stack)return t;if(a.stack)return i;const u=W(s)&&!!s.aggregate,l=W(a)&&!!a.aggregate;if(u!==l)return u?t:i;if(o){if(n==="vertical")return i;if(n==="horizontal")return t}}else{if(Yl(s))return t;if(Yl(a))return i}else{if(Yl(s))return o&&n==="vertical"?void 0:t;if(Yl(a))return o&&n==="horizontal"?void 0:i}}function gve(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function CU(e,t){var g,y;const n=ko(e)?e:{type:e},r=n.type;if(!hve.has(r))return null;const i=BR(t,"x",n)||BR(t,"theta",n);if(!i)return null;const o=t[i],s=W(o)?Y(o,{}):void 0,a=gve(i),u=[],l=new Set;if(t[a]){const m=t[a],v=W(m)?Y(m,{}):void 0;v&&v!==s&&(u.push(a),l.add(v))}const c=a==="x"?"xOffset":"yOffset",f=t[c],d=W(f)?Y(f,{}):void 0;d&&d!==s&&(u.push(c),l.add(d));const h=Cme.reduce((m,v)=>{if(v!=="tooltip"&&Wu(t,v)){const x=t[v];for(const w of K(x)){const b=zi(w);if(b.aggregate)continue;const S=Y(b,{});(!S||!l.has(S))&&m.push({channel:v,fieldDef:b})}}return m},[]);let p;return o.stack!==void 0?Ha(o.stack)?p=o.stack?"zero":null:p=o.stack:pve.has(r)&&(p="zero"),!p||!dve(p)||oU(t)&&h.length===0?null:((g=o==null?void 0:o.scale)!=null&&g.type&&((y=o==null?void 0:o.scale)==null?void 0:y.type)!==Qt.LINEAR&&o!=null&&o.stack&&U(j0e(o.scale.type)),de(t[Lo(i)])?(o.stack!==void 0&&U(B0e(i)),null):(W(o)&&o.aggregate&&!Ime.has(o.aggregate)&&U(U0e(o.aggregate)),{groupbyChannels:u,groupbyFields:l,fieldChannel:i,impute:o.impute===null?!1:ou(r),stackBy:h,offset:p}))}function AU(e,t,n){const r=gn(e),i=Ie("orient",r,n);if(r.orient=xve(r.type,t,i),i!==void 0&&i!==r.orient&&U(_0e(r.orient,i)),r.type==="bar"&&r.orient){const u=Ie("cornerRadiusEnd",r,n);if(u!==void 0){const l=r.orient==="horizontal"&&t.x2||r.orient==="vertical"&&t.y2?["cornerRadius"]:q1e[r.orient];for(const c of l)r[c]=u;r.cornerRadiusEnd!==void 0&&delete r.cornerRadiusEnd}}const o=Ie("opacity",r,n),s=Ie("fillOpacity",r,n);return o===void 0&&s===void 0&&(r.opacity=yve(r.type,t)),Ie("cursor",r,n)===void 0&&(r.cursor=mve(r,t,n)),r}function mve(e,t,n){return t.href||e.href||Ie("href",e,n)?"pointer":e.cursor}function yve(e,t){if(be([fx,v3,x3,w3],e)&&!oU(t))return .7}function vve(e,t,{graticule:n}){if(n)return!1;const r=_o("filled",e,t),i=e.type;return vt(r,i!==fx&&i!==cx&&i!==ny)}function xve(e,t,n){switch(e){case fx:case x3:case w3:case Tj:case R1e:case O1e:return}const{x:r,y:i,x2:o,y2:s}=t;switch(e){case lx:if(W(r)&&(Xt(r.bin)||W(i)&&i.aggregate&&!r.aggregate))return"vertical";if(W(i)&&(Xt(i.bin)||W(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o)return(W(r)&&r.type===dl&&!Ye(r.bin)||iy(r))&&W(i)&&Xt(i.bin)?"horizontal":"vertical";if(!s)return(W(i)&&i.type===dl&&!Ye(i.bin)||iy(i))&&W(r)&&Xt(r.bin)?"vertical":"horizontal"}case ny:if(o&&!(W(r)&&Xt(r.bin))&&s&&!(W(i)&&Xt(i.bin)))return;case ux:if(s)return W(i)&&Xt(i.bin)?"horizontal":"vertical";if(o)return W(r)&&Xt(r.bin)?"vertical":"horizontal";if(e===ny){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case cx:case v3:{const a=NR(r),u=NR(i);if(n)return n;if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u)return"vertical";{const l=Wn(r)&&r.type===hf,c=Wn(i)&&i.type===hf;if(l&&!c)return"vertical";if(!l&&c)return"horizontal"}return}}return"vertical"}function wve(e){const{point:t,line:n,...r}=e;return B(r).length>1?r:r.type}function bve(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:or(e[t],["point","line"])});return e}function _w(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?Q(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?Q(t.point)?t.point:{}:void 0}function jR(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Eve{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Ms(t)){const{mark:r,encoding:i}=t,o=ko(r)?r:{type:r};switch(o.type){case"line":case"rule":case"trail":return!!_w(o,n[o.type],i);case"area":return!!_w(o,n[o.type],i)||!!jR(o,n[o.type])}}return!1}run(t,n,r){const{config:i}=n,{params:o,projection:s,mark:a,name:u,encoding:l,...c}=t,f=vx(l,i),d=ko(a)?a:{type:a},h=_w(d,i[d.type],f),p=d.type==="area"&&jR(d,i[d.type]),g=[{name:u,...o?{params:o}:{},mark:wve({...d.type==="area"&&d.opacity===void 0&&d.fillOpacity===void 0?{opacity:.7}:{},...d}),encoding:or(f,["shape"])}],y=CU(AU(d,f,i),f);let m=f;if(y){const{fieldChannel:v,offset:x}=y;m={...f,[v]:{...f[v],...x?{stack:x}:{}}}}return m=or(m,["y2","x2"]),p&&g.push({...s?{projection:s}:{},mark:{type:"line",...uf(d,["clip","interpolate","tension","tooltip"]),...p},encoding:m}),h&&g.push({...s?{projection:s}:{},mark:{type:"point",opacity:1,filled:!0,...uf(d,["clip","tooltip"]),...h},encoding:m}),r({...c,layer:g},{...n,config:bve(i)})}}function Sve(e,t){return t?pg(e)?MU(e,t):FU(e,t):e}function kw(e,t){return t?MU(e,t):e}function OS(e,t,n){const r=t[e];if(oye(r)){if(r.repeat in n)return{...t,[e]:n[r.repeat]};U(i0e(r.repeat));return}return t}function FU(e,t){if(e=OS("field",e,t),e!==void 0){if(e===null)return null;if($3(e)&&fs(e.sort)){const n=OS("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function UR(e,t){if(W(e))return FU(e,t);{const n=OS("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function WR(e,t){if(de(e)){const n=UR(e,t);if(n)return n;if(gg(e))return{condition:e.condition}}else{if(mg(e)){const n=UR(e.condition,t);if(n)return{...e,condition:n};{const{condition:r,...i}=e;return i}}return e}}function MU(e,t){const n={};for(const r in e)if(ae(e,r)){const i=e[r];if(I(i))n[r]=i.map(o=>WR(o,t)).filter(o=>o);else{const o=WR(i,t);o!==void 0&&(n[r]=o)}}return n}class _ve{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Ms(t)){const{encoding:n,mark:r}=t;if(r==="line"||ko(r)&&r.type==="line")for(const i of _me){const o=Ml(i),s=n[o];if(n[i]&&(W(s)&&!Xt(s.bin)||Io(s)))return!0}}return!1}run(t,n,r){const{encoding:i,mark:o}=t;return U(S0e(!!i.x2,!!i.y2)),r({...t,mark:Q(o)?{...o,type:"rule"}:"rule"},n)}}class kve extends B3{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[Cye,Mye,Lye,new Eve,new _ve]}map(t,n){if(Ms(t)){const r=Wu(t.encoding,ls),i=Wu(t.encoding,cs),o=Wu(t.encoding,Qv);if(r||i||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,o=kw(t.encoding,n.repeater),s={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(u=>u).join("_")}:{},...o?{encoding:o}:{}};if(r||i)return this.mapUnitWithParentEncodingOrProjection(s,n);const a=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(s,n.config))return u.run(s,n,a);return s}mapRepeat(t,n){return cve(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i,...o}=t,{row:s,column:a,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return s||a?this.mapRepeat({...t,repeat:{...s?{row:s}:{},...a?{column:a}:{}},spec:{repeat:{layer:u},spec:i}},n):{...o,layer:u.map(f=>{const d={...l,layer:f},h=`${(i.name?`${i.name}_`:"")+c}child__layer_${tt(f)}`,p=this.mapLayerOrUnit(i,{...n,repeater:d,repeaterPrefix:h});return p.name=h,p})}}mapNonLayerRepeat(t,n){const{repeat:r,spec:i,data:o,...s}=t;!I(r)&&t.columns&&(t=or(t,["columns"]),U(ER("repeat")));const a=[],{repeater:u={},repeaterPrefix:l=""}=n,c=!I(r)&&r.row||[u?u.row:null],f=!I(r)&&r.column||[u?u.column:null],d=I(r)&&r||[u?u.repeat:null];for(const p of d)for(const g of c)for(const y of f){const m={repeat:p,row:g,column:y,layer:u.layer},v=(i.name?`${i.name}_`:"")+l+"child__"+(I(r)?`${tt(p)}`:(r.row?`row_${tt(g)}`:"")+(r.column?`column_${tt(y)}`:"")),x=this.map(i,{...n,repeater:m,repeaterPrefix:v});x.name=v,a.push(or(x,["data"]))}const h=I(r)?t.columns:r.column?r.column.length:1;return{data:i.data??o,align:"all",...s,columns:h,concat:a}}mapFacet(t,n){const{facet:r}=t;return pg(r)&&t.columns&&(t=or(t,["columns"]),U(ER("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:o,parentProjection:s,config:a}=n,u=HR({parentProjection:s,projection:i}),l=qR({parentEncoding:o,encoding:kw(r,n.repeater)});return this.mapUnit({...t,...u?{projection:u}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(t,n){const{row:r,column:i,facet:o,...s}=t.encoding,{mark:a,width:u,projection:l,height:c,view:f,params:d,encoding:h,...p}=t,{facetMapping:g,layout:y}=this.getFacetMappingAndLayout({row:r,column:i,facet:o},n),m=kw(s,n.repeater);return this.mapFacet({...p,...y,facet:g,spec:{...u?{width:u}:{},...c?{height:c}:{},...f?{view:f}:{},...l?{projection:l}:{},mark:a,encoding:m,...d?{params:d}:{}}},n)}getFacetMappingAndLayout(t,n){const{row:r,column:i,facet:o}=t;if(r||i){o&&U(b0e([...r?[ls]:[],...i?[cs]:[]]));const s={},a={};for(const u of[ls,cs]){const l=t[u];if(l){const{align:c,center:f,spacing:d,columns:h,...p}=l;s[u]=p;for(const g of["align","center","spacing"])l[g]!==void 0&&(a[g]??(a[g]={}),a[g][u]=l[g])}}return{facetMapping:s,layout:a}}else{const{align:s,center:a,spacing:u,columns:l,...c}=o;return{facetMapping:Sve(c,n.repeater),layout:{...s?{align:s}:{},...a?{center:a}:{},...u?{spacing:u}:{},...l?{columns:l}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:r,...i}){const{encoding:o,projection:s,...a}=t,u={...i,parentEncoding:qR({parentEncoding:n,encoding:o,layer:!0}),parentProjection:HR({parentProjection:r,projection:s})};return super.mapLayer({...a,...t.name?{name:[u.repeaterPrefix,t.name].filter(l=>l).join("_")}:{}},u)}}function qR({parentEncoding:e,encoding:t={},layer:n}){let r={};if(e){const i=new Set([...B(e),...B(t)]);for(const o of i){const s=t[o],a=e[o];if(de(s)){const u={...a,...s};r[o]=u}else mg(s)?r[o]={...s,condition:{...a,...s.condition}}:s||s===null?r[o]=s:(n||Li(a)||ne(a)||de(a)||I(a))&&(r[o]=a)}}else r=t;return!r||Ue(r)?void 0:r}function HR(e){const{parentProjection:t,projection:n}=e;return t&&n&&U(c0e({parentProjection:t,projection:n})),n??t}function j3(e){return"filter"in e}function $ve(e){return(e==null?void 0:e.stop)!==void 0}function TU(e){return"lookup"in e}function Cve(e){return"data"in e}function Ave(e){return"param"in e}function Fve(e){return"pivot"in e}function Mve(e){return"density"in e}function Tve(e){return"quantile"in e}function Nve(e){return"regression"in e}function Ove(e){return"loess"in e}function Rve(e){return"sample"in e}function Dve(e){return"window"in e}function Pve(e){return"joinaggregate"in e}function Lve(e){return"flatten"in e}function zve(e){return"calculate"in e}function NU(e){return"bin"in e}function Ive(e){return"impute"in e}function Bve(e){return"timeUnit"in e}function jve(e){return"aggregate"in e}function Uve(e){return"stack"in e}function Wve(e){return"fold"in e}function qve(e){return"extent"in e&&!("density"in e)&&!("regression"in e)}function Hve(e){return e.map(t=>j3(t)?{filter:Fc(t.filter,m1e)}:t)}class Vve extends B3{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=VR(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=VR(t,n),t.encoding){const r={};for(const[i,o]of Da(t.encoding))r[i]=OU(o,n);t={...t,encoding:r}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:r,...i}=t;return r?{...i,params:Da(r).map(([o,s])=>{const{init:a,bind:u,empty:l,...c}=s;c.type==="single"?(c.type="point",c.toggle=!1):c.type==="multi"&&(c.type="point"),n.emptySelections[o]=l!=="none";for(const f of tn(n.selectionPredicates[o]??{}))f.empty=l!=="none";return{name:o,value:a,select:c,bind:u}})}:t}}function VR(e,t){const{transform:n,...r}=e;if(n){const i=n.map(o=>{if(j3(o))return{filter:RS(o,t)};if(NU(o)&&Tl(o.bin))return{...o,bin:RU(o.bin)};if(TU(o)){const{selection:s,...a}=o.from;return s?{...o,from:{param:s,...a}}:o}return o});return{...r,transform:i}}return e}function OU(e,t){var r,i;const n=fe(e);if(W(n)&&Tl(n.bin)&&(n.bin=RU(n.bin)),Rl(n)&&((i=(r=n.scale)==null?void 0:r.domain)!=null&&i.selection)){const{selection:o,...s}=n.scale.domain;n.scale.domain={...s,...o?{param:o}:{}}}if(gg(n))if(I(n.condition))n.condition=n.condition.map(o=>{const{selection:s,param:a,test:u,...l}=o;return a?o:{...l,test:RS(o,t)}});else{const{selection:o,param:s,test:a,...u}=OU(n.condition,t);n.condition=s?n.condition:{...u,test:RS(n.condition,t)}}return n}function RU(e){const t=e.extent;if(t!=null&&t.selection){const{selection:n,...r}=t;return{...e,extent:{...r,param:n}}}return e}function RS(e,t){const n=r=>Fc(r,i=>{var o;const s=t.emptySelections[i]??!0,a={param:i,empty:s};return(o=t.selectionPredicates)[i]??(o[i]=[]),t.selectionPredicates[i].push(a),a});return e.selection?n(e.selection):Fc(e.test||e.filter,r=>r.selection?n(r.selection):r)}class DS extends B3{map(t,n){const r=n.selections??[];if(t.params&&!Ms(t)){const i=[];for(const o of t.params)L3(o)?r.push(o):i.push(o);t.params=i}return n.selections=r,super.map(t,n)}mapUnit(t,n){const r=n.selections;if(!r||!r.length)return t;const i=(n.path??[]).concat(t.name),o=[];for(const s of r)if(!s.views||!s.views.length)o.push(s);else for(const a of s.views)(Z(a)&&(a===t.name||i.includes(a))||I(a)&&a.map(u=>i.indexOf(u)).every((u,l,c)=>u!==-1&&(l===0||u>c[l-1])))&&o.push(s);return o.length&&(t.params=o),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=DS.prototype[e];DS.prototype[e]=function(n,r){return t.call(this,n,Gve(n,r))}}function Gve(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function DU(e,t){t===void 0&&(t=$U(e.config));const n=Kve(e,t),{width:r,height:i}=e,o=Zve(n,{width:r,height:i,autosize:e.autosize},t);return{...n,...o?{autosize:o}:{}}}const Yve=new kve,Xve=new Vve,Qve=new DS;function Kve(e,t={}){const n={config:t};return Qve.map(Yve.map(Xve.map(e,n),n),n)}function GR(e){return Z(e)?{type:e}:e??{}}function Zve(e,t,n){let{width:r,height:i}=t;const o=Ms(e)||wx(e),s={};o?r=="container"&&i=="container"?(s.type="fit",s.contains="padding"):r=="container"?(s.type="fit-x",s.contains="padding"):i=="container"&&(s.type="fit-y",s.contains="padding"):(r=="container"&&(U(vR("width")),r=void 0),i=="container"&&(U(vR("height")),i=void 0));const a={type:"pad",...s,...n?GR(n.autosize):{},...GR(e.autosize)};if(a.type==="fit"&&!o&&(U(Gme),a.type="pad"),r=="container"&&!(a.type=="fit"||a.type=="fit-x")&&U(xR("width")),i=="container"&&!(a.type=="fit"||a.type=="fit-y")&&U(xR("height")),!Sr(a,{type:"pad"}))return a}function Jve(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function exe(e){return e?`fit-${nx(e)}`:"fit"}const txe=["background","padding"];function YR(e,t){const n={};for(const r of txe)e&&e[r]!==void 0&&(n[r]=xr(e[r]));return t&&(n.params=e.params),n}class Ts{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Ts(fe(this.explicit),fe(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return vt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:r}){n!==void 0&&this.set(t,n,r)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:r}){n[t]!==void 0?this.set(t,n[t],!0):r[t]!==void 0&&this.set(t,r[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of B(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function no(e){return{explicit:!0,value:e}}function gr(e){return{explicit:!1,value:e}}function PU(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:bx(t,n,r,i)}}function bx(e,t,n,r){return e.explicit&&t.explicit&&U(O0e(n,r,e.value,t.value)),e}function za(e,t,n,r,i=bx){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Sr(e.value,t.value)?e:i(e,t,n,r)}class nxe extends Ts{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function vf(e){return"url"in e}function wp(e){return"values"in e}function LU(e){return"name"in e&&!vf(e)&&!wp(e)&&!Ea(e)}function Ea(e){return e&&(zU(e)||IU(e)||U3(e))}function zU(e){return"sequence"in e}function IU(e){return"sphere"in e}function U3(e){return"graticule"in e}var pt;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup",e[e.PreFilterInvalid=5]="PreFilterInvalid",e[e.PostFilterInvalid=6]="PostFilterInvalid"})(pt||(pt={}));function BU({invalid:e,isPath:t}){switch(Dj(e,{isPath:t})){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"}}}function rxe(e){const{marks:t,scales:n}=BU(e);return t===n?pt.Main:n==="include-invalid-values"?pt.PreFilterInvalid:pt.PostFilterInvalid}function jU(e){const{signals:t,hasLegend:n,index:r,...i}=e;return i.field=ii(i.field),i}function gl(e,t=!0,n=$n){if(I(e)){const r=e.map(i=>gl(i,t,n));return t?`[${r.join(", ")}]`:r}else if(Nl(e))return n(t?fl(e):i1e(e));return t?n(We(e)):e}function ixe(e,t){for(const n of tn(e.component.selection??{})){const r=n.name;let i=`${r}${Ba}, ${n.resolve==="global"?"true":`{unit: ${qu(e)}}`}`;for(const o of kx)o.defined(n)&&(o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(i=o.modifyExpr(e,n,i)));t.push({name:r+Rxe,on:[{events:{signal:n.name+Ba},update:`modify(${V(n.name+ml)}, ${i})`}]})}return W3(t)}function oxe(e,t){if(e.component.selection&&B(e.component.selection).length){const n=V(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Ka("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return W3(t)}function sxe(e,t){let n=!1;for(const r of tn(e.component.selection??{})){const i=r.name,o=V(i+ml);if(t.filter(a=>a.name===i).length===0){const a=r.resolve==="global"?"union":r.resolve,u=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${oW}(${o}, ${V(a)}${u}`})}n=!0;for(const a of kx)a.defined(r)&&a.topLevelSignals&&(t=a.topLevelSignals(e,r,t))}return n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),W3(t)}function axe(e,t){const n=[...t],r=qu(e,{escape:!1});for(const i of tn(e.component.selection??{})){const o={name:i.name+ml};if(i.project.hasSelectionId&&(o.transform=[{type:"collect",sort:{field:Ii}}]),i.init){const a=i.project.items.map(jU);o.values=i.project.hasSelectionId?i.init.map(u=>({unit:r,[Ii]:gl(u,!1)[0]})):i.init.map(u=>({unit:r,fields:a,values:gl(u,!1)}))}n.filter(a=>a.name===i.name+ml).length||n.push(o)}return n}function UU(e,t){for(const n of tn(e.component.selection??{}))for(const r of kx)r.defined(n)&&r.marks&&(t=r.marks(e,n,t));return t}function uxe(e,t){for(const n of e.children)st(n)&&(t=UU(n,t));return t}function lxe(e,t,n,r){const i=cW(e,t.param,t);return{signal:Pi(n.get("type"))&&I(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}function W3(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class je{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){U(a0e);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this);const r=t.parent.removeChild(t);this._parent=n,n.addChild(this,r),t.parent=this}}class sr extends je{clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${DB()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}function $w(e){return e.as!==void 0}function XR(e){return`${e}_end`}class mo extends je{clone(){return new mo(null,fe(this.timeUnits))}constructor(t,n){super(t),this.timeUnits=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,s)=>{const{field:a,timeUnit:u}=o;if(u){let l;if(Ol(u)){if(st(n)){const{mark:c,markDef:f,config:d}=n,h=La({fieldDef:o,markDef:f,config:d});(xp(c)||h)&&(l={timeUnit:Wt(u),field:a})}}else l={as:Y(o,{forAs:!0}),field:a,timeUnit:u};if(st(n)){const{mark:c,markDef:f,config:d}=n,h=La({fieldDef:o,markDef:f,config:d});xp(c)&&xt(s)&&h!==.5&&(l.rectBandPosition=h)}l&&(i[_e(l)]=l)}return i},{});return Ue(r)?null:new mo(t,r)}static makeFromTransform(t,n){const{timeUnit:r,...i}={...n},o=Wt(r),s={...i,timeUnit:o};return new mo(t,{[_e(s)]:s})}merge(t){this.timeUnits={...this.timeUnits};for(const n in t.timeUnits)this.timeUnits[n]||(this.timeUnits[n]=t.timeUnits[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[r,i]of Da(this.timeUnits)){const o=$w(i)?i.as:`${i.field}_end`;t.has(o)||(n[r]=i)}this.timeUnits=n}producedFields(){return new Set(tn(this.timeUnits).map(t=>$w(t)?t.as:XR(t.field)))}dependentFields(){return new Set(tn(this.timeUnits).map(t=>t.field))}hash(){return`TimeUnit ${_e(this.timeUnits)}`}assemble(){const t=[];for(const n of tn(this.timeUnits)){const{rectBandPosition:r}=n,i=Wt(n.timeUnit);if($w(n)){const{field:o,as:s}=n,{unit:a,utc:u,...l}=i,c=[s,`${s}_end`];t.push({field:ii(o),type:"timeunit",...a?{units:sx(a)}:{},...u?{timezone:"utc"}:{},...l,as:c}),t.push(...QR(c,r,i))}else if(n){const{field:o}=n,s=o.replaceAll("\\.","."),a=WU({timeUnit:i,field:s}),u=XR(s);t.push({type:"formula",expr:a,as:u}),t.push(...QR([s,u],r,i))}}return t}}const Ex="offsetted_rect_start",Sx="offsetted_rect_end";function WU({timeUnit:e,field:t,reverse:n}){const{unit:r,utc:i}=e,o=mj(r),{part:s,step:a}=wj(o,e.step);return`${i?"utcOffset":"timeOffset"}('${s}', datum['${t}'], ${n?-a:a})`}function QR([e,t],n,r){if(n!==void 0&&n!==.5){const i=`datum['${e}']`,o=`datum['${t}']`;return[{type:"formula",expr:KR([WU({timeUnit:r,field:e,reverse:!0}),i],n+.5),as:`${e}_${Ex}`},{type:"formula",expr:KR([i,o],n+.5),as:`${e}_${Sx}`}]}return[]}function KR([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`}const xg="_tuple_fields";class cxe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const fxe={defined:()=>!0,parse:(e,t,n)=>{const r=t.name,i=t.project??(t.project=new cxe),o={},s={},a=new Set,u=(p,g)=>{const y=g==="visual"?p.channel:p.field;let m=tt(`${r}_${y}`);for(let v=1;a.has(m);v++)m=tt(`${r}_${y}_${v}`);return a.add(m),{[g]:m}},l=t.type,c=e.config.selection[l],f=n.value!==void 0?K(n.value):null;let{fields:d,encodings:h}=Q(n.select)?n.select:{};if(!d&&!h&&f){for(const p of f)if(Q(p))for(const g of B(p))Sme(g)?(h||(h=[])).push(g):l==="interval"?(U(r0e),h=c.encodings):(d??(d=[])).push(g)}!d&&!h&&(h=c.encodings,"fields"in c&&(d=c.fields));for(const p of h??[]){const g=e.fieldDef(p);if(g){let y=g.field;if(g.aggregate){U(Yme(p,g.aggregate));continue}else if(!y){U(bR(p));continue}if(g.timeUnit&&!Ol(g.timeUnit)){y=e.vgField(p);const m={timeUnit:g.timeUnit,as:y,field:g.field};s[_e(m)]=m}if(!o[y]){const m=l==="interval"&&zo(p)&&Pi(e.getScaleComponent(p).get("type"))?"R":g.bin?"R-RE":"E",v={field:y,channel:p,type:m,index:i.items.length};v.signals={...u(v,"data"),...u(v,"visual")},i.items.push(o[y]=v),i.hasField[y]=o[y],i.hasSelectionId=i.hasSelectionId||y===Ii,jB(p)?(v.geoChannel=p,v.channel=BB(p),i.hasChannel[v.channel]=o[y]):i.hasChannel[p]=o[y]}}else U(bR(p))}for(const p of d??[]){if(i.hasField[p])continue;const g={type:"E",field:p,index:i.items.length};g.signals={...u(g,"data")},i.items.push(g),i.hasField[p]=g,i.hasSelectionId=i.hasSelectionId||p===Ii}f&&(t.init=f.map(p=>i.items.map(g=>Q(p)?p[g.geoChannel||g.channel]!==void 0?p[g.geoChannel||g.channel]:p[g.field]:p))),Ue(s)||(i.timeUnit=new mo(null,s))},signals:(e,t,n)=>{const r=t.name+xg;return n.filter(o=>o.name===r).length>0||t.project.hasSelectionId?n:n.concat({name:r,value:t.project.items.map(jU)})}},ds={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!zo(i))continue;const o=e.getScaleComponent(i),s=o?o.get("type"):void 0;if(s=="sequential"&&U(Zme),!o||!Pi(s)){U(Kme);continue}o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(s=>n.filter(a=>a.name===s.signals.data).length===0);if(!e.parent||ZR(e)||r.length===0)return n;const i=n.find(s=>s.name===t.name);let o=i.update;if(o.includes(oW))i.update=`{${r.map(s=>`${V(ii(s.field))}: ${s.signals.data}`).join(", ")}}`;else{for(const s of r){const a=`${V(ii(s.field))}: ${s.signals.data}`;o.includes(a)||(o=`${o.substring(0,o.length-1)}, ${a}}`)}i.update=o}return n.concat(r.map(s=>({name:s.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!ZR(e))for(const r of t.scales){const i=n.find(o=>o.name===r.signals.data);i.push="outer",delete i.value,delete i.update}return n}};function PS(e,t){return`domain(${V(e.scaleName(t))})`}function ZR(e){return e.parent&&Kf(e.parent)&&!e.parent.parent}const Nc="_brush",qU="_scale_trigger",Cd="geo_interval_init_tick",HU="_init",dxe="_center",hxe={defined:e=>e.type==="interval",parse:(e,t,n)=>{var r;if(e.hasProjection){const i={...Q(n.select)?n.select:{}};i.fields=[Ii],i.encodings||(i.encodings=n.value?B(n.value):[Vi,Hi]),n.select={type:"interval",...i}}if(t.translate&&!ds.defined(t)){const i=`!event.item || event.item.mark.name !== ${V(t.name+Nc)}`;for(const o of t.events){if(!o.between){U(`${o} is not an ordered event stream for interval selections.`);continue}const s=K((r=o.between[0]).filter??(r.filter=[]));s.includes(i)||s.push(i)}}},signals:(e,t,n)=>{const r=t.name,i=r+Ba,o=tn(t.project.hasChannel).filter(a=>a.channel===nt||a.channel===Vt),s=t.init?t.init[0]:null;if(n.push(...o.reduce((a,u)=>a.concat(pxe(e,t,u,s&&s[u.index])),[])),e.hasProjection){const a=V(e.projectionName()),u=e.projectionName()+dxe,{x:l,y:c}=t.project.hasChannel,f=l&&l.signals.visual,d=c&&c.signals.visual,h=l?s&&s[l.index]:`${u}[0]`,p=c?s&&s[c.index]:`${u}[1]`,g=b=>e.getSizeSignalRef(b).signal,y=`[[${f?f+"[0]":"0"}, ${d?d+"[0]":"0"}],[${f?f+"[1]":g("width")}, ${d?d+"[1]":g("height")}]]`;s&&(n.unshift({name:r+HU,init:`[scale(${a}, [${l?h[0]:h}, ${c?p[0]:p}]), scale(${a}, [${l?h[1]:h}, ${c?p[1]:p}])]`}),(!l||!c)&&(n.find(S=>S.name===u)||n.unshift({name:u,update:`invert(${a}, [${g("width")}/2, ${g("height")}/2])`})));const m=`intersect(${y}, {markname: ${V(e.getName("marks"))}}, unit.mark)`,v=`{unit: ${qu(e)}}`,x=`vlSelectionTuples(${m}, ${v})`,w=o.map(b=>b.signals.visual);return n.concat({name:i,on:[{events:[...w.length?[{signal:w.join(" || ")}]:[],...s?[{signal:Cd}]:[]],update:x}]})}else{if(!ds.defined(t)){const l=r+qU,c=o.map(f=>{const d=f.channel,{data:h,visual:p}=f.signals,g=V(e.scaleName(d)),y=e.getScaleComponent(d).get("type"),m=Pi(y)?"+":"";return`(!isArray(${h}) || (${m}invert(${g}, ${p})[0] === ${m}${h}[0] && ${m}invert(${g}, ${p})[1] === ${m}${h}[1]))`});c.length&&n.push({name:l,value:{},on:[{events:o.map(f=>({scale:e.scaleName(f.channel)})),update:c.join(" && ")+` ? ${l} : {}`}]})}const a=o.map(l=>l.signals.data),u=`unit: ${qu(e)}, fields: ${r+xg}, values`;return n.concat({name:i,...s?{init:`{${u}: ${gl(s)}}`}:{},...a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${u}: [${a}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(st(e)&&e.hasProjection&&t.init&&(n.filter(i=>i.name===Cd).length||n.unshift({name:Cd,value:null,on:[{events:"timer{1}",update:`${Cd} === null ? {} : ${Cd}`}]})),n),marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,s=i==null?void 0:i.signals.visual,a=o==null?void 0:o.signals.visual,u=`data(${V(t.name+ml)})`;if(ds.defined(t)||!i&&!o)return n;const l={x:i!==void 0?{signal:`${s}[0]`}:{value:0},y:o!==void 0?{signal:`${a}[0]`}:{value:0},x2:i!==void 0?{signal:`${s}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const y of B(l))l[y]=[{test:`${u}.length && ${u}[0].unit === ${qu(e)}`,...l[y]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=t.mark,p=B(h).reduce((y,m)=>(y[m]=[{test:[i!==void 0&&`${s}[0] !== ${s}[1]`,o!==void 0&&`${a}[0] !== ${a}[1]`].filter(v=>v).join(" && "),value:h[m]},{value:null}],y),{}),g=d??(t.translate?"move":null);return[{name:`${r+Nc}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:l}},...n,{name:r+Nc,type:"rect",clip:!0,encode:{enter:{...g?{cursor:{value:g}}:{},fill:{value:"transparent"}},update:{...l,...p}}}]}};function pxe(e,t,n,r){const i=!e.hasProjection,o=n.channel,s=n.signals.visual,a=V(i?e.scaleName(o):e.projectionName()),u=d=>`scale(${a}, ${d})`,l=e.getSizeSignalRef(o===nt?"width":"height").signal,c=`${o}(unit)`,f=t.events.reduce((d,h)=>[...d,{events:h.between[0],update:`[${c}, ${c}]`},{events:h,update:`[${s}[0], clamp(${c}, 0, ${l})]`}],[]);if(i){const d=n.signals.data,h=ds.defined(t),p=e.getScaleComponent(o),g=p?p.get("type"):void 0,y=r?{init:gl(r,!0,u)}:{value:[]};return f.push({events:{signal:t.name+qU},update:Pi(g)?`[${u(`${d}[0]`)}, ${u(`${d}[1]`)}]`:"[0, 0]"}),h?[{name:d,on:[]}]:[{name:s,...y,on:f},{name:d,...r?{init:gl(r)}:{},on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${a}, ${s})`}]}]}else{const d=o===nt?0:1,h=t.name+HU,p=r?{init:`[${h}[0][${d}], ${h}[1][${d}]]`}:{value:[]};return[{name:s,...p,on:f}]}}const gxe={defined:e=>e.type==="point",signals:(e,t,n)=>{const r=t.name,i=r+xg,o=t.project,s="(item().isVoronoi ? datum.datum : datum)",a=tn(e.component.selection??{}).reduce((f,d)=>d.type==="interval"?f.concat(d.name+Nc):f,[]).map(f=>`indexof(item().mark.name, '${f}') < 0`).join(" && "),u=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${a?` && ${a}`:""}`;let l=`unit: ${qu(e)}, `;if(t.project.hasSelectionId)l+=`${Ii}: ${s}[${V(Ii)}]`;else{const f=o.items.map(d=>{const h=e.fieldDef(d.channel);return h!=null&&h.bin?`[${s}[${V(e.vgField(d.channel,{}))}], ${s}[${V(e.vgField(d.channel,{binSuffix:"end"}))}]]`:`${s}[${V(d.field)}]`}).join(", ");l+=`fields: ${i}, values: [${f}]`}const c=t.events;return n.concat([{name:r+Ba,on:c?[{events:c,update:`${u} ? {${l}} : null`,force:!0}]:[]}])}};function Gf({model:e,channelDef:t,vgChannel:n,invalidValueRef:r,mainRefFn:i}){const o=gg(t)&&t.condition;let s=[];o&&(s=K(o).map(l=>{const c=i(l);if(iye(l)){const{param:f,empty:d}=l;return{test:lW(e,{param:f,empty:d}),...c}}else return{test:hy(e,l.test),...c}})),r!==void 0&&s.push(r);const a=i(t);return a!==void 0&&s.push(a),s.length>1||s.length===1&&s[0].test?{[n]:s}:s.length===1?{[n]:s[0]}:{}}function q3(e,t="text"){const n=e.encoding[t];return Gf({model:e,channelDef:n,vgChannel:t,mainRefFn:r=>_x(r,e.config),invalidValueRef:void 0})}function _x(e,t,n="datum"){if(e){if(Li(e))return Ve(e.value);if(de(e)){const{format:r,formatType:i}=sy(e);return _3({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function VU(e,t={}){const{encoding:n,markDef:r,config:i,stack:o}=e,s=n.tooltip;if(I(s))return{tooltip:JR({tooltip:s},o,i,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return Gf({model:e,channelDef:s,vgChannel:"tooltip",mainRefFn:l=>{const c=_x(l,i,a);if(c)return c;if(l===null)return;let f=Ie("tooltip",r,i);if(f===!0&&(f={content:"encoding"}),Z(f))return{value:f};if(Q(f))return ne(f)?f:f.content==="encoding"?JR(n,o,i,t):{signal:a}},invalidValueRef:void 0})}}function GU(e,t,n,{reactiveGeom:r}={}){const i={...n,...n.tooltipFormat},o={},s=r?"datum.datum":"datum",a=[];function u(c,f){const d=Ml(f),h=Wn(c)?c:{...c,type:e[d].type},p=h.title||A3(h,i),g=K(p).join(", ").replaceAll(/"/g,'\\"');let y;if(xt(f)){const m=f==="x"?"x2":"y2",v=zi(e[m]);if(Xt(h.bin)&&v){const x=Y(h,{expr:s}),w=Y(v,{expr:s}),{format:b,formatType:S}=sy(h);y=hg(x,w,b,S,i),o[m]=!0}}if((xt(f)||f===ai||f===qi)&&t&&t.fieldChannel===f&&t.offset==="normalize"){const{format:m,formatType:v}=sy(h);y=_3({fieldOrDatumDef:h,format:m,formatType:v,expr:s,config:i,normalizeStack:!0}).signal}y??(y=_x(h,i,s).signal),a.push({channel:f,key:g,value:y})}M3(e,(c,f)=>{W(c)?u(c,f):px(c)&&u(c.condition,f)});const l={};for(const{channel:c,key:f,value:d}of a)!o[c]&&!l[f]&&(l[f]=d);return l}function JR(e,t,n,{reactiveGeom:r}={}){const i=GU(e,t,n,{reactiveGeom:r}),o=Da(i).map(([s,a])=>`"${s}": ${a}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function mxe(e){const{markDef:t,config:n}=e,r=Ie("aria",t,n);return r===!1?{}:{...r?{aria:r}:{},...yxe(e),...vxe(e)}}function yxe(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=Ie("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in Hme?{}:{ariaRoleDescription:{value:t}}}function vxe(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return Gf({model:e,channelDef:o,vgChannel:"description",mainRefFn:u=>_x(u,e.config),invalidValueRef:void 0});const s=Ie("description",n,r);if(s!=null)return{description:Ve(s)};if(r.aria===!1)return{};const a=GU(t,i,r);if(!Ue(a))return{description:{signal:Da(a).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function Pt(e,t,n={}){const{markDef:r,encoding:i,config:o}=t,{vgChannel:s}=n;let{defaultRef:a,defaultValue:u}=n;const l=i[e];a===void 0&&(u??(u=Ie(e,r,o,{vgChannel:s,ignoreVgConfig:!gg(l)})),u!==void 0&&(a=Ve(u)));const c={markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e)},f=Lj({...c,scaleChannel:e,channelDef:l});return Gf({model:t,channelDef:l,vgChannel:s??e,invalidValueRef:f,mainRefFn:h=>S3({...c,channel:e,channelDef:h,stack:null,defaultRef:a})})}function YU(e,t={filled:void 0}){const{markDef:n,encoding:r,config:i}=e,{type:o}=n,s=t.filled??Ie("filled",n,i),a=be(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,u=Ie(s===!0?"color":void 0,n,i,{vgChannel:"fill"})??i.mark[s===!0&&"color"]??a,l=Ie(s===!1?"color":void 0,n,i,{vgChannel:"stroke"})??i.mark[s===!1&&"color"],c=s?"fill":"stroke",f={...u?{fill:Ve(u)}:{},...l?{stroke:Ve(l)}:{}};return n.color&&(s?n.fill:n.stroke)&&U(aj("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...Pt("color",e,{vgChannel:c,defaultValue:s?u:l}),...Pt("fill",e,{defaultValue:r.fill?u:void 0}),...Pt("stroke",e,{defaultValue:r.stroke?l:void 0})}}function xxe(e){const{encoding:t,mark:n}=e,r=t.order;return!ou(n)&&Li(r)?Gf({model:e,channelDef:r,vgChannel:"zindex",mainRefFn:i=>Ve(i.value),invalidValueRef:void 0}):{}}function xf({channel:e,markDef:t,encoding:n={},model:r,bandPosition:i}){const o=`${e}Offset`,s=t[o],a=n[o];if((o==="xOffset"||o==="yOffset")&&a)return{offsetType:"encoding",offset:S3({channel:o,channelDef:a,markDef:t,config:r==null?void 0:r.config,scaleName:r.scaleName(o),scale:r.getScaleComponent(o),stack:null,defaultRef:Ve(s),bandPosition:i})};const u=t[o];return u?{offsetType:"visual",offset:u}:{}}function xn(e,t,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:o,config:s,stack:a}=t,u=i[e],l=i[Lo(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:h}=xf({channel:e,markDef:o,encoding:i,model:t,bandPosition:.5}),p=H3({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!u&&xt(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:wxe({channel:e,channelDef:u,channel2Def:l,markDef:o,config:s,scaleName:c,scale:f,stack:a,offset:d,defaultRef:p,bandPosition:h==="encoding"?0:void 0});return g?{[r||e]:g}:void 0}function wxe(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:s}=e;if(de(n)&&i&&t===i.fieldChannel){if(W(n)){let a=n.bandPosition;if(a===void 0&&s.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return ry({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:o})}return Uu(n,r,{suffix:"end"},{offset:o})}return E3(e)}function H3({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:o,config:s}=e;return()=>{const a=Ml(n),u=Pa(n),l=Ie(n,o,s,{vgChannel:u});if(l!==void 0)return Ah(n,l);switch(t){case"zeroOrMin":return e5({scaleName:r,scale:i,mode:"zeroOrMin",mainChannel:a,config:s});case"zeroOrMax":return e5({scaleName:r,scale:i,mode:{zeroOrMax:{widthSignal:e.width.signal,heightSignal:e.height.signal}},mainChannel:a,config:s});case"mid":return{...e[dr(n)],mult:.5}}}}function e5({mainChannel:e,config:t,...n}){const r=Pj(n),{mode:i}=n;if(r)return r;switch(e){case"radius":{if(i==="zeroOrMin")return{value:0};const{widthSignal:o,heightSignal:s}=i.zeroOrMax;return{signal:`min(${o},${s})/2`}}case"theta":return i==="zeroOrMin"?{value:0}:{signal:"2*PI"};case"x":return i==="zeroOrMin"?{value:0}:{field:{group:"width"}};case"y":return i==="zeroOrMin"?{field:{group:"height"}}:{value:0}}}const bxe={left:"x",center:"xc",right:"x2"},Exe={top:"y",middle:"yc",bottom:"y2"};function XU(e,t,n,r="middle"){if(e==="radius"||e==="theta")return Pa(e);const i=e==="x"?"align":"baseline",o=Ie(i,t,n);let s;return ne(o)?(U(E0e(i)),s=void 0):s=o,e==="x"?bxe[s||(r==="top"?"left":"center")]:Exe[s||r]}function fy(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?QU(e,t,{defaultPos:n,defaultPos2:r}):xn(e,t,{defaultPos:n})}function QU(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=t,s=Lo(e),a=dr(e),u=Sxe(t,r,s),l=u[a]?XU(e,i,o):Pa(e);return{...xn(e,t,{defaultPos:n,vgChannel:l}),...u}}function Sxe(e,t,n){const{encoding:r,mark:i,markDef:o,stack:s,config:a}=e,u=Ml(n),l=dr(n),c=Pa(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),{offset:p}=n in r||n in o?xf({channel:n,markDef:o,encoding:r,model:e}):xf({channel:u,markDef:o,encoding:r,model:e});if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude)){const y=dr(n),m=e.markDef[y];return m!=null?{[y]:{value:m}}:{[c]:{field:e.getName(n)}}}const g=_xe({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:a,scaleName:d,scale:h,stack:s,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:mm(n,o)||mm(n,{[n]:ey(n,o,a.style),[l]:ey(l,o,a.style)})||mm(n,a[i])||mm(n,a.mark)||{[c]:H3({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function _xe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l}){return de(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Uu(t,o,{suffix:"start"},{offset:u}):E3({channel:e,channelDef:n,scaleName:o,scale:s,stack:a,markDef:r,config:i,offset:u,defaultRef:l})}function mm(e,t){const n=dr(e),r=Pa(e);if(t[r]!==void 0)return{[r]:Ah(e,t[r])};if(t[e]!==void 0)return{[r]:Ah(e,t[e])};if(t[n]){const i=t[n];if(hl(i))U(m0e(n));else return{[n]:Ah(e,i)}}}function Ia(e,t){const{config:n,encoding:r,markDef:i}=e,o=i.type,s=Lo(t),a=dr(t),u=r[t],l=r[s],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=i.orient,h=r[a]??r.size??Ie("size",i,n,{vgChannel:a}),p=HB(t),g=o==="bar"&&(t==="x"?d==="vertical":d==="horizontal");return W(u)&&(Ye(u.bin)||Xt(u.bin)||u.timeUnit&&!l)&&!(h&&!hl(h))&&!r[p]&&!qt(f)?Cxe({fieldDef:u,fieldDef2:l,channel:t,model:e}):(de(u)&&qt(f)||g)&&!l?$xe(u,t,e):QU(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function kxe(e,t,n,r,i,o,s){if(hl(i))if(n){const u=n.get("type");if(u==="band"){let l=`bandwidth('${t}')`;i.band!==1&&(l=`${i.band} * ${l}`);const c=_o("minBandSize",{type:s},r);return{signal:c?`max(${$i(c)}, ${l})`:l}}else i.band!==1&&(U($0e(u)),i=void 0)}else return{mult:i.band,field:{group:e}};else{if(ne(i))return i;if(i)return{value:i}}if(n){const u=n.get("range");if(iu(u)&&Ae(u.step))return{value:u.step-2}}if(!o){const{bandPaddingInner:u,barBandPaddingInner:l,rectBandPaddingInner:c}=r.scale,f=vt(u,s==="bar"?l:c);if(ne(f))return{signal:`(1 - (${f.signal})) * ${e}`};if(Ae(f))return{signal:`${1-f} * ${e}`}}return{value:ly(r.view,e)-2}}function $xe(e,t,n){var k,$;const{markDef:r,encoding:i,config:o,stack:s}=n,a=r.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=dr(t),f=Lo(t),d=HB(t),h=n.scaleName(d),p=n.getScaleComponent(tx(t)),g=a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let y;(i.size||r.size)&&(g?y=Pt("size",n,{vgChannel:c,defaultRef:Ve(r.size)}):U(M0e(r.type)));const m=!!y,v=qj({channel:t,fieldDef:e,markDef:r,config:o,scaleType:(k=l||p)==null?void 0:k.get("type"),useVlSizeChannel:g});y=y||{[c]:kxe(c,h||u,p||l,o,v,!!e,r.type)};const x=(($=l||p)==null?void 0:$.get("type"))==="band"&&hl(v)&&!m?"top":"middle",w=XU(t,r,o,x),b=w==="xc"||w==="yc",{offset:S,offsetType:E}=xf({channel:t,markDef:r,encoding:i,model:n,bandPosition:b?.5:0}),_=E3({channel:t,channelDef:e,markDef:r,config:o,scaleName:u,scale:l,stack:s,offset:S,defaultRef:H3({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:b?E==="encoding"?0:.5:ne(v)?{signal:`(1-${v})/2`}:hl(v)?(1-v.band)/2:0});if(c)return{[w]:_,...y};{const C=Pa(f),R=y[c],A=S?{...R,offset:S}:R;return{[w]:_,[C]:I(_)?[_[0],{..._[1],offset:A}]:{..._,offset:A}}}}function t5(e,t,n,r,i,o,s){if(IB(e))return 0;const a=e==="x"||e==="y2",u=a?-t/2:t/2;if(ne(n)||ne(i)||ne(r)||o){const l=$i(n),c=$i(i),f=$i(r),d=$i(o),p=o?`(${s} < ${d} ? ${a?"":"-"}0.5 * (${d} - (${s})) : ${u})`:u,g=f?`${f} + `:"",y=l?`(${l} ? -1 : 1) * `:"",m=c?`(${c} + ${p})`:p;return{signal:g+y+m}}else return i=i||0,r+(n?-i-u:+i+u)}function Cxe({fieldDef:e,fieldDef2:t,channel:n,model:r}){var $;const{config:i,markDef:o,encoding:s}=r,a=r.getScaleComponent(n),u=r.scaleName(n),l=a?a.get("type"):void 0,c=a.get("reverse"),f=qj({channel:n,fieldDef:e,markDef:o,config:i,scaleType:l}),d=($=r.component.axes[n])==null?void 0:$[0],h=(d==null?void 0:d.get("translate"))??.5,p=xt(n)?Ie("binSpacing",o,i)??0:0,g=Lo(n),y=Pa(n),m=Pa(g),v=_o("minBandSize",o,i),{offset:x}=xf({channel:n,markDef:o,encoding:s,model:r,bandPosition:0}),{offset:w}=xf({channel:g,markDef:o,encoding:s,model:r,bandPosition:0}),b=Z1e({fieldDef:e,scaleName:u}),S=t5(n,p,c,h,x,v,b),E=t5(g,p,c,h,w??x,v,b),_=ne(f)?{signal:`(1-${f.signal})/2`}:hl(f)?(1-f.band)/2:.5,k=La({fieldDef:e,fieldDef2:t,markDef:o,config:i});if(Ye(e.bin)||e.timeUnit){const C=e.timeUnit&&k!==.5;return{[m]:n5({fieldDef:e,scaleName:u,bandPosition:_,offset:E,useRectOffsetField:C}),[y]:n5({fieldDef:e,scaleName:u,bandPosition:ne(_)?{signal:`1-${_.signal}`}:1-_,offset:S,useRectOffsetField:C})}}else if(Xt(e.bin)){const C=Uu(e,u,{},{offset:E});if(W(t))return{[m]:C,[y]:Uu(t,u,{},{offset:S})};if(Tl(e.bin)&&e.bin.step)return{[m]:C,[y]:{signal:`scale("${u}", ${Y(e,{expr:"datum"})} + ${e.bin.step})`,offset:S}}}U(cj(g))}function n5({fieldDef:e,scaleName:t,bandPosition:n,offset:r,useRectOffsetField:i}){return ry({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:r,...i?{startSuffix:Ex,endSuffix:Sx}:{}})}const Axe=new Set(["aria","width","height"]);function ui(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?YU(e):{};return{...Fxe(e.markDef,t),...r5("fill",n),...r5("stroke",r),...Pt("opacity",e),...Pt("fillOpacity",e),...Pt("strokeOpacity",e),...Pt("strokeWidth",e),...Pt("strokeDash",e),...xxe(e),...VU(e),...q3(e,"href"),...mxe(e)}}function r5(e,t){return t?{[e]:t}:{}}function Fxe(e,t){return qme.reduce((n,r)=>(!Axe.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=Ve(e[r])),n),{})}function V3(e){const{config:t,markDef:n}=e,r=new Set;if(e.forEachFieldDef((i,o)=>{var l;let s;if(!zo(o)||!(s=e.getScaleType(o)))return;const a=rx(i.aggregate),u=b3({scaleChannel:o,markDef:n,config:t,scaleType:s,isCountAggregate:a});if(X1e(u)){const c=e.vgField(o,{expr:"datum",binSuffix:(l=e.stack)!=null&&l.impute?"mid":void 0});c&&r.add(c)}}),r.size>0)return{defined:{signal:[...r].map(o=>ax(o,!0)).join(" && ")}}}function i5(e,t){if(t!==void 0)return{[e]:Ve(t)}}const Cw="voronoi",KU={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(Cw)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(ou(o))return U(Xme(o)),n;const s={name:e.getName(Cw),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...VU(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{const f=l.name??"";f===e.component.mark[0].name?a=c:f.includes(Cw)&&(u=!0)}),u||n.splice(a+1,0,s),n}},ZU={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!P3(e.bind),parse:(e,t,n)=>sW(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,s=t.init&&t.init[0],a=KU.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{const c=tt(`${r}_${u.field}`);n.filter(d=>d.name===c).length||n.unshift({name:c,...s?{init:gl(s[l])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${V(u.field)}] : null`}]:[],bind:o[u.field]??o[u.channel]??o})}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find(l=>l.name===r+Ba),s=r+xg,a=i.items.map(l=>tt(`${r}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(o.update=`${u} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}},dy="_toggle",JU={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+dy,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Ba,r=t.name+dy;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${qu(e)}}, `)+`${r} ? ${n} : null`}},Mxe={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=Z(t.clear)?Ka(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(ZU.defined(t))for(const r of t.project.items){const i=n.findIndex(o=>o.name===tt(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,o){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:o})}if(t.type==="interval")for(const i of t.project.items){const o=n.findIndex(s=>s.name===i.signals.visual);if(r(o,"[0, 0]"),o===-1){const s=n.findIndex(a=>a.name===i.signals.data);r(s,"null")}}else{let i=n.findIndex(o=>o.name===t.name+Ba);r(i,"null"),JU.defined(t)&&(i=n.findIndex(o=>o.name===t.name+dy),r(i,"false"))}return n}},eW={defined:e=>{const t=e.resolve==="global"&&e.bind&&P3(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Ii;return t&&!n&&U(Jme),t&&n},parse:(e,t,n)=>{const r=fe(n);if(r.select=Z(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},sW(t,r),Q(n.select)&&(n.select.on||n.select.clear)){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const a of t.events)a.filter=K(a.filter??[]),a.filter.includes(s)||a.filter.push(s)}const i=Sw(t.bind)?t.bind.legend:"click",o=Z(i)?Ka(i,"view"):K(i);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=Sw(t.bind)&&t.bind.legend,o=s=>a=>{const u=fe(a);return u.markname=s,u};for(const s of t.project.items){if(!s.hasLegend)continue;const a=`${tt(s.field)}_legend`,u=`${r}_${a}`;if(n.filter(c=>c.name===u).length===0){const c=i.merge.map(o(`${a}_symbols`)).concat(i.merge.map(o(`${a}_labels`))).concat(i.merge.map(o(`${a}_entries`)));n.unshift({name:u,...t.init?{}:{value:null},on:[{events:c,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]})}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find(d=>d.name===r+Ba),s=r+xg,a=i.items.filter(d=>d.hasLegend).map(d=>tt(`${r}_${tt(d.field)}_legend`)),l=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?o.on.push({events:a.map(d=>({signal:d})),update:l}):a.length>0&&(o.update=l,delete o.value,delete o.on);const c=n.find(d=>d.name===r+dy),f=Sw(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push({...c.on[0],events:f}):c.on[0].events=f),n}};function Txe(e,t,n){var i;const r=(i=e.fieldDef(t))==null?void 0:i.field;for(const o of tn(e.component.selection??{})){const s=o.project.hasField[r]??o.project.hasChannel[t];if(s&&eW.defined(o)){const a=n.get("selections")??[];a.push(o.name),n.set("selections",a,!1),s.hasLegend=!0}}}const tW="_translate_anchor",nW="_translate_delta",Nxe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=ds.defined(t),o=r+tW,{x:s,y:a}=t.project.hasChannel;let u=Ka(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+Nc,l))),n.push({name:o,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(s!==void 0?`, extent_x: ${i?PS(e,nt):`slice(${s.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${i?PS(e,Vt):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:r+nW,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),s!==void 0&&o5(e,t,s,"width",n),a!==void 0&&o5(e,t,a,"height",n),n}};function o5(e,t,n,r,i){const o=t.name,s=o+tW,a=o+nW,u=n.channel,l=ds.defined(t),c=i.find(b=>b.name===n.signals[l?"data":"visual"]),f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(u),h=d&&d.get("type"),p=d&&d.get("reverse"),g=l?u===nt?p?"":"-":p?"-":"":"",y=`${s}.extent_${u}`,m=`${g}${a}.${u} / ${l?`${f}`:`span(${y})`}`,v=!l||!d?"panLinear":h==="log"?"panLog":h==="symlog"?"panSymlog":h==="pow"?"panPow":"panLinear",x=l?h==="pow"?`, ${d.get("exponent")??1}`:h==="symlog"?`, ${d.get("constant")??1}`:"":"",w=`${v}(${y}, ${m}${x})`;c.on.push({events:{signal:a},update:l?w:`clampRange(${w}, 0, ${f})`})}const rW="_zoom_anchor",iW="_zoom_delta",Oxe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=ds.defined(t),o=r+iW,{x:s,y:a}=t.project.hasChannel,u=V(e.scaleName(nt)),l=V(e.scaleName(Vt));let c=Ka(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+Nc,f))),n.push({name:r+rW,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),s!==void 0&&s5(e,t,s,"width",n),a!==void 0&&s5(e,t,a,"height",n),n}};function s5(e,t,n,r,i){const o=t.name,s=n.channel,a=ds.defined(t),u=i.find(v=>v.name===n.signals[a?"data":"visual"]),l=e.getSizeSignalRef(r).signal,c=e.getScaleComponent(s),f=c&&c.get("type"),d=a?PS(e,s):u.name,h=o+iW,p=`${o}${rW}.${s}`,g=!a||!c?"zoomLinear":f==="log"?"zoomLog":f==="symlog"?"zoomSymlog":f==="pow"?"zoomPow":"zoomLinear",y=a?f==="pow"?`, ${c.get("exponent")??1}`:f==="symlog"?`, ${c.get("constant")??1}`:"":"",m=`${g}(${d}, ${p}, ${h}${y})`;u.on.push({events:{signal:h},update:a?m:`clampRange(${m}, 0, ${l})`})}const ml="_store",Ba="_tuple",Rxe="_modify",oW="vlSelectionResolve",kx=[gxe,hxe,fxe,JU,ZU,ds,eW,Mxe,Nxe,Oxe,KU];function Dxe(e){let t=e.parent;for(;t&&!Cr(t);)t=t.parent;return t}function qu(e,{escape:t}={escape:!0}){let n=t?V(e.name):e.name;const r=Dxe(e);if(r){const{facet:i}=r;for(const o of Gr)i[o]&&(n+=` + '__facet_${o}_' + (facet[${V(r.vgField(o))}])`)}return n}function G3(e){return tn(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function sW(e,t){(Z(t.select)||!t.select.on)&&delete e.events,(Z(t.select)||!t.select.clear)&&delete e.clear,(Z(t.select)||!t.select.toggle)&&delete e.toggle}function LS(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...LS(e.object)),t.push(...LS(e.property))),t)}function aW(e){return e.object.type==="MemberExpression"?aW(e.object):e.object.name==="datum"}function uW(e){const t=gA(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&aW(r)&&n.add(LS(r).slice(1).join("."))}),n}class Yf extends je{clone(){return new Yf(null,this.model,fe(this.filter))}constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=hy(this.model,this.filter,this),this._dependentFields=uW(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function Pxe(e,t){const n={},r=e.config.selection;if(!t||!t.length)return n;for(const i of t){const o=tt(i.name),s=i.select,a=Z(s)?s:s.type,u=Q(s)?fe(s):{type:a},l=r[a];for(const d in l)d==="fields"||d==="encodings"||(d==="mark"&&(u[d]={...l[d],...u[d]}),(u[d]===void 0||u[d]===!0)&&(u[d]=fe(l[d]??u[d])));const c=n[o]={...u,name:o,type:a,init:i.value,bind:i.bind,events:Z(u.on)?Ka(u.on,"scope"):K(fe(u.on))},f=fe(i);for(const d of kx)d.defined(c)&&d.parse&&d.parse(e,c,f)}return n}function lW(e,t,n,r="datum"){const i=Z(t)?t:t.param,o=tt(i),s=V(o+ml);let a;try{a=e.getSelectionComponent(o,i)}catch{return`!!${o}`}if(a.project.timeUnit){const d=n??e.component.data.raw,h=a.project.timeUnit.clone();d.parent?h.insertAsParentOf(d):d.parent=h}const u=a.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",l=a.resolve==="global"?")":`, ${V(a.resolve)})`,c=`${u}${s}, ${r}${l}`,f=`length(data(${s}))`;return t.empty===!1?`${f} && ${c}`:`!${f} || ${c}`}function cW(e,t,n){const r=tt(t),i=n.encoding;let o=n.field,s;try{s=e.getSelectionComponent(r,t)}catch{return r}if(!i&&!o)o=s.project.items[0].field,s.project.items.length>1&&U(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${V(o)}.`);else if(i&&!o){const a=s.project.items.filter(u=>u.channel===i);!a.length||a.length>1?(o=s.project.items[0].field,U((a.length?"Multiple ":"No ")+`matching ${V(i)} encoding found for selection ${V(n.param)}. Using "field": ${V(o)}.`)):o=a[0].field}return`${s.name}[${V(ii(o))}]`}function Lxe(e,t){for(const[n,r]of Da(e.component.selection??{})){const i=e.getName(`lookup_${n}`);e.component.data.outputNodes[i]=r.materialized=new sr(new Yf(t,e,{param:n}),i,pt.Lookup,e.component.data.outputNodeRefCounts)}}function hy(e,t,n){return Ch(t,r=>Z(r)?r:h1e(r)?lW(e,r,n):Ej(r))}function zxe(e,t){if(e)return I(e)&&!Hs(e)?e.map(n=>A3(n,t)).join(", "):e}function Aw(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function rh(e,t,n,r={header:!1}){var f,d;const{disable:i,orient:o,scale:s,labelExpr:a,title:u,zindex:l,...c}=e.combine();if(!i){for(const h in c){const p=vye[h],g=c[h];if(p&&p!==t&&p!=="both")delete c[h];else if(vg(g)){const{condition:y,...m}=g,v=K(y),x=OR[h];if(x){const{vgProp:w,part:b}=x,S=[...v.map(E=>{const{test:_,...k}=E;return{test:hy(null,_),...k}}),m];Aw(c,b,w,S),delete c[h]}else if(x===null){const w={signal:v.map(b=>{const{test:S,...E}=b;return`${hy(null,S)} ? ${yR(E)} : `}).join("")+yR(m)};c[h]=w}}else if(ne(g)){const y=OR[h];if(y){const{vgProp:m,part:v}=y;Aw(c,v,m,g),delete c[h]}}be(["labelAlign","labelBaseline"],h)&&c[h]===null&&delete c[h]}if(t==="grid"){if(!c.grid)return;if(c.encode){const{grid:h}=c.encode;c.encode={...h?{grid:h}:{}},Ue(c.encode)&&delete c.encode}return{scale:s,orient:o,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:vt(l,0)}}else{if(!r.header&&e.mainExtracted)return;if(a!==void 0){let p=a;(d=(f=c.encode)==null?void 0:f.labels)!=null&&d.update&&ne(c.encode.labels.update.text)&&(p=ll(a,"datum.label",c.encode.labels.update.text.signal)),Aw(c,"labels","text",{signal:p})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(const p of eU)e.hasAxisPart(p)||delete c.encode[p];Ue(c.encode)&&delete c.encode}const h=zxe(u,n);return{scale:s,orient:o,grid:!1,...h?{title:h}:{},...c,...n.aria===!1?{aria:!1}:{},zindex:vt(l,0)}}}}function fW(e){const{axes:t}=e.component,n=[];for(const r of Fs)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const o=r==="x"?"height":"width",s=e.getSizeSignalRef(o).signal;o!==s&&n.push({name:o,update:s})}}return n}function Ixe(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>rh(i,"grid",t)),...r.map(i=>rh(i,"grid",t)),...n.map(i=>rh(i,"main",t)),...r.map(i=>rh(i,"main",t))].filter(i=>i)}function a5(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const o=n==="x"?"bottom":"left",s=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...B(s),...B(a)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${o}" ? ${$i(s[c])} : ${$i(a[c])}`};return l}return t[i]})])}function Bxe(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:$j(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",s=ne(n)?"axisOrient":`axis${ag(n)}`,a=[...i,...i.map(l=>o+l.substr(4))],u=["axis",s,o];return{vlOnlyAxisConfig:a5(a,r,e,n),vgAxisConfig:a5(u,r,e,n),axisConfigStyle:jxe([...u,...a],r)}}function jxe(e,t){var r;const n=[{}];for(const i of e){let o=(r=t[i])==null?void 0:r.style;if(o){o=K(o);for(const s of o)n.push(t.style[s])}}return Object.assign.apply(null,n)}function zS(e,t,n,r={}){var o;const i=ej(e,n,t);if(i!==void 0)return{configFrom:"style",configValue:i};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((o=r[s])==null?void 0:o[e])!==void 0)return{configFrom:s,configValue:r[s][e]};return{}}const u5={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??Uxe(n,e),gridScale:({model:e,channel:t})=>Wxe(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||hW(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||dW(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??Hxe(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??Vxe(t.type,n,W(t)&&!!t.timeUnit,W(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{const o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return n.tickCount??Yxe({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},tickMinStep:Xxe,title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=pW(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),o=n==="x"?"x2":"y2",s=t.fieldDef(o);return nj(i?[TR(i)]:[],W(s)?[TR(s)]:[])},values:({axis:e,fieldOrDatumDef:t})=>Qxe(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??Kxe(n,t)};function Uxe(e,t){return!qt(e)&&W(t)&&!Ye(t==null?void 0:t.bin)&&!Xt(t==null?void 0:t.bin)}function Wxe(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function qxe(e,t,n,r,i){const o=t==null?void 0:t.labelAngle;if(o!==void 0)return ne(o)?o:vp(o);{const{configValue:s}=zS("labelAngle",r,t==null?void 0:t.style,i);return s!==void 0?vp(s):n===nt&&be([y3,m3],e.type)&&!(W(e)&&e.timeUnit)?270:void 0}}function IS(e){return`(((${e.signal} % 360) + 360) % 360)`}function dW(e,t,n,r){if(e!==void 0)if(n==="x"){if(ne(e)){const i=IS(e),o=ne(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(ne(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(ne(e)){const i=IS(e),o=ne(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(ne(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function hW(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,o=r?"bottom":"left";if(ne(e)){const s=IS(e),a=ne(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${i?`(${s} + 90)`:s} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${s} && ${s} < ${180+i}) === ${a} ? "left" : "right"`}}if((e+i)%180===0)return r?null:"center";if(ne(t)){const s=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${s} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function Hxe(e,t){if(t==="x"&&be(["quantitative","temporal"],e))return!0}function Vxe(e,t,n,r){if(n&&!Q(r)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function Gxe(e){return e==="x"?"bottom":"left"}function Yxe({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!qt(t)&&t!=="log"){if(W(e)){if(Ye(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&be(["month","hours","day","quarter"],(i=Wt(e.timeUnit))==null?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function Xxe({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(W(t)){const{timeUnit:n}=t;if(n){const r=xj(n);if(r)return{signal:r}}}}function pW(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,s=i?i.title:void 0;if(o&&s)return rj(o,s);if(o)return o;if(s)return s;if(o!==void 0)return o;if(s!==void 0)return s}function Qxe(e,t){const n=e.values;if(I(n))return Jj(t,n);if(ne(n))return n}function Kxe(e,t){return e==="rect"&&oy(t)?1:0}class wf extends je{clone(){return new wf(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=uW(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(Rl(r)&&Wj(r.sort)){const{field:o,timeUnit:s}=r,a=r.sort,u=a.map((l,c)=>`${Ej({field:o,timeUnit:s,equal:l})} ? ${c} : `).join("")+a.length;t=new wf(t,{calculate:u,as:bf(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${_e(this.transform)}`}}function bf(e,t,n){return Y(e,{prefix:t,suffix:"sort_index",...n})}function $x(e,t){return be(["top","bottom"],t)?"column":be(["left","right"],t)||e==="row"?"row":"column"}function Ef(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return vt((t||{})[e],i[e],n.header[e])}function Cx(e,t,n,r){const i={};for(const o of e){const s=Ef(o,t||{},n,r);s!==void 0&&(i[o]=s)}return i}const Y3=["row","column"],X3=["header","footer"];function Zxe(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=Cx(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),u=$x(t,a),l=vp(s);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...mW(l,u),...gW(u,l,o),...yW(r,i,t,Bye,vU)}}}function gW(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=hW(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function mW(e,t){const n=dW(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Jxe(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of X3)if(n[i])for(const o of n[i]){const s=t2e(e,t,i,n,o);s!=null&&r.push(s)}return r}function e2e(e,t){const{sort:n}=e;return fs(n)?{field:Y(n,{expr:"datum"}),order:n.order??"ascending"}:I(n)?{field:bf(e,t,{expr:"datum"}),order:"ascending"}:{field:Y(e,{expr:"datum"}),order:n??"ascending"}}function BS(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:u}=Cx(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=_3({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=$x(t,a);return{text:{signal:u?ll(ll(u,"datum.label",l),"datum.value",Y(e,{expr:"parent"})):l},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...mW(o,c),...gW(c,o,s),...yW(n,e,t,jye,xU)}}function t2e(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:s}=r,a=e.config?e.config:void 0;if(s&&i.labels){const{labelOrient:f}=Cx(["labelOrient"],s.header,a,t);(t==="row"&&!be(["top","bottom"],f)||t==="column"&&!be(["left","right"],f))&&(o=BS(s,t,a))}const u=Cr(e)&&!pg(e.facet),l=i.axes,c=(l==null?void 0:l.length)>0;if(o||c){const f=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:e2e(s,t)}:{},...c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{},...c?{axes:l}:{}}}}return null}const n2e={column:{start:0,end:1},row:{start:1,end:0}};function r2e(e,t){return n2e[t][e]}function i2e(e,t){const n={};for(const r of Gr){const i=e[r];if(i!=null&&i.facetFieldDef){const{titleAnchor:o,titleOrient:s}=Cx(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),a=$x(r,s),u=r2e(o,a);u!==void 0&&(n[a]=u)}}return Ue(n)?void 0:n}function yW(e,t,n,r,i){const o={};for(const s of r){if(!i[s])continue;const a=Ef(s,t==null?void 0:t.header,e,n);a!==void 0&&(o[i[s]]=a)}return o}function Q3(e){return[...ym(e,"width"),...ym(e,"height"),...ym(e,"childWidth"),...ym(e,"childHeight")]}function ym(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const o=e.getScaleComponent(n);if(o){const s=o.get("type"),a=o.get("range");if(qt(s)&&iu(a)){const u=e.scaleName(n);return Cr(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[l5(u,a)]:[l5(u,a),{name:i,update:vW(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const o=i.endsWith("width"),s=o?"containerSize()[0]":"containerSize()[1]",a=NS(e.config.view,o?"width":"height"),u=`isFinite(${s}) ? ${s} : ${a}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function l5(e,t){const n=`${e}_step`;return ne(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function vW(e,t,n){const r=t.get("type"),i=t.get("padding"),o=vt(t.get("paddingOuter"),i);let s=t.get("paddingInner");return s=r==="band"?s!==void 0?s:i:1,`bandspace(${n}, ${$i(s)}, ${$i(o)}) * ${e}_step`}function xW(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function wW(e,t){return B(e).reduce((n,r)=>({...n,...Gf({model:t,channelDef:e[r],vgChannel:r,mainRefFn:i=>Ve(i.value),invalidValueRef:void 0})}),{})}function bW(e,t){if(Cr(t))return e==="theta"?"independent":"shared";if(Kf(t))return"shared";if(rF(t))return xt(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function K3(e,t){const n=e.scale[t],r=xt(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&U(D0e(t)),"independent"):e[r][t]||"shared"}const o2e={...qye,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},EW=B(o2e);class s2e extends Ts{}const c5={symbols:a2e,gradient:u2e,labels:l2e,entries:c2e};function a2e(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){if(o!=="symbol")return;const{markDef:s,encoding:a,config:u,mark:l}=n,c=s.filled&&l!=="trail";let f={...Vme({},n,I1e),...YU(n,{filled:c})};const d=i.get("symbolOpacity")??u.legend.symbolOpacity,h=i.get("symbolFillColor")??u.legend.symbolFillColor,p=i.get("symbolStrokeColor")??u.legend.symbolStrokeColor,g=d===void 0?SW(a.opacity)??s.opacity:void 0;if(f.fill){if(r==="fill"||c&&r===cr)delete f.fill;else if(f.fill.field)h?delete f.fill:(f.fill=Ve(u.legend.symbolBaseFillColor??"black"),f.fillOpacity=Ve(g??1));else if(I(f.fill)){const y=jS(a.fill??a.color)??s.fill??(c&&s.color);y&&(f.fill=Ve(y))}}if(f.stroke){if(r==="stroke"||!c&&r===cr)delete f.stroke;else if(f.stroke.field||p)delete f.stroke;else if(I(f.stroke)){const y=vt(jS(a.stroke||a.color),s.stroke,c?s.color:void 0);y&&(f.stroke={value:y})}}if(r!==As){const y=W(t)&&kW(n,i,t);y?f.opacity=[{test:y,...Ve(g??1)},Ve(u.legend.unselectedOpacity)]:g&&(f.opacity=Ve(g))}return f={...f,...e},Ue(f)?void 0:f}function u2e(e,{model:t,legendType:n,legendCmpt:r}){if(n!=="gradient")return;const{config:i,markDef:o,encoding:s}=t;let a={};const l=(r.get("gradientOpacity")??i.legend.gradientOpacity)===void 0?SW(s.opacity)||o.opacity:void 0;return l&&(a.opacity=Ve(l)),a={...a,...e},Ue(a)?void 0:a}function l2e(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},s=n.config,a=W(t)?kW(n,i,t):void 0,u=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o;let f;pl(c)?f=Ci({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:s}):l===void 0&&c===void 0&&s.customFormatTypes&&(t.type==="quantitative"&&s.numberFormatType?f=Ci({fieldOrDatumDef:t,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):t.type==="temporal"&&s.timeFormatType&&W(t)&&t.timeUnit===void 0&&(f=Ci({fieldOrDatumDef:t,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));const d={...u?{opacity:u}:{},...f?{text:f}:{},...e};return Ue(d)?void 0:d}function c2e(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?{...e,fill:{value:"transparent"}}:e}function SW(e){return _W(e,(t,n)=>Math.max(t,n.value))}function jS(e){return _W(e,(t,n)=>vt(t,n.value))}function _W(e,t){if(sye(e))return K(e.condition).reduce(t,e.value);if(Li(e))return e.value}function kW(e,t,n){const r=t.get("selections");if(!(r!=null&&r.length))return;const i=V(n.field);return r.map(o=>`(!length(data(${V(tt(o)+ml)})) || (${o}[${i}] && indexof(${o}[${i}], datum.value) >= 0))`).join(" || ")}const f5={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return Bj(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return jj(r,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??y2e(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??v2e(n),symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>e.symbolType??d2e(t.type,n,r.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>Tc(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Mc(n)&&lo(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>f2e(t,e)};function f2e(e,t){const n=e.values;if(I(n))return Jj(t,n);if(ne(n))return n}function d2e(e,t,n,r){if(t!=="shape"){const i=jS(n)??r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function h2e(e){const{legend:t}=e;return vt(t.type,p2e(e))}function p2e({channel:e,timeUnit:t,scaleType:n}){if(Mc(e)){if(be(["quarter","month","day"],t))return"symbol";if(lo(n))return"gradient"}return"symbol"}function g2e({legendConfig:e,legendType:t,orient:n,legend:r}){return r.direction??e[t?"gradientDirection":"symbolDirection"]??m2e(n,t)}function m2e(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function y2e({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(lo(i))return n==="horizontal"?r==="top"||r==="bottom"?d5(t,"width",s,o):s:d5(t,"height",u,a)}function d5(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function v2e(e){if(be(["quantile","threshold","log","symlog"],e))return"greedy"}function $W(e){const t=st(e)?x2e(e):S2e(e);return e.component.legends=t,t}function x2e(e){const{encoding:t}=e,n={};for(const r of[cr,...bU]){const i=At(t[r]);!i||!e.getScaleComponent(r)||r===fr&&W(i)&&i.type===Vf||(n[r]=E2e(e,r))}return n}function w2e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function b2e(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function E2e(e,t){var w;let n=e.legend(t);const{markDef:r,encoding:i,config:o}=e,s=o.legend,a=new s2e({},w2e(e,t));Txe(e,t,a);const u=n!==void 0?!n:s.disable;if(a.set("disable",u,n!==void 0),u)return a;n=n||{};const l=e.getScaleComponent(t).get("type"),c=At(i[t]),f=W(c)?(w=Wt(c.timeUnit))==null?void 0:w.unit:void 0,d=n.orient||o.legend.orient||"right",h=h2e({legend:n,channel:t,timeUnit:f,scaleType:l}),p=g2e({legend:n,legendType:h,orient:d,legendConfig:s}),g={legend:n,channel:t,model:e,markDef:r,encoding:i,fieldOrDatumDef:c,legendConfig:s,config:o,scaleType:l,orient:d,legendType:h,direction:p};for(const b of EW){if(h==="gradient"&&b.startsWith("symbol")||h==="symbol"&&b.startsWith("gradient"))continue;const S=b in f5?f5[b](g):n[b];if(S!==void 0){const E=b2e(S,b,n,e.fieldDef(t));(E||o.legend[b]===void 0)&&a.set(b,S,E)}}const y=(n==null?void 0:n.encoding)??{},m=a.get("selections"),v={},x={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:a,legendType:h};for(const b of["labels","legend","title","symbols","gradient","entries"]){const S=wW(y[b]??{},e),E=b in c5?c5[b](S,x):S;E!==void 0&&!Ue(E)&&(v[b]={...m!=null&&m.length&&W(c)?{name:`${tt(c.field)}_legend_${b}`}:{},...m!=null&&m.length?{interactive:!!m}:{},update:E})}return Ue(v)||a.set("encode",v,!!(n!=null&&n.encoding)),a}function S2e(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){$W(r);for(const i of B(r.component.legends))n.legend[i]=K3(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=CW(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of B(t))for(const i of e.children)i.component.legends[r]&&n.legend[r]==="shared"&&delete i.component.legends[r];return t}function CW(e,t){var o,s,a,u;if(!e)return t.clone();const n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const l of EW){const c=za(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return _2e(f,d);case"title":return ij(f,d);case"type":return i=!0,gr("symbol")}return bx(f,d,l,"legend")});e.setWithExplicit(l,c)}return i&&((s=(o=e.implicit)==null?void 0:o.encode)!=null&&s.gradient&&J1(e.implicit,["encode","gradient"]),(u=(a=e.explicit)==null?void 0:a.encode)!=null&&u.gradient&&J1(e.explicit,["encode","gradient"])),e}function _2e(e,t){return t.value==="circle"?t:e}function k2e(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function AW(e){const t=e.component.legends,n={};for(const i of B(t)){const o=e.getScaleComponent(i),s=We(o.get("domains"));if(n[s])for(const a of n[s])CW(a,t[i])||n[s].push(t[i]);else n[s]=[t[i].clone()]}return tn(n).flat().map(i=>$2e(i,e.config)).filter(i=>i!==void 0)}function $2e(e,t){var s,a,u;const{disable:n,labelExpr:r,selections:i,...o}=e.combine();if(!n){if(t.aria===!1&&o.aria==null&&(o.aria=!1),(s=o.encode)!=null&&s.symbols){const l=o.encode.symbols.update;l.fill&&l.fill.value!=="transparent"&&!l.stroke&&!o.stroke&&(l.stroke={value:"transparent"});for(const c of bU)o[c]&&delete l[c]}if(o.title||delete o.title,r!==void 0){let l=r;(u=(a=o.encode)==null?void 0:a.labels)!=null&&u.update&&ne(o.encode.labels.update.text)&&(l=ll(r,"datum.label",o.encode.labels.update.text.signal)),k2e(o,"labels","text",{signal:l})}return o}}function C2e(e){return Kf(e)||rF(e)?A2e(e):FW(e)}function A2e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),FW(e))}function FW(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(s=>s.signal).join(", ")}]`},o=t.data.reduce((s,a)=>{const u=ne(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return be(s,u)||s.push(u),s},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]},...n}]}else return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const F2e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class MW extends Ts{constructor(t,n,r,i){super({...n},{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function TW(e){e.component.projection=st(e)?M2e(e):O2e(e)}function M2e(e){if(e.hasProjection){const t=gn(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),r=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=n?T2e(e):void 0,o=new MW(e.projectionName(!0),{...gn(e.config.projection),...t},r,i);return o.get("type")||o.set("type","equalEarth",!1),o}}function T2e(e){const t=[],{encoding:n}=e;for(const r of[[Vi,Hi],[oi,Gi]])(At(n[r[0]])||At(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(fr)&&e.typedFieldDef(fr).type===Vf&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(pt.Main)),t}function N2e(e,t){const n=VA(F2e,i=>!!(!ae(e.explicit,i)&&!ae(t.explicit,i)||ae(e.explicit,i)&&ae(t.explicit,i)&&Sr(e.get(i),t.get(i))));if(Sr(e.size,t.size)){if(n)return e;if(Sr(e.explicit,{}))return t;if(Sr(t.explicit,{}))return e}return null}function O2e(e){if(e.children.length===0)return;let t;for(const r of e.children)TW(r);const n=VA(e.children,r=>{const i=r.component.projection;if(i)if(t){const o=N2e(t,i);return o&&(t=o),!!o}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new MW(r,t.specifiedProjection,t.size,fe(t.data));for(const o of e.children){const s=o.component.projection;s&&(s.isFit&&i.data.push(...o.component.projection.data),o.renameProjection(s.get("name"),r),s.merged=!0)}return i}}function R2e(e,t,n,r){if(yg(t,n)){const i=st(e)?e.axis(n)??e.legend(n)??{}:{},o=Y(t,{expr:"datum"}),s=Y(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Y(t,{binSuffix:"range",forAs:!0}),formula:hg(o,s,i.format,i.formatType,r)}}return{}}function NW(e,t){return`${QB(e)}_${t}`}function D2e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function Z3(e,t,n){const r=gx(n,void 0)??{},i=NW(r,t);return e.getName(`${i}_bins`)}function P2e(e){return"as"in e}function h5(e,t,n){let r,i;P2e(e)?r=Z(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Y(e,{forAs:!0}),Y(e,{binSuffix:"end",forAs:!0})];const o={...gx(t,void 0)},s=NW(o,e.field),{signal:a,extentSignal:u}=D2e(n,s);if(ix(o.extent)){const c=o.extent;i=cW(n,c.param,c),delete o.extent}const l={bin:o,field:e.field,as:[r],...a?{signal:a}:{},...u?{extentSignal:u}:{},...i?{span:i}:{}};return{key:s,binComponent:l}}class yo extends je{clone(){return new yo(null,fe(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,s)=>{if(Wn(o)&&Ye(o.bin)){const{key:a,binComponent:u}=h5(o,o.bin,n);i[a]={...u,...i[a],...R2e(n,o,s,n.config)}}return i},{});return Ue(r)?null:new yo(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:o}=h5(n,n.bin,r);return new yo(t,{[i]:o})}merge(t,n){for(const r of B(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=uo([...this.bins[r].as,...t.bins[r].as],_e)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(tn(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(tn(this.bins).map(t=>t.field))}hash(){return`Bin ${_e(this.bins)}`}assemble(){return tn(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,{extent:o,...s}=t.bin,a={type:"bin",field:ii(t.field),as:r,signal:t.signal,...ix(o)?{extent:null}:{extent:o},...t.span?{span:{signal:`span(${t.span})`}}:{},...s};!o&&t.extentSignal&&(n.push({type:"extent",field:ii(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),n.push(a);for(const u of i)for(let l=0;l<2;l++)n.push({type:"formula",expr:Y({field:r[l]},{expr:"datum"}),as:u[l]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function L2e(e,t,n,r){var o;const i=st(r)?r.encoding[Lo(t)]:void 0;if(Wn(n)&&st(r)&&Hj(n,i,r.markDef,r.config)){e.add(Y(n,{})),e.add(Y(n,{suffix:"end"}));const{mark:s,markDef:a,config:u}=r,l=La({fieldDef:n,markDef:a,config:u});xp(s)&&l!==.5&&xt(t)&&(e.add(Y(n,{suffix:Ex})),e.add(Y(n,{suffix:Sx}))),n.bin&&yg(n,t)&&e.add(Y(n,{binSuffix:"range"}))}else if(jB(t)){const s=BB(t);e.add(r.getName(s))}else e.add(Y(n));return Rl(n)&&$1e((o=n.scale)==null?void 0:o.range)&&e.add(n.scale.range.field),e}function z2e(e,t){for(const n of B(t)){const r=t[n];for(const i of B(r))n in e?e[n][i]=new Set([...e[n][i]??[],...r[i]]):e[n]={[i]:r[i]}}}class Ti extends je{clone(){return new Ti(null,new Set(this.dimensions),fe(this.measures))}constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(s=>{s.aggregate&&(r=!0)});const i={},o=new Set;return!r||(n.forEachFieldDef((s,a)=>{const{aggregate:u,field:l}=s;if(u)if(u==="count")i["*"]??(i["*"]={}),i["*"].count=new Set([Y(s,{forAs:!0})]);else{if(bs(u)||ru(u)){const c=bs(u)?"argmin":"argmax",f=u[c];i[f]??(i[f]={}),i[f][c]=new Set([Y({op:c,field:f},{forAs:!0})])}else i[l]??(i[l]={}),i[l][u]=new Set([Y(s,{forAs:!0})]);zo(a)&&n.scaleDomain(a)==="unaggregated"&&(i[l]??(i[l]={}),i[l].min=new Set([Y({field:l,aggregate:"min"},{forAs:!0})]),i[l].max=new Set([Y({field:l,aggregate:"max"},{forAs:!0})]))}else L2e(o,a,s,n)}),o.size+B(i).length===0)?null:new Ti(t,o,i)}static makeFromTransform(t,n){var r;const i=new Set,o={};for(const s of n.aggregate){const{op:a,field:u,as:l}=s;a&&(a==="count"?(o["*"]??(o["*"]={}),o["*"].count=new Set([l||Y(s,{forAs:!0})])):(o[u]??(o[u]={}),(r=o[u])[a]??(r[a]=new Set),o[u][a].add(l||Y(s,{forAs:!0}))))}for(const s of n.groupby??[])i.add(s);return i.size+B(o).length===0?null:new Ti(t,i,o)}merge(t){return NB(this.dimensions,t.dimensions)?(z2e(this.measures,t.measures),!0):(K0e("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...B(this.measures)])}producedFields(){const t=new Set;for(const n of B(this.measures))for(const r of B(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${_e({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const o of B(this.measures))for(const s of B(this.measures[o]))for(const a of this.measures[o][s])r.push(a),t.push(s),n.push(o==="*"?null:ii(o));return{type:"aggregate",groupby:[...this.dimensions].map(ii),ops:t,fields:n,as:r}}}class Xf extends je{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(const o of Gr){const s=n.facet[o];if(s){const{bin:a,sort:u}=s;this[o]={name:n.getName(`${o}_domain`),fields:[Y(s),...Ye(a)?[Y(s,{binSuffix:"end"})]:[]],...fs(u)?{sortField:u}:I(u)?{sortIndexField:bf(s,o)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(const n of Gr)this[n]&&(t+=` ${n.charAt(0)}:${_e(this[n])}`);return t}get fields(){var n;const t=[];for(const r of Gr)(n=this[r])!=null&&n.fields&&t.push(...this[r].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of Gr)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Fs){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),o=r.get("range");if(qt(i)&&iu(o)){const s=Ax(this.childModel,n),a=nF(s);a?t[n]=a:U(o3(n))}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x",facet:void 0}[t],o=[],s=[],a=[];i&&r&&r[i]&&(n?(o.push(`distinct_${r[i]}`),s.push("max")):(o.push(r[i]),s.push("distinct")),a.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=dx,field:f}=u;o.push(f),s.push(c),a.push(Y(u,{forAs:!0}))}else l&&(o.push(l),s.push("max"),a.push(l));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...o.length?{fields:o,ops:s,as:a}:{}}]}}assembleFacetHeaderData(t){var u;const{columns:n}=this.model.layout,{layoutHeaders:r}=this.model.component,i=[],o={};for(const l of Y3){for(const c of X3){const f=(r[l]&&r[l][c])??[];for(const d of f)if(((u=d.axes)==null?void 0:u.length)>0){o[l]=!0;break}}if(o[l]){const c=`length(data("${this.facet.name}"))`,f=l==="row"?n?{signal:`ceil(${c} / ${n})`}:1:n?{signal:`min(${c}, ${n})`}:{signal:c};i.push({name:`${this.facet.name}_${l}`,transform:[{type:"sequence",start:0,stop:f}]})}}const{row:s,column:a}=o;return(s||a)&&i.unshift(this.assembleRowColumnHeaderData("facet",null,t)),i}assemble(){const t=[];let n=null;const r=this.getChildIndependentFieldsWithStep(),{column:i,row:o,facet:s}=this;if(i&&o&&(r.x||r.y)){n=`cross_${this.column.name}_${this.row.name}`;const a=[].concat(r.x??[],r.y??[]),u=a.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:u}]})}for(const a of[cs,ls])this[a]&&t.push(this.assembleRowColumnHeaderData(a,n,r));if(s){const a=this.assembleFacetHeaderData(r);a&&t.push(...a)}return t}}function p5(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function I2e(e,t){const n=XA(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const r=p5(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.startsWith("utc:")){const r=p5(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return U(s0e(t)),null}function B2e(e){const t={};return c0(e.filter,n=>{if(bj(n)){let r=null;l3(n)?r=xr(n.equal):f3(n)?r=xr(n.lte):c3(n)?r=xr(n.lt):d3(n)?r=xr(n.gt):h3(n)?r=xr(n.gte):p3(n)?r=n.range[0]:g3(n)&&(r=(n.oneOf??n.in)[0]),r&&(Nl(r)?t[n.field]="date":Ae(r)?t[n.field]="number":Z(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function j2e(e){const t={};function n(r){yf(r)?t[r.field]="date":r.type==="quantitative"&&zme(r.aggregate)?t[r.field]="number":cf(r.field)>1?r.field in t||(t[r.field]="flatten"):Rl(r)&&fs(r.sort)&&cf(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((st(e)||Cr(e))&&e.forEachFieldDef((r,i)=>{if(Wn(r))n(r);else{const o=Ml(i),s=e.fieldDef(o);n({...r,type:s.type})}}),st(e)){const{mark:r,markDef:i,encoding:o}=e;if(ou(r)&&!e.encoding.order){const s=i.orient==="horizontal"?"y":"x",a=o[s];W(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function U2e(e){const t={};if(st(e)&&e.component.selection)for(const n of B(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&cf(i.field)>1&&(t[i.field]="flatten")}return t}class wn extends je{clone(){return new wn(null,fe(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${_e(this._parse)}`}static makeExplicit(t,n,r){var s;let i={};const o=n.data;return!Ea(o)&&((s=o==null?void 0:o.format)!=null&&s.parse)&&(i=o.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const a of B(r)){const u=i.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===r[a]||u.value==="derived"||r[a]==="flatten"?delete r[a]:U(SR(a,r[a],u.value)))}for(const a of B(n)){const u=i.get(a);u!==void 0&&(u===n[a]?delete n[a]:U(SR(a,n[a],u)))}const o=new Ts(n,r);i.copyAll(o);const s={};for(const a of B(o.combine())){const u=o.get(a);u!==null&&(s[a]=u)}return B(s).length===0||i.parseNothing?null:new wn(t,s)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const n of B(this._parse)){const r=this._parse[n];cf(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(B(this._parse))}dependentFields(){return new Set(B(this._parse))}assembleTransforms(t=!1){return B(this._parse).filter(n=>t?cf(n)>1:!0).map(n=>{const r=I2e(n,this._parse[n]);return r?{type:"formula",expr:r,as:qf(n)}:null}).filter(n=>n!==null)}}class ja extends je{clone(){return new ja(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Ii])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Ii}}}class wg extends je{clone(){return new wg(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${_e(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class bg extends je{clone(){return new bg(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${_e(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class yl extends je{constructor(t){super(null),t??(t={name:"source"});let n;if(Ea(t)||(n=t.format?{...or(t.format,["parse"])}:{}),wp(t))this._data={values:t.values};else if(vf(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];be(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else IU(t)?this._data={values:[{type:"Sphere"}]}:(LU(t)||Ea(t))&&(this._data={});this._generator=Ea(t),t.name&&(this._name=t.name),n&&!Ue(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var g5=function(e,t,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},W2e=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},ih;function J3(e){return e instanceof yl||e instanceof wg||e instanceof bg}class eF{constructor(){ih.set(this,void 0),g5(this,ih,!1,"f")}setModified(){g5(this,ih,!0,"f")}get modifiedFlag(){return W2e(this,ih,"f")}}ih=new WeakMap;class Dl extends eF{getNodeDepths(t,n,r){r.set(t,n);for(const i of t.children)this.getNodeDepths(i,n+1,r);return r}optimize(t){const r=[...this.getNodeDepths(t,0,new Map).entries()].sort((i,o)=>o[1]-i[1]);for(const i of r)this.run(i[0]);return this.modifiedFlag}}class tF extends eF{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class q2e extends tF{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of B(r))r[i].length>1&&(this.setModified(),this.mergeNodes(t,r[i]))}}class H2e extends tF{constructor(t){super(),this.requiresSelectionId=t&&G3(t)}run(t){t instanceof ja&&(this.requiresSelectionId&&(J3(t.parent)||t.parent instanceof Ti||t.parent instanceof wn)||(this.setModified(),t.remove()))}}class V2e extends eF{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let r=new Set;t instanceof mo&&(r=t.producedFields(),GA(r,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const i of t.children)this.run(i,new Set([...n,...r]))}}class G2e extends tF{constructor(){super()}run(t){t instanceof sr&&!t.isRequired()&&(this.setModified(),t.remove())}}class Y2e extends Dl{run(t){if(!J3(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof wn)if(t instanceof wn)this.setModified(),t.merge(n);else{if(YA(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class X2e extends Dl{run(t){const n=[...t.children],r=t.children.filter(i=>i instanceof wn);if(t.numChildren()>1&&r.length>=1){const i={},o=new Set;for(const s of r){const a=s.parse;for(const u of B(a))u in i?i[u]!==a[u]&&o.add(u):i[u]=a[u]}for(const s of o)delete i[s];if(!Ue(i)){this.setModified();const s=new wn(t,i);for(const a of n){if(a instanceof wn)for(const u of B(i))delete a.parse[u];t.removeChild(a),a.parent=s,a instanceof wn&&B(a.parse).length===0&&a.remove()}}}}}class Q2e extends Dl{run(t){t instanceof sr||t.numChildren()>0||t instanceof Xf||t instanceof yl||(this.setModified(),t.remove())}}class K2e extends Dl{run(t){const n=t.children.filter(i=>i instanceof mo),r=n.pop();for(const i of n)this.setModified(),r.merge(i)}}class Z2e extends Dl{run(t){const n=t.children.filter(i=>i instanceof Ti),r={};for(const i of n){const o=_e(i.groupBy);o in r||(r[o]=[]),r[o].push(i)}for(const i of B(r)){const o=r[i];if(o.length>1){const s=o.pop();for(const a of o)s.merge(a)&&(t.removeChild(a),a.parent=s,a.remove(),this.setModified())}}}}class J2e extends Dl{constructor(t){super(),this.model=t}run(t){const n=!(J3(t)||t instanceof Yf||t instanceof wn||t instanceof ja),r=[],i=[];for(const o of t.children)o instanceof yo&&(n&&!YA(t.producedFields(),o.dependentFields())?r.push(o):i.push(o));if(r.length>0){const o=r.pop();for(const s of r)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof yo?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(i.length>1){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified()}}}class ewe extends Dl{run(t){const n=[...t.children];if(!lf(n,s=>s instanceof sr)||t.numChildren()<=1)return;const i=[];let o;for(const s of n)if(s instanceof sr){let a=s;for(;a.numChildren()===1;){const[u]=a.children;if(u instanceof sr)a=u;else break}i.push(...a.children),o?(t.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=a,this.setModified()):o=a}else i.push(s);if(i.length){this.setModified();for(const s of i)s.parent.removeChild(s),s.parent=o}}}class Pl extends je{clone(){return new Pl(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=uo(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??Y(t)}hash(){return`JoinAggregateTransform ${_e(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const o of this.transform.joinaggregate)n.push(o.op),r.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);const i=this.transform.groupby;return{type:"joinaggregate",as:r,ops:n,fields:t,...i!==void 0?{groupby:i}:{}}}}class Sf extends je{clone(){return new Sf(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n,r){const{config:i,markDef:o}=n,{marks:s,scales:a}=r;if(s==="include-invalid-values"&&a==="include-invalid-values")return null;const u=n.reduceFieldDef((l,c,f)=>{const d=zo(f)&&n.getScaleComponent(f);if(d){const h=d.get("type"),{aggregate:p}=c,g=b3({scaleChannel:f,markDef:o,config:i,scaleType:h,isCountAggregate:rx(p)});g!=="show"&&g!=="always-valid"&&(l[c.field]=c)}return l},{});return B(u).length?new Sf(t,u):null}dependentFields(){return new Set(B(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${_e(this.filter)}`}assemble(){const t=B(this.filter).reduce((n,r)=>{const i=this.filter[r],o=Y(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${o}) || (${US(o)}))`):i.type==="quantitative"&&n.push(US(o))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}function US(e){return`isValid(${e}) && isFinite(+${e})`}function twe(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Y(r);return i&&t.push(i),t},[])}function nwe(e){return I(e)&&e.every(t=>Z(t))&&e.length>1}class hs extends je{clone(){return new hs(null,fe(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:r,groupby:i,as:o,offset:s="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),u.push(vt(f.order,"ascending"));const l={field:a,order:u};let c;return nwe(o)?c=o:Z(o)?c=[o,`${o}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new hs(t,{dimensionFieldDefs:[],stackField:r,groupby:i,offset:s,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannels:o,fieldChannel:s,offset:a,impute:u}=r,l=o.map(h=>{const p=i[h];return zi(p)}).filter(h=>!!h),c=twe(n),f=n.encoding.order;let d;if(I(f)||W(f))d=tj(f);else{const h=Vj(f)?f.sort:s==="y"?"descending":"ascending";d=c.reduce((p,g)=>(p.field.includes(g)||(p.field.push(g),p.order.push(h)),p),{field:[],order:[]})}return new hs(t,{dimensionFieldDefs:l,stackField:n.vgField(s),facetby:[],stackby:c,sort:d,offset:a,impute:u,as:[n.vgField(s,{suffix:"start",forAs:!0}),n.vgField(s,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${_e(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:r}=this._stack;return t.length>0?t.map(i=>i.bin?n?[Y(i,{binSuffix:"mid"})]:[Y(i,{}),Y(i,{binSuffix:"end"})]:[Y(i)]).flat():r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:r,stackField:i,stackby:o,sort:s,offset:a,impute:u,as:l}=this._stack;if(u)for(const c of r){const{bandPosition:f=.5,bin:d}=c;if(d){const h=Y(c,{expr:"datum"}),p=Y(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${US(h)} ? ${f}*${h}+${1-f}*${p} : ${h}`,as:Y(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:i,groupby:[...o,...n],key:Y(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:s,as:l,offset:a}),t}}class Qf extends je{clone(){return new Qf(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=uo(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??Y(t)}hash(){return`WindowTransform ${_e(this.transform)}`}assemble(){const t=[],n=[],r=[],i=[];for(const f of this.transform.window)n.push(f.op),r.push(this.getDefaultName(f)),i.push(f.param===void 0?null:f.param),t.push(f.field===void 0?null:f.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&n.every(f=>r3(f)))return{type:"joinaggregate",as:r,ops:n,fields:t,...s!==void 0?{groupby:s}:{}};const a=[],u=[];if(this.transform.sort!==void 0)for(const f of this.transform.sort)a.push(f.field),u.push(f.order??"ascending");const l={field:a,order:u},c=this.transform.ignorePeers;return{type:"window",params:i,as:r,ops:n,fields:t,sort:l,...c!==void 0?{ignorePeers:c}:{},...s!==void 0?{groupby:s}:{},...o!==void 0?{frame:o}:{}}}}function rwe(e){function t(n){if(!(n instanceof Xf)){const r=n.clone();if(r instanceof sr){const i=qS+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof Ti||r instanceof hs||r instanceof Qf||r instanceof Pl)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function WS(e){if(e instanceof Xf)if(e.numChildren()===1&&!(e.children[0]instanceof sr)){const t=e.children[0];(t instanceof Ti||t instanceof hs||t instanceof Qf||t instanceof Pl)&&t.addDimensions(e.fields),t.swapWithParent(),WS(e)}else{const t=e.model.component.data.main;OW(t);const n=rwe(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(WS)}function OW(e){if(e instanceof sr&&e.type===pt.Main&&e.numChildren()===1){const t=e.children[0];t instanceof Xf||(t.swapWithParent(),OW(e))}}const qS="scale_",vm=5;function HS(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!HS(t.children))return!1}return!0}function ci(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function m5(e,t,n){let r=e.sources,i=!1;return i=ci(new G2e,r)||i,i=ci(new H2e(t),r)||i,r=r.filter(o=>o.numChildren()>0),i=ci(new Q2e,r)||i,r=r.filter(o=>o.numChildren()>0),n||(i=ci(new Y2e,r)||i,i=ci(new J2e(t),r)||i,i=ci(new V2e,r)||i,i=ci(new X2e,r)||i,i=ci(new Z2e,r)||i,i=ci(new K2e,r)||i,i=ci(new q2e,r)||i,i=ci(new ewe,r)||i),e.sources=r,i}function iwe(e,t){HS(e.sources);let n=0,r=0;for(let i=0;i<vm&&m5(e,t,!0);i++)n++;e.sources.map(WS);for(let i=0;i<vm&&m5(e,t,!1);i++)r++;HS(e.sources),Math.max(n,r)===vm&&U(`Maximum optimization runs(${vm}) reached.`)}class Dt{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Dt(()=>t(n))}}function RW(e){st(e)?owe(e):swe(e)}function owe(e){const t=e.component.scales;for(const n of B(t)){const r=uwe(e,n);if(t[n].setWithExplicit("domains",r),cwe(e,n),e.component.data.isFaceted){let o=e;for(;!Cr(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(const a of r.value)is(a)&&(a.data=qS+a.data.replace(qS,""))}}}function swe(e){for(const n of e.children)RW(n);const t=e.component.scales;for(const n of B(t)){let r,i=null;for(const o of e.children){const s=o.component.scales[n];if(s){r===void 0?r=s.getWithExplicit("domains"):r=za(r,s.getWithExplicit("domains"),"domains","scale",VS);const a=s.get("selectionExtent");i&&a&&i.param!==a.param&&U(n0e),i=a}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function awe(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:o}=y5(t,n);if(!i){U(o);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=y5(t,n);if(i)return"unaggregated"}return e}function uwe(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=awe(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:i}),t==="x"&&At(r.x2)?At(r.x)?za(zs(n,i,e,"x"),zs(n,i,e,"x2"),"domain","scale",VS):zs(n,i,e,"x2"):t==="y"&&At(r.y2)?At(r.y)?za(zs(n,i,e,"y"),zs(n,i,e,"y2"),"domain","scale",VS):zs(n,i,e,"y2"):zs(n,i,e,t)}function lwe(e,t,n){return e.map(r=>({signal:`{data: ${mx(r,{timeUnit:n,type:t})}}`}))}function Fw(e,t,n){var i;const r=(i=Wt(n))==null?void 0:i.unit;return t==="temporal"||r?lwe(e,t,r):[e]}function zs(e,t,n,r){const{encoding:i,markDef:o,mark:s,config:a,stack:u}=n,l=At(i[r]),{type:c}=l,f=l.timeUnit,d=rxe({invalid:_o("invalid",o,a),isPath:ou(s)});if(k1e(t)){const g=zs(e,void 0,n,r),y=Fw(t.unionWith,c,f);return no([...y,...g.value])}else{if(ne(t))return no([t]);if(t&&t!=="unaggregated"&&!Aj(t))return no(Fw(t,c,f))}if(u&&r===u.fieldChannel){if(u.offset==="normalize")return gr([[0,1]]);const g=n.requestDataName(d);return gr([{data:g,field:n.vgField(r,{suffix:"start"})},{data:g,field:n.vgField(r,{suffix:"end"})}])}const h=zo(r)&&W(l)?fwe(n,r,e):void 0;if(Io(l)){const g=Fw([l.datum],c,f);return gr(g)}const p=l;if(t==="unaggregated"){const{field:g}=l;return gr([{data:n.requestDataName(d),field:Y({field:g,aggregate:"min"})},{data:n.requestDataName(d),field:Y({field:g,aggregate:"max"})}])}else if(Ye(p.bin)){if(qt(e))return gr(e==="bin-ordinal"?[]:[{data:yp(h)?n.requestDataName(d):n.requestDataName(pt.Raw),field:n.vgField(r,yg(p,r)?{binSuffix:"range"}:{}),sort:h===!0||!Q(h)?{field:n.vgField(r,{}),op:"min"}:h}]);{const{bin:g}=p;if(Ye(g)){const y=Z3(n,p.field,g);return gr([new Dt(()=>{const m=n.getSignalName(y);return`[${m}.start, ${m}.stop]`})])}else return gr([{data:n.requestDataName(d),field:n.vgField(r,{})}])}}else if(p.timeUnit&&be(["time","utc"],e)){const g=i[Lo(r)];if(Hj(p,g,o,a)){const y=n.requestDataName(d),m=La({fieldDef:p,fieldDef2:g,markDef:o,config:a}),v=xp(s)&&m!==.5&&xt(r);return gr([{data:y,field:n.vgField(r,v?{suffix:Ex}:{})},{data:y,field:n.vgField(r,{suffix:v?Sx:"end"})}])}}return gr(h?[{data:yp(h)?n.requestDataName(d):n.requestDataName(pt.Raw),field:n.vgField(r),sort:h}]:[{data:n.requestDataName(d),field:n.vgField(r)}])}function Mw(e,t){const{op:n,field:r,order:i}=e;return{op:n??(t?"sum":dx),...r?{field:ii(r)}:{},...i?{order:i}:{}}}function cwe(e,t){var a;const n=e.component.scales[t],r=e.specifiedScales[t].domain,i=(a=e.fieldDef(t))==null?void 0:a.bin,o=Aj(r)&&r,s=Tl(i)&&ix(i.extent)&&i.extent;(o||s)&&n.set("selectionExtent",o??s,!0)}function fwe(e,t,n){if(!qt(n))return;const r=e.fieldDef(t),i=r.sort;if(Wj(i))return{op:"min",field:bf(r,t),order:"ascending"};const{stack:o}=e,s=o?new Set([...o.groupbyFields,...o.stackBy.map(a=>a.fieldDef.field)]):void 0;if(fs(i)){const a=o&&!s.has(i.field);return Mw(i,a)}else if(rye(i)){const{encoding:a,order:u}=i,l=e.fieldDef(a),{aggregate:c,field:f}=l,d=o&&!s.has(f);if(bs(c)||ru(c))return Mw({field:Y(l),order:u},d);if(r3(c)||!c)return Mw({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(be(["ascending",void 0],i))return!0}}function y5(e,t){const{aggregate:n,type:r}=e;return n?Z(n)&&!Bme.has(n)?{valid:!1,reason:A0e(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:F0e(e)}:{valid:!0}:{valid:!1,reason:C0e(e)}}function VS(e,t,n,r){return e.explicit&&t.explicit&&U(R0e(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function dwe(e){const t=uo(e.map(s=>{if(is(s)){const{sort:a,...u}=s;return u}return s}),_e),n=uo(e.map(s=>{if(is(s)){const a=s.sort;return a!==void 0&&!yp(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(s=>s!==void 0),_e);if(t.length===0)return;if(t.length===1){const s=e[0];if(is(s)&&n.length>0){let a=n[0];if(n.length>1){U(kR);const u=n.filter(l=>Q(l)&&"op"in l&&l.op!=="min");n.every(l=>Q(l)&&"op"in l)&&u.length===1?a=u[0]:a=!0}else if(Q(a)&&"field"in a){const u=a.field;s.field===u&&(a=a.order?{order:a.order}:!0)}return{...s,sort:a}}return s}const r=uo(n.map(s=>yp(s)||!("op"in s)||Z(s.op)&&s.op in Pme?s:(U(P0e(s)),!0)),_e);let i;r.length===1?i=r[0]:r.length>1&&(U(kR),i=!0);const o=uo(e.map(s=>is(s)?s.data:null),s=>s);return o.length===1&&o[0]!==null?{data:o[0],fields:t.map(a=>a.field),...i?{sort:i}:{}}:{fields:t,...i?{sort:i}:{}}}function nF(e){if(is(e)&&Z(e.field))return e.field;if(jme(e)){let t;for(const n of e.fields)if(is(n)&&Z(n.field)){if(!t)t=n.field;else if(t!==n.field)return U(L0e),t}return U(z0e),t}else if(Ume(e)){U(I0e);const t=e.fields[0];return Z(t)?t:void 0}}function Ax(e,t){const r=e.component.scales[t].get("domains").map(i=>(is(i)&&(i.data=e.lookupDataSource(i.data)),i));return dwe(r)}function DW(e){return Kf(e)||rF(e)?e.children.reduce((t,n)=>t.concat(DW(n)),v5(e)):v5(e)}function v5(e){return B(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:s,selectionExtent:a,domains:u,range:l,reverse:c,...f}=i,d=hwe(i.range,o,n,e),h=Ax(e,n),p=a?lxe(e,a,r,h):null;return t.push({name:o,type:s,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...c!==void 0?{reverse:c}:{},...f}),t},[])}function hwe(e,t,n,r){if(xt(n)){if(iu(e))return{step:{signal:`${t}_step`}}}else if(Q(e)&&is(e))return{...e,data:r.lookupDataSource(e.data)};return e}class PW extends Ts{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainHasZero(){const t=this.get("type");if(be([Qt.LOG,Qt.TIME,Qt.UTC],t))return"definitely-not";const n=this.get("zero");if(n===!0||n===void 0&&be([Qt.LINEAR,Qt.SQRT,Qt.POW],t))return"definitely";const r=this.get("domains");if(r.length>0){let i=!1,o=!1,s=!1;for(const a of r){if(I(a)){const u=a[0],l=a[a.length-1];if(Ae(u)&&Ae(l))if(u<=0&&l>=0){i=!0;continue}else{o=!0;continue}}s=!0}if(i)return"definitely";if(o&&!s)return"definitely-not"}return"maybe"}}const pwe=["range","scheme"];function gwe(e){const t=e.component.scales;for(const n of n3){const r=t[n];if(!r)continue;const i=mwe(n,e);r.setWithExplicit("range",i)}}function x5(e,t){const n=e.fieldDef(t);if(n!=null&&n.bin){const{bin:r,field:i}=n,o=dr(t),s=e.getName(o);if(Q(r)&&r.binned&&r.step!==void 0)return new Dt(()=>{const a=e.scaleName(t),u=`(domain("${a}")[1] - domain("${a}")[0]) / ${r.step}`;return`${e.getSignalName(s)} / (${u})`});if(Ye(r)){const a=Z3(e,i,r);return new Dt(()=>{const u=e.getSignalName(a),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(s)} / (${l})`})}}}function mwe(e,t){const n=t.specifiedScales[e],{size:r}=t,o=t.getScaleComponent(e).get("type");for(const f of pwe)if(n[f]!==void 0){const d=FS(o,f),h=Fj(e,f);if(!d)U(uj(o,f,e));else if(h)U(h);else switch(f){case"range":{const p=n.range;if(I(p)){if(xt(e))return no(p.map(g=>{if(g==="width"||g==="height"){const y=t.getName(g),m=t.getSignalName.bind(t);return Dt.fromName(m,y)}return g}))}else if(Q(p))return no({data:t.requestDataName(pt.Main),field:p.field,sort:{op:"min",field:t.vgField(e)}});return no(p)}case"scheme":return no(ywe(n[f]))}}const s=e===nt||e==="xOffset"?"width":"height",a=r[s];if($o(a)){if(xt(e))if(qt(o)){const f=zW(a,t,e);if(f)return no({step:f})}else U(lj(s));else if(cg(e)){const f=e===Za?"x":"y";if(t.getScaleComponent(f).get("type")==="band"){const p=IW(a,o);if(p)return no(p)}}}const{rangeMin:u,rangeMax:l}=n,c=vwe(e,t);return(u!==void 0||l!==void 0)&&FS(o,"rangeMin")&&I(c)&&c.length===2?no([u??c[0],l??c[1]]):gr(c)}function ywe(e){return _1e(e)?{scheme:e.name,...or(e,["name"])}:{scheme:e}}function LW(e,t,n,{center:r}={}){const i=dr(e),o=t.getName(i),s=t.getSignalName.bind(t);return e===Vt&&Pi(n)?r?[Dt.fromName(a=>`${s(a)}/2`,o),Dt.fromName(a=>`-${s(a)}/2`,o)]:[Dt.fromName(s,o),0]:r?[Dt.fromName(a=>`-${s(a)}/2`,o),Dt.fromName(a=>`${s(a)}/2`,o)]:[0,Dt.fromName(s,o)]}function vwe(e,t){const{size:n,config:r,mark:i,encoding:o}=t,{type:s}=At(o[e]),u=t.getScaleComponent(e).get("type"),{domain:l,domainMid:c}=t.specifiedScales[e];switch(e){case nt:case Vt:{if(be(["point","band"],u)){const f=BW(e,n,r.view);if($o(f))return{step:zW(f,t,e)}}return LW(e,t,u)}case Za:case Hf:return xwe(e,t,u);case Cs:{const f=Ewe(i,r),d=Swe(i,n,t,r);return pf(u)?bwe(f,d,wwe(u,r,l,e)):[f,d]}case ai:return[0,Math.PI*2];case Fl:return[0,360];case qi:return[0,new Dt(()=>{const f=t.getSignalName(Cr(t.parent)?"child_width":"width"),d=t.getSignalName(Cr(t.parent)?"child_height":"height");return`min(${f},${d})/2`})];case tu:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case nu:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case fr:return"symbol";case cr:case Do:case Po:return u==="ordinal"?s==="nominal"?"category":"ordinal":c!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case As:case Ja:case eu:return[r.scale.minOpacity,r.scale.maxOpacity]}}function zW(e,t,n){const{encoding:r}=t,i=t.getScaleComponent(n),o=tx(n),s=r[o];if(SU({step:e,offsetIsDiscrete:de(s)&&Sj(s.type)})==="offset"&&rU(r,o)){const u=t.getScaleComponent(o);let c=`domain('${t.scaleName(o)}').length`;if(u.get("type")==="band"){const d=u.get("paddingInner")??u.get("padding")??0,h=u.get("paddingOuter")??u.get("padding")??0;c=`bandspace(${c}, ${d}, ${h})`}const f=i.get("paddingInner")??i.get("padding");return{signal:`${e.step} * ${c} / (1-${$S(f)})`}}else return e.step}function IW(e,t){if(SU({step:e,offsetIsDiscrete:qt(t)})==="offset")return{step:e.step}}function xwe(e,t,n){const r=e===Za?"x":"y",i=t.getScaleComponent(r);if(!i)return LW(r,t,n,{center:!0});const o=i.get("type"),s=t.scaleName(r),{markDef:a,config:u}=t;if(o==="band"){const l=BW(r,t.size,t.config.view);if($o(l)){const c=IW(l,n);if(c)return c}return[0,{signal:`bandwidth('${s}')`}]}else{const l=t.encoding[r];if(W(l)&&l.timeUnit){const c=xj(l.timeUnit,p=>`scale('${s}', ${p})`),f=t.config.scale.bandWithNestedOffsetPaddingInner,d=La({fieldDef:l,markDef:a,config:u})-.5,h=d!==0?` + ${d}`:"";if(f){const p=ne(f)?`${f.signal}/2`+h:`${f/2+d}`,g=ne(f)?`(1 - ${f.signal}/2)`+h:`${1-f/2+d}`;return[{signal:`${p} * (${c})`},{signal:`${g} * (${c})`}]}return[0,{signal:c}]}return MB(`Cannot use ${e} scale if ${r} scale is not discrete.`)}}function BW(e,t,n){const r=e===nt?"width":"height",i=t[r];return i||cy(n,r)}function wwe(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&I(n)?n.length+1:(U(Y0e(r)),3)}}function bwe(e,t,n){const r=()=>{const i=$i(t),o=$i(e),s=`(${i} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${i} + ${s}, ${s})`};return ne(t)?new Dt(r):{signal:r()}}function Ewe(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize}throw new Error(ox("size",e))}const w5=.95;function Swe(e,t,n,r){const i={x:x5(n,"x"),y:x5(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const o=b5(t,i,r.view);return Ae(o)?o-1:new Dt(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const o=b5(t,i,r.view);return Ae(o)?Math.pow(w5*o,2):new Dt(()=>`pow(${w5} * ${o.signal}, 2)`)}}throw new Error(ox("size",e))}function b5(e,t,n){const r=$o(e.width)?e.width.step:ly(n,"width"),i=$o(e.height)?e.height.step:ly(n,"height");return t.x||t.y?new Dt(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function jW(e,t){st(e)?_we(e,t):WW(e,t)}function _we(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:s}=e;for(const a of B(n)){const u=s[a],l=n[a],c=e.getScaleComponent(a),f=At(i[a]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),y=FS(h,t),m=Fj(a,t);if(d!==void 0&&(y?m&&U(m):U(uj(h,t,a))),y&&m===void 0)if(d!==void 0){const v=f.timeUnit,x=f.type;switch(t){case"domainMax":case"domainMin":Nl(u[t])||x==="temporal"||v?l.set(t,{signal:mx(u[t],{type:x,timeUnit:v})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const v=t in E5?E5[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,domainMin:u.domainMin,domainMax:u.domainMax,markDef:o,config:r,hasNestedOffsetScale:iU(i,a),hasSecondaryRangeChannel:!!i[Lo(a)]}):r.scale[t];v!==void 0&&l.set(t,v,!1)}}}const E5={bins:({model:e,fieldOrDatumDef:t})=>W(t)?kwe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>$we(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:r,domainMax:i,fieldOrDatumDef:o})=>Cwe(e,t,n,r,i,o),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>Awe(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:r,config:i,hasNestedOffsetScale:o})=>Fwe(e,t,n.type,r,i.scale,o),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:r,config:i,hasNestedOffsetScale:o})=>Mwe(e,t,n,r,i.scale,o),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=W(e)?e.sort:void 0;return Twe(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i,config:o,hasSecondaryRangeChannel:s})=>Nwe(e,t,n,r,i,o.scale,s)};function UW(e){st(e)?gwe(e):WW(e,"range")}function WW(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?UW(r):jW(r,t);for(const r of B(n)){let i;for(const o of e.children){const s=o.component.scales[r];if(s){const a=s.getWithExplicit(t);i=za(i,a,t,"scale",PU((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function kwe(e,t){const n=t.bin;if(Ye(n)){const r=Z3(e,t.field,n);return new Dt(()=>e.getSignalName(r))}else if(Xt(n)&&Tl(n)&&n.step!==void 0)return{step:n.step}}function $we(e,t){if(be([cr,Do,Po],e)&&t!=="nominal")return"hcl"}function Cwe(e,t,n,r,i,o){var s;if(!((s=zi(o))!=null&&s.bin||I(n)||i!=null||r!=null||be([Qt.TIME,Qt.UTC],e)))return xt(t)?!0:void 0}function Awe(e,t,n,r,i,o){if(xt(e)){if(lo(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:s,orient:a}=i;if(s==="bar"&&!(W(r)&&(r.bin||r.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===Qt.POINT)return n.pointPadding}}function Fwe(e,t,n,r,i,o=!1){if(e===void 0){if(xt(t)){const{bandPaddingInner:s,barBandPaddingInner:a,rectBandPaddingInner:u,tickBandPaddingInner:l,bandWithNestedOffsetPaddingInner:c}=i;return o?c:vt(s,n==="bar"?a:n==="tick"?l:u)}else if(cg(t)&&r===Qt.BAND)return i.offsetBandPaddingInner}}function Mwe(e,t,n,r,i,o=!1){if(e===void 0){if(xt(t)){const{bandPaddingOuter:s,bandWithNestedOffsetPaddingOuter:a}=i;if(o)return a;if(n===Qt.BAND)return vt(s,ne(r)?{signal:`${r.signal}/2`}:r/2)}else if(cg(t)){if(n===Qt.POINT)return .5;if(n===Qt.BAND)return i.offsetBandPaddingOuter}}}function Twe(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return Pi(e)&&t==="descending"?ne(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Pi(e)&&t==="descending")return!0}function Nwe(e,t,n,r,i,o,s){if(!!n&&n!=="unaggregated"&&Pi(i)){if(I(n)){const u=n[0],l=n[n.length-1];if(Ae(u)&&u<=0&&Ae(l)&&l>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!pf(i))return!0;if(!(W(t)&&t.bin)&&be([...Fs,...Ame],e)){const{orient:u,type:l}=r;return be(["bar","area","line","trail"],l)&&(u==="horizontal"&&e==="y"||u==="vertical"&&e==="x")?!1:be(["bar","area"],l)&&!s?!0:o==null?void 0:o.zero}return!1}function Owe(e,t,n,r,i=!1){const o=Rwe(t,n,r,i),{type:s}=e;return zo(t)?s!==void 0?T1e(t,s)?W(n)&&!M1e(s,n.type)?(U(N0e(s,o)),o):s:(U(T0e(t,s,o)),o):o:null}function Rwe(e,t,n,r){var i;switch(t.type){case"nominal":case"ordinal":{if(Mc(e)||bw(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&U(Ew(e,"ordinal")),"ordinal";if(xt(e)||cg(e)){if(be(["rect","bar","image","rule","tick"],n.type)||r)return"band"}else if(n.type==="arc"&&e in t3)return"band";const o=n[dr(e)];return hl(o)||mf(t)&&((i=t.axis)!=null&&i.tickBand)?"band":"point"}case"temporal":return Mc(e)?"time":bw(e)==="discrete"?(U(Ew(e,"temporal")),"ordinal"):W(t)&&t.timeUnit&&Wt(t.timeUnit).utc?"utc":"time";case"quantitative":return Mc(e)?W(t)&&Ye(t.bin)?"bin-ordinal":"linear":bw(e)==="discrete"?(U(Ew(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(sj(t.type))}function Dwe(e,{ignoreRange:t}={}){qW(e),RW(e);for(const n of F1e)jW(e,n);t||UW(e)}function qW(e){st(e)?e.component.scales=Pwe(e):e.component.scales=zwe(e)}function Pwe(e){const{encoding:t,mark:n,markDef:r}=e,i={};for(const o of n3){const s=At(t[o]);if(s&&n===Nj&&o===fr&&s.type===Vf)continue;let a=s&&s.scale;if(s&&a!==null&&a!==!1){a??(a={});const u=iU(t,o),l=Owe(a,o,s,r,u);i[o]=new PW(e.scaleName(`${o}`,!0),{value:l,explicit:a.type===l})}}return i}const Lwe=PU((e,t)=>CR(e)-CR(t));function zwe(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const o of e.children){qW(o);for(const s of B(o.component.scales))if((t=i.scale)[s]??(t[s]=bW(s,e)),i.scale[s]==="shared"){const a=r[s],u=o.component.scales[s].getWithExplicit("type");a?x1e(a.value,u.value)?r[s]=za(a,u,"type","scale",Lwe):(i.scale[s]="independent",delete r[s]):r[s]=u}}for(const o of B(r)){const s=e.scaleName(o,!0),a=r[o];n[o]=new PW(s,a);for(const u of e.children){const l=u.component.scales[o];l&&(u.renameScale(l.get("name"),s),l.merged=!0)}}return n}class Tw{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function st(e){return(e==null?void 0:e.type)==="unit"}function Cr(e){return(e==null?void 0:e.type)==="facet"}function rF(e){return(e==null?void 0:e.type)==="concat"}function Kf(e){return(e==null?void 0:e.type)==="layer"}class iF{constructor(t,n,r,i,o,s,a){this.type=n,this.parent=r,this.config=o,this.correctDataNames=u=>{var l,c,f;return(l=u.from)!=null&&l.data&&(u.from.data=this.lookupDataSource(u.from.data)),(f=(c=u.from)==null?void 0:c.facet)!=null&&f.data&&(u.from.facet.data=this.lookupDataSource(u.from.facet.data)),u},this.parent=r,this.config=o,this.view=gn(a),this.name=t.name??i,this.title=Hs(t.title)?{text:t.title}:t.title?gn(t.title):void 0,this.scaleNameMap=r?r.scaleNameMap:new Tw,this.projectionNameMap=r?r.projectionNameMap:new Tw,this.signalNameMap=r?r.signalNameMap:new Tw,this.data=t.data,this.description=t.description,this.transforms=Hve(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:Xye(t,n,o),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:hx(t)||(r==null?void 0:r.component.data.isFaceted)&&t.data===void 0},layoutSize:new Ts,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...s?fe(s):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){Dwe(this)}parseProjection(){TW(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){$W(this)}assembleEncodeFromView(t){const{style:n,...r}=t,i={};for(const o of B(r)){const s=r[o];s!==void 0&&(i[o]=Ve(s))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Ve(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n}:Ue(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:r,config:i}=this,o=i2e(r.layoutHeaders,i);return{padding:t,...this.assembleDefaultLayout(),...n,...o?{titleBand:o}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of Gr)t[r].title&&n.push(Zxe(this,r));for(const r of Y3)n=n.concat(Jxe(this,r));return n}assembleAxes(){return Ixe(this.component.axes,this.config)}assembleLegends(){return AW(this)}assembleProjections(){return C2e(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},r={...KB(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(r.text)return be(["unit","layer"],this.type)?be(["middle",void 0],r.anchor)&&(r.frame??(r.frame="group")):r.anchor??(r.anchor="start"),Ue(r)?void 0:r}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||Cr(this.parent)?DW(this):[];i.length>0&&(n.scales=i);const o=this.assembleAxes();o.length>0&&(n.axes=o);const s=this.assembleLegends();return s.length>0&&(n.legends=s),n}getName(t){return tt((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(pt[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(r[n]||0)+1,n}getSizeSignalRef(t){if(Cr(this.parent)){const n=xW(t),r=nx(n),i=this.component.scales[r];if(i&&!i.merged){const o=i.get("type"),s=i.get("range");if(qt(o)&&iu(s)){const a=i.get("name"),u=Ax(this,r),l=nF(u);if(l){const c=Y({aggregate:"distinct",field:l},{expr:"datum"});return{signal:vW(a,i,c)}}else return U(o3(r)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(WB(t)&&zo(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getScaleType(t){const n=this.getScaleComponent(t);return n?n.get("type"):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(Qme(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)==null?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)==null?void 0:n.some(r=>r.hasOrientSignalRef()))}}class HW extends iF{vgField(t,n={}){const r=this.fieldDef(t);if(r)return Y(r,n)}reduceFieldDef(t,n){return _ye(this.getMapping(),(r,i,o)=>{const s=zi(i);return s?t(r,s,o):r},n)}forEachFieldDef(t,n){M3(this.getMapping(),(r,i)=>{const o=zi(r);o&&t(o,i)},n)}}class Fx extends je{clone(){return new Fx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"value",r[1]??"density"];const i=this.transform.resolve??"shared";this.transform.resolve=i}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${_e(this.transform)}`}assemble(){const{density:t,...n}=this.transform,r={type:"kde",field:t,...n};return r.resolve=this.transform.resolve,r}}class Mx extends je{clone(){return new Mx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${_e(this.transform)}`}assemble(){const{extent:t,param:n}=this.transform;return{type:"extent",field:t,signal:n}}}class Tx extends je{clone(){return new Tx(this.parent,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((o,s)=>i[s]??o)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${_e(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class Nx extends je{clone(){return new Nx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"key",r[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${_e(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Oc extends je{clone(){return new Oc(null,fe(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[Vi,Hi],[oi,Gi]]){const o=i.map(s=>{const a=At(n.encoding[s]);return W(a)?a.field:Io(a)?{expr:`${a.datum}`}:Li(a)?{expr:`${a.value}`}:void 0});(o[0]||o[1])&&(t=new Oc(t,o,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(fr)){const i=n.typedFieldDef(fr);i.type===Vf&&(t=new Oc(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}dependentFields(){const t=(this.fields??[]).filter(Z);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${_e(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class bp extends je{clone(){return new bp(null,this.projection,fe(this.fields),fe(this.as))}constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[Vi,Hi],[oi,Gi]]){const i=r.map(s=>{const a=At(n.encoding[s]);return W(a)?a.field:Io(a)?{expr:`${a.datum}`}:Li(a)?{expr:`${a.value}`}:void 0}),o=r[0]===oi?"2":"";(i[0]||i[1])&&(t=new bp(t,n.projectionName(),i,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(Z))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${_e(this.fields)} ${_e(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Hu extends je{clone(){return new Hu(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new Hu(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,o=r.y;if(W(i)&&W(o)){const s=i.impute?i:o.impute?o:void 0;if(s===void 0)return;const a=i.impute?o:o.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=s.impute,d=aU(n.mark,r);return new Hu(t,{impute:s.field,key:a.field,...u?{method:u}:{},...l!==void 0?{value:l}:{},...c?{frame:c}:{},...f!==void 0?{keyvals:f}:{},...d.length?{groupby:d}:{}})}return null}hash(){return`Impute ${_e(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:o,value:s,frame:a=[null,null]}=this.transform,u={type:"impute",field:t,key:n,...r?{keyvals:$ve(r)?this.processSequence(r):r}:{},method:"value",...o?{groupby:o}:{},value:!i||i==="value"?s:null};if(i&&i!=="value"){const l={type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:a,ignorePeers:!1,...o?{groupby:o}:{}},c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class Ox extends je{clone(){return new Ox(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${_e(this.transform)}`}assemble(){const{loess:t,on:n,...r}=this.transform;return{type:"loess",x:n,y:t,...r}}}class Ep extends je{clone(){return new Ep(null,fe(this.transform),this.secondary)}constructor(t,n,r){super(t),this.transform=n,this.secondary=r}static make(t,n,r,i){const o=n.component.data.sources,{from:s}=r;let a=null;if(Cve(s)){let u=YW(s.data,o);u||(u=new yl(s.data),o.push(u));const l=n.getName(`lookup_${i}`);a=new sr(u,l,pt.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(Ave(s)){const u=s.param;r={as:u,...r};let l;try{l=n.getSelectionComponent(tt(u),u)}catch{throw new Error(e0e(u))}if(a=l.materialized,!a)throw new Error(t0e(u))}return new Ep(t,r,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?K(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${_e({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:K(this.transform.as)}:{}};else{let n=this.transform.as;Z(n)||(U(l0e),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class Rx extends je{clone(){return new Rx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"prob",r[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${_e(this.transform)}`}assemble(){const{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}}class Dx extends je{clone(){return new Dx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${_e(this.transform)}`}assemble(){const{regression:t,on:n,...r}=this.transform;return{type:"regression",x:n,y:t,...r}}}class Px extends je{clone(){return new Px(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=uo((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${_e(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:o}=this.transform;return{type:"pivot",field:t,value:n,...i!==void 0?{limit:i}:{},...o!==void 0?{op:o}:{},...r!==void 0?{groupby:r}:{}}}}class Lx extends je{clone(){return new Lx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${_e(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function VW(e){let t=0;function n(r,i){if(r instanceof yl&&!r.isGenerator&&!vf(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof wn&&(r.parent instanceof yl&&!i.source?(i.format={...i.format,parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof Xf){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,e.push(...r.assemble());return}switch((r instanceof wg||r instanceof bg||r instanceof Sf||r instanceof Yf||r instanceof wf||r instanceof bp||r instanceof Ti||r instanceof Ep||r instanceof Qf||r instanceof Pl||r instanceof Nx||r instanceof Tx||r instanceof Fx||r instanceof Ox||r instanceof Rx||r instanceof Dx||r instanceof ja||r instanceof Lx||r instanceof Px||r instanceof Mx)&&i.transform.push(r.assemble()),(r instanceof yo||r instanceof mo||r instanceof Hu||r instanceof hs||r instanceof Oc)&&i.transform.push(...r.assemble()),r instanceof sr&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof sr?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof sr&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const s of r.children)n(s,{name:null,source:o,transform:[]});break}}}return n}function Iwe(e){const t=[],n=VW(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function Bwe(e,t){const n=[],r=VW(n);let i=0;for(const s of e.sources){s.hasName()||(s.dataName=`source_${i++}`);const a=s.assemble();r(s,a)}for(const s of n)s.transform.length===0&&delete s.transform;let o=0;for(const[s,a]of n.entries())(a.transform??[]).length===0&&!a.source&&n.splice(o++,0,n.splice(s,1)[0]);for(const s of n)for(const a of s.transform??[])a.type==="lookup"&&(a.from=e.outputNodes[a.from].getSource());for(const s of n)s.name in t&&(s.values=t[s.name]);return n}function jwe(e){return e==="top"||e==="left"||ne(e)?"header":"footer"}function Uwe(e){for(const t of Gr)Wwe(e,t);S5(e,"x"),S5(e,"y")}function Wwe(e,t){var s;const{facet:n,config:r,child:i,component:o}=e;if(e.channelHasField(t)){const a=n[t],u=Ef("title",null,r,t);let l=Tc(a,r,{allowDisabling:!0,includeDefault:u===void 0||!!u});i.component.layoutHeaders[t].title&&(l=I(l)?l.join(", "):l,l+=` / ${i.component.layoutHeaders[t].title}`,i.component.layoutHeaders[t].title=null);const c=Ef("labelOrient",a.header,r,t),f=a.header!==null?vt((s=a.header)==null?void 0:s.labels,r.header.labels,!0):!1,d=be(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:a.header!==null?l:null,facetFieldDef:a,[d]:t==="facet"?[]:[GW(e,t,f)]}}}function GW(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function S5(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:r,resolve:i}=e.component;if(i.axis[t]=K3(i,t),i.axis[t]==="shared"){const o=t==="x"?"column":"row",s=r[o];for(const a of n.component.axes[t]){const u=jwe(a.get("orient"));s[u]??(s[u]=[GW(e,o,!1)]);const l=rh(a,"main",e.config,{header:!0});l&&s[u][0].axes.push(l),a.mainExtracted=!0}}}}function qwe(e){oF(e),py(e,"width"),py(e,"height")}function Hwe(e){oF(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";py(e,t),py(e,n)}function oF(e){for(const t of e.children)t.parseLayoutSize()}function py(e,t){const n=xW(t),r=nx(n),i=e.component.resolve,o=e.component.layoutSize;let s;for(const a of e.children){const u=a.component.layoutSize.getWithExplicit(n),l=i.scale[r]??bW(r,e);if(l==="independent"&&u.value==="step"){s=void 0;break}if(s){if(l==="independent"&&s.value!==u.value){s=void 0;break}s=za(s,u,n,"")}else s=u}if(s){for(const a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,s)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function Vwe(e){const{size:t,component:n}=e;for(const r of Fs){const i=dr(r);if(t[i]){const o=t[i];n.layoutSize.set(i,$o(o)?"step":o,!0)}else{const o=Gwe(e,i);n.layoutSize.set(i,o,!1)}}}function Gwe(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const o=i.get("type"),s=i.get("range");if(qt(o)){const a=cy(r.view,t);return iu(s)||$o(a)?"step":a}else return NS(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return NS(r.view,t);{const o=cy(r.view,t);return $o(o)?o.step:o}}}function GS(e,t,n){return Y(t,{suffix:`by_${Y(e)}`,...n})}class Fh extends HW{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=cF(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!pg(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=B(t),r={};for(const i of n){if(![ls,cs].includes(i)){U(ox(i,"facet"));break}const o=t[i];if(o.field===void 0){U(CS(o,i));break}r[i]=this.initFacetFieldDef(o,i)}return r}initFacetFieldDef(t,n){const r=F3(t,n);return r.header?r.header=gn(r.header):r.header===null&&(r.header=null),r}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=zx(this),this.child.parseData()}parseLayoutSize(){oF(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),Uwe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const n of Gr)for(const r of X3){const i=this.component.layoutHeaders[n],o=i[r],{facetFieldDef:s}=i;if(s){const a=Ef("titleOrient",s.header,this.config,n);if(["right","bottom"].includes(a)){const u=$x(n,a);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[u]="end"}}if(o!=null&&o[0]){const a=n==="row"?"height":"width",u=r==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(a)&&(t[u]??(t[u]={}),t[u][n]=.5),i.title&&(t.offset??(t.offset={}),t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),{...this.getHeaderLayoutMixins(),...r?{columns:r}:{},bounds:"full",align:i}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Fh))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof Fh?{...this.channelHasField("column")?{encode:{update:{columns:{field:Y(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof Fh){if(this.child.channelHasField("column")){const i=Y(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of Fs){const o=this.child.component.scales[i];if(o&&!o.merged){const s=o.get("type"),a=o.get("range");if(qt(s)&&iu(a)){const u=Ax(this.child,i),l=nF(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):U(o3(i))}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:o,ops:s,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const c of Gr){const f=this.facet[c];if(f){u.push(Y(f));const{bin:d,sort:h}=f;if(Ye(d)&&u.push(Y(f,{binSuffix:"end"})),fs(h)){const{field:p,op:g=dx}=h,y=GS(f,h);r&&i?(o.push(y),s.push("max"),a.push(y)):(o.push(p),s.push(g),a.push(y))}else if(I(h)){const p=bf(f,c);o.push(p),s.push("max"),a.push(p)}}}const l=!!r&&!!i;return{name:t,data:n,groupby:u,...l||o.length>0?{aggregate:{...l?{cross:l}:{},...o.length?{fields:o,ops:s,as:a}:{}}}:{}}}facetSortFields(t){const{facet:n}=this,r=n[t];return r?fs(r.sort)?[GS(r,r.sort,{expr:"datum"})]:I(r.sort)?[bf(r,t,{expr:"datum"})]:[Y(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(fs(i)?i.order:!I(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){var i;const{facet:t,config:n}=this;if(t.facet)return BS(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const o of Y3)if(t[o]){const s=Ef("labelOrient",(i=t[o])==null?void 0:i.header,n,o);if(r[o].includes(s))return BS(t[o],o,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=Iwe(n),i=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),s=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...o?{title:o}:{},...s?{style:s}:{},from:{facet:this.assembleFacet()},sort:{field:Gr.map(u=>this.facetSortFields(u)).flat(),order:Gr.map(u=>this.facetSortOrder(u)).flat()},...r.length>0?{data:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup(oxe(this,[]))}]}getMapping(){return this.facet}}function Ywe(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const o of[n,r])if(fs(o.sort)){const{field:s,op:a=dx}=o.sort;e=i=new Pl(e,{joinaggregate:[{op:a,field:s,as:GS(o,o.sort,{forAs:!0})}],groupby:[Y(o)]})}return i}return null}function YW(e,t){var n,r,i,o;for(const s of t){const a=s.data;if(e.name&&s.hasName()&&e.name!==s.dataName)continue;const u=(n=e.format)==null?void 0:n.mesh,l=(r=a.format)==null?void 0:r.feature;if(u&&l)continue;const c=(i=e.format)==null?void 0:i.feature;if((c||l)&&c!==l)continue;const f=(o=a.format)==null?void 0:o.mesh;if(!((u||f)&&u!==f)){if(wp(e)&&wp(a)){if(Sr(e.values,a.values))return s}else if(vf(e)&&vf(a)){if(e.url===a.url)return s}else if(LU(e)&&e.name===s.dataName)return s}}return null}function Xwe(e,t){if(e.data||!e.parent){if(e.data===null){const r=new yl({values:[]});return t.push(r),r}const n=YW(e.data,t);if(n)return Ea(e.data)||(n.data.format=TB({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new yl(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Qwe(e,t,n){let r=0;for(const i of t.transforms){let o,s;if(zve(i))s=e=new wf(e,i),o="derived";else if(j3(i)){const a=B2e(i);s=e=wn.makeWithAncestors(e,{},a,n)??e,e=new Yf(e,t,i.filter)}else if(NU(i))s=e=yo.makeFromTransform(e,i,t),o="number";else if(Bve(i))o="date",n.getWithExplicit(i.field).value===void 0&&(e=new wn(e,{[i.field]:o}),n.set(i.field,o,!1)),s=e=mo.makeFromTransform(e,i);else if(jve(i))s=e=Ti.makeFromTransform(e,i),o="number",G3(t)&&(e=new ja(e));else if(TU(i))s=e=Ep.make(e,t,i,r++),o="derived";else if(Dve(i))s=e=new Qf(e,i),o="number";else if(Pve(i))s=e=new Pl(e,i),o="number";else if(Uve(i))s=e=hs.makeFromTransform(e,i),o="derived";else if(Wve(i))s=e=new Nx(e,i),o="derived";else if(qve(i))s=e=new Mx(e,i),o="derived";else if(Lve(i))s=e=new Tx(e,i),o="derived";else if(Fve(i))s=e=new Px(e,i),o="derived";else if(Rve(i))e=new Lx(e,i);else if(Ive(i))s=e=Hu.makeFromTransform(e,i),o="derived";else if(Mve(i))s=e=new Fx(e,i),o="derived";else if(Tve(i))s=e=new Rx(e,i),o="derived";else if(Nve(i))s=e=new Dx(e,i),o="derived";else if(Ove(i))s=e=new Ox(e,i),o="derived";else{U(u0e(i));continue}if(s&&o!==void 0)for(const a of s.producedFields()??[])n.set(a,o,!1)}return e}function zx(e){var y;let t=Xwe(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:r}=e.component.data,i=e.data,s=!(i&&(Ea(i)||vf(i)||wp(i)))&&e.parent?e.parent.component.data.ancestorParse.clone():new nxe;Ea(i)?(zU(i)?t=new bg(t,i.sequence):U3(i)&&(t=new wg(t,i.graticule)),s.parseNothing=!0):((y=i==null?void 0:i.format)==null?void 0:y.parse)===null&&(s.parseNothing=!0),t=wn.makeExplicit(t,e,s)??t,t=new ja(t);const a=e.parent&&Kf(e.parent);(st(e)||Cr(e))&&a&&(t=yo.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=Qwe(t,e,s));const u=U2e(e),l=j2e(e);t=wn.makeWithAncestors(t,{},{...u,...l},s)??t,st(e)&&(t=Oc.parseAll(t,e),t=bp.parseAll(t,e)),(st(e)||Cr(e))&&(a||(t=yo.makeFromEncoding(t,e)??t),t=mo.makeFromEncoding(t,e)??t,t=wf.parseAllForSortIndex(t,e));const c=t=xm(pt.Raw,e,t);if(st(e)){const m=Ti.makeFromEncoding(t,e);m&&(t=m,G3(e)&&(t=new ja(t))),t=Hu.makeFromEncoding(t,e)??t,t=hs.makeFromEncoding(t,e)??t}let f,d;if(st(e)){const{markDef:m,mark:v,config:x}=e,w=Ie("invalid",m,x),{marks:b,scales:S}=d=BU({invalid:w,isPath:ou(v)});b!==S&&S==="include-invalid-values"&&(f=t=xm(pt.PreFilterInvalid,e,t)),b==="exclude-invalid-values"&&(t=Sf.make(t,e,d)??t)}const h=t=xm(pt.Main,e,t);let p;if(st(e)&&d){const{marks:m,scales:v}=d;m==="include-invalid-values"&&v==="exclude-invalid-values"&&(t=Sf.make(t,e,d)??t,p=t=xm(pt.PostFilterInvalid,e,t))}st(e)&&Lxe(e,h);let g=null;if(Cr(e)){const m=e.getName("facet");t=Ywe(t,e.facet)??t,g=new Xf(t,e,m,h.getSource()),n[m]=g}return{...e.component.data,outputNodes:n,outputNodeRefCounts:r,raw:c,main:h,facetRoot:g,ancestorParse:s,preFilterInvalid:f,postFilterInvalid:p}}function xm(e,t,n){const{outputNodes:r,outputNodeRefCounts:i}=t.component.data,o=t.getDataName(e),s=new sr(n,o,e,i);return r[o]=s,s}class Kwe extends iF{constructor(t,n,r,i){var o,s,a,u;super(t,"concat",n,r,i,t.resolve),(((s=(o=t.resolve)==null?void 0:o.axis)==null?void 0:s.x)==="shared"||((u=(a=t.resolve)==null?void 0:a.axis)==null?void 0:u.y)==="shared")&&U(o0e),this.children=this.getChildren(t).map((l,c)=>cF(l,this,this.getName(`concat_${c}`),void 0,i))}parseData(){this.component.data=zx(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of B(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return xx(t)?t.vconcat:I3(t)?t.hconcat:t.concat}parseLayoutSize(){Hwe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=Q3(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...r?{style:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}}function Zwe(e){return e===!1||e===null}const Jwe={disable:1,gridScale:1,scale:1,...tU,labelExpr:1,encode:1},XW=B(Jwe);class sF extends Ts{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new sF(fe(this.explicit),fe(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Zwe(this.get(t))}hasOrientSignalRef(){return ne(this.explicit.orient)}}function ebe(e,t,n){const{encoding:r,config:i}=e,o=At(r[t])??At(r[Lo(t)]),s=e.axis(t)||{},{format:a,formatType:u}=s;if(pl(u))return{text:Ci({fieldOrDatumDef:o,field:"datum.value",format:a,formatType:u,config:i}),...n};if(a===void 0&&u===void 0&&i.customFormatTypes){if(gf(o)==="quantitative"){if(mf(o)&&o.stack==="normalize"&&i.normalizedNumberFormatType)return{text:Ci({fieldOrDatumDef:o,field:"datum.value",format:i.normalizedNumberFormat,formatType:i.normalizedNumberFormatType,config:i}),...n};if(i.numberFormatType)return{text:Ci({fieldOrDatumDef:o,field:"datum.value",format:i.numberFormat,formatType:i.numberFormatType,config:i}),...n}}if(gf(o)==="temporal"&&i.timeFormatType&&W(o)&&!o.timeUnit)return{text:Ci({fieldOrDatumDef:o,field:"datum.value",format:i.timeFormat,formatType:i.timeFormatType,config:i}),...n}}return n}function tbe(e){return Fs.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[ube(n,e)]),t),{})}const nbe={bottom:"top",top:"bottom",left:"right",right:"left"};function rbe(e){const{axes:t,resolve:n}=e.component,r={top:0,bottom:0,right:0,left:0};for(const i of e.children){i.parseAxesAndHeaders();for(const o of B(i.component.axes))n.axis[o]=K3(e.component.resolve,o),n.axis[o]==="shared"&&(t[o]=ibe(t[o],i.component.axes[o]),t[o]||(n.axis[o]="independent",delete t[o]))}for(const i of Fs){for(const o of e.children)if(o.component.axes[i]){if(n.axis[i]==="independent"){t[i]=(t[i]??[]).concat(o.component.axes[i]);for(const s of o.component.axes[i]){const{value:a,explicit:u}=s.getWithExplicit("orient");if(!ne(a)){if(r[a]>0&&!u){const l=nbe[a];r[a]>r[l]&&s.set("orient",l,!1)}r[a]++}}}delete o.component.axes[i]}if(n.axis[i]==="independent"&&t[i]&&t[i].length>1)for(const[o,s]of(t[i]||[]).entries())o>0&&s.get("grid")&&!s.explicit.grid&&(s.implicit.grid=!1)}}function ibe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],o=t[r];if(!!i!=!!o)return;if(i&&o){const s=i.getWithExplicit("orient"),a=o.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;e[r]=obe(i,o)}}}else return t.map(n=>n.clone());return e}function obe(e,t){for(const n of XW){const r=za(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,o)=>{switch(n){case"title":return ij(i,o);case"gridScale":return{explicit:i.explicit,value:vt(i.value,o.value)}}return bx(i,o,n,"axis")});e.setWithExplicit(n,r)}return e}function sbe(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(ne(n.labelAngle)?n.labelAngle:vp(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===pW(r,i))return!0}return e===n[t]}const abe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function ube(e,t){var m,v;let n=t.axis(e);const r=new sF,i=At(t.encoding[e]),{mark:o,config:s}=t,a=(n==null?void 0:n.orient)||((m=s[e==="x"?"axisX":"axisY"])==null?void 0:m.orient)||((v=s.axis)==null?void 0:v.orient)||Gxe(e),u=t.getScaleComponent(e).get("type"),l=Bxe(e,u,a,t.config),c=n!==void 0?!n:zS("disable",s.style,n==null?void 0:n.style,l).configValue;if(r.set("disable",c,n!==void 0),c)return r;n=n||{};const f=qxe(i,n,e,s.style,l),d=jj(n.formatType,i,u),h=Bj(i,i.type,n.format,n.formatType,s,!0),p={fieldOrDatumDef:i,axis:n,channel:e,model:t,scaleType:u,orient:a,labelAngle:f,format:h,formatType:d,mark:o,config:s};for(const x of XW){const w=x in u5?u5[x](p):RR(x)?n[x]:void 0,b=w!==void 0,S=sbe(w,x,n,t,e);if(b&&S)r.set(x,w,S);else{const{configValue:E=void 0,configFrom:_=void 0}=RR(x)&&x!=="values"?zS(x,s.style,n.style,l):{},k=E!==void 0;b&&!k?r.set(x,w,S):(_!=="vgAxisConfig"||abe.has(x)&&k||vg(E)||ne(E))&&r.set(x,E,!1)}}const g=n.encoding??{},y=eU.reduce((x,w)=>{if(!r.hasAxisPart(w))return x;const b=wW(g[w]??{},t),S=w==="labels"?ebe(t,e,b):b;return S!==void 0&&!Ue(S)&&(x[w]={update:S}),x},{});return Ue(y)||r.set("encode",y,!!n.encoding||n.labelAngle!==void 0),r}function lbe({encoding:e,size:t}){for(const n of Fs){const r=dr(n);$o(t[r])&&aa(e[n])&&(delete t[r],U(lj(r)))}return t}const cbe={vgMark:"arc",encodeEntry:e=>({...ui(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...xn("x",e,{defaultPos:"mid"}),...xn("y",e,{defaultPos:"mid"}),...Ia(e,"radius"),...Ia(e,"theta")})},fbe={vgMark:"area",encodeEntry:e=>({...ui(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...fy("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...fy("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...V3(e)})},dbe={vgMark:"rect",encodeEntry:e=>({...ui(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ia(e,"x"),...Ia(e,"y")})},hbe={vgMark:"shape",encodeEntry:e=>({...ui(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&W(n)&&n.type===Vf?{field:Y(n,{expr:"datum"})}:{}}]}},pbe={vgMark:"image",encodeEntry:e=>({...ui(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...Ia(e,"x"),...Ia(e,"y"),...q3(e,"url")})},gbe={vgMark:"line",encodeEntry:e=>({...ui(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...xn("x",e,{defaultPos:"mid"}),...xn("y",e,{defaultPos:"mid"}),...Pt("size",e,{vgChannel:"strokeWidth"}),...V3(e)})},mbe={vgMark:"trail",encodeEntry:e=>({...ui(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...xn("x",e,{defaultPos:"mid"}),...xn("y",e,{defaultPos:"mid"}),...Pt("size",e),...V3(e)})};function aF(e,t){const{config:n}=e;return{...ui(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...xn("x",e,{defaultPos:"mid"}),...xn("y",e,{defaultPos:"mid"}),...Pt("size",e),...Pt("angle",e),...ybe(e,n,t)}}function ybe(e,t,n){return n?{shape:{value:n}}:Pt("shape",e)}const vbe={vgMark:"symbol",encodeEntry:e=>aF(e)},xbe={vgMark:"symbol",encodeEntry:e=>aF(e,"circle")},wbe={vgMark:"symbol",encodeEntry:e=>aF(e,"square")},bbe={vgMark:"rect",encodeEntry:e=>({...ui(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ia(e,"x"),...Ia(e,"y")})},Ebe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...ui(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...fy("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...fy("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...Pt("size",e,{vgChannel:"strokeWidth"})}}},Sbe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...ui(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...xn("x",e,{defaultPos:"mid"}),...xn("y",e,{defaultPos:"mid"}),...q3(e),...Pt("size",e,{vgChannel:"fontSize"}),...Pt("angle",e),...i5("align",_be(e.markDef,n,t)),...i5("baseline",kbe(e.markDef,n,t)),...xn("radius",e,{defaultPos:null}),...xn("theta",e,{defaultPos:null})}}};function _be(e,t,n){if(Ie("align",e,n)===void 0)return"center"}function kbe(e,t,n){if(Ie("baseline",e,n)===void 0)return"middle"}const $be={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",o=r==="horizontal"?"height":"width";return{...ui(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...xn("x",e,{defaultPos:"mid",vgChannel:"xc"}),...xn("y",e,{defaultPos:"mid",vgChannel:"yc"}),...Pt("size",e,{defaultRef:Cbe(e),vgChannel:i}),[o]:Ve(Ie("thickness",n,t))}}};function Cbe(e){const{config:t,markDef:n}=e,{orient:r}=n,i=r==="horizontal"?"width":"height",o=r==="horizontal"?"x":"y",s=tx(o),a=e.getScaleComponent(s)||e.getScaleComponent(o),u=e.scaleName(s)||e.scaleName(o),l=Ie("size",n,t,{vgChannel:i})??t.tick.bandSize;if(l!==void 0)return Ve(l);if((a==null?void 0:a.get("type"))==="band")return{scale:u,band:1};const c=a==null?void 0:a.get("range"),{tickBandPaddingInner:f}=t.scale,d=c&&iu(c)?c.step:ly(t.view,i);return Ae(d)&&Ae(f)?{value:d*(1-f)}:{signal:`${$S(f)} * ${$S(d)}`}}const wm={arc:cbe,area:fbe,bar:dbe,circle:xbe,geoshape:hbe,image:pbe,line:gbe,point:vbe,rect:bbe,rule:Ebe,square:wbe,text:Sbe,tick:$be,trail:mbe};function Abe(e){if(be([cx,ux,D1e],e.mark)){const t=aU(e.mark,e.encoding);if(t.length>0)return Fbe(e,t)}else if(e.mark===lx){const t=kS.some(n=>Ie(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return Mbe(e)}return uF(e)}const _5="faceted_path_";function Fbe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:_5+e.requestDataName(pt.Main),data:e.requestDataName(pt.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:uF(e,{fromPrefix:_5})}]}const k5="stack_group_";function Mbe(e){var l;const[t]=uF(e,{fromPrefix:k5}),n=e.scaleName(e.stack.fieldChannel),r=(c={})=>e.vgField(e.stack.fieldChannel,c),i=(c,f)=>{const d=[r({prefix:"min",suffix:"start",expr:f}),r({prefix:"max",suffix:"start",expr:f}),r({prefix:"min",suffix:"end",expr:f}),r({prefix:"max",suffix:"end",expr:f})];return`${c}(${d.map(h=>`scale('${n}',${h})`).join(",")})`};let o,s;e.stack.fieldChannel==="x"?(o={...uf(t.encode.update,["y","yc","y2","height",...kS]),x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}},s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...or(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(o={...uf(t.encode.update,["x","xc","x2","width"]),y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}},s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...or(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const c of kS){const f=_o(c,e.markDef,e.config);t.encode.update[c]?(o[c]=t.encode.update[c],delete t.encode.update[c]):f&&(o[c]=Ve(f)),f&&(t.encode.update[c]={value:0})}const a=[];if(((l=e.stack.groupbyChannels)==null?void 0:l.length)>0)for(const c of e.stack.groupbyChannels){const f=e.fieldDef(c),d=Y(f);d&&a.push(d),(f!=null&&f.bin||f!=null&&f.timeUnit)&&a.push(Y(f,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,f)=>{if(t.encode.update[f])return{...c,[f]:t.encode.update[f]};{const d=_o(f,e.markDef,e.config);return d!==void 0?{...c,[f]:Ve(d)}:c}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(pt.Main),name:k5+e.requestDataName(pt.Main),groupby:a,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[t]}]}]}function Tbe(e){const{encoding:t,stack:n,mark:r,markDef:i,config:o}=e,s=t.order;if(!(!I(s)&&Li(s)&&SS(s.value)||!s&&SS(Ie("order",i,o)))){if((I(s)||W(s))&&!n)return tj(s,{expr:"datum"});if(ou(r)){const a=i.orient==="horizontal"?"y":"x",u=t[a];if(W(u))return{field:a}}}}function uF(e,t={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:o}=e,s=vt(r.clip,Nbe(e),Obe(e)),a=JB(r),u=i.key,l=Tbe(e),c=Rbe(e),f=Ie("aria",r,o),d=wm[n].postEncodingTransform?wm[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:wm[n].vgMark,...s?{clip:s}:{},...a?{style:a}:{},...u?{key:u.field}:{},...l?{sort:l}:{},...c||{},...f===!1?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(pt.Main)},encode:{update:wm[n].encodeEntry(e)},...d?{transform:d}:{}}]}function Nbe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t!=null&&t.get("selectionExtent")||n!=null&&n.get("selectionExtent")?!0:void 0}function Obe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function Rbe(e){if(!e.component.selection)return null;const t=B(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=B(r.component.selection).length,r=r.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}class QW extends HW{constructor(t,n,r,i={},o){super(t,"unit",n,r,o,void 0,PR(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const s=ko(t.mark)?{...t.mark}:{type:t.mark},a=s.type;s.filled===void 0&&(s.filled=vve(s,o,{graticule:t.data&&U3(t.data)}));const u=this.encoding=Eye(t.encoding||{},a,s.filled,o);this.markDef=AU(s,u,o),this.size=lbe({encoding:u,size:PR(t)?{...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:i}),this.stack=CU(this.markDef,u),this.specifiedScales=this.initScales(a,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(l=>L3(l))}get hasProjection(){const{encoding:t}=this,n=this.mark===Nj,r=t&&xme.some(i=>de(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return n3.reduce((r,i)=>{const o=At(n[i]);return o&&(r[i]=this.initScale(o.scale??{})),r},{})}initScale(t){const{domain:n,range:r}=t,i=gn(t);return I(n)&&(i.domain=n.map(xr)),I(r)&&(i.range=r.map(xr)),i}initAxes(t){return Fs.reduce((n,r)=>{const i=t[r];if(de(i)||r===nt&&de(t.x2)||r===Vt&&de(t.y2)){const o=de(i)?i.axis:void 0;n[r]=o&&this.initAxis({...o})}return n},{})}initAxis(t){const n=B(t),r={};for(const i of n){const o=t[i];r[i]=vg(o)?ZB(o):xr(o)}return r}initLegends(t){return Fme.reduce((n,r)=>{const i=At(t[r]);if(i&&Tme(r)){const o=i.legend;n[r]=o&&gn(o)}return n},{})}parseData(){this.component.data=zx(this)}parseLayoutSize(){Vwe(this)}parseSelections(){this.component.selection=Pxe(this,this.selection)}parseMarkGroup(){this.component.mark=Abe(this)}parseAxesAndHeaders(){this.component.axes=tbe(this)}assembleSelectionTopLevelSignals(t){return sxe(this,t)}assembleSignals(){return[...fW(this),...ixe(this,[])]}assembleSelectionData(t){return axe(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return Q3(this)}assembleMarks(){let t=this.component.mark??[];return(!this.parent||!Kf(this.parent))&&(t=UU(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Wu(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return zi(n)}typedFieldDef(t){const n=this.fieldDef(t);return Wn(n)?n:null}}class lF extends iF{constructor(t,n,r,i,o){super(t,"layer",n,r,o,t.resolve,t.view);const s={...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((a,u)=>{if(wx(a))return new lF(a,this,this.getName(`layer_${u}`),s,o);if(Ms(a))return new QW(a,this,this.getName(`layer_${u}`),s,o);throw new Error(i3(a))})}parseData(){this.component.data=zx(this);for(const t of this.children)t.parseData()}parseLayoutSize(){qwe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of B(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){rbe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),fW(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),Q3(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const r of this.children)for(const i of K(r.assembleGroupStyle()))t.add(i);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return uxe(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),AW(this))}}function cF(e,t,n,r,i){if(hx(e))return new Fh(e,t,n,i);if(wx(e))return new lF(e,t,n,r,i);if(Ms(e))return new QW(e,t,n,r,i);if(Vye(e))return new Kwe(e,t,n,i);throw new Error(i3(e))}function Dbe(e,t={}){t.logger&&X0e(t.logger),t.fieldTitle&&Kj(t.fieldTitle);try{const n=$U(Af(t.config,e.config)),r=DU(e,n),i=cF(r,null,"",void 0,n);return i.parse(),iwe(i.component.data,i),{spec:Lbe(i,Pbe(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&Q0e(),t.fieldTitle&&hye()}}function Pbe(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):Z(t)&&(t={type:t}),i&&o&&Jve(t.type)){if(i==="step"&&o==="step")U(wR()),t.type="pad";else if(i==="step"||o==="step"){const s=i==="step"?"width":"height";U(wR(nx(s)));const a=s==="width"?"height":"width";t.type=exe(a)}}return{...B(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...YR(n,!1),...YR(e,!0)}}function Lbe(e,t,n={},r){const i=e.config?sve(e.config):void 0,o=[].concat(e.assembleSelectionData([]),Bwe(e.component.data,n)),s=e.assembleProjections(),a=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>(h.name==="width"||h.name==="height")&&h.value!==void 0?(t[h.name]=+h.value,!1):!0);const{params:f,...d}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...d,...a?{title:a}:{},...u?{style:u}:{},...l?{encode:{update:l}}:{},data:o,...s.length>0?{projections:s}:{},...e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...EU(f)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}const zbe=hme.version,Ibe=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:cf,accessPathWithDatum:XA,compile:Dbe,contains:be,deepEqual:Sr,deleteNestedProperty:J1,duplicate:fe,entries:Da,every:VA,fieldIntersection:YA,flatAccessWithDatum:OB,getFirstDefined:vt,hasIntersection:GA,hash:_e,internalField:PB,isBoolean:yp,isEmpty:Ue,isEqual:gme,isInternalField:LB,isNullOrFalse:SS,isNumeric:Xv,keys:B,logicalExpr:Ch,mergeDeep:TB,never:MB,normalize:DU,normalizeAngle:vp,omit:or,pick:uf,prefixGenerator:_S,removePathFromField:qf,replaceAll:ll,replacePathInField:ii,resetIdCounter:yme,setEqual:NB,some:lf,stringify:We,titleCase:ag,unique:uo,uniqueId:DB,vals:tn,varName:tt,version:zbe},Symbol.toStringTag,{value:"Module"}));function KW(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var Bbe="vega-themes",jbe="2.15.0",Ube="Themes for stylized Vega and Vega-Lite visualizations.",Wbe=["vega","vega-lite","themes","style"],qbe="BSD-3-Clause",Hbe={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},Vbe=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],Gbe="build/vega-themes.js",fF="build/vega-themes.module.js",Ybe="build/vega-themes.min.js",Xbe="build/vega-themes.min.js",Qbe="build/vega-themes.module.d.ts",Kbe={type:"git",url:"https://github.com/vega/vega-themes.git"},Zbe=["src","build"],Jbe={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},eEe={"@babel/core":"^7.24.6","@babel/plugin-transform-runtime":"^7.24.6","@babel/preset-env":"^7.24.6","@babel/preset-typescript":"^7.24.6","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@typescript-eslint/eslint-plugin":"^7.11.0","@typescript-eslint/parser":"^7.11.0","browser-sync":"^3.0.2",concurrently:"^8.2.2",eslint:"^8.45.0","eslint-config-prettier":"^9.1.0","eslint-plugin-prettier":"^5.1.3","gh-pages":"^6.1.1",prettier:"^3.2.5","release-it":"^17.3.0",rollup:"^4.18.0","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.4.5",typescript:"^5.4.5",vega:"^5.25.0","vega-lite":"^5.9.3"},tEe={vega:"*","vega-lite":"*"},nEe={},rEe={name:Bbe,version:jbe,description:Ube,keywords:Wbe,license:qbe,author:Hbe,contributors:Vbe,main:Gbe,module:fF,unpkg:Ybe,jsdelivr:Xbe,types:Qbe,repository:Kbe,files:Zbe,scripts:Jbe,devDependencies:eEe,peerDependencies:tEe,dependencies:nEe};const Xl="#fff",$5="#888",iEe={background:"#333",view:{stroke:$5},title:{color:Xl,subtitleColor:Xl},style:{"guide-label":{fill:Xl},"guide-title":{fill:Xl}},axis:{domainColor:Xl,gridColor:$5,tickColor:Xl}},cu="#4572a7",oEe={background:"#fff",arc:{fill:cu},area:{fill:cu},line:{stroke:cu,strokeWidth:2},path:{stroke:cu},rect:{fill:cu},shape:{stroke:cu},symbol:{fill:cu,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},fu="#30a2da",Nw="#cbcbcb",sEe="#999",aEe="#333",C5="#f0f0f0",A5="#333",uEe={arc:{fill:fu},area:{fill:fu},axis:{domainColor:Nw,grid:!0,gridColor:Nw,gridWidth:1,labelColor:sEe,labelFontSize:10,titleColor:aEe,tickColor:Nw,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:C5,group:{fill:C5},legend:{labelColor:A5,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:A5,titleFontSize:14,titlePadding:10},line:{stroke:fu,strokeWidth:2},path:{stroke:fu,strokeWidth:.5},rect:{fill:fu},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:fu},bar:{binSpacing:2,fill:fu,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},du="#000",lEe={group:{fill:"#e5e5e5"},arc:{fill:du},area:{fill:du},line:{stroke:du},path:{stroke:du},rect:{fill:du},shape:{stroke:du},symbol:{fill:du,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},cEe=22,fEe="normal",F5="Benton Gothic, sans-serif",M5=11.5,dEe="normal",hu="#82c6df",Ow="Benton Gothic Bold, sans-serif",T5="normal",N5=13,Ad={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},hEe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:Ow,fontSize:cEe,fontWeight:fEe},arc:{fill:hu},area:{fill:hu},line:{stroke:hu,strokeWidth:2},path:{stroke:hu},rect:{fill:hu},shape:{stroke:hu},symbol:{fill:hu,size:30},axis:{labelFont:F5,labelFontSize:M5,labelFontWeight:dEe,titleFont:Ow,titleFontSize:N5,titleFontWeight:T5},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:F5,labelFontSize:M5,symbolType:"square",titleFont:Ow,titleFontSize:N5,titleFontWeight:T5},range:{category:Ad["category-6"],diverging:Ad["fireandice-6"],heatmap:Ad["fire-7"],ordinal:Ad["fire-7"],ramp:Ad["fire-7"]}},pu="#ab5787",bm="#979797",pEe={background:"#f9f9f9",arc:{fill:pu},area:{fill:pu},line:{stroke:pu},path:{stroke:pu},rect:{fill:pu},shape:{stroke:pu},symbol:{fill:pu,size:30},axis:{domainColor:bm,domainWidth:.5,gridWidth:.2,labelColor:bm,tickColor:bm,tickWidth:.2,titleColor:bm},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},gu="#3e5c69",gEe={background:"#fff",arc:{fill:gu},area:{fill:gu},line:{stroke:gu},path:{stroke:gu},rect:{fill:gu},shape:{stroke:gu},symbol:{fill:gu},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Lr="#1696d2",O5="#000000",mEe="#FFFFFF",Em="Lato",Rw="Lato",yEe="Lato",vEe="#DEDDDD",xEe=18,Fd={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},wEe={background:mEe,title:{anchor:"start",fontSize:xEe,font:Em},axisX:{domain:!0,domainColor:O5,domainWidth:1,grid:!1,labelFontSize:12,labelFont:Rw,labelAngle:0,tickColor:O5,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Em},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:vEe,gridWidth:1,labelFontSize:12,labelFont:Rw,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Em,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:Rw,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Em,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Fd["six-groups-cat-1"],diverging:Fd["diverging-colors"],heatmap:Fd["diverging-colors"],ordinal:Fd["six-groups-seq"],ramp:Fd["shades-blue"]},area:{fill:Lr},rect:{fill:Lr},line:{color:Lr,stroke:Lr,strokeWidth:5},trail:{color:Lr,stroke:Lr,strokeWidth:0,size:1},path:{stroke:Lr,strokeWidth:.5},point:{filled:!0},text:{font:yEe,color:Lr,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Lr,stroke:null}},arc:{fill:Lr},shape:{stroke:Lr},symbol:{fill:Lr,size:30}},mu="#3366CC",R5="#ccc",Sm="Arial, sans-serif",bEe={arc:{fill:mu},area:{fill:mu},path:{stroke:mu},rect:{fill:mu},shape:{stroke:mu},symbol:{stroke:mu},circle:{fill:mu},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Sm,fontSize:12},"guide-title":{font:Sm,fontSize:12},"group-title":{font:Sm,fontSize:12}},title:{font:Sm,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:R5,tickColor:R5,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},dF=e=>e*(1/3+1),D5=dF(9),P5=dF(10),L5=dF(12),Md="Segoe UI",z5="wf_standard-font, helvetica, arial, sans-serif",I5="#252423",Td="#605E5C",B5="transparent",EEe="#C8C6C4",di="#118DFF",SEe="#12239E",_Ee="#E66C37",kEe="#6B007B",$Ee="#E044A7",CEe="#744EC2",AEe="#D9B300",FEe="#D64550",ZW=di,JW="#DEEFFF",j5=[JW,ZW],MEe=[JW,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",ZW],TEe={view:{stroke:B5},background:B5,font:Md,header:{titleFont:z5,titleFontSize:L5,titleColor:I5,labelFont:Md,labelFontSize:P5,labelColor:Td},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Td,labelFontSize:D5,titleFont:z5,titleColor:I5,titleFontSize:L5,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:EEe,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:di},line:{stroke:di,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:Md,fontSize:D5,fill:Td},arc:{fill:di},area:{fill:di,line:!0,opacity:.6},path:{stroke:di},rect:{fill:di},point:{fill:di,filled:!0,size:75},shape:{stroke:di},symbol:{fill:di,strokeWidth:1.5,size:50},legend:{titleFont:Md,titleFontWeight:"bold",titleColor:Td,labelFont:Md,labelFontSize:P5,labelColor:Td,symbolType:"circle",symbolSize:75},range:{category:[di,SEe,_Ee,kEe,$Ee,CEe,AEe,FEe],diverging:j5,heatmap:j5,ordinal:MEe}},Dw='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',NEe='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',Pw=400,_m={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},OEe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],REe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function Ix({theme:e,background:t}){const n=["white","g10"].includes(e)?"light":"dark",r=_m.gridBg[e],i=_m.textPrimary[e],o=_m.textSecondary[e],s=n==="dark"?OEe:REe,a=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:Dw,fontWeight:600},axis:{labelColor:o,labelFontSize:12,labelFont:NEe,labelFontWeight:Pw,titleColor:i,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:_m.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:Dw,fill:o,fontWeight:Pw},"guide-title":{font:Dw,fill:o,fontWeight:Pw}},range:{category:s,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const DEe=Ix({theme:"white",background:"#ffffff"}),PEe=Ix({theme:"g10",background:"#f4f4f4"}),LEe=Ix({theme:"g90",background:"#262626"}),zEe=Ix({theme:"g100",background:"#161616"}),IEe=rEe.version,BEe=Object.freeze(Object.defineProperty({__proto__:null,carbong10:PEe,carbong100:zEe,carbong90:LEe,carbonwhite:DEe,dark:iEe,excel:oEe,fivethirtyeight:uEe,ggplot2:lEe,googlecharts:bEe,latimes:hEe,powerbi:TEe,quartz:pEe,urbaninstitute:wEe,version:IEe,vox:gEe},Symbol.toStringTag,{value:"Module"}));function jEe(e,t,n,r){if(I(e))return`[${e.map(i=>t(Z(i)?i:U5(i,n))).join(", ")}]`;if(Q(e)){let i="";const{title:o,image:s,...a}=e;o&&(i+=`<h2>${t(o)}</h2>`),s&&(i+=`<img src="${new URL(t(s),r||location.href).href}">`);const u=Object.keys(a);if(u.length>0){i+="<table>";for(const l of u){let c=a[l];c!==void 0&&(Q(c)&&(c=U5(c,n)),i+=`<tr><td class="key">${t(l)}</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function UEe(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function U5(e,t){return JSON.stringify(e,UEe(t))}var WEe=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`;const eq="vg-tooltip-element",qEe={offsetX:10,offsetY:10,id:eq,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:HEe,maxDepth:2,formatTooltip:jEe,baseURL:""};function HEe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function VEe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return WEe.toString().replace(eq,e)}function GEe(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}class YEe{constructor(t){this.options={...qEe,...t};const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=VEe(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:s}=GEe(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.style.top=`${s}px`,this.el.style.left=`${o}px`}}var Lw={};function XEe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}class QEe{constructor(){this.max=1e3,this.map=new Map}get(t){const n=this.map.get(t);if(n!==void 0)return this.map.delete(t),this.map.set(t,n),n}delete(t){return this.map.delete(t)}set(t,n){if(!this.delete(t)&&n!==void 0){if(this.map.size>=this.max){const i=this.map.keys().next().value;this.delete(i)}this.map.set(t,n)}return this}}var KEe=QEe;const ZEe=Object.freeze({loose:!0}),JEe=Object.freeze({}),eSe=e=>e?typeof e!="object"?ZEe:e:JEe;var hF=eSe,YS={exports:{}};const tSe="2.0.0",tq=256,nSe=Number.MAX_SAFE_INTEGER||9007199254740991,rSe=16,iSe=tq-6,oSe=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var pF={MAX_LENGTH:tq,MAX_SAFE_COMPONENT_LENGTH:rSe,MAX_SAFE_BUILD_LENGTH:iSe,MAX_SAFE_INTEGER:nSe,RELEASE_TYPES:oSe,SEMVER_SPEC_VERSION:tSe,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const sSe=typeof process=="object"&&Lw&&Lw.NODE_DEBUG&&/\bsemver\b/i.test(Lw.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var Bx=sSe;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=pF,o=Bx;t=e.exports={};const s=t.re=[],a=t.safeRe=[],u=t.src=[],l=t.t={};let c=0;const f="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",i],[f,r]],h=g=>{for(const[y,m]of d)g=g.split(`${y}*`).join(`${y}{0,${m}}`).split(`${y}+`).join(`${y}{1,${m}}`);return g},p=(g,y,m)=>{const v=h(y),x=c++;o(g,x,y),l[g]=x,u[x]=y,s[x]=new RegExp(y,m?"g":void 0),a[x]=new RegExp(v,m?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),p("MAINVERSION",`(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${u[l.NUMERICIDENTIFIER]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${u[l.NUMERICIDENTIFIERLOOSE]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${u[l.PRERELEASEIDENTIFIER]}(?:\\.${u[l.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${u[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[l.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${f}+`),p("BUILD",`(?:\\+(${u[l.BUILDIDENTIFIER]}(?:\\.${u[l.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${u[l.MAINVERSION]}${u[l.PRERELEASE]}?${u[l.BUILD]}?`),p("FULL",`^${u[l.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${u[l.MAINVERSIONLOOSE]}${u[l.PRERELEASELOOSE]}?${u[l.BUILD]}?`),p("LOOSE",`^${u[l.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${u[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${u[l.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:${u[l.PRERELEASE]})?${u[l.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:${u[l.PRERELEASELOOSE]})?${u[l.BUILD]}?)?)?`),p("XRANGE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),p("COERCE",`${u[l.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",u[l.COERCEPLAIN]+`(?:${u[l.PRERELEASE]})?(?:${u[l.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",u[l.COERCE],!0),p("COERCERTLFULL",u[l.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${u[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${u[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${u[l.LONECARET]}${u[l.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${u[l.LONECARET]}${u[l.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${u[l.GTLT]}\\s*(${u[l.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]}|${u[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${u[l.XRANGEPLAIN]})\\s+-\\s+(${u[l.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${u[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[l.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(YS,YS.exports);var gF=YS.exports;const W5=/^[0-9]+$/,nq=(e,t)=>{const n=W5.test(e),r=W5.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},aSe=(e,t)=>nq(t,e);var uSe={compareIdentifiers:nq,rcompareIdentifiers:aSe};const km=Bx,{MAX_LENGTH:q5,MAX_SAFE_INTEGER:$m}=pF,{safeRe:H5,t:V5}=gF,lSe=hF,{compareIdentifiers:Ql}=uSe;let cSe=class Ji{constructor(t,n){if(n=lSe(n),t instanceof Ji){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>q5)throw new TypeError(`version is longer than ${q5} characters`);km("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?H5[V5.LOOSE]:H5[V5.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>$m||this.major<0)throw new TypeError("Invalid major version");if(this.minor>$m||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>$m||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const o=+i;if(o>=0&&o<$m)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(km("SemVer.compare",this.version,this.options,t),!(t instanceof Ji)){if(typeof t=="string"&&t===this.version)return 0;t=new Ji(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Ji||(t=new Ji(t,this.options)),Ql(this.major,t.major)||Ql(this.minor,t.minor)||Ql(this.patch,t.patch)}comparePre(t){if(t instanceof Ji||(t=new Ji(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(km("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Ql(r,i)}while(++n)}compareBuild(t){t instanceof Ji||(t=new Ji(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(km("build compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Ql(r,i)}while(++n)}inc(t,n,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(r)?1:0;if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(n){let o=[n,i];r===!1&&(o=[n]),Ql(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var mF=cSe;const G5=mF,fSe=(e,t,n)=>new G5(e,n).compare(new G5(t,n));var Zf=fSe;const dSe=Zf,hSe=(e,t,n)=>dSe(e,t,n)===0;var pSe=hSe;const gSe=Zf,mSe=(e,t,n)=>gSe(e,t,n)!==0;var ySe=mSe;const vSe=Zf,xSe=(e,t,n)=>vSe(e,t,n)>0;var wSe=xSe;const bSe=Zf,ESe=(e,t,n)=>bSe(e,t,n)>=0;var SSe=ESe;const _Se=Zf,kSe=(e,t,n)=>_Se(e,t,n)<0;var $Se=kSe;const CSe=Zf,ASe=(e,t,n)=>CSe(e,t,n)<=0;var FSe=ASe;const MSe=pSe,TSe=ySe,NSe=wSe,OSe=SSe,RSe=$Se,DSe=FSe,PSe=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return MSe(e,n,r);case"!=":return TSe(e,n,r);case">":return NSe(e,n,r);case">=":return OSe(e,n,r);case"<":return RSe(e,n,r);case"<=":return DSe(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var LSe=PSe,zw,Y5;function zSe(){if(Y5)return zw;Y5=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),s("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(c){const f=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],d=c.match(f);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new a(d[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(s("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new a(c,this.options)}catch{return!1}return o(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new u(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||o(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||o(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}zw=t;const n=hF,{safeRe:r,t:i}=gF,o=LSe,s=Bx,a=mF,u=rq();return zw}var Iw,X5;function rq(){if(X5)return Iw;X5=1;class e{constructor(M,F){if(F=r(F),M instanceof e)return M.loose===!!F.loose&&M.includePrerelease===!!F.includePrerelease?M:new e(M.raw,F);if(M instanceof i)return this.raw=M.value,this.set=[[M]],this.format(),this;if(this.options=F,this.loose=!!F.loose,this.includePrerelease=!!F.includePrerelease,this.raw=M.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(N=>this.parseRange(N.trim())).filter(N=>N.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const N=this.set[0];if(this.set=this.set.filter(P=>!p(P[0])),this.set.length===0)this.set=[N];else if(this.set.length>1){for(const P of this.set)if(P.length===1&&g(P[0])){this.set=[P];break}}}this.format()}format(){return this.range=this.set.map(M=>M.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(M){const N=((this.options.includePrerelease&&d)|(this.options.loose&&h))+":"+M,P=n.get(N);if(P)return P;const T=this.options.loose,O=T?a[u.HYPHENRANGELOOSE]:a[u.HYPHENRANGE];M=M.replace(O,C(this.options.includePrerelease)),o("hyphen replace",M),M=M.replace(a[u.COMPARATORTRIM],l),o("comparator trim",M),M=M.replace(a[u.TILDETRIM],c),o("tilde trim",M),M=M.replace(a[u.CARETTRIM],f),o("caret trim",M);let j=M.split(" ").map(he=>m(he,this.options)).join(" ").split(/\s+/).map(he=>$(he,this.options));T&&(j=j.filter(he=>(o("loose invalid filter",he,this.options),!!he.match(a[u.COMPARATORLOOSE])))),o("range list",j);const X=new Map,re=j.map(he=>new i(he,this.options));for(const he of re){if(p(he))return[he];X.set(he.value,he)}X.size>1&&X.has("")&&X.delete("");const we=[...X.values()];return n.set(N,we),we}intersects(M,F){if(!(M instanceof e))throw new TypeError("a Range is required");return this.set.some(N=>y(N,F)&&M.set.some(P=>y(P,F)&&N.every(T=>P.every(O=>T.intersects(O,F)))))}test(M){if(!M)return!1;if(typeof M=="string")try{M=new s(M,this.options)}catch{return!1}for(let F=0;F<this.set.length;F++)if(R(this.set[F],M,this.options))return!0;return!1}}Iw=e;const t=KEe,n=new t,r=hF,i=zSe(),o=Bx,s=mF,{safeRe:a,t:u,comparatorTrimReplace:l,tildeTrimReplace:c,caretTrimReplace:f}=gF,{FLAG_INCLUDE_PRERELEASE:d,FLAG_LOOSE:h}=pF,p=A=>A.value==="<0.0.0-0",g=A=>A.value==="",y=(A,M)=>{let F=!0;const N=A.slice();let P=N.pop();for(;F&&N.length;)F=N.every(T=>P.intersects(T,M)),P=N.pop();return F},m=(A,M)=>(o("comp",A,M),A=b(A,M),o("caret",A),A=x(A,M),o("tildes",A),A=E(A,M),o("xrange",A),A=k(A,M),o("stars",A),A),v=A=>!A||A.toLowerCase()==="x"||A==="*",x=(A,M)=>A.trim().split(/\s+/).map(F=>w(F,M)).join(" "),w=(A,M)=>{const F=M.loose?a[u.TILDELOOSE]:a[u.TILDE];return A.replace(F,(N,P,T,O,j)=>{o("tilde",A,N,P,T,O,j);let X;return v(P)?X="":v(T)?X=`>=${P}.0.0 <${+P+1}.0.0-0`:v(O)?X=`>=${P}.${T}.0 <${P}.${+T+1}.0-0`:j?(o("replaceTilde pr",j),X=`>=${P}.${T}.${O}-${j} <${P}.${+T+1}.0-0`):X=`>=${P}.${T}.${O} <${P}.${+T+1}.0-0`,o("tilde return",X),X})},b=(A,M)=>A.trim().split(/\s+/).map(F=>S(F,M)).join(" "),S=(A,M)=>{o("caret",A,M);const F=M.loose?a[u.CARETLOOSE]:a[u.CARET],N=M.includePrerelease?"-0":"";return A.replace(F,(P,T,O,j,X)=>{o("caret",A,P,T,O,j,X);let re;return v(T)?re="":v(O)?re=`>=${T}.0.0${N} <${+T+1}.0.0-0`:v(j)?T==="0"?re=`>=${T}.${O}.0${N} <${T}.${+O+1}.0-0`:re=`>=${T}.${O}.0${N} <${+T+1}.0.0-0`:X?(o("replaceCaret pr",X),T==="0"?O==="0"?re=`>=${T}.${O}.${j}-${X} <${T}.${O}.${+j+1}-0`:re=`>=${T}.${O}.${j}-${X} <${T}.${+O+1}.0-0`:re=`>=${T}.${O}.${j}-${X} <${+T+1}.0.0-0`):(o("no pr"),T==="0"?O==="0"?re=`>=${T}.${O}.${j}${N} <${T}.${O}.${+j+1}-0`:re=`>=${T}.${O}.${j}${N} <${T}.${+O+1}.0-0`:re=`>=${T}.${O}.${j} <${+T+1}.0.0-0`),o("caret return",re),re})},E=(A,M)=>(o("replaceXRanges",A,M),A.split(/\s+/).map(F=>_(F,M)).join(" ")),_=(A,M)=>{A=A.trim();const F=M.loose?a[u.XRANGELOOSE]:a[u.XRANGE];return A.replace(F,(N,P,T,O,j,X)=>{o("xRange",A,N,P,T,O,j,X);const re=v(T),we=re||v(O),he=we||v(j),Re=he;return P==="="&&Re&&(P=""),X=M.includePrerelease?"-0":"",re?P===">"||P==="<"?N="<0.0.0-0":N="*":P&&Re?(we&&(O=0),j=0,P===">"?(P=">=",we?(T=+T+1,O=0,j=0):(O=+O+1,j=0)):P==="<="&&(P="<",we?T=+T+1:O=+O+1),P==="<"&&(X="-0"),N=`${P+T}.${O}.${j}${X}`):we?N=`>=${T}.0.0${X} <${+T+1}.0.0-0`:he&&(N=`>=${T}.${O}.0${X} <${T}.${+O+1}.0-0`),o("xRange return",N),N})},k=(A,M)=>(o("replaceStars",A,M),A.trim().replace(a[u.STAR],"")),$=(A,M)=>(o("replaceGTE0",A,M),A.trim().replace(a[M.includePrerelease?u.GTE0PRE:u.GTE0],"")),C=A=>(M,F,N,P,T,O,j,X,re,we,he,Re)=>(v(N)?F="":v(P)?F=`>=${N}.0.0${A?"-0":""}`:v(T)?F=`>=${N}.${P}.0${A?"-0":""}`:O?F=`>=${F}`:F=`>=${F}${A?"-0":""}`,v(re)?X="":v(we)?X=`<${+re+1}.0.0-0`:v(he)?X=`<${re}.${+we+1}.0-0`:Re?X=`<=${re}.${we}.${he}-${Re}`:A?X=`<${re}.${we}.${+he+1}-0`:X=`<=${X}`,`${F} ${X}`.trim()),R=(A,M,F)=>{for(let N=0;N<A.length;N++)if(!A[N].test(M))return!1;if(M.prerelease.length&&!F.includePrerelease){for(let N=0;N<A.length;N++)if(o(A[N].semver),A[N].semver!==i.ANY&&A[N].semver.prerelease.length>0){const P=A[N].semver;if(P.major===M.major&&P.minor===M.minor&&P.patch===M.patch)return!0}return!1}return!0};return Iw}const ISe=rq(),BSe=(e,t,n)=>{try{t=new ISe(t,n)}catch{return!1}return t.test(e)};var jSe=BSe,iq=XEe(jSe);function USe(e,t,n){const r=e.open(t),i=1e4,o=250,{origin:s}=new URL(t);let a=~~(i/o);function u(c){c.source===r&&(a=0,e.removeEventListener("message",u,!1))}e.addEventListener("message",u,!1);function l(){a<=0||(r.postMessage(n,s),setTimeout(l,o),a-=1)}setTimeout(l,o)}var WSe=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function oq(e,...t){for(const n of t)qSe(e,n);return e}function qSe(e,t){for(const n of Object.keys(t))Ff(e,n,t[n],!0)}const gi=Oge;let Sp=Ibe;const Cm=typeof window<"u"?window:void 0;var tD;Sp===void 0&&((tD=Cm==null?void 0:Cm.vl)!=null&&tD.compile)&&(Sp=Cm.vl);const HSe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},VSe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},oh={vega:"Vega","vega-lite":"Vega-Lite"},gy={vega:gi.version,"vega-lite":Sp?Sp.version:"not available"},GSe={vega:e=>e,"vega-lite":(e,t)=>Sp.compile(e,{config:t}).spec},YSe=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,XSe="chart-wrapper";function QSe(e){return typeof e=="function"}function Q5(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,s=window.open("");s.document.write(i+e+o),s.document.title=`${oh[r]} JSON Source`}function KSe(e,t){if(e.$schema){const n=KW(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${oh[n.library]}, but mode argument sets ${oh[t]??t}.`);const r=n.library;return iq(gy[r],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${oh[r]} ${n.version}, but the current version of ${oh[r]} is v${gy[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function sq(e){return!!(e&&"load"in e)}function K5(e){return sq(e)?e:gi.loader(e)}function ZSe(e){var n;const t=((n=e.usermeta)==null?void 0:n.embedOptions)??{};return Z(t.defaultStyle)&&(t.defaultStyle=!1),t}async function JSe(e,t,n={}){let r,i;Z(t)?(i=K5(n.loader),r=JSON.parse(await i.load(t))):r=t;const o=ZSe(r),s=o.loader;(!i||s)&&(i=K5(n.loader??s));const a=await Z5(o,i),u=await Z5(n,i),l={...oq(u,a),config:Af(u.config??{},a.config??{})};return await t_e(e,r,l,i)}async function Z5(e,t){const n=Z(e.config)?JSON.parse(await t.load(e.config)):e.config??{},r=Z(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return{...e,...r?{patch:r}:{},...n?{config:n}:{}}}function e_e(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}async function t_e(e,t,n={},r){const i=n.theme?Af(BEe[n.theme],n.config??{}):n.config,o=Ha(n.actions)?n.actions:oq({},HSe,n.actions??{}),s={...VSe,...n.i18n},a=n.renderer??"canvas",u=n.logLevel??gi.Warn,l=n.downloadFileName??"visualization",c=typeof e=="string"?document.querySelector(e):e;if(!c)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const b="vega-embed-style",{root:S,rootContainer:E}=e_e(c);if(!S.getElementById(b)){const _=document.createElement("style");_.id=b,_.innerHTML=n.defaultStyle===void 0||n.defaultStyle===!0?WSe.toString():n.defaultStyle,E.appendChild(_)}}const f=KSe(t,n.mode);let d=GSe[f](t,i);if(f==="vega-lite"&&d.$schema){const b=KW(d.$schema);iq(gy.vega,`^${b.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${b.version}, but current version is v${gy.vega}.`)}c.classList.add("vega-embed"),o&&c.classList.add("has-actions"),c.innerHTML="";let h=c;if(o){const b=document.createElement("div");b.classList.add(XSe),c.appendChild(b),h=b}const p=n.patch;if(p&&(d=p instanceof Function?p(d):Ry(d,p,!0,!1).newDocument),n.formatLocale&&gi.formatLocale(n.formatLocale),n.timeFormatLocale&&gi.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(const b in n.expressionFunctions){const S=n.expressionFunctions[b];"fn"in S?gi.expressionFunction(b,S.fn,S.visitor):S instanceof Function&&gi.expressionFunction(b,S)}const{ast:g}=n,y=gi.parse(d,f==="vega-lite"?{}:i,{ast:g}),m=new(n.viewClass||gi.View)(y,{loader:r,logLevel:u,renderer:a,...g?{expr:gi.expressionInterpreter??n.expr??Wge}:{}});if(m.addSignalListener("autosize",(b,S)=>{const{type:E}=S;E=="fit-x"?(h.classList.add("fit-x"),h.classList.remove("fit-y")):E=="fit-y"?(h.classList.remove("fit-x"),h.classList.add("fit-y")):E=="fit"?h.classList.add("fit-x","fit-y"):h.classList.remove("fit-x","fit-y")}),n.tooltip!==!1){const{loader:b,tooltip:S}=n,E=b&&!sq(b)?b==null?void 0:b.baseURL:void 0,_=QSe(S)?S:new YEe({baseURL:E,...S===!0?{}:S}).call;m.tooltip(_)}let{hover:v}=n;if(v===void 0&&(v=f==="vega"),v){const{hoverSet:b,updateSet:S}=typeof v=="boolean"?{}:v;m.hover(b,S)}n&&(n.width!=null&&m.width(n.width),n.height!=null&&m.height(n.height),n.padding!=null&&m.padding(n.padding)),await m.initialize(h,n.bind).runAsync();let x;if(o!==!1){let b=c;if(n.defaultStyle!==!1||n.forceActionsMenu){const E=document.createElement("details");E.title=s.CLICK_TO_VIEW_ACTIONS,c.append(E),b=E;const _=document.createElement("summary");_.innerHTML=YSe,E.append(_),x=k=>{E.contains(k.target)||E.removeAttribute("open")},document.addEventListener("click",x)}const S=document.createElement("div");if(b.append(S),S.classList.add("vega-actions"),o===!0||o.export!==!1){for(const E of["svg","png"])if(o===!0||o.export===!0||o.export[E]){const _=s[`${E.toUpperCase()}_ACTION`],k=document.createElement("a"),$=Q(n.scaleFactor)?n.scaleFactor[E]:n.scaleFactor;k.text=_,k.href="#",k.target="_blank",k.download=`${l}.${E}`,k.addEventListener("mousedown",async function(C){C.preventDefault();const R=await m.toImageURL(E,$);this.href=R}),S.append(k)}}if(o===!0||o.source!==!1){const E=document.createElement("a");E.text=s.SOURCE_ACTION,E.href="#",E.addEventListener("click",function(_){Q5(g2(t),n.sourceHeader??"",n.sourceFooter??"",f),_.preventDefault()}),S.append(E)}if(f==="vega-lite"&&(o===!0||o.compiled!==!1)){const E=document.createElement("a");E.text=s.COMPILED_ACTION,E.href="#",E.addEventListener("click",function(_){Q5(g2(d),n.sourceHeader??"",n.sourceFooter??"","vega"),_.preventDefault()}),S.append(E)}if(o===!0||o.editor!==!1){const E=n.editorUrl??"https://vega.github.io/editor/",_=document.createElement("a");_.text=s.EDITOR_ACTION,_.href="#",_.addEventListener("click",function(k){USe(window,E,{config:i,mode:p?"vega":f,renderer:a,spec:g2(p?d:t)}),k.preventDefault()}),S.append(_)}}function w(){x&&document.removeEventListener("click",x),m.finalize()}return{view:m,spec:t,vgSpec:d,finalize:w,embedOptions:n}}function n_e(e){return!!e&&{}.toString.call(e)==="[object Function]"}function r_e(e,t,n){n&&(n_e(n)?n(e.data(t)):e.change(t,gi.changeset().remove(()=>!0).insert(n)))}function i_e(e,t){Object.keys(t).forEach(n=>{r_e(e,n,t[n])})}function aq(e){const t=new Set;return e.forEach(n=>{Object.keys(n).forEach(r=>{t.add(r)})}),t}const uq=()=>{};function Bw(e,t){const n=Object.keys(t);return n.forEach(r=>{try{e.addSignalListener(r,t[r])}catch(i){console.warn("Cannot add invalid signal listener.",i)}}),n.length>0}var o_e=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!e(t[s],n[s]))return!1}return!0}return t!==t&&n!==n};const s_e=yy(o_e);function a_e(e,t){if(e===t)return!1;const n={width:!1,height:!1,isExpensive:!1},r=aq([e,t]);return r.has("width")&&(!("width"in e)||!("width"in t)||e.width!==t.width)&&("width"in e&&typeof e.width=="number"?n.width=e.width:n.isExpensive=!0),r.has("height")&&(!("height"in e)||!("height"in t)||e.height!==t.height)&&("height"in e&&typeof e.height=="number"?n.height=e.height:n.isExpensive=!0),r.delete("width"),r.delete("height"),[...r].some(i=>!(i in e)||!(i in t)||!s_e(e[i],t[i]))&&(n.isExpensive=!0),n.width!==!1||n.height!==!1||n.isExpensive?n:!1}function J5(e,t){const n=Object.keys(t);return n.forEach(r=>{try{e.removeSignalListener(r,t[r])}catch(i){console.warn("Cannot remove invalid signal listener.",i)}}),n.length>0}function jw(e){const{spec:t,width:n,height:r}=e;return typeof n<"u"&&typeof r<"u"?{...t,width:n,height:r}:typeof n<"u"?{...t,width:n}:typeof r<"u"?{...t,height:r}:t}function sh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class lq extends ua.PureComponent{constructor(){super(...arguments),sh(this,"containerRef",ua.createRef()),sh(this,"resultPromise",void 0),sh(this,"handleError",t=>{const{onError:n=uq}=this.props;n(t,this.containerRef.current),console.warn(t)}),sh(this,"modifyView",t=>{this.resultPromise&&this.resultPromise.then(n=>(n&&t(n.view),!0)).catch(this.handleError)})}componentDidMount(){this.createView()}componentDidUpdate(t){const n=aq([this.props,t]);if(n.delete("className"),n.delete("signalListeners"),n.delete("spec"),n.delete("style"),n.delete("width"),n.delete("height"),Array.from(n).some(r=>this.props[r]!==t[r]))this.clearView(),this.createView();else{const r=a_e(jw(this.props),jw(t)),{signalListeners:i}=this.props,{signalListeners:o}=t;if(r)if(r.isExpensive)this.clearView(),this.createView();else{const s=!Db(i,o);this.modifyView(a=>{r.width!==!1&&a.width(r.width),r.height!==!1&&a.height(r.height),s&&(o&&J5(a,o),i&&Bw(a,i)),a.run()})}else Db(i,o)||this.modifyView(s=>{o&&J5(s,o),i&&Bw(s,i),s.run()})}}componentWillUnmount(){this.clearView()}createView(){const{spec:t,onNewView:n,signalListeners:r={},width:i,height:o,...s}=this.props;if(this.containerRef.current){const a=jw(this.props);this.resultPromise=JSe(this.containerRef.current,a,s).then(u=>{if(u){const{view:l}=u;Bw(l,r)&&l.run()}return u}).catch(this.handleError),n&&this.modifyView(n)}}clearView(){return this.resultPromise&&this.resultPromise.then(t=>{t&&t.finalize()}).catch(this.handleError),this.resultPromise=void 0,this}render(){const{className:t,style:n}=this.props;return ua.createElement("div",{ref:this.containerRef,className:t,style:n})}}sh(lq,"propTypes",{className:CM.string,onError:CM.func});function XS(){return XS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},XS.apply(this,arguments)}function QS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u_e={};class cq extends ua.PureComponent{constructor(){super(...arguments),QS(this,"vegaEmbed",ua.createRef()),QS(this,"handleNewView",t=>{this.update();const{onNewView:n=uq}=this.props;n(t)})}componentDidMount(){this.update()}componentDidUpdate(t){Db(this.props.data,t.data)||this.update()}update(){const{data:t}=this.props;this.vegaEmbed.current&&t&&Object.keys(t).length>0&&this.vegaEmbed.current.modifyView(n=>{i_e(n,t),n.resize().run()})}render(){const{data:t,...n}=this.props;return ua.createElement(lq,XS({ref:this.vegaEmbed},n,{onNewView:this.handleNewView}))}}QS(cq,"defaultProps",{data:u_e});function KS(){return KS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KS.apply(this,arguments)}function l_e(e){return ua.createElement(cq,KS({},e,{mode:"vega-lite"}))}function c_e({build:e,repo:t}){return Se.jsxs("table",{children:[Se.jsx("thead",{children:Se.jsxs("tr",{children:[Se.jsx("th",{children:"Key"}),Se.jsx("th",{children:"Value"})]})}),Se.jsx("tbody",{children:Object.entries(e).map(([n,r])=>{if(n.startsWith("yearmonth"))return null;if(n.startsWith("github")){const i=`https://github.com/${t}/actions/runs/${r}`;return Se.jsxs("tr",{children:[Se.jsx("td",{children:"link"}),Se.jsx("td",{children:Se.jsx("a",{href:i,children:i})})]},n)}else return Se.jsxs("tr",{children:[Se.jsx("td",{children:`${n}`}),Se.jsx("td",{children:`${r}`})]},n)})})]})}function f_e({builds:e,repo:t}){const[n,r]=Qn.useState();return Se.jsxs("div",{style:{display:"flex"},children:[Se.jsx(l_e,{data:{values:e},patch:i=>{var o;return(o=i.signals)==null||o.push({name:"barClick",value:0,on:[{events:"*:mousedown",update:"datum"}]}),i},signalListeners:{barClick:(i,o)=>{r(o)}},spec:{$schema:"https://vega.github.io/schema/vega-lite/v5.json",width:1e3,height:400,mark:{type:"point",tooltip:{content:"data"}},data:{name:"values"},selection:{grid:{type:"interval",bind:"scales"}},encoding:{y:{field:"duration",type:"quantitative",axis:{title:"Duration (minutes)"}},x:{field:"updated_at",timeUnit:"yearmonthdatehoursminutes",type:"temporal",scale:{nice:"week"},axis:{title:"Date"}},color:{field:"state",type:"nominal",scale:{domain:["success","skipped","failure","canceled"],range:["#39aa56","#ff7f0e","#db4545","#9d9d9d"]}}}}}),n?Se.jsx(c_e,{repo:t,build:n}):null]})}class d_e{}class h_e{constructor(){this.signals=new Set,this.abortController=new AbortController}addSignal(t=new d_e){if(this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(t),t.aborted?this.handleAborted(t):typeof t.addEventListener=="function"&&t.addEventListener("abort",()=>{this.handleAborted(t)})}handleAborted(t){this.signals.delete(t),this.signals.size===0&&this.abortController.abort()}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}}class p_e{constructor(){this.callbacks=new Set}addCallback(t=()=>{}){this.callbacks.add(t),t(this.currentMessage)}callback(t){this.currentMessage=t;for(const n of this.callbacks)n(t)}}class my{constructor({fill:t,cache:n}){if(typeof t!="function")throw new TypeError("must pass a fill function");if(typeof n!="object")throw new TypeError("must pass a cache object");if(typeof n.get!="function"||typeof n.set!="function"||typeof n.delete!="function")throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=n,this.fillCallback=t}static isAbortException(t){return t.name==="AbortError"||t.code==="ERR_ABORTED"||t.message==="AbortError: aborted"||t.message==="Error: aborted"}evict(t,n){this.cache.get(t)===n&&this.cache.delete(t)}fill(t,n,r,i){const o=new h_e,s=new p_e;s.addCallback(i);const a={aborter:o,promise:this.fillCallback(n,o.signal,u=>{s.callback(u)}),settled:!1,statusReporter:s,get aborted(){return this.aborter.signal.aborted}};a.aborter.addSignal(r),a.aborter.signal.addEventListener("abort",()=>{a.settled||this.evict(t,a)}),a.promise.then(()=>{a.settled=!0},()=>{a.settled=!0,this.evict(t,a)}).catch(u=>{throw console.error(u),u}),this.cache.set(t,a)}static checkSinglePromise(t,n){function r(){if(n!=null&&n.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return t.then(i=>(r(),i),i=>{throw r(),i})}has(t){return this.cache.has(t)}get(t,n,r,i){if(!r&&n instanceof AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");const o=this.cache.get(t);return o?o.aborted&&!o.settled?(this.evict(t,o),this.get(t,n,r,i)):o.settled?o.promise:(o.aborter.addSignal(r),o.statusReporter.addCallback(i),my.checkSinglePromise(o.promise,r)):(this.fill(t,n,r,i),my.checkSinglePromise(this.cache.get(t).promise,r))}delete(t){const n=this.cache.get(t);n&&(n.settled||n.aborter.abort(),this.cache.delete(t))}clear(){const t=this.cache.keys();let n=0;for(let r=t.next();!r.done;r=t.next())this.delete(r.value),n+=1;return n}}var zr,Qe,lt,Xs,_p,Qs,Me,ZS,hi,fq,JS,e_,t_,dq,n_;class g_e extends Map{constructor(n={}){super();Os(this,Me);Os(this,zr,0);Os(this,Qe,new Map);Os(this,lt,new Map);Os(this,Xs);Os(this,_p);Os(this,Qs);if(!(n.maxSize&&n.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof n.maxAge=="number"&&n.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");an(this,Xs,n.maxSize),an(this,_p,n.maxAge||Number.POSITIVE_INFINITY),an(this,Qs,n.onEviction)}get __oldCache(){return ce(this,lt)}get(n){if(ce(this,Qe).has(n)){const r=ce(this,Qe).get(n);return rt(this,Me,JS).call(this,n,r)}if(ce(this,lt).has(n)){const r=ce(this,lt).get(n);if(rt(this,Me,hi).call(this,n,r)===!1)return rt(this,Me,dq).call(this,n,r),r.value}}set(n,r,{maxAge:i=ce(this,_p)}={}){const o=typeof i=="number"&&i!==Number.POSITIVE_INFINITY?Date.now()+i:void 0;return ce(this,Qe).has(n)?ce(this,Qe).set(n,{value:r,expiry:o}):rt(this,Me,t_).call(this,n,{value:r,expiry:o}),this}has(n){return ce(this,Qe).has(n)?!rt(this,Me,hi).call(this,n,ce(this,Qe).get(n)):ce(this,lt).has(n)?!rt(this,Me,hi).call(this,n,ce(this,lt).get(n)):!1}peek(n){if(ce(this,Qe).has(n))return rt(this,Me,e_).call(this,n,ce(this,Qe));if(ce(this,lt).has(n))return rt(this,Me,e_).call(this,n,ce(this,lt))}delete(n){const r=ce(this,Qe).delete(n);return r&&Ux(this,zr)._--,ce(this,lt).delete(n)||r}clear(){ce(this,Qe).clear(),ce(this,lt).clear(),an(this,zr,0)}resize(n){if(!(n&&n>0))throw new TypeError("`maxSize` must be a number greater than 0");const r=[...rt(this,Me,n_).call(this)],i=r.length-n;i<0?(an(this,Qe,new Map(r)),an(this,lt,new Map),an(this,zr,r.length)):(i>0&&rt(this,Me,ZS).call(this,r.slice(0,i)),an(this,lt,new Map(r.slice(i))),an(this,Qe,new Map),an(this,zr,0)),an(this,Xs,n)}*keys(){for(const[n]of this)yield n}*values(){for(const[,n]of this)yield n}*[Symbol.iterator](){for(const n of ce(this,Qe)){const[r,i]=n;rt(this,Me,hi).call(this,r,i)===!1&&(yield[r,i.value])}for(const n of ce(this,lt)){const[r,i]=n;ce(this,Qe).has(r)||rt(this,Me,hi).call(this,r,i)===!1&&(yield[r,i.value])}}*entriesDescending(){let n=[...ce(this,Qe)];for(let r=n.length-1;r>=0;--r){const i=n[r],[o,s]=i;rt(this,Me,hi).call(this,o,s)===!1&&(yield[o,s.value])}n=[...ce(this,lt)];for(let r=n.length-1;r>=0;--r){const i=n[r],[o,s]=i;ce(this,Qe).has(o)||rt(this,Me,hi).call(this,o,s)===!1&&(yield[o,s.value])}}*entriesAscending(){for(const[n,r]of rt(this,Me,n_).call(this))yield[n,r.value]}get size(){if(!ce(this,zr))return ce(this,lt).size;let n=0;for(const r of ce(this,lt).keys())ce(this,Qe).has(r)||n++;return Math.min(ce(this,zr)+n,ce(this,Xs))}get maxSize(){return ce(this,Xs)}entries(){return this.entriesAscending()}forEach(n,r=this){for(const[i,o]of this.entriesAscending())n.call(r,o,i,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}zr=new WeakMap,Qe=new WeakMap,lt=new WeakMap,Xs=new WeakMap,_p=new WeakMap,Qs=new WeakMap,Me=new WeakSet,ZS=function(n){if(typeof ce(this,Qs)=="function")for(const[r,i]of n)ce(this,Qs).call(this,r,i.value)},hi=function(n,r){return typeof r.expiry=="number"&&r.expiry<=Date.now()?(typeof ce(this,Qs)=="function"&&ce(this,Qs).call(this,n,r.value),this.delete(n)):!1},fq=function(n,r){if(rt(this,Me,hi).call(this,n,r)===!1)return r.value},JS=function(n,r){return r.expiry?rt(this,Me,fq).call(this,n,r):r.value},e_=function(n,r){const i=r.get(n);return rt(this,Me,JS).call(this,n,i)},t_=function(n,r){ce(this,Qe).set(n,r),Ux(this,zr)._++,ce(this,zr)>=ce(this,Xs)&&(an(this,zr,0),rt(this,Me,ZS).call(this,ce(this,lt)),an(this,lt,ce(this,Qe)),an(this,Qe,new Map))},dq=function(n,r){ce(this,lt).delete(n),rt(this,Me,t_).call(this,n,r)},n_=function*(){for(const n of ce(this,lt)){const[r,i]=n;ce(this,Qe).has(r)||rt(this,Me,hi).call(this,r,i)===!1&&(yield n)}for(const n of ce(this,Qe)){const[r,i]=n;rt(this,Me,hi).call(this,r,i)===!1&&(yield n)}};function m_e(e=[]){if(!e.length)return[];const t=e.map(i=>i.duration);let n=0;for(const i of t)n+=i;const r=n/t.length;return e.filter(i=>i.duration<r*2)}function y_e(e){return e.name==="AbortError"||e.code==="ERR_ABORTED"||e.message==="AbortError: aborted"||e.message==="Error: aborted"}const eD=100;function v_e({counter:e,repo:t}){return`https://api.github.com/repos/${t}/actions/runs?page=${Math.floor(e/eD)}&per_page=${eD}`}const x_e=new my({cache:new g_e({maxSize:1e3}),async fill(e,t){const{url:n,token:r}=e,i=await fetch(n,{headers:{Accept:"application/vnd.github.v3+json",...r?{Authorization:`token ${r}`}:{}},signal:t});if(!i.ok)throw new Error(`HTTP ${i.status} ${i.statusText}`);const o=await i.json();return{total:o.total_count,result:m_e(o.workflow_runs.map(s=>{var a,u;return{message:(u=(a=s.head_commit)==null?void 0:a.message)==null?void 0:u.slice(0,50),branch:s.head_branch,name:s.name,github_link:s.id,duration:Math.min(Math.abs(new Date(s.updated_at)-new Date(s.created_at))/6e4,100),state:s.conclusion,updated_at:new Date(s.updated_at),updated_at2:s.updated_at}}))}}});function w_e(e){const[t,n]=Qn.useState(0),[r,i]=Qn.useState(),[o,s]=Qn.useState(),[a,u]=Qn.useState(e.repo?"Loading...":""),[l,c]=Qn.useState([]);return Qn.useEffect(()=>{(async()=>{try{if(i(void 0),e!=null&&e.repo){const f=v_e({...e,counter:l.length});if(!(f&&o)||o>=l.length){const d=e.token,{total:h,result:p}=await x_e.get(f+d,{url:f,token:d});p.length?(c([...l,...p]),s(h),u(`Loading builds...${l.length}/${h}`)):(u(""),n(0))}else l.length?(u(""),n(0)):i("No builds loaded")}}catch(f){y_e(f)||(console.error(f),i(f))}})()},[a,e,t,l,o]),[a,r,l]}function b_e(){const[e,t]=Qn.useState(""),[n,r]=Qn.useState(""),[i,o]=Qn.useState(""),[s,a]=Qn.useState(""),[u,l,c]=w_e({repo:e,token:n});return Se.jsxs(Se.Fragment,{children:[Se.jsx("h1",{children:"githubgraph-js - GitHub actions graphs"}),Se.jsxs("form",{onSubmit:f=>{f.preventDefault(),t(i),r(s)},children:[Se.jsxs("div",{children:[Se.jsx("label",{style:{marginRight:10},children:"Repo name:"}),Se.jsx("input",{value:i,onChange:f=>o(f.target.value)})]}),Se.jsxs("div",{children:[Se.jsx("label",{style:{marginRight:10},children:"Access token (optional, let's you make more API requests without limitations):"}),Se.jsx("input",{value:s,onChange:f=>a(f.target.value)})]}),Se.jsx("button",{type:"submit",children:"Submit"})]}),l?Se.jsx("p",{style:{color:"red"},children:`${l}`}):u?Se.jsx("p",{children:u}):c.length?Se.jsx("div",{style:{marginTop:50},children:Se.jsx(f_e,{builds:c,repo:e})}):null,c?Se.jsx("textarea",{style:{marginTop:20},rows:10,cols:120,onChange:()=>{},value:[["branch","duration","github_link","message","name","state","updated_at"].join("	"),...c.map(f=>{var d;return`${f.branch}	${f.duration}	${f.github_link}	${(d=f.message)==null?void 0:d.replaceAll(`
`," ").replaceAll("	"," ")}	${f.name}	${f.state}	${f.updated_at2}`}).filter(f=>!!f.trim())].join(`
`)}):null,Se.jsx("div",{style:{marginTop:50},children:Se.jsx("a",{href:"https://github.com/cmdcolin/githubgraphjs/",children:"source code"})})]})}Uw.createRoot(document.getElementById("root")).render(Se.jsx(ua.StrictMode,{children:Se.jsx(b_e,{})}))});export default E_e();
