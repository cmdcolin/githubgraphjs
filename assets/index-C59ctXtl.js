var tH=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var l2=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var ce=(e,t,n)=>(l2(e,t,"read from private field"),n?n.call(e):t.get(e)),Cn=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},sn=(e,t,n,r)=>(l2(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);var c2=(e,t,n,r)=>({set _(i){sn(e,t,i,n)},get _(){return ce(e,t,r)}}),it=(e,t,n)=>(l2(e,t,"access private method"),n);var xke=tH((i$e,jT)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Yc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Iy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var q5={exports:{}},By={},H5={exports:{}},_e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xp=Symbol.for("react.element"),nH=Symbol.for("react.portal"),rH=Symbol.for("react.fragment"),iH=Symbol.for("react.strict_mode"),oH=Symbol.for("react.profiler"),sH=Symbol.for("react.provider"),aH=Symbol.for("react.context"),uH=Symbol.for("react.forward_ref"),lH=Symbol.for("react.suspense"),cH=Symbol.for("react.memo"),fH=Symbol.for("react.lazy"),eF=Symbol.iterator;function dH(e){return e===null||typeof e!="object"?null:(e=eF&&e[eF]||e["@@iterator"],typeof e=="function"?e:null)}var G5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V5=Object.assign,Y5={};function zf(e,t,n){this.props=e,this.context=t,this.refs=Y5,this.updater=n||G5}zf.prototype.isReactComponent={};zf.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};zf.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function X5(){}X5.prototype=zf.prototype;function C_(e,t,n){this.props=e,this.context=t,this.refs=Y5,this.updater=n||G5}var A_=C_.prototype=new X5;A_.constructor=C_;V5(A_,zf.prototype);A_.isPureReactComponent=!0;var tF=Array.isArray,Q5=Object.prototype.hasOwnProperty,T_={current:null},K5={key:!0,ref:!0,__self:!0,__source:!0};function J5(e,t,n){var r,i={},o=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)Q5.call(t,r)&&!K5.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var u=Array(a),l=0;l<a;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Xp,type:e,key:o,ref:s,props:i,_owner:T_.current}}function hH(e,t){return{$$typeof:Xp,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function F_(e){return typeof e=="object"&&e!==null&&e.$$typeof===Xp}function pH(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var nF=/\/+/g;function f2(e,t){return typeof e=="object"&&e!==null&&e.key!=null?pH(""+e.key):t.toString(36)}function Vm(e,t,n,r,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Xp:case nH:s=!0}}if(s)return s=e,i=i(s),e=r===""?"."+f2(s,0):r,tF(i)?(n="",e!=null&&(n=e.replace(nF,"$&/")+"/"),Vm(i,t,n,"",function(l){return l})):i!=null&&(F_(i)&&(i=hH(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(nF,"$&/")+"/")+e)),t.push(i)),1;if(s=0,r=r===""?".":r+":",tF(e))for(var a=0;a<e.length;a++){o=e[a];var u=r+f2(o,a);s+=Vm(o,t,n,u,i)}else if(u=dH(e),typeof u=="function")for(e=u.call(e),a=0;!(o=e.next()).done;)o=o.value,u=r+f2(o,a++),s+=Vm(o,t,n,u,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function qg(e,t,n){if(e==null)return e;var r=[],i=0;return Vm(e,r,"","",function(o){return t.call(n,o,i++)}),r}function gH(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Hn={current:null},Ym={transition:null},mH={ReactCurrentDispatcher:Hn,ReactCurrentBatchConfig:Ym,ReactCurrentOwner:T_};_e.Children={map:qg,forEach:function(e,t,n){qg(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return qg(e,function(){t++}),t},toArray:function(e){return qg(e,function(t){return t})||[]},only:function(e){if(!F_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_e.Component=zf;_e.Fragment=rH;_e.Profiler=oH;_e.PureComponent=C_;_e.StrictMode=iH;_e.Suspense=lH;_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mH;_e.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=V5({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=T_.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(u in t)Q5.call(t,u)&&!K5.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&a!==void 0?a[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){a=Array(u);for(var l=0;l<u;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:Xp,type:e.type,key:i,ref:o,props:r,_owner:s}};_e.createContext=function(e){return e={$$typeof:aH,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:sH,_context:e},e.Consumer=e};_e.createElement=J5;_e.createFactory=function(e){var t=J5.bind(null,e);return t.type=e,t};_e.createRef=function(){return{current:null}};_e.forwardRef=function(e){return{$$typeof:uH,render:e}};_e.isValidElement=F_;_e.lazy=function(e){return{$$typeof:fH,_payload:{_status:-1,_result:e},_init:gH}};_e.memo=function(e,t){return{$$typeof:cH,type:e,compare:t===void 0?null:t}};_e.startTransition=function(e){var t=Ym.transition;Ym.transition={};try{e()}finally{Ym.transition=t}};_e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};_e.useCallback=function(e,t){return Hn.current.useCallback(e,t)};_e.useContext=function(e){return Hn.current.useContext(e)};_e.useDebugValue=function(){};_e.useDeferredValue=function(e){return Hn.current.useDeferredValue(e)};_e.useEffect=function(e,t){return Hn.current.useEffect(e,t)};_e.useId=function(){return Hn.current.useId()};_e.useImperativeHandle=function(e,t,n){return Hn.current.useImperativeHandle(e,t,n)};_e.useInsertionEffect=function(e,t){return Hn.current.useInsertionEffect(e,t)};_e.useLayoutEffect=function(e,t){return Hn.current.useLayoutEffect(e,t)};_e.useMemo=function(e,t){return Hn.current.useMemo(e,t)};_e.useReducer=function(e,t,n){return Hn.current.useReducer(e,t,n)};_e.useRef=function(e){return Hn.current.useRef(e)};_e.useState=function(e){return Hn.current.useState(e)};_e.useSyncExternalStore=function(e,t,n){return Hn.current.useSyncExternalStore(e,t,n)};_e.useTransition=function(){return Hn.current.useTransition()};_e.version="18.2.0";H5.exports=_e;var Kn=H5.exports;const fa=Iy(Kn);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yH=Kn,vH=Symbol.for("react.element"),xH=Symbol.for("react.fragment"),bH=Object.prototype.hasOwnProperty,wH=yH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,EH={key:!0,ref:!0,__self:!0,__source:!0};function Z5(e,t,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)bH.call(t,r)&&!EH.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:vH,type:e,key:o,ref:s,props:i,_owner:wH.current}}By.Fragment=xH;By.jsx=Z5;By.jsxs=Z5;q5.exports=By;var we=q5.exports,dw={},e4={exports:{}},Lr={},t4={exports:{}},n4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(N,O){var j=N.length;N.push(O);e:for(;0<j;){var X=j-1>>>1,re=N[X];if(0<i(re,O))N[X]=O,N[j]=re,j=X;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var O=N[0],j=N.pop();if(j!==O){N[0]=j;e:for(var X=0,re=N.length,be=re>>>1;X<be;){var he=2*(X+1)-1,Le=N[he],Gt=he+1,hi=N[Gt];if(0>i(Le,j))Gt<re&&0>i(hi,Le)?(N[X]=hi,N[Gt]=j,X=Gt):(N[X]=Le,N[he]=j,X=he);else if(Gt<re&&0>i(hi,j))N[X]=hi,N[Gt]=j,X=Gt;else break e}}return O}function i(N,O){var j=N.sortIndex-O.sortIndex;return j!==0?j:N.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var u=[],l=[],c=1,f=null,d=3,h=!1,p=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(N){for(var O=n(l);O!==null;){if(O.callback===null)r(l);else if(O.startTime<=N)r(l),O.sortIndex=O.expirationTime,t(u,O);else break;O=n(l)}}function b(N){if(g=!1,x(N),!p)if(n(u)!==null)p=!0,M(w);else{var O=n(l);O!==null&&P(b,O.startTime-N)}}function w(N,O){p=!1,g&&(g=!1,y(_),_=-1),h=!0;var j=d;try{for(x(O),f=n(u);f!==null&&(!(f.expirationTime>O)||N&&!C());){var X=f.callback;if(typeof X=="function"){f.callback=null,d=f.priorityLevel;var re=X(f.expirationTime<=O);O=e.unstable_now(),typeof re=="function"?f.callback=re:f===n(u)&&r(u),x(O)}else r(u);f=n(u)}if(f!==null)var be=!0;else{var he=n(l);he!==null&&P(b,he.startTime-O),be=!1}return be}finally{f=null,d=j,h=!1}}var S=!1,E=null,_=-1,k=5,$=-1;function C(){return!(e.unstable_now()-$<k)}function R(){if(E!==null){var N=e.unstable_now();$=N;var O=!0;try{O=E(!0,N)}finally{O?A():(S=!1,E=null)}}else S=!1}var A;if(typeof v=="function")A=function(){v(R)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,T=F.port2;F.port1.onmessage=R,A=function(){T.postMessage(null)}}else A=function(){m(R,0)};function M(N){E=N,S||(S=!0,A())}function P(N,O){_=m(function(){N(e.unstable_now())},O)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(N){N.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,M(w))},e.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<N?Math.floor(1e3/N):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(N){switch(d){case 1:case 2:case 3:var O=3;break;default:O=d}var j=d;d=O;try{return N()}finally{d=j}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(N,O){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var j=d;d=N;try{return O()}finally{d=j}},e.unstable_scheduleCallback=function(N,O,j){var X=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?X+j:X):j=X,N){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=j+re,N={id:c++,callback:O,priorityLevel:N,startTime:j,expirationTime:re,sortIndex:-1},j>X?(N.sortIndex=j,t(l,N),n(u)===null&&N===n(l)&&(g?(y(_),_=-1):g=!0,P(b,j-X))):(N.sortIndex=re,t(u,N),p||h||(p=!0,M(w))),N},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(N){var O=d;return function(){var j=d;d=O;try{return N.apply(this,arguments)}finally{d=j}}}})(n4);t4.exports=n4;var SH=t4.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r4=Kn,Mr=SH;function H(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i4=new Set,Gh={};function Fl(e,t){Xc(e,t),Xc(e+"Capture",t)}function Xc(e,t){for(Gh[e]=t,e=0;e<t.length;e++)i4.add(t[e])}var vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hw=Object.prototype.hasOwnProperty,_H=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rF={},iF={};function kH(e){return hw.call(iF,e)?!0:hw.call(rF,e)?!1:_H.test(e)?iF[e]=!0:(rF[e]=!0,!1)}function $H(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function CH(e,t,n,r){if(t===null||typeof t>"u"||$H(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Gn(e,t,n,r,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var tn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){tn[e]=new Gn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];tn[t]=new Gn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){tn[e]=new Gn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){tn[e]=new Gn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){tn[e]=new Gn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){tn[e]=new Gn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){tn[e]=new Gn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){tn[e]=new Gn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){tn[e]=new Gn(e,5,!1,e.toLowerCase(),null,!1,!1)});var M_=/[\-:]([a-z])/g;function N_(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(M_,N_);tn[t]=new Gn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(M_,N_);tn[t]=new Gn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(M_,N_);tn[t]=new Gn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){tn[e]=new Gn(e,1,!1,e.toLowerCase(),null,!1,!1)});tn.xlinkHref=new Gn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){tn[e]=new Gn(e,1,!1,e.toLowerCase(),null,!0,!0)});function O_(e,t,n,r){var i=tn.hasOwnProperty(t)?tn[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(CH(t,n,i,r)&&(n=null),r||i===null?kH(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Cs=r4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hg=Symbol.for("react.element"),dc=Symbol.for("react.portal"),hc=Symbol.for("react.fragment"),R_=Symbol.for("react.strict_mode"),pw=Symbol.for("react.profiler"),o4=Symbol.for("react.provider"),s4=Symbol.for("react.context"),D_=Symbol.for("react.forward_ref"),gw=Symbol.for("react.suspense"),mw=Symbol.for("react.suspense_list"),P_=Symbol.for("react.memo"),Us=Symbol.for("react.lazy"),a4=Symbol.for("react.offscreen"),oF=Symbol.iterator;function dd(e){return e===null||typeof e!="object"?null:(e=oF&&e[oF]||e["@@iterator"],typeof e=="function"?e:null)}var ut=Object.assign,d2;function Gd(e){if(d2===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);d2=t&&t[1]||""}return`
`+d2+e}var h2=!1;function p2(e,t){if(!e||h2)return"";h2=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var u=`
`+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=s&&0<=a);break}}}finally{h2=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Gd(e):""}function AH(e){switch(e.tag){case 5:return Gd(e.type);case 16:return Gd("Lazy");case 13:return Gd("Suspense");case 19:return Gd("SuspenseList");case 0:case 2:case 15:return e=p2(e.type,!1),e;case 11:return e=p2(e.type.render,!1),e;case 1:return e=p2(e.type,!0),e;default:return""}}function yw(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case hc:return"Fragment";case dc:return"Portal";case pw:return"Profiler";case R_:return"StrictMode";case gw:return"Suspense";case mw:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case s4:return(e.displayName||"Context")+".Consumer";case o4:return(e._context.displayName||"Context")+".Provider";case D_:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case P_:return t=e.displayName||null,t!==null?t:yw(e.type)||"Memo";case Us:t=e._payload,e=e._init;try{return yw(e(t))}catch{}}return null}function TH(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yw(t);case 8:return t===R_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function $a(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function u4(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function FH(e){var t=u4(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Gg(e){e._valueTracker||(e._valueTracker=FH(e))}function l4(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=u4(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function F0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function vw(e,t){var n=t.checked;return ut({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function sF(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=$a(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function c4(e,t){t=t.checked,t!=null&&O_(e,"checked",t,!1)}function xw(e,t){c4(e,t);var n=$a(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?bw(e,t.type,n):t.hasOwnProperty("defaultValue")&&bw(e,t.type,$a(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function aF(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function bw(e,t,n){(t!=="number"||F0(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Vd=Array.isArray;function Mc(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+$a(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function ww(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(H(91));return ut({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function uF(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(H(92));if(Vd(n)){if(1<n.length)throw Error(H(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:$a(n)}}function f4(e,t){var n=$a(t.value),r=$a(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function lF(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function d4(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ew(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?d4(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Vg,h4=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Vg=Vg||document.createElement("div"),Vg.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Vg.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Vh(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Eh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MH=["Webkit","ms","Moz","O"];Object.keys(Eh).forEach(function(e){MH.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Eh[t]=Eh[e]})});function p4(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Eh.hasOwnProperty(e)&&Eh[e]?(""+t).trim():t+"px"}function g4(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=p4(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var NH=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sw(e,t){if(t){if(NH[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(H(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(H(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(H(61))}if(t.style!=null&&typeof t.style!="object")throw Error(H(62))}}function _w(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kw=null;function L_(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var $w=null,Nc=null,Oc=null;function cF(e){if(e=Jp(e)){if(typeof $w!="function")throw Error(H(280));var t=e.stateNode;t&&(t=Hy(t),$w(e.stateNode,e.type,t))}}function m4(e){Nc?Oc?Oc.push(e):Oc=[e]:Nc=e}function y4(){if(Nc){var e=Nc,t=Oc;if(Oc=Nc=null,cF(e),t)for(e=0;e<t.length;e++)cF(t[e])}}function v4(e,t){return e(t)}function x4(){}var g2=!1;function b4(e,t,n){if(g2)return e(t,n);g2=!0;try{return v4(e,t,n)}finally{g2=!1,(Nc!==null||Oc!==null)&&(x4(),y4())}}function Yh(e,t){var n=e.stateNode;if(n===null)return null;var r=Hy(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(H(231,t,typeof n));return n}var Cw=!1;if(vs)try{var hd={};Object.defineProperty(hd,"passive",{get:function(){Cw=!0}}),window.addEventListener("test",hd,hd),window.removeEventListener("test",hd,hd)}catch{Cw=!1}function OH(e,t,n,r,i,o,s,a,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var Sh=!1,M0=null,N0=!1,Aw=null,RH={onError:function(e){Sh=!0,M0=e}};function DH(e,t,n,r,i,o,s,a,u){Sh=!1,M0=null,OH.apply(RH,arguments)}function PH(e,t,n,r,i,o,s,a,u){if(DH.apply(this,arguments),Sh){if(Sh){var l=M0;Sh=!1,M0=null}else throw Error(H(198));N0||(N0=!0,Aw=l)}}function Ml(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function w4(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function fF(e){if(Ml(e)!==e)throw Error(H(188))}function LH(e){var t=e.alternate;if(!t){if(t=Ml(e),t===null)throw Error(H(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return fF(i),e;if(o===r)return fF(i),t;o=o.sibling}throw Error(H(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?e:t}function E4(e){return e=LH(e),e!==null?S4(e):null}function S4(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=S4(e);if(t!==null)return t;e=e.sibling}return null}var _4=Mr.unstable_scheduleCallback,dF=Mr.unstable_cancelCallback,zH=Mr.unstable_shouldYield,IH=Mr.unstable_requestPaint,yt=Mr.unstable_now,BH=Mr.unstable_getCurrentPriorityLevel,z_=Mr.unstable_ImmediatePriority,k4=Mr.unstable_UserBlockingPriority,O0=Mr.unstable_NormalPriority,jH=Mr.unstable_LowPriority,$4=Mr.unstable_IdlePriority,jy=null,po=null;function UH(e){if(po&&typeof po.onCommitFiberRoot=="function")try{po.onCommitFiberRoot(jy,e,void 0,(e.current.flags&128)===128)}catch{}}var Di=Math.clz32?Math.clz32:HH,WH=Math.log,qH=Math.LN2;function HH(e){return e>>>=0,e===0?32:31-(WH(e)/qH|0)|0}var Yg=64,Xg=4194304;function Yd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function R0(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Yd(a):(o&=s,o!==0&&(r=Yd(o)))}else s=n&~i,s!==0?r=Yd(s):o!==0&&(r=Yd(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Di(t),i=1<<n,r|=e[n],t&=~i;return r}function GH(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VH(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-Di(o),a=1<<s,u=i[s];u===-1?(!(a&n)||a&r)&&(i[s]=GH(a,t)):u<=t&&(e.expiredLanes|=a),o&=~a}}function Tw(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function C4(){var e=Yg;return Yg<<=1,!(Yg&4194240)&&(Yg=64),e}function m2(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Qp(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Di(t),e[t]=n}function YH(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Di(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}function I_(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Di(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Be=0;function A4(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var T4,B_,F4,M4,N4,Fw=!1,Qg=[],da=null,ha=null,pa=null,Xh=new Map,Qh=new Map,Xs=[],XH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hF(e,t){switch(e){case"focusin":case"focusout":da=null;break;case"dragenter":case"dragleave":ha=null;break;case"mouseover":case"mouseout":pa=null;break;case"pointerover":case"pointerout":Xh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qh.delete(t.pointerId)}}function pd(e,t,n,r,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},t!==null&&(t=Jp(t),t!==null&&B_(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function QH(e,t,n,r,i){switch(t){case"focusin":return da=pd(da,e,t,n,r,i),!0;case"dragenter":return ha=pd(ha,e,t,n,r,i),!0;case"mouseover":return pa=pd(pa,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Xh.set(o,pd(Xh.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Qh.set(o,pd(Qh.get(o)||null,e,t,n,r,i)),!0}return!1}function O4(e){var t=Du(e.target);if(t!==null){var n=Ml(t);if(n!==null){if(t=n.tag,t===13){if(t=w4(n),t!==null){e.blockedOn=t,N4(e.priority,function(){F4(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xm(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Mw(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);kw=r,n.target.dispatchEvent(r),kw=null}else return t=Jp(n),t!==null&&B_(t),e.blockedOn=n,!1;t.shift()}return!0}function pF(e,t,n){Xm(e)&&n.delete(t)}function KH(){Fw=!1,da!==null&&Xm(da)&&(da=null),ha!==null&&Xm(ha)&&(ha=null),pa!==null&&Xm(pa)&&(pa=null),Xh.forEach(pF),Qh.forEach(pF)}function gd(e,t){e.blockedOn===t&&(e.blockedOn=null,Fw||(Fw=!0,Mr.unstable_scheduleCallback(Mr.unstable_NormalPriority,KH)))}function Kh(e){function t(i){return gd(i,e)}if(0<Qg.length){gd(Qg[0],e);for(var n=1;n<Qg.length;n++){var r=Qg[n];r.blockedOn===e&&(r.blockedOn=null)}}for(da!==null&&gd(da,e),ha!==null&&gd(ha,e),pa!==null&&gd(pa,e),Xh.forEach(t),Qh.forEach(t),n=0;n<Xs.length;n++)r=Xs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Xs.length&&(n=Xs[0],n.blockedOn===null);)O4(n),n.blockedOn===null&&Xs.shift()}var Rc=Cs.ReactCurrentBatchConfig,D0=!0;function JH(e,t,n,r){var i=Be,o=Rc.transition;Rc.transition=null;try{Be=1,j_(e,t,n,r)}finally{Be=i,Rc.transition=o}}function ZH(e,t,n,r){var i=Be,o=Rc.transition;Rc.transition=null;try{Be=4,j_(e,t,n,r)}finally{Be=i,Rc.transition=o}}function j_(e,t,n,r){if(D0){var i=Mw(e,t,n,r);if(i===null)$2(e,t,r,P0,n),hF(e,r);else if(QH(i,e,t,n,r))r.stopPropagation();else if(hF(e,r),t&4&&-1<XH.indexOf(e)){for(;i!==null;){var o=Jp(i);if(o!==null&&T4(o),o=Mw(e,t,n,r),o===null&&$2(e,t,r,P0,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else $2(e,t,r,null,n)}}var P0=null;function Mw(e,t,n,r){if(P0=null,e=L_(r),e=Du(e),e!==null)if(t=Ml(e),t===null)e=null;else if(n=t.tag,n===13){if(e=w4(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return P0=e,null}function R4(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BH()){case z_:return 1;case k4:return 4;case O0:case jH:return 16;case $4:return 536870912;default:return 16}default:return 16}}var ea=null,U_=null,Qm=null;function D4(){if(Qm)return Qm;var e,t=U_,n=t.length,r,i="value"in ea?ea.value:ea.textContent,o=i.length;for(e=0;e<n&&t[e]===i[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===i[o-r];r++);return Qm=i.slice(e,1<r?1-r:void 0)}function Km(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Kg(){return!0}function gF(){return!1}function zr(e){function t(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Kg:gF,this.isPropagationStopped=gF,this}return ut(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Kg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Kg)},persist:function(){},isPersistent:Kg}),t}var If={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},W_=zr(If),Kp=ut({},If,{view:0,detail:0}),eG=zr(Kp),y2,v2,md,Uy=ut({},Kp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:q_,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==md&&(md&&e.type==="mousemove"?(y2=e.screenX-md.screenX,v2=e.screenY-md.screenY):v2=y2=0,md=e),y2)},movementY:function(e){return"movementY"in e?e.movementY:v2}}),mF=zr(Uy),tG=ut({},Uy,{dataTransfer:0}),nG=zr(tG),rG=ut({},Kp,{relatedTarget:0}),x2=zr(rG),iG=ut({},If,{animationName:0,elapsedTime:0,pseudoElement:0}),oG=zr(iG),sG=ut({},If,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),aG=zr(sG),uG=ut({},If,{data:0}),yF=zr(uG),lG={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cG={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fG={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dG(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=fG[e])?!!t[e]:!1}function q_(){return dG}var hG=ut({},Kp,{key:function(e){if(e.key){var t=lG[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Km(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?cG[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:q_,charCode:function(e){return e.type==="keypress"?Km(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Km(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),pG=zr(hG),gG=ut({},Uy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vF=zr(gG),mG=ut({},Kp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:q_}),yG=zr(mG),vG=ut({},If,{propertyName:0,elapsedTime:0,pseudoElement:0}),xG=zr(vG),bG=ut({},Uy,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),wG=zr(bG),EG=[9,13,27,32],H_=vs&&"CompositionEvent"in window,_h=null;vs&&"documentMode"in document&&(_h=document.documentMode);var SG=vs&&"TextEvent"in window&&!_h,P4=vs&&(!H_||_h&&8<_h&&11>=_h),xF=" ",bF=!1;function L4(e,t){switch(e){case"keyup":return EG.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function z4(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var pc=!1;function _G(e,t){switch(e){case"compositionend":return z4(t);case"keypress":return t.which!==32?null:(bF=!0,xF);case"textInput":return e=t.data,e===xF&&bF?null:e;default:return null}}function kG(e,t){if(pc)return e==="compositionend"||!H_&&L4(e,t)?(e=D4(),Qm=U_=ea=null,pc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return P4&&t.locale!=="ko"?null:t.data;default:return null}}var $G={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wF(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!$G[e.type]:t==="textarea"}function I4(e,t,n,r){m4(r),t=L0(t,"onChange"),0<t.length&&(n=new W_("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var kh=null,Jh=null;function CG(e){Q4(e,0)}function Wy(e){var t=yc(e);if(l4(t))return e}function AG(e,t){if(e==="change")return t}var B4=!1;if(vs){var b2;if(vs){var w2="oninput"in document;if(!w2){var EF=document.createElement("div");EF.setAttribute("oninput","return;"),w2=typeof EF.oninput=="function"}b2=w2}else b2=!1;B4=b2&&(!document.documentMode||9<document.documentMode)}function SF(){kh&&(kh.detachEvent("onpropertychange",j4),Jh=kh=null)}function j4(e){if(e.propertyName==="value"&&Wy(Jh)){var t=[];I4(t,Jh,e,L_(e)),b4(CG,t)}}function TG(e,t,n){e==="focusin"?(SF(),kh=t,Jh=n,kh.attachEvent("onpropertychange",j4)):e==="focusout"&&SF()}function FG(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Wy(Jh)}function MG(e,t){if(e==="click")return Wy(t)}function NG(e,t){if(e==="input"||e==="change")return Wy(t)}function OG(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ii=typeof Object.is=="function"?Object.is:OG;function Zh(e,t){if(Ii(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!hw.call(t,i)||!Ii(e[i],t[i]))return!1}return!0}function _F(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function kF(e,t){var n=_F(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_F(n)}}function U4(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?U4(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function W4(){for(var e=window,t=F0();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=F0(e.document)}return t}function G_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function RG(e){var t=W4(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&U4(n.ownerDocument.documentElement,n)){if(r!==null&&G_(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=kF(n,o);var s=kF(n,r);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var DG=vs&&"documentMode"in document&&11>=document.documentMode,gc=null,Nw=null,$h=null,Ow=!1;function $F(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ow||gc==null||gc!==F0(r)||(r=gc,"selectionStart"in r&&G_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$h&&Zh($h,r)||($h=r,r=L0(Nw,"onSelect"),0<r.length&&(t=new W_("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gc)))}function Jg(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var mc={animationend:Jg("Animation","AnimationEnd"),animationiteration:Jg("Animation","AnimationIteration"),animationstart:Jg("Animation","AnimationStart"),transitionend:Jg("Transition","TransitionEnd")},E2={},q4={};vs&&(q4=document.createElement("div").style,"AnimationEvent"in window||(delete mc.animationend.animation,delete mc.animationiteration.animation,delete mc.animationstart.animation),"TransitionEvent"in window||delete mc.transitionend.transition);function qy(e){if(E2[e])return E2[e];if(!mc[e])return e;var t=mc[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in q4)return E2[e]=t[n];return e}var H4=qy("animationend"),G4=qy("animationiteration"),V4=qy("animationstart"),Y4=qy("transitionend"),X4=new Map,CF="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Va(e,t){X4.set(e,t),Fl(t,[e])}for(var S2=0;S2<CF.length;S2++){var _2=CF[S2],PG=_2.toLowerCase(),LG=_2[0].toUpperCase()+_2.slice(1);Va(PG,"on"+LG)}Va(H4,"onAnimationEnd");Va(G4,"onAnimationIteration");Va(V4,"onAnimationStart");Va("dblclick","onDoubleClick");Va("focusin","onFocus");Va("focusout","onBlur");Va(Y4,"onTransitionEnd");Xc("onMouseEnter",["mouseout","mouseover"]);Xc("onMouseLeave",["mouseout","mouseover"]);Xc("onPointerEnter",["pointerout","pointerover"]);Xc("onPointerLeave",["pointerout","pointerover"]);Fl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zG=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xd));function AF(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,PH(r,t,void 0,e),e.currentTarget=null}function Q4(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],u=a.instance,l=a.currentTarget;if(a=a.listener,u!==o&&i.isPropagationStopped())break e;AF(i,a,l),o=u}else for(s=0;s<r.length;s++){if(a=r[s],u=a.instance,l=a.currentTarget,a=a.listener,u!==o&&i.isPropagationStopped())break e;AF(i,a,l),o=u}}}if(N0)throw e=Aw,N0=!1,Aw=null,e}function Xe(e,t){var n=t[zw];n===void 0&&(n=t[zw]=new Set);var r=e+"__bubble";n.has(r)||(K4(t,e,2,!1),n.add(r))}function k2(e,t,n){var r=0;t&&(r|=4),K4(n,e,r,t)}var Zg="_reactListening"+Math.random().toString(36).slice(2);function ep(e){if(!e[Zg]){e[Zg]=!0,i4.forEach(function(n){n!=="selectionchange"&&(zG.has(n)||k2(n,!1,e),k2(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Zg]||(t[Zg]=!0,k2("selectionchange",!1,t))}}function K4(e,t,n,r){switch(R4(t)){case 1:var i=JH;break;case 4:i=ZH;break;default:i=j_}n=i.bind(null,t,n,e),i=void 0,!Cw||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function $2(e,t,n,r,i){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Du(a),s===null)return;if(u=s.tag,u===5||u===6){r=o=s;continue e}a=a.parentNode}}r=r.return}b4(function(){var l=o,c=L_(n),f=[];e:{var d=X4.get(e);if(d!==void 0){var h=W_,p=e;switch(e){case"keypress":if(Km(n)===0)break e;case"keydown":case"keyup":h=pG;break;case"focusin":p="focus",h=x2;break;case"focusout":p="blur",h=x2;break;case"beforeblur":case"afterblur":h=x2;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=mF;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=nG;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=yG;break;case H4:case G4:case V4:h=oG;break;case Y4:h=xG;break;case"scroll":h=eG;break;case"wheel":h=wG;break;case"copy":case"cut":case"paste":h=aG;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=vF}var g=(t&4)!==0,m=!g&&e==="scroll",y=g?d!==null?d+"Capture":null:d;g=[];for(var v=l,x;v!==null;){x=v;var b=x.stateNode;if(x.tag===5&&b!==null&&(x=b,y!==null&&(b=Yh(v,y),b!=null&&g.push(tp(v,b,x)))),m)break;v=v.return}0<g.length&&(d=new h(d,p,null,n,c),f.push({event:d,listeners:g}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&n!==kw&&(p=n.relatedTarget||n.fromElement)&&(Du(p)||p[xs]))break e;if((h||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?Du(p):null,p!==null&&(m=Ml(p),p!==m||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(g=mF,b="onMouseLeave",y="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(g=vF,b="onPointerLeave",y="onPointerEnter",v="pointer"),m=h==null?d:yc(h),x=p==null?d:yc(p),d=new g(b,v+"leave",h,n,c),d.target=m,d.relatedTarget=x,b=null,Du(c)===l&&(g=new g(y,v+"enter",p,n,c),g.target=x,g.relatedTarget=m,b=g),m=b,h&&p)t:{for(g=h,y=p,v=0,x=g;x;x=Xl(x))v++;for(x=0,b=y;b;b=Xl(b))x++;for(;0<v-x;)g=Xl(g),v--;for(;0<x-v;)y=Xl(y),x--;for(;v--;){if(g===y||y!==null&&g===y.alternate)break t;g=Xl(g),y=Xl(y)}g=null}else g=null;h!==null&&TF(f,d,h,g,!1),p!==null&&m!==null&&TF(f,m,p,g,!0)}}e:{if(d=l?yc(l):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var w=AG;else if(wF(d))if(B4)w=NG;else{w=FG;var S=TG}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=MG);if(w&&(w=w(e,l))){I4(f,w,n,c);break e}S&&S(e,d,l),e==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&bw(d,"number",d.value)}switch(S=l?yc(l):window,e){case"focusin":(wF(S)||S.contentEditable==="true")&&(gc=S,Nw=l,$h=null);break;case"focusout":$h=Nw=gc=null;break;case"mousedown":Ow=!0;break;case"contextmenu":case"mouseup":case"dragend":Ow=!1,$F(f,n,c);break;case"selectionchange":if(DG)break;case"keydown":case"keyup":$F(f,n,c)}var E;if(H_)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else pc?L4(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(P4&&n.locale!=="ko"&&(pc||_!=="onCompositionStart"?_==="onCompositionEnd"&&pc&&(E=D4()):(ea=c,U_="value"in ea?ea.value:ea.textContent,pc=!0)),S=L0(l,_),0<S.length&&(_=new yF(_,e,null,n,c),f.push({event:_,listeners:S}),E?_.data=E:(E=z4(n),E!==null&&(_.data=E)))),(E=SG?_G(e,n):kG(e,n))&&(l=L0(l,"onBeforeInput"),0<l.length&&(c=new yF("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:l}),c.data=E))}Q4(f,t)})}function tp(e,t,n){return{instance:e,listener:t,currentTarget:n}}function L0(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Yh(e,n),o!=null&&r.unshift(tp(e,o,i)),o=Yh(e,t),o!=null&&r.push(tp(e,o,i))),e=e.return}return r}function Xl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function TF(e,t,n,r,i){for(var o=t._reactName,s=[];n!==null&&n!==r;){var a=n,u=a.alternate,l=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&l!==null&&(a=l,i?(u=Yh(n,o),u!=null&&s.unshift(tp(n,u,a))):i||(u=Yh(n,o),u!=null&&s.push(tp(n,u,a)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var IG=/\r\n?/g,BG=/\u0000|\uFFFD/g;function FF(e){return(typeof e=="string"?e:""+e).replace(IG,`
`).replace(BG,"")}function em(e,t,n){if(t=FF(t),FF(e)!==t&&n)throw Error(H(425))}function z0(){}var Rw=null,Dw=null;function Pw(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Lw=typeof setTimeout=="function"?setTimeout:void 0,jG=typeof clearTimeout=="function"?clearTimeout:void 0,MF=typeof Promise=="function"?Promise:void 0,UG=typeof queueMicrotask=="function"?queueMicrotask:typeof MF<"u"?function(e){return MF.resolve(null).then(e).catch(WG)}:Lw;function WG(e){setTimeout(function(){throw e})}function C2(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Kh(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Kh(t)}function ga(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function NF(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Bf=Math.random().toString(36).slice(2),uo="__reactFiber$"+Bf,np="__reactProps$"+Bf,xs="__reactContainer$"+Bf,zw="__reactEvents$"+Bf,qG="__reactListeners$"+Bf,HG="__reactHandles$"+Bf;function Du(e){var t=e[uo];if(t)return t;for(var n=e.parentNode;n;){if(t=n[xs]||n[uo]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=NF(e);e!==null;){if(n=e[uo])return n;e=NF(e)}return t}e=n,n=e.parentNode}return null}function Jp(e){return e=e[uo]||e[xs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function yc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(H(33))}function Hy(e){return e[np]||null}var Iw=[],vc=-1;function Ya(e){return{current:e}}function Ze(e){0>vc||(e.current=Iw[vc],Iw[vc]=null,vc--)}function Ve(e,t){vc++,Iw[vc]=e.current,e.current=t}var Ca={},Sn=Ya(Ca),ir=Ya(!1),tl=Ca;function Qc(e,t){var n=e.type.contextTypes;if(!n)return Ca;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function or(e){return e=e.childContextTypes,e!=null}function I0(){Ze(ir),Ze(Sn)}function OF(e,t,n){if(Sn.current!==Ca)throw Error(H(168));Ve(Sn,t),Ve(ir,n)}function J4(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(H(108,TH(e)||"Unknown",i));return ut({},n,r)}function B0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ca,tl=Sn.current,Ve(Sn,e),Ve(ir,ir.current),!0}function RF(e,t,n){var r=e.stateNode;if(!r)throw Error(H(169));n?(e=J4(e,t,tl),r.__reactInternalMemoizedMergedChildContext=e,Ze(ir),Ze(Sn),Ve(Sn,e)):Ze(ir),Ve(ir,n)}var Qo=null,Gy=!1,A2=!1;function Z4(e){Qo===null?Qo=[e]:Qo.push(e)}function GG(e){Gy=!0,Z4(e)}function Xa(){if(!A2&&Qo!==null){A2=!0;var e=0,t=Be;try{var n=Qo;for(Be=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Qo=null,Gy=!1}catch(i){throw Qo!==null&&(Qo=Qo.slice(e+1)),_4(z_,Xa),i}finally{Be=t,A2=!1}}return null}var xc=[],bc=0,j0=null,U0=0,Wr=[],qr=0,nl=null,ns=1,rs="";function _u(e,t){xc[bc++]=U0,xc[bc++]=j0,j0=e,U0=t}function eP(e,t,n){Wr[qr++]=ns,Wr[qr++]=rs,Wr[qr++]=nl,nl=e;var r=ns;e=rs;var i=32-Di(r)-1;r&=~(1<<i),n+=1;var o=32-Di(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,ns=1<<32-Di(t)+i|n<<i|r,rs=o+e}else ns=1<<o|n<<i|r,rs=e}function V_(e){e.return!==null&&(_u(e,1),eP(e,1,0))}function Y_(e){for(;e===j0;)j0=xc[--bc],xc[bc]=null,U0=xc[--bc],xc[bc]=null;for(;e===nl;)nl=Wr[--qr],Wr[qr]=null,rs=Wr[--qr],Wr[qr]=null,ns=Wr[--qr],Wr[qr]=null}var Cr=null,Sr=null,tt=!1,ki=null;function tP(e,t){var n=Vr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function DF(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Cr=e,Sr=ga(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Cr=e,Sr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=nl!==null?{id:ns,overflow:rs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Vr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Cr=e,Sr=null,!0):!1;default:return!1}}function Bw(e){return(e.mode&1)!==0&&(e.flags&128)===0}function jw(e){if(tt){var t=Sr;if(t){var n=t;if(!DF(e,t)){if(Bw(e))throw Error(H(418));t=ga(n.nextSibling);var r=Cr;t&&DF(e,t)?tP(r,n):(e.flags=e.flags&-4097|2,tt=!1,Cr=e)}}else{if(Bw(e))throw Error(H(418));e.flags=e.flags&-4097|2,tt=!1,Cr=e}}}function PF(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Cr=e}function tm(e){if(e!==Cr)return!1;if(!tt)return PF(e),tt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Pw(e.type,e.memoizedProps)),t&&(t=Sr)){if(Bw(e))throw nP(),Error(H(418));for(;t;)tP(e,t),t=ga(t.nextSibling)}if(PF(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(H(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Sr=ga(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Sr=null}}else Sr=Cr?ga(e.stateNode.nextSibling):null;return!0}function nP(){for(var e=Sr;e;)e=ga(e.nextSibling)}function Kc(){Sr=Cr=null,tt=!1}function X_(e){ki===null?ki=[e]:ki.push(e)}var VG=Cs.ReactCurrentBatchConfig;function bi(e,t){if(e&&e.defaultProps){t=ut({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}var W0=Ya(null),q0=null,wc=null,Q_=null;function K_(){Q_=wc=q0=null}function J_(e){var t=W0.current;Ze(W0),e._currentValue=t}function Uw(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Dc(e,t){q0=e,Q_=wc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(nr=!0),e.firstContext=null)}function ti(e){var t=e._currentValue;if(Q_!==e)if(e={context:e,memoizedValue:t,next:null},wc===null){if(q0===null)throw Error(H(308));wc=e,q0.dependencies={lanes:0,firstContext:e}}else wc=wc.next=e;return t}var Pu=null;function Z_(e){Pu===null?Pu=[e]:Pu.push(e)}function rP(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Z_(t)):(n.next=i.next,i.next=n),t.interleaved=n,bs(e,r)}function bs(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ws=!1;function ek(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function iP(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ma(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ae&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,bs(e,n)}return i=r.interleaved,i===null?(t.next=t,Z_(r)):(t.next=i.next,i.next=t),r.interleaved=t,bs(e,n)}function Jm(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,I_(e,n)}}function LF(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=t:o=o.next=t}else i=o=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function H0(e,t,n,r){var i=e.updateQueue;Ws=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var u=a,l=u.next;u.next=null,s===null?o=l:s.next=l,s=u;var c=e.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==s&&(a===null?c.firstBaseUpdate=l:a.next=l,c.lastBaseUpdate=u))}if(o!==null){var f=i.baseState;s=0,c=l=u=null,a=o;do{var d=a.lane,h=a.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(d=t,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){f=p.call(h,f,d);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(h,f,d):p,d==null)break e;f=ut({},f,d);break e;case 2:Ws=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else h={eventTime:h,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(l=c=h,u=f):c=c.next=h,s|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(u=f),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);il|=s,e.lanes=s,e.memoizedState=f}}function zF(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(H(191,i));i.call(r)}}}var oP=new r4.Component().refs;function Ww(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ut({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Vy={isMounted:function(e){return(e=e._reactInternals)?Ml(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=zn(),i=va(e),o=cs(r,i);o.payload=t,n!=null&&(o.callback=n),t=ma(e,o,i),t!==null&&(Pi(t,e,i,r),Jm(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=zn(),i=va(e),o=cs(r,i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=ma(e,o,i),t!==null&&(Pi(t,e,i,r),Jm(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=zn(),r=va(e),i=cs(n,r);i.tag=2,t!=null&&(i.callback=t),t=ma(e,i,r),t!==null&&(Pi(t,e,r,n),Jm(t,e,r))}};function IF(e,t,n,r,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,s):t.prototype&&t.prototype.isPureReactComponent?!Zh(n,r)||!Zh(i,o):!0}function sP(e,t,n){var r=!1,i=Ca,o=t.contextType;return typeof o=="object"&&o!==null?o=ti(o):(i=or(t)?tl:Sn.current,r=t.contextTypes,o=(r=r!=null)?Qc(e,i):Ca),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Vy,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function BF(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Vy.enqueueReplaceState(t,t.state,null)}function qw(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=oP,ek(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=ti(o):(o=or(t)?tl:Sn.current,i.context=Qc(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Ww(e,t,o,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Vy.enqueueReplaceState(i,i.state,null),H0(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function yd(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,e));var i=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;a===oP&&(a=i.refs={}),s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,e))}return e}function nm(e,t){throw e=Object.prototype.toString.call(t),Error(H(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function jF(e){var t=e._init;return t(e._payload)}function aP(e){function t(y,v){if(e){var x=y.deletions;x===null?(y.deletions=[v],y.flags|=16):x.push(v)}}function n(y,v){if(!e)return null;for(;v!==null;)t(y,v),v=v.sibling;return null}function r(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function i(y,v){return y=xa(y,v),y.index=0,y.sibling=null,y}function o(y,v,x){return y.index=x,e?(x=y.alternate,x!==null?(x=x.index,x<v?(y.flags|=2,v):x):(y.flags|=2,v)):(y.flags|=1048576,v)}function s(y){return e&&y.alternate===null&&(y.flags|=2),y}function a(y,v,x,b){return v===null||v.tag!==6?(v=D2(x,y.mode,b),v.return=y,v):(v=i(v,x),v.return=y,v)}function u(y,v,x,b){var w=x.type;return w===hc?c(y,v,x.props.children,b,x.key):v!==null&&(v.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Us&&jF(w)===v.type)?(b=i(v,x.props),b.ref=yd(y,v,x),b.return=y,b):(b=i0(x.type,x.key,x.props,null,y.mode,b),b.ref=yd(y,v,x),b.return=y,b)}function l(y,v,x,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==x.containerInfo||v.stateNode.implementation!==x.implementation?(v=P2(x,y.mode,b),v.return=y,v):(v=i(v,x.children||[]),v.return=y,v)}function c(y,v,x,b,w){return v===null||v.tag!==7?(v=qu(x,y.mode,b,w),v.return=y,v):(v=i(v,x),v.return=y,v)}function f(y,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return v=D2(""+v,y.mode,x),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Hg:return x=i0(v.type,v.key,v.props,null,y.mode,x),x.ref=yd(y,null,v),x.return=y,x;case dc:return v=P2(v,y.mode,x),v.return=y,v;case Us:var b=v._init;return f(y,b(v._payload),x)}if(Vd(v)||dd(v))return v=qu(v,y.mode,x,null),v.return=y,v;nm(y,v)}return null}function d(y,v,x,b){var w=v!==null?v.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return w!==null?null:a(y,v,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Hg:return x.key===w?u(y,v,x,b):null;case dc:return x.key===w?l(y,v,x,b):null;case Us:return w=x._init,d(y,v,w(x._payload),b)}if(Vd(x)||dd(x))return w!==null?null:c(y,v,x,b,null);nm(y,x)}return null}function h(y,v,x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return y=y.get(x)||null,a(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Hg:return y=y.get(b.key===null?x:b.key)||null,u(v,y,b,w);case dc:return y=y.get(b.key===null?x:b.key)||null,l(v,y,b,w);case Us:var S=b._init;return h(y,v,x,S(b._payload),w)}if(Vd(b)||dd(b))return y=y.get(x)||null,c(v,y,b,w,null);nm(v,b)}return null}function p(y,v,x,b){for(var w=null,S=null,E=v,_=v=0,k=null;E!==null&&_<x.length;_++){E.index>_?(k=E,E=null):k=E.sibling;var $=d(y,E,x[_],b);if($===null){E===null&&(E=k);break}e&&E&&$.alternate===null&&t(y,E),v=o($,v,_),S===null?w=$:S.sibling=$,S=$,E=k}if(_===x.length)return n(y,E),tt&&_u(y,_),w;if(E===null){for(;_<x.length;_++)E=f(y,x[_],b),E!==null&&(v=o(E,v,_),S===null?w=E:S.sibling=E,S=E);return tt&&_u(y,_),w}for(E=r(y,E);_<x.length;_++)k=h(E,y,_,x[_],b),k!==null&&(e&&k.alternate!==null&&E.delete(k.key===null?_:k.key),v=o(k,v,_),S===null?w=k:S.sibling=k,S=k);return e&&E.forEach(function(C){return t(y,C)}),tt&&_u(y,_),w}function g(y,v,x,b){var w=dd(x);if(typeof w!="function")throw Error(H(150));if(x=w.call(x),x==null)throw Error(H(151));for(var S=w=null,E=v,_=v=0,k=null,$=x.next();E!==null&&!$.done;_++,$=x.next()){E.index>_?(k=E,E=null):k=E.sibling;var C=d(y,E,$.value,b);if(C===null){E===null&&(E=k);break}e&&E&&C.alternate===null&&t(y,E),v=o(C,v,_),S===null?w=C:S.sibling=C,S=C,E=k}if($.done)return n(y,E),tt&&_u(y,_),w;if(E===null){for(;!$.done;_++,$=x.next())$=f(y,$.value,b),$!==null&&(v=o($,v,_),S===null?w=$:S.sibling=$,S=$);return tt&&_u(y,_),w}for(E=r(y,E);!$.done;_++,$=x.next())$=h(E,y,_,$.value,b),$!==null&&(e&&$.alternate!==null&&E.delete($.key===null?_:$.key),v=o($,v,_),S===null?w=$:S.sibling=$,S=$);return e&&E.forEach(function(R){return t(y,R)}),tt&&_u(y,_),w}function m(y,v,x,b){if(typeof x=="object"&&x!==null&&x.type===hc&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Hg:e:{for(var w=x.key,S=v;S!==null;){if(S.key===w){if(w=x.type,w===hc){if(S.tag===7){n(y,S.sibling),v=i(S,x.props.children),v.return=y,y=v;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Us&&jF(w)===S.type){n(y,S.sibling),v=i(S,x.props),v.ref=yd(y,S,x),v.return=y,y=v;break e}n(y,S);break}else t(y,S);S=S.sibling}x.type===hc?(v=qu(x.props.children,y.mode,b,x.key),v.return=y,y=v):(b=i0(x.type,x.key,x.props,null,y.mode,b),b.ref=yd(y,v,x),b.return=y,y=b)}return s(y);case dc:e:{for(S=x.key;v!==null;){if(v.key===S)if(v.tag===4&&v.stateNode.containerInfo===x.containerInfo&&v.stateNode.implementation===x.implementation){n(y,v.sibling),v=i(v,x.children||[]),v.return=y,y=v;break e}else{n(y,v);break}else t(y,v);v=v.sibling}v=P2(x,y.mode,b),v.return=y,y=v}return s(y);case Us:return S=x._init,m(y,v,S(x._payload),b)}if(Vd(x))return p(y,v,x,b);if(dd(x))return g(y,v,x,b);nm(y,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,v!==null&&v.tag===6?(n(y,v.sibling),v=i(v,x),v.return=y,y=v):(n(y,v),v=D2(x,y.mode,b),v.return=y,y=v),s(y)):n(y,v)}return m}var Jc=aP(!0),uP=aP(!1),Zp={},go=Ya(Zp),rp=Ya(Zp),ip=Ya(Zp);function Lu(e){if(e===Zp)throw Error(H(174));return e}function tk(e,t){switch(Ve(ip,t),Ve(rp,e),Ve(go,Zp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ew(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ew(t,e)}Ze(go),Ve(go,t)}function Zc(){Ze(go),Ze(rp),Ze(ip)}function lP(e){Lu(ip.current);var t=Lu(go.current),n=Ew(t,e.type);t!==n&&(Ve(rp,e),Ve(go,n))}function nk(e){rp.current===e&&(Ze(go),Ze(rp))}var st=Ya(0);function G0(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var T2=[];function rk(){for(var e=0;e<T2.length;e++)T2[e]._workInProgressVersionPrimary=null;T2.length=0}var Zm=Cs.ReactCurrentDispatcher,F2=Cs.ReactCurrentBatchConfig,rl=0,at=null,St=null,Ot=null,V0=!1,Ch=!1,op=0,YG=0;function an(){throw Error(H(321))}function ik(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ii(e[n],t[n]))return!1;return!0}function ok(e,t,n,r,i,o){if(rl=o,at=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Zm.current=e===null||e.memoizedState===null?JG:ZG,e=n(r,i),Ch){o=0;do{if(Ch=!1,op=0,25<=o)throw Error(H(301));o+=1,Ot=St=null,t.updateQueue=null,Zm.current=eV,e=n(r,i)}while(Ch)}if(Zm.current=Y0,t=St!==null&&St.next!==null,rl=0,Ot=St=at=null,V0=!1,t)throw Error(H(300));return e}function sk(){var e=op!==0;return op=0,e}function io(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?at.memoizedState=Ot=e:Ot=Ot.next=e,Ot}function ni(){if(St===null){var e=at.alternate;e=e!==null?e.memoizedState:null}else e=St.next;var t=Ot===null?at.memoizedState:Ot.next;if(t!==null)Ot=t,St=e;else{if(e===null)throw Error(H(310));St=e,e={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},Ot===null?at.memoizedState=Ot=e:Ot=Ot.next=e}return Ot}function sp(e,t){return typeof t=="function"?t(e):t}function M2(e){var t=ni(),n=t.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=e;var r=St,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,u=null,l=o;do{var c=l.lane;if((rl&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var f={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(a=u=f,s=r):u=u.next=f,at.lanes|=c,il|=c}l=l.next}while(l!==null&&l!==o);u===null?s=r:u.next=a,Ii(r,t.memoizedState)||(nr=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do o=i.lane,at.lanes|=o,il|=o,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function N2(e){var t=ni(),n=t.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);Ii(o,t.memoizedState)||(nr=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function cP(){}function fP(e,t){var n=at,r=ni(),i=t(),o=!Ii(r.memoizedState,i);if(o&&(r.memoizedState=i,nr=!0),r=r.queue,ak(pP.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||Ot!==null&&Ot.memoizedState.tag&1){if(n.flags|=2048,ap(9,hP.bind(null,n,r,i,t),void 0,null),jt===null)throw Error(H(349));rl&30||dP(n,t,i)}return i}function dP(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=at.updateQueue,t===null?(t={lastEffect:null,stores:null},at.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function hP(e,t,n,r){t.value=n,t.getSnapshot=r,gP(t)&&mP(e)}function pP(e,t,n){return n(function(){gP(t)&&mP(e)})}function gP(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ii(e,n)}catch{return!0}}function mP(e){var t=bs(e,1);t!==null&&Pi(t,e,1,-1)}function UF(e){var t=io();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sp,lastRenderedState:e},t.queue=e,e=e.dispatch=KG.bind(null,at,e),[t.memoizedState,e]}function ap(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=at.updateQueue,t===null?(t={lastEffect:null,stores:null},at.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function yP(){return ni().memoizedState}function e0(e,t,n,r){var i=io();at.flags|=e,i.memoizedState=ap(1|t,n,void 0,r===void 0?null:r)}function Yy(e,t,n,r){var i=ni();r=r===void 0?null:r;var o=void 0;if(St!==null){var s=St.memoizedState;if(o=s.destroy,r!==null&&ik(r,s.deps)){i.memoizedState=ap(t,n,o,r);return}}at.flags|=e,i.memoizedState=ap(1|t,n,o,r)}function WF(e,t){return e0(8390656,8,e,t)}function ak(e,t){return Yy(2048,8,e,t)}function vP(e,t){return Yy(4,2,e,t)}function xP(e,t){return Yy(4,4,e,t)}function bP(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function wP(e,t,n){return n=n!=null?n.concat([e]):null,Yy(4,4,bP.bind(null,t,e),n)}function uk(){}function EP(e,t){var n=ni();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&ik(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function SP(e,t){var n=ni();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&ik(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function _P(e,t,n){return rl&21?(Ii(n,t)||(n=C4(),at.lanes|=n,il|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,nr=!0),e.memoizedState=n)}function XG(e,t){var n=Be;Be=n!==0&&4>n?n:4,e(!0);var r=F2.transition;F2.transition={};try{e(!1),t()}finally{Be=n,F2.transition=r}}function kP(){return ni().memoizedState}function QG(e,t,n){var r=va(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$P(e))CP(t,n);else if(n=rP(e,t,n,r),n!==null){var i=zn();Pi(n,e,r,i),AP(n,t,r)}}function KG(e,t,n){var r=va(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($P(e))CP(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Ii(a,s)){var u=t.interleaved;u===null?(i.next=i,Z_(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}n=rP(e,t,i,r),n!==null&&(i=zn(),Pi(n,e,r,i),AP(n,t,r))}}function $P(e){var t=e.alternate;return e===at||t!==null&&t===at}function CP(e,t){Ch=V0=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function AP(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,I_(e,n)}}var Y0={readContext:ti,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useInsertionEffect:an,useLayoutEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useMutableSource:an,useSyncExternalStore:an,useId:an,unstable_isNewReconciler:!1},JG={readContext:ti,useCallback:function(e,t){return io().memoizedState=[e,t===void 0?null:t],e},useContext:ti,useEffect:WF,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,e0(4194308,4,bP.bind(null,t,e),n)},useLayoutEffect:function(e,t){return e0(4194308,4,e,t)},useInsertionEffect:function(e,t){return e0(4,2,e,t)},useMemo:function(e,t){var n=io();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=io();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=QG.bind(null,at,e),[r.memoizedState,e]},useRef:function(e){var t=io();return e={current:e},t.memoizedState=e},useState:UF,useDebugValue:uk,useDeferredValue:function(e){return io().memoizedState=e},useTransition:function(){var e=UF(!1),t=e[0];return e=XG.bind(null,e[1]),io().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=at,i=io();if(tt){if(n===void 0)throw Error(H(407));n=n()}else{if(n=t(),jt===null)throw Error(H(349));rl&30||dP(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,WF(pP.bind(null,r,o,e),[e]),r.flags|=2048,ap(9,hP.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=io(),t=jt.identifierPrefix;if(tt){var n=rs,r=ns;n=(r&~(1<<32-Di(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=op++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=YG++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ZG={readContext:ti,useCallback:EP,useContext:ti,useEffect:ak,useImperativeHandle:wP,useInsertionEffect:vP,useLayoutEffect:xP,useMemo:SP,useReducer:M2,useRef:yP,useState:function(){return M2(sp)},useDebugValue:uk,useDeferredValue:function(e){var t=ni();return _P(t,St.memoizedState,e)},useTransition:function(){var e=M2(sp)[0],t=ni().memoizedState;return[e,t]},useMutableSource:cP,useSyncExternalStore:fP,useId:kP,unstable_isNewReconciler:!1},eV={readContext:ti,useCallback:EP,useContext:ti,useEffect:ak,useImperativeHandle:wP,useInsertionEffect:vP,useLayoutEffect:xP,useMemo:SP,useReducer:N2,useRef:yP,useState:function(){return N2(sp)},useDebugValue:uk,useDeferredValue:function(e){var t=ni();return St===null?t.memoizedState=e:_P(t,St.memoizedState,e)},useTransition:function(){var e=N2(sp)[0],t=ni().memoizedState;return[e,t]},useMutableSource:cP,useSyncExternalStore:fP,useId:kP,unstable_isNewReconciler:!1};function ef(e,t){try{var n="",r=t;do n+=AH(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function O2(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Hw(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var tV=typeof WeakMap=="function"?WeakMap:Map;function TP(e,t,n){n=cs(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Q0||(Q0=!0,tE=r),Hw(e,t)},n}function FP(e,t,n){n=cs(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Hw(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Hw(e,t),typeof r!="function"&&(ya===null?ya=new Set([this]):ya.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function qF(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new tV;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=gV.bind(null,e,t,n),t.then(e,e))}function HF(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function GF(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=cs(-1,1),t.tag=2,ma(n,t,1))),n.lanes|=1),e)}var nV=Cs.ReactCurrentOwner,nr=!1;function Mn(e,t,n,r){t.child=e===null?uP(t,null,n,r):Jc(t,e.child,n,r)}function VF(e,t,n,r,i){n=n.render;var o=t.ref;return Dc(t,i),r=ok(e,t,n,r,o,i),n=sk(),e!==null&&!nr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ws(e,t,i)):(tt&&n&&V_(t),t.flags|=1,Mn(e,t,r,i),t.child)}function YF(e,t,n,r,i){if(e===null){var o=n.type;return typeof o=="function"&&!mk(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,MP(e,t,o,r,i)):(e=i0(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Zh,n(s,r)&&e.ref===t.ref)return ws(e,t,i)}return t.flags|=1,e=xa(o,r),e.ref=t.ref,e.return=t,t.child=e}function MP(e,t,n,r,i){if(e!==null){var o=e.memoizedProps;if(Zh(o,r)&&e.ref===t.ref)if(nr=!1,t.pendingProps=r=o,(e.lanes&i)!==0)e.flags&131072&&(nr=!0);else return t.lanes=e.lanes,ws(e,t,i)}return Gw(e,t,n,r,i)}function NP(e,t,n){var r=t.pendingProps,i=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(Sc,xr),xr|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ve(Sc,xr),xr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Ve(Sc,xr),xr|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ve(Sc,xr),xr|=r;return Mn(e,t,i,n),t.child}function OP(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Gw(e,t,n,r,i){var o=or(n)?tl:Sn.current;return o=Qc(t,o),Dc(t,i),n=ok(e,t,n,r,o,i),r=sk(),e!==null&&!nr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ws(e,t,i)):(tt&&r&&V_(t),t.flags|=1,Mn(e,t,n,i),t.child)}function XF(e,t,n,r,i){if(or(n)){var o=!0;B0(t)}else o=!1;if(Dc(t,i),t.stateNode===null)t0(e,t),sP(t,n,r),qw(t,n,r,i),r=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var u=s.context,l=n.contextType;typeof l=="object"&&l!==null?l=ti(l):(l=or(n)?tl:Sn.current,l=Qc(t,l));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||u!==l)&&BF(t,s,r,l),Ws=!1;var d=t.memoizedState;s.state=d,H0(t,r,s,i),u=t.memoizedState,a!==r||d!==u||ir.current||Ws?(typeof c=="function"&&(Ww(t,n,c,r),u=t.memoizedState),(a=Ws||IF(t,n,a,r,d,u,l))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),s.props=r,s.state=u,s.context=l,r=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,iP(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:bi(t.type,a),s.props=l,f=t.pendingProps,d=s.context,u=n.contextType,typeof u=="object"&&u!==null?u=ti(u):(u=or(n)?tl:Sn.current,u=Qc(t,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==f||d!==u)&&BF(t,s,r,u),Ws=!1,d=t.memoizedState,s.state=d,H0(t,r,s,i);var p=t.memoizedState;a!==f||d!==p||ir.current||Ws?(typeof h=="function"&&(Ww(t,n,h,r),p=t.memoizedState),(l=Ws||IF(t,n,l,r,d,p,u)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,u)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=u,r=l):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Vw(e,t,n,r,o,i)}function Vw(e,t,n,r,i,o){OP(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return i&&RF(t,n,!1),ws(e,t,o);r=t.stateNode,nV.current=t;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=Jc(t,e.child,null,o),t.child=Jc(t,null,a,o)):Mn(e,t,a,o),t.memoizedState=r.state,i&&RF(t,n,!0),t.child}function RP(e){var t=e.stateNode;t.pendingContext?OF(e,t.pendingContext,t.pendingContext!==t.context):t.context&&OF(e,t.context,!1),tk(e,t.containerInfo)}function QF(e,t,n,r,i){return Kc(),X_(i),t.flags|=256,Mn(e,t,n,r),t.child}var Yw={dehydrated:null,treeContext:null,retryLane:0};function Xw(e){return{baseLanes:e,cachePool:null,transitions:null}}function DP(e,t,n){var r=t.pendingProps,i=st.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Ve(st,i&1),e===null)return jw(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=r.children,e=r.fallback,o?(r=t.mode,o=t.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Ky(s,r,0,null),e=qu(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Xw(n),t.memoizedState=Yw,e):lk(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return rV(e,t,s,r,a,i,n);if(o){o=r.fallback,s=t.mode,i=e.child,a=i.sibling;var u={mode:"hidden",children:r.children};return!(s&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=xa(i,u),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=xa(a,o):(o=qu(o,s,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,s=e.child.memoizedState,s=s===null?Xw(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~n,t.memoizedState=Yw,r}return o=e.child,e=o.sibling,r=xa(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function lk(e,t){return t=Ky({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function rm(e,t,n,r){return r!==null&&X_(r),Jc(t,e.child,null,n),e=lk(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function rV(e,t,n,r,i,o,s){if(n)return t.flags&256?(t.flags&=-257,r=O2(Error(H(422))),rm(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Ky({mode:"visible",children:r.children},i,0,null),o=qu(o,i,s,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Jc(t,e.child,null,s),t.child.memoizedState=Xw(s),t.memoizedState=Yw,o);if(!(t.mode&1))return rm(e,t,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(H(419)),r=O2(o,r,void 0),rm(e,t,s,r)}if(a=(s&e.childLanes)!==0,nr||a){if(r=jt,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,bs(e,i),Pi(r,e,i,-1))}return gk(),r=O2(Error(H(421))),rm(e,t,s,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=mV.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,Sr=ga(i.nextSibling),Cr=t,tt=!0,ki=null,e!==null&&(Wr[qr++]=ns,Wr[qr++]=rs,Wr[qr++]=nl,ns=e.id,rs=e.overflow,nl=t),t=lk(t,r.children),t.flags|=4096,t)}function KF(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Uw(e.return,t,n)}function R2(e,t,n,r,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function PP(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Mn(e,t,r.children,n),r=st.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&KF(e,n,t);else if(e.tag===19)KF(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ve(st,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&G0(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),R2(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&G0(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}R2(t,!0,n,null,o);break;case"together":R2(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function t0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ws(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),il|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(H(153));if(t.child!==null){for(e=t.child,n=xa(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=xa(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function iV(e,t,n){switch(t.tag){case 3:RP(t),Kc();break;case 5:lP(t);break;case 1:or(t.type)&&B0(t);break;case 4:tk(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ve(W0,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ve(st,st.current&1),t.flags|=128,null):n&t.child.childLanes?DP(e,t,n):(Ve(st,st.current&1),e=ws(e,t,n),e!==null?e.sibling:null);Ve(st,st.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return PP(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ve(st,st.current),r)break;return null;case 22:case 23:return t.lanes=0,NP(e,t,n)}return ws(e,t,n)}var LP,Qw,zP,IP;LP=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Qw=function(){};zP=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Lu(go.current);var o=null;switch(n){case"input":i=vw(e,i),r=vw(e,r),o=[];break;case"select":i=ut({},i,{value:void 0}),r=ut({},r,{value:void 0}),o=[];break;case"textarea":i=ww(e,i),r=ww(e,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=z0)}Sw(n,r);var s;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Gh.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var u=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&u!==a&&(u!=null||a!=null))if(l==="style")if(a){for(s in a)!a.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&a[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(o||(o=[]),o.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(o=o||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Gh.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&Xe("scroll",e),o||a===u||(o=[])):(o=o||[]).push(l,u))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}};IP=function(e,t,n,r){n!==r&&(t.flags|=4)};function vd(e,t){if(!tt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function un(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function oV(e,t,n){var r=t.pendingProps;switch(Y_(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return un(t),null;case 1:return or(t.type)&&I0(),un(t),null;case 3:return r=t.stateNode,Zc(),Ze(ir),Ze(Sn),rk(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(tm(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ki!==null&&(iE(ki),ki=null))),Qw(e,t),un(t),null;case 5:nk(t);var i=Lu(ip.current);if(n=t.type,e!==null&&t.stateNode!=null)zP(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(H(166));return un(t),null}if(e=Lu(go.current),tm(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[uo]=t,r[np]=o,e=(t.mode&1)!==0,n){case"dialog":Xe("cancel",r),Xe("close",r);break;case"iframe":case"object":case"embed":Xe("load",r);break;case"video":case"audio":for(i=0;i<Xd.length;i++)Xe(Xd[i],r);break;case"source":Xe("error",r);break;case"img":case"image":case"link":Xe("error",r),Xe("load",r);break;case"details":Xe("toggle",r);break;case"input":sF(r,o),Xe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Xe("invalid",r);break;case"textarea":uF(r,o),Xe("invalid",r)}Sw(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&em(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&em(r.textContent,a,e),i=["children",""+a]):Gh.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Xe("scroll",r)}switch(n){case"input":Gg(r),aF(r,o,!0);break;case"textarea":Gg(r),lF(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=z0)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=d4(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[uo]=t,e[np]=r,LP(e,t,!1,!1),t.stateNode=e;e:{switch(s=_w(n,r),n){case"dialog":Xe("cancel",e),Xe("close",e),i=r;break;case"iframe":case"object":case"embed":Xe("load",e),i=r;break;case"video":case"audio":for(i=0;i<Xd.length;i++)Xe(Xd[i],e);i=r;break;case"source":Xe("error",e),i=r;break;case"img":case"image":case"link":Xe("error",e),Xe("load",e),i=r;break;case"details":Xe("toggle",e),i=r;break;case"input":sF(e,r),i=vw(e,r),Xe("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=ut({},r,{value:void 0}),Xe("invalid",e);break;case"textarea":uF(e,r),i=ww(e,r),Xe("invalid",e);break;default:i=r}Sw(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var u=a[o];o==="style"?g4(e,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&h4(e,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Vh(e,u):typeof u=="number"&&Vh(e,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Gh.hasOwnProperty(o)?u!=null&&o==="onScroll"&&Xe("scroll",e):u!=null&&O_(e,o,u,s))}switch(n){case"input":Gg(e),aF(e,r,!1);break;case"textarea":Gg(e),lF(e);break;case"option":r.value!=null&&e.setAttribute("value",""+$a(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Mc(e,!!r.multiple,o,!1):r.defaultValue!=null&&Mc(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=z0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return un(t),null;case 6:if(e&&t.stateNode!=null)IP(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(H(166));if(n=Lu(ip.current),Lu(go.current),tm(t)){if(r=t.stateNode,n=t.memoizedProps,r[uo]=t,(o=r.nodeValue!==n)&&(e=Cr,e!==null))switch(e.tag){case 3:em(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&em(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[uo]=t,t.stateNode=r}return un(t),null;case 13:if(Ze(st),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(tt&&Sr!==null&&t.mode&1&&!(t.flags&128))nP(),Kc(),t.flags|=98560,o=!1;else if(o=tm(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(H(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(H(317));o[uo]=t}else Kc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;un(t),o=!1}else ki!==null&&(iE(ki),ki=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||st.current&1?$t===0&&($t=3):gk())),t.updateQueue!==null&&(t.flags|=4),un(t),null);case 4:return Zc(),Qw(e,t),e===null&&ep(t.stateNode.containerInfo),un(t),null;case 10:return J_(t.type._context),un(t),null;case 17:return or(t.type)&&I0(),un(t),null;case 19:if(Ze(st),o=t.memoizedState,o===null)return un(t),null;if(r=(t.flags&128)!==0,s=o.rendering,s===null)if(r)vd(o,!1);else{if($t!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=G0(e),s!==null){for(t.flags|=128,vd(o,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ve(st,st.current&1|2),t.child}e=e.sibling}o.tail!==null&&yt()>tf&&(t.flags|=128,r=!0,vd(o,!1),t.lanes=4194304)}else{if(!r)if(e=G0(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),vd(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!tt)return un(t),null}else 2*yt()-o.renderingStartTime>tf&&n!==1073741824&&(t.flags|=128,r=!0,vd(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(n=o.last,n!==null?n.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=yt(),t.sibling=null,n=st.current,Ve(st,r?n&1|2:n&1),t):(un(t),null);case 22:case 23:return pk(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?xr&1073741824&&(un(t),t.subtreeFlags&6&&(t.flags|=8192)):un(t),null;case 24:return null;case 25:return null}throw Error(H(156,t.tag))}function sV(e,t){switch(Y_(t),t.tag){case 1:return or(t.type)&&I0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Zc(),Ze(ir),Ze(Sn),rk(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return nk(t),null;case 13:if(Ze(st),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(H(340));Kc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ze(st),null;case 4:return Zc(),null;case 10:return J_(t.type._context),null;case 22:case 23:return pk(),null;case 24:return null;default:return null}}var im=!1,pn=!1,aV=typeof WeakSet=="function"?WeakSet:Set,ee=null;function Ec(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){dt(e,t,r)}else n.current=null}function Kw(e,t,n){try{n()}catch(r){dt(e,t,r)}}var JF=!1;function uV(e,t){if(Rw=D0,e=W4(),G_(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,u=-1,l=0,c=0,f=e,d=null;t:for(;;){for(var h;f!==n||i!==0&&f.nodeType!==3||(a=s+i),f!==o||r!==0&&f.nodeType!==3||(u=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===e)break t;if(d===n&&++l===i&&(a=s),d===o&&++c===r&&(u=s),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}n=a===-1||u===-1?null:{start:a,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Dw={focusedElem:e,selectionRange:n},D0=!1,ee=t;ee!==null;)if(t=ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ee=e;else for(;ee!==null;){t=ee;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,m=p.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:bi(t.type,g),m);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(b){dt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,ee=e;break}ee=t.return}return p=JF,JF=!1,p}function Ah(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&Kw(t,n,o)}i=i.next}while(i!==r)}}function Xy(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Jw(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function BP(e){var t=e.alternate;t!==null&&(e.alternate=null,BP(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[uo],delete t[np],delete t[zw],delete t[qG],delete t[HG])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function jP(e){return e.tag===5||e.tag===3||e.tag===4}function ZF(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||jP(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Zw(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=z0));else if(r!==4&&(e=e.child,e!==null))for(Zw(e,t,n),e=e.sibling;e!==null;)Zw(e,t,n),e=e.sibling}function eE(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(eE(e,t,n),e=e.sibling;e!==null;)eE(e,t,n),e=e.sibling}var Yt=null,Ei=!1;function Ls(e,t,n){for(n=n.child;n!==null;)UP(e,t,n),n=n.sibling}function UP(e,t,n){if(po&&typeof po.onCommitFiberUnmount=="function")try{po.onCommitFiberUnmount(jy,n)}catch{}switch(n.tag){case 5:pn||Ec(n,t);case 6:var r=Yt,i=Ei;Yt=null,Ls(e,t,n),Yt=r,Ei=i,Yt!==null&&(Ei?(e=Yt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Yt.removeChild(n.stateNode));break;case 18:Yt!==null&&(Ei?(e=Yt,n=n.stateNode,e.nodeType===8?C2(e.parentNode,n):e.nodeType===1&&C2(e,n),Kh(e)):C2(Yt,n.stateNode));break;case 4:r=Yt,i=Ei,Yt=n.stateNode.containerInfo,Ei=!0,Ls(e,t,n),Yt=r,Ei=i;break;case 0:case 11:case 14:case 15:if(!pn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Kw(n,t,s),i=i.next}while(i!==r)}Ls(e,t,n);break;case 1:if(!pn&&(Ec(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){dt(n,t,a)}Ls(e,t,n);break;case 21:Ls(e,t,n);break;case 22:n.mode&1?(pn=(r=pn)||n.memoizedState!==null,Ls(e,t,n),pn=r):Ls(e,t,n);break;default:Ls(e,t,n)}}function eM(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new aV),t.forEach(function(r){var i=yV.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function pi(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:Yt=a.stateNode,Ei=!1;break e;case 3:Yt=a.stateNode.containerInfo,Ei=!0;break e;case 4:Yt=a.stateNode.containerInfo,Ei=!0;break e}a=a.return}if(Yt===null)throw Error(H(160));UP(o,s,i),Yt=null,Ei=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(l){dt(i,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)WP(t,e),t=t.sibling}function WP(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pi(t,e),Zi(e),r&4){try{Ah(3,e,e.return),Xy(3,e)}catch(g){dt(e,e.return,g)}try{Ah(5,e,e.return)}catch(g){dt(e,e.return,g)}}break;case 1:pi(t,e),Zi(e),r&512&&n!==null&&Ec(n,n.return);break;case 5:if(pi(t,e),Zi(e),r&512&&n!==null&&Ec(n,n.return),e.flags&32){var i=e.stateNode;try{Vh(i,"")}catch(g){dt(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=n!==null?n.memoizedProps:o,a=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&c4(i,o),_w(a,s);var l=_w(a,o);for(s=0;s<u.length;s+=2){var c=u[s],f=u[s+1];c==="style"?g4(i,f):c==="dangerouslySetInnerHTML"?h4(i,f):c==="children"?Vh(i,f):O_(i,c,f,l)}switch(a){case"input":xw(i,o);break;case"textarea":f4(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?Mc(i,!!o.multiple,h,!1):d!==!!o.multiple&&(o.defaultValue!=null?Mc(i,!!o.multiple,o.defaultValue,!0):Mc(i,!!o.multiple,o.multiple?[]:"",!1))}i[np]=o}catch(g){dt(e,e.return,g)}}break;case 6:if(pi(t,e),Zi(e),r&4){if(e.stateNode===null)throw Error(H(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){dt(e,e.return,g)}}break;case 3:if(pi(t,e),Zi(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Kh(t.containerInfo)}catch(g){dt(e,e.return,g)}break;case 4:pi(t,e),Zi(e);break;case 13:pi(t,e),Zi(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(dk=yt())),r&4&&eM(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(pn=(l=pn)||c,pi(t,e),pn=l):pi(t,e),Zi(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!c&&e.mode&1)for(ee=e,c=e.child;c!==null;){for(f=ee=c;ee!==null;){switch(d=ee,h=d.child,d.tag){case 0:case 11:case 14:case 15:Ah(4,d,d.return);break;case 1:Ec(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,n=d.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){dt(r,n,g)}}break;case 5:Ec(d,d.return);break;case 22:if(d.memoizedState!==null){nM(f);continue}}h!==null?(h.return=d,ee=h):nM(f)}c=c.sibling}e:for(c=null,f=e;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,l?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=f.stateNode,u=f.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=p4("display",s))}catch(g){dt(e,e.return,g)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(g){dt(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:pi(t,e),Zi(e),r&4&&eM(e);break;case 21:break;default:pi(t,e),Zi(e)}}function Zi(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(jP(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Vh(i,""),r.flags&=-33);var o=ZF(e);eE(e,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=ZF(e);Zw(e,a,s);break;default:throw Error(H(161))}}catch(u){dt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function lV(e,t,n){ee=e,qP(e)}function qP(e,t,n){for(var r=(e.mode&1)!==0;ee!==null;){var i=ee,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||im;if(!s){var a=i.alternate,u=a!==null&&a.memoizedState!==null||pn;a=im;var l=pn;if(im=s,(pn=u)&&!l)for(ee=i;ee!==null;)s=ee,u=s.child,s.tag===22&&s.memoizedState!==null?rM(i):u!==null?(u.return=s,ee=u):rM(i);for(;o!==null;)ee=o,qP(o),o=o.sibling;ee=i,im=a,pn=l}tM(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,ee=o):tM(e)}}function tM(e){for(;ee!==null;){var t=ee;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:pn||Xy(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!pn)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:bi(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&zF(t,o,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}zF(t,s,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Kh(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}pn||t.flags&512&&Jw(t)}catch(d){dt(t,t.return,d)}}if(t===e){ee=null;break}if(n=t.sibling,n!==null){n.return=t.return,ee=n;break}ee=t.return}}function nM(e){for(;ee!==null;){var t=ee;if(t===e){ee=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ee=n;break}ee=t.return}}function rM(e){for(;ee!==null;){var t=ee;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Xy(4,t)}catch(u){dt(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(u){dt(t,i,u)}}var o=t.return;try{Jw(t)}catch(u){dt(t,o,u)}break;case 5:var s=t.return;try{Jw(t)}catch(u){dt(t,s,u)}}}catch(u){dt(t,t.return,u)}if(t===e){ee=null;break}var a=t.sibling;if(a!==null){a.return=t.return,ee=a;break}ee=t.return}}var cV=Math.ceil,X0=Cs.ReactCurrentDispatcher,ck=Cs.ReactCurrentOwner,Jr=Cs.ReactCurrentBatchConfig,Ae=0,jt=null,wt=null,Jt=0,xr=0,Sc=Ya(0),$t=0,up=null,il=0,Qy=0,fk=0,Th=null,Jn=null,dk=0,tf=1/0,Vo=null,Q0=!1,tE=null,ya=null,om=!1,ta=null,K0=0,Fh=0,nE=null,n0=-1,r0=0;function zn(){return Ae&6?yt():n0!==-1?n0:n0=yt()}function va(e){return e.mode&1?Ae&2&&Jt!==0?Jt&-Jt:VG.transition!==null?(r0===0&&(r0=C4()),r0):(e=Be,e!==0||(e=window.event,e=e===void 0?16:R4(e.type)),e):1}function Pi(e,t,n,r){if(50<Fh)throw Fh=0,nE=null,Error(H(185));Qp(e,n,r),(!(Ae&2)||e!==jt)&&(e===jt&&(!(Ae&2)&&(Qy|=n),$t===4&&Qs(e,Jt)),sr(e,r),n===1&&Ae===0&&!(t.mode&1)&&(tf=yt()+500,Gy&&Xa()))}function sr(e,t){var n=e.callbackNode;VH(e,t);var r=R0(e,e===jt?Jt:0);if(r===0)n!==null&&dF(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&dF(n),t===1)e.tag===0?GG(iM.bind(null,e)):Z4(iM.bind(null,e)),UG(function(){!(Ae&6)&&Xa()}),n=null;else{switch(A4(r)){case 1:n=z_;break;case 4:n=k4;break;case 16:n=O0;break;case 536870912:n=$4;break;default:n=O0}n=JP(n,HP.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function HP(e,t){if(n0=-1,r0=0,Ae&6)throw Error(H(327));var n=e.callbackNode;if(Pc()&&e.callbackNode!==n)return null;var r=R0(e,e===jt?Jt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=J0(e,r);else{t=r;var i=Ae;Ae|=2;var o=VP();(jt!==e||Jt!==t)&&(Vo=null,tf=yt()+500,Wu(e,t));do try{hV();break}catch(a){GP(e,a)}while(!0);K_(),X0.current=o,Ae=i,wt!==null?t=0:(jt=null,Jt=0,t=$t)}if(t!==0){if(t===2&&(i=Tw(e),i!==0&&(r=i,t=rE(e,i))),t===1)throw n=up,Wu(e,0),Qs(e,r),sr(e,yt()),n;if(t===6)Qs(e,r);else{if(i=e.current.alternate,!(r&30)&&!fV(i)&&(t=J0(e,r),t===2&&(o=Tw(e),o!==0&&(r=o,t=rE(e,o))),t===1))throw n=up,Wu(e,0),Qs(e,r),sr(e,yt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(H(345));case 2:ku(e,Jn,Vo);break;case 3:if(Qs(e,r),(r&130023424)===r&&(t=dk+500-yt(),10<t)){if(R0(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){zn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Lw(ku.bind(null,e,Jn,Vo),t);break}ku(e,Jn,Vo);break;case 4:if(Qs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-Di(r);o=1<<s,s=t[s],s>i&&(i=s),r&=~o}if(r=i,r=yt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*cV(r/1960))-r,10<r){e.timeoutHandle=Lw(ku.bind(null,e,Jn,Vo),r);break}ku(e,Jn,Vo);break;case 5:ku(e,Jn,Vo);break;default:throw Error(H(329))}}}return sr(e,yt()),e.callbackNode===n?HP.bind(null,e):null}function rE(e,t){var n=Th;return e.current.memoizedState.isDehydrated&&(Wu(e,t).flags|=256),e=J0(e,t),e!==2&&(t=Jn,Jn=n,t!==null&&iE(t)),e}function iE(e){Jn===null?Jn=e:Jn.push.apply(Jn,e)}function fV(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Ii(o(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qs(e,t){for(t&=~fk,t&=~Qy,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Di(t),r=1<<n;e[n]=-1,t&=~r}}function iM(e){if(Ae&6)throw Error(H(327));Pc();var t=R0(e,0);if(!(t&1))return sr(e,yt()),null;var n=J0(e,t);if(e.tag!==0&&n===2){var r=Tw(e);r!==0&&(t=r,n=rE(e,r))}if(n===1)throw n=up,Wu(e,0),Qs(e,t),sr(e,yt()),n;if(n===6)throw Error(H(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ku(e,Jn,Vo),sr(e,yt()),null}function hk(e,t){var n=Ae;Ae|=1;try{return e(t)}finally{Ae=n,Ae===0&&(tf=yt()+500,Gy&&Xa())}}function ol(e){ta!==null&&ta.tag===0&&!(Ae&6)&&Pc();var t=Ae;Ae|=1;var n=Jr.transition,r=Be;try{if(Jr.transition=null,Be=1,e)return e()}finally{Be=r,Jr.transition=n,Ae=t,!(Ae&6)&&Xa()}}function pk(){xr=Sc.current,Ze(Sc)}function Wu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,jG(n)),wt!==null)for(n=wt.return;n!==null;){var r=n;switch(Y_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&I0();break;case 3:Zc(),Ze(ir),Ze(Sn),rk();break;case 5:nk(r);break;case 4:Zc();break;case 13:Ze(st);break;case 19:Ze(st);break;case 10:J_(r.type._context);break;case 22:case 23:pk()}n=n.return}if(jt=e,wt=e=xa(e.current,null),Jt=xr=t,$t=0,up=null,fk=Qy=il=0,Jn=Th=null,Pu!==null){for(t=0;t<Pu.length;t++)if(n=Pu[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Pu=null}return e}function GP(e,t){do{var n=wt;try{if(K_(),Zm.current=Y0,V0){for(var r=at.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}V0=!1}if(rl=0,Ot=St=at=null,Ch=!1,op=0,ck.current=null,n===null||n.return===null){$t=1,up=t,wt=null;break}e:{var o=e,s=n.return,a=n,u=t;if(t=Jt,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=a,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=HF(s);if(h!==null){h.flags&=-257,GF(h,s,a,o,t),h.mode&1&&qF(o,l,t),t=h,u=l;var p=t.updateQueue;if(p===null){var g=new Set;g.add(u),t.updateQueue=g}else p.add(u);break e}else{if(!(t&1)){qF(o,l,t),gk();break e}u=Error(H(426))}}else if(tt&&a.mode&1){var m=HF(s);if(m!==null){!(m.flags&65536)&&(m.flags|=256),GF(m,s,a,o,t),X_(ef(u,a));break e}}o=u=ef(u,a),$t!==4&&($t=2),Th===null?Th=[o]:Th.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var y=TP(o,u,t);LF(o,y);break e;case 1:a=u;var v=o.type,x=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ya===null||!ya.has(x)))){o.flags|=65536,t&=-t,o.lanes|=t;var b=FP(o,a,t);LF(o,b);break e}}o=o.return}while(o!==null)}XP(n)}catch(w){t=w,wt===n&&n!==null&&(wt=n=n.return);continue}break}while(!0)}function VP(){var e=X0.current;return X0.current=Y0,e===null?Y0:e}function gk(){($t===0||$t===3||$t===2)&&($t=4),jt===null||!(il&268435455)&&!(Qy&268435455)||Qs(jt,Jt)}function J0(e,t){var n=Ae;Ae|=2;var r=VP();(jt!==e||Jt!==t)&&(Vo=null,Wu(e,t));do try{dV();break}catch(i){GP(e,i)}while(!0);if(K_(),Ae=n,X0.current=r,wt!==null)throw Error(H(261));return jt=null,Jt=0,$t}function dV(){for(;wt!==null;)YP(wt)}function hV(){for(;wt!==null&&!zH();)YP(wt)}function YP(e){var t=KP(e.alternate,e,xr);e.memoizedProps=e.pendingProps,t===null?XP(e):wt=t,ck.current=null}function XP(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=sV(n,t),n!==null){n.flags&=32767,wt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{$t=6,wt=null;return}}else if(n=oV(n,t,xr),n!==null){wt=n;return}if(t=t.sibling,t!==null){wt=t;return}wt=t=e}while(t!==null);$t===0&&($t=5)}function ku(e,t,n){var r=Be,i=Jr.transition;try{Jr.transition=null,Be=1,pV(e,t,n,r)}finally{Jr.transition=i,Be=r}return null}function pV(e,t,n,r){do Pc();while(ta!==null);if(Ae&6)throw Error(H(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(H(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(YH(e,o),e===jt&&(wt=jt=null,Jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||om||(om=!0,JP(O0,function(){return Pc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Jr.transition,Jr.transition=null;var s=Be;Be=1;var a=Ae;Ae|=4,ck.current=null,uV(e,n),WP(n,e),RG(Dw),D0=!!Rw,Dw=Rw=null,e.current=n,lV(n),IH(),Ae=a,Be=s,Jr.transition=o}else e.current=n;if(om&&(om=!1,ta=e,K0=i),o=e.pendingLanes,o===0&&(ya=null),UH(n.stateNode),sr(e,yt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Q0)throw Q0=!1,e=tE,tE=null,e;return K0&1&&e.tag!==0&&Pc(),o=e.pendingLanes,o&1?e===nE?Fh++:(Fh=0,nE=e):Fh=0,Xa(),null}function Pc(){if(ta!==null){var e=A4(K0),t=Jr.transition,n=Be;try{if(Jr.transition=null,Be=16>e?16:e,ta===null)var r=!1;else{if(e=ta,ta=null,K0=0,Ae&6)throw Error(H(331));var i=Ae;for(Ae|=4,ee=e.current;ee!==null;){var o=ee,s=o.child;if(ee.flags&16){var a=o.deletions;if(a!==null){for(var u=0;u<a.length;u++){var l=a[u];for(ee=l;ee!==null;){var c=ee;switch(c.tag){case 0:case 11:case 15:Ah(8,c,o)}var f=c.child;if(f!==null)f.return=c,ee=f;else for(;ee!==null;){c=ee;var d=c.sibling,h=c.return;if(BP(c),c===l){ee=null;break}if(d!==null){d.return=h,ee=d;break}ee=h}}}var p=o.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(g!==null)}}ee=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,ee=s;else e:for(;ee!==null;){if(o=ee,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ah(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,ee=y;break e}ee=o.return}}var v=e.current;for(ee=v;ee!==null;){s=ee;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,ee=x;else e:for(s=v;ee!==null;){if(a=ee,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Xy(9,a)}}catch(w){dt(a,a.return,w)}if(a===s){ee=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,ee=b;break e}ee=a.return}}if(Ae=i,Xa(),po&&typeof po.onPostCommitFiberRoot=="function")try{po.onPostCommitFiberRoot(jy,e)}catch{}r=!0}return r}finally{Be=n,Jr.transition=t}}return!1}function oM(e,t,n){t=ef(n,t),t=TP(e,t,1),e=ma(e,t,1),t=zn(),e!==null&&(Qp(e,1,t),sr(e,t))}function dt(e,t,n){if(e.tag===3)oM(e,e,n);else for(;t!==null;){if(t.tag===3){oM(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ya===null||!ya.has(r))){e=ef(n,e),e=FP(t,e,1),t=ma(t,e,1),e=zn(),t!==null&&(Qp(t,1,e),sr(t,e));break}}t=t.return}}function gV(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=zn(),e.pingedLanes|=e.suspendedLanes&n,jt===e&&(Jt&n)===n&&($t===4||$t===3&&(Jt&130023424)===Jt&&500>yt()-dk?Wu(e,0):fk|=n),sr(e,t)}function QP(e,t){t===0&&(e.mode&1?(t=Xg,Xg<<=1,!(Xg&130023424)&&(Xg=4194304)):t=1);var n=zn();e=bs(e,t),e!==null&&(Qp(e,t,n),sr(e,n))}function mV(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),QP(e,n)}function yV(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(t),QP(e,n)}var KP;KP=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||ir.current)nr=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return nr=!1,iV(e,t,n);nr=!!(e.flags&131072)}else nr=!1,tt&&t.flags&1048576&&eP(t,U0,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;t0(e,t),e=t.pendingProps;var i=Qc(t,Sn.current);Dc(t,n),i=ok(null,t,r,e,i,n);var o=sk();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,or(r)?(o=!0,B0(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ek(t),i.updater=Vy,t.stateNode=i,i._reactInternals=t,qw(t,r,e,n),t=Vw(null,t,r,!0,o,n)):(t.tag=0,tt&&o&&V_(t),Mn(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(t0(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=xV(r),e=bi(r,e),i){case 0:t=Gw(null,t,r,e,n);break e;case 1:t=XF(null,t,r,e,n);break e;case 11:t=VF(null,t,r,e,n);break e;case 14:t=YF(null,t,r,bi(r.type,e),n);break e}throw Error(H(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bi(r,i),Gw(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bi(r,i),XF(e,t,r,i,n);case 3:e:{if(RP(t),e===null)throw Error(H(387));r=t.pendingProps,o=t.memoizedState,i=o.element,iP(e,t),H0(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=ef(Error(H(423)),t),t=QF(e,t,r,n,i);break e}else if(r!==i){i=ef(Error(H(424)),t),t=QF(e,t,r,n,i);break e}else for(Sr=ga(t.stateNode.containerInfo.firstChild),Cr=t,tt=!0,ki=null,n=uP(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Kc(),r===i){t=ws(e,t,n);break e}Mn(e,t,r,n)}t=t.child}return t;case 5:return lP(t),e===null&&jw(t),r=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,Pw(r,i)?s=null:o!==null&&Pw(r,o)&&(t.flags|=32),OP(e,t),Mn(e,t,s,n),t.child;case 6:return e===null&&jw(t),null;case 13:return DP(e,t,n);case 4:return tk(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Jc(t,null,r,n):Mn(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bi(r,i),VF(e,t,r,i,n);case 7:return Mn(e,t,t.pendingProps,n),t.child;case 8:return Mn(e,t,t.pendingProps.children,n),t.child;case 12:return Mn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Ve(W0,r._currentValue),r._currentValue=s,o!==null)if(Ii(o.value,s)){if(o.children===i.children&&!ir.current){t=ws(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=cs(-1,n&-n),u.tag=2;var l=o.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Uw(o.return,n,t),a.lanes|=n;break}u=u.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(H(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Uw(s,n,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Mn(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Dc(t,n),i=ti(i),r=r(i),t.flags|=1,Mn(e,t,r,n),t.child;case 14:return r=t.type,i=bi(r,t.pendingProps),i=bi(r.type,i),YF(e,t,r,i,n);case 15:return MP(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bi(r,i),t0(e,t),t.tag=1,or(r)?(e=!0,B0(t)):e=!1,Dc(t,n),sP(t,r,i),qw(t,r,i,n),Vw(null,t,r,!0,e,n);case 19:return PP(e,t,n);case 22:return NP(e,t,n)}throw Error(H(156,t.tag))};function JP(e,t){return _4(e,t)}function vV(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vr(e,t,n,r){return new vV(e,t,n,r)}function mk(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xV(e){if(typeof e=="function")return mk(e)?1:0;if(e!=null){if(e=e.$$typeof,e===D_)return 11;if(e===P_)return 14}return 2}function xa(e,t){var n=e.alternate;return n===null?(n=Vr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function i0(e,t,n,r,i,o){var s=2;if(r=e,typeof e=="function")mk(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case hc:return qu(n.children,i,o,t);case R_:s=8,i|=8;break;case pw:return e=Vr(12,n,t,i|2),e.elementType=pw,e.lanes=o,e;case gw:return e=Vr(13,n,t,i),e.elementType=gw,e.lanes=o,e;case mw:return e=Vr(19,n,t,i),e.elementType=mw,e.lanes=o,e;case a4:return Ky(n,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case o4:s=10;break e;case s4:s=9;break e;case D_:s=11;break e;case P_:s=14;break e;case Us:s=16,r=null;break e}throw Error(H(130,e==null?e:typeof e,""))}return t=Vr(s,n,t,i),t.elementType=e,t.type=r,t.lanes=o,t}function qu(e,t,n,r){return e=Vr(7,e,r,t),e.lanes=n,e}function Ky(e,t,n,r){return e=Vr(22,e,r,t),e.elementType=a4,e.lanes=n,e.stateNode={isHidden:!1},e}function D2(e,t,n){return e=Vr(6,e,null,t),e.lanes=n,e}function P2(e,t,n){return t=Vr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function bV(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=m2(0),this.expirationTimes=m2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=m2(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function yk(e,t,n,r,i,o,s,a,u){return e=new bV(e,t,n,a,u),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Vr(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ek(o),e}function wV(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dc,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function ZP(e){if(!e)return Ca;e=e._reactInternals;e:{if(Ml(e)!==e||e.tag!==1)throw Error(H(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(or(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(H(171))}if(e.tag===1){var n=e.type;if(or(n))return J4(e,n,t)}return t}function e6(e,t,n,r,i,o,s,a,u){return e=yk(n,r,!0,e,i,o,s,a,u),e.context=ZP(null),n=e.current,r=zn(),i=va(n),o=cs(r,i),o.callback=t??null,ma(n,o,i),e.current.lanes=i,Qp(e,i,r),sr(e,r),e}function Jy(e,t,n,r){var i=t.current,o=zn(),s=va(i);return n=ZP(n),t.context===null?t.context=n:t.pendingContext=n,t=cs(o,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ma(i,t,s),e!==null&&(Pi(e,i,s,o),Jm(e,i,s)),s}function Z0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sM(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function vk(e,t){sM(e,t),(e=e.alternate)&&sM(e,t)}function EV(){return null}var t6=typeof reportError=="function"?reportError:function(e){console.error(e)};function xk(e){this._internalRoot=e}Zy.prototype.render=xk.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(H(409));Jy(e,t,null,null)};Zy.prototype.unmount=xk.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ol(function(){Jy(null,e,null,null)}),t[xs]=null}};function Zy(e){this._internalRoot=e}Zy.prototype.unstable_scheduleHydration=function(e){if(e){var t=M4();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Xs.length&&t!==0&&t<Xs[n].priority;n++);Xs.splice(n,0,e),n===0&&O4(e)}};function bk(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ev(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function aM(){}function SV(e,t,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var l=Z0(s);o.call(l)}}var s=e6(t,r,e,0,null,!1,!1,"",aM);return e._reactRootContainer=s,e[xs]=s.current,ep(e.nodeType===8?e.parentNode:e),ol(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=Z0(u);a.call(l)}}var u=yk(e,0,!1,null,null,!1,!1,"",aM);return e._reactRootContainer=u,e[xs]=u.current,ep(e.nodeType===8?e.parentNode:e),ol(function(){Jy(t,u,n,r)}),u}function tv(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var u=Z0(s);a.call(u)}}Jy(t,s,e,i)}else s=SV(n,t,e,i,r);return Z0(s)}T4=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Yd(t.pendingLanes);n!==0&&(I_(t,n|1),sr(t,yt()),!(Ae&6)&&(tf=yt()+500,Xa()))}break;case 13:ol(function(){var r=bs(e,1);if(r!==null){var i=zn();Pi(r,e,1,i)}}),vk(e,1)}};B_=function(e){if(e.tag===13){var t=bs(e,134217728);if(t!==null){var n=zn();Pi(t,e,134217728,n)}vk(e,134217728)}};F4=function(e){if(e.tag===13){var t=va(e),n=bs(e,t);if(n!==null){var r=zn();Pi(n,e,t,r)}vk(e,t)}};M4=function(){return Be};N4=function(e,t){var n=Be;try{return Be=e,t()}finally{Be=n}};$w=function(e,t,n){switch(t){case"input":if(xw(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Hy(r);if(!i)throw Error(H(90));l4(r),xw(r,i)}}}break;case"textarea":f4(e,n);break;case"select":t=n.value,t!=null&&Mc(e,!!n.multiple,t,!1)}};v4=hk;x4=ol;var _V={usingClientEntryPoint:!1,Events:[Jp,yc,Hy,m4,y4,hk]},xd={findFiberByHostInstance:Du,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},kV={bundleType:xd.bundleType,version:xd.version,rendererPackageName:xd.rendererPackageName,rendererConfig:xd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=E4(e),e===null?null:e.stateNode},findFiberByHostInstance:xd.findFiberByHostInstance||EV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sm.isDisabled&&sm.supportsFiber)try{jy=sm.inject(kV),po=sm}catch{}}Lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_V;Lr.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bk(t))throw Error(H(200));return wV(e,t,null,n)};Lr.createRoot=function(e,t){if(!bk(e))throw Error(H(299));var n=!1,r="",i=t6;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=yk(e,1,!1,null,null,n,!1,r,i),e[xs]=t.current,ep(e.nodeType===8?e.parentNode:e),new xk(t)};Lr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(H(188)):(e=Object.keys(e).join(","),Error(H(268,e)));return e=E4(t),e=e===null?null:e.stateNode,e};Lr.flushSync=function(e){return ol(e)};Lr.hydrate=function(e,t,n){if(!ev(t))throw Error(H(200));return tv(null,e,t,!0,n)};Lr.hydrateRoot=function(e,t,n){if(!bk(e))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=t6;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=e6(t,null,e,1,n??null,i,!1,o,s),e[xs]=t.current,ep(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Zy(t)};Lr.render=function(e,t,n){if(!ev(t))throw Error(H(200));return tv(null,e,t,!1,n)};Lr.unmountComponentAtNode=function(e){if(!ev(e))throw Error(H(40));return e._reactRootContainer?(ol(function(){tv(null,null,e,!1,function(){e._reactRootContainer=null,e[xs]=null})}),!0):!1};Lr.unstable_batchedUpdates=hk;Lr.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ev(n))throw Error(H(200));if(e==null||e._reactInternals===void 0)throw Error(H(38));return tv(e,t,n,!1,r)};Lr.version="18.2.0-next-9e3b772b8-20220608";function n6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n6)}catch(e){console.error(e)}}n6(),e4.exports=Lr;var $V=e4.exports,uM=$V;dw.createRoot=uM.createRoot,dw.hydrateRoot=uM.hydrateRoot;var r6={exports:{}},CV="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",AV=CV,TV=AV;function i6(){}function o6(){}o6.resetWarningCache=i6;var FV=function(){function e(r,i,o,s,a,u){if(u!==TV){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o6,resetWarningCache:i6};return n.PropTypes=n,n};r6.exports=FV();var MV=r6.exports;const lM=Iy(MV),cM={};function oE(e,t){e===void 0&&(e=cM),t===void 0&&(t=cM);const n=Object.keys(e),r=Object.keys(t);return e===t||n.length===r.length&&n.every(i=>e[i]===t[i])}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var NV=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),OV=Object.prototype.hasOwnProperty;function sE(e,t){return OV.call(e,t)}function aE(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)sE(e,i)&&r.push(i);return r}function _r(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function uE(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function $u(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function s6(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function lE(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(lE(e[t]))return!0}else if(typeof e=="object"){for(var r=aE(e),i=r.length,o=0;o<i;o++)if(lE(e[r[o]]))return!0}}return!1}function fM(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var a6=function(e){NV(t,e);function t(n,r,i,o,s){var a=this.constructor,u=e.call(this,fM(n,{name:r,index:i,operation:o,tree:s}))||this;return u.name=r,u.index=i,u.operation=o,u.tree=s,Object.setPrototypeOf(u,a.prototype),u.message=fM(n,{name:r,index:i,operation:o,tree:s}),u}return t}(Error),ft=a6,RV=_r,_c={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=e1(n,this.path);r&&(r=_r(r));var i=Hu(n,{op:"remove",path:this.from}).removed;return Hu(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=e1(n,this.from);return Hu(n,{op:"add",path:this.path,value:_r(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:lp(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},DV={add:function(e,t,n){return uE(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:_c.move,copy:_c.copy,test:_c.test,_get:_c._get};function e1(e,t){if(t=="")return e;var n={op:"_get",path:t};return Hu(e,n),n.value}function Hu(e,t,n,r,i,o){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):t1(t,0)),t.path===""){var s={newDocument:e};if(t.op==="add")return s.newDocument=t.value,s;if(t.op==="replace")return s.newDocument=t.value,s.removed=e,s;if(t.op==="move"||t.op==="copy")return s.newDocument=e1(e,t.from),t.op==="move"&&(s.removed=e),s;if(t.op==="test"){if(s.test=lp(e,t.value),s.test===!1)throw new ft("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s.newDocument=e,s}else{if(t.op==="remove")return s.removed=e,s.newDocument=null,s;if(t.op==="_get")return t.value=e,s;if(n)throw new ft("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return s}}else{r||(e=_r(e));var a=t.path||"",u=a.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=t1;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=s6(h)),i&&(h=="__proto__"||h=="prototype"&&c>0&&u[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!uE(h))throw new ft("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);uE(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new ft("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var s=DV[t.op].call(t,l,h,e);if(s.test===!1)throw new ft("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}}else if(c>=f){var s=_c[t.op].call(t,l,h,e);if(s.test===!1)throw new ft("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new ft("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function nv(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new ft("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=_r(e));for(var o=new Array(t.length),s=0,a=t.length;s<a;s++)o[s]=Hu(e,t[s],n,!0,i,s),e=o[s].newDocument;return o.newDocument=e,o}function PV(e,t,n){var r=Hu(e,t);if(r.test===!1)throw new ft("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function t1(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new ft("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(_c[e.op]){if(typeof e.path!="string")throw new ft("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new ft('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new ft("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new ft("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&lE(e.value))throw new ft("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new ft("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new ft("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var s={op:"_get",path:e.from,value:void 0},a=u6([s],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new ft("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new ft("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function u6(e,t,n){try{if(!Array.isArray(e))throw new ft("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)nv(_r(t),_r(e),n||!0);else{n=n||t1;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof ft)return i;throw i}}function lp(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,o,s;if(n&&r){if(o=e.length,o!=t.length)return!1;for(i=o;i--!==0;)if(!lp(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var a=Object.keys(e);if(o=a.length,o!==Object.keys(t).length)return!1;for(i=o;i--!==0;)if(!t.hasOwnProperty(a[i]))return!1;for(i=o;i--!==0;)if(s=a[i],!lp(e[s],t[s]))return!1;return!0}return e!==e&&t!==t}const LV=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:ft,_areEquals:lp,applyOperation:Hu,applyPatch:nv,applyReducer:PV,deepClone:RV,getValueByPointer:e1,validate:u6,validator:t1},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var wk=new WeakMap,zV=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),IV=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function BV(e){return wk.get(e)}function jV(e,t){return e.observers.get(t)}function UV(e,t){e.observers.delete(t.callback)}function WV(e,t){t.unobserve()}function qV(e,t){var n=[],r,i=BV(e);if(!i)i=new zV(e),wk.set(e,i);else{var o=jV(i,t);r=o&&o.observer}if(r)return r;if(r={},i.value=_r(e),t){r.callback=t,r.next=null;var s=function(){cE(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(s)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=n,r.object=e,r.unobserve=function(){cE(r),clearTimeout(r.next),UV(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new IV(t,r)),r}function cE(e,t){t===void 0&&(t=!1);var n=wk.get(e.object);Ek(n.value,e.object,e.patches,"",t),e.patches.length&&nv(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function Ek(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=aE(t),s=aE(e),a=!1,u=s.length-1;u>=0;u--){var l=s[u],c=e[l];if(sE(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?Ek(c,f,n,r+"/"+$u(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+$u(l),value:_r(c)}),n.push({op:"replace",path:r+"/"+$u(l),value:_r(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+$u(l),value:_r(c)}),n.push({op:"remove",path:r+"/"+$u(l)}),a=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!a&&o.length==s.length))for(var u=0;u<o.length;u++){var l=o[u];!sE(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+$u(l),value:_r(t[l])})}}}function HV(e,t,n){n===void 0&&(n=!1);var r=[];return Ek(e,t,r,"",n),r}const GV=Object.freeze(Object.defineProperty({__proto__:null,compare:HV,generate:cE,observe:qV,unobserve:WV},Symbol.toStringTag,{value:"Module"}));Object.assign({},LV,GV,{JsonPatchError:a6,deepClone:_r,escapePathComponent:$u,unescapePathComponent:s6});var VV=/("(?:[^\\"]|\\.)*")|[:,]/g,YV=function(t,n){var r,i,o;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,o=n.replacer,function s(a,u,l){var c,f,d,h,p,g,m,y,v,x,b,w;if(a&&typeof a.toJSON=="function"&&(a=a.toJSON()),b=JSON.stringify(a,o),b===void 0)return b;if(m=i-u.length-l,b.length<=m&&(v=b.replace(VV,function(S,E){return E||S+" "}),v.length<=m))return v;if(o!=null&&(a=JSON.parse(b),o=void 0),typeof a=="object"&&a!==null){if(y=u+r,d=[],f=0,Array.isArray(a))for(x="[",c="]",m=a.length;f<m;f++)d.push(s(a[f],y,f===m-1?0:1)||"null");else for(x="{",c="}",g=Object.keys(a),m=g.length;f<m;f++)h=g[f],p=JSON.stringify(h)+": ",w=s(a[h],y,p.length+(f===m-1?0:1)),w!==void 0&&d.push(p+w);if(d.length>0)return[x,r+d.join(`,
`+y),c].join(`
`+u)}return b}(t,"",0)};const L2=Iy(YV);function gr(e,t,n){return e.fields=t||[],e.fname=n,e}function gt(e){return e==null?null:e.fname}function xn(e){return e==null?null:e.fields}function l6(e){return e.length===1?XV(e[0]):QV(e)}const XV=e=>function(t){return t[e]},QV=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function z(e){throw Error(e)}function Mo(e){const t=[],n=e.length;let r=null,i=0,o="",s,a,u;e=e+"";function l(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(u=e[a],u==="\\")o+=e.substring(s,a++),s=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;s===i&&u==='"'||s===i&&u==="'"?(s=a+1,r=u):u==="."&&!i?a>s?l():s=a+1:u==="["?(a>s&&l(),i=s=a+1):u==="]"&&(i||z("Access path missing open bracket: "+e),i>0&&l(),i=0,s=a+1)}return i&&z("Access path missing closing bracket: "+e),r&&z("Access path missing closing quote: "+e),a>s&&(a++,l()),t}function ri(e,t,n){const r=Mo(e);return e=r.length===1?r[0]:e,gr((n&&n.get||l6)(r),[e],t||e)}const eg=ri("id"),_n=gr(e=>e,[],"identity"),Ks=gr(()=>0,[],"zero"),jf=gr(()=>1,[],"one"),ii=gr(()=>!0,[],"true"),Is=gr(()=>!1,[],"false");function KV(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const c6=0,Sk=1,_k=2,f6=3,d6=4;function kk(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:KV,r=e||c6;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=Sk&&n(t||"error","ERROR",arguments),this},warn(){return r>=_k&&n(t||"warn","WARN",arguments),this},info(){return r>=f6&&n(t||"log","INFO",arguments),this},debug(){return r>=d6&&n(t||"log","DEBUG",arguments),this}}}var I=Array.isArray;function J(e){return e===Object(e)}const dM=e=>e!=="__proto__";function Uf(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((r,i)=>{for(const o in i)if(o==="signals")r.signals=JV(r.signals,i.signals);else{const s=o==="legend"?{layout:1}:o==="style"?!0:null;Wf(r,o,i[o],s)}return r},{})}function Wf(e,t,n,r){if(!dM(t))return;let i,o;if(J(n)&&!I(n)){o=J(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?Wf(o,i,n[i]):dM(i)&&(o[i]=n[i])}else e[t]=n}function JV(e,t){if(e==null)return t;const n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function $e(e){return e[e.length-1]}function mn(e){return e==null||e===""?null:+e}const h6=e=>t=>e*Math.exp(t),p6=e=>t=>Math.log(e*t),g6=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),m6=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,n1=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function rv(e,t,n,r){const i=n(e[0]),o=n($e(e)),s=(o-i)*t;return[r(i-s),r(o-s)]}function y6(e,t){return rv(e,t,mn,_n)}function v6(e,t){var n=Math.sign(e[0]);return rv(e,t,p6(n),h6(n))}function x6(e,t,n){return rv(e,t,n1(n),n1(1/n))}function b6(e,t,n){return rv(e,t,g6(n),m6(n))}function iv(e,t,n,r,i){const o=r(e[0]),s=r($e(e)),a=t!=null?r(t):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function $k(e,t,n){return iv(e,t,n,mn,_n)}function Ck(e,t,n){const r=Math.sign(e[0]);return iv(e,t,n,p6(r),h6(r))}function r1(e,t,n,r){return iv(e,t,n,n1(r),n1(1/r))}function Ak(e,t,n,r){return iv(e,t,n,g6(r),m6(r))}function w6(e){return 1+~~(new Date(e).getMonth()/3)}function E6(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Q(e){return e!=null?I(e)?e:[e]:[]}function S6(e,t,n){let r=e[0],i=e[1],o;return i<r&&(o=i,i=r,r=o),o=i-r,o>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-o),r+o]}function ge(e){return typeof e=="function"}const ZV="descending";function Tk(e,t,n){n=n||{},t=Q(t)||[];const r=[],i=[],o={},s=n.comparator||eY;return Q(e).forEach((a,u)=>{a!=null&&(r.push(t[u]===ZV?-1:1),i.push(a=ge(a)?a:ri(a,null,n)),(xn(a)||[]).forEach(l=>o[l]=1))}),i.length===0?null:gr(s(i,r),Object.keys(o))}const ov=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),eY=(e,t)=>e.length===1?tY(e[0],t[0]):nY(e,t,e.length),tY=(e,t)=>function(n,r){return ov(e(n),e(r))*t},nY=(e,t,n)=>(t.push(0),function(r,i){let o,s=0,a=-1;for(;s===0&&++a<n;)o=e[a],s=ov(o(r),o(i));return s*t[a]});function kn(e){return ge(e)?e:()=>e}function Fk(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function pe(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function Eo(e,t){let n=0,r,i,o,s;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(o=s=i;n<r;++n)i=e[n],i!=null&&(i<o&&(o=i),i>s&&(s=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(o=s=i;n<r;++n)i=t(e[n]),i!=null&&(i<o&&(o=i),i>s&&(s=i))}return[o,s]}function _6(e,t){const n=e.length;let r=-1,i,o,s,a,u;if(t==null){for(;++r<n;)if(o=e[r],o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=e[r],o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}else{for(;++r<n;)if(o=t(e[r],r,e),o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=t(e[r],r,e),o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}return[a,u]}const rY=Object.prototype.hasOwnProperty;function ae(e,t){return rY.call(e,t)}const am={};function qf(e){let t={},n;function r(o){return ae(t,o)&&t[o]!==am}const i={size:0,empty:0,object:t,has:r,get(o){return r(o)?t[o]:void 0},set(o,s){return r(o)||(++i.size,t[o]===am&&--i.empty),t[o]=s,this},delete(o){return r(o)&&(--i.size,++i.empty,t[o]=am),this},clear(){i.size=i.empty=0,i.object=t={}},test(o){return arguments.length?(n=o,i):n},clean(){const o={};let s=0;for(const a in t){const u=t[a];u!==am&&(!n||!n(u))&&(o[a]=u,++s)}i.size=s,i.empty=0,i.object=t=o}};return e&&Object.keys(e).forEach(o=>{i.set(o,e[o])}),i}function k6(e,t,n,r,i,o){if(!n&&n!==0)return o;const s=+n;let a=e[0],u=$e(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=s?r:c<=s?i:o}function G(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),pe(r,n)}function kc(e,t,n,r){let i=t[0],o=t[t.length-1],s;return i>o&&(s=i,i=o,o=s),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=o:e<o)}function Qa(e){return typeof e=="boolean"}function ba(e){return Object.prototype.toString.call(e)==="[object Date]"}function $6(e){return e&&ge(e[Symbol.iterator])}function Te(e){return typeof e=="number"}function C6(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function K(e){return typeof e=="string"}function Mk(e,t,n){e&&(e=t?Q(e).map(a=>a.replace(/\\(.)/g,"$1")):Q(e));const r=e&&e.length,i=n&&n.get||l6,o=a=>i(t?[a]:Mo(a));let s;if(!r)s=function(){return""};else if(r===1){const a=o(e[0]);s=function(u){return""+a(u)}}else{const a=e.map(o);s=function(u){let l=""+a[0](u),c=0;for(;++c<r;)l+="|"+a[c](u);return l}}return gr(s,e,"key")}function A6(e,t){const n=e[0],r=$e(e),i=+t;return i?i===1?r:n+i*(r-n):n}const iY=1e4;function T6(e){e=+e||iY;let t,n,r;const i=()=>{t={},n={},r=0},o=(s,a)=>(++r>e&&(n=t,t={},r=1),t[s]=a);return i(),{clear:i,has:s=>ae(t,s)||ae(n,s),get:s=>ae(t,s)?t[s]:ae(n,s)?o(s,n[s]):void 0,set:(s,a)=>ae(t,s)?t[s]=a:o(s,a)}}function F6(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const s=r||new t.constructor(i+o);let a=0,u=0,l=0;for(;a<i&&u<o;++l)s[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<i;++a,++l)s[l]=t[a];for(;u<o;++u,++l)s[l]=n[u];return s}function Qd(e,t){let n="";for(;--t>=0;)n+=e;return n}function M6(e,t,n,r){const i=n||" ",o=e+"",s=t-o.length;return s<=0?o:r==="left"?Qd(i,s)+o:r==="center"?Qd(i,~~(s/2))+o+Qd(i,Math.ceil(s/2)):o+Qd(i,s)}function tg(e){return e&&$e(e)-e[0]||0}function V(e){return I(e)?"["+e.map(V)+"]":J(e)||K(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Nk(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const oY=e=>Te(e)||ba(e)?e:Date.parse(e);function Ok(e,t){return t=t||oY,e==null||e===""?null:t(e)}function Rk(e){return e==null||e===""?null:e+""}function Bi(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function N6(e,t,n,r){const i=r??"",o=e+"",s=o.length,a=Math.max(0,t-i.length);return s<=t?o:n==="left"?i+o.slice(s-a):n==="center"?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function qs(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const o=t(e[i]);o&&n(o,i,e)}}else e.forEach(n)}var hM={},z2={},I2=34,bd=10,B2=13;function O6(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function sY(e,t){var n=O6(e);return function(r,i){return t(n(r),i,e)}}function pM(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Xn(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function aY(e){return e<0?"-"+Xn(-e,6):e>9999?"+"+Xn(e,6):Xn(e,4)}function uY(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":aY(e.getUTCFullYear())+"-"+Xn(e.getUTCMonth()+1,2)+"-"+Xn(e.getUTCDate(),2)+(i?"T"+Xn(t,2)+":"+Xn(n,2)+":"+Xn(r,2)+"."+Xn(i,3)+"Z":r?"T"+Xn(t,2)+":"+Xn(n,2)+":"+Xn(r,2)+"Z":n||t?"T"+Xn(t,2)+":"+Xn(n,2)+"Z":"")}function lY(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,g=i(f,function(m,y){if(h)return h(m,y-1);p=m,h=d?sY(m,d):O6(m)});return g.columns=p||[],g}function i(f,d){var h=[],p=f.length,g=0,m=0,y,v=p<=0,x=!1;f.charCodeAt(p-1)===bd&&--p,f.charCodeAt(p-1)===B2&&--p;function b(){if(v)return z2;if(x)return x=!1,hM;var S,E=g,_;if(f.charCodeAt(E)===I2){for(;g++<p&&f.charCodeAt(g)!==I2||f.charCodeAt(++g)===I2;);return(S=g)>=p?v=!0:(_=f.charCodeAt(g++))===bd?x=!0:_===B2&&(x=!0,f.charCodeAt(g)===bd&&++g),f.slice(E+1,S-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(S=g++))===bd)x=!0;else if(_===B2)x=!0,f.charCodeAt(g)===bd&&++g;else if(_!==n)continue;return f.slice(E,S)}return v=!0,f.slice(E,p)}for(;(y=b())!==z2;){for(var w=[];y!==hM&&y!==z2;)w.push(y),y=b();d&&(w=d(w,m++))==null||h.push(w)}return h}function o(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function s(f,d){return d==null&&(d=pM(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function a(f,d){return d==null&&(d=pM(f)),o(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?uY(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:s,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function cY(e){return e}function fY(e){if(e==null)return cY;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*r+o,f[1]=(n+=a[1])*i+s;l<c;)f[l]=a[l],++l;return f}}function dY(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function hY(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return gM(e,n)})}:gM(e,t)}function gM(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,o=R6(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:o}:r==null?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function R6(e,t){var n=fY(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&dY(f,p)}function o(c){return n(c)}function s(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=s(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=s(c.arcs);break;case"MultiLineString":d=c.arcs.map(s);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function pY(e,t){var n={},r={},i={},o=[],s=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++s],t[s]=l,t[c]=d)}),t.forEach(function(l){var c=a(l),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=r[d]){delete r[p.start];var g=p===h?h:h.concat(p);r[g.start=h.start]=i[g.end=p.end]=g}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var m=p===h?h:p.concat(h);r[m.start=p.start]=i[m.end=h.end]=m}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),o.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||o.push([l])}),o}function gY(e){return R6(e,mY.apply(this,arguments))}function mY(e,t,n){var r,i,o;if(arguments.length>1)r=yY(e,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:pY(e,r)}}function yY(e,t,n){var r=[],i=[],o;function s(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:o})}function a(f){f.forEach(s)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}function fs(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function vY(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Hf(e){let t,n,r;e.length!==2?(t=fs,n=(a,u)=>fs(e(a),u),r=(a,u)=>e(a)-u):(t=e===fs||e===vY?e:xY,n=e,r=e);function i(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){const f=i(a,u,l,c-1);return f>l&&r(a[f-1],u)>-r(a[f],u)?f-1:f}return{left:i,center:s,right:o}}function xY(){return 0}function D6(e){return e===null?NaN:+e}function*bY(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const P6=Hf(fs),Aa=P6.right,wY=P6.left;Hf(D6).center;function EY(e,t){let n=0,r,i=0,o=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i));else{let s=-1;for(let a of e)(a=t(a,++s,e))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i))}if(n>1)return o/(n-1)}function SY(e,t){const n=EY(e,t);return n&&Math.sqrt(n)}class In{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],s=t+o,a=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);a&&(n[r++]=a),t=s}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,s=0;if(n>0){for(s=t[--n];n>0&&(r=s,i=t[--n],s=r+i,o=i-(s-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=s+i,i==r-s&&(s=r))}return s}}class mM extends Map{constructor(t,n=I6){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(fE(this,t))}has(t){return super.has(fE(this,t))}set(t,n){return super.set(L6(this,t),n)}delete(t){return super.delete(z6(this,t))}}class i1 extends Set{constructor(t,n=I6){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(fE(this,t))}add(t){return super.add(L6(this,t))}delete(t){return super.delete(z6(this,t))}}function fE({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function L6({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function z6({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function I6(e){return e!==null&&typeof e=="object"?e.valueOf():e}function _Y(e,t){return Array.from(t,n=>e[n])}function kY(e=fs){if(e===fs)return B6;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function B6(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const $Y=Math.sqrt(50),CY=Math.sqrt(10),AY=Math.sqrt(2);function o1(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=$Y?10:o>=CY?5:o>=AY?2:1;let a,u,l;return i<0?(l=Math.pow(10,-i)/s,a=Math.round(e*l),u=Math.round(t*l),a/l<e&&++a,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*s,a=Math.round(e/l),u=Math.round(t/l),a*l<e&&++a,u*l>t&&--u),u<a&&.5<=n&&n<2?o1(e,t,n*2):[a,u,l]}function dE(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,o,s]=r?o1(t,e,n):o1(e,t,n);if(!(o>=i))return[];const a=o-i+1,u=new Array(a);if(r)if(s<0)for(let l=0;l<a;++l)u[l]=(o-l)/-s;else for(let l=0;l<a;++l)u[l]=(o-l)*s;else if(s<0)for(let l=0;l<a;++l)u[l]=(i+l)/-s;else for(let l=0;l<a;++l)u[l]=(i+l)*s;return u}function hE(e,t,n){return t=+t,e=+e,n=+n,o1(e,t,n)[2]}function Ta(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?hE(t,e,n):hE(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Gu(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function pE(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function j6(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?B6:kY(i);r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(r,Math.floor(t+(u-l)*f/u+d));j6(e,t,h,p,i)}const o=e[t];let s=n,a=r;for(wd(e,n,t),i(e[r],o)>0&&wd(e,n,r);s<a;){for(wd(e,s,a),++s,--a;i(e[s],o)<0;)++s;for(;i(e[a],o)>0;)--a}i(e[n],o)===0?wd(e,n,a):(++a,wd(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function wd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function gE(e,t,n){if(e=Float64Array.from(bY(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return pE(e);if(t>=1)return Gu(e);var r,i=(r-1)*t,o=Math.floor(i),s=Gu(j6(e,o).subarray(0,o+1)),a=pE(e.subarray(o+1));return s+(a-s)*(i-o)}}function U6(e,t,n=D6){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e),a=+n(e[o+1],o+1,e);return s+(a-s)*(i-o)}}function TY(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function W6(e,t){return gE(e,.5,t)}function*FY(e){for(const t of e)yield*t}function q6(e){return Array.from(FY(e))}function kr(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function H6(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function MY(e,...t){e=new i1(e),t=t.map(NY);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e}function NY(e){return e instanceof i1?e:new i1(e)}function OY(...e){const t=new i1;for(const n of e)for(const r of n)t.add(r);return t}function RY(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function s1(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function nf(e){return e=s1(Math.abs(e)),e?e[1]:NaN}function DY(e,t){return function(n,r){for(var i=n.length,o=[],s=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),o.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}function PY(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var LY=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function sl(e){if(!(t=LY.exec(e)))throw new Error("invalid format: "+e);var t;return new Dk({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}sl.prototype=Dk.prototype;function Dk(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Dk.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function zY(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var G6;function IY(e,t){var n=s1(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(G6=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+s1(e,Math.max(0,t+o-1))[0]}function yM(e,t){var n=s1(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const vM={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:RY,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>yM(e*100,t),r:yM,s:IY,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function xM(e){return e}var bM=Array.prototype.map,wM=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function V6(e){var t=e.grouping===void 0||e.thousands===void 0?xM:DY(bM.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?xM:PY(bM.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=sl(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,y=f.width,v=f.comma,x=f.precision,b=f.trim,w=f.type;w==="n"?(v=!0,w="g"):vM[w]||(x===void 0&&(x=12),b=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",E=g==="$"?r:/[%p]/.test(w)?s:"",_=vM[w],k=/[defgprs%]/.test(w);x=x===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function $(C){var R=S,A=E,F,T,M;if(w==="c")A=_(C)+A,C="";else{C=+C;var P=C<0||1/C<0;if(C=isNaN(C)?u:_(Math.abs(C),x),b&&(C=zY(C)),P&&+C==0&&p!=="+"&&(P=!1),R=(P?p==="("?p:a:p==="-"||p==="("?"":p)+R,A=(w==="s"?wM[8+G6/3]:"")+A+(P&&p==="("?")":""),k){for(F=-1,T=C.length;++F<T;)if(M=C.charCodeAt(F),48>M||M>57){A=(M===46?i+C.slice(F+1):C.slice(F))+A,C=C.slice(0,F);break}}}v&&!m&&(C=t(C,1/0));var N=R.length+C.length+A.length,O=N<y?new Array(y-N+1).join(d):"";switch(v&&m&&(C=t(O+C,O.length?y-A.length:1/0),O=""),h){case"<":C=R+C+A+O;break;case"=":C=R+O+C+A;break;case"^":C=O.slice(0,N=O.length>>1)+R+C+A+O.slice(N);break;default:C=O+R+C+A;break}return o(C)}return $.toString=function(){return f+""},$}function c(f,d){var h=l((f=sl(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(nf(d)/3)))*3,g=Math.pow(10,-p),m=wM[8+p/3];return function(y){return h(g*y)+m}}return{format:l,formatPrefix:c}}var um,sv,Pk;BY({thousands:",",grouping:[3],currency:["$",""]});function BY(e){return um=V6(e),sv=um.format,Pk=um.formatPrefix,um}function Y6(e){return Math.max(0,-nf(Math.abs(e)))}function X6(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(nf(t)/3)))*3-nf(Math.abs(e)))}function Q6(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,nf(t)-nf(e))+1}const j2=new Date,U2=new Date;function Ft(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{const s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=(o,s)=>(t(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,a)=>{const u=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return u;let l;do u.push(l=new Date(+o)),t(o,a),e(o);while(l<o&&o<s);return u},i.filter=o=>Ft(s=>{if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););}),n&&(i.count=(o,s)=>(j2.setTime(+o),U2.setTime(+s),e(j2),e(U2),Math.floor(n(j2,U2))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?s=>r(s)%o===0:s=>i.count(0,s)%o===0):i)),i}const rf=Ft(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);rf.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ft(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):rf);rf.range;const is=1e3,Yr=is*60,os=Yr*60,Es=os*24,Lk=Es*7,EM=Es*30,W2=Es*365,ss=Ft(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*is)},(e,t)=>(t-e)/is,e=>e.getUTCSeconds());ss.range;const av=Ft(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*is)},(e,t)=>{e.setTime(+e+t*Yr)},(e,t)=>(t-e)/Yr,e=>e.getMinutes());av.range;const uv=Ft(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Yr)},(e,t)=>(t-e)/Yr,e=>e.getUTCMinutes());uv.range;const lv=Ft(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*is-e.getMinutes()*Yr)},(e,t)=>{e.setTime(+e+t*os)},(e,t)=>(t-e)/os,e=>e.getHours());lv.range;const cv=Ft(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*os)},(e,t)=>(t-e)/os,e=>e.getUTCHours());cv.range;const ds=Ft(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Yr)/Es,e=>e.getDate()-1);ds.range;const wa=Ft(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Es,e=>e.getUTCDate()-1);wa.range;const K6=Ft(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Es,e=>Math.floor(e/Es));K6.range;function Nl(e){return Ft(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Yr)/Lk)}const Gf=Nl(0),a1=Nl(1),jY=Nl(2),UY=Nl(3),of=Nl(4),WY=Nl(5),qY=Nl(6);Gf.range;a1.range;jY.range;UY.range;of.range;WY.range;qY.range;function Ol(e){return Ft(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Lk)}const Vf=Ol(0),u1=Ol(1),HY=Ol(2),GY=Ol(3),sf=Ol(4),VY=Ol(5),YY=Ol(6);Vf.range;u1.range;HY.range;GY.range;sf.range;VY.range;YY.range;const cp=Ft(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());cp.range;const fp=Ft(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());fp.range;const So=Ft(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());So.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ft(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});So.range;const _o=Ft(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());_o.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ft(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});_o.range;function J6(e,t,n,r,i,o){const s=[[ss,1,is],[ss,5,5*is],[ss,15,15*is],[ss,30,30*is],[o,1,Yr],[o,5,5*Yr],[o,15,15*Yr],[o,30,30*Yr],[i,1,os],[i,3,3*os],[i,6,6*os],[i,12,12*os],[r,1,Es],[r,2,2*Es],[n,1,Lk],[t,1,EM],[t,3,3*EM],[e,1,W2]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=Hf(([,,m])=>m).right(s,d);if(h===s.length)return e.every(Ta(l/W2,c/W2,f));if(h===0)return rf.every(Math.max(Ta(l,c,f),1));const[p,g]=s[d/s[h-1][2]<s[h][2]/d?h-1:h];return p.every(g)}return[a,u]}const[XY,QY]=J6(_o,fp,Vf,K6,cv,uv),[KY,JY]=J6(So,cp,Gf,ds,lv,av),Zt="year",lr="quarter",bn="month",Ct="week",cr="date",gn="day",ko="dayofyear",Nr="hours",Or="minutes",oi="seconds",ji="milliseconds",zk=[Zt,lr,bn,Ct,cr,gn,ko,Nr,Or,oi,ji],q2=zk.reduce((e,t,n)=>(e[t]=1+n,e),{});function Ik(e){const t=Q(e).slice(),n={};return t.length||z("Missing time unit."),t.forEach(i=>{ae(q2,i)?n[i]=1:z(`Invalid time unit: ${i}.`)}),(n[Ct]||n[gn]?1:0)+(n[lr]||n[bn]||n[cr]?1:0)+(n[ko]?1:0)>1&&z(`Incompatible time units: ${e}`),t.sort((i,o)=>q2[i]-q2[o]),t}const ZY={[Zt]:"%Y ",[lr]:"Q%q ",[bn]:"%b ",[cr]:"%d ",[Ct]:"W%U ",[gn]:"%a ",[ko]:"%j ",[Nr]:"%H:00",[Or]:"00:%M",[oi]:":%S",[ji]:".%L",[`${Zt}-${bn}`]:"%Y-%m ",[`${Zt}-${bn}-${cr}`]:"%Y-%m-%d ",[`${Nr}-${Or}`]:"%H:%M"};function Z6(e,t){const n=pe({},ZY,t),r=Ik(e),i=r.length;let o="",s=0,a,u;for(s=0;s<i;)for(a=r.length;a>s;--a)if(u=r.slice(s,a).join("-"),n[u]!=null){o+=n[u],s=a;break}return o.trim()}const Tu=new Date;function Bk(e){return Tu.setFullYear(e),Tu.setMonth(0),Tu.setDate(1),Tu.setHours(0,0,0,0),Tu}function eL(e){return nL(new Date(e))}function tL(e){return mE(new Date(e))}function nL(e){return ds.count(Bk(e.getFullYear())-1,e)}function mE(e){return Gf.count(Bk(e.getFullYear())-1,e)}function yE(e){return Bk(e).getDay()}function eX(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(-1,t,n,r,i,o,s);return a.setFullYear(e),a}return new Date(e,t,n,r,i,o,s)}function rL(e){return oL(new Date(e))}function iL(e){return vE(new Date(e))}function oL(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return wa.count(t-1,e)}function vE(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Vf.count(t-1,e)}function xE(e){return Tu.setTime(Date.UTC(e,0,1)),Tu.getUTCDay()}function tX(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,r,i,o,s));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,r,i,o,s))}function sL(e,t,n,r,i){const o=t||1,s=$e(e),a=(y,v,x)=>(x=x||y,nX(n[x],r[x],y===s&&o,v)),u=new Date,l=Bi(e),c=l[Zt]?a(Zt):kn(2012),f=l[bn]?a(bn):l[lr]?a(lr):Ks,d=l[Ct]&&l[gn]?a(gn,1,Ct+gn):l[Ct]?a(Ct,1):l[gn]?a(gn,1):l[cr]?a(cr,1):l[ko]?a(ko,1):jf,h=l[Nr]?a(Nr):Ks,p=l[Or]?a(Or):Ks,g=l[oi]?a(oi):Ks,m=l[ji]?a(ji):Ks;return function(y){u.setTime(+y);const v=c(u);return i(v,f(u),d(u,v),h(u),p(u),g(u),m(u))}}function nX(e,t,n,r){const i=n<=1?e:r?(o,s)=>r+n*Math.floor((e(o,s)-r)/n):(o,s)=>n*Math.floor(e(o,s)/n);return t?(o,s)=>t(i(o,s),s):i}function af(e,t,n){return t+e*7-(n+6)%7}const rX={[Zt]:e=>e.getFullYear(),[lr]:e=>Math.floor(e.getMonth()/3),[bn]:e=>e.getMonth(),[cr]:e=>e.getDate(),[Nr]:e=>e.getHours(),[Or]:e=>e.getMinutes(),[oi]:e=>e.getSeconds(),[ji]:e=>e.getMilliseconds(),[ko]:e=>nL(e),[Ct]:e=>mE(e),[Ct+gn]:(e,t)=>af(mE(e),e.getDay(),yE(t)),[gn]:(e,t)=>af(1,e.getDay(),yE(t))},iX={[lr]:e=>3*e,[Ct]:(e,t)=>af(e,0,yE(t))};function aL(e,t){return sL(e,t||1,rX,iX,eX)}const oX={[Zt]:e=>e.getUTCFullYear(),[lr]:e=>Math.floor(e.getUTCMonth()/3),[bn]:e=>e.getUTCMonth(),[cr]:e=>e.getUTCDate(),[Nr]:e=>e.getUTCHours(),[Or]:e=>e.getUTCMinutes(),[oi]:e=>e.getUTCSeconds(),[ji]:e=>e.getUTCMilliseconds(),[ko]:e=>oL(e),[Ct]:e=>vE(e),[gn]:(e,t)=>af(1,e.getUTCDay(),xE(t)),[Ct+gn]:(e,t)=>af(vE(e),e.getUTCDay(),xE(t))},sX={[lr]:e=>3*e,[Ct]:(e,t)=>af(e,0,xE(t))};function uL(e,t){return sL(e,t||1,oX,sX,tX)}const aX={[Zt]:So,[lr]:cp.every(3),[bn]:cp,[Ct]:Gf,[cr]:ds,[gn]:ds,[ko]:ds,[Nr]:lv,[Or]:av,[oi]:ss,[ji]:rf},uX={[Zt]:_o,[lr]:fp.every(3),[bn]:fp,[Ct]:Vf,[cr]:wa,[gn]:wa,[ko]:wa,[Nr]:cv,[Or]:uv,[oi]:ss,[ji]:rf};function Yf(e){return aX[e]}function Xf(e){return uX[e]}function lL(e,t,n){return e?e.offset(t,n):void 0}function cL(e,t,n){return lL(Yf(e),t,n)}function fL(e,t,n){return lL(Xf(e),t,n)}function dL(e,t,n,r){return e?e.range(t,n,r):void 0}function hL(e,t,n,r){return dL(Yf(e),t,n,r)}function pL(e,t,n,r){return dL(Xf(e),t,n,r)}const Kd=1e3,Jd=Kd*60,Zd=Jd*60,fv=Zd*24,lX=fv*7,SM=fv*30,bE=fv*365,gL=[Zt,bn,cr,Nr,Or,oi,ji],eh=gL.slice(0,-1),th=eh.slice(0,-1),nh=th.slice(0,-1),cX=nh.slice(0,-1),fX=[Zt,Ct],_M=[Zt,bn],mL=[Zt],Ed=[[eh,1,Kd],[eh,5,5*Kd],[eh,15,15*Kd],[eh,30,30*Kd],[th,1,Jd],[th,5,5*Jd],[th,15,15*Jd],[th,30,30*Jd],[nh,1,Zd],[nh,3,3*Zd],[nh,6,6*Zd],[nh,12,12*Zd],[cX,1,fv],[fX,1,lX],[_M,1,SM],[_M,3,3*SM],[mL,1,bE]];function yL(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(tg(t))/n;let i=Hf(a=>a[2]).right(Ed,r),o,s;return i===Ed.length?(o=mL,s=Ta(t[0]/bE,t[1]/bE,n)):i?(i=Ed[r/Ed[i-1][2]<Ed[i][2]/r?i-1:i],o=i[0],s=i[1]):(o=gL,s=Math.max(Ta(t[0],t[1],n),1)),{units:o,step:s}}function H2(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function G2(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Sd(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function vL(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,u=e.shortMonths,l=_d(i),c=kd(i),f=_d(o),d=kd(o),h=_d(s),p=kd(s),g=_d(a),m=kd(a),y=_d(u),v=kd(u),x={a:P,A:N,b:O,B:j,c:null,d:FM,e:FM,f:RX,g:qX,G:GX,H:MX,I:NX,j:OX,L:xL,m:DX,M:PX,p:X,q:re,Q:OM,s:RM,S:LX,u:zX,U:IX,V:BX,w:jX,W:UX,x:null,X:null,y:WX,Y:HX,Z:VX,"%":NM},b={a:be,A:he,b:Le,B:Gt,c:null,d:MM,e:MM,f:KX,g:aQ,G:lQ,H:YX,I:XX,j:QX,L:wL,m:JX,M:ZX,p:hi,q:fu,Q:OM,s:RM,S:eQ,u:tQ,U:nQ,V:rQ,w:iQ,W:oQ,x:null,X:null,y:sQ,Y:uQ,Z:cQ,"%":NM},w={a:$,A:C,b:R,B:A,c:F,d:AM,e:AM,f:CX,g:CM,G:$M,H:TM,I:TM,j:SX,L:$X,m:EX,M:_X,p:k,q:wX,Q:TX,s:FX,S:kX,u:mX,U:yX,V:vX,w:gX,W:xX,x:T,X:M,y:CM,Y:$M,Z:bX,"%":AX};x.x=S(n,x),x.X=S(r,x),x.c=S(t,x),b.x=S(n,b),b.X=S(r,b),b.c=S(t,b);function S(Z,me){return function(ve){var q=[],Vt=-1,Re=0,on=Z.length,$n,du,ZT;for(ve instanceof Date||(ve=new Date(+ve));++Vt<on;)Z.charCodeAt(Vt)===37&&(q.push(Z.slice(Re,Vt)),(du=kM[$n=Z.charAt(++Vt)])!=null?$n=Z.charAt(++Vt):du=$n==="e"?" ":"0",(ZT=me[$n])&&($n=ZT(ve,du)),q.push($n),Re=Vt+1);return q.push(Z.slice(Re,Vt)),q.join("")}}function E(Z,me){return function(ve){var q=Sd(1900,void 0,1),Vt=_(q,Z,ve+="",0),Re,on;if(Vt!=ve.length)return null;if("Q"in q)return new Date(q.Q);if("s"in q)return new Date(q.s*1e3+("L"in q?q.L:0));if(me&&!("Z"in q)&&(q.Z=0),"p"in q&&(q.H=q.H%12+q.p*12),q.m===void 0&&(q.m="q"in q?q.q:0),"V"in q){if(q.V<1||q.V>53)return null;"w"in q||(q.w=1),"Z"in q?(Re=G2(Sd(q.y,0,1)),on=Re.getUTCDay(),Re=on>4||on===0?u1.ceil(Re):u1(Re),Re=wa.offset(Re,(q.V-1)*7),q.y=Re.getUTCFullYear(),q.m=Re.getUTCMonth(),q.d=Re.getUTCDate()+(q.w+6)%7):(Re=H2(Sd(q.y,0,1)),on=Re.getDay(),Re=on>4||on===0?a1.ceil(Re):a1(Re),Re=ds.offset(Re,(q.V-1)*7),q.y=Re.getFullYear(),q.m=Re.getMonth(),q.d=Re.getDate()+(q.w+6)%7)}else("W"in q||"U"in q)&&("w"in q||(q.w="u"in q?q.u%7:"W"in q?1:0),on="Z"in q?G2(Sd(q.y,0,1)).getUTCDay():H2(Sd(q.y,0,1)).getDay(),q.m=0,q.d="W"in q?(q.w+6)%7+q.W*7-(on+5)%7:q.w+q.U*7-(on+6)%7);return"Z"in q?(q.H+=q.Z/100|0,q.M+=q.Z%100,G2(q)):H2(q)}}function _(Z,me,ve,q){for(var Vt=0,Re=me.length,on=ve.length,$n,du;Vt<Re;){if(q>=on)return-1;if($n=me.charCodeAt(Vt++),$n===37){if($n=me.charAt(Vt++),du=w[$n in kM?me.charAt(Vt++):$n],!du||(q=du(Z,ve,q))<0)return-1}else if($n!=ve.charCodeAt(q++))return-1}return q}function k(Z,me,ve){var q=l.exec(me.slice(ve));return q?(Z.p=c.get(q[0].toLowerCase()),ve+q[0].length):-1}function $(Z,me,ve){var q=h.exec(me.slice(ve));return q?(Z.w=p.get(q[0].toLowerCase()),ve+q[0].length):-1}function C(Z,me,ve){var q=f.exec(me.slice(ve));return q?(Z.w=d.get(q[0].toLowerCase()),ve+q[0].length):-1}function R(Z,me,ve){var q=y.exec(me.slice(ve));return q?(Z.m=v.get(q[0].toLowerCase()),ve+q[0].length):-1}function A(Z,me,ve){var q=g.exec(me.slice(ve));return q?(Z.m=m.get(q[0].toLowerCase()),ve+q[0].length):-1}function F(Z,me,ve){return _(Z,t,me,ve)}function T(Z,me,ve){return _(Z,n,me,ve)}function M(Z,me,ve){return _(Z,r,me,ve)}function P(Z){return s[Z.getDay()]}function N(Z){return o[Z.getDay()]}function O(Z){return u[Z.getMonth()]}function j(Z){return a[Z.getMonth()]}function X(Z){return i[+(Z.getHours()>=12)]}function re(Z){return 1+~~(Z.getMonth()/3)}function be(Z){return s[Z.getUTCDay()]}function he(Z){return o[Z.getUTCDay()]}function Le(Z){return u[Z.getUTCMonth()]}function Gt(Z){return a[Z.getUTCMonth()]}function hi(Z){return i[+(Z.getUTCHours()>=12)]}function fu(Z){return 1+~~(Z.getUTCMonth()/3)}return{format:function(Z){var me=S(Z+="",x);return me.toString=function(){return Z},me},parse:function(Z){var me=E(Z+="",!1);return me.toString=function(){return Z},me},utcFormat:function(Z){var me=S(Z+="",b);return me.toString=function(){return Z},me},utcParse:function(Z){var me=E(Z+="",!0);return me.toString=function(){return Z},me}}}var kM={"-":"",_:" ",0:"0"},qt=/^\s*\d+/,dX=/^%/,hX=/[\\^$*+?|[\]().{}]/g;function Me(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function pX(e){return e.replace(hX,"\\$&")}function _d(e){return new RegExp("^(?:"+e.map(pX).join("|")+")","i")}function kd(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function gX(e,t,n){var r=qt.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function mX(e,t,n){var r=qt.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function yX(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function vX(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function xX(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function $M(e,t,n){var r=qt.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function CM(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function bX(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function wX(e,t,n){var r=qt.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function EX(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function AM(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function SX(e,t,n){var r=qt.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function TM(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function _X(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function kX(e,t,n){var r=qt.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function $X(e,t,n){var r=qt.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function CX(e,t,n){var r=qt.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function AX(e,t,n){var r=dX.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function TX(e,t,n){var r=qt.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function FX(e,t,n){var r=qt.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function FM(e,t){return Me(e.getDate(),t,2)}function MX(e,t){return Me(e.getHours(),t,2)}function NX(e,t){return Me(e.getHours()%12||12,t,2)}function OX(e,t){return Me(1+ds.count(So(e),e),t,3)}function xL(e,t){return Me(e.getMilliseconds(),t,3)}function RX(e,t){return xL(e,t)+"000"}function DX(e,t){return Me(e.getMonth()+1,t,2)}function PX(e,t){return Me(e.getMinutes(),t,2)}function LX(e,t){return Me(e.getSeconds(),t,2)}function zX(e){var t=e.getDay();return t===0?7:t}function IX(e,t){return Me(Gf.count(So(e)-1,e),t,2)}function bL(e){var t=e.getDay();return t>=4||t===0?of(e):of.ceil(e)}function BX(e,t){return e=bL(e),Me(of.count(So(e),e)+(So(e).getDay()===4),t,2)}function jX(e){return e.getDay()}function UX(e,t){return Me(a1.count(So(e)-1,e),t,2)}function WX(e,t){return Me(e.getFullYear()%100,t,2)}function qX(e,t){return e=bL(e),Me(e.getFullYear()%100,t,2)}function HX(e,t){return Me(e.getFullYear()%1e4,t,4)}function GX(e,t){var n=e.getDay();return e=n>=4||n===0?of(e):of.ceil(e),Me(e.getFullYear()%1e4,t,4)}function VX(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Me(t/60|0,"0",2)+Me(t%60,"0",2)}function MM(e,t){return Me(e.getUTCDate(),t,2)}function YX(e,t){return Me(e.getUTCHours(),t,2)}function XX(e,t){return Me(e.getUTCHours()%12||12,t,2)}function QX(e,t){return Me(1+wa.count(_o(e),e),t,3)}function wL(e,t){return Me(e.getUTCMilliseconds(),t,3)}function KX(e,t){return wL(e,t)+"000"}function JX(e,t){return Me(e.getUTCMonth()+1,t,2)}function ZX(e,t){return Me(e.getUTCMinutes(),t,2)}function eQ(e,t){return Me(e.getUTCSeconds(),t,2)}function tQ(e){var t=e.getUTCDay();return t===0?7:t}function nQ(e,t){return Me(Vf.count(_o(e)-1,e),t,2)}function EL(e){var t=e.getUTCDay();return t>=4||t===0?sf(e):sf.ceil(e)}function rQ(e,t){return e=EL(e),Me(sf.count(_o(e),e)+(_o(e).getUTCDay()===4),t,2)}function iQ(e){return e.getUTCDay()}function oQ(e,t){return Me(u1.count(_o(e)-1,e),t,2)}function sQ(e,t){return Me(e.getUTCFullYear()%100,t,2)}function aQ(e,t){return e=EL(e),Me(e.getUTCFullYear()%100,t,2)}function uQ(e,t){return Me(e.getUTCFullYear()%1e4,t,4)}function lQ(e,t){var n=e.getUTCDay();return e=n>=4||n===0?sf(e):sf.ceil(e),Me(e.getUTCFullYear()%1e4,t,4)}function cQ(){return"+0000"}function NM(){return"%"}function OM(e){return+e}function RM(e){return Math.floor(+e/1e3)}var Ql,jk,SL,Uk,_L;fQ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function fQ(e){return Ql=vL(e),jk=Ql.format,SL=Ql.parse,Uk=Ql.utcFormat,_L=Ql.utcParse,Ql}function rh(e){const t={};return n=>t[n]||(t[n]=e(n))}function dQ(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=hQ(r,i);const s=o<r.length?r.slice(o):"";for(;--o>i;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+s}}function hQ(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function kL(e){const t=rh(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=sl(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return dQ(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,o,s){s=sl(s??",f");const a=Ta(r,i,o),u=Math.max(Math.abs(r),Math.abs(i));let l;if(s.precision==null)switch(s.type){case"s":return isNaN(l=X6(a,u))||(s.precision=l),n(s,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=Q6(a,u))||(s.precision=l-(s.type==="e"));break}case"f":case"%":{isNaN(l=Y6(a))||(s.precision=l-(s.type==="%")*2);break}}return t(s)}}}let wE;$L();function $L(){return wE=kL({format:sv,formatPrefix:Pk})}function CL(e){return kL(V6(e))}function l1(e){return arguments.length?wE=CL(e):wE}function DM(e,t,n){n=n||{},J(n)||z(`Invalid time multi-format specifier: ${n}`);const r=t(oi),i=t(Or),o=t(Nr),s=t(cr),a=t(Ct),u=t(bn),l=t(lr),c=t(Zt),f=e(n[ji]||".%L"),d=e(n[oi]||":%S"),h=e(n[Or]||"%I:%M"),p=e(n[Nr]||"%I %p"),g=e(n[cr]||n[gn]||"%a %d"),m=e(n[Ct]||"%b %d"),y=e(n[bn]||"%B"),v=e(n[lr]||"%B"),x=e(n[Zt]||"%Y");return b=>(r(b)<b?f:i(b)<b?d:o(b)<b?h:s(b)<b?p:u(b)<b?a(b)<b?g:m:c(b)<b?l(b)<b?y:v:x)(b)}function AL(e){const t=rh(e.format),n=rh(e.utcFormat);return{timeFormat:r=>K(r)?t(r):DM(t,Yf,r),utcFormat:r=>K(r)?n(r):DM(n,Xf,r),timeParse:rh(e.parse),utcParse:rh(e.utcParse)}}let EE;TL();function TL(){return EE=AL({format:jk,parse:SL,utcFormat:Uk,utcParse:_L})}function FL(e){return AL(vL(e))}function dp(e){return arguments.length?EE=FL(e):EE}const SE=(e,t)=>pe({},e,t);function ML(e,t){const n=e?CL(e):l1(),r=t?FL(t):dp();return SE(n,r)}function Wk(e,t){const n=arguments.length;return n&&n!==2&&z("defaultLocale expects either zero or two arguments."),n?SE(l1(e),dp(t)):SE(l1(),dp())}function pQ(){return $L(),TL(),Wk()}const gQ=/^(data:|([A-Za-z]+:)?\/\/)/,mQ=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,yQ=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,PM="file://";function vQ(e,t){return n=>({options:n||{},sanitize:bQ,load:xQ,fileAccess:!!t,file:wQ(t),http:SQ(e)})}async function xQ(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function bQ(e,t){t=pe({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,s;const a=mQ.test(e.replace(yQ,""));(e==null||typeof e!="string"||!a)&&z("Sanitize failure, invalid URI: "+V(e));const u=gQ.test(e);return(s=t.baseURL)&&!u&&(!e.startsWith("/")&&!s.endsWith("/")&&(e="/"+e),e=s+e),o=(i=e.startsWith(PM))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(PM.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function wQ(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,o)=>{i?r(i):n(o)})}):EQ}async function EQ(){z("No file system access.")}function SQ(e){return e?async function(t,n){const r=pe({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?ge(o[i])?o[i]():o.text():z(o.status+""+o.statusText)}:_Q}async function _Q(){z("No HTTP fetch method available.")}const kQ=e=>e!=null&&e===e,$Q=e=>e==="true"||e==="false"||e===!0||e===!1,CQ=e=>!Number.isNaN(Date.parse(e)),NL=e=>!Number.isNaN(+e)&&!(e instanceof Date),AQ=e=>NL(e)&&Number.isInteger(+e),_E={boolean:Nk,integer:mn,number:mn,date:Ok,string:Rk,unknown:_n},lm=[$Q,AQ,NL,CQ],TQ=["boolean","integer","number","date"];function OL(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=lm.length,i=lm.map((o,s)=>s+1);for(let o=0,s=0,a,u;o<n;++o)for(u=t?e[o][t]:e[o],a=0;a<r;++a)if(i[a]&&kQ(u)&&!lm[a](u)&&(i[a]=0,++s,s===lm.length))return"string";return TQ[i.reduce((o,s)=>o===0?s:o,0)-1]}function RL(e,t){return t.reduce((n,r)=>(n[r]=OL(e,r),n),{})}function LM(e){const t=function(n,r){const i={delimiter:e};return qk(n,r?pe(r,i):i)};return t.responseType="text",t}function qk(e,t){return t.header&&(e=t.header.map(V).join(t.delimiter)+`
`+e),lY(t.delimiter).parse(e+"")}qk.responseType="text";function FQ(e){return typeof Buffer=="function"&&ge(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function Hk(e,t){const n=t&&t.property?ri(t.property):_n;return J(e)&&!FQ(e)?MQ(n(e),t):n(JSON.parse(e))}Hk.responseType="json";function MQ(e,t){return!I(e)&&$6(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const NQ={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function DL(e,t){let n,r,i,o;return e=Hk(e,t),t&&t.feature?(n=hY,i=t.feature):t&&t.mesh?(n=gY,i=t.mesh,o=NQ[t.filter]):z("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):z("Invalid TopoJSON object: "+i),r&&r.features||[r]}DL.responseType="json";const o0={dsv:qk,csv:LM(","),tsv:LM("	"),json:Hk,topojson:DL};function Gk(e,t){return arguments.length>1?(o0[e]=t,this):ae(o0,e)?o0[e]:null}function PL(e){const t=Gk(e);return t&&t.responseType||"text"}function LL(e,t,n,r){t=t||{};const i=Gk(t.type||"json");return i||z("Unknown data format type: "+t.type),e=i(e,t),t.parse&&OQ(e,t.parse,n,r),ae(e,"columns")&&delete e.columns,e}function OQ(e,t,n,r){if(!e.length)return;const i=dp();n=n||i.timeParse,r=r||i.utcParse;let o=e.columns||Object.keys(e[0]),s,a,u,l,c,f;t==="auto"&&(t=RL(e,o)),o=Object.keys(t);const d=o.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?r:n)(m);if(!_E[p])throw Error("Illegal format pattern: "+h+":"+p);return _E[p]});for(u=0,c=e.length,f=o.length;u<c;++u)for(s=e[u],l=0;l<f;++l)a=o[l],s[a]=d[l](s[a])}const dv=vQ(typeof fetch<"u"&&fetch,null);function hv(e){const t=e||_n,n=[],r={};return n.add=i=>{const o=t(i);return r[o]||(r[o]=1,n.push(i)),n},n.remove=i=>{const o=t(i);if(r[o]){r[o]=0;const s=n.indexOf(i);s>=0&&n.splice(s,1)}return n},n}async function s0(e,t){try{await t(e)}catch(n){e.error(n)}}const zL=Symbol("vega_id");let RQ=1;function pv(e){return!!(e&&oe(e))}function oe(e){return e[zL]}function IL(e,t){return e[zL]=t,e}function Pe(e){const t=e===Object(e)?e:{data:e};return oe(t)?t:IL(t,RQ++)}function Vk(e){return gv(e,Pe({}))}function gv(e,t){for(const n in e)t[n]=e[n];return t}function BL(e,t){return IL(t,oe(e))}function Rl(e,t){return e?t?(n,r)=>e(n,r)||oe(t(n))-oe(t(r)):(n,r)=>e(n,r)||oe(n)-oe(r):null}function jL(e){return e&&e.constructor===Dl}function Dl(){const e=[],t=[],n=[],r=[],i=[];let o=null,s=!1;return{constructor:Dl,insert(a){const u=Q(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){const u=ge(a)?r:t,l=Q(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){const c={field:u,value:kn(l)};return ge(a)?(c.filter=a,i.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return ge(a)?i.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return o=a,this},reflow(){return s=!0,this},pulse(a,u){const l={},c={};let f,d,h,p,g,m;for(f=0,d=u.length;f<d;++f)l[oe(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[oe(g)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],u.forEach(v=>{p(v)&&(l[oe(v)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=oe(g),l[m]?l[m]=1:a.add.push(Pe(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[oe(g)]<0&&a.rem.push(g);function y(v,x,b){b?v[x]=b(v):a.encode=x,s||(c[oe(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=l[oe(g)],m>0&&(y(g,p,h.value),a.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,u.forEach(v=>{p(v)&&l[oe(v)]>0&&y(v,h.field,h.value)}),a.modifies(h.field);if(s)a.mod=t.length||r.length?u.filter(v=>l[oe(v)]>0):u.slice();else for(m in c)a.mod.push(c[m]);return(o||o==null&&(t.length||r.length))&&a.clean(!0),a}}}const a0="_:mod:_";function mv(){Object.defineProperty(this,a0,{writable:!0,value:{}})}mv.prototype={set(e,t,n,r){const i=this,o=i[e],s=i[a0];return t!=null&&t>=0?(o[t]!==n||r)&&(o[t]=n,s[t+":"+e]=-1,s[e]=-1):(o!==n||r)&&(i[e]=n,s[e]=I(n)?1+n.length:-1),i},modified(e,t){const n=this[a0];if(arguments.length){if(I(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[a0]={},this}};let DQ=0;const PQ="pulse",LQ=new mv,zQ=1,IQ=2;function He(e,t,n,r){this.id=++DQ,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function zM(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}He.prototype={targets(){return this._targets||(this._targets=hv(eg))},set(e){return this.value!==e?(this.value=e,1):0},skip:zM(zQ),modified:zM(IQ),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new mv,i=this._argops=this._argops||[],o=[];let s,a,u,l;const c=(f,d,h)=>{h instanceof He?(h!==this&&(t&&h.targets().add(this),o.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(s in e)if(a=e[s],s===PQ)Q(a).forEach(f=>{f instanceof He?f!==this&&(f.targets().add(this),o.push(f)):z("Pulse parameters must be operator instances.")}),this.source=a;else if(I(a))for(r.set(s,-1,Array(u=a.length)),l=0;l<u;++l)c(s,l,a[l]);else c(s,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){const t=this._argval||LQ,n=this._argops;let r,i,o,s;if(n){const a=n.length;for(i=0;i<a;++i)r=n[i],o=r.op,s=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,s);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function BQ(e,t,n,r){let i=1,o;return e instanceof He?o=e:e&&e.prototype instanceof He?o=new e:ge(e)?o=new He(null,e):(i=0,o=new He(e,t)),this.rank(o),i&&(r=n,n=t),n&&this.connect(o,o.parameters(n,r)),this.touch(o),o}function jQ(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let UQ=0;function yv(e,t,n){this.id=++UQ,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Bs(e,t,n){return new yv(e,t,n)}yv.prototype={_filter:ii,_apply:_n,targets(){return this._targets||(this._targets=hv(eg))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Bs(e);return this.targets().add(t),t},apply(e){const t=Bs(null,e);return this.targets().add(t),t},merge(){const e=Bs();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Bs();return this.targets().add(Bs(null,null,Fk(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(Bs(null,null,()=>n=!0)),t.targets().add(Bs(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=ii,this._targets=null}};function WQ(e,t,n,r){const i=this,o=Bs(n,r),s=function(l){l.dataflow=i;try{o.receive(l)}catch(c){i.error(c)}finally{i.run()}};let a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=Q(e);const u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,s);return o}function qQ(e,t){const n=this.locale();return LL(e,t,n.timeParse,n.utcParse)}function HQ(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function GQ(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:PL(t&&t.type)});try{i=n.parse(i,t)}catch(o){r=-2,n.warn("Data ingestion failed",e,o)}}catch(o){r=-1,n.warn("Loading failed",e,o)}return{data:i,status:r}}async function VQ(e,t,n){const r=this,i=r._pending||YQ(r);i.requests+=1;const o=await r.request(t,n);return r.pulse(e,r.changeset().remove(ii).insert(o.data||[])),i.done(),o}function YQ(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const XQ={skip:!0};function QQ(e,t,n,r,i){return(e instanceof He?JQ:KQ)(this,e,t,n,r,i),this}function KQ(e,t,n,r,i,o){const s=pe({},o,XQ);let a,u;ge(n)||(n=kn(n)),r===void 0?a=l=>e.touch(n(l)):ge(r)?(u=new He(null,r,i,!1),a=l=>{u.evaluate(l);const c=n(l),f=u.value;jL(f)?e.pulse(c,f,o):e.update(c,f,s)}):a=l=>e.update(n(l),r,s),t.apply(a)}function JQ(e,t,n,r,i,o){if(r===void 0)t.targets().add(n);else{const s=o||{},a=new He(null,ZQ(n,r),i,!1);a.modified(s.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function ZQ(e,t){return t=ge(t)?t:kn(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function eK(e){e.rank=++this._rank}function tK(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&z("Cycle detected in dataflow graph.")}const c1={},oo=1,Hs=2,Yo=4,nK=oo|Hs,IM=oo|Yo,Kl=oo|Hs|Yo,BM=8,$d=16,jM=32,UM=64;function Ea(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function V2(e,t){const n=[];return qs(e,t,r=>n.push(r)),n}function WM(e,t){const n={};return e.visit(t,r=>{n[oe(r)]=1}),r=>n[oe(r)]?null:r}function cm(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}Ea.prototype={StopPropagation:c1,ADD:oo,REM:Hs,MOD:Yo,ADD_REM:nK,ADD_MOD:IM,ALL:Kl,REFLOW:BM,SOURCE:$d,NO_SOURCE:jM,NO_FIELDS:UM,fork(e){return new Ea(this.dataflow).init(this,e)},clone(){const e=this.fork(Kl);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Kl|$d)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Ea(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&UM)&&(n.fields=e.fields),t&oo?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Hs?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Yo?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&jM?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Kl;return t&oo&&this.add.length||t&Hs&&this.rem.length||t&Yo&&this.mod.length},reflow(e){if(e)return this.fork(Kl).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Yo,WM(this,oo))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return I(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?I(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&oo&&(n.addF=cm(n.addF,t)),e&Hs&&(n.remF=cm(n.remF,t)),e&Yo&&(n.modF=cm(n.modF,t)),e&$d&&(n.srcF=cm(n.srcF,t)),n},materialize(e){e=e||Kl;const t=this;return e&oo&&t.addF&&(t.add=V2(t.add,t.addF),t.addF=null),e&Hs&&t.remF&&(t.rem=V2(t.rem,t.remF),t.remF=null),e&Yo&&t.modF&&(t.mod=V2(t.mod,t.modF),t.modF=null),e&$d&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&$d)return qs(n.source,n.srcF,r),n;e&oo&&qs(n.add,n.addF,r),e&Hs&&qs(n.rem,n.remF,r),e&Yo&&qs(n.mod,n.modF,r);const i=n.source;if(e&BM&&i){const o=n.add.length+n.mod.length;o===i.length||(o?qs(i,WM(n,IM),r):qs(i,n.srcF,r))}return n}};function Yk(e,t,n,r){const i=this;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const s of n)if(s.stamp===t){if(s.fields){const a=i.fields||(i.fields={});for(const u in s.fields)a[u]=1}s.changed(i.ADD)&&(o|=i.ADD),s.changed(i.REM)&&(o|=i.REM),s.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}G(Yk,Ea,{fork(e){const t=new Ea(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?I(e)?e.some(r=>n[r]):n[e]:0},filter(){z("MultiPulse does not support filtering.")},materialize(){z("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});async function rK(e,t,n){const r=this,i=[];if(r._pulse)return UL(r);if(r._pending&&await r._pending,t&&await s0(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Ea(r,o,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=hv(eg);let s=0,a,u,l;try{for(;r._heap.size()>0;){if(a=r._heap.pop(),a.rank!==a.qrank){r._enqueue(a,!0);continue}u=a.run(r._getPulse(a,e)),u.then?u=await u:u.async&&(i.push(u.async),u=c1),u!==c1&&a._targets&&a._targets.forEach(c=>r._enqueue(c)),++s}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${s} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await s0(r,c[f].callback)}return n&&await s0(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function iK(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function oK(e,t,n){return this._pulse?UL(this):(this.evaluate(e,t,n),this)}function sK(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function UL(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function aK(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function uK(e,t){const n=e.source,r=this._clock;return n&&I(n)?new Yk(this,r,n.map(i=>i.pulse),t):this._input[e.id]||lK(this._pulse,n&&n.pulse)}function lK(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==c1&&(e.source=t.source),e)}const Xk={skip:!1,force:!1};function cK(e,t){const n=t||Xk;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function fK(e,t,n){const r=n||Xk;return(e.set(t)||r.force)&&this.touch(e,r),this}function dK(e,t,n){this.touch(e,n||Xk);const r=new Ea(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function hK(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),WL(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,pK(t,0,e)):r=n,r}}}function WL(e,t,n,r){let i,o;const s=e[n];for(;n>t;){if(o=n-1>>1,i=e[o],r(s,i)<0){e[n]=i,n=o;continue}break}return e[n]=s}function pK(e,t,n){const r=t,i=e.length,o=e[t];let s=(t<<1)+1,a;for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],t=s,s=(t<<1)+1;return e[t]=o,WL(e,r,t,n)}function Lc(){this.logger(kk()),this.logLevel(Sk),this._clock=0,this._rank=0,this._locale=Wk();try{this._loader=dv()}catch{}this._touched=hv(eg),this._input={},this._pulse=null,this._heap=hK((e,t)=>e.qrank-t.qrank),this._postrun=[]}function Cd(e){return function(){return this._log[e].apply(this,arguments)}}Lc.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Cd("error"),warn:Cd("warn"),info:Cd("info"),debug:Cd("debug"),logLevel:Cd("level"),cleanThreshold:1e4,add:BQ,connect:jQ,rank:eK,rerank:tK,pulse:dK,touch:cK,update:fK,changeset:Dl,ingest:HQ,parse:qQ,preload:VQ,request:GQ,events:WQ,on:QQ,evaluate:rK,run:oK,runAsync:iK,runAfter:sK,_enqueue:aK,_getPulse:uK};function D(e,t){He.call(this,e,null,t)}G(D,He,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const uf={};function qL(e){const t=HL(e);return t&&t.Definition||null}function HL(e){return e=e&&e.toLowerCase(),ae(uf,e)?uf[e]:null}function*GL(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function Qk(e,t,n){const r=Float64Array.from(GL(e,n));return r.sort(fs),t.map(i=>U6(r,i))}function Kk(e,t){return Qk(e,[.25,.5,.75],t)}function Jk(e,t){const n=e.length,r=SY(e,t),i=Kk(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function VL(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o=e.extent[0],s=e.extent[1],a,u,l,c,f,d;const h=e.span||s-o||Math.abs(o)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/a)>t;)a*=n;for(f=0,d=i.length;f<d;++f)c=a/i[f],c>=l&&h/c<=t&&(a=c)}c=Math.log(a);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/a+g)*a,o=o<c?c-a:c,s=Math.ceil(s/a)*a),{start:o,stop:s===o?o+a:s,step:a}}var si=Math.random;function gK(e){si=e}function YL(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(GL(e,r)),o=i.length,s=t;let a,u,l,c;for(l=0,c=Array(s);l<s;++l){for(a=0,u=0;u<o;++u)a+=i[~~(si()*o)];c[l]=a/o}return c.sort(fs),[gE(c,n/2),gE(c,1-n/2)]}function XL(e,t,n,r){r=r||(d=>d);const i=e.length,o=new Float64Array(i);let s=0,a=1,u=r(e[0]),l=u,c=u+t,f;for(;a<i;++a){if(f=r(e[a]),f>=c){for(l=(u+l)/2;s<a;++s)o[s]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;s<a;++s)o[s]=l;return n?mK(o,t+t/4):o}function mK(e,t){const n=e.length;let r=0,i=1,o,s;for(;e[r]===e[i];)++i;for(;i<n;){for(o=i+1;e[i]===e[o];)++o;if(e[i]-e[i-1]<t){for(s=i+(r+o-i-i>>1);s<i;)e[s++]=e[i];for(;s>i;)e[s--]=e[r]}r=i,i=o}return e}function yK(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function vK(e,t){t==null&&(t=e,e=0);let n,r,i;const o={min(s){return arguments.length?(n=s||0,i=r-n,o):n},max(s){return arguments.length?(r=s||0,i=r-n,o):r},sample(){return n+Math.floor(i*si())},pdf(s){return s===Math.floor(s)&&s>=n&&s<r?1/i:0},cdf(s){const a=Math.floor(s);return a<n?0:a>=r?1:(a-n+1)/i},icdf(s){return s>=0&&s<=1?n-1+Math.floor(s*i):NaN}};return o.min(e).max(t)}const QL=Math.sqrt(2*Math.PI),xK=Math.SQRT2;let Ad=NaN;function vv(e,t){e=e||0,t=t??1;let n=0,r=0,i,o;if(Ad===Ad)n=Ad,Ad=NaN;else{do n=si()*2-1,r=si()*2-1,i=n*n+r*r;while(i===0||i>1);o=Math.sqrt(-2*Math.log(i)/i),n*=o,Ad=r*o}return e+n*t}function Zk(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*QL)}function xv(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let o;if(i>37)o=0;else{const s=Math.exp(-i*i/2);let a;i<7.07106781186547?(a=.0352624965998911*i+.700383064443688,a=a*i+6.37396220353165,a=a*i+33.912866078383,a=a*i+112.079291497871,a=a*i+221.213596169931,a=a*i+220.206867912376,o=s*a,a=.0883883476483184*i+1.75566716318264,a=a*i+16.064177579207,a=a*i+86.7807322029461,a=a*i+296.564248779674,a=a*i+637.333633378831,a=a*i+793.826512519948,a=a*i+440.413735824752,o=o/a):(a=i+.65,a=i+4/a,a=i+3/a,a=i+2/a,a=i+1/a,o=s/a/2.506628274631)}return r>0?1-o:o}function bv(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*xK*bK(2*e-1)}function bK(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function e$(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>vv(n,r),pdf:o=>Zk(o,n,r),cdf:o=>xv(o,n,r),icdf:o=>bv(o,n,r)};return i.mean(e).stdev(t)}function t$(e,t){const n=e$();let r=0;const i={data(o){return arguments.length?(e=o,r=o?o.length:0,i.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=Jk(e)),i):t},sample(){return e[~~(si()*r)]+t*n.sample()},pdf(o){let s=0,a=0;for(;a<r;++a)s+=n.pdf((o-e[a])/t);return s/t/r},cdf(o){let s=0,a=0;for(;a<r;++a)s+=n.cdf((o-e[a])/t);return s/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function n$(e,t){return e=e||0,t=t??1,Math.exp(e+vv()*t)}function r$(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*QL*e)}function i$(e,t,n){return xv(Math.log(e),t,n)}function o$(e,t,n){return Math.exp(bv(e,t,n))}function KL(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>n$(n,r),pdf:o=>r$(o,n,r),cdf:o=>i$(o,n,r),icdf:o=>o$(o,n,r)};return i.mean(e).stdev(t)}function JL(e,t){let n=0,r;function i(s){const a=[];let u=0,l;for(l=0;l<n;++l)u+=a[l]=s[l]==null?1:+s[l];for(l=0;l<n;++l)a[l]/=u;return a}const o={weights(s){return arguments.length?(r=i(t=s||[]),o):t},distributions(s){return arguments.length?(s?(n=s.length,e=s):(n=0,e=[]),o.weights(t)):e},sample(){const s=si();let a=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(s<u){a=e[l];break}return a.sample()},pdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].pdf(s);return a},cdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].cdf(s);return a},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function s$(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*si()}function a$(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function u$(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function l$(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function ZL(e,t){let n,r;const i={min(o){return arguments.length?(n=o||0,i):n},max(o){return arguments.length?(r=o??1,i):r},sample:()=>s$(n,r),pdf:o=>a$(o,n,r),cdf:o=>u$(o,n,r),icdf:o=>l$(o,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function c$(e,t,n){let r=0,i=0;for(const o of e){const s=n(o);t(o)==null||s==null||isNaN(s)||(r+=(s-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function ng(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function wv(e,t,n,r){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,o=new Float64Array(i),s=new Float64Array(i);let a=0,u=0,l=0,c,f,d;for(d of e)o[a]=c=+t(d),s[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<i;++a)o[a]-=u,s[a]-=l;return[o,s,u,l]}function rg(e,t,n,r){let i=-1,o,s;for(const a of e)o=t(a),s=n(a),o!=null&&(o=+o)>=o&&s!=null&&(s=+s)>=s&&r(o,s,++i)}function Qf(e,t,n,r,i){let o=0,s=0;return rg(e,t,n,(a,u)=>{const l=u-i(a),c=u-r;o+=l*l,s+=c*c}),1-o/s}function f$(e,t,n){let r=0,i=0,o=0,s=0,a=0;rg(e,t,n,(c,f)=>{++a,r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const u=ng(r,i,o,s),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Qf(e,t,n,i,l)}}function ez(e,t,n){let r=0,i=0,o=0,s=0,a=0;rg(e,t,n,(c,f)=>{++a,c=Math.log(c),r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const u=ng(r,i,o,s),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Qf(e,t,n,i,l)}}function tz(e,t,n){const[r,i,o,s]=wv(e,t,n);let a=0,u=0,l=0,c=0,f=0,d,h,p;rg(e,t,n,(v,x)=>{d=r[f++],h=Math.log(x),p=d*x,a+=(x*h-a)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,m]=ng(u/s,a/s,l/s,c/s),y=v=>Math.exp(g+m*(v-o));return{coef:[Math.exp(g-m*o),m],predict:y,rSquared:Qf(e,t,n,s,y)}}function nz(e,t,n){let r=0,i=0,o=0,s=0,a=0,u=0;rg(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,r+=(h-r)/u,i+=(p-i)/u,o+=(h*p-o)/u,s+=(h*h-s)/u,a+=(d-a)/u});const l=ng(r,i,o,s),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Qf(e,t,n,a,c)}}function d$(e,t,n){const[r,i,o,s]=wv(e,t,n),a=r.length;let u=0,l=0,c=0,f=0,d=0,h,p,g,m;for(h=0;h<a;)p=r[h],g=i[h++],m=p*p,u+=(m-u)/h,l+=(m*p-l)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const y=c-u*u,v=u*y-l*l,x=(d*u-f*l)/v,b=(f*y-d*l)/v,w=-x*u,S=E=>(E=E-o,x*E*E+b*E+w+s);return{coef:[w-b*o+x*o*o+s,b-2*x*o,x],predict:S,rSquared:Qf(e,t,n,s,S)}}function rz(e,t,n,r){if(r===0)return c$(e,t,n);if(r===1)return f$(e,t,n);if(r===2)return d$(e,t,n);const[i,o,s,a]=wv(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d)*o[p];for(l.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d+h);m[h]=g}c.push(m)}c.push(l);const y=EK(c),v=x=>{x-=s;let b=a+y[0]+y[1]*x+y[2]*x*x;for(d=3;d<f;++d)b+=y[d]*Math.pow(x,d);return b};return{coef:wK(f,y,-s,a),predict:v,rSquared:Qf(e,t,n,a,v)}}function wK(e,t,n,r){const i=Array(e);let o,s,a,u;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(a=t[o],u=1,i[o]+=a,s=1;s<=o;++s)u*=(o+1-s)/s,i[o-s]+=a*Math.pow(n,s)*u;return i[0]+=r,i}function EK(e){const t=e.length-1,n=[];let r,i,o,s,a;for(r=0;r<t;++r){for(s=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][s])&&(s=i);for(o=r;o<t+1;++o)a=e[o][r],e[o][r]=e[o][s],e[o][s]=a;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(a=0,o=i+1;o<t;++o)a+=e[o][i]*n[o];n[i]=(e[t][i]-a)/e[i][i]}return n}const qM=2,HM=1e-12;function iz(e,t,n,r){const[i,o,s,a]=wv(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=qM;){const p=[0,l-1];for(let m=0;m<u;++m){const y=i[m],v=p[0],x=p[1],b=y-i[v]>i[x]-y?v:x;let w=0,S=0,E=0,_=0,k=0;const $=1/Math.abs(i[b]-y||1);for(let A=v;A<=x;++A){const F=i[A],T=o[A],M=SK(Math.abs(y-F)*$)*d[A],P=F*M;w+=M,S+=P,E+=T*M,_+=T*P,k+=F*P}const[C,R]=ng(S/w,E/w,_/w,k/w);c[m]=C+R*y,f[m]=Math.abs(o[m]-c[m]),_K(i,m+1,p)}if(h===qM)break;const g=W6(f);if(Math.abs(g)<HM)break;for(let m=0,y,v;m<u;++m)y=f[m]/(6*g),d[m]=y>=1?HM:(v=1-y*y)*v}return kK(i,c,s,a)}function SK(e){return(e=1-e*e*e)*e*e}function _K(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}function kK(e,t,n,r){const i=e.length,o=[];let s=0,a=0,u=[],l;for(;s<i;++s)l=e[s]+n,u[0]===l?u[1]+=(t[s]-u[1])/++a:(a=0,u[1]+=r,u=[l,t[s]],o.push(u));return u[1]+=r,o}const $K=.5*Math.PI/180;function Ev(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=g=>[g,e(g)],o=t[0],s=t[1],a=s-o,u=a/r,l=[i(o)],c=[];if(n===r){for(let g=1;g<r;++g)l.push(i(o+g/n*a));return l.push(i(s)),l}else{c.push(i(s));for(let g=n;--g>0;)c.push(i(o+g/n*a))}let f=l[0],d=c[c.length-1];const h=1/a,p=CK(f[1],c);for(;d;){const g=i((f[0]+d[0])/2);g[0]-f[0]>=u&&AK(f,g,d,h,p)>$K?c.push(g):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function CK(e,t){let n=e,r=e;const i=t.length;for(let o=0;o<i;++o){const s=t[o][1];s<n&&(n=s),s>r&&(r=s)}return 1/(r-n)}function AK(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),s=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-s)}function TK(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function kE(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:TK(e)}function oz(e,t,n){return n||e+(t?"_"+t:"")}const Y2=()=>{},FK={init:Y2,add:Y2,rem:Y2,idx:0},hp={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},ig=Object.keys(hp).filter(e=>e!=="__count__");function MK(e,t){return(n,r)=>pe({name:e,aggregate_param:r,out:n||e},FK,t)}[...ig,"__count__"].forEach(e=>{hp[e]=MK(e,hp[e])});function sz(e,t,n){return hp[e](n,t)}function az(e,t){return e.idx-t.idx}function NK(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{r.req&&r.req.forEach(i=>{t[i]||n(t[i]=hp[i]())})};return e.forEach(n),Object.values(t).sort(az)}function OK(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.aggregate_param==null?e.init(this):e.init(this,e.aggregate_param))}function RK(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function DK(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function PK(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function uz(e,t){const n=t||_n,r=NK(e),i=e.slice().sort(az);function o(s){this._ops=r,this._out=i,this.cell=s,this.init()}return o.prototype.init=OK,o.prototype.add=RK,o.prototype.rem=DK,o.prototype.set=PK,o.prototype.get=n,o.fields=e.map(s=>s.out),o}function h$(e){this._key=e?ri(e):oe,this.reset()}const rn=h$.prototype;rn.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};rn.add=function(e){this._add.push(e)};rn.rem=function(e){this._rem.push(e)};rn.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),s={};let a,u,l;for(a=0;a<i;++a)s[n(t[a])]=1;for(a=0,u=0;a<r;++a)s[n(l=e[a])]?s[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o};rn.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,o;for(;--r>=0;)o=e(t[r])+"",ae(n,o)||(n[o]=1,++i);return i};rn.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=_6(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};rn.argmin=function(e){return this.extent(e)[0]||{}};rn.argmax=function(e){return this.extent(e)[1]||{}};rn.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};rn.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};rn.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Kk(this.values(),e),this._get=e),this._q};rn.q1=function(e){return this.quartile(e)[0]};rn.q2=function(e){return this.quartile(e)[1]};rn.q3=function(e){return this.quartile(e)[2]};rn.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=YL(this.values(),1e3,.05,e),this._get=e),this._ci};rn.ci0=function(e){return this.ci(e)[0]};rn.ci1=function(e){return this.ci(e)[1]};function Fa(e){D.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Fa.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ig},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};G(Fa,D,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):Object.create(null),t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function o(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}o(e._prev),o(t);function s(a,u,l){const c=n[l],f=r[l++];for(const d in f){const h=a?a+"|"+d:d;u[c]=f[d],l<i?s(h,u,l):t[h]||e.cell(h,u)}}s("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(v){const x=Q(xn(v)),b=x.length;let w=0,S;for(;w<b;++w)r[S=x[w]]||(r[S]=1,t.push(S))}this._dims=Q(e.groupby),this._dnames=this._dims.map(v=>{const x=gt(v);return i(v),n.push(x),x}),this.cellkey=e.key?e.key:kE(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],s=e.ops||["count"],a=e.aggregate_params||[null],u=e.as||[],l=o.length,c={};let f,d,h,p,g,m,y;for(l!==s.length&&z("Unmatched number of fields and aggregate ops."),y=0;y<l;++y){if(f=o[y],d=s[y],h=a[y]||null,f==null&&d!=="count"&&z("Null aggregate field specified."),g=gt(f),m=oz(d,g,u[y]),n.push(m),d==="count"){this._counts.push(m);continue}p=c[g],p||(i(f),p=c[g]=[],p.field=f,this._measures.push(p)),d!=="count"&&(this._countOnly=!1),p.push(sz(d,h,m))}return this._measures=this._measures.map(v=>uz(v,v.field)),Object.create(null)},cellkey:kE(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let o=0;o<i;++o)n.agg[o]=new r[o](n)}return n.store&&(n.data=new h$),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let s=0;s<i;++s)o[n[s]]=r[s](e);return t?BL(t.tuple,o):Pe(o)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,o=r.length;i<o;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,s=e.rem,a=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&s.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?s:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const LK=1e-14;function p$(e){D.call(this,null,e)}p$.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};G(p$,D,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,o=r.step,s=e.as||["bin0","bin1"],a=s[0],u=s[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(xn(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[a]=f,c[u]=f==null?null:i+o*(1+(f-i)/o)}:c=>c[a]=r(c)),t.modifies(n?s:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=VL(e),r=n.step;let i=n.start,o=i+Math.ceil((n.stop-i)/r)*r,s,a;(s=e.anchor)!=null&&(a=s-(i+r*Math.floor((s-i)/r)),i+=a,o+=a);const u=function(l){let c=mn(t(l));return c==null?null:c<i?-1/0:c>o?1/0:(c=Math.max(i,Math.min(c,o-r)),i+r*Math.floor(LK+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=gr(u,xn(t),e.name||"bin_"+gt(t))}});function lz(e,t,n){const r=e;let i=t||[],o=n||[],s={},a=0;return{add:u=>o.push(u),remove:u=>s[r(u)]=++a,size:()=>i.length,data:(u,l)=>(a&&(i=i.filter(c=>!s[r(c)]),s={},a=0),l&&u&&i.sort(u),o.length&&(i=u?F6(u,i,o.sort(u)):i.concat(o),o=[]),i)}}function g$(e){D.call(this,[],e)}g$.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};G(g$,D,{transform(e,t){const n=t.fork(t.ALL),r=lz(oe,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(Rl(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function cz(e){He.call(this,null,zK,e)}G(cz,He);function zK(e){return this.value&&!e.modified()?this.value:Tk(e.fields,e.orders)}function m$(e){D.call(this,null,e)}m$.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function IK(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}G(m$,D,{transform(e,t){const n=f=>d=>{for(var h=IK(a(d),e.case,o)||[],p,g=0,m=h.length;g<m;++g)s.test(p=h[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,s=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],s=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,l;for(a in n)u=r[a],l=n[a]||0,!u&&l?(r[a]=u=Pe({}),u[i]=a,u[o]=l,s.add.push(u)):l===0?(u&&s.rem.push(u),n[a]=null,r[a]=null):u[o]!==l&&(u[o]=l,s.mod.push(u));return s.modifies(t)}});function y$(e){D.call(this,null,e)}y$.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};G(y$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],s=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return s?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=BK(a,i,o,e.filter||ii)):n.mod=a,n.source=this.value,n.modifies(r)}});function BK(e,t,n,r){for(var i=[],o={},s=e.length,a=0,u,l;a<s;++a)for(o[t]=l=e[a],u=0;u<s;++u)o[n]=e[u],r(o)&&(i.push(Pe(o)),o={},o[t]=l);return i}const GM={kde:t$,mixture:JL,normal:e$,lognormal:KL,uniform:ZL},jK="distributions",VM="function",UK="field";function fz(e,t){const n=e[VM];ae(GM,n)||z("Unknown distribution function: "+n);const r=GM[n]();for(const i in e)i===UK?r.data((e.from||t()).map(e[i])):i===jK?r[i](e[i].map(o=>fz(o,t))):typeof r[i]===VM&&r[i](e[i]);return r}function v$(e){D.call(this,null,e)}const dz=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],WK={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:dz},{name:"weights",type:"number",array:!0}]};v$.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:dz.concat(WK)},{name:"as",type:"string",array:!0,default:["value","density"]}]};G(v$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=fz(e.distribution,qK(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let s=e.method||"pdf";s!=="pdf"&&s!=="cdf"&&z("Invalid density method: "+s),!e.extent&&!r.data&&z("Missing density extent parameter."),s=r[s];const a=e.as||["value","density"],u=e.extent||Eo(r.data()),l=Ev(s,u,i,o).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],Pe(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function qK(e){return()=>e.materialize(e.SOURCE).source}function hz(e,t){return e?e.map((n,r)=>t[r]||gt(n)):null}function x$(e,t,n){const r=[],i=f=>f(u);let o,s,a,u,l,c;if(t==null)r.push(e.map(n));else for(o={},s=0,a=e.length;s<a;++s)u=e[s],l=t.map(i),c=o[l],c||(o[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}const pz="bin";function b$(e){D.call(this,null,e)}b$.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:pz}]};const HK=(e,t)=>tg(Eo(e,t))/30;G(b$,D,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=x$(t.source,e.groupby,_n),i=e.smooth||!1,o=e.field,s=e.step||HK(n,o),a=Rl((p,g)=>o(p)-o(g)),u=e.as||pz,l=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const p=r[d].sort(a);h=-1;for(const g of XL(p,s,i,o))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:s},t.reflow(!0).modifies(u)}});function gz(e){He.call(this,null,GK,e),this.modified(!0)}G(gz,He);function GK(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:gr(n=>t(n,e),xn(t),gt(t))}function w$(e){D.call(this,[void 0,void 0],e)}w$.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};G(w$,D,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],s=n[1];if((i||o==null)&&(o=1/0,s=-1/0),t.visit(i?t.SOURCE:t.ADD,a=>{const u=mn(r(a));u!=null&&(u<o&&(o=u),u>s&&(s=u))}),!Number.isFinite(o)||!Number.isFinite(s)){let a=gt(r);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}});function E$(e,t){He.call(this,e),this.parent=t,this.count=0}G(E$,He,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function Sv(e){D.call(this,{},e),this._keys=qf();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}G(Sv,D,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let o=ae(i,e)&&i[e],s,a;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(a=r||(a=this._group[e])&&a.tuple,s=n.dataflow,o=new E$(n.fork(n.NO_SOURCE),this),s.add(o).connect(t(s,e,a)),i[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,s=e.modified("key"),a=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=oe(u),c=o.get(l);c!==void 0&&(o.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);o.set(oe(u),l),a(l).add(u)}),s||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=oe(u),c=o.get(l),f=r(u);c===f?a(f).mod(u):(o.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(o.get(oe(u))).mod(u)}),s&&t.visit(t.REFLOW,u=>{const l=oe(u),c=o.get(l),f=r(u);c!==f&&(o.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function mz(e){He.call(this,null,VK,e)}G(mz,He);function VK(e){return this.value&&!e.modified()?this.value:I(e.name)?Q(e.name).map(t=>ri(t)):ri(e.name,e.as)}function S$(e){D.call(this,qf(),e)}S$.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};G(S$,D,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,s=i.rem,a=i.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=oe(f);r.has(d)?r.delete(d):s.push(f)}),t.visit(t.ADD,f=>{u(f,e)?o.push(f):r.set(oe(f),1)});function c(f){const d=oe(f),h=u(f,e),p=r.get(d);h&&p?(r.delete(d),o.push(f)):!h&&!p?(r.set(d,1),s.push(f)):l&&h&&!p&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function _$(e){D.call(this,[],e)}_$.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};G(_$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=hz(r,e.as||[]),o=e.index||null,s=i.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=r.map(p=>p(a)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=Vk(a),f=0;f<s;++f)d[i[f]]=(h=u[f][c])==null?null:h;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}});function k$(e){D.call(this,[],e)}k$.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};G(k$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(gt),o=e.as||["key","value"],s=o[0],a=o[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Vk(l),f[s]=i[c],f[a]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});function $$(e){D.call(this,null,e)}$$.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};G($$,D,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,s=>s[r]=n(s,e))}});function yz(e){D.call(this,[],e)}G(yz,D,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,o=e.size-i.length,s,a,u;if(o>0){for(s=[];--o>=0;)s.push(u=Pe(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(s):s}else a=i.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,i=i.slice(-o);return n.source=this.value=i,n}});const fm={value:"value",median:W6,mean:TY,min:pE,max:Gu},YK=[];function C$(e){D.call(this,[],e)}C$.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function XK(e){var t=e.method||fm.value,n;if(fm[t]==null)z("Unrecognized imputation method: "+t);else return t===fm.value?(n=e.value!==void 0?e.value:0,()=>n):fm[t]}function QK(e){const t=e.field;return n=>n?t(n):NaN}G(C$,D,{transform(e,t){var n=t.fork(t.ALL),r=XK(e),i=QK(e),o=gt(e.field),s=gt(e.key),a=(e.groupby||[]).map(gt),u=KK(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,g,m,y,v,x,b,w;for(m=0,x=u.length;m<x;++m)for(d=u[m],p=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(g=u.domain[v],w={_impute:!0},y=0,b=p.length;y<b;++y)w[a[y]]=p[y];w[s]=g,w[o]=Number.isNaN(h)?h=r(d,i):h,l.push(Pe(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function KK(e,t,n,r){var i=y=>y(m),o=[],s=r?r.slice():[],a={},u={},l,c,f,d,h,p,g,m;for(s.forEach((y,v)=>a[y]=v+1),d=0,g=e.length;d<g;++d)m=e[d],p=n(m),h=a[p]||(a[p]=s.push(p)),c=(l=t?t.map(i):YK)+"",(f=u[c])||(f=u[c]=[],o.push(f),f.values=l),f[h-1]=m;return o.domain=s,o}function A$(e){Fa.call(this,e)}A$.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:ig},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};G(A$,Fa,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(i=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{pe(o,i[n.cellkey(o)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function T$(e){D.call(this,null,e)}T$.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};G(T$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=x$(r,e.groupby,e.field),o=(e.groupby||[]).map(gt),s=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&z("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=Eo(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=t$(h,s)[a],g=e.counts?h.length:1,m=c||Eo(h);Ev(p,m,f,d).forEach(y=>{const v={};for(let x=0;x<o.length;++x)v[o[x]]=h.dims[x];v[u[0]]=y[0],v[u[1]]=y[1]*g,l.push(Pe(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function vz(e){He.call(this,null,JK,e)}G(vz,He);function JK(e){return this.value&&!e.modified()?this.value:Mk(e.fields,e.flat)}function xz(e){D.call(this,[],e),this._pending=null}G(xz,D,{transform(e,t){const n=t.dataflow;return this._pending?X2(this,t,this._pending):ZK(e)?t.StopPropagation:e.values?X2(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=Q(i.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(r=>X2(this,t,Q(r.data)))}});function ZK(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function X2(e,t,n){n.forEach(Pe);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function F$(e){D.call(this,{},e)}F$.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};G(F$,D,{transform(e,t){const n=e.fields,r=e.index,i=e.values,o=e.default==null?null:e.default,s=e.modified(),a=n.length;let u=s?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return i?(d=i.length,a>1&&!c&&z('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&z('The "as" parameter has too few output field names.'),c=c||i.map(gt),f=function(p){for(var g=0,m=0,y,v;g<a;++g)if(v=r.get(n[g](p)),v==null)for(y=0;y<d;++y,++m)p[c[m]]=o;else for(y=0;y<d;++y,++m)p[c[m]]=i[y](v)}):(c||z("Missing output field names."),f=function(p){for(var g=0,m;g<a;++g)m=r.get(n[g](p)),p[c[g]]=m??o}),s?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function bz(e){He.call(this,null,eJ,e)}G(bz,He);function eJ(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,o,s;for(o=0;o<n;++o)s=t[o],s[0]<r&&(r=s[0]),s[1]>i&&(i=s[1]);return[r,i]}function wz(e){He.call(this,null,tJ,e)}G(wz,He);function tJ(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function Ez(e){D.call(this,null,e)}G(Ez,D,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function M$(e){Fa.call(this,e)}M$.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:ig,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};G(M$,Fa,{_transform:Fa.prototype.transform,transform(e,t){return this._transform(nJ(e,t),t)}});function nJ(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",o=xn(n).concat(xn(r)),s=iJ(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:s.map(()=>i),fields:s.map(a=>rJ(a,n,r,o)),as:s.map(a=>a+""),modified:e.modified.bind(e)}}function rJ(e,t,n,r){return gr(i=>t(i)===e?n(i):NaN,r,e+"")}function iJ(e,t,n){const r={},i=[];return n.visit(n.SOURCE,o=>{const s=e(o);r[s]||(r[s]=1,i.push(s))}),i.sort(ov),t?i.slice(0,t):i}function Sz(e){Sv.call(this,e)}G(Sz,Sv,{transform(e,t){const n=e.subflow,r=e.field,i=o=>this.subflow(oe(o),n,t,o);return(e.modified("field")||r&&t.modified(xn(r)))&&z("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,o=>{const s=i(o);r(o).forEach(a=>s.mod(a))}),t.visit(t.ADD,o=>{const s=i(o);r(o).forEach(a=>s.add(Pe(a)))}),t.visit(t.REM,o=>{const s=i(o);r(o).forEach(a=>s.rem(a))})):(t.visit(t.MOD,o=>i(o).mod(o)),t.visit(t.ADD,o=>i(o).add(o)),t.visit(t.REM,o=>i(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function N$(e){D.call(this,null,e)}N$.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};G(N$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=hz(e.fields,e.as||[]),o=r?(a,u)=>oJ(a,u,r,i):gv;let s;return this.value?s=this.value:(t=t.addAll(),s=this.value={}),t.visit(t.REM,a=>{const u=oe(a);n.rem.push(s[u]),s[u]=null}),t.visit(t.ADD,a=>{const u=o(a,Pe({}));s[oe(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(o(a,s[oe(a)]))}),n}});function oJ(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}function _z(e){D.call(this,null,e)}G(_z,D,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function O$(e){D.call(this,null,e)}O$.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const sJ=1e-14;G(O$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,o=x$(i,e.groupby,e.field),s=(e.groupby||[]).map(gt),a=[],u=e.step||.01,l=e.probs||kr(u/2,1-sJ,u),c=l.length;return o.forEach(f=>{const d=Qk(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<s.length;++g)p[s[g]]=f.dims[g];p[r[0]]=l[h],p[r[1]]=d[h],a.push(Pe(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function kz(e){D.call(this,null,e)}G(kz,D,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const o=oe(i);n.rem.push(r[o]),r[o]=null}),t.visit(t.ADD,i=>{const o=Vk(i);r[oe(i)]=o,n.add.push(o)}),t.visit(t.MOD,i=>{const o=r[oe(i)];for(const s in i)o[s]=i[s],n.modifies(s);n.mod.push(o)})),n}});function R$(e){D.call(this,[],e),this.count=0}R$.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};G(R$,D,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce((c,f)=>(c[oe(f)]=1,c),{});let s=this.value,a=this.count,u=0;function l(c){let f,d;s.length<i?s.push(c):(d=~~((a+1)*si()),d<s.length&&d>=u&&(f=s[d],o[oe(f)]&&n.rem.push(f),s[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=oe(c);o[f]&&(o[f]=-1,n.rem.push(c)),--a}),s=s.filter(c=>o[oe(c)]!==-1)),(t.rem.length||r)&&s.length<i&&t.source&&(u=a=s.length,t.visit(t.SOURCE,c=>{o[oe(c)]||l(c)}),u=-1),r&&s.length>i){const c=s.length-i;for(let f=0;f<c;++f)o[oe(s[f])]=-1,n.rem.push(s[f]);s=s.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[oe(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=s.filter(c=>!o[oe(c)])),this.count=a,this.value=n.source=s,n}});function D$(e){D.call(this,null,e)}D$.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};G(D$,D,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=kr(e.start,e.stop,e.step||1).map(i=>{const o={};return o[r]=i,Pe(o)}),n.add=t.add.concat(this.value),n}});function $z(e){D.call(this,null,e),this.modified(!0)}G($z,D,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function P$(e){D.call(this,null,e)}const Cz=["unit0","unit1"];P$.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:zk,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Cz}]};G(P$,D,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",o=this._floor(e,t),s=(i?Xf:Yf)(o.unit).offset,a=e.as||Cz,u=a[0],l=a[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(xn(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let m,y;g==null?(p[u]=null,r&&(p[l]=null)):(p[u]=m=y=o(g),r&&(p[l]=y=s(m,c)),m<f&&(f=m),y>d&&(d=y))}),o.start=f,o.stop=d,t.modifies(r?a:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:yL({extent:e.extent||Eo(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=Ik(r),s=this.value||{},a=(n?uL:aL)(o,i);return a.unit=$e(o),a.units=o,a.step=i,a.start=s.start,a.stop=s.stop,this.value=a}});function Az(e){D.call(this,qf(),e)}G(Az,D,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,o=a=>i.set(r(a),a);let s=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,a=>i.delete(r(a))),t.visit(t.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function Tz(e){D.call(this,null,e)}G(Tz,D,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Rl(e.sort)):t.source).map(e.field))}});function aJ(e,t,n,r){const i=pp[e](t,n);return{init:i.init||Ks,update:function(o,s){s[r]=i.next(o)}}}const pp={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=pp.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||z("ntile num must be greater than zero.");const n=pp.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||z("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=uJ(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function uJ(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const lJ=Object.keys(pp);function Fz(e){const t=Q(e.ops),n=Q(e.fields),r=Q(e.params),i=Q(e.aggregate_params),o=Q(e.as),s=this.outputs=[],a=this.windows=[],u={},l={},c=[],f=[];let d=!0;function h(p){Q(xn(p)).forEach(g=>u[g]=1)}h(e.sort),t.forEach((p,g)=>{const m=n[g],y=r[g],v=i[g]||null,x=gt(m),b=oz(p,x,o[g]);if(h(m),s.push(b),ae(pp,p))a.push(aJ(p,m,y,b));else{if(m==null&&p!=="count"&&z("Null aggregate field specified."),p==="count"){c.push(b);return}d=!1;let w=l[x];w||(w=l[x]=[],w.field=m,f.push(w)),w.push(sz(p,v,b))}}),(c.length||f.length)&&(this.cell=cJ(f,c,d)),this.inputs=Object.keys(u)}const Mz=Fz.prototype;Mz.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};Mz.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let s;if(n){for(s=e.p0;s<e.i0;++s)n.rem(i[s]);for(s=e.p1;s<e.i1;++s)n.add(i[s]);n.set(t)}for(s=0;s<o;++s)r[s].update(e,t)};function cJ(e,t,n){e=e.map(u=>uz(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),s=0;s<i;++s)o[s]=new e[s](r);if(r.store)var a=r.data=new h$;return r.add=function(u){if(r.num+=1,!n){a&&a.add(u);for(let l=0;l<i;++l)o[l].add(o[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){a&&a.rem(u);for(let l=0;l<i;++l)o[l].rem(o[l].get(u),u)}},r.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=o.length;l<c;++l)o[l].set(u)},r.init=function(){r.num=0,a&&a.reset();for(let u=0;u<i;++u)o[u].init()},r}function L$(e){D.call(this,{},e),this._mlen=0,this._mods=[]}L$.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:lJ.concat(ig)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};G(L$,D,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=Rl(e.sort),i=kE(e.groupby),o=a=>this.group(i(a));let s=this.state;(!s||n)&&(s=this.state=new Fz(e)),n||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,a=>o(a).add(a))):(t.visit(t.REM,a=>o(a).remove(a)),t.visit(t.ADD,a=>o(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)fJ(this._mods[a],s,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(s.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=lz(oe),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function fJ(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,s=r.frame||[null,0],a=e.data(n),u=a.length,l=o?Hf(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||kn(-1)};t.init();for(let f=0;f<u;++f)dJ(c,s,f,u),o&&hJ(c,l),t.update(c,a[f])}function dJ(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function hJ(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,s=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<s&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}const pJ=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Fa,bin:p$,collect:g$,compare:cz,countpattern:m$,cross:y$,density:v$,dotbin:b$,expression:gz,extent:w$,facet:Sv,field:mz,filter:S$,flatten:_$,fold:k$,formula:$$,generate:yz,impute:C$,joinaggregate:A$,kde:T$,key:vz,load:xz,lookup:F$,multiextent:bz,multivalues:wz,params:Ez,pivot:M$,prefacet:Sz,project:N$,proxy:_z,quantile:O$,relay:kz,sample:R$,sequence:D$,sieve:$z,subflow:E$,timeunit:P$,tupleindex:Az,values:Tz,window:L$},Symbol.toStringTag,{value:"Module"}));function ze(e){return function(){return e}}const YM=Math.abs,ln=Math.atan2,hu=Math.cos,gJ=Math.max,Q2=Math.min,eo=Math.sin,zu=Math.sqrt,fn=1e-12,lf=Math.PI,f1=lf/2,Nz=2*lf;function mJ(e){return e>1?0:e<-1?lf:Math.acos(e)}function XM(e){return e>=1?f1:e<=-1?-f1:Math.asin(e)}const $E=Math.PI,CE=2*$E,Cu=1e-6,yJ=CE-Cu;function Oz(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function vJ(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Oz;const n=10**t;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let z$=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Oz:vJ(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,o,s){this._append`C${+t},${+n},${+r},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(t,n,r,i,o){if(t=+t,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,u=r-t,l=i-n,c=s-t,f=a-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>Cu)if(!(Math.abs(f*u-l*c)>Cu)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let h=r-s,p=i-a,g=u*u+l*l,m=h*h+p*p,y=Math.sqrt(g),v=Math.sqrt(d),x=o*Math.tan(($E-Math.acos((g+d-m)/(2*y*v)))/2),b=x/v,w=x/y;Math.abs(b-1)>Cu&&this._append`L${t+b*c},${n+b*f}`,this._append`A${o},${o},0,0,${+(f*h>c*p)},${this._x1=t+w*u},${this._y1=n+w*l}`}}arc(t,n,r,i,o,s){if(t=+t,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),u=r*Math.sin(i),l=t+a,c=n+u,f=1^s,d=s?i-o:o-i;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>Cu||Math.abs(this._y1-c)>Cu)&&this._append`L${l},${c}`,r&&(d<0&&(d=d%CE+CE),d>yJ?this._append`A${r},${r},0,1,${f},${t-a},${n-u}A${r},${r},0,1,${f},${this._x1=l},${this._y1=c}`:d>Cu&&this._append`A${r},${r},0,${+(d>=$E)},${f},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function _v(){return new z$}_v.prototype=z$.prototype;function kv(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new z$(t)}function xJ(e){return e.innerRadius}function bJ(e){return e.outerRadius}function wJ(e){return e.startAngle}function EJ(e){return e.endAngle}function SJ(e){return e&&e.padAngle}function _J(e,t,n,r,i,o,s,a){var u=n-e,l=r-t,c=s-i,f=a-o,d=f*u-c*l;if(!(d*d<fn))return d=(c*(t-o)-f*(e-i))/d,[e+d*u,t+d*l]}function dm(e,t,n,r,i,o,s){var a=e-n,u=t-r,l=(s?o:-o)/zu(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,p=n+c,g=r+f,m=(d+p)/2,y=(h+g)/2,v=p-d,x=g-h,b=v*v+x*x,w=i-o,S=d*g-p*h,E=(x<0?-1:1)*zu(gJ(0,w*w*b-S*S)),_=(S*x-v*E)/b,k=(-S*v-x*E)/b,$=(S*x+v*E)/b,C=(-S*v+x*E)/b,R=_-m,A=k-y,F=$-m,T=C-y;return R*R+A*A>F*F+T*T&&(_=$,k=C),{cx:_,cy:k,x01:-c,y01:-f,x11:_*(i/w-1),y11:k*(i/w-1)}}function kJ(){var e=xJ,t=bJ,n=ze(0),r=null,i=wJ,o=EJ,s=SJ,a=null,u=kv(l);function l(){var c,f,d=+e.apply(this,arguments),h=+t.apply(this,arguments),p=i.apply(this,arguments)-f1,g=o.apply(this,arguments)-f1,m=YM(g-p),y=g>p;if(a||(a=c=u()),h<d&&(f=h,h=d,d=f),!(h>fn))a.moveTo(0,0);else if(m>Nz-fn)a.moveTo(h*hu(p),h*eo(p)),a.arc(0,0,h,p,g,!y),d>fn&&(a.moveTo(d*hu(g),d*eo(g)),a.arc(0,0,d,g,p,y));else{var v=p,x=g,b=p,w=g,S=m,E=m,_=s.apply(this,arguments)/2,k=_>fn&&(r?+r.apply(this,arguments):zu(d*d+h*h)),$=Q2(YM(h-d)/2,+n.apply(this,arguments)),C=$,R=$,A,F;if(k>fn){var T=XM(k/d*eo(_)),M=XM(k/h*eo(_));(S-=T*2)>fn?(T*=y?1:-1,b+=T,w-=T):(S=0,b=w=(p+g)/2),(E-=M*2)>fn?(M*=y?1:-1,v+=M,x-=M):(E=0,v=x=(p+g)/2)}var P=h*hu(v),N=h*eo(v),O=d*hu(w),j=d*eo(w);if($>fn){var X=h*hu(x),re=h*eo(x),be=d*hu(b),he=d*eo(b),Le;if(m<lf)if(Le=_J(P,N,be,he,X,re,O,j)){var Gt=P-Le[0],hi=N-Le[1],fu=X-Le[0],Z=re-Le[1],me=1/eo(mJ((Gt*fu+hi*Z)/(zu(Gt*Gt+hi*hi)*zu(fu*fu+Z*Z)))/2),ve=zu(Le[0]*Le[0]+Le[1]*Le[1]);C=Q2($,(d-ve)/(me-1)),R=Q2($,(h-ve)/(me+1))}else C=R=0}E>fn?R>fn?(A=dm(be,he,P,N,h,R,y),F=dm(X,re,O,j,h,R,y),a.moveTo(A.cx+A.x01,A.cy+A.y01),R<$?a.arc(A.cx,A.cy,R,ln(A.y01,A.x01),ln(F.y01,F.x01),!y):(a.arc(A.cx,A.cy,R,ln(A.y01,A.x01),ln(A.y11,A.x11),!y),a.arc(0,0,h,ln(A.cy+A.y11,A.cx+A.x11),ln(F.cy+F.y11,F.cx+F.x11),!y),a.arc(F.cx,F.cy,R,ln(F.y11,F.x11),ln(F.y01,F.x01),!y))):(a.moveTo(P,N),a.arc(0,0,h,v,x,!y)):a.moveTo(P,N),!(d>fn)||!(S>fn)?a.lineTo(O,j):C>fn?(A=dm(O,j,X,re,d,-C,y),F=dm(P,N,be,he,d,-C,y),a.lineTo(A.cx+A.x01,A.cy+A.y01),C<$?a.arc(A.cx,A.cy,C,ln(A.y01,A.x01),ln(F.y01,F.x01),!y):(a.arc(A.cx,A.cy,C,ln(A.y01,A.x01),ln(A.y11,A.x11),!y),a.arc(0,0,d,ln(A.cy+A.y11,A.cx+A.x11),ln(F.cy+F.y11,F.cx+F.x11),y),a.arc(F.cx,F.cy,C,ln(F.y11,F.x11),ln(F.y01,F.x01),!y))):a.arc(0,0,d,w,b,y)}if(a.closePath(),c)return a=null,c+""||null}return l.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-lf/2;return[hu(f)*c,eo(f)*c]},l.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:ze(+c),l):e},l.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:ze(+c),l):t},l.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:ze(+c),l):n},l.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:ze(+c),l):r},l.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:ze(+c),l):i},l.endAngle=function(c){return arguments.length?(o=typeof c=="function"?c:ze(+c),l):o},l.padAngle=function(c){return arguments.length?(s=typeof c=="function"?c:ze(+c),l):s},l.context=function(c){return arguments.length?(a=c??null,l):a},l}function Rz(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Dz(e){this._context=e}Dz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function I$(e){return new Dz(e)}function Pz(e){return e[0]}function Lz(e){return e[1]}function zz(e,t){var n=ze(!0),r=null,i=I$,o=null,s=kv(a);e=typeof e=="function"?e:e===void 0?Pz:ze(e),t=typeof t=="function"?t:t===void 0?Lz:ze(t);function a(u){var l,c=(u=Rz(u)).length,f,d=!1,h;for(r==null&&(o=i(h=s())),l=0;l<=c;++l)!(l<c&&n(f=u[l],l,u))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(f,l,u),+t(f,l,u));if(h)return o=null,h+""||null}return a.x=function(u){return arguments.length?(e=typeof u=="function"?u:ze(+u),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:ze(+u),a):t},a.defined=function(u){return arguments.length?(n=typeof u=="function"?u:ze(!!u),a):n},a.curve=function(u){return arguments.length?(i=u,r!=null&&(o=i(r)),a):i},a.context=function(u){return arguments.length?(u==null?r=o=null:o=i(r=u),a):r},a}function Iz(e,t,n){var r=null,i=ze(!0),o=null,s=I$,a=null,u=kv(l);e=typeof e=="function"?e:e===void 0?Pz:ze(+e),t=typeof t=="function"?t:ze(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Lz:ze(+n);function l(f){var d,h,p,g=(f=Rz(f)).length,m,y=!1,v,x=new Array(g),b=new Array(g);for(o==null&&(a=s(v=u())),d=0;d<=g;++d){if(!(d<g&&i(m=f[d],d,f))===y)if(y=!y)h=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=d-1;p>=h;--p)a.point(x[p],b[p]);a.lineEnd(),a.areaEnd()}y&&(x[d]=+e(m,d,f),b[d]=+t(m,d,f),a.point(r?+r(m,d,f):x[d],n?+n(m,d,f):b[d]))}if(v)return a=null,v+""||null}function c(){return zz().defined(i).curve(s).context(o)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:ze(+f),r=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:ze(+f),l):e},l.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:ze(+f),l):r},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:ze(+f),n=null,l):t},l.y0=function(f){return arguments.length?(t=typeof f=="function"?f:ze(+f),l):t},l.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:ze(+f),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(r).y(t)},l.defined=function(f){return arguments.length?(i=typeof f=="function"?f:ze(!!f),l):i},l.curve=function(f){return arguments.length?(s=f,o!=null&&(a=s(o)),l):s},l.context=function(f){return arguments.length?(f==null?o=a=null:a=s(o=f),l):o},l}const $J={draw(e,t){const n=zu(t/lf);e.moveTo(n,0),e.arc(0,0,n,0,Nz)}};function CJ(e,t){let n=null,r=kv(i);e=typeof e=="function"?e:ze(e||$J),t=typeof t=="function"?t:ze(t===void 0?64:+t);function i(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return i.type=function(o){return arguments.length?(e=typeof o=="function"?o:ze(o),i):e},i.size=function(o){return arguments.length?(t=typeof o=="function"?o:ze(+o),i):t},i.context=function(o){return arguments.length?(n=o??null,i):n},i}function Ma(){}function d1(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function $v(e){this._context=e}$v.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:d1(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:d1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function AJ(e){return new $v(e)}function Bz(e){this._context=e}Bz.prototype={areaStart:Ma,areaEnd:Ma,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:d1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function TJ(e){return new Bz(e)}function jz(e){this._context=e}jz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:d1(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function FJ(e){return new jz(e)}function Uz(e,t){this._basis=new $v(e),this._beta=t}Uz.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,s=t[n]-i,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+u*o),this._beta*t[a]+(1-this._beta)*(i+u*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const MJ=function e(t){function n(r){return t===1?new $v(r):new Uz(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function h1(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function B$(e,t){this._context=e,this._k=(1-t)/6}B$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:h1(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:h1(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const NJ=function e(t){function n(r){return new B$(r,t)}return n.tension=function(r){return e(+r)},n}(0);function j$(e,t){this._context=e,this._k=(1-t)/6}j$.prototype={areaStart:Ma,areaEnd:Ma,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:h1(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const OJ=function e(t){function n(r){return new j$(r,t)}return n.tension=function(r){return e(+r)},n}(0);function U$(e,t){this._context=e,this._k=(1-t)/6}U$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:h1(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const RJ=function e(t){function n(r){return new U$(r,t)}return n.tension=function(r){return e(+r)},n}(0);function W$(e,t,n){var r=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>fn){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>fn){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,s=(s*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,s,e._x2,e._y2)}function Wz(e,t){this._context=e,this._alpha=t}Wz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:W$(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const DJ=function e(t){function n(r){return t?new Wz(r,t):new B$(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function qz(e,t){this._context=e,this._alpha=t}qz.prototype={areaStart:Ma,areaEnd:Ma,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:W$(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const PJ=function e(t){function n(r){return t?new qz(r,t):new j$(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Hz(e,t){this._context=e,this._alpha=t}Hz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:W$(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const LJ=function e(t){function n(r){return t?new Hz(r,t):new U$(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Gz(e){this._context=e}Gz.prototype={areaStart:Ma,areaEnd:Ma,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function zJ(e){return new Gz(e)}function QM(e){return e<0?-1:1}function KM(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(QM(o)+QM(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function JM(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function K2(e,t,n){var r=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,i+a*t,o-a,s-a*n,o,s)}function p1(e){this._context=e}p1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:K2(this,this._t0,JM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,K2(this,JM(this,n=KM(this,e,t)),n);break;default:K2(this,this._t0,n=KM(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Vz(e){this._context=new Yz(e)}(Vz.prototype=Object.create(p1.prototype)).point=function(e,t){p1.prototype.point.call(this,t,e)};function Yz(e){this._context=e}Yz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function IJ(e){return new p1(e)}function BJ(e){return new Vz(e)}function Xz(e){this._context=e}Xz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=ZM(e),i=ZM(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function ZM(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),s=new Array(n);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,s[t]-=r*s[t-1];for(i[n-1]=s[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function jJ(e){return new Xz(e)}function Cv(e,t){this._context=e,this._t=t}Cv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function UJ(e){return new Cv(e,.5)}function WJ(e){return new Cv(e,0)}function qJ(e){return new Cv(e,1)}function Sa(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const HJ=()=>typeof Image<"u"?Image:null;function No(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ka(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const AE=Symbol("implicit");function q$(){var e=new mM,t=[],n=[],r=AE;function i(o){let s=e.get(o);if(s===void 0){if(r!==AE)return r;e.set(o,s=t.push(o)-1)}return n[s%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new mM;for(const s of o)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return q$(t,n).unknown(r)},No.apply(i,arguments),i}function Kf(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function og(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ja(){}var al=.7,cf=1/al,zc="\\s*([+-]?\\d+)\\s*",gp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",mo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",GJ=/^#([0-9a-f]{3,8})$/,VJ=new RegExp(`^rgb\\(${zc},${zc},${zc}\\)$`),YJ=new RegExp(`^rgb\\(${mo},${mo},${mo}\\)$`),XJ=new RegExp(`^rgba\\(${zc},${zc},${zc},${gp}\\)$`),QJ=new RegExp(`^rgba\\(${mo},${mo},${mo},${gp}\\)$`),KJ=new RegExp(`^hsl\\(${gp},${mo},${mo}\\)$`),JJ=new RegExp(`^hsla\\(${gp},${mo},${mo},${gp}\\)$`),eN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Kf(Ja,mp,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:tN,formatHex:tN,formatHex8:ZJ,formatHsl:eZ,formatRgb:nN,toString:nN});function tN(){return this.rgb().formatHex()}function ZJ(){return this.rgb().formatHex8()}function eZ(){return Qz(this).formatHsl()}function nN(){return this.rgb().formatRgb()}function mp(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=GJ.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?rN(t):n===3?new Pt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?hm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?hm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=VJ.exec(e))?new Pt(t[1],t[2],t[3],1):(t=YJ.exec(e))?new Pt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=XJ.exec(e))?hm(t[1],t[2],t[3],t[4]):(t=QJ.exec(e))?hm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=KJ.exec(e))?sN(t[1],t[2]/100,t[3]/100,1):(t=JJ.exec(e))?sN(t[1],t[2]/100,t[3]/100,t[4]):eN.hasOwnProperty(e)?rN(eN[e]):e==="transparent"?new Pt(NaN,NaN,NaN,0):null}function rN(e){return new Pt(e>>16&255,e>>8&255,e&255,1)}function hm(e,t,n,r){return r<=0&&(e=t=n=NaN),new Pt(e,t,n,r)}function H$(e){return e instanceof Ja||(e=mp(e)),e?(e=e.rgb(),new Pt(e.r,e.g,e.b,e.opacity)):new Pt}function Na(e,t,n,r){return arguments.length===1?H$(e):new Pt(e,t,n,r??1)}function Pt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Kf(Pt,Na,og(Ja,{brighter(e){return e=e==null?cf:Math.pow(cf,e),new Pt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?al:Math.pow(al,e),new Pt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Pt(Vu(this.r),Vu(this.g),Vu(this.b),g1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:iN,formatHex:iN,formatHex8:tZ,formatRgb:oN,toString:oN}));function iN(){return`#${Iu(this.r)}${Iu(this.g)}${Iu(this.b)}`}function tZ(){return`#${Iu(this.r)}${Iu(this.g)}${Iu(this.b)}${Iu((isNaN(this.opacity)?1:this.opacity)*255)}`}function oN(){const e=g1(this.opacity);return`${e===1?"rgb(":"rgba("}${Vu(this.r)}, ${Vu(this.g)}, ${Vu(this.b)}${e===1?")":`, ${e})`}`}function g1(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Vu(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Iu(e){return e=Vu(e),(e<16?"0":"")+e.toString(16)}function sN(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ai(e,t,n,r)}function Qz(e){if(e instanceof Ai)return new Ai(e.h,e.s,e.l,e.opacity);if(e instanceof Ja||(e=mp(e)),!e)return new Ai;if(e instanceof Ai)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(t===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-t)/a+2:s=(t-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new Ai(s,a,u,e.opacity)}function m1(e,t,n,r){return arguments.length===1?Qz(e):new Ai(e,t,n,r??1)}function Ai(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Kf(Ai,m1,og(Ja,{brighter(e){return e=e==null?cf:Math.pow(cf,e),new Ai(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?al:Math.pow(al,e),new Ai(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Pt(J2(e>=240?e-240:e+120,i,r),J2(e,i,r),J2(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Ai(aN(this.h),pm(this.s),pm(this.l),g1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=g1(this.opacity);return`${e===1?"hsl(":"hsla("}${aN(this.h)}, ${pm(this.s)*100}%, ${pm(this.l)*100}%${e===1?")":`, ${e})`}`}}));function aN(e){return e=(e||0)%360,e<0?e+360:e}function pm(e){return Math.max(0,Math.min(1,e||0))}function J2(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Kz=Math.PI/180,Jz=180/Math.PI,y1=18,Zz=.96422,e8=1,t8=.82521,n8=4/29,Ic=6/29,r8=3*Ic*Ic,nZ=Ic*Ic*Ic;function i8(e){if(e instanceof yo)return new yo(e.l,e.a,e.b,e.opacity);if(e instanceof as)return o8(e);e instanceof Pt||(e=H$(e));var t=nb(e.r),n=nb(e.g),r=nb(e.b),i=Z2((.2225045*t+.7168786*n+.0606169*r)/e8),o,s;return t===n&&n===r?o=s=i:(o=Z2((.4360747*t+.3850649*n+.1430804*r)/Zz),s=Z2((.0139322*t+.0971045*n+.7141733*r)/t8)),new yo(116*i-16,500*(o-i),200*(i-s),e.opacity)}function v1(e,t,n,r){return arguments.length===1?i8(e):new yo(e,t,n,r??1)}function yo(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Kf(yo,v1,og(Ja,{brighter(e){return new yo(this.l+y1*(e??1),this.a,this.b,this.opacity)},darker(e){return new yo(this.l-y1*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Zz*eb(t),e=e8*eb(e),n=t8*eb(n),new Pt(tb(3.1338561*t-1.6168667*e-.4906146*n),tb(-.9787684*t+1.9161415*e+.033454*n),tb(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Z2(e){return e>nZ?Math.pow(e,1/3):e/r8+n8}function eb(e){return e>Ic?e*e*e:r8*(e-n8)}function tb(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function nb(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function rZ(e){if(e instanceof as)return new as(e.h,e.c,e.l,e.opacity);if(e instanceof yo||(e=i8(e)),e.a===0&&e.b===0)return new as(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Jz;return new as(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function x1(e,t,n,r){return arguments.length===1?rZ(e):new as(e,t,n,r??1)}function as(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function o8(e){if(isNaN(e.h))return new yo(e.l,0,0,e.opacity);var t=e.h*Kz;return new yo(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Kf(as,x1,og(Ja,{brighter(e){return new as(this.h,this.c,this.l+y1*(e??1),this.opacity)},darker(e){return new as(this.h,this.c,this.l-y1*(e??1),this.opacity)},rgb(){return o8(this).rgb()}}));var s8=-.14861,G$=1.78277,V$=-.29227,Av=-.90649,yp=1.97294,uN=yp*Av,lN=yp*G$,cN=G$*V$-Av*s8;function iZ(e){if(e instanceof Yu)return new Yu(e.h,e.s,e.l,e.opacity);e instanceof Pt||(e=H$(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(cN*r+uN*t-lN*n)/(cN+uN-lN),o=r-i,s=(yp*(n-i)-V$*o)/Av,a=Math.sqrt(s*s+o*o)/(yp*i*(1-i)),u=a?Math.atan2(s,o)*Jz-120:NaN;return new Yu(u<0?u+360:u,a,i,e.opacity)}function TE(e,t,n,r){return arguments.length===1?iZ(e):new Yu(e,t,n,r??1)}function Yu(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Kf(Yu,TE,og(Ja,{brighter(e){return e=e==null?cf:Math.pow(cf,e),new Yu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?al:Math.pow(al,e),new Yu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*Kz,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Pt(255*(t+n*(s8*r+G$*i)),255*(t+n*(V$*r+Av*i)),255*(t+n*(yp*r)),this.opacity)}}));function a8(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}function u8(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return a8((n-r/t)*t,s,i,o,a)}}function l8(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return a8((n-r/t)*t,i,o,s,a)}}const Tv=e=>()=>e;function c8(e,t){return function(n){return e+n*t}}function oZ(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Fv(e,t){var n=t-e;return n?c8(e,n>180||n<-180?n-360*Math.round(n/360):n):Tv(isNaN(e)?t:e)}function sZ(e){return(e=+e)==1?Lt:function(t,n){return n-t?oZ(t,n,e):Tv(isNaN(t)?n:t)}}function Lt(e,t){var n=t-e;return n?c8(e,n):Tv(isNaN(e)?t:e)}const FE=function e(t){var n=sZ(t);function r(i,o){var s=n((i=Na(i)).r,(o=Na(o)).r),a=n(i.g,o.g),u=n(i.b,o.b),l=Lt(i.opacity,o.opacity);return function(c){return i.r=s(c),i.g=a(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function f8(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s)a=Na(t[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=e(r),i=e(i),o=e(o),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=o(u),a+""}}}var aZ=f8(u8),uZ=f8(l8);function Y$(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function d8(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function lZ(e,t){return(d8(t)?Y$:h8)(e,t)}function h8(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=Za(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}function p8(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function $i(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function g8(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Za(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var ME=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rb=new RegExp(ME.source,"g");function cZ(e){return function(){return e}}function fZ(e){return function(t){return e(t)+""}}function m8(e,t){var n=ME.lastIndex=rb.lastIndex=0,r,i,o,s=-1,a=[],u=[];for(e=e+"",t=t+"";(r=ME.exec(e))&&(i=rb.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:$i(r,i)})),n=rb.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?fZ(u[0].x):cZ(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function Za(e,t){var n=typeof t,r;return t==null||n==="boolean"?Tv(t):(n==="number"?$i:n==="string"?(r=mp(t))?(t=r,FE):m8:t instanceof mp?FE:t instanceof Date?p8:d8(t)?Y$:Array.isArray(t)?h8:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?g8:$i)(e,t)}function dZ(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function hZ(e,t){var n=Fv(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function sg(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var fN=180/Math.PI,NE={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function y8(e,t,n,r,i,o){var s,a,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*fN,skewX:Math.atan(u)*fN,scaleX:s,scaleY:a}}var gm;function pZ(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?NE:y8(t.a,t.b,t.c,t.d,t.e,t.f)}function gZ(e){return e==null||(gm||(gm=document.createElementNS("http://www.w3.org/2000/svg","g")),gm.setAttribute("transform",e),!(e=gm.transform.baseVal.consolidate()))?NE:(e=e.matrix,y8(e.a,e.b,e.c,e.d,e.e,e.f))}function v8(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:$i(l,f)},{i:g-2,x:$i(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function s(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:$i(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:$i(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(i(h)+"scale(",null,",",null,")");p.push({i:g-4,x:$i(l,f)},{i:g-2,x:$i(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),s(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,g=d.length,m;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var mZ=v8(pZ,"px, ","px)","deg)"),yZ=v8(gZ,", ",")",")"),vZ=1e-12;function dN(e){return((e=Math.exp(e))+1/e)/2}function xZ(e){return((e=Math.exp(e))-1/e)/2}function bZ(e){return((e=Math.exp(2*e))-1)/(e+1)}const wZ=function e(t,n,r){function i(o,s){var a=o[0],u=o[1],l=o[2],c=s[0],f=s[1],d=s[2],h=c-a,p=f-u,g=h*h+p*p,m,y;if(g<vZ)y=Math.log(d/l)/t,m=function(E){return[a+E*h,u+E*p,l*Math.exp(t*E*y)]};else{var v=Math.sqrt(g),x=(d*d-l*l+r*g)/(2*l*n*v),b=(d*d-l*l-r*g)/(2*d*n*v),w=Math.log(Math.sqrt(x*x+1)-x),S=Math.log(Math.sqrt(b*b+1)-b);y=(S-w)/t,m=function(E){var _=E*y,k=dN(w),$=l/(n*v)*(k*bZ(t*_+w)-xZ(w));return[a+$*h,u+$*p,l*k/dN(t*_+w)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,u=a*a;return e(s,a,u)},i}(Math.SQRT2,2,4);function x8(e){return function(t,n){var r=e((t=m1(t)).h,(n=m1(n)).h),i=Lt(t.s,n.s),o=Lt(t.l,n.l),s=Lt(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=o(a),t.opacity=s(a),t+""}}}const EZ=x8(Fv);var SZ=x8(Lt);function _Z(e,t){var n=Lt((e=v1(e)).l,(t=v1(t)).l),r=Lt(e.a,t.a),i=Lt(e.b,t.b),o=Lt(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=r(s),e.b=i(s),e.opacity=o(s),e+""}}function b8(e){return function(t,n){var r=e((t=x1(t)).h,(n=x1(n)).h),i=Lt(t.c,n.c),o=Lt(t.l,n.l),s=Lt(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=o(a),t.opacity=s(a),t+""}}}const kZ=b8(Fv);var $Z=b8(Lt);function w8(e){return function t(n){n=+n;function r(i,o){var s=e((i=TE(i)).h,(o=TE(o)).h),a=Lt(i.s,o.s),u=Lt(i.l,o.l),l=Lt(i.opacity,o.opacity);return function(c){return i.h=s(c),i.s=a(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}const CZ=w8(Fv);var AZ=w8(Lt);function X$(e,t){t===void 0&&(t=e,e=Za);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(s){var a=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return o[a](s-a)}}function TZ(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const FZ=Object.freeze(Object.defineProperty({__proto__:null,interpolate:Za,interpolateArray:lZ,interpolateBasis:u8,interpolateBasisClosed:l8,interpolateCubehelix:CZ,interpolateCubehelixLong:AZ,interpolateDate:p8,interpolateDiscrete:dZ,interpolateHcl:kZ,interpolateHclLong:$Z,interpolateHsl:EZ,interpolateHslLong:SZ,interpolateHue:hZ,interpolateLab:_Z,interpolateNumber:$i,interpolateNumberArray:Y$,interpolateObject:g8,interpolateRgb:FE,interpolateRgbBasis:aZ,interpolateRgbBasisClosed:uZ,interpolateRound:sg,interpolateString:m8,interpolateTransformCss:mZ,interpolateTransformSvg:yZ,interpolateZoom:wZ,piecewise:X$,quantize:TZ},Symbol.toStringTag,{value:"Module"}));function MZ(e){return function(){return e}}function OE(e){return+e}var hN=[0,1];function rr(e){return e}function RE(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:MZ(isNaN(t)?NaN:.5)}function NZ(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function OZ(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=RE(i,r),o=n(s,o)):(r=RE(r,i),o=n(o,s)),function(a){return o(r(a))}}function RZ(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=RE(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(a){var u=Aa(e,a,1,r)-1;return o[u](i[u](a))}}function ag(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Mv(){var e=hN,t=hN,n=Za,r,i,o,s=rr,a,u,l;function c(){var d=Math.min(e.length,t.length);return s!==rr&&(s=NZ(e[0],e[d-1])),a=d>2?RZ:OZ,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(u||(u=a(e.map(r),t,n)))(r(s(d)))}return f.invert=function(d){return s(i((l||(l=a(t,e.map(r),$i)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,OE),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=sg,c()},f.clamp=function(d){return arguments.length?(s=d?!0:rr,c()):s!==rr},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return r=d,i=h,c()}}function E8(){return Mv()(rr,rr)}function S8(e,t,n,r){var i=Ta(e,t,n),o;switch(r=sl(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=X6(i,s))&&(r.precision=o),Pk(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Q6(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Y6(i))&&(r.precision=o-(r.type==="%")*2);break}}return sv(r)}function Pl(e){var t=e.domain;return e.ticks=function(n){var r=t();return dE(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return S8(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,s=r[i],a=r[o],u,l,c=10;for(a<s&&(l=s,s=a,a=l,l=i,i=o,o=l);c-- >0;){if(l=hE(s,a,n),l===u)return r[i]=s,r[o]=a,t(r);if(l>0)s=Math.floor(s/l)*l,a=Math.ceil(a/l)*l;else if(l<0)s=Math.ceil(s*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function _8(){var e=E8();return e.copy=function(){return ag(e,_8())},No.apply(e,arguments),Pl(e)}function k8(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,OE),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return k8(e).unknown(t)},e=arguments.length?Array.from(e,OE):[0,1],Pl(n)}function $8(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],s;return o<i&&(s=n,n=r,r=s,s=i,i=o,o=s),e[n]=t.floor(i),e[r]=t.ceil(o),e}function pN(e){return Math.log(e)}function gN(e){return Math.exp(e)}function DZ(e){return-Math.log(-e)}function PZ(e){return-Math.exp(-e)}function LZ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function zZ(e){return e===10?LZ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function IZ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function mN(e){return(t,n)=>-e(-t,n)}function Q$(e){const t=e(pN,gN),n=t.domain;let r=10,i,o;function s(){return i=IZ(r),o=zZ(r),n()[0]<0?(i=mN(i),o=mN(o),e(DZ,PZ)):e(pN,gN),t}return t.base=function(a){return arguments.length?(r=+a,s()):r},t.domain=function(a){return arguments.length?(n(a),s()):n()},t.ticks=a=>{const u=n();let l=u[0],c=u[u.length-1];const f=c<l;f&&([l,c]=[c,l]);let d=i(l),h=i(c),p,g;const m=a==null?10:+a;let y=[];if(!(r%1)&&h-d<m){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1;p<r;++p)if(g=d<0?p/o(-d):p*o(d),!(g<l)){if(g>c)break;y.push(g)}}else for(;d<=h;++d)for(p=r-1;p>=1;--p)if(g=d>0?p/o(-d):p*o(d),!(g<l)){if(g>c)break;y.push(g)}y.length*2<m&&(y=dE(l,c,m))}else y=dE(d,h,Math.min(h-d,m)).map(o);return f?y.reverse():y},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=r===10?"s":","),typeof u!="function"&&(!(r%1)&&(u=sl(u)).precision==null&&(u.trim=!0),u=sv(u)),a===1/0)return u;const l=Math.max(1,r*a/t.ticks().length);return c=>{let f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=()=>n($8(n(),{floor:a=>o(Math.floor(i(a))),ceil:a=>o(Math.ceil(i(a)))})),t}function C8(){const e=Q$(Mv()).domain([1,10]);return e.copy=()=>ag(e,C8()).base(e.base()),No.apply(e,arguments),e}function yN(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function vN(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function K$(e){var t=1,n=e(yN(t),vN(t));return n.constant=function(r){return arguments.length?e(yN(t=+r),vN(t)):t},Pl(n)}function A8(){var e=K$(Mv());return e.copy=function(){return ag(e,A8()).constant(e.constant())},No.apply(e,arguments)}function xN(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function BZ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function jZ(e){return e<0?-e*e:e*e}function J$(e){var t=e(rr,rr),n=1;function r(){return n===1?e(rr,rr):n===.5?e(BZ,jZ):e(xN(n),xN(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Pl(t)}function Z$(){var e=J$(Mv());return e.copy=function(){return ag(e,Z$()).exponent(e.exponent())},No.apply(e,arguments),e}function UZ(){return Z$.apply(null,arguments).exponent(.5)}function T8(){var e=[],t=[],n=[],r;function i(){var s=0,a=Math.max(1,t.length);for(n=new Array(a-1);++s<a;)n[s-1]=U6(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?r:t[Aa(n,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(fs),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(r=s,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return T8().domain(e).range(t).unknown(r)},No.apply(o,arguments)}function F8(){var e=0,t=1,n=1,r=[.5],i=[0,1],o;function s(u){return u!=null&&u<=u?i[Aa(r,u,0,n)]:o}function a(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return s}return s.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},s.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,a()):i.slice()},s.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},s.unknown=function(u){return arguments.length&&(o=u),s},s.thresholds=function(){return r.slice()},s.copy=function(){return F8().domain([e,t]).range(i).unknown(o)},No.apply(Pl(s),arguments)}function M8(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[Aa(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return M8().domain(e).range(t).unknown(n)},No.apply(i,arguments)}function WZ(e){return new Date(e)}function qZ(e){return e instanceof Date?+e:+new Date(+e)}function eC(e,t,n,r,i,o,s,a,u,l){var c=E8(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),v=l("%b %d"),x=l("%B"),b=l("%Y");function w(S){return(u(S)<S?h:a(S)<S?p:s(S)<S?g:o(S)<S?m:r(S)<S?i(S)<S?y:v:n(S)<S?x:b)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,qZ)):d().map(WZ)},c.ticks=function(S){var E=d();return e(E[0],E[E.length-1],S??10)},c.tickFormat=function(S,E){return E==null?w:l(E)},c.nice=function(S){var E=d();return(!S||typeof S.range!="function")&&(S=t(E[0],E[E.length-1],S??10)),S?d($8(E,S)):c},c.copy=function(){return ag(c,eC(e,t,n,r,i,o,s,a,u,l))},c}function HZ(){return No.apply(eC(KY,JY,So,cp,Gf,ds,lv,av,ss,jk).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function GZ(){return No.apply(eC(XY,QY,_o,fp,Vf,wa,cv,uv,ss,Uk).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Nv(){var e=0,t=1,n,r,i,o,s=rr,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:s(i===0?.5:(f=(o(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(s=f,l):s};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,s=f(h,p),l):[s(0),s(1)]}}return l.range=c(Za),l.rangeRound=c(sg),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return o=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function eu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function tC(){var e=Pl(Nv()(rr));return e.copy=function(){return eu(e,tC())},Ka.apply(e,arguments)}function N8(){var e=Q$(Nv()).domain([1,10]);return e.copy=function(){return eu(e,N8()).base(e.base())},Ka.apply(e,arguments)}function O8(){var e=K$(Nv());return e.copy=function(){return eu(e,O8()).constant(e.constant())},Ka.apply(e,arguments)}function nC(){var e=J$(Nv());return e.copy=function(){return eu(e,nC()).exponent(e.exponent())},Ka.apply(e,arguments)}function VZ(){return nC.apply(null,arguments).exponent(.5)}function Ov(){var e=0,t=.5,n=1,r=1,i,o,s,a,u,l=rr,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-o)*(r*g<r*o?a:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),o=c(t=+t),s=c(n=+n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function p(g){return function(m){var y,v,x;return arguments.length?([y,v,x]=m,l=X$(g,[y,v,x]),h):[l(0),l(.5),l(1)]}}return h.range=p(Za),h.rangeRound=p(sg),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,i=g(e),o=g(t),s=g(n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,h}}function R8(){var e=Pl(Ov()(rr));return e.copy=function(){return eu(e,R8())},Ka.apply(e,arguments)}function D8(){var e=Q$(Ov()).domain([.1,1,10]);return e.copy=function(){return eu(e,D8()).base(e.base())},Ka.apply(e,arguments)}function P8(){var e=K$(Ov());return e.copy=function(){return eu(e,P8()).constant(e.constant())},Ka.apply(e,arguments)}function rC(){var e=J$(Ov());return e.copy=function(){return eu(e,rC()).exponent(e.exponent())},Ka.apply(e,arguments)}function YZ(){return rC.apply(null,arguments).exponent(.5)}function iC(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const XZ="identity",ff="linear",Ss="log",ug="pow",lg="sqrt",Rv="symlog",ul="time",ll="utc",vo="sequential",Jf="diverging",df="quantile",Dv="quantize",Pv="threshold",oC="ordinal",DE="point",L8="band",sC="bin-ordinal",Mt="continuous",cg="discrete",fg="discretizing",ci="interpolating",aC="temporal";function QZ(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function KZ(e){return function(t){const n=e.range();let r=t[0],i=t[1],o=-1,s,a,u,l;for(i<r&&(a=r,r=i,i=a),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(o<0&&(o=u),s=u);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[s]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function uC(){const e=q$().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,o,s=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=iC(f,a,u);let g=r[d-0];i=(h-g)/(p||1),s&&(i=Math.floor(i)),g+=(h-g-i*(f-a))*l,o=i*(1-a),s&&(g=Math.round(g),o=Math.round(o));const m=kr(f).map(y=>g+i*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],s=!0,c()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(s=!!f,c()):s},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],m=+f[1],y,v,x;if(!(g!==g||m!==m)&&(m<g&&(x=g,g=m,m=x),!(m<h[0]||g>r[1-d])))return y=Math.max(0,Aa(h,g)-1),v=g===m?y:Aa(h,m)-1,g-h[y]>o+1e-10&&++y,d&&(x=y,y=p-v,v=p-x),y>v?void 0:t().slice(y,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return uC().domain(t()).range(r).round(s).paddingInner(a).paddingOuter(u).align(l)},c()}function z8(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return z8(t())},e}function JZ(){return z8(uC().paddingInner(1))}var ZZ=Array.prototype.map;function eee(e){return ZZ.call(e,mn)}const tee=Array.prototype.slice;function I8(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(Aa(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=eee(r),n):e.slice()},n.range=function(r){return arguments.length?(t=tee.call(r),n):t.slice()},n.tickFormat=function(r,i){return S8(e[0],$e(e),r??10,i)},n.copy=function(){return I8().domain(n.domain()).range(n.range())},n}const b1=new Map,B8=Symbol("vega_scale");function j8(e){return e[B8]=!0,e}function nee(e){return e&&e[B8]===!0}function ree(e,t,n){const r=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?QZ(o):o.invertExtent?KZ(o):void 0),o.type=e,j8(o)};return r.metadata=Bi(Q(n)),r}function Ne(e,t,n){return arguments.length>1?(b1.set(e,ree(e,t,n)),this):U8(e)?b1.get(e):void 0}Ne(XZ,k8);Ne(ff,_8,Mt);Ne(Ss,C8,[Mt,Ss]);Ne(ug,Z$,Mt);Ne(lg,UZ,Mt);Ne(Rv,A8,Mt);Ne(ul,HZ,[Mt,aC]);Ne(ll,GZ,[Mt,aC]);Ne(vo,tC,[Mt,ci]);Ne(`${vo}-${ff}`,tC,[Mt,ci]);Ne(`${vo}-${Ss}`,N8,[Mt,ci,Ss]);Ne(`${vo}-${ug}`,nC,[Mt,ci]);Ne(`${vo}-${lg}`,VZ,[Mt,ci]);Ne(`${vo}-${Rv}`,O8,[Mt,ci]);Ne(`${Jf}-${ff}`,R8,[Mt,ci]);Ne(`${Jf}-${Ss}`,D8,[Mt,ci,Ss]);Ne(`${Jf}-${ug}`,rC,[Mt,ci]);Ne(`${Jf}-${lg}`,YZ,[Mt,ci]);Ne(`${Jf}-${Rv}`,P8,[Mt,ci]);Ne(df,T8,[fg,df]);Ne(Dv,F8,fg);Ne(Pv,M8,fg);Ne(sC,I8,[cg,fg]);Ne(oC,q$,cg);Ne(L8,uC,cg);Ne(DE,JZ,cg);function U8(e){return b1.has(e)}function Ll(e,t){const n=b1.get(e);return n&&n.metadata[t]}function lC(e){return Ll(e,Mt)}function hf(e){return Ll(e,cg)}function PE(e){return Ll(e,fg)}function W8(e){return Ll(e,Ss)}function iee(e){return Ll(e,aC)}function q8(e){return Ll(e,ci)}function H8(e){return Ll(e,df)}const oee=["clamp","base","constant","exponent"];function G8(e,t){const n=t[0],r=$e(t)-n;return function(i){return e(n+i*r)}}function Lv(e,t,n){return X$(cC(t||"rgb",n),e)}function V8(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function Y8(e,t,n){const r=n-t;let i,o,s;return!r||!Number.isFinite(r)?kn(.5):(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),s=Ne(o)().domain([t,n]).range([0,1]),oee.forEach(a=>e[a]?s[a](e[a]()):0),s)}function cC(e,t){const n=FZ[see(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function see(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const aee={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},uee={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function X8(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function Q8(e,t){for(const n in e)fC(n,t(e[n]))}const bN={};Q8(uee,X8);Q8(aee,e=>Lv(X8(e)));function fC(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(bN[e]=t,this):bN[e]}const u0="symbol",lee="discrete",cee="gradient",fee=e=>I(e)?e.map(t=>String(t)):String(e),dee=(e,t)=>e[1]-t[1],hee=(e,t)=>t[1]-e[1];function dC(e,t,n){let r;return Te(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(tg(e.domain())/n||1)+1))),J(t)&&(r=t.step,t=t.interval),K(t)&&(t=e.type===ul?Yf(t):e.type==ll?Xf(t):z("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function K8(e,t,n){let r=e.range(),i=r[0],o=$e(r),s=dee;if(i>o&&(r=o,o=i,i=r,s=hee),i=Math.floor(i),o=Math.ceil(o),t=t.map(a=>[a,e(a)]).filter(a=>i<=a[1]&&a[1]<=o).sort(s).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],$e(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function hC(e,t){return e.bins?K8(e,e.bins):e.ticks?e.ticks(t):e.domain()}function J8(e,t,n,r,i,o){const s=t.type;let a=fee;if(s===ul||i===ul)a=e.timeFormat(r);else if(s===ll||i===ll)a=e.utcFormat(r);else if(W8(s)){const u=e.formatFloat(r);if(o||t.bins)a=u;else{const l=Z8(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(a=e.format(r));return a}function Z8(e,t,n){const r=hC(e,t),i=e.base(),o=Math.log(i),s=Math.max(1,i*t/r.length),a=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/o));return l*i<i-.5&&(l*=i),l<=s};return n?r.filter(a):a}const LE={[df]:"quantiles",[Dv]:"thresholds",[Pv]:"domain"},eI={[df]:"quantiles",[Dv]:"domain"};function tI(e,t){return e.bins?mee(e.bins):e.type===Ss?Z8(e,t,!0):LE[e.type]?gee(e[LE[e.type]]()):hC(e,t)}function pee(e,t,n){const r=t[eI[t.type]](),i=r.length;let o=i>1?r[1]-r[0]:r[0],s;for(s=1;s<i;++s)o=Math.min(o,r[s]-r[s-1]);return e.formatSpan(0,o,3*10,n)}function gee(e){const t=[-1/0].concat(e);return t.max=1/0,t}function mee(e){const t=e.slice(0,-1);return t.max=$e(e),t}const yee=e=>LE[e.type]||e.bins;function nI(e,t,n,r,i,o,s){const a=eI[t.type]&&o!==ul&&o!==ll?pee(e,t,i):J8(e,t,n,i,o,s);return r===u0&&yee(t)?vee(a):r===lee?xee(a):bee(a)}const vee=e=>(t,n,r)=>{const i=wN(r[n+1],wN(r.max,1/0)),o=EN(t,e),s=EN(i,e);return o&&s?o+"  "+s:s?"< "+s:" "+o},wN=(e,t)=>e??t,xee=e=>(t,n)=>n?e(t):null,bee=e=>t=>e(t),EN=(e,t)=>Number.isFinite(e)?t(e):null;function wee(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+$e(t),o=i-r;if(e.type===Pv){const s=n?o/n:.1;r-=s,i+=s,o=i-r}return s=>(s-r)/o}function Eee(e,t,n,r){const i=r||t.type;return K(n)&&iee(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===ul?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===ll?e.utcFormat("%A, %d %B %Y, %X UTC"):nI(e,t,5,null,n,r,!0)}function rI(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=Eee(e,t,n.format,n.formatType);if(PE(t.type)){const o=tI(t).slice(1).map(i),s=o.length;return`${s} boundar${s===1?"y":"ies"}: ${o.join(", ")}`}else if(hf(t.type)){const o=t.domain(),s=o.length,a=s>r?o.slice(0,r-2).map(i).join(", ")+", ending with "+o.slice(-1).map(i):o.map(i).join(", ");return`${s} value${s===1?"":"s"}: ${a}`}else{const o=t.domain();return`values from ${i(o[0])} to ${i($e(o))}`}}let iI=0;function See(){iI=0}const w1="p_";function pC(e){return e&&e.gradient}function oI(e,t,n){const r=e.gradient;let i=e.id,o=r==="radial"?w1:"";return i||(i=e.id="gradient_"+iI++,r==="radial"?(e.x1=to(e.x1,.5),e.y1=to(e.y1,.5),e.r1=to(e.r1,0),e.x2=to(e.x2,.5),e.y2=to(e.y2,.5),e.r2=to(e.r2,.5),o=w1):(e.x1=to(e.x1,0),e.y1=to(e.y1,0),e.x2=to(e.x2,1),e.y2=to(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function to(e,t){return e??t}function sI(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,o){return n.push({offset:i,color:o}),r}}}const SN={basis:{curve:AJ},"basis-closed":{curve:TJ},"basis-open":{curve:FJ},bundle:{curve:MJ,tension:"beta",value:.85},cardinal:{curve:NJ,tension:"tension",value:0},"cardinal-open":{curve:RJ,tension:"tension",value:0},"cardinal-closed":{curve:OJ,tension:"tension",value:0},"catmull-rom":{curve:DJ,tension:"alpha",value:.5},"catmull-rom-closed":{curve:PJ,tension:"alpha",value:.5},"catmull-rom-open":{curve:LJ,tension:"alpha",value:.5},linear:{curve:I$},"linear-closed":{curve:zJ},monotone:{horizontal:BJ,vertical:IJ},natural:{curve:jJ},step:{curve:UJ},"step-after":{curve:qJ},"step-before":{curve:WJ}};function gC(e,t,n){var r=ae(SN,e)&&SN[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const _ee={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},kee=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,$ee=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Cee=/^((\s+,?\s*)|(,\s*))/,Aee=/^[01]/;function pf(e){const t=[];return(e.match(kee)||[]).forEach(r=>{let i=r[0];const o=i.toLowerCase(),s=_ee[o],a=Tee(o,s,r.slice(1).trim()),u=a.length;if(u<s||u&&u%s!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...a.slice(0,s)]),u!==s){o==="m"&&(i=i==="M"?"L":"l");for(let l=s;l<u;l+=s)t.push([i,...a.slice(l,l+s)])}}),t}function Tee(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let o=0;o<t;++o){const s=e==="a"&&(o===3||o===4)?Aee:$ee,a=n.slice(i).match(s);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const u=n.slice(i).match(Cee);u!==null&&(i+=u[0].length)}return r}const Oa=Math.PI/180,Fee=1e-14,Fu=Math.PI/2,lo=Math.PI*2,Jl=Math.sqrt(3)/2;var ib={},ob={},aI=[].join;function Mee(e,t,n,r,i,o,s,a,u){const l=aI.call(arguments);if(ib[l])return ib[l];const c=s*Oa,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(a-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(a-e)*.5;let g=h*h/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,y=f/n,v=-f/r,x=d/r,b=m*a+y*u,w=v*a+x*u,S=m*e+y*t,E=v*e+x*t;let k=1/((S-b)*(S-b)+(E-w)*(E-w))-.25;k<0&&(k=0);let $=Math.sqrt(k);o==i&&($=-$);const C=.5*(b+S)-$*(E-w),R=.5*(w+E)+$*(S-b),A=Math.atan2(w-R,b-C);let T=Math.atan2(E-R,S-C)-A;T<0&&o===1?T+=lo:T>0&&o===0&&(T-=lo);const M=Math.ceil(Math.abs(T/(Fu+.001))),P=[];for(let N=0;N<M;++N){const O=A+N*T/M,j=A+(N+1)*T/M;P[N]=[C,R,O,j,n,r,f,d]}return ib[l]=P}function Nee(e){const t=aI.call(e);if(ob[t])return ob[t];var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7];const c=l*s,f=-u*a,d=u*s,h=l*a,p=Math.cos(i),g=Math.sin(i),m=Math.cos(o),y=Math.sin(o),v=.5*(o-i),x=Math.sin(v*.5),b=8/3*x*x/Math.sin(v),w=n+p-b*g,S=r+g+b*p,E=n+m,_=r+y,k=E+b*y,$=_-b*m;return ob[t]=[c*w+f*S,d*w+h*S,c*k+f*$,d*k+h*$,c*E+f*_,d*E+h*_]}const Br=["l",0,0,0,0,0,0,0];function Oee(e,t,n){const r=Br[0]=e[0];if(r==="a"||r==="A")Br[1]=t*e[1],Br[2]=n*e[2],Br[3]=e[3],Br[4]=e[4],Br[5]=e[5],Br[6]=t*e[6],Br[7]=n*e[7];else if(r==="h"||r==="H")Br[1]=t*e[1];else if(r==="v"||r==="V")Br[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)Br[i]=(i%2==1?t:n)*e[i];return Br}function vp(e,t,n,r,i,o){var s,a=null,u=0,l=0,c=0,f=0,d,h,p,g,m=0,y=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),o==null&&(o=i),e.beginPath&&e.beginPath();for(var v=0,x=t.length;v<x;++v){switch(s=t[v],(i!==1||o!==1)&&(s=Oee(s,i,o)),s[0]){case"l":u+=s[1],l+=s[2],e.lineTo(u+n,l+r);break;case"L":u=s[1],l=s[2],e.lineTo(u+n,l+r);break;case"h":u+=s[1],e.lineTo(u+n,l+r);break;case"H":u=s[1],e.lineTo(u+n,l+r);break;case"v":l+=s[1],e.lineTo(u+n,l+r);break;case"V":l=s[1],e.lineTo(u+n,l+r);break;case"m":u+=s[1],l+=s[2],m=u,y=l,e.moveTo(u+n,l+r);break;case"M":u=s[1],l=s[2],m=u,y=l,e.moveTo(u+n,l+r);break;case"c":d=u+s[5],h=l+s[6],c=u+s[3],f=l+s[4],e.bezierCurveTo(u+s[1]+n,l+s[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=s[5],l=s[6],c=s[3],f=s[4],e.bezierCurveTo(s[1]+n,s[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+s[3],h=l+s[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+s[1]+n,l+s[2]+r,d+n,h+r),c=u+s[1],f=l+s[2],u=d,l=h;break;case"S":d=s[3],h=s[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,s[1]+n,s[2]+r,d+n,h+r),u=d,l=h,c=s[1],f=s[2];break;case"q":d=u+s[3],h=l+s[4],c=u+s[1],f=l+s[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=s[3],h=s[4],e.quadraticCurveTo(s[1]+n,s[2]+r,d+n,h+r),u=d,l=h,c=s[1],f=s[2];break;case"t":d=u+s[1],h=l+s[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-p,f=2*l-g):a[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+s[1],f=l+s[2];break;case"T":d=s[1],h=s[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":_N(e,u+n,l+r,[s[1],s[2],s[3],s[4],s[5],s[6]+u+n,s[7]+l+r]),u+=s[6],l+=s[7];break;case"A":_N(e,u+n,l+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),u=s[6],l=s[7];break;case"z":case"Z":u=m,l=y,e.closePath();break}a=s}}function _N(e,t,n,r){const i=Mee(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){const s=Nee(i[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}const kN=.5773502691896257,$N={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,lo)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jl*n,i=r-n*kN,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jl*n,i=r-n*kN;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jl*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jl*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jl*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Jl*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function uI(e){return ae($N,e)?$N[e]:Ree(e)}var sb={};function Ree(e){if(!ae(sb,e)){const t=pf(e);sb[e]={draw:function(n,r){vp(n,t,0,0,Math.sqrt(r)/2)}}}return sb[e]}const zs=.448084975506;function Dee(e){return e.x}function Pee(e){return e.y}function Lee(e){return e.width}function zee(e){return e.height}function Wo(e){return typeof e=="function"?e:()=>+e}function mm(e,t,n){return Math.max(t,Math.min(e,n))}function lI(){var e=Dee,t=Pee,n=Lee,r=zee,i=Wo(0),o=i,s=i,a=i,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),m=+n.call(this,c),y=+r.call(this,c),v=Math.min(m,y)/2,x=mm(+i.call(this,c),0,v),b=mm(+o.call(this,c),0,v),w=mm(+s.call(this,c),0,v),S=mm(+a.call(this,c),0,v);if(u||(u=h=_v()),x<=0&&b<=0&&w<=0&&S<=0)u.rect(p,g,m,y);else{var E=p+m,_=g+y;u.moveTo(p+x,g),u.lineTo(E-b,g),u.bezierCurveTo(E-zs*b,g,E,g+zs*b,E,g+b),u.lineTo(E,_-S),u.bezierCurveTo(E,_-zs*S,E-zs*S,_,E-S,_),u.lineTo(p+w,_),u.bezierCurveTo(p+zs*w,_,p,_-zs*w,p,_-w),u.lineTo(p,g+x),u.bezierCurveTo(p,g+zs*x,p+zs*x,g,p+x,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=Wo(c),l):e},l.y=function(c){return arguments.length?(t=Wo(c),l):t},l.width=function(c){return arguments.length?(n=Wo(c),l):n},l.height=function(c){return arguments.length?(r=Wo(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=Wo(c),o=f!=null?Wo(f):i,a=d!=null?Wo(d):i,s=h!=null?Wo(h):o,l):i},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function cI(){var e,t,n,r,i=null,o,s,a,u;function l(f,d,h){const p=h/2;if(o){var g=a-d,m=f-s;if(g||m){var y=Math.hypot(g,m),v=(g/=y)*u,x=(m/=y)*u,b=Math.atan2(m,g);i.moveTo(s-v,a-x),i.lineTo(f-g*p,d-m*p),i.arc(f,d,p,b-Math.PI,b),i.lineTo(s+v,a+x),i.arc(s,a,u,b,b+Math.PI)}else i.arc(f,d,p,0,lo);i.closePath()}else o=1;s=f,a=d,u=p}function c(f){var d,h=f.length,p,g=!1,m;for(i==null&&(i=m=_v()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===g&&(g=!g)&&(o=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function dg(e,t){return e??t}const hg=e=>e.x||0,pg=e=>e.y||0,Iee=e=>e.width||0,Bee=e=>e.height||0,jee=e=>(e.x||0)+(e.width||0),Uee=e=>(e.y||0)+(e.height||0),Wee=e=>e.startAngle||0,qee=e=>e.endAngle||0,Hee=e=>e.padAngle||0,Gee=e=>e.innerRadius||0,Vee=e=>e.outerRadius||0,Yee=e=>e.cornerRadius||0,Xee=e=>dg(e.cornerRadiusTopLeft,e.cornerRadius)||0,Qee=e=>dg(e.cornerRadiusTopRight,e.cornerRadius)||0,Kee=e=>dg(e.cornerRadiusBottomRight,e.cornerRadius)||0,Jee=e=>dg(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Zee=e=>dg(e.size,64),ete=e=>e.size||1,zv=e=>e.defined!==!1,tte=e=>uI(e.shape||"circle"),nte=kJ().startAngle(Wee).endAngle(qee).padAngle(Hee).innerRadius(Gee).outerRadius(Vee).cornerRadius(Yee),rte=Iz().x(hg).y1(pg).y0(Uee).defined(zv),ite=Iz().y(pg).x1(hg).x0(jee).defined(zv),ote=zz().x(hg).y(pg).defined(zv),ste=lI().x(hg).y(pg).width(Iee).height(Bee).cornerRadius(Xee,Qee,Kee,Jee),ate=CJ().type(tte).size(Zee),ute=cI().x(hg).y(pg).defined(zv).size(ete);function mC(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function lte(e,t){return nte.context(e)(t)}function cte(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?ite:rte).curve(gC(r,n.orient,n.tension)).context(e)(t)}function fte(e,t){const n=t[0],r=n.interpolate||"linear";return ote.curve(gC(r,n.orient,n.tension)).context(e)(t)}function Zf(e,t,n,r){return ste.context(e)(t,n,r)}function dte(e,t){return(t.mark.shape||t.shape).context(e)(t)}function hte(e,t){return ate.context(e)(t)}function pte(e,t){return ute.context(e)(t)}var fI=1;function dI(){fI=1}function yC(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+fI++),s=i.clipping[o]||(i.clipping[o]={id:o});return ge(r)?s.path=r(null):mC(n)?s.path=Zf(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function Et(e){this.clear(),e&&this.union(e)}Et.prototype={clone(){return new Et(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*r-u*i+l,u*r+a*i+c,a*r-u*s+l,u*r+a*s+c,a*o-u*i+l,u*o+a*i+c,a*o-u*s+l,u*o+a*s+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Iv(e){this.mark=e,this.bounds=this.bounds||new Et}function Bv(e){Iv.call(this,e),this.items=this.items||[]}G(Bv,Iv);function vC(e){this._pending=0,this._loader=e||dv()}function CN(e){e._pending+=1}function Td(e){e._pending-=1}vC.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return CN(t),t._loader.sanitize(e,{context:"href"}).then(n=>(Td(t),n)).catch(()=>(Td(t),null))},loadImage(e){const t=this,n=HJ();return CN(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const o=new n,s=ae(r,"crossOrigin")?r.crossOrigin:"anonymous";return s!=null&&(o.crossOrigin=s),o.onload=()=>Td(t),o.onerror=()=>Td(t),o.src=i,o}).catch(r=>(Td(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function As(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?gte(t,r):0))}return e}function gte(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const mte=lo-1e-8;let jv,l0,c0,Bu,zE,f0,IE,BE;const na=(e,t)=>jv.add(e,t),d0=(e,t)=>na(l0=e,c0=t),AN=e=>na(e,jv.y1),TN=e=>na(jv.x1,e),Mu=(e,t)=>zE*e+IE*t,Nu=(e,t)=>f0*e+BE*t,ab=(e,t)=>na(Mu(e,t),Nu(e,t)),ub=(e,t)=>d0(Mu(e,t),Nu(e,t));function gg(e,t){return jv=e,t?(Bu=t*Oa,zE=BE=Math.cos(Bu),f0=Math.sin(Bu),IE=-f0):(zE=BE=1,Bu=f0=IE=0),yte}const yte={beginPath(){},closePath(){},moveTo:ub,lineTo:ub,rect(e,t,n,r){Bu?(ab(e+n,t),ab(e+n,t+r),ab(e,t+r),ub(e,t)):(na(e+n,t+r),d0(e,t))},quadraticCurveTo(e,t,n,r){const i=Mu(e,t),o=Nu(e,t),s=Mu(n,r),a=Nu(n,r);FN(l0,i,s,AN),FN(c0,o,a,TN),d0(s,a)},bezierCurveTo(e,t,n,r,i,o){const s=Mu(e,t),a=Nu(e,t),u=Mu(n,r),l=Nu(n,r),c=Mu(i,o),f=Nu(i,o);MN(l0,s,u,c,AN),MN(c0,a,l,f,TN),d0(c,f)},arc(e,t,n,r,i,o){if(r+=Bu,i+=Bu,l0=n*Math.cos(i)+e,c0=n*Math.sin(i)+t,Math.abs(i-r)>mte)na(e-n,t-n),na(e+n,t+n);else{const s=l=>na(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(s(r),s(i),i!==r)if(r=r%lo,r<0&&(r+=lo),i=i%lo,i<0&&(i+=lo),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=lo,a=r-r%Fu,u=0;u<4&&a>i;++u,a-=Fu)s(a);else for(a=r-r%Fu+Fu,u=0;u<4&&a<i;++u,a=a+Fu)s(a)}}};function FN(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function MN(e,t,n,r,i){const o=r-e+3*t-3*n,s=e+n-2*t,a=e-t;let u=0,l=0,c;Math.abs(o)>Fee?(c=s*s+a*o,c>=0&&(c=Math.sqrt(c),u=(-s+c)/o,l=(-s-c)/o)):u=.5*a/s,0<u&&u<1&&i(NN(u,e,t,n,r)),0<l&&l<1&&i(NN(l,e,t,n,r))}function NN(e,t,n,r,i){const o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*r+a*e*i}var _a=(_a=Sa(1,1))?_a.getContext("2d"):null;const jE=new Et;function xC(e){return function(t,n){if(!_a)return!0;e(_a,t),jE.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:s}=jE;for(let a=i;a<=s;++a)for(let u=r;u<=o;++u)if(_a.isPointInPath(u,a))return!0;return!1}}function bC(e,t){return t.contains(e.x||0,e.y||0)}function hI(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(jE.set(n,r,n+i,r+o))}function pI(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:r;return $c(t,n,r,i,o)}function $c(e,t,n,r,i){const{x1:o,y1:s,x2:a,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,p,g,m;for(m=0;m<4;++m){if(m===0&&(h=-l,p=-(o-t)),m===1&&(h=l,p=a-t),m===2&&(h=-c,p=-(s-n)),m===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function gf(e,t){e.globalCompositeOperation=t.blend||"source-over"}function mi(e,t){return e??t}function ON(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function vte(e,t,n){const r=n.width(),i=n.height();let o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+mi(t.x1,.5)*r,n.y1+mi(t.y1,.5)*i,Math.max(r,i)*mi(t.r1,0),n.x1+mi(t.x2,.5)*r,n.y1+mi(t.y2,.5)*i,Math.max(r,i)*mi(t.r2,.5));else{const s=mi(t.x1,0),a=mi(t.y1,0),u=mi(t.x2,1),l=mi(t.y2,0);if(s===u||a===l||r===i)o=e.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+u*r,n.y1+l*i);else{const c=Sa(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=ON(f.createLinearGradient(s,a,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return ON(o,t.stops)}function gI(e,t,n){return pC(n)?vte(e,n,t.bounds):n}function E1(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=gI(e,t,t.fill),!0):!1}var xte=[];function mf(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=gI(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||xte),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function bte(e,t){return e.zindex-t.zindex||e.index-t.index}function wC(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,o;for(i=0,o=t.length;i<o;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(bte)}function Ui(e,t){var n=e.items,r,i;if(!n||!n.length)return;const o=wC(e);if(o&&o.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=o}for(r=0,i=n.length;r<i;++r)t(n[r])}function S1(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const o=wC(e);for(o&&o.length&&(n=o),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===o){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function EC(e){return function(t,n,r){Ui(n,i=>{(!r||r.intersects(i.bounds))&&mI(e,t,i,i)})}}function wte(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&mI(e,t,n.items[0],n.items)}}function mI(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(gf(t,n),n.fill&&E1(t,n,i)&&t.fill(),n.stroke&&mf(t,n,i)&&t.stroke()))}function Uv(e){return e=e||ii,function(t,n,r,i,o,s){return r*=t.pixelRatio,i*=t.pixelRatio,S1(n,a=>{const u=a.bounds;if(!(u&&!u.contains(o,s)||!u)&&e(t,a,r,i,o,s))return a})}}function mg(e,t){return function(n,r,i,o){var s=Array.isArray(r)?r[0]:r,a=t??s.fill,u=s.stroke&&n.isPointInStroke,l,c;return u&&(l=s.strokeWidth,c=s.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:a&&n.isPointInPath(i,o)||u&&n.isPointInStroke(i,o)}}function SC(e){return Uv(mg(e))}function Xu(e,t){return"translate("+e+","+t+")"}function _C(e){return"rotate("+e+")"}function Ete(e,t){return"scale("+e+","+t+")"}function yI(e){return Xu(e.x||0,e.y||0)}function Ste(e){return Xu(e.x||0,e.y||0)+(e.angle?" "+_C(e.angle):"")}function _te(e){return Xu(e.x||0,e.y||0)+(e.angle?" "+_C(e.angle):"")+(e.scaleX||e.scaleY?" "+Ete(e.scaleX||1,e.scaleY||1):"")}function kC(e,t,n){function r(s,a){s("transform",Ste(a)),s("d",t(null,a))}function i(s,a){return t(gg(s,a.angle),a),As(s,a).translate(a.x||0,a.y||0)}function o(s,a){var u=a.x||0,l=a.y||0,c=a.angle||0;s.translate(u,l),c&&s.rotate(c*=Oa),s.beginPath(),t(s,a),c&&s.rotate(-c),s.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:EC(o),pick:SC(o),isect:n||xC(o)}}var kte=kC("arc",lte);function $te(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,o=1/0,s,a;--i>=0;)e[i].defined!==!1&&(a=Math.abs(e[i][r]-n),a<o&&(o=a,s=e[i]));return s}function Cte(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,o,s;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],o=e[r].y-t[1],s=i*i+o*o,s<n))return e[r];return null}function Ate(e,t){for(var n=e.length,r,i,o;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],o=r*r+i*i,r=e[n].size||1,o<r*r))return e[n];return null}function $C(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(gg(u),c),As(u,c[0]))}function o(u,l){u.beginPath(),t(u,l)}const s=mg(o);function a(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,s(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:wte(o),pick:a,isect:bC,tip:n}}var Tte=$C("area",cte,$te);function Fte(e,t){var n=t.clip;e.save(),ge(n)?(e.beginPath(),n(e),e.clip()):vI(e,t.group)}function vI(e,t){e.beginPath(),mC(t)?Zf(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function xI(e){const t=mi(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Mte(e,t){e("transform",yI(t))}function bI(e,t){const n=xI(t);e("d",Zf(null,t,n,n))}function Nte(e,t){e("class","background"),e("aria-hidden",!0),bI(e,t)}function Ote(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?bI(e,t):e("d","")}function Rte(e,t,n){const r=t.clip?yC(n,t,t):null;e("clip-path",r)}function Dte(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),As(e,t),e.translate(t.x||0,t.y||0)}function xp(e,t,n,r){const i=xI(t);e.beginPath(),Zf(e,t,(n||0)+i,(r||0)+i)}const Pte=mg(xp),Lte=mg(xp,!1),zte=mg(xp,!0);function Ite(e,t,n,r){Ui(t,i=>{const o=i.x||0,s=i.y||0,a=i.strokeForeground,u=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&u&&(xp(e,i,o,s),gf(e,i),i.fill&&E1(e,i,u)&&e.fill(),i.stroke&&!a&&mf(e,i,u)&&e.stroke()),e.save(),e.translate(o,s),i.clip&&vI(e,i),n&&n.translate(-o,-s),Ui(i,l=>{(l.marktype==="group"||r==null||r.includes(l.marktype))&&this.draw(e,l,n,r)}),n&&n.translate(o,s),e.restore(),a&&i.stroke&&u&&(xp(e,i,o,s),gf(e,i),mf(e,i,u)&&e.stroke())})}function Bte(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const s=n*e.pixelRatio,a=r*e.pixelRatio;return S1(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,o))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(i<c||i>h||o<f||o>p))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,g&&mC(u)&&!zte(e,u,s,a))return e.restore(),null;const m=u.strokeForeground,y=t.interactive!==!1;return y&&m&&u.stroke&&Lte(e,u,s,a)?(e.restore(),u):(l=S1(u,v=>jte(v,c,f)?this.pick(v,n,r,c,f):null),!l&&y&&(u.fill||!m&&u.stroke)&&Pte(e,u,s,a)&&(l=u),e.restore(),l||null)})}function jte(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Ute={type:"group",tag:"g",nested:!1,attr:Mte,bound:Dte,draw:Ite,pick:Bte,isect:hI,content:Rte,background:Nte,foreground:Ote},bp={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function CC(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function AC(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function TC(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function Wv(e,t){return e==="center"?t/2:e==="right"?t:0}function qv(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function Wte(e,t,n){const r=CC(t,n),i=AC(t,r),o=TC(t,r),s=(t.x||0)-Wv(t.align,i),a=(t.y||0)-qv(t.baseline,o),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,bp["xmlns:xlink"],"xlink:href"),e("transform",Xu(s,a)),e("width",i),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function qte(e,t){const n=t.image,r=AC(t,n),i=TC(t,n),o=(t.x||0)-Wv(t.align,r),s=(t.y||0)-qv(t.baseline,i);return e.set(o,s,o+r,s+i)}function Hte(e,t,n){Ui(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=CC(r,this);let o=AC(r,i),s=TC(r,i);if(o===0||s===0)return;let a=(r.x||0)-Wv(r.align,o),u=(r.y||0)-qv(r.baseline,s),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,u+=(s-d)/2,s=d):(d=s*c,a+=(o-d)/2,o=d))),(i.complete||i.toDataURL)&&(gf(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,a,u,o,s))})}var Gte={type:"image",tag:"image",nested:!1,attr:Wte,bound:qte,draw:Hte,pick:Uv(),isect:ii,get:CC,xOffset:Wv,yOffset:qv},Vte=$C("line",fte,Cte);function Yte(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",_te(t)),e("d",t.path)}function h0(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*Oa,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=pf(n)).path=n),a&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(a),vp(e,u,0,0,o,s),e.rotate(-a),e.translate(-r,-i)):vp(e,u,r,i,o,s)}function Xte(e,t){return h0(gg(e,t.angle),t)?e.set(0,0,0,0):As(e,t,!0)}var Qte={type:"path",tag:"path",nested:!1,attr:Yte,bound:Xte,draw:EC(h0),pick:SC(h0),isect:xC(h0)};function Kte(e,t){e("d",Zf(null,t))}function Jte(e,t){var n,r;return As(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function RN(e,t){e.beginPath(),Zf(e,t)}var Zte={type:"rect",tag:"path",nested:!1,attr:Kte,bound:Jte,draw:EC(RN),pick:SC(RN),isect:hI};function ene(e,t){e("transform",yI(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function tne(e,t){var n,r;return As(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function wI(e,t,n){var r,i,o,s;return t.stroke&&mf(e,t,n)?(r=t.x||0,i=t.y||0,o=t.x2!=null?t.x2:r,s=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,s),!0):!1}function nne(e,t,n){Ui(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&wI(e,r,i)&&(gf(e,r),e.stroke())}})}function rne(e,t,n,r){return e.isPointInStroke?wI(e,t,1)&&e.isPointInStroke(n,r):!1}var ine={type:"rule",tag:"line",nested:!1,attr:ene,bound:tne,draw:nne,pick:Uv(rne),isect:pI},one=kC("shape",dte),sne=kC("symbol",hte,bC);const DN=T6();var Ar={height:Oo,measureWidth:FC,estimateWidth:_1,width:_1,canvas:EI};EI(!0);function EI(e){Ar.width=e&&_a?FC:_1}function _1(e,t){return SI(Da(e,t),Oo(e))}function SI(e,t){return~~(.8*e.length*t)}function FC(e,t){return Oo(e)<=0||!(t=Da(e,t))?0:_I(t,Hv(e))}function _I(e,t){const n=`(${t}) ${e}`;let r=DN.get(n);return r===void 0&&(_a.font=t,r=_a.measureText(e).width,DN.set(n,r)),r}function Oo(e){return e.fontSize!=null?+e.fontSize||0:11}function Ra(e){return e.lineHeight!=null?e.lineHeight:Oo(e)+2}function ane(e){return I(e)?e.length>1?e:e[0]:e}function yg(e){return ane(e.lineBreak&&e.text&&!I(e.text)?e.text.split(e.lineBreak):e.text)}function MC(e){const t=yg(e);return(I(t)?t.length-1:0)*Ra(e)}function Da(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?lne(e,n):n}function une(e){if(Ar.width===FC){const t=Hv(e);return n=>_I(n,t)}else if(Ar.width===_1){const t=Oo(e);return n=>SI(n,t)}else return t=>Ar.width(e,t)}function lne(e,t){var n=+e.limit,r=une(e);if(r(t)<n)return t;var i=e.ellipsis||"",o=e.dir==="rtl",s=0,a=t.length,u;if(n-=r(i),o){for(;s<a;)u=s+a>>>1,r(t.slice(u))>n?s=u+1:a=u;return i+t.slice(s)}else{for(;s<a;)u=1+(s+a>>>1),r(t.slice(0,u))<n?s=u:a=u-1;return t.slice(0,s)+i}}function vg(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Hv(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Oo(e)+"px "+vg(e,t)}function NC(e){var t=e.baseline,n=Oo(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Ra(e):t==="line-bottom"?.29*n-.5*Ra(e):0)}const cne={left:"start",center:"middle",right:"end"},Mh=new Et;function Gv(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-Fu,t+=r*Math.cos(i),n+=r*Math.sin(i)),Mh.x1=t,Mh.y1=n,Mh}function fne(e,t){var n=t.dx||0,r=(t.dy||0)+NC(t),i=Gv(t),o=i.x1,s=i.y1,a=t.angle||0,u;e("text-anchor",cne[t.align]||"start"),a?(u=Xu(o,s)+" "+_C(a),(n||r)&&(u+=" "+Xu(n,r))):u=Xu(o+n,s+r),e("transform",u)}function OC(e,t,n){var r=Ar.height(t),i=t.align,o=Gv(t),s=o.x1,a=o.y1,u=t.dx||0,l=(t.dy||0)+NC(t)-Math.round(.8*r),c=yg(t),f;if(I(c)?(r+=Ra(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Ar.width(t,h)),0)):f=Ar.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=s,l+=a,u+f,l+r),t.angle&&!n)e.rotate(t.angle*Oa,s,a);else if(n===2)return e.rotatedPoints(t.angle*Oa,s,a);return e}function dne(e,t,n){Ui(t,r=>{var i=r.opacity==null?1:r.opacity,o,s,a,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=Hv(r),e.textAlign=r.align||"left",o=Gv(r),s=o.x1,a=o.y1,r.angle&&(e.save(),e.translate(s,a),e.rotate(r.angle*Oa),s=a=0),s+=r.dx||0,a+=(r.dy||0)+NC(r),c=yg(r),gf(e,r),I(c))for(l=Ra(r),u=0;u<c.length;++u)f=Da(r,c[u]),r.fill&&E1(e,r,i)&&e.fillText(f,s,a),r.stroke&&mf(e,r,i)&&e.strokeText(f,s,a),a+=l;else f=Da(r,c),r.fill&&E1(e,r,i)&&e.fillText(f,s,a),r.stroke&&mf(e,r,i)&&e.strokeText(f,s,a);r.angle&&e.restore()}})}function hne(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=Gv(t),a=s.x1,u=s.y1,l=OC(Mh,t,1),c=-t.angle*Oa,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(a-f*a+d*u),p=d*i+f*o+(u-d*a-f*u);return l.contains(h,p)}function pne(e,t){const n=OC(Mh,e,2);return $c(t,n[0],n[1],n[2],n[3])||$c(t,n[0],n[1],n[4],n[5])||$c(t,n[4],n[5],n[6],n[7])||$c(t,n[2],n[3],n[6],n[7])}var gne={type:"text",tag:"text",nested:!1,attr:fne,bound:OC,draw:dne,pick:Uv(hne),isect:pne},mne=$C("trail",pte,Ate),Rr={arc:kte,area:Tte,group:Ute,image:Gte,line:Vte,path:Qte,rect:Zte,rule:ine,shape:one,symbol:sne,text:gne,trail:mne};function UE(e,t,n){var r=Rr[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Et),e,n)}var PN={mark:null};function kI(e,t,n){var r=Rr[e.marktype],i=r.bound,o=e.items,s=o&&o.length,a,u,l,c;if(r.nested)return s?l=o[0]:(PN.mark=e,l=PN),c=UE(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Et,s)for(a=0,u=o.length;a<u;++a)t.union(UE(o[a],i,n));return e.bounds=t}const yne=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function $I(e,t){return JSON.stringify(e,yne,t)}function CI(e){const t=typeof e=="string"?JSON.parse(e):e;return AI(t)}function AI(e){var t=e.marktype,n=e.items,r,i,o;if(n)for(i=0,o=n.length;i<o;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&AI(n[i]);return t&&kI(e),e}function RC(e){arguments.length?this.root=CI(e):(this.root=TI({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Bv(this.root)])}RC.prototype={toJSON(e){return $I(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=TI(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function TI(e,t){const n={bounds:new Et,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function ra(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function DC(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function kt(e,t,n,r){var i=e.childNodes[t],o;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(o=i||null,i=ra(e.ownerDocument,n,r),e.insertBefore(i,o)),i}function Hr(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function FI(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Vv(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function vne(e,t,n,r){var i=e&&e.mark,o,s;if(i&&(o=Rr[i.marktype]).tip){for(s=Vv(t,n),s[0]-=r[0],s[1]-=r[1];e=e.mark.group;)s[0]-=e.x||0,s[1]-=e.y||0;e=o.tip(i.items,s)}return e}function Pa(e,t){this._active=null,this._handlers={},this._loader=e||dv(),this._tooltip=t||xne}function xne(e,t,n,r){e.element().setAttribute("title",r||"")}Pa.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),o=ra(null,"a");for(const s in r)o.setAttribute(s,r[s]);o.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=vne(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),s=i.height();let a=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,u+=e.y||0;return{x:a,y:u,width:o,height:s,left:a,top:u,right:a+o,bottom:u+s}}};function Ir(e){this._el=null,this._bgcolor=null,this._loader=new vC(e)}Ir.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e,t){const n=this;return n._call=function(){n._render(e,t)},n._call(),n._call=null,n},_render(){},renderAsync(e,t){const n=this.render(e,t);return this._ready?this._ready.then(()=>n):Promise.resolve(n)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(o=>{o&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const bne="keydown",wne="keypress",Ene="keyup",MI="dragenter",p0="dragleave",NI="dragover",WE="pointerdown",Sne="pointerup",k1="pointermove",Nh="pointerout",OI="pointerover",qE="mousedown",_ne="mouseup",RI="mousemove",HE="mouseout",DI="mouseover",$1="click",kne="dblclick",$ne="wheel",PI="mousewheel",C1="touchstart",A1="touchmove",T1="touchend",Cne=[bne,wne,Ene,MI,p0,NI,WE,Sne,k1,Nh,OI,qE,_ne,RI,HE,DI,$1,kne,$ne,PI,C1,A1,T1],GE=k1,wp=Nh,VE=$1;function La(e,t){Pa.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const Ane=e=>e===C1||e===A1||e===T1?[C1,A1,T1]:[e];function LN(e,t){Ane(t).forEach(n=>Tne(e,n))}function Tne(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function ih(e,t,n){t.forEach(r=>e.fire(r,n))}function zN(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i?ih(this,e,r):((!i||!i.exit)&&ih(this,n,r),this._active=o,ih(this,t,r),ih(this,e,r))}}function IN(e){return function(t){ih(this,e,t),this._active=null}}G(La,Pa,{initialize(e,t,n){return this._canvas=e&&DC(e,"canvas"),[$1,qE,WE,k1,Nh,p0].forEach(r=>LN(this,r)),Pa.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Cne,DOMMouseScroll(e){this.fire(PI,e)},pointermove:zN([k1,RI],[OI,DI],[Nh,HE]),dragover:zN([NI],[MI],[p0]),pointerout:IN([Nh,HE]),dragleave:IN([p0]),pointerdown(e){this._down=this._active,this.fire(WE,e)},mousedown(e){this._down=this._active,this.fire(qE,e)},click(e){this._down===this._active&&(this.fire($1,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(C1,e,!0)},touchmove(e){this.fire(A1,e,!0)},touchend(e){this.fire(T1,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===VE&&r&&r.href?this.handleHref(t,r,r.href):(e===GE||e===wp)&&this.handleTooltip(t,r,e!==wp),i)for(let o=0,s=i.length;o<s;++o)i[o].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(LN(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=Vv(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const o=this.context();return Rr[e.marktype].pick.call(this,o,e,t,n,r,i)}});function Fne(){return typeof window<"u"&&window.devicePixelRatio||1}function Mne(e,t,n,r,i,o){const s=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=s?Fne():i;e.width=t*u,e.height=n*u;for(const l in o)a[l]=o[l];return s&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*r[0],u*r[1]),e}function Ep(e){Ir.call(this,e),this._options={},this._redraw=!1,this._dirty=new Et,this._tempb=new Et}const BN=Ir.prototype,Nne=(e,t,n)=>new Et().set(0,0,t,n).translate(-e[0],-e[1]);function One(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}G(Ep,Ir,{initialize(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Sa(1,1,this._options.type),e&&this._canvas&&(Hr(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),BN.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(BN.resize.call(this,e,t,n,r),this._canvas)Mne(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||z("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e,t){const n=this.context(),r=this._origin,i=this._width,o=this._height,s=this._dirty,a=Nne(r,i,o);n.save();const u=this._redraw||s.empty()?(this._redraw=!1,a.expand(1)):One(n,a.intersect(s),r);return this.clear(-r[0],-r[1],i,o),this.draw(n,e,u,t),n.restore(),s.clear(),this},draw(e,t,n,r){if(t.marktype!=="group"&&r!=null&&!r.includes(t.marktype))return;const i=Rr[t.marktype];t.clip&&Fte(e,t),i.draw.call(this,e,t,n,r),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,o=this.context();i.type!=="pdf"&&!i.externalContext&&o.clearRect(e,t,n,r),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});function PC(e,t){Pa.call(this,e,t);const n=this;n._hrefHandler=YE(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=YE(n,(r,i)=>{n.handleTooltip(r,i,r.type!==wp)})}const YE=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};G(PC,Pa,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(VE,this._hrefHandler),r.removeEventListener(GE,this._tooltipHandler),r.removeEventListener(wp,this._tooltipHandler)),this._svg=r=e&&DC(e,"svg"),r&&(r.addEventListener(VE,this._hrefHandler),r.addEventListener(GE,this._tooltipHandler),r.addEventListener(wp,this._tooltipHandler)),Pa.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const o={type:e,handler:t,listener:YE(this,t)};(r[n]||(r[n]=[])).push(o),this._svg&&this._svg.addEventListener(n,o.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const LI="aria-hidden",LC="aria-label",zC="role",IC="aria-roledescription",zI="graphics-object",BC="graphics-symbol",II=(e,t,n)=>({[zC]:e,[IC]:t,[LC]:n||void 0}),Rne=Bi(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),jN={axis:{desc:"axis",caption:Lne},legend:{desc:"legend",caption:zne},"title-text":{desc:"title",caption:e=>`Title text '${WN(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${WN(e)}'`}},UN={ariaRole:zC,ariaRoleDescription:IC,description:LC};function BI(e,t){const n=t.aria===!1;if(e(LI,n||void 0),n||t.description==null)for(const r in UN)e(UN[r],void 0);else{const r=t.mark.marktype;e(LC,t.description),e(zC,t.ariaRole||(r==="group"?zI:BC)),e(IC,t.ariaRoleDescription||`${r} mark`)}}function jI(e){return e.aria===!1?{[LI]:!0}:Rne[e.role]?null:jN[e.role]?Pne(e,jN[e.role]):Dne(e)}function Dne(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return II(n?zI:BC,`${t} mark container`,e.description)}function Pne(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return II(t.role||BC,t.desc,n.description||r(n))}catch{return null}}function WN(e){return Q(e.text).join(" ")}function Lne(e){const t=e.datum,n=e.orient,r=t.title?UI(e):null,i=e.context,o=i.scales[t.scale].value,s=i.dataflow.locale(),a=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${hf(a)?"discrete":a} scale with ${rI(s,o,e)}`}function zne(e){const t=e.datum,n=t.title?UI(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),s=e.context,a=s.scales[i[o[0]]].value,u=s.dataflow.locale();return Bne(r)+(n?` titled '${n}'`:"")+` for ${Ine(o)} with ${rI(u,a,e)}`}function UI(e){try{return Q($e(e.items).items[0].text).join(" ")}catch{return null}}function Ine(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+$e(e)}function Bne(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const WI=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),jne=e=>WI(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function jC(){let e="",t="",n="";const r=[],i=()=>t=n="",o=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},s=(u,l)=>(l!=null&&(t+=` ${u}="${jne(l)}"`),a),a={open(u){o(u),t="<"+u;for(var l=arguments.length,c=new Array(l>1?l-1:0),f=1;f<l;f++)c[f-1]=arguments[f];for(const d of c)for(const h in d)s(h,d[h]);return a},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),a},attr:s,text:u=>(n+=WI(u),a),toString:()=>e};return a}const qI=e=>HI(jC(),e)+"";function HI(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const r of n)r.nodeType===3?e.text(r.nodeValue):HI(e,r)}return e.close()}const F1={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},M1={blend:"mix-blend-mode"},GI={fill:"none","stroke-miterlimit":10},Fd=0,qN="http://www.w3.org/2000/xmlns/",_t=bp.xmlns;function Yv(e){Ir.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const lb=Ir.prototype;G(Yv,Ir,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=kt(e,0,"svg",_t),this._svg.setAttributeNS(qN,"xmlns",_t),this._svg.setAttributeNS(qN,"xmlns:xlink",bp["xmlns:xlink"]),this._svg.setAttribute("version",bp.version),this._svg.setAttribute("class","marks"),Hr(e,1),this._root=kt(this._svg,Fd,"g",_t),ia(this._root,GI),Hr(this._svg,Fd+1)),this.background(this._bgcolor),lb.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),lb.background.apply(this,arguments)},resize(e,t,n,r){return lb.resize.call(this,e,t,n,r),this._svg&&(ia(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=kt(e,Fd,"rect",_t),ia(n,{width:this._width,height:this._height,fill:t}));const r=qI(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e,t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e,void 0,t),Hr(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,o,s,a,u;for(s=0,a=e.length;s<a;++s)if(n=e[s],r=n.mark,r.marktype!==i&&(i=r.marktype,o=Rr[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,HN(n,t),r.items.forEach(l=>{l.dirty=t})),!r.zdirty){if(n.exit){o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=o.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,HN(n,t)):this._update(o,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n,r){if(!this.isDirty(t))return t._svg;const i=this._svg,o=t.marktype,s=Rr[o],a=t.interactive===!1?"none":null,u=s.tag==="g",l=GN(t,e,n,"g",i);if(o!=="group"&&r!=null&&!r.includes(o))return Hr(l,0),t._svg;l.setAttribute("class",FI(t));const c=jI(t);for(const p in c)Fn(l,p,c[p]);u||Fn(l,"pointer-events",a),Fn(l,"clip-path",t.clip?yC(this,t,t.group):null);let f=null,d=0;const h=p=>{const g=this.isDirty(p),m=GN(p,l,f,s.tag,i);g&&(this._update(s,m,p),u&&qne(this,m,p,r)),f=m,++d};return s.nested?t.items.length&&h(t.items[0]):Ui(t,h),Hr(l,d),l},_update(e,t,n){us=t,hn=t.__values__,BI(Oh,n),e.attr(Oh,n,this);const r=Gne[e.type];r&&r.call(this,e,t,n),us&&this.style(us,n)},style(e,t){if(t!=null){for(const n in F1){let r=n==="font"?vg(t):t[n];if(r===hn[n])continue;const i=F1[n];r==null?e.removeAttribute(i):(pC(r)&&(r=oI(r,this._defs.gradient,VI())),e.setAttribute(i,r+"")),hn[n]=r}for(const n in M1)g0(e,M1[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=kt(e,Fd+1,"defs",_t)),r=Une(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=kt(e,Fd+1,"defs",_t)),r=Wne(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):Hr(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function HN(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function Une(e,t,n){let r,i,o;if(t.gradient==="radial"){let s=kt(e,n++,"pattern",_t);ia(s,{id:w1+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),s=kt(s,0,"rect",_t),ia(s,{width:1,height:1,fill:`url(${VI()}#${t.id})`}),e=kt(e,n++,"radialGradient",_t),ia(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=kt(e,n++,"linearGradient",_t),ia(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=kt(e,r,"stop",_t),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return Hr(e,r),n}function Wne(e,t,n){let r;return e=kt(e,n,"clipPath",_t),e.setAttribute("id",t.id),t.path?(r=kt(e,0,"path",_t),r.setAttribute("d",t.path)):(r=kt(e,0,"rect",_t),ia(r,{x:0,y:0,width:t.width,height:t.height})),Hr(e,1),n+1}function qne(e,t,n,r){t=t.lastChild.previousSibling;let i,o=0;Ui(n,s=>{i=e.mark(t,s,i,r),++o}),Hr(t,1+o)}function GN(e,t,n,r,i){let o=e._svg,s;if(!o&&(s=t.ownerDocument,o=ra(s,r,_t),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},r==="g"))){const a=ra(s,"path",_t);o.appendChild(a),a.__data__=e;const u=ra(s,"g",_t);o.appendChild(u),u.__data__=e;const l=ra(s,"path",_t);o.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(o.ownerSVGElement!==i||Hne(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function Hne(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let us=null,hn=null;const Gne={group(e,t,n){const r=us=t.childNodes[2];hn=r.__values__,e.foreground(Oh,n,this),hn=t.__values__,us=t.childNodes[1],e.content(Oh,n,this);const i=us=t.childNodes[0];e.background(Oh,n,this);const o=n.mark.interactive===!1?"none":null;if(o!==hn.events&&(Fn(r,"pointer-events",o),Fn(i,"pointer-events",o),hn.events=o),n.strokeForeground&&n.stroke){const s=n.fill;Fn(r,"display",null),this.style(i,n),Fn(i,"stroke",null),s&&(n.fill=null),hn=r.__values__,this.style(r,n),s&&(n.fill=s),us=null}else Fn(r,"display","none")},image(e,t,n){n.smooth===!1?(g0(t,"image-rendering","optimizeSpeed"),g0(t,"image-rendering","pixelated")):g0(t,"image-rendering",null)},text(e,t,n){const r=yg(n);let i,o,s,a;I(r)?(o=r.map(u=>Da(n,u)),i=o.join(`
`),i!==hn.text&&(Hr(t,0),s=t.ownerDocument,a=Ra(n),o.forEach((u,l)=>{const c=ra(s,"tspan",_t);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),hn.text=i)):(o=Da(n,r),o!==hn.text&&(t.textContent=o,hn.text=o)),Fn(t,"font-family",vg(n)),Fn(t,"font-size",Oo(n)+"px"),Fn(t,"font-style",n.fontStyle),Fn(t,"font-variant",n.fontVariant),Fn(t,"font-weight",n.fontWeight)}};function Oh(e,t,n){t!==hn[e]&&(n?Vne(us,e,t,n):Fn(us,e,t),hn[e]=t)}function g0(e,t,n){n!==hn[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),hn[t]=n)}function ia(e,t){for(const n in t)Fn(e,n,t[n])}function Fn(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Vne(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function VI(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function UC(e){Ir.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}G(UC,Ir,{svg(){return this._text},_render(e){const t=jC();t.open("svg",pe({},bp,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",GI,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Rr[t.marktype],r=n.tag,i=[BI,n.attr];e.open("g",{class:FI(t),"clip-path":t.clip?yC(this,t,t.group):null},jI(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const o=s=>{const a=this.href(s);if(a&&e.open("a",a),e.open(r,this.attr(t,s,i,r!=="g"?r:null)),r==="text"){const u=yg(s);if(I(u)){const l={x:0,dy:Ra(s)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(Da(s,u[c])).close()}else e.text(Da(s,u))}else if(r==="g"){const u=s.strokeForeground,l=s.fill,c=s.stroke;u&&c&&(s.stroke=null),e.open("path",this.attr(t,s,n.background,"bgrect")).close(),e.open("g",this.attr(t,s,n.content)),Ui(s,f=>this.mark(e,f)),e.close(),u&&c?(l&&(s.fill=null),s.stroke=c,e.open("path",this.attr(t,s,n.foreground,"bgrect")).close(),l&&(s.fill=l)):e.open("path",this.attr(t,s,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):Ui(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},o=(s,a,u,l)=>{i[l||s]=a};return Array.isArray(n)?n.forEach(s=>s(o,t,this)):n(o,t,this),r&&Yne(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const o=t[i],s=o.stops;o.gradient==="radial"?(e.open("pattern",{id:w1+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):e.open("linearGradient",{id:i,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let a=0;a<s.length;++a)e.open("stop",{offset:s[a].offset,"stop-color":s[a].color}).close();e.close()}for(const i in n){const o=n[i];e.open("clipPath",{id:i}),o.path?e.open("path",{d:o.path}).close():e.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),e.close()}e.close()}}});function Yne(e,t,n,r,i){let o;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=vg(t),e["font-size"]=Oo(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const s in F1){let a=t[s];const u=F1[s];a==="transparent"&&(u==="fill"||u==="stroke")||a!=null&&(pC(a)&&(a=oI(a,i.gradient,"")),e[u]=a)}for(const s in M1){const a=t[s];a!=null&&(o=o||[],o.push(`${M1[s]}: ${a};`))}return o&&(e.style=o.join(" ")),e}const Si={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function Xne(e){Si.svgMarkTypes=e.svgMarkTypes??["text"],Si.svgOnTop=e.svgOnTop??!0,Si.debug=e.debug??!1}function N1(e){Ir.call(this,e),this._svgRenderer=new Yv(e),this._canvasRenderer=new Ep(e)}const VN=Ir.prototype;G(N1,Ir,{initialize(e,t,n,r,i){this._root_el=kt(e,0,"div");const o=kt(this._root_el,0,"div"),s=kt(this._root_el,1,"div");return this._root_el.style.position="relative",Si.debug||(o.style.height="100%",s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.height="100%",s.style.width="100%"),this._svgEl=Si.svgOnTop?s:o,this._canvasEl=Si.svgOnTop?o:s,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,t,n,r,i),this._svgRenderer.initialize(this._svgEl,t,n,r,i),VN.initialize.call(this,e,t,n,r,i)},dirty(e){return Si.svgMarkTypes.includes(e.mark.marktype)?this._svgRenderer.dirty(e):this._canvasRenderer.dirty(e),this},_render(e,t){const r=(t??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(i=>!Si.svgMarkTypes.includes(i));this._svgRenderer.render(e,Si.svgMarkTypes),this._canvasRenderer.render(e,r)},resize(e,t,n,r){return VN.resize.call(this,e,t,n,r),this._svgRenderer.resize(e,t,n,r),this._canvasRenderer.resize(e,t,n,r),this},background(e){return Si.svgOnTop?this._canvasRenderer.background(e):this._svgRenderer.background(e),this}});function WC(e,t){La.call(this,e,t)}G(WC,La,{initialize(e,t,n){const r=kt(kt(e,0,"div"),Si.svgOnTop?0:1,"div");return La.prototype.initialize.call(this,r,t,n)}});const YI="canvas",XI="hybrid",QI="png",KI="svg",JI="none",oa={Canvas:YI,PNG:QI,SVG:KI,Hybrid:XI,None:JI},cl={};cl[YI]=cl[QI]={renderer:Ep,headless:Ep,handler:La};cl[KI]={renderer:Yv,headless:UC,handler:PC};cl[XI]={renderer:N1,headless:N1,handler:WC};cl[JI]={};function Xv(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(cl[e]=t,this):cl[e]}function ZI(e,t,n){const r=[],i=new Et().union(t),o=e.marktype;return o?e9(e,i,n,r):o==="group"?t9(e,i,n,r):z("Intersect scene must be mark node or group item.")}function e9(e,t,n,r){if(Qne(e,t,n)){const i=e.items,o=e.marktype,s=i.length;let a=0;if(o==="group")for(;a<s;++a)t9(i[a],t,n,r);else for(const u=Rr[o].isect;a<s;++a){const l=i[a];n9(l,t,u)&&r.push(l)}}return r}function Qne(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function t9(e,t,n,r){n&&n(e.mark)&&n9(e,t,Rr.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const s=e.x||0,a=e.y||0;t.translate(-s,-a);for(let u=0;u<o;++u)e9(i[u],t,n,r);t.translate(s,a)}return r}function n9(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const cb=new Et;function r9(e){const t=e.clip;if(ge(t))t(gg(cb.clear()));else if(t)cb.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(cb)}const Kne=1e-9;function qC(e,t,n){return e===t?!0:n==="path"?i9(e,t):e instanceof Date&&t instanceof Date?+e==+t:Te(e)&&Te(t)?Math.abs(e-t)<=Kne:!e||!t||!J(e)&&!J(t)?e==t:Jne(e,t)}function i9(e,t){return qC(pf(e),pf(t))}function Jne(e,t){var n=Object.keys(e),r=Object.keys(t),i,o;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),o=n.length-1;o>=0;o--)if(n[o]!=r[o])return!1;for(o=n.length-1;o>=0;o--)if(i=n[o],!qC(e[i],t[i],i))return!1;return typeof e==typeof t}function Zne(){dI(),See()}const yf="top",Ti="left",Fi="right",za="bottom",ere="top-left",tre="top-right",nre="bottom-left",rre="bottom-right",HC="start",XE="middle",Nn="end",ire="x",ore="y",Qv="group",GC="axis",VC="title",sre="frame",are="scope",YC="legend",o9="row-header",s9="row-footer",a9="row-title",u9="column-header",l9="column-footer",c9="column-title",ure="padding",lre="symbol",f9="fit",d9="fit-x",h9="fit-y",cre="pad",XC="none",ym="all",QE="each",QC="flush",sa="column",aa="row";function p9(e){D.call(this,null,e)}G(p9,D,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=Rr[i],s=o.bound;let a=r.bounds,u;if(o.nested)r.items.length&&n.dirty(r.items[0]),a=vm(r,s),r.items.forEach(l=>{l.bounds.clear().union(a)});else if(i===Qv||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),r.items.forEach(l=>a.union(vm(l,s))),r.role){case GC:case YC:case VC:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(vm(l,s))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(vm(l,s))}),u&&(a.clear(),r.items.forEach(l=>a.union(l.bounds)));return r9(r),t.modifies("bounds")}});function vm(e,t,n){return t(e.bounds.clear(),e,n)}const YN=":vega_identifier:";function KC(e){D.call(this,0,e)}KC.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};G(KC,D,{transform(e,t){const n=fre(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,o=>o[r]=o[r]||++i),n.set(this.value=i),t}});function fre(e){return e._signals[YN]||(e._signals[YN]=e.add(0))}function g9(e){D.call(this,null,e)}G(g9,D,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,dre(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===Qv?Bv:Iv;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function dre(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function m9(e){D.call(this,null,e)}const XN={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!y9(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},y9=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),QN=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,o;n<r;i=o,++n)if(y9(i,o=e[n].bounds,t))return!0},hre=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},pre=(e,t,n)=>{var r=e.range(),i=new Et;return t===yf||t===za?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),o=>i.encloses(o.bounds)},KN=e=>(e.forEach(t=>t.opacity=1),e),JN=(e,t)=>e.reflow(t.modified()).modifies("opacity");G(m9,D,{transform(e,t){const n=XN[e.method]||XN.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,o,s;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(KN(i),t=JN(t,e)),t;if(i=i.filter(hre),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),o=KN(i),t=JN(t,e),o.length>=3&&QN(o,r)){do o=n(o,r);while(o.length>=3&&QN(o,r));o.length<3&&!$e(i).opacity&&(o.length>1&&($e(o).opacity=0),$e(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(s=pre(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{s(u)||(u.opacity=0)}));const a=o[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function v9(e){D.call(this,null,e)}G(v9,D,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const dn=new Et;function Cc(e,t,n){return e[t]===n?0:(e[t]=n,1)}function gre(e){var t=e.items[0].orient;return t===Ti||t===Fi}function mre(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function yre(e,t,n,r){var i=t.items[0],o=i.datum,s=i.translate!=null?i.translate:.5,a=i.orient,u=mre(o),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=o.title&&i.items[u[2]].items[0],g=i.titlePadding,m=i.bounds,y=p&&MC(p),v=0,x=0,b,w;switch(dn.clear().union(m),m.clear(),(b=u[0])>-1&&m.union(i.items[b].bounds),(b=u[1])>-1&&m.union(i.items[b].bounds),a){case yf:v=f||0,x=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(l,0),p&&xm(e,p,w,g,y,0,-1,m);break;case Ti:v=-c,x=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,l),p&&xm(e,p,w,g,y,1,-1,m);break;case Fi:v=n+c,x=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,l),p&&xm(e,p,w,g,y,1,1,m);break;case za:v=f||0,x=r+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,w),p&&xm(e,p,w,g,0,0,1,m);break;default:v=i.x,x=i.y}return As(m.translate(v,x),i),Cc(i,"x",v+s)|Cc(i,"y",x+s)&&(i.bounds=dn,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function xm(e,t,n,r,i,o,s,a){const u=t.bounds;if(t.auto){const l=s*(n+i+r);let c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}const ZN=(e,t)=>Math.floor(Math.min(e,t)),eO=(e,t)=>Math.ceil(Math.max(e,t));function vre(e){var t=e.items,n=t.length,r=0,i,o;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],o=i.items,i.marktype===Qv)switch(i.role){case GC:case YC:case VC:break;case o9:s.rowheaders.push(...o);break;case s9:s.rowfooters.push(...o);break;case u9:s.colheaders.push(...o);break;case l9:s.colfooters.push(...o);break;case a9:s.rowtitle=o[0];break;case c9:s.coltitle=o[0];break;default:s.marks.push(...o)}return s}function xre(e){return new Et().set(0,0,e.width||0,e.height||0)}function bre(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function et(e,t,n){const r=J(e)?e[t]:e;return r??(n!==void 0?n:0)}function tO(e){return e<0?Math.ceil(-e):0}function x9(e,t,n){var r=!n.nodirty,i=n.bounds===QC?xre:bre,o=dn.set(0,0,0,0),s=et(n.align,sa),a=et(n.align,aa),u=et(n.padding,sa),l=et(n.padding,aa),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),y=Array(f),v=0,x=Array(d),b=Array(d),w=Array(d),S,E,_,k,$,C,R,A,F,T,M;for(E=0;E<c;++E)p[E]=0;for(E=0;E<f;++E)y[E]=0;for(E=0;E<d;++E)C=t[E],$=w[E]=i(C),C.x=C.x||0,x[E]=0,C.y=C.y||0,b[E]=0,_=E%c,k=~~(E/c),g=Math.max(g,R=Math.ceil($.x2)),v=Math.max(v,A=Math.ceil($.y2)),p[_]=Math.max(p[_],R),y[k]=Math.max(y[k],A),h[E]=u+tO($.x1),m[E]=l+tO($.y1),r&&e.dirty(t[E]);for(E=0;E<d;++E)E%c===0&&(h[E]=0),E<c&&(m[E]=0);if(s===QE)for(_=1;_<c;++_){for(M=0,E=_;E<d;E+=c)M<h[E]&&(M=h[E]);for(E=_;E<d;E+=c)h[E]=M+p[_-1]}else if(s===ym){for(M=0,E=0;E<d;++E)E%c&&M<h[E]&&(M=h[E]);for(E=0;E<d;++E)E%c&&(h[E]=M+g)}else for(s=!1,_=1;_<c;++_)for(E=_;E<d;E+=c)h[E]+=p[_-1];if(a===QE)for(k=1;k<f;++k){for(M=0,E=k*c,S=E+c;E<S;++E)M<m[E]&&(M=m[E]);for(E=k*c;E<S;++E)m[E]=M+y[k-1]}else if(a===ym){for(M=0,E=c;E<d;++E)M<m[E]&&(M=m[E]);for(E=c;E<d;++E)m[E]=M+v}else for(a=!1,k=1;k<f;++k)for(E=k*c,S=E+c;E<S;++E)m[E]+=y[k-1];for(F=0,E=0;E<d;++E)F=h[E]+(E%c?F:0),x[E]+=F-t[E].x;for(_=0;_<c;++_)for(T=0,E=_;E<d;E+=c)T+=m[E],b[E]+=T-t[E].y;if(s&&et(n.center,sa)&&f>1)for(E=0;E<d;++E)$=s===ym?g:p[E%c],F=$-w[E].x2-t[E].x-x[E],F>0&&(x[E]+=F/2);if(a&&et(n.center,aa)&&c!==1)for(E=0;E<d;++E)$=a===ym?v:y[~~(E/c)],T=$-w[E].y2-t[E].y-b[E],T>0&&(b[E]+=T/2);for(E=0;E<d;++E)o.union(w[E].translate(x[E],b[E]));switch(F=et(n.anchor,ire),T=et(n.anchor,ore),et(n.anchor,sa)){case Nn:F-=o.width();break;case XE:F-=o.width()/2}switch(et(n.anchor,aa)){case Nn:T-=o.height();break;case XE:T-=o.height()/2}for(F=Math.round(F),T=Math.round(T),o.clear(),E=0;E<d;++E)t[E].mark.bounds.clear();for(E=0;E<d;++E)C=t[E],C.x+=x[E]+=F,C.y+=b[E]+=T,o.union(C.mark.bounds.union(C.bounds.translate(x[E],b[E]))),r&&e.dirty(C);return o}function wre(e,t,n){var r=vre(t),i=r.marks,o=n.bounds===QC?Ere:Sre,s=n.offset,a=n.columns||i.length,u=a<=0?1:Math.ceil(i.length/a),l=u*a,c,f,d,h,p,g,m;const y=x9(e,i,n);y.empty()&&y.set(0,0,0,0),r.rowheaders&&(g=et(n.headerBand,aa,null),c=bm(e,r.rowheaders,i,a,u,-et(s,"rowHeader"),ZN,0,o,"x1",0,a,1,g)),r.colheaders&&(g=et(n.headerBand,sa,null),f=bm(e,r.colheaders,i,a,a,-et(s,"columnHeader"),ZN,1,o,"y1",0,1,a,g)),r.rowfooters&&(g=et(n.footerBand,aa,null),d=bm(e,r.rowfooters,i,a,u,et(s,"rowFooter"),eO,0,o,"x2",a-1,a,1,g)),r.colfooters&&(g=et(n.footerBand,sa,null),h=bm(e,r.colfooters,i,a,a,et(s,"columnFooter"),eO,1,o,"y2",l-a,1,a,g)),r.rowtitle&&(p=et(n.titleAnchor,aa),m=et(s,"rowTitle"),m=p===Nn?d+m:c-m,g=et(n.titleBand,aa,.5),nO(e,r.rowtitle,m,0,y,g)),r.coltitle&&(p=et(n.titleAnchor,sa),m=et(s,"columnTitle"),m=p===Nn?h+m:f-m,g=et(n.titleBand,sa,.5),nO(e,r.coltitle,m,1,y,g))}function Ere(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function Sre(e,t){return e.bounds[t]}function bm(e,t,n,r,i,o,s,a,u,l,c,f,d,h){var p=n.length,g=0,m=0,y,v,x,b,w,S,E,_,k;if(!p)return g;for(y=c;y<p;y+=f)n[y]&&(g=s(g,u(n[y],l)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=o,v=0,b=t.length;v<b;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(y=c,v=0,b=t.length;v<b;++v,y+=f){for(S=t[v],w=S.mark.bounds,x=y;x>=0&&(E=n[x])==null;x-=d);a?(_=h==null?E.x:Math.round(E.bounds.x1+h*E.bounds.width()),k=g):(_=g,k=h==null?E.y:Math.round(E.bounds.y1+h*E.bounds.height())),w.union(S.bounds.translate(_-(S.x||0),k-(S.y||0))),S.x=_,S.y=k,e.dirty(S),m=s(m,w[l])}return m}function nO(e,t,n,r,i,o){if(t){e.dirty(t);var s=n,a=n;r?s=Math.round(i.x1+o*i.width()):a=Math.round(i.y1+o*i.height()),t.bounds.translate(s-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=s,t.y=a,e.dirty(t)}}function _re(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function kre(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function $re(e,t,n,r,i,o,s){const a=_re(n,t),u=kre(e,a("offset",0)),l=a("anchor",HC),c=l===Nn?1:l===XE?.5:0,f={align:QE,bounds:a("bounds",QC),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case Ti:f.anchor={x:Math.floor(r.x1)-u,column:Nn,y:c*(s||r.height()+2*r.y1),row:l};break;case Fi:f.anchor={x:Math.ceil(r.x2)+u,y:c*(s||r.height()+2*r.y1),row:l};break;case yf:f.anchor={y:Math.floor(i.y1)-u,row:Nn,x:c*(o||i.width()+2*i.x1),column:l};break;case za:f.anchor={y:Math.ceil(i.y2)+u,x:c*(o||i.width()+2*i.x1),column:l};break;case ere:f.anchor={x:u,y:u};break;case tre:f.anchor={x:o-u,y:u,column:Nn};break;case nre:f.anchor={x:u,y:s-u,row:Nn};break;case rre:f.anchor={x:o-u,y:s-u,column:Nn,row:Nn};break}return f}function Cre(e,t){var n=t.items[0],r=n.datum,i=n.orient,o=n.bounds,s=n.x,a=n.y,u,l;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),Tre(e,n,n.items[0].items[0]),o=Are(n,o),u=2*n.padding,l=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),l=Math.ceil(o.height()+l)),r.type===lre&&Fre(n.items[0].items[0].items[0].items),i!==XC&&(n.x=s=0,n.y=a=0),n.width=u,n.height=l,As(o.set(s,a,s+u,a+l),n),n.mark.bounds.clear().union(o),n}function Are(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function Tre(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(!t.datum.title)(i||o)&&Md(e,n,i,o);else{var s=t.items[1].items[0],a=s.anchor,u=t.titlePadding||0,l=r-s.x,c=r-s.y;switch(s.orient){case Ti:i+=Math.ceil(s.bounds.width())+u;break;case Fi:case za:break;default:o+=s.bounds.height()+u}switch((i||o)&&Md(e,n,i,o),s.orient){case Ti:c+=Zl(t,n,s,a,1,1);break;case Fi:l+=Zl(t,n,s,Nn,0,0)+u,c+=Zl(t,n,s,a,1,1);break;case za:l+=Zl(t,n,s,a,0,0),c+=Zl(t,n,s,Nn,-1,0,1)+u;break;default:l+=Zl(t,n,s,a,0,0)}(l||c)&&Md(e,s,l,c),(l=Math.round(s.bounds.x1-r))<0&&(Md(e,n,-l,0),Md(e,s,-l,0))}}function Zl(e,t,n,r,i,o,s){const a=e.datum.type!=="symbol",u=n.datum.vgrad,l=a&&(o||!u)&&!s?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&o?c:0,d=u&&o?0:c,h=i<=0?0:MC(n);return Math.round(r===HC?f:r===Nn?d-h:.5*(c-h))}function Md(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function Fre(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function Mre(e,t,n,r,i){var o=t.items[0],s=o.frame,a=o.orient,u=o.anchor,l=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],h=a===Ti||a===Fi?r:n,p=0,g=0,m=0,y=0,v=0,x;if(s!==Qv?a===Ti?(p=i.y2,h=i.y1):a===Fi?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):a===Ti&&(p=r,h=0),x=u===HC?p:u===Nn?h:(p+h)/2,d&&d.text){switch(a){case yf:case za:v=f.bounds.height()+c;break;case Ti:y=f.bounds.width()+c;break;case Fi:y=-f.bounds.width()-c;break}dn.clear().union(d.bounds),dn.translate(y-(d.x||0),v-(d.y||0)),Cc(d,"x",y)|Cc(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(dn),d.mark.bounds.clear().union(dn),e.dirty(d)),dn.clear().union(d.bounds)}else dn.clear();switch(dn.union(f.bounds),a){case yf:g=x,m=i.y1-dn.height()-l;break;case Ti:g=i.x1-dn.width()-l,m=x;break;case Fi:g=i.x2+dn.width()+l,m=x;break;case za:g=x,m=i.y2+l;break;default:g=o.x,m=o.y}return Cc(o,"x",g)|Cc(o,"y",m)&&(dn.translate(g,m),e.dirty(o),o.bounds.clear().union(dn),t.bounds.clear().union(dn),e.dirty(o)),o.bounds}function b9(e){D.call(this,null,e)}G(b9,D,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&wre(n,r,e.layout),Ore(n,r,e)}),Nre(e.mark.group)?t.reflow():t}});function Nre(e){return e&&e.mark.role!=="legend-entry"}function Ore(e,t,n){var r=t.items,i=Math.max(0,t.width||0),o=Math.max(0,t.height||0),s=new Et().set(0,0,i,o),a=s.clone(),u=s.clone(),l=[],c,f,d,h,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case GC:h=gre(f)?a:u,h.union(yre(e,f,i,o));break;case VC:c=f;break;case YC:l.push(Cre(e,f));break;case sre:case are:case o9:case s9:case a9:case u9:case l9:case c9:a.union(f.bounds),u.union(f.bounds);break;default:s.union(f.bounds)}if(l.length){const m={};l.forEach(y=>{d=y.orient||Fi,d!==XC&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const v=m[y];x9(e,v,$re(v,y,n.legends,a,u,i,o))}l.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=v,e.dirty(y)),n.autosize&&(n.autosize.type===f9||n.autosize.type===d9||n.autosize.type===h9))switch(y.orient){case Ti:case Fi:s.add(v.x1,0).add(v.x2,0);break;case yf:case za:s.add(0,v.y1).add(0,v.y2)}else s.union(v)})}s.union(a).union(u),c&&s.union(Mre(e,c,i,o,s)),t.clip&&s.set(0,0,t.width||0,t.height||0),Rre(e,t,s,n)}function Rre(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let s=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===ure){const p=e.padding();s-=p.left+p.right,a-=p.top+p.bottom}o===XC?(l=0,f=0,u=s,c=a):o===f9?(u=Math.max(0,s-l-d),c=Math.max(0,a-f-h)):o===d9?(u=Math.max(0,s-l-d),a=c+f+h):o===h9?(s=u+l+d,c=Math.max(0,a-f-h)):o===cre&&(s=u+l+d,a=c+f+h),e._resizeView(s,a,u,c,[l,f],i.resize)}const Dre=Object.freeze(Object.defineProperty({__proto__:null,bound:p9,identifier:KC,mark:g9,overlap:m9,render:v9,viewlayout:b9},Symbol.toStringTag,{value:"Module"}));function w9(e){D.call(this,null,e)}G(w9,D,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,s=e.count==null?e.values?e.values.length:10:e.count,a=dC(o,s,e.minstep),u=e.format||J8(n,o,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?K8(o,e.values,a):hC(o,a);return i&&(r.rem=i),i=l.map((c,f)=>Pe({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(Pe({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function E9(e){D.call(this,null,e)}function Pre(){return Pe({})}function Lre(e){const t=qf().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}G(E9,D,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Pre,o=e.key||oe,s=this.value;return I(r.encode)&&(r.encode=null),s&&(e.modified("key")||t.modified(o))&&z("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=Lre(o)),t.visit(t.ADD,a=>{const u=o(a);let l=s.get(u);l?l.exit?(s.empty--,r.add.push(l)):r.mod.push(l):(l=i(a),s.set(u,l),r.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{const u=o(a),l=s.get(u);l&&(l.datum=a,r.mod.push(l))}),t.visit(t.REM,a=>{const u=o(a),l=s.get(u);a===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),r}});function S9(e){D.call(this,null,e)}G(S9,D,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(I(o))if(n.changed()||o.every(f=>i[f]))o=o[0],n.encode=null;else return t.StopPropagation;var s=o==="enter",a=i.update||Is,u=i.enter||Is,l=i.exit||Is,c=(o&&!s?i[o]:a)||Is;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==Is&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Is&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),s||c!==Is){const f=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function _9(e){D.call(this,[],e)}G(_9,D,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.type||u0,s=e.scale,a=+e.limit,u=dC(s,e.count==null?5:e.count,e.minstep),l=!!e.values||o===u0,c=e.format||nI(n,s,u,o,e.formatSpecifier,e.formatType,l),f=e.values||tI(s,u),d,h,p,g,m;return i&&(r.rem=i),o===u0?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,a-1),m=!0):i=f,ge(p=e.size)?(!e.values&&s(i[0])===0&&(i=i.slice(1)),g=i.reduce((y,v)=>Math.max(y,p(v,e)),0)):p=kn(g=p||8),i=i.map((y,v)=>Pe({index:v,label:c(y,v,i),value:y,offset:g,size:p(y,e)})),m&&(m=f[i.length],i.push(Pe({index:i.length,label:`${f.length-i.length} entries`,value:m,offset:g,size:p(m,e)})))):o===cee?(d=s.domain(),h=Y8(s,d[0],$e(d)),f.length<3&&!e.values&&d[0]!==$e(d)&&(f=[d[0],$e(d)]),i=f.map((y,v)=>Pe({index:v,label:c(y,v,f),value:y,perc:h(y)}))):(p=f.length-1,h=wee(s),i=f.map((y,v)=>Pe({index:v,label:c(y,v,f),value:y,perc:v?h(y):0,perc2:v===p?1:h(f[v+1])}))),r.source=i,r.add=i,this.value=i,r}});const zre=e=>e.source.x,Ire=e=>e.source.y,Bre=e=>e.target.x,jre=e=>e.target.y;function JC(e){D.call(this,{},e)}JC.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};G(JC,D,{transform(e,t){var n=e.sourceX||zre,r=e.sourceY||Ire,i=e.targetX||Bre,o=e.targetY||jre,s=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=rO.get(u+"-"+a)||rO.get(u);return l||z("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[s]=l(n(c),r(c),i(c),o(c))}),t.reflow(e.modified()).modifies(s)}});const k9=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,Ure=(e,t,n,r)=>k9(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),$9=(e,t,n,r)=>{var i=n-e,o=r-t,s=Math.hypot(i,o)/2,a=180*Math.atan2(o,i)/Math.PI;return"M"+e+","+t+"A"+s+","+s+" "+a+" 0 1 "+n+","+r},Wre=(e,t,n,r)=>$9(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),C9=(e,t,n,r)=>{const i=n-e,o=r-t,s=.2*(i+o),a=.2*(o-i);return"M"+e+","+t+"C"+(e+s)+","+(t+a)+" "+(n+a)+","+(r-s)+" "+n+","+r},qre=(e,t,n,r)=>C9(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Hre=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,Gre=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,Vre=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*s+","+t*a+"L"+r*s+","+r*a},Yre=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},Xre=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},Qre=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*o+"C"+u*i+","+u*o+" "+u*s+","+u*a+" "+r*s+","+r*a},rO=qf({line:k9,"line-radial":Ure,arc:$9,"arc-radial":Wre,curve:C9,"curve-radial":qre,"orthogonal-horizontal":Hre,"orthogonal-vertical":Gre,"orthogonal-radial":Vre,"diagonal-horizontal":Yre,"diagonal-vertical":Xre,"diagonal-radial":Qre});function ZC(e){D.call(this,null,e)}ZC.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};G(ZC,D,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],o=e.field||jf,s=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(o),c=l.length,f=s,d=(a-s)/H6(l),h=kr(c),p,g,m;for(e.sort&&h.sort((y,v)=>l[y]-l[v]),p=0;p<c;++p)m=l[h[p]],g=u[h[p]],g[r]=f,g[i]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const Kre=5;function Jre(e){const t=e.type;return!e.bins&&(t===ff||t===ug||t===lg)}function A9(e){return lC(e)&&e!==vo}const Zre=Bi(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function T9(e){D.call(this,null,e),this.modified(!0)}G(T9,D,{transform(e,t){var n=t.dataflow,r=this.value,i=eie(e);(!r||i!==r.type)&&(this.value=r=Ne(i)());for(i in e)if(!Zre[i]){if(i==="padding"&&A9(r.type))continue;ge(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return sie(r,e,oie(r,e,nie(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function eie(e){var t=e.type,n="",r;return t===vo?vo+"-"+ff:(tie(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?vo+"-":r===3?Jf+"-":""),(n+t||ff).toLowerCase())}function tie(e){const t=e.type;return lC(t)&&t!==ul&&t!==ll&&(e.scheme||e.range&&e.range.length&&e.range.every(K))}function nie(e,t,n){const r=rie(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,o=e.type,s=t.zero||t.zero===void 0&&Jre(e),a,u;if(!i)return 0;if(A9(o)&&t.padding&&i[0]!==$e(i)&&(i=iie(o,i,t.range,t.padding,t.exponent,t.constant)),(s||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(i=i.slice()).length-1||1,s&&(i[0]>0&&(i[0]=0),i[a]<0&&(i[a]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>i[a]?a+1:u<i[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return e.domain(F9(o,i,n)),o===oC&&e.unknown(t.domainImplicit?AE:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&dC(e,t.nice)||null),i.length}function rie(e,t,n){return t?(e.domain(F9(e.type,t,n)),t.length):-1}function iie(e,t,n,r,i,o){var s=Math.abs($e(n)-n[0]),a=s/(s-2*r),u=e===Ss?Ck(t,null,a):e===lg?r1(t,null,a,.5):e===ug?r1(t,null,a,i||1):e===Rv?Ak(t,null,a,o||1):$k(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function F9(e,t,n){if(W8(e)){var r=Math.abs(t.reduce((i,o)=>i+(o<0?-1:o>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+V(t))}return t}function oie(e,t,n){let r=t.bins;if(r&&!I(r)){const i=e.domain(),o=i[0],s=$e(i),a=r.step;let u=r.start==null?o:r.start,l=r.stop==null?s:r.stop;a||z("Scale bins parameter missing step property."),u<o&&(u=a*Math.ceil(o/a)),l>s&&(l=a*Math.floor(s/a)),r=kr(u,l+a/2,a)}return r?e.bins=r:e.bins&&delete e.bins,e.type===sC&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function sie(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(t.rangeStep!=null)o=aie(r,t,n);else if(t.scheme&&(o=uie(r,t,n),ge(o))){if(e.interpolator)return e.interpolator(o);z(`Scale type ${r} does not support interpolating color schemes.`)}if(o&&q8(r))return e.interpolator(Lv(KE(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(cC(t.interpolate,t.interpolateGamma)):ge(e.round)?e.round(i):ge(e.rangeRound)&&e.interpolate(i?sg:Za),o&&e.range(KE(o,t.reverse))}function aie(e,t,n){e!==L8&&e!==DE&&z("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===DE?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*iC(n,i,r)]}function uie(e,t,n){var r=t.schemeExtent,i,o;return I(t.scheme)?o=Lv(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),o=fC(i),o||z(`Unrecognized scheme name: ${t.scheme}`)),n=e===Pv?n+1:e===sC?n-1:e===df||e===Dv?+t.schemeCount||Kre:n,q8(e)?iO(o,r,t.reverse):ge(o)?V8(iO(o,r),n):e===oC?o:o.slice(0,n)}function iO(e,t,n){return ge(e)&&(t||n)?G8(e,KE(t||[0,1],n)):e}function KE(e,t){return t?e.slice().reverse():e}function M9(e){D.call(this,null,e)}G(M9,D,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Rl(e.sort)),this.modified(n),t}});const oO="zero",N9="center",O9="normalize",R9=["y0","y1"];function eA(e){D.call(this,null,e)}eA.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:oO,values:[oO,N9,O9]},{name:"as",type:"string",array:!0,length:2,default:R9}]};G(eA,D,{transform(e,t){var n=e.as||R9,r=n[0],i=n[1],o=Rl(e.sort),s=e.field||jf,a=e.offset===N9?lie:e.offset===O9?cie:fie,u,l,c,f;for(u=die(t.source,e.groupby,o,s),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,s,r,i);return t.reflow(e.modified()).modifies(n)}});function lie(e,t,n,r,i){for(var o=(t-e.sum)/2,s=e.length,a=0,u;a<s;++a)u=e[a],u[r]=o,u[i]=o+=Math.abs(n(u))}function cie(e,t,n,r,i){for(var o=1/e.sum,s=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[r]=s,c[i]=s=o*(l+=Math.abs(n(c)))}function fie(e,t,n,r,i){for(var o=0,s=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=+n(c),l<0?(c[r]=s,c[i]=s+=l):(c[r]=o,c[i]=o+=l)}function die(e,t,n,r){var i=[],o=g=>g(c),s,a,u,l,c,f,d,h,p;if(t==null)i.push(e.slice());else for(s={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(o),d=s[f],d||(s[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,l=i.length;f<l;++f){for(d=i[f],a=0,h=0,u=d.length;a<u;++a)h+=Math.abs(r(d[a]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}const hie=Object.freeze(Object.defineProperty({__proto__:null,axisticks:w9,datajoin:E9,encode:S9,legendentries:_9,linkpath:JC,pie:ZC,scale:T9,sortitems:M9,stack:eA},Symbol.toStringTag,{value:"Module"}));var ue=1e-6,O1=1e-12,xe=Math.PI,pt=xe/2,R1=xe/4,Un=xe*2,mt=180/xe,ye=xe/180,ke=Math.abs,ed=Math.atan,ai=Math.atan2,le=Math.cos,wm=Math.ceil,D9=Math.exp,JE=Math.hypot,D1=Math.log,fb=Math.pow,se=Math.sin,Xr=Math.sign||function(e){return e>0?1:e<0?-1:0},Wn=Math.sqrt,tA=Math.tan;function P9(e){return e>1?0:e<-1?xe:Math.acos(e)}function fr(e){return e>1?pt:e<-1?-pt:Math.asin(e)}function Qt(){}function P1(e,t){e&&aO.hasOwnProperty(e.type)&&aO[e.type](e,t)}var sO={Feature:function(e,t){P1(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)P1(n[r].geometry,t)}},aO={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){ZE(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)ZE(n[r],t,0)},Polygon:function(e,t){uO(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)uO(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)P1(n[r],t)}};function ZE(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function uO(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)ZE(e[n],t,1);t.polygonEnd()}function es(e,t){e&&sO.hasOwnProperty(e.type)?sO[e.type](e,t):P1(e,t)}var L1=new In,z1=new In,L9,z9,eS,tS,nS,$o={point:Qt,lineStart:Qt,lineEnd:Qt,polygonStart:function(){L1=new In,$o.lineStart=pie,$o.lineEnd=gie},polygonEnd:function(){var e=+L1;z1.add(e<0?Un+e:e),this.lineStart=this.lineEnd=this.point=Qt},sphere:function(){z1.add(Un)}};function pie(){$o.point=mie}function gie(){I9(L9,z9)}function mie(e,t){$o.point=I9,L9=e,z9=t,e*=ye,t*=ye,eS=e,tS=le(t=t/2+R1),nS=se(t)}function I9(e,t){e*=ye,t*=ye,t=t/2+R1;var n=e-eS,r=n>=0?1:-1,i=r*n,o=le(t),s=se(t),a=nS*s,u=tS*o+a*le(i),l=a*r*se(i);L1.add(ai(l,u)),eS=e,tS=o,nS=s}function yie(e){return z1=new In,es(e,$o),z1*2}function I1(e){return[ai(e[1],e[0]),fr(e[2])]}function fl(e){var t=e[0],n=e[1],r=le(n);return[r*le(t),r*se(t),se(n)]}function Em(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function vf(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function db(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Sm(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function B1(e){var t=Wn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var ot,Zn,ct,wr,Au,B9,j9,Bc,Rh,Gs,_s,Ko={point:rS,lineStart:lO,lineEnd:cO,polygonStart:function(){Ko.point=W9,Ko.lineStart=vie,Ko.lineEnd=xie,Rh=new In,$o.polygonStart()},polygonEnd:function(){$o.polygonEnd(),Ko.point=rS,Ko.lineStart=lO,Ko.lineEnd=cO,L1<0?(ot=-(ct=180),Zn=-(wr=90)):Rh>ue?wr=90:Rh<-ue&&(Zn=-90),_s[0]=ot,_s[1]=ct},sphere:function(){ot=-(ct=180),Zn=-(wr=90)}};function rS(e,t){Gs.push(_s=[ot=e,ct=e]),t<Zn&&(Zn=t),t>wr&&(wr=t)}function U9(e,t){var n=fl([e*ye,t*ye]);if(Bc){var r=vf(Bc,n),i=[r[1],-r[0],0],o=vf(i,r);B1(o),o=I1(o);var s=e-Au,a=s>0?1:-1,u=o[0]*mt*a,l,c=ke(s)>180;c^(a*Au<u&&u<a*e)?(l=o[1]*mt,l>wr&&(wr=l)):(u=(u+360)%360-180,c^(a*Au<u&&u<a*e)?(l=-o[1]*mt,l<Zn&&(Zn=l)):(t<Zn&&(Zn=t),t>wr&&(wr=t))),c?e<Au?br(ot,e)>br(ot,ct)&&(ct=e):br(e,ct)>br(ot,ct)&&(ot=e):ct>=ot?(e<ot&&(ot=e),e>ct&&(ct=e)):e>Au?br(ot,e)>br(ot,ct)&&(ct=e):br(e,ct)>br(ot,ct)&&(ot=e)}else Gs.push(_s=[ot=e,ct=e]);t<Zn&&(Zn=t),t>wr&&(wr=t),Bc=n,Au=e}function lO(){Ko.point=U9}function cO(){_s[0]=ot,_s[1]=ct,Ko.point=rS,Bc=null}function W9(e,t){if(Bc){var n=e-Au;Rh.add(ke(n)>180?n+(n>0?360:-360):n)}else B9=e,j9=t;$o.point(e,t),U9(e,t)}function vie(){$o.lineStart()}function xie(){W9(B9,j9),$o.lineEnd(),ke(Rh)>ue&&(ot=-(ct=180)),_s[0]=ot,_s[1]=ct,Bc=null}function br(e,t){return(t-=e)<0?t+360:t}function bie(e,t){return e[0]-t[0]}function fO(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function wie(e){var t,n,r,i,o,s,a;if(wr=ct=-(ot=Zn=1/0),Gs=[],es(e,Ko),n=Gs.length){for(Gs.sort(bie),t=1,r=Gs[0],o=[r];t<n;++t)i=Gs[t],fO(r,i[0])||fO(r,i[1])?(br(r[0],i[1])>br(r[0],r[1])&&(r[1]=i[1]),br(i[0],r[1])>br(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,n=o.length-1,t=0,r=o[n];t<=n;r=i,++t)i=o[t],(a=br(r[1],i[0]))>s&&(s=a,ot=i[0],ct=r[1])}return Gs=_s=null,ot===1/0||Zn===1/0?[[NaN,NaN],[NaN,NaN]]:[[ot,Zn],[ct,wr]]}var oh,j1,U1,W1,q1,H1,G1,V1,iS,oS,sS,q9,H9,On,Rn,Dn,Mi={sphere:Qt,point:nA,lineStart:dO,lineEnd:hO,polygonStart:function(){Mi.lineStart=_ie,Mi.lineEnd=kie},polygonEnd:function(){Mi.lineStart=dO,Mi.lineEnd=hO}};function nA(e,t){e*=ye,t*=ye;var n=le(t);xg(n*le(e),n*se(e),se(t))}function xg(e,t,n){++oh,U1+=(e-U1)/oh,W1+=(t-W1)/oh,q1+=(n-q1)/oh}function dO(){Mi.point=Eie}function Eie(e,t){e*=ye,t*=ye;var n=le(t);On=n*le(e),Rn=n*se(e),Dn=se(t),Mi.point=Sie,xg(On,Rn,Dn)}function Sie(e,t){e*=ye,t*=ye;var n=le(t),r=n*le(e),i=n*se(e),o=se(t),s=ai(Wn((s=Rn*o-Dn*i)*s+(s=Dn*r-On*o)*s+(s=On*i-Rn*r)*s),On*r+Rn*i+Dn*o);j1+=s,H1+=s*(On+(On=r)),G1+=s*(Rn+(Rn=i)),V1+=s*(Dn+(Dn=o)),xg(On,Rn,Dn)}function hO(){Mi.point=nA}function _ie(){Mi.point=$ie}function kie(){G9(q9,H9),Mi.point=nA}function $ie(e,t){q9=e,H9=t,e*=ye,t*=ye,Mi.point=G9;var n=le(t);On=n*le(e),Rn=n*se(e),Dn=se(t),xg(On,Rn,Dn)}function G9(e,t){e*=ye,t*=ye;var n=le(t),r=n*le(e),i=n*se(e),o=se(t),s=Rn*o-Dn*i,a=Dn*r-On*o,u=On*i-Rn*r,l=JE(s,a,u),c=fr(l),f=l&&-c/l;iS.add(f*s),oS.add(f*a),sS.add(f*u),j1+=c,H1+=c*(On+(On=r)),G1+=c*(Rn+(Rn=i)),V1+=c*(Dn+(Dn=o)),xg(On,Rn,Dn)}function Cie(e){oh=j1=U1=W1=q1=H1=G1=V1=0,iS=new In,oS=new In,sS=new In,es(e,Mi);var t=+iS,n=+oS,r=+sS,i=JE(t,n,r);return i<O1&&(t=H1,n=G1,r=V1,j1<ue&&(t=U1,n=W1,r=q1),i=JE(t,n,r),i<O1)?[NaN,NaN]:[ai(n,t)*mt,fr(r/i)*mt]}function aS(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function uS(e,t){return ke(e)>xe&&(e-=Math.round(e/Un)*Un),[e,t]}uS.invert=uS;function V9(e,t,n){return(e%=Un)?t||n?aS(gO(e),mO(t,n)):gO(e):t||n?mO(t,n):uS}function pO(e){return function(t,n){return t+=e,ke(t)>xe&&(t-=Math.round(t/Un)*Un),[t,n]}}function gO(e){var t=pO(e);return t.invert=pO(-e),t}function mO(e,t){var n=le(e),r=se(e),i=le(t),o=se(t);function s(a,u){var l=le(u),c=le(a)*l,f=se(a)*l,d=se(u),h=d*n+c*r;return[ai(f*i-h*o,c*n-d*r),fr(h*i+f*o)]}return s.invert=function(a,u){var l=le(u),c=le(a)*l,f=se(a)*l,d=se(u),h=d*i-f*o;return[ai(f*i+d*o,c*n+h*r),fr(h*n-c*r)]},s}function Aie(e){e=V9(e[0]*ye,e[1]*ye,e.length>2?e[2]*ye:0);function t(n){return n=e(n[0]*ye,n[1]*ye),n[0]*=mt,n[1]*=mt,n}return t.invert=function(n){return n=e.invert(n[0]*ye,n[1]*ye),n[0]*=mt,n[1]*=mt,n},t}function Tie(e,t,n,r,i,o){if(n){var s=le(t),a=se(t),u=r*n;i==null?(i=t+r*Un,o=t-u/2):(i=yO(s,i),o=yO(s,o),(r>0?i<o:i>o)&&(i+=r*Un));for(var l,c=i;r>0?c>o:c<o;c-=u)l=I1([s,-a*le(c),-a*se(c)]),e.point(l[0],l[1])}}function yO(e,t){t=fl(t),t[0]-=e,B1(t);var n=P9(-t[1]);return((-t[2]<0?-n:n)+Un-ue)%Un}function Y9(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Qt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function m0(e,t){return ke(e[0]-t[0])<ue&&ke(e[1]-t[1])<ue}function _m(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function X9(e,t,n,r,i){var o=[],s=[],a,u;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],y=p[g],v;if(m0(m,y)){if(!m[2]&&!y[2]){for(i.lineStart(),a=0;a<g;++a)i.point((m=p[a])[0],m[1]);i.lineEnd();return}y[0]+=2*ue}o.push(v=new _m(m,p,null,!0)),s.push(v.o=new _m(m,null,v,!1)),o.push(v=new _m(y,p,null,!1)),s.push(v.o=new _m(y,null,v,!0))}}),!!o.length){for(s.sort(t),vO(o),vO(s),a=0,u=s.length;a<u;++a)s[a].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,u=c.length;a<u;++a)i.point((f=c[a])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,a=c.length-1;a>=0;--a)i.point((f=c[a])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function vO(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function hb(e){return ke(e[0])<=xe?e[0]:Xr(e[0])*((ke(e[0])+xe)%Un-xe)}function Fie(e,t){var n=hb(t),r=t[1],i=se(r),o=[se(n),-le(n),0],s=0,a=0,u=new In;i===1?r=pt+ue:i===-1&&(r=-pt-ue);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],p=hb(h),g=h[1]/2+R1,m=se(g),y=le(g),v=0;v<d;++v,p=b,m=S,y=E,h=x){var x=f[v],b=hb(x),w=x[1]/2+R1,S=se(w),E=le(w),_=b-p,k=_>=0?1:-1,$=k*_,C=$>xe,R=m*S;if(u.add(ai(R*k*se($),y*E+R*le($))),s+=C?_+k*Un:_,C^p>=n^b>=n){var A=vf(fl(h),fl(x));B1(A);var F=vf(o,A);B1(F);var T=(C^_>=0?-1:1)*fr(F[2]);(r>T||r===T&&(A[0]||A[1]))&&(a+=C^_>=0?1:-1)}}return(s<-ue||s<ue&&u<-O1)^a&1}function Q9(e,t,n,r){return function(i){var o=t(i),s=Y9(),a=t(s),u=!1,l,c,f,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=x,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=q6(c);var b=Fie(l,r);c.length?(u||(i.polygonStart(),u=!0),X9(c,Nie,b,n,i)):b&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(b,w){e(b,w)&&i.point(b,w)}function p(b,w){o.point(b,w)}function g(){d.point=p,o.lineStart()}function m(){d.point=h,o.lineEnd()}function y(b,w){f.push([b,w]),a.point(b,w)}function v(){a.lineStart(),f=[]}function x(){y(f[0][0],f[0][1]),a.lineEnd();var b=a.clean(),w=s.result(),S,E=w.length,_,k,$;if(f.pop(),l.push(f),f=null,!!E){if(b&1){if(k=w[0],(_=k.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),S=0;S<_;++S)i.point(($=k[S])[0],$[1]);i.lineEnd()}return}E>1&&b&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(Mie))}}return d}}function Mie(e){return e.length>1}function Nie(e,t){return((e=e.x)[0]<0?e[1]-pt-ue:pt-e[1])-((t=t.x)[0]<0?t[1]-pt-ue:pt-t[1])}const xO=Q9(function(){return!0},Oie,Die,[-xe,-pt]);function Oie(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,s){var a=o>0?xe:-xe,u=ke(o-t);ke(u-xe)<ue?(e.point(t,n=(n+s)/2>0?pt:-pt),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(o,n),i=0):r!==a&&u>=xe&&(ke(t-r)<ue&&(t-=r*ue),ke(o-a)<ue&&(o-=a*ue),n=Rie(t,n,o,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),i=0),e.point(t=o,n=s),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function Rie(e,t,n,r){var i,o,s=se(e-n);return ke(s)>ue?ed((se(t)*(o=le(r))*se(n)-se(r)*(i=le(t))*se(e))/(i*o*s)):(t+r)/2}function Die(e,t,n,r){var i;if(e==null)i=n*pt,r.point(-xe,i),r.point(0,i),r.point(xe,i),r.point(xe,0),r.point(xe,-i),r.point(0,-i),r.point(-xe,-i),r.point(-xe,0),r.point(-xe,i);else if(ke(e[0]-t[0])>ue){var o=e[0]<t[0]?xe:-xe;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function Pie(e){var t=le(e),n=2*ye,r=t>0,i=ke(t)>ue;function o(c,f,d,h){Tie(h,e,n,d,c,f)}function s(c,f){return le(c)*le(f)>t}function a(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,y){var v=[m,y],x,b=s(m,y),w=r?b?0:l(m,y):b?l(m+(m<0?xe:-xe),y):0;if(!f&&(p=h=b)&&c.lineStart(),b!==h&&(x=u(f,v),(!x||m0(f,x)||m0(v,x))&&(v[2]=1)),b!==h)g=0,b?(c.lineStart(),x=u(v,f),c.point(x[0],x[1])):(x=u(f,v),c.point(x[0],x[1],2),c.lineEnd()),f=x;else if(i&&f&&r^b){var S;!(w&d)&&(S=u(v,f,!0))&&(g=0,r?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}b&&(!f||!m0(f,v))&&c.point(v[0],v[1]),f=v,h=b,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function u(c,f,d){var h=fl(c),p=fl(f),g=[1,0,0],m=vf(h,p),y=Em(m,m),v=m[0],x=y-v*v;if(!x)return!d&&c;var b=t*y/x,w=-t*v/x,S=vf(g,m),E=Sm(g,b),_=Sm(m,w);db(E,_);var k=S,$=Em(E,k),C=Em(k,k),R=$*$-C*(Em(E,E)-1);if(!(R<0)){var A=Wn(R),F=Sm(k,(-$-A)/C);if(db(F,E),F=I1(F),!d)return F;var T=c[0],M=f[0],P=c[1],N=f[1],O;M<T&&(O=T,T=M,M=O);var j=M-T,X=ke(j-xe)<ue,re=X||j<ue;if(!X&&N<P&&(O=P,P=N,N=O),re?X?P+N>0^F[1]<(ke(F[0]-T)<ue?P:N):P<=F[1]&&F[1]<=N:j>xe^(T<=F[0]&&F[0]<=M)){var be=Sm(k,(-$+A)/C);return db(be,E),[F,I1(be)]}}}function l(c,f){var d=r?e:xe-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return Q9(s,a,o,r?[0,-e]:[-xe,e-xe])}function Lie(e,t,n,r,i,o){var s=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,d=u-s,h=l-a,p;if(p=n-s,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-s,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=o-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=s+c*d,e[1]=a+c*h),f<1&&(t[0]=s+f*d,t[1]=a+f*h),!0}}}}}var sh=1e9,km=-sh;function K9(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function o(l,c,f,d){var h=0,p=0;if(l==null||(h=s(l,f))!==(p=s(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function s(l,c){return ke(l[0]-e)<ue?c>0?0:3:ke(l[0]-n)<ue?c>0?2:1:ke(l[1]-t)<ue?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=s(l,1),d=s(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=Y9(),d,h,p,g,m,y,v,x,b,w,S,E={point:_,lineStart:R,lineEnd:A,polygonStart:$,polygonEnd:C};function _(T,M){i(T,M)&&c.point(T,M)}function k(){for(var T=0,M=0,P=h.length;M<P;++M)for(var N=h[M],O=1,j=N.length,X=N[0],re,be,he=X[0],Le=X[1];O<j;++O)re=he,be=Le,X=N[O],he=X[0],Le=X[1],be<=r?Le>r&&(he-re)*(r-be)>(Le-be)*(e-re)&&++T:Le<=r&&(he-re)*(r-be)<(Le-be)*(e-re)&&--T;return T}function $(){c=f,d=[],h=[],S=!0}function C(){var T=k(),M=S&&T,P=(d=q6(d)).length;(M||P)&&(l.polygonStart(),M&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),P&&X9(d,a,T,o,l),l.polygonEnd()),c=l,d=h=p=null}function R(){E.point=F,h&&h.push(p=[]),w=!0,b=!1,v=x=NaN}function A(){d&&(F(g,m),y&&b&&f.rejoin(),d.push(f.result())),E.point=_,b&&c.lineEnd()}function F(T,M){var P=i(T,M);if(h&&p.push([T,M]),w)g=T,m=M,y=P,w=!1,P&&(c.lineStart(),c.point(T,M));else if(P&&b)c.point(T,M);else{var N=[v=Math.max(km,Math.min(sh,v)),x=Math.max(km,Math.min(sh,x))],O=[T=Math.max(km,Math.min(sh,T)),M=Math.max(km,Math.min(sh,M))];Lie(N,O,e,t,n,r)?(b||(c.lineStart(),c.point(N[0],N[1])),c.point(O[0],O[1]),P||c.lineEnd(),S=!1):P&&(c.lineStart(),c.point(T,M),S=!1)}v=T,x=M,b=P}return E}}function bO(e,t,n){var r=kr(e,t-ue,n).concat(t);return function(i){return r.map(function(o){return[i,o]})}}function wO(e,t,n){var r=kr(e,t-ue,n).concat(t);return function(i){return r.map(function(o){return[o,i]})}}function zie(){var e,t,n,r,i,o,s,a,u=10,l=u,c=90,f=360,d,h,p,g,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return kr(wm(r/c)*c,n,c).map(p).concat(kr(wm(a/f)*f,s,f).map(g)).concat(kr(wm(t/u)*u,e,u).filter(function(x){return ke(x%c)>ue}).map(d)).concat(kr(wm(o/l)*l,i,l).filter(function(x){return ke(x%f)>ue}).map(h))}return y.lines=function(){return v().map(function(x){return{type:"LineString",coordinates:x}})},y.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(s).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},y.extent=function(x){return arguments.length?y.extentMajor(x).extentMinor(x):y.extentMinor()},y.extentMajor=function(x){return arguments.length?(r=+x[0][0],n=+x[1][0],a=+x[0][1],s=+x[1][1],r>n&&(x=r,r=n,n=x),a>s&&(x=a,a=s,s=x),y.precision(m)):[[r,a],[n,s]]},y.extentMinor=function(x){return arguments.length?(t=+x[0][0],e=+x[1][0],o=+x[0][1],i=+x[1][1],t>e&&(x=t,t=e,e=x),o>i&&(x=o,o=i,i=x),y.precision(m)):[[t,o],[e,i]]},y.step=function(x){return arguments.length?y.stepMajor(x).stepMinor(x):y.stepMinor()},y.stepMajor=function(x){return arguments.length?(c=+x[0],f=+x[1],y):[c,f]},y.stepMinor=function(x){return arguments.length?(u=+x[0],l=+x[1],y):[u,l]},y.precision=function(x){return arguments.length?(m=+x,d=bO(o,i,90),h=wO(t,e,m),p=bO(a,s,90),g=wO(r,n,m),y):m},y.extentMajor([[-180,-90+ue],[180,90-ue]]).extentMinor([[-180,-80-ue],[180,80+ue]])}const Sp=e=>e;var pb=new In,lS=new In,J9,Z9,cS,fS,ts={point:Qt,lineStart:Qt,lineEnd:Qt,polygonStart:function(){ts.lineStart=Iie,ts.lineEnd=jie},polygonEnd:function(){ts.lineStart=ts.lineEnd=ts.point=Qt,pb.add(ke(lS)),lS=new In},result:function(){var e=pb/2;return pb=new In,e}};function Iie(){ts.point=Bie}function Bie(e,t){ts.point=e7,J9=cS=e,Z9=fS=t}function e7(e,t){lS.add(fS*e-cS*t),cS=e,fS=t}function jie(){e7(J9,Z9)}var xf=1/0,Y1=xf,_p=-xf,X1=_p,Q1={point:Uie,lineStart:Qt,lineEnd:Qt,polygonStart:Qt,polygonEnd:Qt,result:function(){var e=[[xf,Y1],[_p,X1]];return _p=X1=-(Y1=xf=1/0),e}};function Uie(e,t){e<xf&&(xf=e),e>_p&&(_p=e),t<Y1&&(Y1=t),t>X1&&(X1=t)}var dS=0,hS=0,ah=0,K1=0,J1=0,Ac=0,pS=0,gS=0,uh=0,t7,n7,co,fo,Gr={point:dl,lineStart:EO,lineEnd:SO,polygonStart:function(){Gr.lineStart=Hie,Gr.lineEnd=Gie},polygonEnd:function(){Gr.point=dl,Gr.lineStart=EO,Gr.lineEnd=SO},result:function(){var e=uh?[pS/uh,gS/uh]:Ac?[K1/Ac,J1/Ac]:ah?[dS/ah,hS/ah]:[NaN,NaN];return dS=hS=ah=K1=J1=Ac=pS=gS=uh=0,e}};function dl(e,t){dS+=e,hS+=t,++ah}function EO(){Gr.point=Wie}function Wie(e,t){Gr.point=qie,dl(co=e,fo=t)}function qie(e,t){var n=e-co,r=t-fo,i=Wn(n*n+r*r);K1+=i*(co+e)/2,J1+=i*(fo+t)/2,Ac+=i,dl(co=e,fo=t)}function SO(){Gr.point=dl}function Hie(){Gr.point=Vie}function Gie(){r7(t7,n7)}function Vie(e,t){Gr.point=r7,dl(t7=co=e,n7=fo=t)}function r7(e,t){var n=e-co,r=t-fo,i=Wn(n*n+r*r);K1+=i*(co+e)/2,J1+=i*(fo+t)/2,Ac+=i,i=fo*e-co*t,pS+=i*(co+e),gS+=i*(fo+t),uh+=i*3,dl(co=e,fo=t)}function i7(e){this._context=e}i7.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Un);break}}},result:Qt};var mS=new In,gb,o7,s7,lh,ch,kp={point:Qt,lineStart:function(){kp.point=Yie},lineEnd:function(){gb&&a7(o7,s7),kp.point=Qt},polygonStart:function(){gb=!0},polygonEnd:function(){gb=null},result:function(){var e=+mS;return mS=new In,e}};function Yie(e,t){kp.point=a7,o7=lh=e,s7=ch=t}function a7(e,t){lh-=e,ch-=t,mS.add(Wn(lh*lh+ch*ch)),lh=e,ch=t}let _O,Z1,kO,$O;class CO{constructor(t){this._append=t==null?u7:Xie(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==kO||this._append!==Z1){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,kO=r,Z1=this._append,$O=this._,this._=i}this._+=$O;break}}}result(){const t=this._;return this._="",t.length?t:null}}function u7(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Xie(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return u7;if(t!==_O){const n=10**t;_O=t,Z1=function(i){let o=1;this._+=i[0];for(const s=i.length;o<s;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}return Z1}function l7(e,t){let n=3,r=4.5,i,o;function s(a){return a&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),es(a,i(o))),o.result()}return s.area=function(a){return es(a,i(ts)),ts.result()},s.measure=function(a){return es(a,i(kp)),kp.result()},s.bounds=function(a){return es(a,i(Q1)),Q1.result()},s.centroid=function(a){return es(a,i(Gr)),Gr.result()},s.projection=function(a){return arguments.length?(i=a==null?(e=null,Sp):(e=a).stream,s):e},s.context=function(a){return arguments.length?(o=a==null?(t=null,new CO(n)):new i7(t=a),typeof r!="function"&&o.pointRadius(r),s):t},s.pointRadius=function(a){return arguments.length?(r=typeof a=="function"?a:(o.pointRadius(+a),+a),s):r},s.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);n=u}return t===null&&(o=new CO(n)),s},s.projection(e).digits(n).context(t)}function Kv(e){return function(t){var n=new yS;for(var r in e)n[r]=e[r];return n.stream=t,n}}function yS(){}yS.prototype={constructor:yS,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function rA(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),es(n,e.stream(Q1)),t(Q1.result()),r!=null&&e.clipExtent(r),e}function Jv(e,t,n){return rA(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),a=+t[0][0]+(i-s*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(o-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,u])},n)}function iA(e,t,n){return Jv(e,[[0,0],t],n)}function oA(e,t,n){return rA(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),s=(i-o*(r[1][0]+r[0][0]))/2,a=-o*r[0][1];e.scale(150*o).translate([s,a])},n)}function sA(e,t,n){return rA(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),s=-o*r[0][0],a=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,a])},n)}var AO=16,Qie=le(30*ye);function TO(e,t){return+t?Jie(e,t):Kie(e)}function Kie(e){return Kv({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Jie(e,t){function n(r,i,o,s,a,u,l,c,f,d,h,p,g,m){var y=l-r,v=c-i,x=y*y+v*v;if(x>4*t&&g--){var b=s+d,w=a+h,S=u+p,E=Wn(b*b+w*w+S*S),_=fr(S/=E),k=ke(ke(S)-1)<ue||ke(o-f)<ue?(o+f)/2:ai(w,b),$=e(k,_),C=$[0],R=$[1],A=C-r,F=R-i,T=v*A-y*F;(T*T/x>t||ke((y*A+v*F)/x-.5)>.3||s*d+a*h+u*p<Qie)&&(n(r,i,o,s,a,u,C,R,k,b/=E,w/=E,S,g,m),m.point(C,R),n(C,R,k,b,w,S,l,c,f,d,h,p,g,m))}}return function(r){var i,o,s,a,u,l,c,f,d,h,p,g,m={point:y,lineStart:v,lineEnd:b,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=v}};function y(_,k){_=e(_,k),r.point(_[0],_[1])}function v(){f=NaN,m.point=x,r.lineStart()}function x(_,k){var $=fl([_,k]),C=e(_,k);n(f,d,c,h,p,g,f=C[0],d=C[1],c=_,h=$[0],p=$[1],g=$[2],AO,r),r.point(f,d)}function b(){m.point=y,r.lineEnd()}function w(){v(),m.point=S,m.lineEnd=E}function S(_,k){x(i=_,k),o=f,s=d,a=h,u=p,l=g,m.point=x}function E(){n(f,d,c,h,p,g,o,s,i,a,u,l,AO,r),m.lineEnd=b,b()}return m}}var Zie=Kv({point:function(e,t){this.stream.point(e*ye,t*ye)}});function eoe(e){return Kv({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function toe(e,t,n,r,i){function o(s,a){return s*=r,a*=i,[t+e*s,n-e*a]}return o.invert=function(s,a){return[(s-t)/e*r,(n-a)/e*i]},o}function FO(e,t,n,r,i,o){if(!o)return toe(e,t,n,r,i);var s=le(o),a=se(o),u=s*e,l=a*e,c=s/e,f=a/e,d=(a*n-s*t)/e,h=(a*t+s*n)/e;function p(g,m){return g*=r,m*=i,[u*g-l*m+t,n-l*g-u*m]}return p.invert=function(g,m){return[r*(c*g-f*m+d),i*(h-f*g-c*m)]},p}function Ro(e){return c7(function(){return e})()}function c7(e){var t,n=150,r=480,i=250,o=0,s=0,a=0,u=0,l=0,c,f=0,d=1,h=1,p=null,g=xO,m=null,y,v,x,b=Sp,w=.5,S,E,_,k,$;function C(T){return _(T[0]*ye,T[1]*ye)}function R(T){return T=_.invert(T[0],T[1]),T&&[T[0]*mt,T[1]*mt]}C.stream=function(T){return k&&$===T?k:k=Zie(eoe(c)(g(S(b($=T)))))},C.preclip=function(T){return arguments.length?(g=T,p=void 0,F()):g},C.postclip=function(T){return arguments.length?(b=T,m=y=v=x=null,F()):b},C.clipAngle=function(T){return arguments.length?(g=+T?Pie(p=T*ye):(p=null,xO),F()):p*mt},C.clipExtent=function(T){return arguments.length?(b=T==null?(m=y=v=x=null,Sp):K9(m=+T[0][0],y=+T[0][1],v=+T[1][0],x=+T[1][1]),F()):m==null?null:[[m,y],[v,x]]},C.scale=function(T){return arguments.length?(n=+T,A()):n},C.translate=function(T){return arguments.length?(r=+T[0],i=+T[1],A()):[r,i]},C.center=function(T){return arguments.length?(o=T[0]%360*ye,s=T[1]%360*ye,A()):[o*mt,s*mt]},C.rotate=function(T){return arguments.length?(a=T[0]%360*ye,u=T[1]%360*ye,l=T.length>2?T[2]%360*ye:0,A()):[a*mt,u*mt,l*mt]},C.angle=function(T){return arguments.length?(f=T%360*ye,A()):f*mt},C.reflectX=function(T){return arguments.length?(d=T?-1:1,A()):d<0},C.reflectY=function(T){return arguments.length?(h=T?-1:1,A()):h<0},C.precision=function(T){return arguments.length?(S=TO(E,w=T*T),F()):Wn(w)},C.fitExtent=function(T,M){return Jv(C,T,M)},C.fitSize=function(T,M){return iA(C,T,M)},C.fitWidth=function(T,M){return oA(C,T,M)},C.fitHeight=function(T,M){return sA(C,T,M)};function A(){var T=FO(n,0,0,d,h,f).apply(null,t(o,s)),M=FO(n,r-T[0],i-T[1],d,h,f);return c=V9(a,u,l),E=aS(t,M),_=aS(c,E),S=TO(E,w),F()}function F(){return k=$=null,C}return function(){return t=e.apply(this,arguments),C.invert=t.invert&&R,A()}}function aA(e){var t=0,n=xe/3,r=c7(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*ye,n=o[1]*ye):[t*mt,n*mt]},i}function noe(e){var t=le(e);function n(r,i){return[r*t,se(i)/t]}return n.invert=function(r,i){return[r/t,fr(i*t)]},n}function roe(e,t){var n=se(e),r=(n+se(t))/2;if(ke(r)<ue)return noe(e);var i=1+n*(2*r-n),o=Wn(i)/r;function s(a,u){var l=Wn(i-2*r*se(u))/r;return[l*se(a*=r),o-l*le(a)]}return s.invert=function(a,u){var l=o-u,c=ai(a,ke(l))*Xr(l);return l*r<0&&(c-=xe*Xr(a)*Xr(l)),[c/r,fr((i-(a*a+l*l)*r*r)/(2*r))]},s}function ey(){return aA(roe).scale(155.424).center([0,33.6442])}function f7(){return ey().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function ioe(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function ooe(){var e,t,n=f7(),r,i=ey().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,s=ey().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,r.point(h,p),u||(o.point(h,p),u)||(a.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?s:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=ioe([n.stream(t=d),i.stream(d),s.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),s.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),s.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),o=i.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+ue,g+.12*h+ue],[p-.214*h-ue,g+.234*h-ue]]).stream(l),a=s.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+ue,g+.166*h+ue],[p-.115*h-ue,g+.234*h-ue]]).stream(l),f()},c.fitExtent=function(d,h){return Jv(c,d,h)},c.fitSize=function(d,h){return iA(c,d,h)},c.fitWidth=function(d,h){return oA(c,d,h)},c.fitHeight=function(d,h){return sA(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function d7(e){return function(t,n){var r=le(t),i=le(n),o=e(r*i);return o===1/0?[2,0]:[o*i*se(t),o*se(n)]}}function bg(e){return function(t,n){var r=Wn(t*t+n*n),i=e(r),o=se(i),s=le(i);return[ai(t*o,r*s),fr(r&&n*o/r)]}}var h7=d7(function(e){return Wn(2/(1+e))});h7.invert=bg(function(e){return 2*fr(e/2)});function soe(){return Ro(h7).scale(124.75).clipAngle(180-.001)}var p7=d7(function(e){return(e=P9(e))&&e/se(e)});p7.invert=bg(function(e){return e});function aoe(){return Ro(p7).scale(79.4188).clipAngle(180-.001)}function Zv(e,t){return[e,D1(tA((pt+t)/2))]}Zv.invert=function(e,t){return[e,2*ed(D9(t))-pt]};function uoe(){return g7(Zv).scale(961/Un)}function g7(e){var t=Ro(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,s=null,a,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?s=a=u=l=null:(s=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):s==null?null:[[s,a],[u,l]]};function c(){var f=xe*r(),d=t(Aie(t.rotate()).invert([0,0]));return o(s==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Zv?[[Math.max(d[0]-f,s),a],[Math.min(d[0]+f,u),l]]:[[s,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return c()}function $m(e){return tA((pt+e)/2)}function loe(e,t){var n=le(e),r=e===t?se(e):D1(n/le(t))/D1($m(t)/$m(e)),i=n*fb($m(e),r)/r;if(!r)return Zv;function o(s,a){i>0?a<-pt+ue&&(a=-pt+ue):a>pt-ue&&(a=pt-ue);var u=i/fb($m(a),r);return[u*se(r*s),i-u*le(r*s)]}return o.invert=function(s,a){var u=i-a,l=Xr(r)*Wn(s*s+u*u),c=ai(s,ke(u))*Xr(u);return u*r<0&&(c-=xe*Xr(s)*Xr(u)),[c/r,2*ed(fb(i/l,1/r))-pt]},o}function coe(){return aA(loe).scale(109.5).parallels([30,30])}function ty(e,t){return[e,t]}ty.invert=ty;function foe(){return Ro(ty).scale(152.63)}function doe(e,t){var n=le(e),r=e===t?se(e):(n-le(t))/(t-e),i=n/r+e;if(ke(r)<ue)return ty;function o(s,a){var u=i-a,l=r*s;return[u*se(l),i-u*le(l)]}return o.invert=function(s,a){var u=i-a,l=ai(s,ke(u))*Xr(u);return u*r<0&&(l-=xe*Xr(s)*Xr(u)),[l/r,i-Xr(r)*Wn(s*s+u*u)]},o}function hoe(){return aA(doe).scale(131.154).center([0,13.9389])}var Dh=1.340264,Ph=-.081106,Lh=893e-6,zh=.003796,ny=Wn(3)/2,poe=12;function m7(e,t){var n=fr(ny*se(t)),r=n*n,i=r*r*r;return[e*le(n)/(ny*(Dh+3*Ph*r+i*(7*Lh+9*zh*r))),n*(Dh+Ph*r+i*(Lh+zh*r))]}m7.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,o=0,s,a,u;o<poe&&(a=n*(Dh+Ph*r+i*(Lh+zh*r))-t,u=Dh+3*Ph*r+i*(7*Lh+9*zh*r),n-=s=a/u,r=n*n,i=r*r*r,!(ke(s)<O1));++o);return[ny*e*(Dh+3*Ph*r+i*(7*Lh+9*zh*r))/le(n),fr(se(n)/ny)]};function goe(){return Ro(m7).scale(177.158)}function y7(e,t){var n=le(t),r=le(e)*n;return[n*se(e)/r,se(t)/r]}y7.invert=bg(ed);function moe(){return Ro(y7).scale(144.049).clipAngle(60)}function yoe(){var e=1,t=0,n=0,r=1,i=1,o=0,s,a,u=null,l,c,f,d=1,h=1,p=Kv({point:function(b,w){var S=x([b,w]);this.stream.point(S[0],S[1])}}),g=Sp,m,y;function v(){return d=e*r,h=e*i,m=y=null,x}function x(b){var w=b[0]*d,S=b[1]*h;if(o){var E=S*s-w*a;w=w*s+S*a,S=E}return[w+t,S+n]}return x.invert=function(b){var w=b[0]-t,S=b[1]-n;if(o){var E=S*s+w*a;w=w*s-S*a,S=E}return[w/d,S/h]},x.stream=function(b){return m&&y===b?m:m=p(g(y=b))},x.postclip=function(b){return arguments.length?(g=b,u=l=c=f=null,v()):g},x.clipExtent=function(b){return arguments.length?(g=b==null?(u=l=c=f=null,Sp):K9(u=+b[0][0],l=+b[0][1],c=+b[1][0],f=+b[1][1]),v()):u==null?null:[[u,l],[c,f]]},x.scale=function(b){return arguments.length?(e=+b,v()):e},x.translate=function(b){return arguments.length?(t=+b[0],n=+b[1],v()):[t,n]},x.angle=function(b){return arguments.length?(o=b%360*ye,a=se(o),s=le(o),v()):o*mt},x.reflectX=function(b){return arguments.length?(r=b?-1:1,v()):r<0},x.reflectY=function(b){return arguments.length?(i=b?-1:1,v()):i<0},x.fitExtent=function(b,w){return Jv(x,b,w)},x.fitSize=function(b,w){return iA(x,b,w)},x.fitWidth=function(b,w){return oA(x,b,w)},x.fitHeight=function(b,w){return sA(x,b,w)},x}function v7(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}v7.invert=function(e,t){var n=t,r=25,i;do{var o=n*n,s=o*o;n-=i=(n*(1.007226+o*(.015085+s*(-.044475+.028874*o-.005916*s)))-t)/(1.007226+o*(.015085*3+s*(-.044475*7+.028874*9*o-.005916*11*s)))}while(ke(i)>ue&&--r>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function voe(){return Ro(v7).scale(175.295)}function x7(e,t){return[le(t)*se(e),se(t)]}x7.invert=bg(fr);function xoe(){return Ro(x7).scale(249.5).clipAngle(90+ue)}function b7(e,t){var n=le(t),r=1+le(e)*n;return[n*se(e)/r,se(t)/r]}b7.invert=bg(function(e){return 2*ed(e)});function boe(){return Ro(b7).scale(250).clipAngle(142)}function w7(e,t){return[D1(tA((pt+t)/2)),-e]}w7.invert=function(e,t){return[-t,2*ed(D9(e))-pt]};function woe(){var e=g7(w7),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var Eoe=Math.abs,vS=Math.cos,ry=Math.sin,Soe=1e-6,E7=Math.PI,xS=E7/2,MO=_oe(2);function NO(e){return e>1?xS:e<-1?-xS:Math.asin(e)}function _oe(e){return e>0?Math.sqrt(e):0}function koe(e,t){var n=e*ry(t),r=30,i;do t-=i=(t+ry(t)-n)/(1+vS(t));while(Eoe(i)>Soe&&--r>0);return t/2}function $oe(e,t,n){function r(i,o){return[e*i*vS(o=koe(n,o)),t*ry(o)]}return r.invert=function(i,o){return o=NO(o/t),[i/(e*vS(o)),NO((2*o+ry(2*o))/n)]},r}var Coe=$oe(MO/xS,MO,E7);function Aoe(){return Ro(Coe).scale(169.529)}const Toe=l7(),bS=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Foe(e,t){return function n(){const r=t();return r.type=e,r.path=l7().projection(r),r.copy=r.copy||function(){const i=n();return bS.forEach(o=>{r[o]&&i[o](r[o]())}),i.path.pointRadius(r.path.pointRadius()),i},j8(r)}}function uA(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(iy[e]=Foe(e,t),this):iy[e]||null}function S7(e){return e&&e.path||Toe}const iy={albers:f7,albersusa:ooe,azimuthalequalarea:soe,azimuthalequidistant:aoe,conicconformal:coe,conicequalarea:ey,conicequidistant:hoe,equalEarth:goe,equirectangular:foe,gnomonic:moe,identity:yoe,mercator:uoe,mollweide:Aoe,naturalEarth1:voe,orthographic:xoe,stereographic:boe,transversemercator:woe};for(const e in iy)uA(e,iy[e]);function Moe(){}const qo=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function _7(){var e=1,t=1,n=a;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return o(u,l,d=>{n(d,u,l),Noe(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(Ooe((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function o(u,l,c){var f=new Array,d=new Array,h,p,g,m,y,v;for(h=p=-1,m=u[0]>=l,qo[m<<1].forEach(x);++h<e-1;)g=m,m=u[h+1]>=l,qo[g|m<<1].forEach(x);for(qo[m<<0].forEach(x);++p<t-1;){for(h=-1,m=u[p*e+e]>=l,y=u[p*e]>=l,qo[m<<1|y<<2].forEach(x);++h<e-1;)g=m,m=u[p*e+e+h+1]>=l,v=y,y=u[p*e+h+1]>=l,qo[g|m<<1|y<<2|v<<3].forEach(x);qo[m|y<<3].forEach(x)}for(h=-1,y=u[p*e]>=l,qo[y<<2].forEach(x);++h<e-1;)v=y,y=u[p*e+h+1]>=l,qo[y<<2|v<<3].forEach(x);qo[y<<3].forEach(x);function x(b){var w=[b[0][0]+h,b[0][1]+p],S=[b[1][0]+h,b[1][1]+p],E=s(w),_=s(S),k,$;(k=d[E])?($=f[_])?(delete d[k.end],delete f[$.start],k===$?(k.ring.push(S),c(k.ring)):f[k.start]=d[$.end]={start:k.start,end:$.end,ring:k.ring.concat($.ring)}):(delete d[k.end],k.ring.push(S),d[k.end=_]=k):(k=f[_])?($=d[E])?(delete f[k.start],delete d[$.end],k===$?(k.ring.push(S),c(k.ring)):f[$.start]=d[k.end]={start:$.start,end:k.end,ring:$.ring.concat(k.ring)}):(delete f[k.start],k.ring.unshift(w),f[k.start=E]=k):f[E]=d[_]={start:E,end:_,ring:[w,S]}}}function s(u){return u[0]*2+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,m,y=l[g*e+p];d>0&&d<e&&p===d&&(m=l[g*e+p-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&g===h&&(m=l[(g-1)*e+p],f[1]=h+(c-m)/(y-m)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||z("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?a:Moe,r):n===a},r}function Noe(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function Ooe(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=Roe(e,t[n]))return i;return 0}function Roe(e,t){for(var n=t[0],r=t[1],i=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var u=e[o],l=u[0],c=u[1],f=e[a],d=f[0],h=f[1];if(Doe(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function Doe(e,t,n){var r;return Poe(e,t,n)&&Loe(e[r=+(e[0]===t[0])],n[r],t[r])}function Poe(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function Loe(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function k7(e,t,n){return function(r){var i=Eo(r),o=n?Math.min(i[0],0):i[0],s=i[1],a=s-o,u=t?Ta(o,s,e):a/(e+1);return kr(o+u,s,u)}}function lA(e){D.call(this,null,e)}lA.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};G(lA,D,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||_n,o=_7().smooth(e.smooth!==!1),s=e.thresholds||zoe(r,i,e),a=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=o.size([c.width,c.height])(c.values,I(s)?s:s(c.values));Ioe(f,c,l,e),f.forEach(d=>{u.push(gv(l,Pe(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function zoe(e,t,n){const r=k7(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>Gu(t(i).values)))}function Ioe(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;if(ge(i)&&(i=i(n,r)),ge(o)&&(o=o(n,r)),(i===1||i==null)&&!o)return;const s=(Te(i)?i:i[0])||1,a=(Te(i)?i:i[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach($7(t,s,a,u,l))}function $7(e,t,n,r,i){const o=e.x1||0,s=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+r,f[1]=(f[1]-s)*n+i}return function(f){return f.coordinates.forEach(u),f}}function OO(e,t,n){const r=e>=0?e:Jk(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function mb(e){return ge(e)?e:kn(+e)}function C7(){var e=u=>u[0],t=u=>u[1],n=jf,r=[-1,-1],i=960,o=500,s=2;function a(u,l){const c=OO(r[0],u,e)>>s,f=OO(r[1],u,t)>>s,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>s),g=2*h+(o>>s),m=new Float32Array(p*g),y=new Float32Array(p*g);let v=m;u.forEach(b=>{const w=d+(+e(b)>>s),S=h+(+t(b)>>s);w>=0&&w<p&&S>=0&&S<g&&(m[w+S*p]+=+n(b))}),c>0&&f>0?(ec(p,g,m,y,c),tc(p,g,y,m,f),ec(p,g,m,y,c),tc(p,g,y,m,f),ec(p,g,m,y,c),tc(p,g,y,m,f)):c>0?(ec(p,g,m,y,c),ec(p,g,y,m,c),ec(p,g,m,y,c),v=y):f>0&&(tc(p,g,m,y,f),tc(p,g,y,m,f),tc(p,g,m,y,f),v=y);const x=l?Math.pow(2,-2*s):1/H6(v);for(let b=0,w=p*g;b<w;++b)v[b]*=x;return{values:v,scale:1<<s,width:p,height:g,x1:d,y1:h,x2:d+(i>>s),y2:h+(o>>s)}}return a.x=function(u){return arguments.length?(e=mb(u),a):e},a.y=function(u){return arguments.length?(t=mb(u),a):t},a.weight=function(u){return arguments.length?(n=mb(u),a):n},a.size=function(u){if(!arguments.length)return[i,o];var l=+u[0],c=+u[1];return l>=0&&c>=0||z("invalid size"),i=l,o=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||z("invalid cell size"),s=Math.floor(Math.log(u)/Math.LN2),a):1<<s},a.bandwidth=function(u){return arguments.length?(u=Q(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&z("invalid bandwidth"),r=u,a):r},a}function ec(e,t,n,r,i){const o=(i<<1)+1;for(let s=0;s<t;++s)for(let a=0,u=0;a<e+i;++a)a<e&&(u+=n[a+s*e]),a>=i&&(a>=o&&(u-=n[a-o+s*e]),r[a-i+s*e]=u/Math.min(a+1,e-1+o-a,o))}function tc(e,t,n,r,i){const o=(i<<1)+1;for(let s=0;s<e;++s)for(let a=0,u=0;a<t+i;++a)a<t&&(u+=n[s+a*e]),a>=i&&(a>=o&&(u-=n[s+(a-o)*e]),r[s+(a-i)*e]=u/Math.min(a+1,t-1+o-a,o))}function cA(e){D.call(this,null,e)}cA.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Boe=["x","y","weight","size","cellSize","bandwidth"];function A7(e,t){return Boe.forEach(n=>t[n]!=null?e[n](t[n]):0),e}G(cA,D,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=joe(r,e.groupby),o=(e.groupby||[]).map(gt),s=A7(C7(),e),a=e.as||"grid",u=[];function l(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return u=i.map(c=>Pe(l({[a]:s(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function joe(e,t){var n=[],r=c=>c(a),i,o,s,a,u,l;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function fA(e){D.call(this,null,e)}fA.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};G(fA,D,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=_7().smooth(e.smooth!==!1),i=e.values,o=e.thresholds||k7(e.count||10,e.nice,!!i),s=e.size,a,u;return i||(i=t.materialize(t.SOURCE).source,a=A7(C7(),e)(i,!0),u=$7(a,a.scale||1,a.scale||1,0,0),s=[a.width,a.height],i=a.values),o=I(o)?o:o(i),i=r.size(s)(i,o),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(Pe),n}});const wS="Feature",dA="FeatureCollection",Uoe="MultiPoint";function hA(e){D.call(this,null,e)}hA.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};G(hA,D,{transform(e,t){var n=this._features,r=this._points,i=e.fields,o=i&&i[0],s=i&&i[1],a=e.geojson||!i&&_n,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(xn(a))||o&&t.modified(xn(o))||s&&t.modified(xn(s)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),a&&t.visit(u,c=>n.push(a(c))),o&&s&&(t.visit(u,c=>{var f=o(c),d=s(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:wS,geometry:{type:Uoe,coordinates:r}})),this.value={type:dA,features:n}}});function pA(e){D.call(this,null,e)}pA.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};G(pA,D,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||_n,o=e.as||"path",s=n.SOURCE;!r||e.modified()?(this.value=r=S7(e.projection),n.materialize().reflow()):s=i===_n||t.modified(i.fields)?n.ADD_MOD:n.ADD;const a=Woe(r,e.pointRadius);return n.visit(s,u=>u[o]=r(i(u))),r.pointRadius(a),n.modifies(o)}});function Woe(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function gA(e){D.call(this,null,e)}gA.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};G(gA,D,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],o=e.as||["x","y"],s=o[0],a=o[1],u;function l(c){const f=n([r(c),i(c)]);f?(c[s]=f[0],c[a]=f[1]):(c[s]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(o)}});function mA(e){D.call(this,null,e)}mA.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};G(mA,D,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return(!r||e.modified())&&(this.value=r=qoe(S7(e.projection),e.field||ri("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,s=>s[i]=r),n.modifies(i)}});function qoe(e,t,n){const r=n==null?i=>e(t(i)):i=>{var o=e.pointRadius(),s=e.pointRadius(n)(t(i));return e.pointRadius(o),s};return r.context=i=>(e.context(i),r),r}function yA(e){D.call(this,[],e),this.generator=zie()}yA.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};G(yA,D,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const o in e)ge(r[o])&&r[o](e[o]);return i=r(),n.length?t.mod.push(BL(n[0],i)):t.add.push(Pe(i)),n[0]=i,t}});function vA(e){D.call(this,null,e)}vA.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};G(vA,D,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||_n,o=Goe(e.opacity,e),s=Hoe(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?Gu(n.map(l=>Gu(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=pe({},l,u);r||(f.$max=Gu(c.values||[])),l[a]=Voe(c,f,s.dep?s:kn(s(f)),o.dep?o:kn(o(f)))}),t.reflow(!0).modifies(a)}});function Hoe(e,t){let n;return ge(e)?(n=r=>Na(e(r,t)),n.dep=T7(e)):n=kn(Na(e||"#888")),n}function Goe(e,t){let n;return ge(e)?(n=r=>e(r,t),n.dep=T7(e)):e?n=kn(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function T7(e){if(!ge(e))return!1;const t=Bi(xn(e));return t.$x||t.$y||t.$value||t.$max}function Voe(e,t,n,r){const i=e.width,o=e.height,s=e.x1||0,a=e.y1||0,u=e.x2||i,l=e.y2||o,c=e.values,f=c?m=>c[m]:Ks,d=Sa(u-s,l-a),h=d.getContext("2d"),p=h.getImageData(0,0,u-s,l-a),g=p.data;for(let m=a,y=0;m<l;++m){t.$y=m-a;for(let v=s,x=m*i;v<u;++v,y+=4){t.$x=v-s,t.$value=f(v+x);const b=n(t);g[y+0]=b.r,g[y+1]=b.g,g[y+2]=b.b,g[y+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}function F7(e){D.call(this,null,e),this.modified(!0)}G(F7,D,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Xoe(e.type),bS.forEach(r=>{e[r]!=null&&RO(n,r,e[r])})):bS.forEach(r=>{e.modified(r)&&RO(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Yoe(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Yoe(e,t){const n=Qoe(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Xoe(e){const t=uA((e||"mercator").toLowerCase());return t||z("Unrecognized projection type: "+e),t()}function RO(e,t,n){ge(e[t])&&e[t](n)}function Qoe(e){return e=Q(e),e.length===1?e[0]:{type:dA,features:e.reduce((t,n)=>t.concat(Koe(n)),[])}}function Koe(e){return e.type===dA?e.features:Q(e).filter(t=>t!=null).map(t=>t.type===wS?t:{type:wS,geometry:t})}const Joe=Object.freeze(Object.defineProperty({__proto__:null,contour:fA,geojson:hA,geopath:pA,geopoint:gA,geoshape:mA,graticule:yA,heatmap:vA,isocontour:lA,kde2d:cA,projection:F7},Symbol.toStringTag,{value:"Module"}));function Zoe(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var o,s=n.length,a,u=0,l=0;for(o=0;o<s;++o)a=n[o],u+=a.x,l+=a.y;for(u=(u/s-e)*r,l=(l/s-t)*r,o=0;o<s;++o)a=n[o],a.x-=u,a.y-=l}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(e=+o,i):e},i.y=function(o){return arguments.length?(t=+o,i):t},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function ese(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return M7(this.cover(t,n),t,n,e)}function M7(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o=e._root,s={data:r},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,g,m,y,v;if(!o)return e._root=s,e;for(;o.length;)if((g=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,i=o,!(o=o[y=m<<1|g]))return i[y]=s,e;if(h=+e._x.call(null,o.data),p=+e._y.call(null,o.data),t===h&&n===p)return s.next=o,i?i[y]=s:e._root=s,e;do i=i?i[y]=new Array(4):e._root=new Array(4),(g=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((y=m<<1|g)===(v=(p>=d)<<1|h>=f));return i[v]=o,i[y]=s,e}function tse(e){var t,n,r=e.length,i,o,s=new Array(r),a=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(s[n]=i,a[n]=o,i<u&&(u=i),i>c&&(c=i),o<l&&(l=o),o>f&&(f=o));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)M7(this,s[n],a[n],e[n]);return this}function nse(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var s=i-n||1,a=this._root,u,l;n>e||e>=i||r>t||t>=o;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=a,a=u,s*=2,l){case 0:i=n+s,o=r+s;break;case 1:n=i-s,o=r+s;break;case 2:i=n+s,r=o-s;break;case 3:n=i-s,r=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function rse(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function ise(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Pn(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function ose(e,t,n){var r,i=this._x0,o=this._y0,s,a,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new Pn(h,i,o,c,f)),n==null?n=1/0:(i=e-n,o=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(s=p.x0)>c||(a=p.y0)>f||(u=p.x1)<i||(l=p.y1)<o))if(h.length){var m=(s+u)/2,y=(a+l)/2;d.push(new Pn(h[3],m,y,u,l),new Pn(h[2],s,y,m,l),new Pn(h[1],m,a,u,y),new Pn(h[0],s,a,m,y)),(g=(t>=y)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var v=e-+this._x.call(null,h.data),x=t-+this._y.call(null,h.data),b=v*v+x*x;if(b<n){var w=Math.sqrt(n=b);i=e-w,o=t-w,c=e+w,f=t+w,r=h.data}}return r}function sse(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,o,s=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,g,m,y;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(s+u)/2))?s=d:u=d,(g=f>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,y=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):t?(o?t[m]=o:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[y]=n:this._root=n),this):(this._root=o,this)}function ase(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function use(){return this._root}function lse(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function cse(e){var t=[],n,r=this._root,i,o,s,a,u;for(r&&t.push(new Pn(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,o=n.x0,s=n.y0,a=n.x1,u=n.y1)&&r.length){var l=(o+a)/2,c=(s+u)/2;(i=r[3])&&t.push(new Pn(i,l,c,a,u)),(i=r[2])&&t.push(new Pn(i,o,c,l,u)),(i=r[1])&&t.push(new Pn(i,l,s,a,c)),(i=r[0])&&t.push(new Pn(i,o,s,l,c))}return this}function fse(e){var t=[],n=[],r;for(this._root&&t.push(new Pn(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var o,s=r.x0,a=r.y0,u=r.x1,l=r.y1,c=(s+u)/2,f=(a+l)/2;(o=i[0])&&t.push(new Pn(o,s,a,c,f)),(o=i[1])&&t.push(new Pn(o,c,a,u,f)),(o=i[2])&&t.push(new Pn(o,s,f,c,l)),(o=i[3])&&t.push(new Pn(o,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function dse(e){return e[0]}function hse(e){return arguments.length?(this._x=e,this):this._x}function pse(e){return e[1]}function gse(e){return arguments.length?(this._y=e,this):this._y}function xA(e,t,n){var r=new bA(t??dse,n??pse,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function bA(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function DO(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Vn=xA.prototype=bA.prototype;Vn.copy=function(){var e=new bA(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=DO(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=DO(r));return e};Vn.add=ese;Vn.addAll=tse;Vn.cover=nse;Vn.data=rse;Vn.extent=ise;Vn.find=ose;Vn.remove=sse;Vn.removeAll=ase;Vn.root=use;Vn.size=lse;Vn.visit=cse;Vn.visitAfter=fse;Vn.x=hse;Vn.y=gse;function Ln(e){return function(){return e}}function ua(e){return(e()-.5)*1e-6}function mse(e){return e.x+e.vx}function yse(e){return e.y+e.vy}function vse(e){var t,n,r,i=1,o=1;typeof e!="function"&&(e=Ln(e==null?1:+e));function s(){for(var l,c=t.length,f,d,h,p,g,m,y=0;y<o;++y)for(f=xA(t,mse,yse).visitAfter(a),l=0;l<c;++l)d=t[l],g=n[d.index],m=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(v);function v(x,b,w,S,E){var _=x.data,k=x.r,$=g+k;if(_){if(_.index>d.index){var C=h-_.x-_.vx,R=p-_.y-_.vy,A=C*C+R*R;A<$*$&&(C===0&&(C=ua(r),A+=C*C),R===0&&(R=ua(r),A+=R*R),A=($-(A=Math.sqrt(A)))/A*i,d.vx+=(C*=A)*($=(k*=k)/(m+k)),d.vy+=(R*=A)*$,_.vx-=C*($=1-$),_.vy-=R*$)}return}return b>h+$||S<h-$||w>p+$||E<p-$}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return s.initialize=function(l,c){t=l,r=c,u()},s.iterations=function(l){return arguments.length?(o=+l,s):o},s.strength=function(l){return arguments.length?(i=+l,s):i},s.radius=function(l){return arguments.length?(e=typeof l=="function"?l:Ln(+l),u(),s):e},s}function xse(e){return e.index}function PO(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function bse(e){var t=xse,n=f,r,i=Ln(30),o,s,a,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(a[m.source.index],a[m.target.index])}function d(m){for(var y=0,v=e.length;y<c;++y)for(var x=0,b,w,S,E,_,k,$;x<v;++x)b=e[x],w=b.source,S=b.target,E=S.x+S.vx-w.x-w.vx||ua(l),_=S.y+S.vy-w.y-w.vy||ua(l),k=Math.sqrt(E*E+_*_),k=(k-o[x])/k*m*r[x],E*=k,_*=k,S.vx-=E*($=u[x]),S.vy-=_*$,w.vx+=E*($=1-$),w.vy+=_*$}function h(){if(s){var m,y=s.length,v=e.length,x=new Map(s.map((w,S)=>[t(w,S,s),w])),b;for(m=0,a=new Array(y);m<v;++m)b=e[m],b.index=m,typeof b.source!="object"&&(b.source=PO(x,b.source)),typeof b.target!="object"&&(b.target=PO(x,b.target)),a[b.source.index]=(a[b.source.index]||0)+1,a[b.target.index]=(a[b.target.index]||0)+1;for(m=0,u=new Array(v);m<v;++m)b=e[m],u[m]=a[b.source.index]/(a[b.source.index]+a[b.target.index]);r=new Array(v),p(),o=new Array(v),g()}}function p(){if(s)for(var m=0,y=e.length;m<y;++m)r[m]=+n(e[m],m,e)}function g(){if(s)for(var m=0,y=e.length;m<y;++m)o[m]=+i(e[m],m,e)}return d.initialize=function(m,y){s=m,l=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:Ln(+m),p(),d):n},d.distance=function(m){return arguments.length?(i=typeof m=="function"?m:Ln(+m),g(),d):i},d}var wse={value:()=>{}};function N7(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new y0(n)}function y0(e){this._=e}function Ese(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}y0.prototype=N7.prototype={constructor:y0,on:function(e,t){var n=this._,r=Ese(e+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(e=r[o]).type)&&(i=Sse(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=r[o]).type)n[i]=LO(n[i],e.name,t);else if(t==null)for(i in n)n[i]=LO(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new y0(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function Sse(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function LO(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=wse,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var bf=0,fh=0,Nd=0,O7=1e3,oy,dh,sy=0,hl=0,ex=0,$p=typeof performance=="object"&&performance.now?performance:Date,R7=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function wA(){return hl||(R7(_se),hl=$p.now()+ex)}function _se(){hl=0}function ay(){this._call=this._time=this._next=null}ay.prototype=D7.prototype={constructor:ay,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?wA():+n)+(t==null?0:+t),!this._next&&dh!==this&&(dh?dh._next=this:oy=this,dh=this),this._call=e,this._time=n,ES()},stop:function(){this._call&&(this._call=null,this._time=1/0,ES())}};function D7(e,t,n){var r=new ay;return r.restart(e,t,n),r}function kse(){wA(),++bf;for(var e=oy,t;e;)(t=hl-e._time)>=0&&e._call.call(void 0,t),e=e._next;--bf}function zO(){hl=(sy=$p.now())+ex,bf=fh=0;try{kse()}finally{bf=0,Cse(),hl=0}}function $se(){var e=$p.now(),t=e-sy;t>O7&&(ex-=t,sy=e)}function Cse(){for(var e,t=oy,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:oy=n);dh=e,ES(r)}function ES(e){if(!bf){fh&&(fh=clearTimeout(fh));var t=e-hl;t>24?(e<1/0&&(fh=setTimeout(zO,e-$p.now()-ex)),Nd&&(Nd=clearInterval(Nd))):(Nd||(sy=$p.now(),Nd=setInterval($se,O7)),bf=1,R7(zO))}}function Ase(e,t,n){var r=new ay,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(o,s,a){s=+s,a=a==null?wA():+a,r._restart(function u(l){l+=i,r._restart(u,i+=s,a),o(l)},s,a)},r.restart(e,t,n),r)}const Tse=1664525,Fse=1013904223,IO=4294967296;function Mse(){let e=1;return()=>(e=(Tse*e+Fse)%IO)/IO}function Nse(e){return e.x}function Ose(e){return e.y}var Rse=10,Dse=Math.PI*(3-Math.sqrt(5));function Pse(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,u=D7(f),l=N7("tick","end"),c=Mse();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(g){var m,y=e.length,v;g===void 0&&(g=1);for(var x=0;x<g;++x)for(n+=(o-n)*i,a.forEach(function(b){b(n)}),m=0;m<y;++m)v=e[m],v.fx==null?v.x+=v.vx*=s:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=s:(v.y=v.fy,v.vy=0);return t}function h(){for(var g=0,m=e.length,y;g<m;++g){if(y=e[g],y.index=g,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=Rse*Math.sqrt(.5+g),x=g*Dse;y.x=v*Math.cos(x),y.y=v*Math.sin(x)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),a.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(o=+g,t):o},velocityDecay:function(g){return arguments.length?(s=1-g,t):1-s},randomSource:function(g){return arguments.length?(c=g,a.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?a.delete(g):a.set(g,p(m)),t):a.get(g)},find:function(g,m,y){var v=0,x=e.length,b,w,S,E,_;for(y==null?y=1/0:y*=y,v=0;v<x;++v)E=e[v],b=g-E.x,w=m-E.y,S=b*b+w*w,S<y&&(_=E,y=S);return _},on:function(g,m){return arguments.length>1?(l.on(g,m),t):l.on(g)}}}function Lse(){var e,t,n,r,i=Ln(-30),o,s=1,a=1/0,u=.81;function l(h){var p,g=e.length,m=xA(e,Nse,Ose).visitAfter(f);for(r=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(e){var h,p=e.length,g;for(o=new Array(p),h=0;h<p;++h)g=e[h],o[g.index]=+i(g,h,e)}}function f(h){var p=0,g,m,y=0,v,x,b;if(h.length){for(v=x=b=0;b<4;++b)(g=h[b])&&(m=Math.abs(g.value))&&(p+=g.value,y+=m,v+=m*g.x,x+=m*g.y);h.x=v/y,h.y=x/y}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=o[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var y=h.x-t.x,v=h.y-t.y,x=m-p,b=y*y+v*v;if(x*x/u<b)return b<a&&(y===0&&(y=ua(n),b+=y*y),v===0&&(v=ua(n),b+=v*v),b<s&&(b=Math.sqrt(s*b)),t.vx+=y*h.value*r/b,t.vy+=v*h.value*r/b),!0;if(h.length||b>=a)return;(h.data!==t||h.next)&&(y===0&&(y=ua(n),b+=y*y),v===0&&(v=ua(n),b+=v*v),b<s&&(b=Math.sqrt(s*b)));do h.data!==t&&(x=o[h.data.index]*r/b,t.vx+=y*x,t.vy+=v*x);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(i=typeof h=="function"?h:Ln(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.distanceMax=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function zse(e){var t=Ln(.1),n,r,i;typeof e!="function"&&(e=Ln(e==null?0:+e));function o(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Ln(+a),s(),o):t},o.x=function(a){return arguments.length?(e=typeof a=="function"?a:Ln(+a),s(),o):e},o}function Ise(e){var t=Ln(.1),n,r,i;typeof e!="function"&&(e=Ln(e==null?0:+e));function o(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Ln(+a),s(),o):t},o.y=function(a){return arguments.length?(e=typeof a=="function"?a:Ln(+a),s(),o):e},o}const BO={center:Zoe,collide:vse,nbody:Lse,link:bse,x:zse,y:Ise},hh="forces",SS=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Bse=["static","iterations"],P7=["x","y","vx","vy"];function EA(e){D.call(this,null,e)}EA.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:P7}]};G(EA,D,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(SS),o=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&L7(n,e,0,t)):(this.value=n=Use(t.source,e),n.on("tick",jse(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(Bse)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,u=0,l=a.length,c;u<l;++u)if(c=a[u],!(c.name!==hh||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,o=r.length,s;i<o;++i)if(r[i].name==="links"&&(s=r[i].op.source)){n.pulse(s,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(P7)}});function jse(e,t){return()=>e.touch(t).run()}function Use(e,t){const n=Pse(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),L7(n,t,!0).on("end",()=>o=!0)}function L7(e,t,n,r){var i=Q(t.forces),o,s,a,u;for(o=0,s=SS.length;o<s;++o)a=SS[o],a!==hh&&t.modified(a)&&e[a](t[a]);for(o=0,s=i.length;o<s;++o)u=hh+o,a=n||t.modified(hh,o)?qse(i[o]):r&&Wse(i[o],r)?e.force(u):null,a&&e.force(u,a);for(s=e.numForces||0;o<s;++o)e.force(hh+o,null);return e.numForces=i.length,e}function Wse(e,t){var n,r;for(n in e)if(ge(r=e[n])&&t.modified(xn(r)))return 1;return 0}function qse(e){var t,n;ae(BO,e.force)||z("Unrecognized force: "+e.force),t=BO[e.force]();for(n in e)ge(t[n])&&Hse(t[n],e[n],e);return t}function Hse(e,t,n){e(ge(t)?r=>t(r,n):t)}const Gse=Object.freeze(Object.defineProperty({__proto__:null,force:EA},Symbol.toStringTag,{value:"Module"}));function Vse(e,t){return e.parent===t.parent?1:2}function Yse(e){return e.reduce(Xse,0)/e.length}function Xse(e,t){return e+t.x}function Qse(e){return 1+e.reduce(Kse,0)}function Kse(e,t){return Math.max(e,t.y)}function Jse(e){for(var t;t=e.children;)e=t[0];return e}function Zse(e){for(var t;t=e.children;)e=t[t.length-1];return e}function eae(){var e=Vse,t=1,n=1,r=!1;function i(o){var s,a=0;o.eachAfter(function(d){var h=d.children;h?(d.x=Yse(h),d.y=Qse(h)):(d.x=s?a+=e(d,s):0,d.y=0,s=d)});var u=Jse(o),l=Zse(o),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return o.eachAfter(r?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return i.separation=function(o){return arguments.length?(e=o,i):e},i.size=function(o){return arguments.length?(r=!1,t=+o[0],n=+o[1],i):r?null:[t,n]},i.nodeSize=function(o){return arguments.length?(r=!0,t=+o[0],n=+o[1],i):r?[t,n]:null},i}function tae(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function nae(){return this.eachAfter(tae)}function rae(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function iae(e,t){for(var n=this,r=[n],i,o,s=-1;n=r.pop();)if(e.call(t,n,++s,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function oae(e,t){for(var n=this,r=[n],i=[],o,s,a,u=-1;n=r.pop();)if(i.push(n),o=n.children)for(s=0,a=o.length;s<a;++s)r.push(o[s]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function sae(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function aae(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function uae(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function lae(e){for(var t=this,n=cae(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function cae(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function fae(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function dae(){return Array.from(this)}function hae(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function pae(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*gae(){var e=this,t,n=[e],r,i,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function SA(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=vae)):t===void 0&&(t=yae);for(var n=new wf(e),r,i=[n],o,s,a,u;r=i.pop();)if((s=t(r.data))&&(u=(s=Array.from(s)).length))for(r.children=s,a=u-1;a>=0;--a)i.push(o=s[a]=new wf(s[a])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(z7)}function mae(){return SA(this).eachBefore(xae)}function yae(e){return e.children}function vae(e){return Array.isArray(e)?e[1]:null}function xae(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function z7(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function wf(e){this.data=e,this.depth=this.height=0,this.parent=null}wf.prototype=SA.prototype={constructor:wf,count:nae,each:rae,eachAfter:oae,eachBefore:iae,find:sae,sum:aae,sort:uae,path:lae,ancestors:fae,descendants:dae,leaves:hae,links:pae,copy:mae,[Symbol.iterator]:gae};function v0(e){return e==null?null:I7(e)}function I7(e){if(typeof e!="function")throw new Error;return e}function Ou(){return 0}function cc(e){return function(){return e}}const bae=1664525,wae=1013904223,jO=4294967296;function Eae(){let e=1;return()=>(e=(bae*e+wae)%jO)/jO}function Sae(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function _ae(e,t){let n=e.length,r,i;for(;n;)i=t()*n--|0,r=e[n],e[n]=e[i],e[i]=r;return e}function kae(e,t){for(var n=0,r=(e=_ae(Array.from(e),t)).length,i=[],o,s;n<r;)o=e[n],s&&B7(s,o)?++n:(s=Cae(i=$ae(i,o)),n=0);return s}function $ae(e,t){var n,r;if(yb(t,e))return[t];for(n=0;n<e.length;++n)if(Cm(t,e[n])&&yb(ph(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(Cm(ph(e[n],e[r]),t)&&Cm(ph(e[n],t),e[r])&&Cm(ph(e[r],t),e[n])&&yb(j7(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function Cm(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function B7(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function yb(e,t){for(var n=0;n<t.length;++n)if(!B7(e,t[n]))return!1;return!0}function Cae(e){switch(e.length){case 1:return Aae(e[0]);case 2:return ph(e[0],e[1]);case 3:return j7(e[0],e[1],e[2])}}function Aae(e){return{x:e.x,y:e.y,r:e.r}}function ph(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,s=t.y,a=t.r,u=o-n,l=s-r,c=a-i,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(r+s+l/f*c)/2,r:(f+i+a)/2}}function j7(e,t,n){var r=e.x,i=e.y,o=e.r,s=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-s,h=r-l,p=i-a,g=i-c,m=u-o,y=f-o,v=r*r+i*i-o*o,x=v-s*s-a*a+u*u,b=v-l*l-c*c+f*f,w=h*p-d*g,S=(p*b-g*x)/(w*2)-r,E=(g*m-p*y)/w,_=(h*x-d*b)/(w*2)-i,k=(d*y-h*m)/w,$=E*E+k*k-1,C=2*(o+S*E+_*k),R=S*S+_*_-o*o,A=-(Math.abs($)>1e-6?(C+Math.sqrt(C*C-4*$*R))/(2*$):R/C);return{x:r+S+E*A,y:i+_+k*A,r:A}}function UO(e,t,n){var r=e.x-t.x,i,o,s=e.y-t.y,a,u,l=r*r+s*s;l?(o=t.r+n.r,o*=o,u=e.r+n.r,u*=u,o>u?(i=(l+u-o)/(2*l),a=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-a*s,n.y=e.y-i*s+a*r):(i=(l+o-u)/(2*l),a=Math.sqrt(Math.max(0,o/l-i*i)),n.x=t.x+i*r-a*s,n.y=t.y+i*s+a*r)):(n.x=t.x+n.r,n.y=t.y)}function WO(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function qO(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function Am(e){this._=e,this.next=null,this.previous=null}function Tae(e,t){if(!(o=(e=Sae(e)).length))return 0;var n,r,i,o,s,a,u,l,c,f,d;if(n=e[0],n.x=0,n.y=0,!(o>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;UO(r,n,i=e[2]),n=new Am(n),r=new Am(r),i=new Am(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(u=3;u<o;++u){UO(n._,r._,i=e[u]),i=new Am(i),l=r.next,c=n.previous,f=r._.r,d=n._.r;do if(f<=d){if(WO(l._,i._)){r=l,n.next=r,r.previous=n,--u;continue e}f+=l._.r,l=l.next}else{if(WO(c._,i._)){n=c,n.next=r,r.previous=n,--u;continue e}d+=c._.r,c=c.previous}while(l!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,s=qO(n);(i=i.next)!==r;)(a=qO(i))<s&&(n=i,s=a);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=kae(n,t),u=0;u<o;++u)n=e[u],n.x-=i.x,n.y-=i.y;return i.r}function Fae(e){return Math.sqrt(e.value)}function Mae(){var e=null,t=1,n=1,r=Ou;function i(o){const s=Eae();return o.x=t/2,o.y=n/2,e?o.eachBefore(HO(e)).eachAfter(vb(r,.5,s)).eachBefore(GO(1)):o.eachBefore(HO(Fae)).eachAfter(vb(Ou,1,s)).eachAfter(vb(r,o.r/Math.min(t,n),s)).eachBefore(GO(Math.min(t,n)/(2*o.r))),o}return i.radius=function(o){return arguments.length?(e=v0(o),i):e},i.size=function(o){return arguments.length?(t=+o[0],n=+o[1],i):[t,n]},i.padding=function(o){return arguments.length?(r=typeof o=="function"?o:cc(+o),i):r},i}function HO(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function vb(e,t,n){return function(r){if(i=r.children){var i,o,s=i.length,a=e(r)*t||0,u;if(a)for(o=0;o<s;++o)i[o].r+=a;if(u=Tae(i,n),a)for(o=0;o<s;++o)i[o].r-=a;r.r=u+a}}}function GO(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function U7(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function wg(e,t,n,r,i){for(var o=e.children,s,a=-1,u=o.length,l=e.value&&(r-t)/e.value;++a<u;)s=o[a],s.y0=n,s.y1=i,s.x0=t,s.x1=t+=s.value*l}function Nae(){var e=1,t=1,n=0,r=!1;function i(s){var a=s.height+1;return s.x0=s.y0=n,s.x1=e,s.y1=t/a,s.eachBefore(o(t,a)),r&&s.eachBefore(U7),s}function o(s,a){return function(u){u.children&&wg(u,u.x0,s*(u.depth+1)/a,u.x1,s*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(s){return arguments.length?(r=!!s,i):r},i.size=function(s){return arguments.length?(e=+s[0],t=+s[1],i):[e,t]},i.padding=function(s){return arguments.length?(n=+s,i):n},i}var Oae={depth:-1},VO={},xb={};function Rae(e){return e.id}function Dae(e){return e.parentId}function YO(){var e=Rae,t=Dae,n;function r(i){var o=Array.from(i),s=e,a=t,u,l,c,f,d,h,p,g,m=new Map;if(n!=null){const y=o.map((b,w)=>Pae(n(b,w,i))),v=y.map(XO),x=new Set(y).add("");for(const b of v)x.has(b)||(x.add(b),y.push(b),v.push(XO(b)),o.push(xb));s=(b,w)=>y[w],a=(b,w)=>v[w]}for(c=0,u=o.length;c<u;++c)l=o[c],h=o[c]=new wf(l),(p=s(l,c,i))!=null&&(p+="")&&(g=h.id=p,m.set(g,m.has(g)?VO:h)),(p=a(l,c,i))!=null&&(p+="")&&(h.parent=p);for(c=0;c<u;++c)if(h=o[c],p=h.parent){if(d=m.get(p),!d)throw new Error("missing: "+p);if(d===VO)throw new Error("ambiguous: "+p);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(n!=null){for(;f.data===xb&&f.children.length===1;)f=f.children[0],--u;for(let y=o.length-1;y>=0&&(h=o[y],h.data===xb);--y)h.data=null}if(f.parent=Oae,f.eachBefore(function(y){y.depth=y.parent.depth+1,--u}).eachBefore(z7),f.parent=null,u>0)throw new Error("cycle");return f}return r.id=function(i){return arguments.length?(e=v0(i),r):e},r.parentId=function(i){return arguments.length?(t=v0(i),r):t},r.path=function(i){return arguments.length?(n=v0(i),r):n},r}function Pae(e){e=`${e}`;let t=e.length;return _S(e,t-1)&&!_S(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function XO(e){let t=e.length;if(t<2)return"";for(;--t>1&&!_S(e,t););return e.slice(0,t)}function _S(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function Lae(e,t){return e.parent===t.parent?1:2}function bb(e){var t=e.children;return t?t[0]:e.t}function wb(e){var t=e.children;return t?t[t.length-1]:e.t}function zae(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Iae(e){for(var t=0,n=0,r=e.children,i=r.length,o;--i>=0;)o=r[i],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function Bae(e,t,n){return e.a.parent===t.parent?e.a:n}function x0(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}x0.prototype=Object.create(wf.prototype);function jae(e){for(var t=new x0(e,0),n,r=[t],i,o,s,a;n=r.pop();)if(o=n._.children)for(n.children=new Array(a=o.length),s=a-1;s>=0;--s)r.push(i=n.children[s]=new x0(o[s],s)),i.parent=n;return(t.parent=new x0(null,0)).children=[t],t}function Uae(){var e=Lae,t=1,n=1,r=null;function i(l){var c=jae(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(s),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),y=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+g)*m,v.y=v.depth*y})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){Iae(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,h=l,p=c,g=d.parent.children[0],m=d.m,y=h.m,v=p.m,x=g.m,b;p=wb(p),d=bb(d),p&&d;)g=bb(g),h=wb(h),h.a=l,b=p.z+v-d.z-m+e(p._,d._),b>0&&(zae(Bae(p,l,f),l,b),m+=b,y+=b),v+=p.m,m+=d.m,x+=g.m,y+=h.m;p&&!wb(h)&&(h.t=p,h.m+=v-y),d&&!bb(g)&&(g.t=d,g.m+=m-x,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function tx(e,t,n,r,i){for(var o=e.children,s,a=-1,u=o.length,l=e.value&&(i-n)/e.value;++a<u;)s=o[a],s.x0=t,s.x1=r,s.y0=n,s.y1=n+=s.value*l}var W7=(1+Math.sqrt(5))/2;function q7(e,t,n,r,i,o){for(var s=[],a=t.children,u,l,c=0,f=0,d=a.length,h,p,g=t.value,m,y,v,x,b,w,S;c<d;){h=i-n,p=o-r;do m=a[f++].value;while(!m&&f<d);for(y=v=m,w=Math.max(p/h,h/p)/(g*e),S=m*m*w,b=Math.max(v/S,S/y);f<d;++f){if(m+=l=a[f].value,l<y&&(y=l),l>v&&(v=l),S=m*m*w,x=Math.max(v/S,S/y),x>b){m-=l;break}b=x}s.push(u={value:m,dice:h<p,children:a.slice(c,f)}),u.dice?wg(u,n,r,i,g?r+=p*m/g:o):tx(u,n,r,g?n+=h*m/g:i,o),g-=m,c=f}return s}const H7=function e(t){function n(r,i,o,s,a){q7(t,r,i,o,s,a)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(W7);function Wae(){var e=H7,t=!1,n=1,r=1,i=[0],o=Ou,s=Ou,a=Ou,u=Ou,l=Ou;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(U7),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,y=d.y1-h;m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=y,d.children&&(h=i[d.depth+1]=o(d)/2,p+=l(d)-h,g+=s(d)-h,m-=a(d)-h,y-=u(d)-h,m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),e(d,p,g,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=I7(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:cc(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(s=typeof d=="function"?d:cc(+d),c):s},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:cc(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:cc(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:cc(+d),c):l},c}function qae(e,t,n,r,i){var o=e.children,s,a=o.length,u,l=new Array(a+1);for(l[0]=u=s=0;s<a;++s)l[s+1]=u+=o[s].value;c(0,a,e.value,t,n,r,i);function c(f,d,h,p,g,m,y){if(f>=d-1){var v=o[f];v.x0=p,v.y0=g,v.x1=m,v.y1=y;return}for(var x=l[f],b=h/2+x,w=f+1,S=d-1;w<S;){var E=w+S>>>1;l[E]<b?w=E+1:S=E}b-l[w-1]<l[w]-b&&f+1<w&&--w;var _=l[w]-x,k=h-_;if(m-p>y-g){var $=h?(p*k+m*_)/h:m;c(f,w,_,p,g,$,y),c(w,d,k,$,g,m,y)}else{var C=h?(g*k+y*_)/h:y;c(f,w,_,p,g,m,C),c(w,d,k,p,C,m,y)}}}function Hae(e,t,n,r,i){(e.depth&1?tx:wg)(e,t,n,r,i)}const Gae=function e(t){function n(r,i,o,s,a){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,g=r.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?wg(l,i,o,s,g?o+=(a-o)*l.value/g:a):tx(l,i,o,g?i+=(s-i)*l.value/g:s,a),g-=l.value}else r._squarify=u=q7(t,r,i,o,s,a),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(W7);function kS(e,t,n){const r={};return e.each(i=>{const o=i.data;n(o)&&(r[t(o)]=i)}),e.lookup=r,e}function _A(e){D.call(this,null,e)}_A.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Vae=e=>e.values;G(_A,D,{transform(e,t){t.source||z("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each(s=>{s.children&&pv(s.data)&&i.rem.push(s.data)}),this.value=o=SA({values:Q(e.keys).reduce((s,a)=>(s.key(a),s),Yae()).entries(i.source)},Vae),n&&o.each(s=>{s.children&&(s=Pe(s.data),i.add.push(s),i.source.push(s))}),kS(o,oe,oe)),i.source.root=o,i}});function Yae(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,o){if(o>=e.length)return i;const s=i.length,a=e[o++],u={},l={};let c=-1,f,d,h;for(;++c<s;)f=a(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],o);return l}function r(i,o){if(++o>e.length)return i;const s=[];for(const a in i)s.push({key:a,values:r(i[a],o)});return s}return t}function Ts(e){D.call(this,null,e)}const Xae=(e,t)=>e.parent===t.parent?1:2;G(Ts,D,{transform(e,t){(!t.source||!t.source.root)&&z(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(Rl(e.sort,s=>s.data)),Qae(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Xae:jf);try{this.value=n(i)}catch(s){z(s)}return i.each(s=>Kae(s,r,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function Qae(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}function Kae(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}const $S=["x","y","r","depth","children"];function kA(e){Ts.call(this,e)}kA.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:$S.length,default:$S}]};G(kA,Ts,{layout:Mae,params:["radius","size","padding"],fields:$S});const CS=["x0","y0","x1","y1","depth","children"];function $A(e){Ts.call(this,e)}$A.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:CS.length,default:CS}]};G($A,Ts,{layout:Nae,params:["size","round","padding"],fields:CS});function CA(e){D.call(this,null,e)}CA.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};G(CA,D,{transform(e,t){t.source||z("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?kS(YO().id(e.key).parentId(e.parentKey)(i.source),e.key,ii):kS(YO()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const QO={tidy:Uae,cluster:eae},AS=["x","y","depth","children"];function AA(e){Ts.call(this,e)}AA.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:AS.length,default:AS}]};G(AA,Ts,{layout(e){const t=e||"tidy";if(ae(QO,t))return QO[t]();z("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:AS});function TA(e){D.call(this,[],e)}TA.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};G(TA,D,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||z("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,s=>o[oe(s)]=1),r.each(s=>{const a=s.data,u=s.parent&&s.parent.data;u&&o[oe(a)]&&o[oe(u)]&&i.add.push(Pe({source:u,target:a}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,s=>o[oe(s)]=1),n.forEach(s=>{(o[oe(s.source)]||o[oe(s.target)])&&i.mod.push(s)})),i}});const KO={binary:qae,dice:wg,slice:tx,slicedice:Hae,squarify:H7,resquarify:Gae},TS=["x0","y0","x1","y1","depth","children"];function FA(e){Ts.call(this,e)}FA.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:TS.length,default:TS}]};G(FA,Ts,{layout(){const e=Wae();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ae(KO,t)?e.tile(KO[t]):z("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:TS});const Jae=Object.freeze(Object.defineProperty({__proto__:null,nest:_A,pack:kA,partition:$A,stratify:CA,tree:AA,treelinks:TA,treemap:FA},Symbol.toStringTag,{value:"Module"})),Eb=4278190080;function Zae(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function eue(e,t,n,r,i){const o=e.width,s=e.height,a=r||i,u=Sa(o,s).getContext("2d"),l=Sa(o,s).getContext("2d"),c=a&&Sa(o,s).getContext("2d");n.forEach(_=>b0(u,_,!1)),b0(l,t,!1),a&&b0(c,t,!0);const f=Sb(u,o,s),d=Sb(l,o,s),h=a&&Sb(c,o,s),p=e.bitmap(),g=a&&e.bitmap();let m,y,v,x,b,w,S,E;for(y=0;y<s;++y)for(m=0;m<o;++m)b=y*o+m,w=f[b]&Eb,E=d[b]&Eb,S=a&&h[b]&Eb,(w||S||E)&&(v=e(m),x=e(y),!i&&(w||E)&&p.set(v,x),a&&(w||S)&&g.set(v,x));return[p,g]}function Sb(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function b0(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(o=>b0(e,o.items,n))}):Rr[r].draw(e,{items:n?t.map(tue):t})}function tue(e){const t=gv(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const Ho=5,An=31,Cp=32,Vs=new Uint32Array(Cp+1),Ci=new Uint32Array(Cp+1);Ci[0]=0;Vs[0]=~Ci[0];for(let e=1;e<=Cp;++e)Ci[e]=Ci[e-1]<<1|1,Vs[e]=~Ci[e];function nue(e,t){const n=new Uint32Array(~~((e*t+Cp)/Cp));function r(o,s){n[o]|=s}function i(o,s){n[o]&=s}return{array:n,get:(o,s)=>{const a=s*e+o;return n[a>>>Ho]&1<<(a&An)},set:(o,s)=>{const a=s*e+o;r(a>>>Ho,1<<(a&An))},clear:(o,s)=>{const a=s*e+o;i(a>>>Ho,~(1<<(a&An)))},getRange:(o,s,a,u)=>{let l=u,c,f,d,h;for(;l>=s;--l)if(c=l*e+o,f=l*e+a,d=c>>>Ho,h=f>>>Ho,d===h){if(n[d]&Vs[c&An]&Ci[(f&An)+1])return!0}else{if(n[d]&Vs[c&An]||n[h]&Ci[(f&An)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(o,s,a,u)=>{let l,c,f,d,h;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>Ho,d=c>>>Ho,f===d)r(f,Vs[l&An]&Ci[(c&An)+1]);else for(r(f,Vs[l&An]),r(d,Ci[(c&An)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(o,s,a,u)=>{let l,c,f,d,h;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>Ho,d=c>>>Ho,f===d)i(f,Ci[l&An]|Vs[(c&An)+1]);else for(i(f,Ci[l&An]),i(d,Vs[(c&An)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(o,s,a,u)=>o<0||s<0||u>=t||a>=e}}function rue(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),s=a=>~~((a+n)/r);return s.invert=a=>a*r-n,s.bitmap=()=>nue(i,o),s.ratio=r,s.padding=n,s.width=e,s.height=t,s}function iue(e,t,n,r){const i=e.width,o=e.height;return function(s){const a=s.datum.datum.items[r].items,u=a.length,l=s.datum.fontSize,c=Ar.width(s.datum,s.datum.text);let f=0,d,h,p,g,m,y,v;for(let x=0;x<u;++x)d=a[x].x,p=a[x].y,h=a[x].x2===void 0?d:a[x].x2,g=a[x].y2===void 0?p:a[x].y2,m=(d+h)/2,y=(p+g)/2,v=Math.abs(h-d+g-p),v>=f&&(f=v,s.x=m,s.y=y);return m=c/2,y=l/2,d=s.x-m,h=s.x+m,p=s.y-y,g=s.y+y,s.align="center",d<0&&h<=i?s.align="left":0<=d&&i<h&&(s.align="right"),s.baseline="middle",p<0&&g<=o?s.baseline="top":0<=p&&o<g&&(s.baseline="bottom"),!0}}function uy(e,t,n,r,i,o){let s=n/2;return e-s<0||e+s>i||t-(s=r/2)<0||t+s>o}function la(e,t,n,r,i,o,s,a){const u=i*o/(r*2),l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return s.outOfBounds(l,f,c,d)||s.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function oue(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1];function u(l,c,f,d,h){const p=e.invert(l),g=e.invert(c);let m=f,y=o,v;if(!uy(p,g,d,h,i,o)&&!la(e,p,g,h,d,m,s,a)&&!la(e,p,g,h,d,h,s,null)){for(;y-m>=1;)v=(m+y)/2,la(e,p,g,h,d,v,s,a)?y=v:m=v;if(m>f)return[p,g,m,!0]}}return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=Ar.width(l.datum,l.datum.text);let p=n?d:0,g=!1,m=!1,y=0,v,x,b,w,S,E,_,k,$,C,R,A,F,T,M,P,N;for(let O=0;O<f;++O){for(v=c[O].x,b=c[O].y,x=c[O].x2===void 0?v:c[O].x2,w=c[O].y2===void 0?b:c[O].y2,v>x&&(N=v,v=x,x=N),b>w&&(N=b,b=w,w=N),$=e(v),R=e(x),C=~~(($+R)/2),A=e(b),T=e(w),F=~~((A+T)/2),_=C;_>=$;--_)for(k=F;k>=A;--k)P=u(_,k,p,h,d),P&&([l.x,l.y,p,g]=P);for(_=C;_<=R;++_)for(k=F;k<=T;++k)P=u(_,k,p,h,d),P&&([l.x,l.y,p,g]=P);!g&&!n&&(M=Math.abs(x-v+w-b),S=(v+x)/2,E=(b+w)/2,M>=y&&!uy(S,E,h,d,i,o)&&!la(e,S,E,d,h,d,s,null)&&(y=M,l.x=S,l.y=E,m=!0))}return g||m?(S=h/2,E=d/2,s.setRange(e(l.x-S),e(l.y-E),e(l.x+S),e(l.y+E)),l.align="center",l.baseline="middle",!0):!1}}const sue=[-1,-1,1,1],aue=[-1,1,-1,1];function uue(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=Ar.width(l.datum,l.datum.text),p=[];let g=n?d:0,m=!1,y=!1,v=0,x,b,w,S,E,_,k,$,C,R,A,F;for(let T=0;T<f;++T){for(x=c[T].x,w=c[T].y,b=c[T].x2===void 0?x:c[T].x2,S=c[T].y2===void 0?w:c[T].y2,p.push([e((x+b)/2),e((w+S)/2)]);p.length;)if([k,$]=p.pop(),!(s.get(k,$)||a.get(k,$)||u.get(k,$))){u.set(k,$);for(let M=0;M<4;++M)E=k+sue[M],_=$+aue[M],u.outOfBounds(E,_,E,_)||p.push([E,_]);if(E=e.invert(k),_=e.invert($),C=g,R=o,!uy(E,_,h,d,i,o)&&!la(e,E,_,d,h,C,s,a)&&!la(e,E,_,d,h,d,s,null)){for(;R-C>=1;)A=(C+R)/2,la(e,E,_,d,h,A,s,a)?R=A:C=A;C>g&&(l.x=E,l.y=_,g=C,m=!0)}}!m&&!n&&(F=Math.abs(b-x+S-w),E=(x+b)/2,_=(w+S)/2,F>=v&&!uy(E,_,h,d,i,o)&&!la(e,E,_,d,h,d,s,null)&&(v=F,l.x=E,l.y=_,y=!0))}return m||y?(E=h/2,_=d/2,s.setRange(e(l.x-E),e(l.y-_),e(l.x+E),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}const lue=["right","center","left"],cue=["bottom","middle","top"];function fue(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1],u=r.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>o)return!1;let d=l.textWidth??0,h,p,g,m,y,v,x,b,w,S,E,_,k,$,C;for(let R=0;R<u;++R){if(h=(n[R]&3)-1,p=(n[R]>>>2&3)-1,g=h===0&&p===0||r[R]<0,m=h&&p?Math.SQRT1_2:1,y=r[R]<0?-1:1,v=c[1+h]+r[R]*h*m,E=c[4+p]+y*f*p/2+r[R]*p*m,b=E-f/2,w=E+f/2,_=e(v),$=e(b),C=e(w),!d)if(JO(_,_,$,C,s,a,v,v,b,w,c,g))d=Ar.width(l.datum,l.datum.text);else continue;if(S=v+y*d*h/2,v=S-d/2,x=S+d/2,_=e(v),k=e(x),JO(_,k,$,C,s,a,v,x,b,w,c,g))return l.x=h?h*y<0?x:v:S,l.y=p?p*y<0?w:b:E,l.align=lue[h*y+1],l.baseline=cue[p*y+1],s.setRange(_,$,k,C),!0}return!1}}function JO(e,t,n,r,i,o,s,a,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o||i).getRange(e,n,t,r))}const _b=0,kb=4,$b=8,Cb=0,Ab=1,Tb=2,due={"top-left":_b+Cb,top:_b+Ab,"top-right":_b+Tb,left:kb+Cb,middle:kb+Ab,right:kb+Tb,"bottom-left":$b+Cb,bottom:$b+Ab,"bottom-right":$b+Tb},hue={naive:iue,"reduced-search":oue,floodfill:uue};function pue(e,t,n,r,i,o,s,a,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=gue(r,f),h=mue(i,f),p=yue(e[0].datum),g=p==="group"&&e[0].datum.items[u].marktype,m=g==="area",y=vue(p,g,a,u),v=l===null||l===1/0,x=m&&c==="naive";let b=-1,w=-1;const S=e.map($=>{const C=v?Ar.width($,$.text):void 0;return b=Math.max(b,C),w=Math.max(w,$.fontSize),{datum:$,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y($),textWidth:C}});l=l===null||l===1/0?Math.max(b,w)+Math.max(...r):l;const E=rue(t[0],t[1],l);let _;if(!x){n&&S.sort((R,A)=>n(R.datum,A.datum));let $=!1;for(let R=0;R<h.length&&!$;++R)$=h[R]===5||d[R]<0;const C=(p&&s||m)&&e.map(R=>R.datum);_=o.length||C?eue(E,C||[],o,$,m):Zae(E,s&&S)}const k=m?hue[c](E,_,s,u):fue(E,_,h,d);return S.forEach($=>$.opacity=+k($)),S}function gue(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function mue(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=due[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function yue(e){return e&&e.mark&&e.mark.marktype}function vue(e,t,n,r){const i=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>i(o.datum):t==="line"?o=>{const s=o.datum.items[r].items;return i(s.length?s[n==="start"?0:s.length-1]:{x:NaN,y:NaN})}:o=>{const s=o.datum.bounds;return[s.x1,(s.x1+s.x2)/2,s.x2,s.y1,(s.y1+s.y2)/2,s.y2]}:i}const FS=["x","y","opacity","align","baseline"],G7=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function MA(e){D.call(this,null,e)}MA.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:G7},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:FS.length,default:FS}]};G(MA,D,{transform(e,t){function n(o){const s=e[o];return ge(s)&&t.modified(s.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&z("Size parameter should be specified as a [width, height] array.");const i=e.as||FS;return pue(t.materialize(t.SOURCE).source||[],e.size,e.sort,Q(e.offset==null?1:e.offset),Q(e.anchor||G7),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{const s=o.datum;s[i[0]]=o.x,s[i[1]]=o.y,s[i[2]]=o.opacity,s[i[3]]=o.align,s[i[4]]=o.baseline}),t.reflow(r).modifies(i)}});const xue=Object.freeze(Object.defineProperty({__proto__:null,label:MA},Symbol.toStringTag,{value:"Module"}));function V7(e,t){var n=[],r=function(c){return c(a)},i,o,s,a,u,l;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function NA(e){D.call(this,null,e)}NA.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};G(NA,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=V7(r,e.groupby),o=(e.groupby||[]).map(gt),s=o.length,a=e.as||[gt(e.x),gt(e.y)],u=[];i.forEach(l=>{iz(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<s;++d)f[o[d]]=l.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],u.push(Pe(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const MS={constant:c$,linear:f$,log:ez,exp:tz,pow:nz,quad:d$,poly:rz},bue=(e,t)=>e==="poly"?t:e==="quad"?2:1;function OA(e){D.call(this,null,e)}OA.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(MS)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};G(OA,D,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=V7(r,e.groupby),o=(e.groupby||[]).map(gt),s=e.method||"linear",a=e.order==null?3:e.order,u=bue(s,a),l=e.as||[gt(e.x),gt(e.y)],c=MS[s],f=[];let d=e.extent;ae(MS,s)||z("Invalid regression method: "+s),d!=null&&s==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,a);if(e.params){f.push(Pe({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=d||Eo(h,e.x),y=v=>{const x={};for(let b=0;b<o.length;++b)x[o[b]]=h.dims[b];x[l[0]]=v[0],x[l[1]]=v[1],f.push(Pe(x))};s==="linear"||s==="constant"?m.forEach(v=>y([v,g.predict(v)])):Ev(g.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const wue=Object.freeze(Object.defineProperty({__proto__:null,loess:NA,regression:OA},Symbol.toStringTag,{value:"Module"})),hs=11102230246251565e-32,cn=134217729,Eue=(3+8*hs)*hs;function Fb(e,t,n,r,i){let o,s,a,u,l=t[0],c=r[0],f=0,d=0;c>l==c>-l?(o=l,l=t[++f]):(o=c,c=r[++d]);let h=0;if(f<e&&d<n)for(c>l==c>-l?(s=l+o,a=o-(s-l),l=t[++f]):(s=c+o,a=o-(s-c),c=r[++d]),o=s,a!==0&&(i[h++]=a);f<e&&d<n;)c>l==c>-l?(s=o+l,u=s-o,a=o-(s-u)+(l-u),l=t[++f]):(s=o+c,u=s-o,a=o-(s-u)+(c-u),c=r[++d]),o=s,a!==0&&(i[h++]=a);for(;f<e;)s=o+l,u=s-o,a=o-(s-u)+(l-u),l=t[++f],o=s,a!==0&&(i[h++]=a);for(;d<n;)s=o+c,u=s-o,a=o-(s-u)+(c-u),c=r[++d],o=s,a!==0&&(i[h++]=a);return(o!==0||h===0)&&(i[h++]=o),h}function Sue(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}function Eg(e){return new Float64Array(e)}const _ue=(3+16*hs)*hs,kue=(2+12*hs)*hs,$ue=(9+64*hs)*hs*hs,nc=Eg(4),ZO=Eg(8),eR=Eg(12),tR=Eg(16),Tn=Eg(4);function Cue(e,t,n,r,i,o,s){let a,u,l,c,f,d,h,p,g,m,y,v,x,b,w,S,E,_;const k=e-i,$=n-i,C=t-o,R=r-o;b=k*R,d=cn*k,h=d-(d-k),p=k-h,d=cn*R,g=d-(d-R),m=R-g,w=p*m-(b-h*g-p*g-h*m),S=C*$,d=cn*C,h=d-(d-C),p=C-h,d=cn*$,g=d-(d-$),m=$-g,E=p*m-(S-h*g-p*g-h*m),y=w-E,f=w-y,nc[0]=w-(y+f)+(f-E),v=b+y,f=v-b,x=b-(v-f)+(y-f),y=x-S,f=x-y,nc[1]=x-(y+f)+(f-S),_=v+y,f=_-v,nc[2]=v-(_-f)+(y-f),nc[3]=_;let A=Sue(4,nc),F=kue*s;if(A>=F||-A>=F||(f=e-k,a=e-(k+f)+(f-i),f=n-$,l=n-($+f)+(f-i),f=t-C,u=t-(C+f)+(f-o),f=r-R,c=r-(R+f)+(f-o),a===0&&u===0&&l===0&&c===0)||(F=$ue*s+Eue*Math.abs(A),A+=k*c+R*a-(C*l+$*u),A>=F||-A>=F))return A;b=a*R,d=cn*a,h=d-(d-a),p=a-h,d=cn*R,g=d-(d-R),m=R-g,w=p*m-(b-h*g-p*g-h*m),S=u*$,d=cn*u,h=d-(d-u),p=u-h,d=cn*$,g=d-(d-$),m=$-g,E=p*m-(S-h*g-p*g-h*m),y=w-E,f=w-y,Tn[0]=w-(y+f)+(f-E),v=b+y,f=v-b,x=b-(v-f)+(y-f),y=x-S,f=x-y,Tn[1]=x-(y+f)+(f-S),_=v+y,f=_-v,Tn[2]=v-(_-f)+(y-f),Tn[3]=_;const T=Fb(4,nc,4,Tn,ZO);b=k*c,d=cn*k,h=d-(d-k),p=k-h,d=cn*c,g=d-(d-c),m=c-g,w=p*m-(b-h*g-p*g-h*m),S=C*l,d=cn*C,h=d-(d-C),p=C-h,d=cn*l,g=d-(d-l),m=l-g,E=p*m-(S-h*g-p*g-h*m),y=w-E,f=w-y,Tn[0]=w-(y+f)+(f-E),v=b+y,f=v-b,x=b-(v-f)+(y-f),y=x-S,f=x-y,Tn[1]=x-(y+f)+(f-S),_=v+y,f=_-v,Tn[2]=v-(_-f)+(y-f),Tn[3]=_;const M=Fb(T,ZO,4,Tn,eR);b=a*c,d=cn*a,h=d-(d-a),p=a-h,d=cn*c,g=d-(d-c),m=c-g,w=p*m-(b-h*g-p*g-h*m),S=u*l,d=cn*u,h=d-(d-u),p=u-h,d=cn*l,g=d-(d-l),m=l-g,E=p*m-(S-h*g-p*g-h*m),y=w-E,f=w-y,Tn[0]=w-(y+f)+(f-E),v=b+y,f=v-b,x=b-(v-f)+(y-f),y=x-S,f=x-y,Tn[1]=x-(y+f)+(f-S),_=v+y,f=_-v,Tn[2]=v-(_-f)+(y-f),Tn[3]=_;const P=Fb(M,eR,4,Tn,tR);return tR[P-1]}function Tm(e,t,n,r,i,o){const s=(t-o)*(n-i),a=(e-i)*(r-o),u=s-a,l=Math.abs(s+a);return Math.abs(u)>=_ue*l?u:-Cue(e,t,n,r,i,o,l)}const nR=Math.pow(2,-52),Fm=new Uint32Array(512);class ly{static from(t,n=Nue,r=Oue){const i=t.length,o=new Float64Array(i*2);for(let s=0;s<i;s++){const a=t[s];o[2*s]=n(a),o[2*s+1]=r(a)}return new ly(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:o}=this,s=t.length>>1;let a=1/0,u=1/0,l=-1/0,c=-1/0;for(let k=0;k<s;k++){const $=t[2*k],C=t[2*k+1];$<a&&(a=$),C<u&&(u=C),$>l&&(l=$),C>c&&(c=C),this._ids[k]=k}const f=(a+l)/2,d=(u+c)/2;let h,p,g;for(let k=0,$=1/0;k<s;k++){const C=Mb(f,d,t[2*k],t[2*k+1]);C<$&&(h=k,$=C)}const m=t[2*h],y=t[2*h+1];for(let k=0,$=1/0;k<s;k++){if(k===h)continue;const C=Mb(m,y,t[2*k],t[2*k+1]);C<$&&C>0&&(p=k,$=C)}let v=t[2*p],x=t[2*p+1],b=1/0;for(let k=0;k<s;k++){if(k===h||k===p)continue;const $=Fue(m,y,v,x,t[2*k],t[2*k+1]);$<b&&(g=k,b=$)}let w=t[2*g],S=t[2*g+1];if(b===1/0){for(let C=0;C<s;C++)this._dists[C]=t[2*C]-t[0]||t[2*C+1]-t[1];Tc(this._ids,this._dists,0,s-1);const k=new Uint32Array(s);let $=0;for(let C=0,R=-1/0;C<s;C++){const A=this._ids[C],F=this._dists[A];F>R&&(k[$++]=A,R=F)}this.hull=k.subarray(0,$),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Tm(m,y,v,x,w,S)<0){const k=p,$=v,C=x;p=g,v=w,x=S,g=k,w=$,S=C}const E=Mue(m,y,v,x,w,S);this._cx=E.x,this._cy=E.y;for(let k=0;k<s;k++)this._dists[k]=Mb(t[2*k],t[2*k+1],E.x,E.y);Tc(this._ids,this._dists,0,s-1),this._hullStart=h;let _=3;r[h]=n[g]=p,r[p]=n[h]=g,r[g]=n[p]=h,i[h]=0,i[p]=1,i[g]=2,o.fill(-1),o[this._hashKey(m,y)]=h,o[this._hashKey(v,x)]=p,o[this._hashKey(w,S)]=g,this.trianglesLen=0,this._addTriangle(h,p,g,-1,-1,-1);for(let k=0,$,C;k<this._ids.length;k++){const R=this._ids[k],A=t[2*R],F=t[2*R+1];if(k>0&&Math.abs(A-$)<=nR&&Math.abs(F-C)<=nR||($=A,C=F,R===h||R===p||R===g))continue;let T=0;for(let j=0,X=this._hashKey(A,F);j<this._hashSize&&(T=o[(X+j)%this._hashSize],!(T!==-1&&T!==r[T]));j++);T=n[T];let M=T,P;for(;P=r[M],Tm(A,F,t[2*M],t[2*M+1],t[2*P],t[2*P+1])>=0;)if(M=P,M===T){M=-1;break}if(M===-1)continue;let N=this._addTriangle(M,R,r[M],-1,-1,i[M]);i[R]=this._legalize(N+2),i[M]=N,_++;let O=r[M];for(;P=r[O],Tm(A,F,t[2*O],t[2*O+1],t[2*P],t[2*P+1])<0;)N=this._addTriangle(O,R,P,i[R],-1,i[O]),i[R]=this._legalize(N+2),r[O]=O,_--,O=P;if(M===T)for(;P=n[M],Tm(A,F,t[2*P],t[2*P+1],t[2*M],t[2*M+1])<0;)N=this._addTriangle(P,R,M,-1,i[M],i[P]),this._legalize(N+2),i[P]=N,r[M]=M,_--,M=P;this._hullStart=n[R]=M,r[M]=n[O]=R,r[R]=O,o[this._hashKey(A,F)]=R,o[this._hashKey(t[2*M],t[2*M+1])]=M}this.hull=new Uint32Array(_);for(let k=0,$=this._hullStart;k<_;k++)this.hull[k]=$,$=r[$];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(Aue(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let o=0,s=0;for(;;){const a=r[t],u=t-t%3;if(s=u+(t+2)%3,a===-1){if(o===0)break;t=Fm[--o];continue}const l=a-a%3,c=u+(t+1)%3,f=l+(a+2)%3,d=n[s],h=n[t],p=n[c],g=n[f];if(Tue(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[a]=d;const y=r[f];if(y===-1){let x=this._hullStart;do{if(this._hullTri[x]===f){this._hullTri[x]=t;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(t,y),this._link(a,r[s]),this._link(s,f);const v=l+(a+1)%3;o<Fm.length&&(Fm[o++]=v)}else{if(o===0)break;t=Fm[--o]}}return s}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,o,s){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}function Aue(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function Mb(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function Tue(e,t,n,r,i,o,s,a){const u=e-s,l=t-a,c=n-s,f=r-a,d=i-s,h=o-a,p=u*u+l*l,g=c*c+f*f,m=d*d+h*h;return u*(f*m-g*h)-l*(c*m-g*d)+p*(c*h-f*d)<0}function Fue(e,t,n,r,i,o){const s=n-e,a=r-t,u=i-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u),h=(l*c-a*f)*d,p=(s*f-u*c)*d;return h*h+p*p}function Mue(e,t,n,r,i,o){const s=n-e,a=r-t,u=i-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u),h=e+(l*c-a*f)*d,p=t+(s*f-u*c)*d;return{x:h,y:p}}function Tc(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const o=e[i],s=t[o];let a=i-1;for(;a>=n&&t[e[a]]>s;)e[a+1]=e[a--];e[a+1]=o}else{const i=n+r>>1;let o=n+1,s=r;Od(e,i,o),t[e[n]]>t[e[r]]&&Od(e,n,r),t[e[o]]>t[e[r]]&&Od(e,o,r),t[e[n]]>t[e[o]]&&Od(e,n,o);const a=e[o],u=t[a];for(;;){do o++;while(t[e[o]]<u);do s--;while(t[e[s]]>u);if(s<o)break;Od(e,o,s)}e[n+1]=e[s],e[s]=a,r-o+1>=s-n?(Tc(e,t,o,r),Tc(e,t,n,s-1)):(Tc(e,t,n,s-1),Tc(e,t,o,r))}}function Od(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Nue(e){return e[0]}function Oue(e){return e[1]}const rR=1e-6;class ju{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,o=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>rR||Math.abs(this._y1-o)>rR)&&(this._+="L"+i+","+o),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=o}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class NS{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let Rue=class{constructor(t,[n,r,i,o]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this;let o,s;const a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let g=0,m=0,y=r.length,v,x;g<y;g+=3,m+=2){const b=r[g]*2,w=r[g+1]*2,S=r[g+2]*2,E=t[b],_=t[b+1],k=t[w],$=t[w+1],C=t[S],R=t[S+1],A=k-E,F=$-_,T=C-E,M=R-_,P=(A*M-F*T)*2;if(Math.abs(P)<1e-9){if(o===void 0){o=s=0;for(const O of n)o+=t[O*2],s+=t[O*2+1];o/=n.length,s/=n.length}const N=1e9*Math.sign((o-E)*M-(s-_)*T);v=(E+C)/2-N*M,x=(_+R)/2+N*T}else{const N=1/P,O=A*A+F*F,j=T*T+M*M;v=E+(M*O-F*j)*N,x=_+(A*j-T*O)*N}a[m]=v,a[m+1]=x}let u=n[n.length-1],l,c=u*4,f,d=t[2*u],h,p=t[2*u+1];i.fill(0);for(let g=0;g<n.length;++g)u=n[g],l=c,f=d,h=p,c=u*4,d=t[2*u],p=t[2*u+1],i[l+2]=i[c]=h-p,i[l+3]=i[c+1]=d-f}render(t){const n=t==null?t=new ju:void 0,{delaunay:{halfedges:r,inedges:i,hull:o},circumcenters:s,vectors:a}=this;if(o.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=s[h],m=s[h+1],y=s[p],v=s[p+1];this._renderSegment(g,m,y,v,t)}let u,l=o[o.length-1];for(let c=0;c<o.length;++c){u=l,l=o[c];const f=Math.floor(i[l]/3)*2,d=s[f],h=s[f+1],p=u*4,g=this._project(d,h,a[p+2],a[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new ju:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new ju:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(i[s]!==i[s-2]||i[s+1]!==i[s-1])&&n.lineTo(i[s],i[s+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new NS;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,o){let s;const a=this._regioncode(t,n),u=this._regioncode(r,i);a===0&&u===0?(o.moveTo(t,n),o.lineTo(r,i)):(s=this._clipSegment(t,n,r,i,a,u))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i){e:for(let o=0,s=n.length;o<s;o+=2)for(let a=0,u=i.length;a<u;a+=2)if(n[o]===i[a]&&n[o+1]===i[a+1]&&n[(o+2)%s]===i[(a+u-2)%u]&&n[(o+3)%s]===i[(a+u-1)%u]){yield r;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:o}}=this,s=r[t];if(s===-1)return null;const a=[];let u=s;do{const l=Math.floor(u/3);if(a.push(n[l*2],n[l*2+1]),u=u%3===2?u-2:u+1,o[u]!==t)break;u=i[u]}while(u!==s&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return this._simplify(r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n))}_clipFinite(t,n){const r=n.length;let i=null,o,s,a=n[r-2],u=n[r-1],l,c=this._regioncode(a,u),f,d=0;for(let h=0;h<r;h+=2)if(o=a,s=u,a=n[h],u=n[h+1],l=c,c=this._regioncode(a,u),l===0&&c===0)f=d,d=0,i?i.push(a,u):i=[a,u];else{let p,g,m,y,v;if(l===0){if((p=this._clipSegment(o,s,a,u,l,c))===null)continue;[g,m,y,v]=p}else{if((p=this._clipSegment(a,u,o,s,c,l))===null)continue;[y,v,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(g,m):i=[g,m]}f=d,d=this._edgecode(y,v),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(y,v):i=[y,v]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,o,s){const a=o<s;for(a&&([t,n,r,i,o,s]=[r,i,t,n,s,o]);;){if(o===0&&s===0)return a?[r,i,t,n]:[t,n,r,i];if(o&s)return null;let u,l,c=o||s;c&8?(u=t+(r-t)*(this.ymax-n)/(i-n),l=this.ymax):c&4?(u=t+(r-t)*(this.ymin-n)/(i-n),l=this.ymin):c&2?(l=n+(i-n)*(this.xmax-t)/(r-t),u=this.xmax):(l=n+(i-n)*(this.xmin-t)/(r-t),u=this.xmin),o?(t=u,n=l,o=this._regioncode(t,n)):(r=u,i=l,s=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,o,s){let a=Array.from(n),u;if((u=this._project(a[0],a[1],r,i))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],o,s))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let l=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,r,i,o){for(;n!==r;){let s,a;switch(n){case 5:n=4;continue;case 4:n=6,s=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,s=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,s=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,s=this.xmin,a=this.ymin;break}(i[o]!==s||i[o+1]!==a)&&this.contains(t,s,a)&&(i.splice(o,0,s,a),o+=2)}return o}_project(t,n,r,i){let o=1/0,s,a,u;if(i<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/i)<o&&(u=this.ymin,a=t+(o=s)*r)}else if(i>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/i)<o&&(u=this.ymax,a=t+(o=s)*r)}if(r>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/r)<o&&(a=this.xmax,u=n+(o=s)*i)}else if(r<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/r)<o&&(a=this.xmin,u=n+(o=s)*i)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const r=(n+2)%t.length,i=(n+4)%t.length;(t[n]===t[r]&&t[r]===t[i]||t[n+1]===t[r+1]&&t[r+1]===t[i+1])&&(t.splice(r,2),n-=2)}t.length||(t=null)}return t}};const Due=2*Math.PI,rc=Math.pow;function Pue(e){return e[0]}function Lue(e){return e[1]}function zue(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],o=2*t[r+1],s=2*t[r+2];if((n[s]-n[i])*(n[o+1]-n[i+1])-(n[o]-n[i])*(n[s+1]-n[i+1])>1e-10)return!1}return!0}function Iue(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class RA{static from(t,n=Pue,r=Lue,i){return new RA("length"in t?Bue(t,n,r,i):Float64Array.from(jue(t,n,r,i)))}constructor(t){this._delaunator=new ly(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&zue(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=Iue(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new ly(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=o[u%3===2?u-2:u+1];(r[u]===-1||s[c]===-1)&&(s[c]=u)}for(let u=0,l=i.length;u<l;++u)a[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],s[i[0]]=1,i.length===2&&(s[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(t){return new Rue(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:o,triangles:s,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=s[l],l=l%3===2?l-2:l+1,s[l]!==t)return;if(l=o[l],l===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let o;for(;(o=this._step(r,t,n))>=0&&o!==r&&o!==i;)r=o;return o}_step(t,n,r){const{inedges:i,hull:o,_hullIndex:s,halfedges:a,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=rc(n-l[t*2],2)+rc(r-l[t*2+1],2);const d=i[t];let h=d;do{let p=u[h];const g=rc(n-l[p*2],2)+rc(r-l[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3===2?h-2:h+1,u[h]!==t)break;if(h=a[h],h===-1){if(h=o[(s[t]+1)%o.length],h!==p&&rc(n-l[h*2],2)+rc(r-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new ju:void 0,{points:r,halfedges:i,triangles:o}=this;for(let s=0,a=i.length;s<a;++s){const u=i[s];if(u<s)continue;const l=o[s]*2,c=o[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const r=t==null?t=new ju:void 0,{points:i}=this;for(let o=0,s=i.length;o<s;o+=2){const a=i[o],u=i[o+1];t.moveTo(a+n,u),t.arc(a,u,n,0,Due)}return r&&r.value()}renderHull(t){const n=t==null?t=new ju:void 0,{hull:r,points:i}=this,o=r[0]*2,s=r.length;t.moveTo(i[o],i[o+1]);for(let a=1;a<s;++a){const u=2*r[a];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new NS;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new ju:void 0,{points:i,triangles:o}=this,s=o[t*=3]*2,a=o[t+1]*2,u=o[t+2]*2;return n.moveTo(i[s],i[s+1]),n.lineTo(i[a],i[a+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new NS;return this.renderTriangle(t,n),n.value()}}function Bue(e,t,n,r){const i=e.length,o=new Float64Array(i*2);for(let s=0;s<i;++s){const a=e[s];o[s*2]=t.call(r,a,s,e),o[s*2+1]=n.call(r,a,s,e)}return o}function*jue(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}function DA(e){D.call(this,null,e)}DA.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const Uue=[-1e5,-1e5,1e5,1e5];G(DA,D,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:Uue;const o=this.value=RA.from(r,e.x,e.y).voronoi(i);for(let s=0,a=r.length;s<a;++s){const u=o.cellPolygon(s);r[s][n]=u&&!que(u)?Wue(u):null}return t.reflow(e.modified()).modifies(n)}});function Wue(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}function que(e){return e.length===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}const Hue=Object.freeze(Object.defineProperty({__proto__:null,voronoi:DA},Symbol.toStringTag,{value:"Module"}));var Nb=Math.PI/180,gh=64,w0=2048;function Gue(){var e=[256,256],t,n,r,i,o,s,a,u=Y7,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(Sa()),g=Jue((e[0]>>5)*e[1]),m=null,y=l.length,v=-1,x=[],b=l.map(S=>({text:t(S),font:n(S),style:i(S),weight:o(S),rotate:s(S),size:~~(r(S)+1e-14),padding:a(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S})).sort((S,E)=>E.size-S.size);++v<y;){var w=b[v];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,Vue(p,w,b,v),w.hasText&&h(g,w,m)&&(x.push(w),m?Xue(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return x};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(gh<<5)/g,p.height=w0/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function h(p,g,m){for(var y=g.x,v=g.y,x=Math.sqrt(e[0]*e[0]+e[1]*e[1]),b=u(e),w=c()<.5?1:-1,S=-w,E,_,k;(E=b(S+=w))&&(_=~~E[0],k=~~E[1],!(Math.min(Math.abs(_),Math.abs(k))>=x));)if(g.x=y+_,g.y=v+k,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!Yue(g,p,e[0]))&&(!m||Que(g,m))){for(var $=g.sprite,C=g.width>>5,R=e[0]>>5,A=g.x-(C<<4),F=A&127,T=32-F,M=g.y1-g.y0,P=(g.y+g.y0)*R+(A>>5),N,O=0;O<M;O++){N=0;for(var j=0;j<=C;j++)p[P+j]|=N<<T|(j<C?(N=$[O*C+j])>>>F:0);P+=R}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=pu(p),f):n},f.fontStyle=function(p){return arguments.length?(i=pu(p),f):i},f.fontWeight=function(p){return arguments.length?(o=pu(p),f):o},f.rotate=function(p){return arguments.length?(s=pu(p),f):s},f.text=function(p){return arguments.length?(t=pu(p),f):t},f.spiral=function(p){return arguments.length?(u=Zue[p]||p,f):u},f.fontSize=function(p){return arguments.length?(r=pu(p),f):r},f.padding=function(p){return arguments.length?(a=pu(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}function Vue(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,(gh<<5)/o,w0/o);var s=0,a=0,u=0,l=n.length,c,f,d,h,p;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=i.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*Nb),m=Math.cos(t.rotate*Nb),y=c*m,v=c*g,x=d*m,b=d*g;c=Math.max(Math.abs(y+b),Math.abs(y-b))+31>>5<<5,d=~~Math.max(Math.abs(v+x),Math.abs(v-x))}else c=c+31>>5<<5;if(d>u&&(u=d),s+c>=gh<<5&&(s=0,a+=u,u=0),a+d>=w0)break;i.translate((s+(c>>1))/o,(a+(d>>1))/o),t.rotate&&i.rotate(t.rotate*Nb),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=s,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,s+=c}for(var w=i.getImageData(0,0,(gh<<5)/o,w0/o).data,S=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)S[h]=0;if(s=t.xoff,s==null)return;a=t.yoff;var E=0,_=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var k=f*p+(h>>5),$=w[(a+p)*(gh<<5)+(s+h)<<2]?1<<31-h%32:0;S[k]|=$,E|=$}E?_=p:(t.y0++,d--,p--,a++)}t.y1=t.y0+_,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function Yue(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,o=e.x-(i<<4),s=o&127,a=32-s,u=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<a|(d<i?(c=r[f*i+d])>>>s:0))&t[l+d])return!0;l+=n}return!1}function Xue(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function Que(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Y7(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Kue(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(o){var s=o<0?-1:1;switch(Math.sqrt(1+4*s*o)-s&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function Jue(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function pu(e){return typeof e=="function"?e:function(){return e}}var Zue={archimedean:Y7,rectangular:Kue};const X7=["x","y","font","fontSize","fontStyle","fontWeight","angle"],ele=["text","font","rotate","fontSize","fontStyle","fontWeight"];function PA(e){D.call(this,Gue(),e)}PA.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:X7}]};G(PA,D,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&z("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return ge(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||ele.some(n)))return;const i=t.materialize(t.SOURCE).source,o=this.value,s=e.as||X7;let a=e.fontSize||14,u;if(ge(a)?u=e.fontSizeRange:a=kn(a),u){const p=a,g=Ne("sqrt")().domain(Eo(i,p)).range(u);a=m=>g(p(m))}i.forEach(p=>{p[s[0]]=NaN,p[s[1]]=NaN,p[s[3]]=0});const l=o.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(si).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,g,m;p<h;++p)g=l[p],m=g.datum,m[s[0]]=g.x+f,m[s[1]]=g.y+d,m[s[2]]=g.font,m[s[3]]=g.size,m[s[4]]=g.style,m[s[5]]=g.weight,m[s[6]]=g.rotate;return t.reflow(r).modifies(s)}});const tle=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:PA},Symbol.toStringTag,{value:"Module"})),nle=e=>new Uint8Array(e),rle=e=>new Uint16Array(e),Ih=e=>new Uint32Array(e);function ile(){let e=8,t=[],n=Ih(0),r=Mm(0,e),i=Mm(0,e);return{data:()=>t,seen:()=>n=ole(n,t.length),add(o){for(let s=0,a=t.length,u=o.length,l;s<u;++s)l=o[s],l._index=a++,t.push(l)},remove(o,s){const a=t.length,u=Array(a-o),l=t;let c,f,d;for(f=0;!s[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],s[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:o=>i[o]=r[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,s){r[o]|=s},clear(o,s){r[o]&=~s},resize(o,s){const a=r.length;(o>a||s>e)&&(e=Math.max(s,e),r=Mm(o,e,r),i=Mm(o,e))}}}function ole(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function Mm(e,t,n){const r=(t<257?nle:t<65537?rle:Ih)(e);return n&&r.set(n),r}function iR(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,o){const s=this,a=s.bisect(s.range,i.value),u=i.index,l=a[0],c=a[1],f=u.length;let d;for(d=0;d<l;++d)o[u[d]]|=r;for(d=c;d<f;++d)o[u[d]]|=r;return s}}}function oR(){let e=Ih(0),t=[],n=0;function r(a,u,l){if(!u.length)return[];const c=n,f=u.length,d=Ih(f);let h=Array(f),p,g,m;for(m=0;m<f;++m)h[m]=a(u[m]),d[m]=m;if(h=sle(h,d),c)p=t,g=e,t=Array(c+f),e=Ih(c+f),ale(l,p,g,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function i(a,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a}function o(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]}function s(a,u){let l;return u?l=u.length:(u=t,l=n),[wY(u,a[0],0,l),Aa(u,a[1],0,l)]}return{insert:r,remove:i,bisect:s,reindex:o,index:()=>e,size:()=>n}}function sle(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],o=e[r];return i<o?-1:i>o?1:0}),_Y(e,t)}function ale(e,t,n,r,i,o,s,a,u){let l=0,c=0,f;for(f=0;l<r&&c<s;++f)t[l]<i[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=i[c],u[f]=o[c++]+e);for(;l<r;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<s;++c,++f)a[f]=i[c],u[f]=o[c]+e}function LA(e){D.call(this,ile(),e),this._indices=null,this._dims=null}LA.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};G(LA,D,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],s=r.length;let a=0,u,l;for(;a<s;++a)u=n[a].fname,l=i[u]||(i[u]=oR()),o.push(iR(l,a,r[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,s=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let g,m,y,v,x,b,w,S,E;if(l.set(u),t.rem.length&&(x=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(b={},v=t.mod,w=0,S=v.length;w<S;++w)b[v[w]._index]=1;for(w=0;w<h;++w)E=r[w],(!s[w]||e.modified("fields",w)||t.modified(E.fields))&&(y=E.fname,(g=p[y])||(o[y]=m=oR(),p[y]=g=m.insert(E,t.source,0)),s[w]=iR(m,w,i[w]).onAdd(g,u));for(w=0,S=a.data().length;w<S;++w)x[w]||(l[w]!==u[w]?f.push(w):b[w]&&u[w]!==c&&d.push(w));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,o=this._dims,s=this._indices,a=e.fields,u={},l=n.add,c=i.size()+r.length,f=o.length;let d=i.size(),h,p,g;i.resize(c,f),i.add(r);const m=i.curr(),y=i.prev(),v=i.all();for(h=0;h<f;++h)p=a[h].fname,g=u[p]||(u[p]=s[p].insert(a[h],r,d)),o[h].onAdd(g,m);for(;d<c;++d)y[d]=v,m[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),s=e.mod;let a,u,l;for(a=0,u=s.length;a<u;++a)l=s[a]._index,i[l]!==o&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,o=i.curr(),s=i.prev(),a=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,s[h]=p=o[h],o[h]=a,p!==a&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const o=i.remove(t,n);for(const s in r)r[s].reindex(o)})},update(e,t,n){const r=this._dims,i=e.query,o=t.stamp,s=r.length;let a=0,u,l;for(n.filters=0,l=0;l<s;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,a=0;l<s;++l)e.modified("query",l)&&(a|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return a},incrementAll(e,t,n,r){const i=this.value,o=i.seen(),s=i.curr(),a=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let m,y,v;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(f>h)for(m=h,y=Math.min(f,p);m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;if(d>p)for(m=Math.max(f,p),y=d;m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(d<p)for(m=Math.max(h,d),y=p;m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,o=i.curr(),s=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],h=e.one;let p,g,m;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)m=s[p],o[m]^=h,n.push(m);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)m=s[p],o[m]^=h,r.push(m);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)m=s[p],o[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=s[p],o[m]^=h,r.push(m);e.range=t.slice()}});function zA(e){D.call(this,null,e)}zA.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};G(zA,D,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if(!(i&n))return t.StopPropagation;const o=t.fork(t.ALL),s=r.data(),a=r.curr(),u=r.prev(),l=c=>a[c]&n?null:s[c];return o.filter(o.MOD,l),i&i-1?(o.filter(o.ADD,c=>{const f=a[c]&n;return!f&&f^u[c]&n?s[c]:null}),o.filter(o.REM,c=>{const f=a[c]&n;return f&&!(f^(f^u[c]&n))?s[c]:null})):(o.filter(o.ADD,l),o.filter(o.REM,c=>(a[c]&n)===i?s[c]:null)),o.filter(o.SOURCE,c=>l(c._index))}});const ule=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:LA,resolvefilter:zA},Symbol.toStringTag,{value:"Module"})),lle="RawCode",pl="Literal",cle="Property",fle="Identifier",dle="ArrayExpression",hle="BinaryExpression",Q7="CallExpression",ple="ConditionalExpression",gle="LogicalExpression",mle="MemberExpression",yle="ObjectExpression",vle="UnaryExpression";function Hi(e){this.type=e}Hi.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=xle(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function xle(e){switch(e.type){case dle:return e.elements;case hle:case gle:return[e.left,e.right];case Q7:return[e.callee].concat(e.arguments);case ple:return[e.test,e.consequent,e.alternate];case mle:return[e.object,e.property];case yle:return e.properties;case cle:return[e.key,e.value];case vle:return[e.argument];case fle:case pl:case lle:default:return[]}}var Do,te,L,wn,Ie,nx=1,Sg=2,gl=3,tu=4,rx=5,zl=6,Qn=7,_g=8,ble=9;Do={};Do[nx]="Boolean";Do[Sg]="<end>";Do[gl]="Identifier";Do[tu]="Keyword";Do[rx]="Null";Do[zl]="Numeric";Do[Qn]="Punctuator";Do[_g]="String";Do[ble]="RegularExpression";var wle="ArrayExpression",Ele="BinaryExpression",Sle="CallExpression",_le="ConditionalExpression",K7="Identifier",kle="Literal",$le="LogicalExpression",Cle="MemberExpression",Ale="ObjectExpression",Tle="Property",Fle="UnaryExpression",zt="Unexpected token %0",Mle="Unexpected number",Nle="Unexpected string",Ole="Unexpected identifier",Rle="Unexpected reserved word",Dle="Unexpected end of input",OS="Invalid regular expression",Ob="Invalid regular expression: missing /",J7="Octal literals are not allowed in strict mode.",Ple="Duplicate data property in object literal not allowed in strict mode",Kt="ILLEGAL",Ap="Disabled.",Lle=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),zle=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function ix(e,t){if(!e)throw new Error("ASSERT: "+t)}function Jo(e){return e>=48&&e<=57}function IA(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Bh(e){return"01234567".indexOf(e)>=0}function Ile(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Tp(e){return e===10||e===13||e===8232||e===8233}function kg(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Lle.test(String.fromCharCode(e))}function cy(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&zle.test(String.fromCharCode(e))}const Ble={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Z7(){for(;L<wn;){const e=te.charCodeAt(L);if(Ile(e)||Tp(e))++L;else break}}function RS(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)L<wn&&IA(te[L])?(r=te[L++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Fe({},zt,Kt);return String.fromCharCode(i)}function jle(){var e,t,n,r;for(e=te[L],t=0,e==="}"&&Fe({},zt,Kt);L<wn&&(e=te[L++],!!IA(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Fe({},zt,Kt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function eB(){var e,t;for(e=te.charCodeAt(L++),t=String.fromCharCode(e),e===92&&(te.charCodeAt(L)!==117&&Fe({},zt,Kt),++L,e=RS("u"),(!e||e==="\\"||!kg(e.charCodeAt(0)))&&Fe({},zt,Kt),t=e);L<wn&&(e=te.charCodeAt(L),!!cy(e));)++L,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),te.charCodeAt(L)!==117&&Fe({},zt,Kt),++L,e=RS("u"),(!e||e==="\\"||!cy(e.charCodeAt(0)))&&Fe({},zt,Kt),t+=e);return t}function Ule(){var e,t;for(e=L++;L<wn;){if(t=te.charCodeAt(L),t===92)return L=e,eB();if(cy(t))++L;else break}return te.slice(e,L)}function Wle(){var e,t,n;return e=L,t=te.charCodeAt(L)===92?eB():Ule(),t.length===1?n=gl:Ble.hasOwnProperty(t)?n=tu:t==="null"?n=rx:t==="true"||t==="false"?n=nx:n=gl,{type:n,value:t,start:e,end:L}}function Rb(){var e=L,t=te.charCodeAt(L),n,r=te[L],i,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++L,{type:Qn,value:String.fromCharCode(t),start:e,end:L};default:if(n=te.charCodeAt(L+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return L+=2,{type:Qn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:L};case 33:case 61:return L+=2,te.charCodeAt(L)===61&&++L,{type:Qn,value:te.slice(e,L),start:e,end:L}}}if(s=te.substr(L,4),s===">>>=")return L+=4,{type:Qn,value:s,start:e,end:L};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return L+=3,{type:Qn,value:o,start:e,end:L};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return L+=2,{type:Qn,value:i,start:e,end:L};if(i==="//"&&Fe({},zt,Kt),"<>=!+-*%&|^/".indexOf(r)>=0)return++L,{type:Qn,value:r,start:e,end:L};Fe({},zt,Kt)}function qle(e){let t="";for(;L<wn&&IA(te[L]);)t+=te[L++];return t.length===0&&Fe({},zt,Kt),kg(te.charCodeAt(L))&&Fe({},zt,Kt),{type:zl,value:parseInt("0x"+t,16),start:e,end:L}}function Hle(e){let t="0"+te[L++];for(;L<wn&&Bh(te[L]);)t+=te[L++];return(kg(te.charCodeAt(L))||Jo(te.charCodeAt(L)))&&Fe({},zt,Kt),{type:zl,value:parseInt(t,8),octal:!0,start:e,end:L}}function sR(){var e,t,n;if(n=te[L],ix(Jo(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=L,e="",n!=="."){if(e=te[L++],n=te[L],e==="0"){if(n==="x"||n==="X")return++L,qle(t);if(Bh(n))return Hle(t);n&&Jo(n.charCodeAt(0))&&Fe({},zt,Kt)}for(;Jo(te.charCodeAt(L));)e+=te[L++];n=te[L]}if(n==="."){for(e+=te[L++];Jo(te.charCodeAt(L));)e+=te[L++];n=te[L]}if(n==="e"||n==="E")if(e+=te[L++],n=te[L],(n==="+"||n==="-")&&(e+=te[L++]),Jo(te.charCodeAt(L)))for(;Jo(te.charCodeAt(L));)e+=te[L++];else Fe({},zt,Kt);return kg(te.charCodeAt(L))&&Fe({},zt,Kt),{type:zl,value:parseFloat(e),start:t,end:L}}function Gle(){var e="",t,n,r,i,o=!1;for(t=te[L],ix(t==="'"||t==='"',"String literal must starts with a quote"),n=L,++L;L<wn;)if(r=te[L++],r===t){t="";break}else if(r==="\\")if(r=te[L++],!r||!Tp(r.charCodeAt(0)))switch(r){case"u":case"x":te[L]==="{"?(++L,e+=jle()):e+=RS(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Bh(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),L<wn&&Bh(te[L])&&(o=!0,i=i*8+"01234567".indexOf(te[L++]),"0123".indexOf(r)>=0&&L<wn&&Bh(te[L])&&(i=i*8+"01234567".indexOf(te[L++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&te[L]===`
`&&++L;else{if(Tp(r.charCodeAt(0)))break;e+=r}return t!==""&&Fe({},zt,Kt),{type:_g,value:e,octal:o,start:n,end:L}}function Vle(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Fe({},OS)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Fe({},OS)}try{return new RegExp(e,t)}catch{return null}}function Yle(){var e,t,n,r,i;for(e=te[L],ix(e==="/","Regular expression literal must start with a slash"),t=te[L++],n=!1,r=!1;L<wn;)if(e=te[L++],t+=e,e==="\\")e=te[L++],Tp(e.charCodeAt(0))&&Fe({},Ob),t+=e;else if(Tp(e.charCodeAt(0)))Fe({},Ob);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Fe({},Ob),i=t.substr(1,t.length-2),{value:i,literal:t}}function Xle(){var e,t,n;for(t="",n="";L<wn&&(e=te[L],!!cy(e.charCodeAt(0)));)++L,e==="\\"&&L<wn?Fe({},zt,Kt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Fe({},OS,n),{value:n,literal:t}}function Qle(){var e,t,n,r;return Ie=null,Z7(),e=L,t=Yle(),n=Xle(),r=Vle(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:L}}function Kle(e){return e.type===gl||e.type===tu||e.type===nx||e.type===rx}function tB(){if(Z7(),L>=wn)return{type:Sg,start:L,end:L};const e=te.charCodeAt(L);return kg(e)?Wle():e===40||e===41||e===59?Rb():e===39||e===34?Gle():e===46?Jo(te.charCodeAt(L+1))?sR():Rb():Jo(e)?sR():Rb()}function tr(){const e=Ie;return L=e.end,Ie=tB(),L=e.end,e}function nB(){const e=L;Ie=tB(),L=e}function Jle(e){const t=new Hi(wle);return t.elements=e,t}function aR(e,t,n){const r=new Hi(e==="||"||e==="&&"?$le:Ele);return r.operator=e,r.left=t,r.right=n,r}function Zle(e,t){const n=new Hi(Sle);return n.callee=e,n.arguments=t,n}function ece(e,t,n){const r=new Hi(_le);return r.test=e,r.consequent=t,r.alternate=n,r}function BA(e){const t=new Hi(K7);return t.name=e,t}function mh(e){const t=new Hi(kle);return t.value=e.value,t.raw=te.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function uR(e,t,n){const r=new Hi(Cle);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function tce(e){const t=new Hi(Ale);return t.properties=e,t}function lR(e,t,n){const r=new Hi(Tle);return r.key=t,r.value=n,r.kind=e,r}function nce(e,t){const n=new Hi(Fle);return n.operator=e,n.argument=t,n.prefix=!0,n}function Fe(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,s)=>(ix(s<r.length,"Message reference must be in range"),r[s]));throw n=new Error(i),n.index=L,n.description=i,n}function ox(e){e.type===Sg&&Fe(e,Dle),e.type===zl&&Fe(e,Mle),e.type===_g&&Fe(e,Nle),e.type===gl&&Fe(e,Ole),e.type===tu&&Fe(e,Rle),Fe(e,zt,e.value)}function En(e){const t=tr();(t.type!==Qn||t.value!==e)&&ox(t)}function Ke(e){return Ie.type===Qn&&Ie.value===e}function Db(e){return Ie.type===tu&&Ie.value===e}function rce(){const e=[];for(L=Ie.start,En("[");!Ke("]");)Ke(",")?(tr(),e.push(null)):(e.push(ml()),Ke("]")||En(","));return tr(),Jle(e)}function cR(){L=Ie.start;const e=tr();return e.type===_g||e.type===zl?(e.octal&&Fe(e,J7),mh(e)):BA(e.value)}function ice(){var e,t,n,r;if(L=Ie.start,e=Ie,e.type===gl)return n=cR(),En(":"),r=ml(),lR("init",n,r);if(e.type===Sg||e.type===Qn)ox(e);else return t=cR(),En(":"),r=ml(),lR("init",t,r)}function oce(){var e=[],t,n,r,i={},o=String;for(L=Ie.start,En("{");!Ke("}");)t=ice(),t.key.type===K7?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Fe({},Ple):i[r]=!0,e.push(t),Ke("}")||En(",");return En("}"),tce(e)}function sce(){En("(");const e=jA();return En(")"),e}const ace={if:1};function uce(){var e,t,n;if(Ke("("))return sce();if(Ke("["))return rce();if(Ke("{"))return oce();if(e=Ie.type,L=Ie.start,e===gl||ace[Ie.value])n=BA(tr().value);else if(e===_g||e===zl)Ie.octal&&Fe(Ie,J7),n=mh(tr());else{if(e===tu)throw new Error(Ap);e===nx?(t=tr(),t.value=t.value==="true",n=mh(t)):e===rx?(t=tr(),t.value=null,n=mh(t)):Ke("/")||Ke("/=")?(n=mh(Qle()),nB()):ox(tr())}return n}function lce(){const e=[];if(En("("),!Ke(")"))for(;L<wn&&(e.push(ml()),!Ke(")"));)En(",");return En(")"),e}function cce(){L=Ie.start;const e=tr();return Kle(e)||ox(e),BA(e.value)}function fce(){return En("."),cce()}function dce(){En("[");const e=jA();return En("]"),e}function hce(){var e,t,n;for(e=uce();;)if(Ke("."))n=fce(),e=uR(".",e,n);else if(Ke("("))t=lce(),e=Zle(e,t);else if(Ke("["))n=dce(),e=uR("[",e,n);else break;return e}function fR(){const e=hce();if(Ie.type===Qn&&(Ke("++")||Ke("--")))throw new Error(Ap);return e}function E0(){var e,t;if(Ie.type!==Qn&&Ie.type!==tu)t=fR();else{if(Ke("++")||Ke("--"))throw new Error(Ap);if(Ke("+")||Ke("-")||Ke("~")||Ke("!"))e=tr(),t=E0(),t=nce(e.value,t);else{if(Db("delete")||Db("void")||Db("typeof"))throw new Error(Ap);t=fR()}}return t}function dR(e){let t=0;if(e.type!==Qn&&e.type!==tu)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function pce(){var e,t,n,r,i,o,s,a,u,l;if(e=Ie,u=E0(),r=Ie,i=dR(r),i===0)return u;for(r.prec=i,tr(),t=[e,Ie],s=E0(),o=[u,r,s];(i=dR(Ie))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),t.pop(),n=aR(a,u,s),o.push(n);r=tr(),r.prec=i,o.push(r),t.push(Ie),n=E0(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=aR(o[l-1].value,o[l-2],n),l-=2;return n}function ml(){var e,t,n;return e=pce(),Ke("?")&&(tr(),t=ml(),En(":"),n=ml(),e=ece(e,t,n)),e}function jA(){const e=ml();if(Ke(","))throw new Error(Ap);return e}function UA(e){te=e,L=0,wn=te.length,Ie=null,nB();const t=jA();if(Ie.type!==Sg)throw new Error("Unexpect token after expression.");return t}var rB={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function iB(e){function t(s,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+s+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(s,a,u){return l=>t(s,l,a,u)}const r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&z("Missing arguments to clamp function."),s.length>3&&z("Too many arguments to clamp function.");const a=s.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:o,test:n("test",o),if:function(s){s.length<3&&z("Missing arguments to if function."),s.length>3&&z("Too many arguments to if function.");const a=s.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function gce(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function oB(e){e=e||{};const t=e.allowed?Bi(e.allowed):{},n=e.forbidden?Bi(e.forbidden):{},r=e.constants||rB,i=(e.functions||iB)(f),o=e.globalvar,s=e.fieldvar,a=ge(o)?o:p=>`${o}["${p}"]`;let u={},l={},c=0;function f(p){if(K(p))return p;const g=d[p.type];return g==null&&z("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:ae(n,g)?z("Illegal identifier: "+g):ae(r,g)?r[g]:ae(t,g)?g:(u[g]=1,a(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const y=f(p.property);return m===s&&(l[gce(y)]=1),g&&(c-=1),m+(g?"."+y:"["+y+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&z("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,y=ae(i,g)&&i[g];return y||z("Unrecognized function: "+g),ge(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=i,h.constants=r,h}const hR=Symbol("vega_selection_getter");function sB(e){return(!e.getter||!e.getter[hR])&&(e.getter=ri(e.field),e.getter[hR]=!0),e.getter}const WA="intersect",pR="union",mce="vlMulti",yce="vlPoint",gR="or",vce="and",ao="_vgsid_",Fp=ri(ao),xce="E",bce="R",wce="R-E",Ece="R-LE",Sce="R-RE",fy="index:unit";function mR(e,t){for(var n=t.fields,r=t.values,i=n.length,o=0,s,a;o<i;++o)if(a=n[o],s=sB(a)(e),ba(s)&&(s=mn(s)),ba(r[o])&&(r[o]=mn(r[o])),I(r[o])&&ba(r[o][0])&&(r[o]=r[o].map(mn)),a.type===xce){if(I(r[o])?r[o].indexOf(s)<0:s!==r[o])return!1}else if(a.type===bce){if(!kc(s,r[o]))return!1}else if(a.type===Sce){if(!kc(s,r[o],!0,!1))return!1}else if(a.type===wce){if(!kc(s,r[o],!1,!1))return!1}else if(a.type===Ece&&!kc(s,r[o],!1,!0))return!1;return!0}function _ce(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],o=r?r[fy]&&r[fy].value:void 0,s=n===WA,a=i.length,u=0,l,c,f,d,h;u<a;++u)if(l=i[u],o&&s){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=mR(t,l),c[d]=h?-1:++f,h&&o.size===1)return!0;if(!h&&f===o.get(d).count)return!1}else if(h=mR(t,l),s^h)return h;return a&&s}const aB=Hf(Fp),kce=aB.left,$ce=aB.right;function Cce(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r[fy]&&r[fy].value:void 0,s=n===WA,a=Fp(t),u=kce(i,a);if(u===i.length||Fp(i[u])!==a)return!1;if(o&&s){if(o.size===1)return!0;if($ce(i,a)-u<o.size)return!1}return!0}function Ace(e,t){return e.map(n=>pe(t.fields?{values:t.fields.map(r=>sB(r)(n.datum))}:{[ao]:Fp(n.datum)},t))}function Tce(e,t,n,r){for(var i=this.context.data[e],o=i?i.values.value:[],s={},a={},u={},l,c,f,d,h,p,g,m,y,v,x=o.length,b=0,w,S;b<x;++b)if(l=o[b],d=l.unit,c=l.fields,f=l.values,c&&f){for(w=0,S=c.length;w<S;++w)h=c[w],g=s[h.field]||(s[h.field]={}),m=g[d]||(g[d]=[]),u[h.field]=y=h.type.charAt(0),v=Pb[`${y}_union`],g[d]=v(m,Q(f[w]));n&&(m=a[d]||(a[d]=[]),m.push(Q(f).reduce((E,_,k)=>(E[c[k].field]=_,E),{})))}else h=ao,p=Fp(l),g=s[h]||(s[h]={}),m=g[d]||(g[d]=[]),m.push(p),n&&(m=a[d]||(a[d]=[]),m.push({[ao]:p}));if(t=t||pR,s[ao]?s[ao]=Pb[`${ao}_${t}`](...Object.values(s[ao])):Object.keys(s).forEach(E=>{s[E]=Object.keys(s[E]).map(_=>s[E][_]).reduce((_,k)=>_===void 0?k:Pb[`${u[E]}_${t}`](_,k))}),o=Object.keys(a),n&&o.length){const E=r?yce:mce;s[E]=t===pR?{[gR]:o.reduce((_,k)=>(_.push(...a[k]),_),[])}:{[vce]:o.map(_=>({[gR]:a[_]}))}}return s}var Pb={[`${ao}_union`]:OY,[`${ao}_intersect`]:MY,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=mn(t[0]),r=mn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=mn(t[0]),r=mn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const Fce=":",Mce="@";function qA(e,t,n,r){t[0].type!==pl&&z("First argument to selection functions must be a string literal.");const i=t[0].value,o=t.length>=2&&$e(t).value,s="unit",a=Mce+s,u=Fce+i;o===WA&&!ae(r,a)&&(r[a]=n.getData(i).indataRef(n,s)),ae(r,u)||(r[u]=n.getData(i).tuplesRef())}function uB(e){const t=this.context.data[e];return t?t.values.value:[]}function Nce(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function Oce(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(ii).insert(t)),1}function Rce(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const $g=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},Dce=$g("format"),lB=$g("timeFormat"),Pce=$g("utcFormat"),Lce=$g("timeParse"),zce=$g("utcParse"),Nm=new Date(2e3,0,1);function sx(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(Nm.setYear(2e3),Nm.setMonth(e),Nm.setDate(t),lB.call(this,Nm,n))}function Ice(e){return sx.call(this,e,1,"%B")}function Bce(e){return sx.call(this,e,1,"%b")}function jce(e){return sx.call(this,0,2+e,"%A")}function Uce(e){return sx.call(this,0,2+e,"%a")}const Wce=":",qce="@",DS="%",cB="$";function HA(e,t,n,r){t[0].type!==pl&&z("First argument to data functions must be a string literal.");const i=t[0].value,o=Wce+i;if(!ae(o,r))try{r[o]=n.getData(i).tuplesRef()}catch{}}function Hce(e,t,n,r){t[0].type!==pl&&z("First argument to indata must be a string literal."),t[1].type!==pl&&z("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,s=qce+o;ae(s,r)||(r[s]=n.getData(i).indataRef(n,o))}function Bn(e,t,n,r){if(t[0].type===pl)yR(n,r,t[0].value);else for(e in n.scales)yR(n,r,e)}function yR(e,t,n){const r=DS+n;if(!ae(t,r))try{t[r]=e.scaleRef(n)}catch{}}function Po(e,t){if(ge(e))return e;if(K(e)){const n=t.scales[e];return n&&nee(n.value)?n.value:void 0}}function Gce(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=Bn,n._range=Bn,n._scale=Bn;const r=i=>"_["+(i.type===pl?V(DS+i.value):V(DS)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function GA(e,t){return function(n,r,i){if(n){const o=Po(n,(i||this).context);return o&&o.path[e](r)}else return t(r)}}const Vce=GA("area",yie),Yce=GA("bounds",wie),Xce=GA("centroid",Cie);function Qce(e,t){const n=Po(e,(t||this).context);return n&&n.scale()}function Kce(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function VA(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function Jce(){return VA(this.context.dataflow,"warn",arguments)}function Zce(){return VA(this.context.dataflow,"info",arguments)}function efe(){return VA(this.context.dataflow,"debug",arguments)}function Lb(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function PS(e){const t=Na(e),n=Lb(t.r),r=Lb(t.g),i=Lb(t.b);return .2126*n+.7152*r+.0722*i}function tfe(e,t){const n=PS(e),r=PS(t),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function nfe(){const e=[].slice.call(arguments);return e.unshift({}),pe(...e)}function fB(e,t){return e===t||e!==e&&t!==t?!0:I(e)?I(t)&&e.length===t.length?rfe(e,t):!1:J(e)&&J(t)?dB(e,t):!1}function rfe(e,t){for(let n=0,r=e.length;n<r;++n)if(!fB(e[n],t[n]))return!1;return!0}function dB(e,t){for(const n in e)if(!fB(e[n],t[n]))return!1;return!0}function vR(e){return t=>dB(e,t)}function ife(e,t,n,r,i,o){const s=this.context.dataflow,a=this.context.data[e],u=a.input,l=s.stamp();let c=a.changes,f,d;if(s._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(a.changes=c=s.changeset(),c.stamp=l,s.runAfter(()=>{a.modified=!0,s.pulse(u,c).run()},!0,1)),n&&(f=n===!0?ii:I(n)||pv(n)?n:vR(n),c.remove(f)),t&&c.insert(t),r&&(f=vR(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in o)c.modify(i,d,o[d]);return 1}function ofe(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)}function sfe(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const xR={};function afe(e,t){const n=xR[t]||(xR[t]=ri(t));return I(e)?e.map(n):n(e)}function YA(e){return I(e)||ArrayBuffer.isView(e)?e:null}function XA(e){return YA(e)||(K(e)?e:null)}function ufe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return YA(e).join(...n)}function lfe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return XA(e).indexOf(...n)}function cfe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return XA(e).lastIndexOf(...n)}function ffe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return XA(e).slice(...n)}function dfe(e,t,n){return ge(n)&&z("Function argument passed to replace."),String(e).replace(t,n)}function hfe(e){return YA(e).slice().reverse()}function pfe(e,t,n){return iC(e||0,t||0,n||0)}function gfe(e,t){const n=Po(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function mfe(e,t){const n=Po(e,(t||this).context);return n?n.copy():void 0}function yfe(e,t){const n=Po(e,(t||this).context);return n?n.domain():[]}function vfe(e,t,n){const r=Po(e,(n||this).context);return r?I(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function xfe(e,t){const n=Po(e,(t||this).context);return n&&n.range?n.range():[]}function bfe(e,t,n){const r=Po(e,(n||this).context);return r?r(t):void 0}function wfe(e,t,n,r,i){e=Po(e,(i||this).context);const o=sI(t,n);let s=e.domain(),a=s[0],u=$e(s),l=_n;return u-a?l=Y8(e,a,u):e=(e.interpolator?Ne("sequential")().interpolator(e.interpolator()):Ne("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(s=e.ticks(+r||15),a!==s[0]&&s.unshift(a),u!==$e(s)&&s.push(u)),s.forEach(c=>o.stop(l(c),e(c))),o}function Efe(e,t,n){const r=Po(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function Sfe(e){let t=null;return function(n){return n?vp(n,t=t||pf(e)):e}}const hB=e=>e.data;function pB(e,t){const n=uB.call(t,e);return n.root&&n.root.lookup||{}}function _fe(e,t,n){const r=pB(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(hB):void 0}function kfe(e,t){const n=pB(e,this)[t];return n?n.ancestors().map(hB):void 0}const gB=()=>typeof window<"u"&&window||null;function $fe(){const e=gB();return e?e.screen:{}}function Cfe(){const e=gB();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Afe(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function mB(e,t,n){if(!e)return[];const[r,i]=e,o=new Et().set(r[0],r[1],i[0],i[1]),s=n||this.context.dataflow.scenegraph().root;return ZI(s,o,Tfe(t))}function Tfe(e){let t=null;if(e){const n=Q(e.marktype),r=Q(e.markname);t=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return t}function Ffe(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=Q(e);const i=e[e.length-1];return i===void 0||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e}function Mfe(e){return Q(e).reduce((t,n,r)=>{let[i,o]=n;return t+=r==0?`M ${i},${o} `:r===e.length-1?" Z":`L ${i},${o} `},"")}function Nfe(e,t,n){const{x:r,y:i,mark:o}=n,s=new Et().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[u,l]of t)u<s.x1&&(s.x1=u),u>s.x2&&(s.x2=u),l<s.y1&&(s.y1=l),l>s.y2&&(s.y2=l);return s.translate(r,i),mB([[s.x1,s.y1],[s.x2,s.y2]],e,o).filter(u=>Ofe(u.x,u.y,t))}function Ofe(e,t,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[s,a]=n[o],[u,l]=n[i];l>t!=a>t&&e<(s-u)*(t-l)/(a-l)+u&&r++}return r&1}const Mp={random(){return si()},cumulativeNormal:xv,cumulativeLogNormal:i$,cumulativeUniform:u$,densityNormal:Zk,densityLogNormal:r$,densityUniform:a$,quantileNormal:bv,quantileLogNormal:o$,quantileUniform:l$,sampleNormal:vv,sampleLogNormal:n$,sampleUniform:s$,isArray:I,isBoolean:Qa,isDate:ba,isDefined(e){return e!==void 0},isNumber:Te,isObject:J,isRegExp:C6,isString:K,isTuple:pv,isValid(e){return e!=null&&e===e},toBoolean:Nk,toDate(e){return Ok(e)},toNumber:mn,toString:Rk,indexof:lfe,join:ufe,lastindexof:cfe,replace:dfe,reverse:hfe,slice:ffe,flush:k6,lerp:A6,merge:nfe,pad:M6,peek:$e,pluck:afe,span:tg,inrange:kc,truncate:N6,rgb:Na,lab:v1,hcl:x1,hsl:m1,luminance:PS,contrast:tfe,sequence:kr,format:Dce,utcFormat:Pce,utcParse:zce,utcOffset:fL,utcSequence:pL,timeFormat:lB,timeParse:Lce,timeOffset:cL,timeSequence:hL,timeUnitSpecifier:Z6,monthFormat:Ice,monthAbbrevFormat:Bce,dayFormat:jce,dayAbbrevFormat:Uce,quarter:w6,utcquarter:E6,week:tL,utcweek:iL,dayofyear:eL,utcdayofyear:rL,warn:Jce,info:Zce,debug:efe,extent(e){return Eo(e)},inScope:Kce,intersect:mB,clampRange:S6,pinchDistance:ofe,pinchAngle:sfe,screen:$fe,containerSize:Afe,windowSize:Cfe,bandspace:pfe,setdata:Oce,pathShape:Sfe,panLinear:y6,panLog:v6,panPow:x6,panSymlog:b6,zoomLinear:$k,zoomLog:Ck,zoomPow:r1,zoomSymlog:Ak,encode:Rce,modify:ife,lassoAppend:Ffe,lassoPath:Mfe,intersectLasso:Nfe},Rfe=["view","item","group","xy","x","y"],Dfe="event.vega.",yB="this.",QA={},vB={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${V(cB+e)}]`,functions:Pfe,constants:rB,visitors:QA},LS=oB(vB);function Pfe(e){const t=iB(e);Rfe.forEach(n=>t[n]=Dfe+n);for(const n in Mp)t[n]=yB+n;return pe(t,Gce(e,Mp,QA)),t}function bt(e,t,n){return arguments.length===1?Mp[e]:(Mp[e]=t,n&&(QA[e]=n),LS&&(LS.functions[e]=yB+e),this)}bt("bandwidth",gfe,Bn);bt("copy",mfe,Bn);bt("domain",yfe,Bn);bt("range",xfe,Bn);bt("invert",vfe,Bn);bt("scale",bfe,Bn);bt("gradient",wfe,Bn);bt("geoArea",Vce,Bn);bt("geoBounds",Yce,Bn);bt("geoCentroid",Xce,Bn);bt("geoShape",Efe,Bn);bt("geoScale",Qce,Bn);bt("indata",Nce,Hce);bt("data",uB,HA);bt("treePath",_fe,HA);bt("treeAncestors",kfe,HA);bt("vlSelectionTest",_ce,qA);bt("vlSelectionIdTest",Cce,qA);bt("vlSelectionResolve",Tce,qA);bt("vlSelectionTuples",Ace);function Co(e,t){const n={};let r;try{e=K(e)?e:V(e)+"",r=UA(e)}catch{z("Expression parse error: "+e)}r.visit(o=>{if(o.type!==Q7)return;const s=o.callee.name,a=vB.visitors[s];a&&a(s,o.arguments,t,n)});const i=LS(r);return i.globals.forEach(o=>{const s=cB+o;!ae(n,s)&&t.getSignal(o)&&(n[s]=t.signalRef(o))}),{$expr:pe({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function Lfe(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const zfe=Bi(["rule"]),bR=Bi(["group","image","rect"]);function Ife(e,t){let n="";return zfe[t]||(e.x2&&(e.x?(bR[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(bR[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function KA(e){return(e+"").toLowerCase()}function Bfe(e){return KA(e)==="operator"}function jfe(e){return KA(e)==="collect"}function Rd(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function Ufe(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `}var Wfe={operator:(e,t)=>Rd(e,["_"],t.code),parameter:(e,t)=>Rd(e,["datum","_"],t.code),event:(e,t)=>Rd(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return Rd(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const s="o["+V(o)+"]";i+=`$=${r[o].code};if(${s}!==$)${s}=$,m=1;`}return i+=Ife(r,n),i+="return m;",Rd(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(V).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=(o,s)=>{const a=t[s];let u,l;return o.path?(u=`a${o.path}`,l=`b${o.path}`):((n=n||{})["f"+s]=o,u=`this.f${s}(a)`,l=`this.f${s}(b)`),Ufe(u,l,-a,a)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function qfe(e){const t=this;Bfe(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function Hfe(e){const t=this;if(e.params){const n=t.get(e.id);n||z("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Gfe(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=I(i)?i.map(o=>wR(o,n,t)):wR(i,n,t)}return t}function wR(e,t,n){if(!e||!J(e))return e;for(let r=0,i=ER.length,o;r<i;++r)if(o=ER[r],ae(e,o.key))return o.parse(e,t,n);return e}var ER=[{key:"$ref",parse:Vfe},{key:"$key",parse:Xfe},{key:"$expr",parse:Yfe},{key:"$field",parse:Qfe},{key:"$encode",parse:Jfe},{key:"$compare",parse:Kfe},{key:"$context",parse:Zfe},{key:"$subflow",parse:ede},{key:"$tupleid",parse:tde}];function Vfe(e,t){return t.get(e.$ref)||z("Operator not defined: "+e.$ref)}function Yfe(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=gr(t.parameterExpression(e.$expr),e.$fields))}function Xfe(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Mk(e.$key,e.$flat,t.expr.codegen))}function Qfe(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=ri(e.$field,e.$name,t.expr.codegen))}function Kfe(e,t){const n="c:"+e.$compare+"_"+e.$order,r=Q(e.$compare).map(i=>i&&i.$tupleid?oe:i);return t.fn[n]||(t.fn[n]=Tk(r,e.$order,t.expr.codegen))}function Jfe(e,t){const n=e.$encode,r={};for(const i in n){const o=n[i];r[i]=gr(t.encodeExpression(o.$expr),o.$fields),r[i].output=o.$output}return r}function Zfe(e,t){return t}function ede(e,t){const n=e.$subflow;return function(r,i,o){const s=t.fork().parse(n),a=s.get(n.operators[0].id),u=s.signals.parent;return u&&u.set(o),a.detachSubflow=()=>t.detach(s),a}}function tde(){return oe}function nde(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(o=>t.get(o)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(o=>t.get(o)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&z("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function rde(e){var t=this,n=J(n=e.source)?n.$ref:n,r=t.get(n),i=null,o=e.update,s=void 0;r||z("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(s=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,r,i,o,s)}const ide={skip:!0};function ode(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(o=>{const s=t.signals[o];e.signals(o,s)&&(r[o]=s.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(o=>{const s=t.data[o];e.data(o,s)&&(i[o]=s.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function sde(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(o=>{n.update(t.signals[o],i[o],ide)}),Object.keys(r||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(ii).insert(r[o]))}),(e.subcontext||[]).forEach((o,s)=>{const a=t.subcontext[s];a&&a.setState(o)})}function xB(e,t,n,r){return new bB(e,t,n,r)}function bB(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||Wfe,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function SR(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}bB.prototype=SR.prototype={fork(){const e=new SR(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),jfe(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(r.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),r.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const s=n.data[o]||(n.data[o]={});e.data[o].forEach(a=>s[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[KA(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Lfe,parseOperator:qfe,parseOperatorParameters:Hfe,parseParameters:Gfe,parseStream:nde,parseUpdate:rde,getState:ode,setState:sde};function ade(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),wB(t,e.description()))}function wB(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function ude(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const zb="default";function lde(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:zb,item:null}));e.on(e.events("view","pointermove"),t,(n,r)=>{const i=t.value,o=i?K(i)?i:i.user:zb,s=r.item&&r.item.cursor||null;return i&&o===i.user&&s==i.item?i:{user:o,item:s}}),e.add(null,function(n){let r=n.cursor,i=this.value;return K(r)||(i=r.item,r=r.user),zS(e,r&&r!==zb?r:i||r),i},{cursor:t})}function zS(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function dy(e,t){var n=e._runtime.data;return ae(n,t)||z("Unrecognized data set: "+t),n[t]}function cde(e,t){return arguments.length<2?dy(this,e).values.value:ax.call(this,e,Dl().remove(ii).insert(t))}function ax(e,t){jL(t)||z("Second argument to changes must be a changeset.");const n=dy(this,e);return n.modified=!0,this.pulse(n.input,t)}function fde(e,t){return ax.call(this,e,Dl().insert(t))}function dde(e,t){return ax.call(this,e,Dl().remove(t))}function EB(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function SB(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function ux(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function hde(e){var t=ux(e),n=EB(e),r=SB(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(o){e.error(o)}})}function pde(e,t,n){var r=e._renderer,i=r&&r.canvas(),o,s,a;return i&&(a=ux(e),s=t.changedTouches?t.changedTouches[0]:t,o=Vv(s,i),o[0]-=a[0],o[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=gde(e,n,o),t}function gde(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(s){var a=r,u;if(s){for(u=t;u;u=u.mark.group)if(u.mark.name===s){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function o(s){if(!s)return n;K(s)&&(s=i(s));const a=n.slice();for(;s;)a[0]-=s.x||0,a[1]-=s.y||0,s=s.mark&&s.mark.group;return a}return{view:kn(e),item:kn(t||{}),group:i,xy:o,x:s=>o(s)[0],y:s=>o(s)[1]}}const _R="view",mde="timer",yde="window",vde={trap:!1};function xde(e){const t=pe({defaults:{}},e),n=(r,i)=>{i.forEach(o=>{I(r[o])&&(r[o]=Bi(r[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function _B(e,t,n,r){e._eventListeners.push({type:n,sources:Q(t),handler:r})}function bde(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function Om(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||J(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function wde(e,t,n){var r=this,i=new yv(n),o=function(l,c){r.runAsync(null,()=>{e===_R&&bde(r,t)&&l.preventDefault(),i.receive(pde(r,l,c))})},s;if(e===mde)Om(r,"timer",t)&&r.timer(o,t);else if(e===_R)Om(r,"view",t)&&r.addEventListener(t,o,vde);else if(e===yde?Om(r,"window",t)&&typeof window<"u"&&(s=[window]):typeof document<"u"&&Om(r,"selector",t)&&(s=Array.from(document.querySelectorAll(e))),!s)r.warn("Can not resolve event source: "+e);else{for(var a=0,u=s.length;a<u;++a)s[a].addEventListener(t,o);_B(r,s,t,o)}return i}function kR(e){return e.item}function $R(e){return e.item.mark.source}function CR(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Ede(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","pointerover",kR),$R,CR(e)),this.on(this.events("view","pointerout",kR),$R,CR(t)),this}function Sde(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,o;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(o=n[r],i=o.sources.length;--i>=0;)o.sources[i].removeEventListener(o.type,o.handler);return e&&e.call(this,this._handler,null,null,null),this}function Tr(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const _de="vega-bind",kde="vega-bind-name",$de="vega-bind-radio";function Cde(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:s=>{s!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,s)})}},r.debounce&&(i.update=Fk(r.debounce,i.update))),(r.input==null&&r.element?Ade:Fde)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function Ade(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),_B(r,t,i,o),e.set=s=>{t.value=s,t.dispatchEvent(Tde(i))}}function Tde(e){return typeof Event<"u"?new Event(e):{type:e}}function Fde(e,t,n,r){const i=r.signal(n.signal),o=Tr("div",{class:_de}),s=n.input==="radio"?o:o.appendChild(Tr("label"));s.appendChild(Tr("span",{class:kde},n.name||n.signal)),t.appendChild(o);let a=Mde;switch(n.input){case"checkbox":a=Nde;break;case"select":a=Ode;break;case"radio":a=Rde;break;case"range":a=Dde;break}a(e,s,n,i)}function Mde(e,t,n,r){const i=Tr("input");for(const o in n)o!=="signal"&&o!=="element"&&i.setAttribute(o==="input"?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=o=>i.value=o}function Nde(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=Tr("input",i);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=s=>o.checked=!!s||null}function Ode(e,t,n,r){const i=Tr("select",{name:n.signal}),o=n.labels||[];n.options.forEach((s,a)=>{const u={value:s};hy(s,r)&&(u.selected=!0),i.appendChild(Tr("option",u,(o[a]||s)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=s=>{for(let a=0,u=n.options.length;a<u;++a)if(hy(n.options[a],s)){i.selectedIndex=a;return}}}function Rde(e,t,n,r){const i=Tr("span",{class:$de}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map((s,a)=>{const u={type:"radio",name:n.signal,value:s};hy(s,r)&&(u.checked=!0);const l=Tr("input",u);l.addEventListener("change",()=>e.update(s));const c=Tr("label",{},(o[a]||s)+"");return c.prepend(l),i.appendChild(c),l}),e.set=s=>{const a=e.elements,u=a.length;for(let l=0;l<u;++l)hy(a[l].value,s)&&(a[l].checked=!0)}}function Dde(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,s=n.step||Ta(o,i,100),a=Tr("input",{type:"range",name:n.signal,min:o,max:i,step:s});a.value=r;const u=Tr("span",{},+r);t.appendChild(a),t.appendChild(u);const l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function hy(e,t){return e===t||e+""==t+""}function kB(e,t,n,r,i,o){return t=t||new r(e.loader()),t.initialize(n,EB(e),SB(e),ux(e),i,o).background(e.background())}function JA(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Pde(e,t,n,r){const i=new r(e.loader(),JA(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,ux(e),e);return t&&t.handlers().forEach(o=>{i.on(o.type,o.handler)}),i}function Lde(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=Xv(r);e=n._el=e?Ib(n,e,!0):null,ade(n),o||n.error("Unrecognized renderer type: "+r);const s=o.handler||La,a=e?o.renderer:o.headless;return n._renderer=a?kB(n,n._renderer,e,a):null,n._handler=Pde(n,n._handler,e,s),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=Ib(n,t,!0):e.appendChild(Tr("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=Ib(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{Cde(n,u.element||t,u)})),n}function Ib(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(r){t=null,e.error(r)}return t}const Dd=e=>+e||0,zde=e=>({top:e,bottom:e,left:e,right:e});function AR(e){return J(e)?{top:Dd(e.top),bottom:Dd(e.bottom),left:Dd(e.left),right:Dd(e.right)}:zde(Dd(e))}async function ZA(e,t,n,r){const i=Xv(t),o=i&&i.headless;return o||z("Unrecognized renderer type: "+t),await e.runAsync(),kB(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}async function Ide(e,t){e!==oa.Canvas&&e!==oa.SVG&&e!==oa.PNG&&z("Unrecognized image type: "+e);const n=await ZA(this,e,t);return e===oa.SVG?Bde(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Bde(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function jde(e,t){return(await ZA(this,oa.Canvas,e,t)).canvas()}async function Ude(e){return(await ZA(this,oa.SVG,e)).svg()}function Wde(e,t,n){return xB(e,uf,Mp,n).parse(t)}function qde(e){var t=this._runtime.scales;return ae(t,e)||z("Unrecognized scale or projection: "+e),t[e].value}var $B="width",CB="height",e3="padding",TR={skip:!0};function AB(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===e3?r.left+r.right:0)}function TB(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===e3?r.top+r.bottom:0)}function Hde(e){var t=e._signals,n=t[$B],r=t[CB],i=t[e3];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=AB(e,a.size),o()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=TB(e,a.size),o()},{size:r});const s=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,s.rank=i.rank+1}function Gde(e,t,n,r,i,o){this.runAfter(s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal($B,n,TR),s._resizeWidth.skip(!0)),s.height()!==r&&(a=1,s.signal(CB,r,TR),s._resizeHeight.skip(!0)),s._viewWidth!==e&&(s._resize=1,s._viewWidth=e),s._viewHeight!==t&&(s._resize=1,s._viewHeight=t),(s._origin[0]!==i[0]||s._origin[1]!==i[1])&&(s._resize=1,s._origin=i),a&&s.run("enter"),o&&s.runAfter(u=>u.resize())},!1,1)}function Vde(e){return this._runtime.getState(e||{data:Yde,signals:Xde,recurse:!0})}function Yde(e,t){return t.modified&&I(t.input.value)&&!e.startsWith("_:vega:_")}function Xde(e,t){return!(e==="parent"||t instanceof uf.proxy)}function Qde(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Kde(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(Ase(n,t))}function Jde(e,t,n,r){const i=e.element();i&&i.setAttribute("title",Zde(r))}function Zde(e){return e==null?"":I(e)?FB(e):J(e)&&!ba(e)?ehe(e):e+""}function ehe(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(I(n)?FB(n):MB(n))}).join(`
`)}function FB(e){return"["+e.map(MB).join(", ")+"]"}function MB(e){return I(e)?"[]":J(e)&&!ba(e)?"{}":e}function the(){if(this.renderer()==="canvas"&&this._renderer._canvas){let e=null;const t=()=>{e!=null&&e();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};t()}}function NB(e,t){const n=this;if(t=t||{},Lc.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const o=pe({},e.locale,t.locale);n.locale(ML(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||oa.Canvas,n._scenegraph=new RC;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Jde,n._redraw=!0,n._handler=new La().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=xde(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=Wde(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:pe({},o)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=AB(n,n._width),n._viewHeight=TB(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,Hde(n),ude(n),lde(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio()}function Rm(e,t){return ae(e._signals,t)?e._signals[t]:z("Unrecognized signal name: "+V(t))}function OB(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function FR(e,t,n,r){let i=OB(n,r);return i||(i=JA(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function MR(e,t,n){const r=OB(t,n);return r&&t._targets.remove(r),e}G(NB,Lc,{async evaluate(e,t,n){if(await Lc.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,hde(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&s0(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&wB(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=Rm(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",AR(e)):AR(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Xv(e)||z("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Lc.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Rm(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Gde,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=JA(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,o;--r>=0;)if(o=n[r].type,i=n[r].handler,e===o&&(t===i||t===i.raw)){this._handler.off(o,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return FR(this,e,Rm(this,e),t)},removeSignalListener(e,t){return MR(this,Rm(this,e),t)},addDataListener(e,t){return FR(this,e,dy(this,e).values,t)},removeDataListener(e,t){return MR(this,dy(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=zS(this,null);this._globalCursor=!!e,t&&zS(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Kde,events:wde,finalize:Sde,hover:Ede,data:cde,change:ax,insert:fde,remove:dde,scale:qde,initialize:Lde,toImageURL:Ide,toCanvas:jde,toSVG:Ude,getState:Vde,setState:Qde,_watchPixelRatio:the});const nhe="view",py="[",gy="]",RB="{",DB="}",rhe=":",PB=",",ihe="@",ohe=">",she=/[[\]{}]/,ahe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let LB,zB;function nu(e,t,n){return LB=t||nhe,zB=n||ahe,IB(e.trim()).map(IS)}function uhe(e){return zB[e]}function jh(e,t,n,r,i){const o=e.length;let s=0,a;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function IB(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=jh(e,i,PB,py+RB,gy+DB),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function IS(e){return e[0]==="["?lhe(e):che(e)}function lhe(e){const t=e.length;let n=1,r;if(n=jh(e,n,gy,py,gy),n===t)throw"Empty between selector: "+e;if(r=IB(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==ohe)throw"Expected '>' after between selector: "+e;r=r.map(IS);const i=IS(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function che(e){const t={source:LB},n=[];let r=[0,0],i=0,o=0,s=e.length,a=0,u,l;if(e[s-1]===DB){if(a=e.lastIndexOf(RB),a>=0){try{r=fhe(e.substring(a+1,s-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),s=e.length}else throw"Unmatched right brace: "+e;a=0}if(!s)throw e;if(e[0]===ihe&&(i=++a),u=jh(e,a,rhe),u<s&&(n.push(e.substring(o,u).trim()),o=a=++u),a=jh(e,a,py),a===s)n.push(e.substring(o,s).trim());else if(n.push(e.substring(o,a).trim()),l=[],o=++a,o===s)throw"Unmatched left bracket: "+e;for(;a<s;){if(a=jh(e,a,gy),a===s)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,a).trim()),a<s-1&&e[++a]!==py)throw"Expected left bracket: "+e;o=++a}if(!(s=n.length)||she.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],i?t.markname=n[0].slice(1):uhe(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function fhe(e){const t=e.split(PB);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function dhe(e){return J(e)?e:{type:e||"pad"}}const Pd=e=>+e||0,hhe=e=>({top:e,bottom:e,left:e,right:e});function phe(e){return J(e)?e.signal?e:{top:Pd(e.top),bottom:Pd(e.bottom),left:Pd(e.left),right:Pd(e.right)}:hhe(Pd(e))}const It=e=>J(e)&&!I(e)?pe({},e):{value:e};function NR(e,t,n,r){return n!=null?(J(n)&&!I(n)||I(n)&&n.length&&J(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function nn(e,t,n){for(const r in t)NR(e,r,t[r]);for(const r in n)NR(e,r,n[r],"update")}function td(e,t,n){for(const r in t)n&&ae(n,r)||(e[r]=pe(e[r]||{},t[r]));return e}function fc(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const t3="mark",n3="frame",r3="scope",ghe="axis",mhe="axis-domain",yhe="axis-grid",vhe="axis-label",xhe="axis-tick",bhe="axis-title",whe="legend",Ehe="legend-band",She="legend-entry",_he="legend-gradient",BB="legend-label",khe="legend-symbol",$he="legend-title",Che="title",Ahe="title-text",The="title-subtitle";function Fhe(e,t,n,r,i){const o={},s={};let a,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!fc(u,e)&&Bb(o,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===n3?i.group:n===t3?pe({},i.mark,i[t]):null;for(u in c)l=fc(u,e)||(u==="fill"||u==="stroke")&&(fc("fill",e)||fc("stroke",e)),l||Bb(o,u,c[u]);Q(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)fc(h,e)||Bb(o,h,d[h])}),e=pe({},e);for(u in o)c=o[u],c.signal?(a=a||{})[u]=c:s[u]=c;return e.enter=pe(s,e.enter),a&&(e.update=pe(a,e.update)),e}function Bb(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const jB=e=>K(e)?V(e):e.signal?`(${e.signal})`:UB(e);function lx(e){if(e.gradient!=null)return Nhe(e);let t=e.signal?`(${e.signal})`:e.color?Mhe(e.color):e.field!=null?UB(e.field):e.value!==void 0?V(e.value):void 0;return e.scale!=null&&(t=Ohe(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${S0(e.exponent)})`),e.mult!=null&&(t+=`*${S0(e.mult)}`),e.offset!=null&&(t+=`+${S0(e.offset)}`),e.round&&(t=`round(${t})`),t}const Dm=(e,t,n,r)=>`(${e}(${[t,n,r].map(lx).join(",")})+'')`;function Mhe(e){return e.c?Dm("hcl",e.h,e.c,e.l):e.h||e.s?Dm("hsl",e.h,e.s,e.l):e.l||e.a?Dm("lab",e.l,e.a,e.b):e.r||e.g||e.b?Dm("rgb",e.r,e.g,e.b):null}function Nhe(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:V(n));for(;t.length&&$e(t)==null;)t.pop();return t.unshift(jB(e.gradient)),`gradient(${t.join(",")})`}function S0(e){return J(e)?"("+lx(e)+")":e}function UB(e){return WB(J(e)?e:{datum:e})}function WB(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):z("Invalid field reference: "+V(e));return e.signal||(r=K(r)?Mo(r).map(V).join("]["):WB(r)),t+"["+r+"]"}function Ohe(e,t){const n=jB(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+S0(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function Rhe(e){let t="";return e.forEach(n=>{const r=lx(n);t+=n.test?`(${n.test})?${r}:`:r}),$e(t)===":"&&(t+="null"),t}function qB(e,t,n,r,i,o){const s={};o=o||{},o.encoders={$encode:s},e=Fhe(e,t,n,r,i.config);for(const a in e)s[a]=Dhe(e[a],t,o,i);return o}function Dhe(e,t,n,r){const i={},o={};for(const s in e)e[s]!=null&&(i[s]=Lhe(Phe(e[s]),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function Phe(e){return I(e)?Rhe(e):lx(e)}function Lhe(e,t,n,r){const i=Co(e,t);return i.$fields.forEach(o=>r[o]=1),pe(n,i.$params),i.$expr}const zhe="outer",Ihe=["value","update","init","react","bind"];function OR(e,t){z(e+' for "outer" push: '+V(t))}function HB(e,t){const n=e.name;if(e.push===zhe)t.signals[n]||OR("No prior signal definition",n),Ihe.forEach(r=>{e[r]!==void 0&&OR("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function BS(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function cx(e,t,n,r){return new BS(e,t,n,r)}function my(e,t){return cx("operator",e,t)}function ie(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Np(e,t){return t?{$field:e,$name:t}:{$field:e}}const jS=Np("key");function RR(e,t){return{$compare:e,$order:t}}function Bhe(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const jhe="ascending",Uhe="descending";function Whe(e){return J(e)?(e.order===Uhe?"-":"+")+fx(e.op,e.field):""}function fx(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const i3="scope",US="view";function Tt(e){return e&&e.signal}function qhe(e){return e&&e.expr}function _0(e){if(Tt(e))return!0;if(J(e)){for(const t in e)if(_0(e[t]))return!0}return!1}function _i(e,t){return e??t}function Qu(e){return e&&e.signal||e}const DR="timer";function Op(e,t){return(e.merge?Ghe:e.stream?Vhe:e.type?Yhe:z("Invalid stream specification: "+V(e)))(e,t)}function Hhe(e){return e===i3?US:e||US}function Ghe(e,t){const n=e.merge.map(i=>Op(i,t)),r=o3({merge:n},e,t);return t.addStream(r).id}function Vhe(e,t){const n=Op(e.stream,t),r=o3({stream:n},e,t);return t.addStream(r).id}function Yhe(e,t){let n;e.type===DR?(n=t.event(DR,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Hhe(e.source),e.type);const r=o3({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function o3(e,t,n){let r=t.between;return r&&(r.length!==2&&z('Stream "between" parameter must have 2 entries: '+V(t)),e.between=[Op(r[0],n),Op(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(Xhe(t.marktype,t.markname,t.markrole)),t.source===i3&&r.push("inScope(event.item)"),r.length&&(e.filter=Co("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function Xhe(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const Qhe={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Khe(e,t,n){const r=e.encode,i={target:n};let o=e.events,s=e.update,a=[];o||z("Signal update missing events specification."),K(o)&&(o=nu(o,t.isSubscope()?i3:US)),o=Q(o).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[Zhe(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),r!=null&&(s&&z("Signal encode and update are mutually exclusive."),s="encode(item(),"+V(r)+")"),i.update=K(s)?Co(s,t):s.expr!=null?Co(s.expr,t):s.value!=null?s.value:s.signal!=null?{$expr:Qhe,$params:{$value:t.signalRef(s.signal)}}:z("Invalid signal update specification."),e.force&&(i.options={force:!0}),a.forEach(u=>t.addUpdate(pe(Jhe(u,t),i)))}function Jhe(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):Op(e,t)}}function Zhe(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function epe(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?z("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=Co(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>Khe(i,t,n.id))}const qe=e=>(t,n,r)=>cx(e,n,t||void 0,r),GB=qe("aggregate"),tpe=qe("axisticks"),VB=qe("bound"),Gi=qe("collect"),PR=qe("compare"),npe=qe("datajoin"),YB=qe("encode"),rpe=qe("expression"),ipe=qe("facet"),ope=qe("field"),spe=qe("key"),ape=qe("legendentries"),upe=qe("load"),lpe=qe("mark"),cpe=qe("multiextent"),fpe=qe("multivalues"),dpe=qe("overlap"),hpe=qe("params"),XB=qe("prefacet"),ppe=qe("projection"),gpe=qe("proxy"),mpe=qe("relay"),QB=qe("render"),ype=qe("scale"),Il=qe("sieve"),vpe=qe("sortitems"),KB=qe("viewlayout"),xpe=qe("values");let bpe=0;const JB={min:"min",max:"max",count:"sum"};function wpe(e,t){const n=e.type||"linear";U8(n)||z("Unrecognized scale type: "+V(n)),t.addScale(e.name,{type:n,domain:void 0})}function Epe(e,t){const n=t.getScale(e.name).params;let r;n.domain=ZB(e.domain,e,t),e.range!=null&&(n.range=tj(e,t,n)),e.interpolate!=null&&Npe(e.interpolate,n),e.nice!=null&&(n.nice=Mpe(e.nice,t)),e.bins!=null&&(n.bins=Fpe(e.bins,t));for(r in e)ae(n,r)||r==="name"||(n[r]=Qr(e[r],t))}function Qr(e,t){return J(e)?e.signal?t.signalRef(e.signal):z("Unsupported object: "+V(e)):e}function k0(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Qr(n,t))}function dx(e){z("Can not find data set: "+V(e))}function ZB(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&z("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(I(e)?Spe:e.fields?kpe:_pe)(e,t,n)}function Spe(e,t,n){return e.map(r=>Qr(r,n))}function _pe(e,t,n){const r=n.getData(e.data);return r||dx(e.data),hf(t.type)?r.valuesRef(n,e.field,ej(e.sort,!1)):H8(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function kpe(e,t,n){const r=e.data,i=e.fields.reduce((o,s)=>(s=K(s)?{data:r,field:s}:I(s)||s.signal?$pe(s,n):s,o.push(s),o),[]);return(hf(t.type)?Cpe:H8(t.type)?Ape:Tpe)(e,n,i)}function $pe(e,t){const n="_:vega:_"+bpe++,r=Gi({});if(I(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+V(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Il({})]),{data:n,field:"data"}}function Cpe(e,t,n){const r=ej(e.sort,!0);let i,o;const s=n.map(l=>{const c=t.getData(l.data);return c||dx(l.data),c.countsRef(t,l.field,r)}),a={groupby:jS,pulse:s};r&&(i=r.op||"count",o=r.field?fx(i,r.field):"count",a.ops=[JB[i]],a.fields=[t.fieldRef(o)],a.as=[o]),i=t.add(GB(a));const u=t.add(Gi({pulse:ie(i)}));return o=t.add(xpe({field:jS,sort:t.sortRef(r),pulse:ie(u)})),ie(o)}function ej(e,t){return e&&(!e.field&&!e.op?J(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?z("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!JB[e.op]&&z("Multiple domain scales can not be sorted using "+e.op)),e}function Ape(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||dx(i.data),o.domainRef(t,i.field)});return ie(t.add(fpe({values:r})))}function Tpe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||dx(i.data),o.extentRef(t,i.field)});return ie(t.add(cpe({extents:r})))}function Fpe(e,t){return e.signal||I(e)?k0(e,t):t.objectProperty(e)}function Mpe(e,t){return e.signal?t.signalRef(e.signal):J(e)?{interval:Qr(e.interval),step:Qr(e.step)}:Qr(e)}function Npe(e,t){t.interpolate=Qr(e.type||e),e.gamma!=null&&(t.interpolateGamma=Qr(e.gamma))}function tj(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(K(i)){if(r&&ae(r,i))return e=pe({},e,{range:r[i]}),tj(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=hf(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:z("Unrecognized scale range value: "+V(i))}else if(i.scheme){n.scheme=I(i.scheme)?k0(i.scheme,t):Qr(i.scheme,t),i.extent&&(n.schemeExtent=k0(i.extent,t)),i.count&&(n.schemeCount=Qr(i.count,t));return}else if(i.step){n.rangeStep=Qr(i.step,t);return}else{if(hf(e.type)&&!I(i))return ZB(i,e,t);I(i)||z("Unsupported range type: "+V(i))}return i.map(o=>(I(o)?k0:Qr)(o,t))}function Ope(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=WS(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=WS(n[i],i,t));t.addProjection(e.name,r)}function WS(e,t,n){return I(e)?e.map(r=>WS(r,t,n)):J(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:z("Unsupported parameter object: "+V(e)):e}const Vi="top",nd="left",rd="right",Ia="bottom",nj="center",Rpe="vertical",Dpe="start",Ppe="middle",Lpe="end",qS="index",s3="label",zpe="offset",Ef="perc",Ipe="perc2",Zr="value",Cg="guide-label",a3="guide-title",Bpe="group-title",jpe="group-subtitle",LR="symbol",$0="gradient",HS="discrete",GS="size",Upe="shape",Wpe="fill",qpe="stroke",Hpe="strokeWidth",Gpe="strokeDash",Vpe="opacity",u3=[GS,Upe,Wpe,qpe,Hpe,Gpe,Vpe],Ag={name:1,style:1,interactive:1},Ce={value:0},ei={value:1},hx="group",rj="rect",l3="rule",Ype="symbol",Bl="text";function Rp(e){return e.type=hx,e.interactive=e.interactive||!1,e}function mr(e,t){const n=(r,i)=>_i(e[r],_i(t[r],i));return n.isVertical=r=>Rpe===_i(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>_i(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>_i(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>_i(e.columns,_i(t.columns,+n.isVertical(!0))),n}function ij(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Xpe(e,t,n){const r=t.config.style[n];return r&&r[e]}function px(e,t,n){return`item.anchor === '${Dpe}' ? ${e} : item.anchor === '${Lpe}' ? ${t} : ${n}`}const c3=px(V(nd),V(rd),V(nj));function Qpe(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},J(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function oj(e,t){return t?e?J(e)?Object.assign({},e,{offset:oj(e.offset,t)}):{value:e,offset:t}:t:e}function Dr(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=td(e.encode,t,Ag)):e.interactive=!1,e}function Kpe(e,t,n,r){const i=mr(e,n),o=i.isVertical(),s=i.gradientThickness(),a=i.gradientLength();let u,l,c,f,d;o?(l=[0,1],c=[0,0],f=s,d=a):(l=[0,0],c=[1,0],f=a,d=s);const h={enter:u={opacity:Ce,x:Ce,y:Ce,width:It(f),height:It(d)},update:pe({},u,{opacity:ei,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:Ce}};return nn(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Dr({type:rj,role:_he,encode:h},r)}function Jpe(e,t,n,r,i){const o=mr(e,n),s=o.isVertical(),a=o.gradientThickness(),u=o.gradientLength();let l,c,f,d,h="";s?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:Ce,fill:{scale:t,field:Zr}};p[l]={signal:h+"datum."+Ef,mult:u},p[c]=Ce,p[f]={signal:h+"datum."+Ipe,mult:u},p[d]=It(a);const g={enter:p,update:pe({},p,{opacity:ei}),exit:{opacity:Ce}};return nn(g,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),Dr({type:rj,role:Ehe,key:Zr,from:i,encode:g},r)}const Zpe=`datum.${Ef}<=0?"${nd}":datum.${Ef}>=1?"${rd}":"${nj}"`,ege=`datum.${Ef}<=0?"${Ia}":datum.${Ef}>=1?"${Vi}":"${Ppe}"`;function zR(e,t,n,r){const i=mr(e,t),o=i.isVertical(),s=It(i.gradientThickness()),a=i.gradientLength();let u=i("labelOverlap"),l,c,f,d,h="";const p={enter:l={opacity:Ce},update:c={opacity:ei,text:{field:s3}},exit:{opacity:Ce}};return nn(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:_i(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=c.baseline={signal:ege},f="y",d="x",h="1-"):(l.align=c.align={signal:Zpe},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+Ef,mult:a},l[d]=c[d]=s,s.offset=_i(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+qS}:void 0,Dr({type:Bl,role:BB,style:Cg,key:Zr,from:r,encode:p,overlap:u},n)}function tge(e,t,n,r,i){const o=mr(e,t),s=n.entries,a=!!(s&&s.interactive),u=s?s.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${zpe} : datum.${GS}`,h=l?It(l):{field:GS},p=`datum.${qS}`,g=`max(1, ${i})`;let m,y,v,x,b;h.mult=.5,m={enter:y={opacity:Ce,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:ei,x:y.x,y:y.y},exit:{opacity:Ce}};let w=null,S=null;e.fill||(w=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),nn(m,{fill:o("symbolFillColor",w),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",S),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),u3.forEach($=>{e[$]&&(v[$]=y[$]={scale:e[$],field:Zr})});const E=Dr({type:Ype,role:khe,key:Zr,from:f,clip:l?!0:void 0,encode:m},n.symbols),_=It(c);_.offset=o("labelOffset"),m={enter:y={opacity:Ce,x:{signal:d,offset:_},y:h},update:v={opacity:ei,text:{field:s3},x:y.x,y:y.y},exit:{opacity:Ce}},nn(m,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const k=Dr({type:Bl,role:BB,style:Cg,key:Zr,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:Ce,height:l?It(l):Ce,opacity:Ce},exit:{opacity:Ce},update:v={opacity:ei,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(x=`ceil(item.mark.items.length / ${g})`,v.row.signal=`${p}%${x}`,v.column.signal=`floor(${p} / ${x})`,b={field:["row",p]}):(v.row.signal=`floor(${p} / ${g})`,v.column.signal=`${p} % ${g}`,b={field:p}),v.column.signal=`(${i})?${v.column.signal}:${p}`,r={facet:{data:r,name:"value",groupby:qS}},Rp({role:r3,from:r,encode:td(m,s,Ag),marks:[E,k],name:u,interactive:a,sort:b})}function nge(e,t){const n=mr(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const f3='item.orient === "left"',d3='item.orient === "right"',gx=`(${f3} || ${d3})`,rge=`datum.vgrad && ${gx}`,ige=px('"top"','"bottom"','"middle"'),oge=px('"right"','"left"','"center"'),sge=`datum.vgrad && ${d3} ? (${oge}) : (${gx} && !(datum.vgrad && ${f3})) ? "left" : ${c3}`,age=`item._anchor || (${gx} ? "middle" : "start")`,uge=`${rge} ? (${f3} ? -90 : 90) : 0`,lge=`${gx} ? (datum.vgrad ? (${d3} ? "bottom" : "top") : ${ige}) : "top"`;function cge(e,t,n,r){const i=mr(e,t),o={enter:{opacity:Ce},update:{opacity:ei,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Ce}};return nn(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:age},angle:{signal:uge},align:{signal:sge},baseline:{signal:lge},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Dr({type:Bl,role:$he,style:a3,from:r,encode:o},n)}function fge(e,t){let n;return J(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+IR(e.path)+")":e.sphere&&(n="geoShape("+IR(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function IR(e){return J(e)&&e.signal?e.signal:V(e)}function sj(e){const t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===hx?r3:t||t3}function dge(e){return{marktype:e.type,name:e.name||void 0,role:e.role||sj(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function hge(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function h3(e,t){const n=qL(e.type);n||z("Unrecognized transform type: "+V(e.type));const r=cx(n.type.toLowerCase(),null,aj(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function aj(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const s=e.params[o];r[s.name]=pge(s,t,n)}return r}function pge(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return gge(e,t,n);if(i===void 0){e.required&&z("Missing required "+V(t.type)+" parameter: "+V(e.name));return}else{if(r==="param")return mge(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!Tt(i)?i.map(o=>BR(e,o,n)):BR(e,i,n)}function BR(e,t,n){const r=e.type;if(Tt(t))return UR(r)?z("Expression references can not be signals."):jb(r)?n.fieldRef(t):WR(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||jb(r);return i&&yge(t)?n.exprRef(t.expr,t.as):i&&vge(t)?Np(t.field,t.as):UR(r)?Co(t,n):xge(r)?ie(n.getData(t).values):jb(r)?Np(t):WR(r)?n.compareRef(t):t}}function gge(e,t,n){return K(t.from)||z('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function mge(e,t,n){const r=t[e.name];return e.array?(I(r)||z("Expected an array of sub-parameters. Instead: "+V(r)),r.map(i=>jR(e,i,n))):jR(e,r,n)}function jR(e,t,n){const r=e.params.length;let i;for(let s=0;s<r;++s){i=e.params[s];for(const a in i.key)if(i.key[a]!==t[a]){i=null;break}if(i)break}i||z("Unsupported parameter: "+V(t));const o=pe(aj(i,t,n),i.key);return ie(n.add(hpe(o)))}const yge=e=>e&&e.expr,vge=e=>e&&e.field,xge=e=>e==="data",UR=e=>e==="expr",jb=e=>e==="field",WR=e=>e==="compare";function bge(e,t,n){let r,i,o,s,a;return e?(r=e.facet)&&(t||z("Only group marks can be faceted."),r.field!=null?s=a=C0(r,n):(e.data?a=ie(n.getData(e.data).aggregate):(o=h3(pe({type:"aggregate",groupby:Q(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=C0(r,n),s=a=ie(n.add(o))),i=n.keyRef(r.groupby,!0))):s=ie(n.add(Gi(null,[{}]))),s||(s=C0(e,n)),{key:i,pulse:s,parent:a}}function C0(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ie(t.getData(e.data).output)}function yl(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}yl.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],s=null,a=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=ie(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(s=t[a]);return new yl(e,o,i,r,s)};function uj(e){return K(e)?e:null}function qR(e,t,n){const r=fx(n.op,n.field);let i;if(t.ops){for(let o=0,s=t.as.length;o<s;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function Ld(e,t,n,r,i,o,s){const a=t[n]||(t[n]={}),u=Whe(o);let l=uj(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=a[l]),!c){const d=o?{field:jS,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:ie(t.output)};u&&(d.sort=e.sortRef(o)),f=e.add(cx(r,void 0,d)),s&&(t.index[i]=f),c=ie(f),l!=null&&(a[l]=c)}return c}yl.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),o=uj(t);let s,a,u;return o!=null&&(e=r.scope,s=i[o]),s?n&&n.field&&qR(e,s.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ie(r.output)},n&&n.field&&qR(e,u,n),a=e.add(GB(u)),s=e.add(Gi({pulse:ie(a)})),s={agg:a,ref:ie(s)},o!=null&&(i[o]=s)),s.ref},tuplesRef(){return ie(this.values)},extentRef(e,t){return Ld(e,this,"extent","extent",t,!1)},domainRef(e,t){return Ld(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return Ld(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return Ld(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return Ld(e,this,"indata","tupleindex",t,!0,!0)}};function wge(e,t,n){const r=e.from.facet,i=r.name,o=C0(r,t);let s;r.name||z("Facet must have a name: "+V(r)),r.data||z("Facet must reference a data set: "+V(r)),r.field?s=t.add(XB({field:t.fieldRef(r.field),pulse:o})):r.groupby?s=t.add(ipe({key:t.keyRef(r.groupby),group:ie(t.proxy(n.parent)),pulse:o})):z("Facet must specify groupby or field: "+V(r));const a=t.fork(),u=a.add(Gi()),l=a.add(Il({pulse:ie(u)}));a.addData(i,new yl(a,u,u,l)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(e).toRuntime()}}function Ege(e,t,n){const r=t.add(XB({pulse:n.pulse})),i=t.fork();i.add(Il()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function lj(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,s=e.modify,a=e.values,u=t.add(my()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,o,s,a].map(f=>f??"null").join(",")+"),0)",c=Co(l,t);u.update=c.$expr,u.params=c.$params}function mx(e,t){const n=sj(e),r=e.type===hx,i=e.from&&e.from.facet,o=e.overlap;let s=e.layout||n===r3||n===n3,a,u,l,c,f,d,h;const p=n===t3||s||i,g=bge(e.from,r,t);u=t.add(npe({key:g.key||(e.key?Np(e.key):void 0),pulse:g.pulse,clean:!r}));const m=ie(u);u=l=t.add(Gi({pulse:m})),u=t.add(lpe({markdef:dge(e),interactive:hge(e.interactive,t),clip:fge(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ie(u)}));const y=ie(u);u=c=t.add(YB(qB(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(S=>{const E=h3(S,t),_=E.metadata;(_.generates||_.changes)&&z("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),E.params.pulse=ie(u),t.add(u=E)}),e.sort&&(u=t.add(vpe({sort:t.compareRef(e.sort),pulse:ie(u)})));const v=ie(u);(i||s)&&(s=t.add(KB({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),d=ie(s));const x=t.add(VB({mark:y,pulse:d||v}));h=ie(x),r&&(p&&(a=t.operators,a.pop(),s&&a.pop()),t.pushState(v,d||h,m),i?wge(e,t,g):p?Ege(e,t,g):t.parse(e),t.popState(),p&&(s&&a.push(s),a.push(x))),o&&(h=Sge(o,h,t));const b=t.add(QB({pulse:h})),w=t.add(Il({pulse:ie(b)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new yl(t,l,b,w)),e.on&&e.on.forEach(S=>{(S.insert||S.remove||S.toggle)&&z("Marks only support modify triggers."),lj(S,t,f)}))}function Sge(e,t,n){const r=e.method,i=e.bound,o=e.separation,s={separation:Tt(o)?n.signalRef(o.signal):o,method:Tt(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(s.sort=n.compareRef({field:e.order})),i){const a=i.tolerance;s.boundTolerance=Tt(a)?n.signalRef(a.signal):+a,s.boundScale=n.scaleRef(i.scale),s.boundOrient=i.orient}return ie(n.add(dpe(s)))}function _ge(e,t){const n=t.config.legend,r=e.encode||{},i=mr(e,n),o=r.legend||{},s=o.name||void 0,a=o.interactive,u=o.style,l={};let c=0,f,d,h;u3.forEach(x=>e[x]?(l[x]=e[x],c=c||e[x]):0),c||z("Missing valid scale for legend.");const p=kge(e,t.scaleType(c)),g={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&i.isVertical()},m=ie(t.add(Gi(null,[g]))),y={enter:{x:{value:0},y:{value:0}}},v=ie(t.add(ape(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===$0?(h=[Kpe(e,c,n,r.gradient),zR(e,n,r.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${Qu(i.gradientLength())})/100))`)):p===HS?h=[Jpe(e,c,n,r.gradient,v),zR(e,n,r.labels,v)]:(f=nge(e,n),h=[tge(e,n,r,v,Qu(f.columns))],d.size=Age(e,t,h[0].marks)),h=[Rp({role:She,from:m,encode:y,marks:h,layout:f,interactive:a})],g.title&&h.push(cge(e,n,r.title,m)),mx(Rp({role:whe,from:m,encode:td(Cge(i,e,n),o,Ag),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:a,style:u}),t)}function kge(e,t){let n=e.type||LR;return!e.type&&$ge(e)===1&&(e.fill||e.stroke)&&(n=lC(t)?$0:PE(t)?HS:LR),n!==$0?n:PE(t)?HS:$0}function $ge(e){return u3.reduce((t,n)=>t+(e[n]?1:0),0)}function Cge(e,t,n){const r={enter:{},update:{}};return nn(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function Age(e,t,n){const r=Qu(HR("size",e,n)),i=Qu(HR("strokeWidth",e,n)),o=Qu(Tge(n[1].encode,t,Cg));return Co(`max(ceil(sqrt(${r})+${i}),${o})`,t)}function HR(e,t,n){return t[e]?`scale("${t[e]}",datum)`:ij(e,n[0].encode)}function Tge(e,t,n){return ij("fontSize",e)||Xpe("fontSize",t,n)}const Fge=`item.orient==="${nd}"?-90:item.orient==="${rd}"?90:0`;function Mge(e,t){e=K(e)?{text:e}:e;const n=mr(e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,s=i.interactive,a=i.style,u=[],l={},c=ie(t.add(Gi(null,[l])));return u.push(Rge(e,n,Nge(e),c)),e.subtitle&&u.push(Dge(e,n,r.subtitle,c)),mx(Rp({role:Che,from:c,encode:Oge(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),t)}function Nge(e){const t=e.encode;return t&&t.title||pe({name:e.name,interactive:e.interactive,style:e.style},t)}function Oge(e,t){const n={enter:{},update:{}};return nn(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:c3},angle:{signal:Fge},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),td(n,t,Ag)}function Rge(e,t,n,r){const i={value:0},o=e.text,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return nn(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Dr({type:Bl,role:Ahe,style:Bpe,from:r,encode:s},n)}function Dge(e,t,n,r){const i={value:0},o=e.subtitle,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return nn(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Dr({type:Bl,role:The,style:jpe,from:r,encode:s},n)}function Pge(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(h3(r,t))}),e.on&&e.on.forEach(r=>{lj(r,t,e.name)}),t.addDataPipeline(e.name,Lge(e,t,n))}function Lge(e,t,n){const r=[];let i=null,o=!1,s=!1,a,u,l,c,f;for(e.values?Tt(e.values)||_0(e.format)?(r.push(GR(t,e)),r.push(i=gu())):r.push(i=gu({$ingest:e.values,$format:e.format})):e.url?_0(e.url)||_0(e.format)?(r.push(GR(t,e)),r.push(i=gu())):r.push(i=gu({$request:e.url,$format:e.format})):e.source&&(i=a=Q(e.source).map(d=>ie(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=gu()),r.push(c),f.generates&&(s=!0),f.modifies&&!s&&(o=!0),f.source?i=c:f.changes&&(i=null);return a&&(l=a.length-1,r[0]=mpe({derive:o,pulse:l?a:a[0]}),(o||l)&&r.splice(1,0,gu())),i||r.push(gu()),r.push(Il({})),r}function gu(e){const t=Gi({},e);return t.metadata={source:!0},t}function GR(e,t){return upe({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const cj=e=>e===Ia||e===Vi,yx=(e,t,n)=>Tt(e)?jge(e.signal,t,n):e===nd||e===Vi?t:n,Bt=(e,t,n)=>Tt(e)?Ige(e.signal,t,n):cj(e)?t:n,Li=(e,t,n)=>Tt(e)?Bge(e.signal,t,n):cj(e)?n:t,fj=(e,t,n)=>Tt(e)?Uge(e.signal,t,n):e===Vi?{value:t}:{value:n},zge=(e,t,n)=>Tt(e)?Wge(e.signal,t,n):e===rd?{value:t}:{value:n},Ige=(e,t,n)=>dj(`${e} === '${Vi}' || ${e} === '${Ia}'`,t,n),Bge=(e,t,n)=>dj(`${e} !== '${Vi}' && ${e} !== '${Ia}'`,t,n),jge=(e,t,n)=>p3(`${e} === '${nd}' || ${e} === '${Vi}'`,t,n),Uge=(e,t,n)=>p3(`${e} === '${Vi}'`,t,n),Wge=(e,t,n)=>p3(`${e} === '${rd}'`,t,n),dj=(e,t,n)=>(t=t!=null?It(t):t,n=n!=null?It(n):n,VR(t)&&VR(n)?(t=t?t.signal||V(t.value):null,n=n?n.signal||V(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[pe({test:e},t)].concat(n||[])),VR=e=>e==null||Object.keys(e).length===1,p3=(e,t,n)=>({signal:`${e} ? (${Fc(t)}) : (${Fc(n)})`}),qge=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${nd}' ? (${Fc(r)}) : `:"")+(n!=null?`${e} === '${Ia}' ? (${Fc(n)}) : `:"")+(i!=null?`${e} === '${rd}' ? (${Fc(i)}) : `:"")+(t!=null?`${e} === '${Vi}' ? (${Fc(t)}) : `:"")+"(null)"}),Fc=e=>Tt(e)?e.signal:e==null?null:V(e),Hge=(e,t)=>t===0?0:Tt(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},jc=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function ic(e,t,n,r){let i;if(t&&ae(t,e))return t[e];if(ae(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[a3][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[Cg][i]}return null}function YR(e){const t={};for(const n of e)if(n)for(const r in n)t[r]=1;return Object.keys(t)}function Gge(e,t){var n=t.config,r=n.style,i=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,s=e.orient,a,u,l;if(Tt(s)){const f=YR([n.axisX,n.axisY]),d=YR([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(l of f)a[l]=Bt(s,ic(l,n.axisX,i,r),ic(l,n.axisY,i,r));u={};for(l of d)u[l]=qge(s.signal,ic(l,n.axisTop,i,r),ic(l,n.axisBottom,i,r),ic(l,n.axisLeft,i,r),ic(l,n.axisRight,i,r))}else a=s===Vi||s===Ia?n.axisX:n.axisY,u=n["axis"+s[0].toUpperCase()+s.slice(1)];return a||u||o?pe({},i,a,u,o):i}function Vge(e,t,n,r){const i=mr(e,t),o=e.orient;let s,a;const u={enter:s={opacity:Ce},update:a={opacity:ei},exit:{opacity:Ce}};nn(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=XR(e,0),c=XR(e,1);return s.x=a.x=Bt(o,l,Ce),s.x2=a.x2=Bt(o,c),s.y=a.y=Li(o,l,Ce),s.y2=a.y2=Li(o,c),Dr({type:l3,role:mhe,from:r,encode:u},n)}function XR(e,t){return{scale:e.scale,range:t}}function Yge(e,t,n,r,i){const o=mr(e,t),s=e.orient,a=e.gridScale,u=yx(s,1,-1),l=Xge(e.offset,u);let c,f,d;const h={enter:c={opacity:Ce},update:d={opacity:ei},exit:f={opacity:Ce}};nn(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:e.scale,field:Zr,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},g=Bt(s,{signal:"height"},{signal:"width"}),m=a?{scale:a,range:0,mult:u,offset:l}:{value:0,offset:l},y=a?{scale:a,range:1,mult:u,offset:l}:pe(g,{mult:u,offset:l});return c.x=d.x=Bt(s,p,m),c.y=d.y=Li(s,p,m),c.x2=d.x2=Li(s,y),c.y2=d.y2=Bt(s,y),f.x=Bt(s,p),f.y=Li(s,p),Dr({type:l3,role:yhe,key:Zr,from:r,encode:h},n)}function Xge(e,t){if(t!==1)if(!J(e))e=Tt(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=pe({},e);for(;n.mult!=null;)if(J(n.mult))n=n.mult=pe({},n.mult);else return n.mult=Tt(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function Qge(e,t,n,r,i,o){const s=mr(e,t),a=e.orient,u=yx(a,-1,1);let l,c,f;const d={enter:l={opacity:Ce},update:f={opacity:ei},exit:c={opacity:Ce}};nn(d,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const h=It(i);h.mult=u;const p={scale:e.scale,field:Zr,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return f.y=l.y=Bt(a,Ce,p),f.y2=l.y2=Bt(a,h),c.x=Bt(a,p),f.x=l.x=Li(a,Ce,p),f.x2=l.x2=Li(a,h),c.y=Li(a,p),Dr({type:l3,role:xhe,key:Zr,from:r,encode:d},n)}function Ub(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function Kge(e,t,n,r,i,o){const s=mr(e,t),a=e.orient,u=e.scale,l=yx(a,-1,1),c=Qu(s("labelFlush")),f=Qu(s("labelFlushOffset")),d=s("labelAlign"),h=s("labelBaseline");let p=c===0||!!c,g;const m=It(i);m.mult=l,m.offset=It(s("labelPadding")||0),m.offset.mult=l;const y={scale:u,field:Zr,band:.5,offset:oj(o.offset,s("labelOffset"))},v=Bt(a,p?Ub(u,c,'"left"','"right"','"center"'):{value:"center"},zge(a,"left","right")),x=Bt(a,fj(a,"bottom","top"),p?Ub(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),b=Ub(u,c,`-(${f})`,f,0);p=p&&f;const w={opacity:Ce,x:Bt(a,y,m),y:Li(a,y,m)},S={enter:w,update:g={opacity:ei,text:{field:s3},x:w.x,y:w.y,align:v,baseline:x},exit:{opacity:Ce,x:w.x,y:w.y}};nn(S,{dx:!d&&p?Bt(a,b):null,dy:!h&&p?Li(a,b):null}),nn(S,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:d,baseline:h});const E=s("labelBound");let _=s("labelOverlap");return _=_||E?{separation:s("labelSeparation"),method:_,order:"datum.index",bound:E?{scale:u,orient:a,tolerance:E}:null}:void 0,g.align!==v&&(g.align=jc(g.align,v)),g.baseline!==x&&(g.baseline=jc(g.baseline,x)),Dr({type:Bl,role:vhe,style:Cg,key:Zr,from:r,encode:S,overlap:_},n)}function Jge(e,t,n,r){const i=mr(e,t),o=e.orient,s=yx(o,-1,1);let a,u;const l={enter:a={opacity:Ce,anchor:It(i("titleAnchor",null)),align:{signal:c3}},update:u=pe({},a,{opacity:ei,text:It(e.title)}),exit:{opacity:Ce}},c={signal:`lerp(range("${e.scale}"), ${px(0,1,.5)})`};return u.x=Bt(o,c),u.y=Li(o,c),a.angle=Bt(o,Ce,Hge(s,90)),a.baseline=Bt(o,fj(o,Ia,Vi),{value:Ia}),u.angle=a.angle,u.baseline=a.baseline,nn(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),Zge(i,o,l,n),l.update.align=jc(l.update.align,a.align),l.update.angle=jc(l.update.angle,a.angle),l.update.baseline=jc(l.update.baseline,a.baseline),Dr({type:Bl,role:bhe,style:a3,from:r,encode:l},n)}function Zge(e,t,n,r){const i=(a,u)=>a!=null?(n.update[u]=jc(It(a),n.update[u]),!1):!fc(u,r),o=i(e("titleX"),"x"),s=i(e("titleY"),"y");n.enter.auto=s===o?It(s):Bt(t,It(s),It(o))}function eme(e,t){const n=Gge(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,s=i.interactive,a=i.style,u=mr(e,n),l=Qpe(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ie(t.add(Gi({},[c]))),d=ie(t.add(tpe({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(Yge(e,n,r.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(Qge(e,n,r.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(Kge(e,n,r.labels,d,p,l))),c.domain&&h.push(Vge(e,n,r.domain,f)),c.title&&h.push(Jge(e,n,r.title,f)),mx(Rp({role:ghe,from:f,encode:td(tme(u,e),i,Ag),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:s,style:a}),t)}function tme(e,t){const n={enter:{},update:{}};return nn(n,{orient:e("orient"),offset:e("offset")||0,position:_i(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function hj(e,t,n){const r=Q(e.signals),i=Q(e.scales);return n||r.forEach(o=>HB(o,t)),Q(e.projections).forEach(o=>Ope(o,t)),i.forEach(o=>wpe(o,t)),Q(e.data).forEach(o=>Pge(o,t)),i.forEach(o=>Epe(o,t)),(n||r).forEach(o=>epe(o,t)),Q(e.axes).forEach(o=>eme(o,t)),Q(e.marks).forEach(o=>mx(o,t)),Q(e.legends).forEach(o=>_ge(o,t)),e.title&&Mge(e.title,t),t.parseLambdas(),t}const nme=e=>td({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function rme(e,t){const n=t.config,r=ie(t.root=t.add(my())),i=ime(e,n);i.forEach(l=>HB(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(Gi()),s=t.add(YB(qB(nme(e.encode),hx,n3,e.style,t,{pulse:ie(o)}))),a=t.add(KB({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:ie(s)}));t.operators.pop(),t.pushState(ie(s),ie(a),null),hj(e,t,i),t.operators.push(a);let u=t.add(VB({mark:r,pulse:ie(a)}));return u=t.add(QB({pulse:ie(u)})),u=t.add(Il({pulse:ie(u)})),t.addData("root",new yl(t,o,o,u)),t}function zd(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function ime(e,t){const n=s=>_i(e[s],t[s]),r=[zd("background",n("background")),zd("autosize",dhe(n("autosize"))),zd("padding",phe(n("padding"))),zd("width",n("width")||0),zd("height",n("height")||0)],i=r.reduce((s,a)=>(s[a.name]=a,s),{}),o={};return Q(e.signals).forEach(s=>{ae(i,s.name)?s=pe(i[s.name],s):r.push(s),o[s.name]=s}),Q(t.signals).forEach(s=>{!ae(o,s.name)&&!ae(i,s.name)&&r.push(s)}),r}function pj(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function QR(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}pj.prototype=QR.prototype={parse(e){return hj(e,this)},fork(){return new QR(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof BS?ie(e):e;return this.add(gpe({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,o){let s,a;r&&(s=r.data||(r.data={}),a=s[i]||(s[i]=[]),a.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(ie(this.add(Il({pulse:e})))),this._parent.push(t),this._lookup.push(n?ie(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return $e(this._parent)},encode(){return $e(this._encode)},lookup(){return $e(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(K(e))return Np(e,t);e.signal||z("Unsupported field reference: "+V(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=ie(this.add(ope(i)))}return r},compareRef(e){let t=!1;const n=o=>Tt(o)?(t=!0,this.signalRef(o.signal)):qhe(o)?(t=!0,this.exprRef(o.expr)):o,r=Q(e.field).map(n),i=Q(e.order).map(n);return t?ie(this.add(PR({fields:r,orders:i}))):RR(r,i)},keyRef(e,t){let n=!1;const r=o=>Tt(o)?(n=!0,ie(i[o.signal])):o,i=this.signals;return e=Q(e).map(r),n?ie(this.add(spe({fields:e,flat:t}))):Bhe(e,t)},sortRef(e){if(!e)return e;const t=fx(e.op,e.field),n=e.order||jhe;return n.signal?ie(this.add(PR({fields:t,orders:this.signalRef(n.signal)}))):RR(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return ae(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&z("Duplicate signal name: "+V(e));const n=t instanceof BS?t:this.add(my(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||z("Unrecognized signal name: "+V(e)),this.signals[e]},signalRef(e){return this.signals[e]?ie(this.signals[e]):(ae(this.lambdas,e)||(this.lambdas[e]=this.add(my(null))),ie(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=Co(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!J(e)?e:this.signalRef(e.signal||g3(e))},exprRef(e,t){const n={expr:Co(e,this)};return t&&(n.expr.$name=t),ie(this.add(rpe(n)))},addBinding(e,t){this.bindings||z("Nested signals do not support binding: "+V(e)),this.bindings.push(pe({signal:e},t))},addScaleProj(e,t){ae(this.scales,e)&&z("Duplicate scale or projection name: "+V(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,ype(t))},addProjection(e,t){this.addScaleProj(e,ppe(t))},getScale(e){return this.scales[e]||z("Unrecognized scale name: "+V(e)),this.scales[e]},scaleRef(e){return ie(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ae(this.data,e)&&z("Duplicate data set name: "+V(e)),this.data[e]=t},getData(e){return this.data[e]||z("Undefined data set name: "+V(e)),this.data[e]},addDataPipeline(e,t){return ae(this.data,e)&&z("Duplicate data set name: "+V(e)),this.addData(e,yl.fromEntries(this,t))}};function g3(e){return(I(e)?ome:sme)(e)}function ome(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(J(i)?i.signal||g3(i):V(i))}return n+"]"}function sme(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+V(r)+":"+(J(i)?i.signal||g3(i):V(i));return t+"}"}function ame(){const e="sans-serif",r="#4c78a8",i="#000",o="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:s},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function ume(e,t,n){return J(e)||z("Input Vega specification must be an object."),t=Uf(ame(),t,e.config),rme(e,new pj(t,n)).toRuntime()}var lme="5.28.0";pe(uf,pJ,Dre,hie,Joe,Gse,xue,Jae,wue,Hue,tle,ule);const cme=Object.freeze(Object.defineProperty({__proto__:null,Bounds:Et,CanvasHandler:La,CanvasRenderer:Ep,DATE:cr,DAY:gn,DAYOFYEAR:ko,Dataflow:Lc,Debug:d6,Error:Sk,EventStream:yv,Gradient:sI,GroupItem:Bv,HOURS:Nr,Handler:Pa,HybridHandler:WC,HybridRenderer:N1,Info:f6,Item:Iv,MILLISECONDS:ji,MINUTES:Or,MONTH:bn,Marks:Rr,MultiPulse:Yk,None:c6,Operator:He,Parameters:mv,Pulse:Ea,QUARTER:lr,RenderType:oa,Renderer:Ir,ResourceLoader:vC,SECONDS:oi,SVGHandler:PC,SVGRenderer:Yv,SVGStringRenderer:UC,Scenegraph:RC,TIME_UNITS:zk,Transform:D,View:NB,WEEK:Ct,Warn:_k,YEAR:Zt,accessor:gr,accessorFields:xn,accessorName:gt,array:Q,ascending:ov,bandwidthNRD:Jk,bin:VL,bootstrapCI:YL,boundClip:r9,boundContext:gg,boundItem:UE,boundMark:kI,boundStroke:As,changeset:Dl,clampRange:S6,codegenExpression:oB,compare:Tk,constant:kn,cumulativeLogNormal:i$,cumulativeNormal:xv,cumulativeUniform:u$,dayofyear:eL,debounce:Fk,defaultLocale:Wk,definition:qL,densityLogNormal:r$,densityNormal:Zk,densityUniform:a$,domChild:kt,domClear:Hr,domCreate:ra,domFind:DC,dotbin:XL,error:z,expressionFunction:bt,extend:pe,extent:Eo,extentIndex:_6,falsy:Is,fastmap:qf,field:ri,flush:k6,font:Hv,fontFamily:vg,fontSize:Oo,format:o0,formatLocale:l1,formats:Gk,hasOwnProperty:ae,id:eg,identity:_n,inferType:OL,inferTypes:RL,ingest:Pe,inherits:G,inrange:kc,interpolate:cC,interpolateColors:Lv,interpolateRange:G8,intersect:ZI,intersectBoxLine:$c,intersectPath:xC,intersectPoint:bC,intersectRule:pI,isArray:I,isBoolean:Qa,isDate:ba,isFunction:ge,isIterable:$6,isNumber:Te,isObject:J,isRegExp:C6,isString:K,isTuple:pv,key:Mk,lerp:A6,lineHeight:Ra,loader:dv,locale:ML,logger:kk,lruCache:T6,markup:jC,merge:F6,mergeConfig:Uf,multiLineOffset:MC,one:jf,pad:M6,panLinear:y6,panLog:v6,panPow:x6,panSymlog:b6,parse:ume,parseExpression:UA,parseSelector:nu,path:_v,pathCurves:gC,pathEqual:i9,pathParse:pf,pathRectangle:lI,pathRender:vp,pathSymbols:uI,pathTrail:cI,peek:$e,point:Vv,projection:uA,quantileLogNormal:o$,quantileNormal:bv,quantileUniform:l$,quantiles:Qk,quantizeInterpolator:V8,quarter:w6,quartiles:Kk,get random(){return si},randomInteger:vK,randomKDE:t$,randomLCG:yK,randomLogNormal:KL,randomMixture:JL,randomNormal:e$,randomUniform:ZL,read:LL,regressionConstant:c$,regressionExp:tz,regressionLinear:f$,regressionLoess:iz,regressionLog:ez,regressionPoly:rz,regressionPow:nz,regressionQuad:d$,renderModule:Xv,repeat:Qd,resetDefaultLocale:pQ,resetSVGClipId:dI,resetSVGDefIds:Zne,responseType:PL,runtimeContext:xB,sampleCurve:Ev,sampleLogNormal:n$,sampleNormal:vv,sampleUniform:s$,scale:Ne,sceneEqual:qC,sceneFromJSON:CI,scenePickVisit:S1,sceneToJSON:$I,sceneVisit:Ui,sceneZOrder:wC,scheme:fC,serializeXML:qI,setHybridRendererOptions:Xne,setRandom:gK,span:tg,splitAccessPath:Mo,stringValue:V,textMetrics:Ar,timeBin:yL,timeFloor:aL,timeFormatLocale:dp,timeInterval:Yf,timeOffset:cL,timeSequence:hL,timeUnitSpecifier:Z6,timeUnits:Ik,toBoolean:Nk,toDate:Ok,toNumber:mn,toSet:Bi,toString:Rk,transform:HL,transforms:uf,truncate:N6,truthy:ii,tupleid:oe,typeParsers:_E,utcFloor:uL,utcInterval:Xf,utcOffset:fL,utcSequence:pL,utcdayofyear:rL,utcquarter:E6,utcweek:iL,version:lme,visitArray:qs,week:tL,writeConfig:Wf,zero:Ks,zoomLinear:$k,zoomLog:Ck,zoomPow:r1,zoomSymlog:Ak},Symbol.toStringTag,{value:"Module"}));function fme(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var dme={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},hme={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},pme={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const gme=Array.prototype.slice,mu=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,gme.call(t,1))},mme=(e,t,n,r,i,o,s)=>new Date(e,t||0,n??1,r||0,i||0,o||0,s||0);var yme={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:mme,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return mu("join",arguments)},indexof:function(){return mu("indexOf",arguments)},lastindexof:function(){return mu("lastIndexOf",arguments)},slice:function(){return mu("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return mu("substring",arguments,String)},split:function(){return mu("split",arguments,String)},replace:function(){return mu("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const vme=["view","item","group","xy","x","y"],VS=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&VS.add(setImmediate);const xme={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:dme[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const i=e(t.property);if(n&&(e.memberDepth-=1),VS.has(r[i])){console.error(`Prevented interpretation of member "${i}" which could lead to insecure code execution`);return}return r[i]},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),r==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||yme[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>hme[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>pme[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,r)=>{e.memberDepth+=1;const i=e(r.key);return e.memberDepth-=1,VS.has(e(r.value))?console.error(`Prevented interpretation of property "${i}" which could lead to insecure code execution`):n[i]=e(r.value),n},{})};function Id(e,t,n,r,i,o){const s=a=>xme[a.type](s,a);return s.memberDepth=0,s.fn=Object.create(t),s.params=n,s.datum=r,s.event=i,s.item=o,vme.forEach(a=>s.fn[a]=function(){return i.vega[a](...arguments)}),s(e)}var bme={operator(e,t){const n=t.ast,r=e.functions;return i=>Id(n,r,i)},parameter(e,t){const n=t.ast,r=e.functions;return(i,o)=>Id(n,r,o,i)},event(e,t){const n=t.ast,r=e.functions;return i=>Id(n,r,void 0,void 0,i)},handler(e,t){const n=t.ast,r=e.functions;return(i,o)=>{const s=o.item&&o.item.datum;return Id(n,r,i,s,o)}},encode(e,t){const{marktype:n,channels:r}=t,i=e.functions,o=n==="group"||n==="image"||n==="rect";return(s,a)=>{const u=s.datum;let l=0,c;for(const f in r)c=Id(r[f].ast,i,a,u,void 0,s),s[f]!==c&&(s[f]=c,l=1);return n!=="rule"&&fme(s,r,o),l}}};const wme="vega-lite",Eme='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',Sme="5.17.0",_me=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],kme="https://vega.github.io/vega-lite/",$me="Vega-Lite is a concise high-level language for interactive visualization.",Cme=["vega","chart","visualization"],Ame="build/vega-lite.js",Tme="build/vega-lite.min.js",Fme="build/vega-lite.min.js",Mme="build/src/index",Nme="build/src/index.d.ts",Ome={vl2pdf:"./bin/vl2pdf",vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},Rme=["bin","build","src","vega-lite*","tsconfig.json"],Dme={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.mjs","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",format:"eslint . --fix && yarn prettierbase --write",lint:"eslint . && yarn prettierbase --check",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/","watch:test:runtime":"TZ=America/Los_Angeles npx jest --watch test-runtime/ --config test-runtime/jest-config.json",release:"release-it"},Pme={type:"git",url:"https://github.com/vega/vega-lite.git"},Lme="BSD-3-Clause",zme={url:"https://github.com/vega/vega-lite/issues"},Ime={"@babel/core":"^7.23.9","@babel/preset-env":"^7.23.9","@babel/preset-typescript":"^7.23.3","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-alias":"^5.1.0","@rollup/plugin-babel":"^6.0.4","@rollup/plugin-commonjs":"^25.0.7","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@types/d3":"^7.4.3","@types/jest":"^29.5.11","@types/pako":"^2.0.3","@typescript-eslint/eslint-plugin":"^6.20.0","@typescript-eslint/parser":"^6.20.0",ajv:"^8.12.0","ajv-formats":"^2.1.1",cheerio:"^1.0.0-rc.12","conventional-changelog-cli":"^4.1.0",d3:"^7.8.5","del-cli":"^5.1.0",eslint:"^8.56.0","eslint-config-prettier":"^9.1.0","eslint-plugin-jest":"^27.6.3","eslint-plugin-prettier":"^5.1.3","fast-json-stable-stringify":"~2.1.0","highlight.js":"^11.9.0",jest:"^29.7.0","jest-dev-server":"^9.0.2",mkdirp:"^3.0.1",pako:"^2.1.0",prettier:"^3.2.4",puppeteer:"^15.0.0","release-it":"^17.0.3",rollup:"^4.9.6","rollup-plugin-bundle-size":"^1.0.3",serve:"^14.2.1",terser:"^5.27.0","ts-jest":"^29.1.2","ts-json-schema-generator":"^1.5.0",typescript:"~5.3.3","vega-cli":"^5.27.0","vega-datasets":"^2.8.0","vega-embed":"^6.24.0","vega-tooltip":"^0.34.0","yaml-front-matter":"^4.1.1"},Bme={"json-stringify-pretty-compact":"~3.0.0",tslib:"~2.6.2","vega-event-selector":"~3.0.1","vega-expression":"~5.1.0","vega-util":"~1.17.2",yargs:"~17.7.2"},jme={vega:"^5.24.0"},Ume={node:">=18"},Wme={name:wme,author:Eme,version:Sme,collaborators:_me,homepage:kme,description:$me,keywords:Cme,main:Ame,unpkg:Tme,jsdelivr:Fme,module:Mme,types:Nme,bin:Ome,files:Rme,scripts:Dme,repository:Pme,license:Lme,bugs:zme,devDependencies:Ime,dependencies:Bme,peerDependencies:jme,engines:Ume};function m3(e){return!!e.or}function y3(e){return!!e.and}function v3(e){return!!e.not}function A0(e,t){if(v3(e))A0(e.not,t);else if(y3(e))for(const n of e.and)A0(n,t);else if(m3(e))for(const n of e.or)A0(n,t);else t(e)}function Uc(e,t){return v3(e)?{not:Uc(e.not,t)}:y3(e)?{and:e.and.map(n=>Uc(n,t))}:m3(e)?{or:e.or.map(n=>Uc(n,t))}:t(e)}const fe=structuredClone;function gj(e){throw new Error(e)}function Sf(e,t){const n={};for(const r of t)ae(e,r)&&(n[r]=e[r]);return n}function ar(e,t){const n={...e};for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>We(e)).join(",")})`};function Ee(e){if(Te(e))return e;const t=K(e)?e:We(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function YS(e){return e===!1||e===null}function Se(e,t){return e.includes(t)}function vl(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function x3(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function mj(e,...t){for(const n of t)qme(e,n??{});return e}function qme(e,t){for(const n of B(t))Wf(e,n,t[n],!0)}function ho(e,t){const n=[],r={};let i;for(const o of e)i=t(o),!(i in r)&&(r[i]=1,n.push(o));return n}function Hme(e,t){const n=B(e),r=B(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}function yj(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function b3(e,t){for(const n of e)if(t.has(n))return!0;return!1}function XS(e){const t=new Set;for(const n of e){const i=Mo(n).map((s,a)=>a===0?s:`[${s}]`),o=i.map((s,a)=>i.slice(0,a+1).join(""));for(const s of o)t.add(s)}return t}function w3(e,t){return e===void 0||t===void 0?!0:b3(XS(e),XS(t))}function Ue(e){return B(e).length===0}const B=Object.keys,en=Object.values,Ba=Object.entries;function Dp(e){return e===!0||e===!1}function nt(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function Uh(e,t){return v3(e)?`!(${Uh(e.not,t)})`:y3(e)?`(${e.and.map(n=>Uh(n,t)).join(") && (")})`:m3(e)?`(${e.or.map(n=>Uh(n,t)).join(") || (")})`:t(e)}function yy(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&yy(e[n],t)&&delete e[n],Ue(e)}function Tg(e){return e.charAt(0).toUpperCase()+e.substr(1)}function E3(e,t="datum"){const n=Mo(e),r=[];for(let i=1;i<=n.length;i++){const o=`[${n.slice(0,i).map(V).join("][")}]`;r.push(`${t}${o}`)}return r.join(" && ")}function vj(e,t="datum"){return`${t}[${V(Mo(e).join("."))}]`}function Gme(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function ui(e){return`${Mo(e).map(Gme).join("\\.")}`}function xl(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function S3(e){return`${Mo(e).join(".")}`}function _f(e){return e?Mo(e).length:0}function vt(...e){for(const t of e)if(t!==void 0)return t}let xj=42;function bj(e){const t=++xj;return e?String(e)+t:t}function Vme(){xj=42}function wj(e){return Ej(e)?e:`__${e}`}function Ej(e){return e.startsWith("__")}function Pp(e){if(e!==void 0)return(e%360+360)%360}function vx(e){return Te(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const KR=Object.getPrototypeOf(structuredClone({}));function $r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor.name!==t.constructor.name)return!1;let n,r;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!$r(e[r],t[r]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(r of e.entries())if(!t.has(r[0]))return!1;for(r of e.entries())if(!$r(r[1],t.get(r[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(r of e.entries())if(!t.has(r[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==KR.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==KR.toString)return e.toString()===t.toString();const i=Object.keys(e);if(n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!$r(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function We(e){const t=[];return function n(r){if(r&&r.toJSON&&typeof r.toJSON=="function"&&(r=r.toJSON()),r===void 0)return;if(typeof r=="number")return isFinite(r)?""+r:"null";if(typeof r!="object")return JSON.stringify(r);let i,o;if(Array.isArray(r)){for(o="[",i=0;i<r.length;i++)i&&(o+=","),o+=n(r[i])||"null";return o+"]"}if(r===null)return"null";if(t.includes(r))throw new TypeError("Converting circular structure to JSON");const s=t.push(r)-1,a=Object.keys(r).sort();for(o="",i=0;i<a.length;i++){const u=a[i],l=n(r[u]);l&&(o&&(o+=","),o+=JSON.stringify(u)+":"+l)}return t.splice(s,1),`{${o}}`}(e)}const ps="row",gs="column",xx="facet",rt="x",Ht="y",Yi="x2",Lo="y2",ru="xOffset",id="yOffset",Xi="radius",Fs="radius2",fi="theta",Ms="theta2",Qi="latitude",Ki="longitude",Ji="latitude2",li="longitude2",dr="color",zo="fill",Io="stroke",hr="shape",Ns="size",jl="angle",Os="opacity",iu="fillOpacity",ou="strokeOpacity",su="strokeWidth",au="strokeDash",Fg="text",kf="order",Mg="detail",bx="key",bl="tooltip",wx="href",Ex="url",Sx="description",Yme={x:1,y:1,x2:1,y2:1},Sj={theta:1,theta2:1,radius:1,radius2:1};function _j(e){return e in Sj}const _3={longitude:1,longitude2:1,latitude:1,latitude2:1};function kj(e){switch(e){case Qi:return"y";case Ji:return"y2";case Ki:return"x";case li:return"x2"}}function $j(e){return e in _3}const Xme=B(_3),k3={...Yme,...Sj,..._3,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function Wc(e){return e===dr||e===zo||e===Io}const Cj={row:1,column:1,facet:1},Kr=B(Cj),$3={...k3,...Cj},Qme=B($3),{order:Ske,detail:_ke,tooltip:kke,...Kme}=$3,{row:$ke,column:Cke,facet:Ake,...Jme}=Kme;function Zme(e){return!!Jme[e]}function Aj(e){return!!$3[e]}const e0e=[Yi,Lo,Ji,li,Ms,Fs];function Tj(e){return Ul(e)!==e}function Ul(e){switch(e){case Yi:return rt;case Lo:return Ht;case Ji:return Qi;case li:return Ki;case Ms:return fi;case Fs:return Xi}return e}function ja(e){if(_j(e))switch(e){case fi:return"startAngle";case Ms:return"endAngle";case Xi:return"outerRadius";case Fs:return"innerRadius"}return e}function Bo(e){switch(e){case rt:return Yi;case Ht:return Lo;case Qi:return Ji;case Ki:return li;case fi:return Ms;case Xi:return Fs}}function pr(e){switch(e){case rt:case Yi:return"width";case Ht:case Lo:return"height"}}function Fj(e){switch(e){case rt:return"xOffset";case Ht:return"yOffset";case Yi:return"x2Offset";case Lo:return"y2Offset";case fi:return"thetaOffset";case Xi:return"radiusOffset";case Ms:return"theta2Offset";case Fs:return"radius2Offset"}}function C3(e){switch(e){case rt:return"xOffset";case Ht:return"yOffset"}}function t0e(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const n0e=B(k3),{x:Tke,y:Fke,x2:Mke,y2:Nke,xOffset:Oke,yOffset:Rke,latitude:Dke,longitude:Pke,latitude2:Lke,longitude2:zke,theta:Ike,theta2:Bke,radius:jke,radius2:Uke,...A3}=k3,r0e=B(A3),T3={x:1,y:1},jo=B(T3);function xt(e){return e in T3}const F3={theta:1,radius:1},i0e=B(F3);function _x(e){return e==="width"?rt:Ht}const Mj={xOffset:1,yOffset:1};function Ng(e){return e in Mj}const{text:Wke,tooltip:qke,href:Hke,url:Gke,description:Vke,detail:Yke,key:Xke,order:Qke,...Nj}=A3,o0e=B(Nj);function s0e(e){return!!A3[e]}function a0e(e){switch(e){case dr:case zo:case Io:case Ns:case hr:case Os:case su:case au:return!0;case iu:case ou:case jl:return!1}}const Oj={...T3,...F3,...Mj,...Nj},kx=B(Oj);function Rs(e){return!!Oj[e]}function u0e(e,t){return c0e(e)[t]}const Rj={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:Kke,...l0e}=Rj;function c0e(e){switch(e){case dr:case zo:case Io:case Sx:case Mg:case bx:case bl:case wx:case kf:case Os:case iu:case ou:case su:case xx:case ps:case gs:return Rj;case rt:case Ht:case ru:case id:case Qi:case Ki:return l0e;case Yi:case Lo:case Ji:case li:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Ns:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case au:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case hr:return{point:"always",geoshape:"always"};case Fg:return{text:"always"};case jl:return{point:"always",square:"always",text:"always"};case Ex:return{image:"always"};case fi:return{text:"always",arc:"always"};case Xi:return{text:"always",arc:"always"};case Ms:case Fs:return{arc:"always"}}}function Wb(e){switch(e){case rt:case Ht:case fi:case Xi:case ru:case id:case Ns:case jl:case su:case Os:case iu:case ou:case Yi:case Lo:case Ms:case Fs:return;case xx:case ps:case gs:case hr:case au:case Fg:case bl:case wx:case Ex:case Sx:return"discrete";case dr:case zo:case Io:return"flexible";case Qi:case Ki:case Ji:case li:case Mg:case bx:case kf:return}}const f0e={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},d0e={count:1,min:1,max:1};function ks(e){return!!e&&!!e.argmin}function uu(e){return!!e&&!!e.argmax}function M3(e){return K(e)&&!!f0e[e]}const h0e=new Set(["count","valid","missing","distinct"]);function Dj(e){return K(e)&&h0e.has(e)}function p0e(e){return K(e)&&Se(["min","max"],e)}const g0e=new Set(["count","sum","distinct","valid","missing"]),m0e=new Set(["mean","average","median","q1","q3","min","max"]);function Pj(e){return Qa(e)&&(e=Lx(e,void 0)),"bin"+B(e).map(t=>$x(e[t])?nt(`_${t}_${Ba(e[t])}`):nt(`_${t}_${e[t]}`)).join("")}function Ye(e){return e===!0||Wl(e)&&!e.binned}function Xt(e){return e==="binned"||Wl(e)&&e.binned===!0}function Wl(e){return J(e)}function $x(e){return e==null?void 0:e.param}function JR(e){switch(e){case ps:case gs:case Ns:case dr:case zo:case Io:case su:case Os:case iu:case ou:case hr:return 6;case au:return 4;default:return 10}}function Og(e){return!!(e!=null&&e.expr)}function er(e){const t=B(e||{}),n={};for(const r of t)n[r]=Er(e[r]);return n}function Lj(e){const{anchor:t,frame:n,offset:r,orient:i,angle:o,limit:s,color:a,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p,...g}=e,m={...g,...a?{fill:a}:{}},y={...t?{anchor:t}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...o!==void 0?{angle:o}:{},...s!==void 0?{limit:s}:{}},v={...u?{subtitleColor:u}:{},...l?{subtitleFont:l}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...h?{subtitleLineHeight:h}:{},...p?{subtitlePadding:p}:{}},x=Sf(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:x,nonMarkTitleProperties:y,subtitle:v}}function Ys(e){return K(e)||I(e)&&K(e[0])}function ne(e){return!!(e!=null&&e.signal)}function lu(e){return!!e.step}function y0e(e){return I(e)?!1:"fields"in e&&!("data"in e)}function v0e(e){return I(e)?!1:"fields"in e&&"data"in e}function ls(e){return I(e)?!1:"field"in e&&"data"in e}const x0e={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},b0e=B(x0e),w0e={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},QS=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function zj(e){const t=I(e.condition)?e.condition.map(ZR):ZR(e.condition);return{...Er(e),condition:t}}function Er(e){if(Og(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function ZR(e){if(Og(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function Je(e){if(Og(e)){const{expr:t,...n}=e;return{signal:t,...n}}return ne(e)?e:e!==void 0?{value:e}:void 0}function E0e(e){return ne(e)?e.signal:V(e)}function eD(e){return ne(e)?e.signal:V(e.value)}function Ni(e){return ne(e)?e.signal:e==null?null:V(e)}function S0e(e,t,n){for(const r of n){const i=$s(r,t.markDef,t.config);i!==void 0&&(e[r]=Je(i))}return e}function Ij(e){return[].concat(e.type,e.style??[])}function De(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:o&&(!i||i===e)?void 0:$s(e,t,n,r)}function $s(e,t,n,{vgChannel:r}={}){return vt(r?vy(e,t,n.style):void 0,vy(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function vy(e,t,n){return Bj(e,Ij(t),n)}function Bj(e,t,n){t=Q(t);let r;for(const i of t){const o=n[i];o&&o[e]!==void 0&&(r=o[e])}return r}function jj(e,t){return Q(e).reduce((n,r)=>(n.field.push(Y(r,t)),n.order.push(r.sort??"ascending"),n),{field:[],order:[]})}function Uj(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if($r(i,r))return;n.push(r)}),n}function Wj(e,t){return $r(e,t)||!t?e:e?[...Q(e),...Q(t)].join(", "):t}function qj(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((Ys(n)||ne(n))&&(Ys(r)||ne(r)))return{explicit:e.explicit,value:Wj(n,r)};if(Ys(n)||ne(n))return{explicit:e.explicit,value:n};if(Ys(r)||ne(r))return{explicit:e.explicit,value:r};if(!Ys(n)&&!ne(n)&&!Ys(r)&&!ne(r))return{explicit:e.explicit,value:Uj(n,r)};throw new Error("It should never reach here")}function N3(e){return`Invalid specification ${We(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const _0e='Autosize "fit" only works for single views and layered views.';function tD(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function nD(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function rD(e){return e?`Dropping "fit-${e}" because spec has discrete ${pr(e)}.`:'Dropping "fit" because spec has discrete size.'}function O3(e){return`Unknown field for ${e}. Cannot calculate view size.`}function iD(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function k0e(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function $0e(e){return`The "nearest" transform is not supported for ${e} marks.`}function Hj(e){return`Selection not supported for ${e} yet.`}function C0e(e){return`Cannot find a selection named "${e}".`}const A0e="Scale bindings are currently only supported for scales with unbinned, continuous domains.",T0e="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",F0e="Legend bindings are only supported for selections over an individual field or encoding channel.";function M0e(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function N0e(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const O0e="The same selection must be used to override scale domains in a layered view.",R0e='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function D0e(e){return`Unknown repeated value "${e}".`}function oD(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const P0e="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function L0e(e){return`Unrecognized parse "${e}".`}function sD(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const z0e="Attempt to add the same child twice.";function I0e(e){return`Ignoring an invalid transform: ${We(e)}.`}const B0e='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function aD(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function j0e(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${We(t)} is overridden by a child projection ${We(n)}.`}const U0e="Arc marks uses theta channel rather than angle, replacing angle with theta.";function W0e(e){return`${e}Offset dropped because ${e} is continuous`}function q0e(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${We(n)}}.`}function Gj(e){return`Invalid field type "${e}".`}function H0e(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function G0e(e){return`Invalid aggregation operator "${e}".`}function Vj(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function V0e(e){return`Position range does not support relative band size for ${e}.`}function KS(e,t){return`Dropping ${We(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Y0e="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function Cx(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function X0e(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function Q0e(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function K0e(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function J0e(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function qb(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Z0e(e){return`The ${e} for range marks cannot be an expression`}function e1e(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function t1e(e,t){return`Specified orient "${e}" overridden with "${t}".`}function n1e(e){return`Cannot use the scale property "${e}" with non-color channel.`}function r1e(e){return`Cannot use the relative band size with ${e} scale.`}function i1e(e){return`Using unaggregated domain with raw field has no effect (${We(e)}).`}function o1e(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function s1e(e){return`Unaggregated domain is currently unsupported for log scale (${We(e)}).`}function a1e(e){return`Cannot apply size to non-oriented mark "${e}".`}function u1e(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function l1e(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function Yj(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function Xj(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function c1e(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${We(n)} and ${We(r)}). Using ${We(n)}.`}function f1e(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${We(n)} and ${We(r)}). Using the union of the two domains.`}function d1e(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function h1e(e){return`Dropping sort property ${We(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const uD="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",p1e="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",g1e="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",m1e="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function y1e(e){return`Cannot stack "${e}" if there is already "${e}2".`}function v1e(e){return`Cannot stack non-linear scale (${e}).`}function x1e(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function xy(e,t){return`Invalid ${e}: ${We(t)}.`}function b1e(e){return`Dropping day from datetime ${We(e)} as day cannot be combined with other units.`}function w1e(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function E1e(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function S1e(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function lD(e){return`1D error band does not support ${e}.`}function Qj(e){return`Channel ${e} is required for "binned" bin.`}function _1e(e){return`Channel ${e} should not be used with "binned" bin.`}function k1e(e){return`Domain for ${e} is required for threshold scale.`}const Kj=kk(_k);let $f=Kj;function $1e(e){return $f=e,$f}function C1e(){return $f=Kj,$f}function U(...e){$f.warn(...e)}function A1e(...e){$f.debug(...e)}function ql(e){if(e&&J(e)){for(const t of D3)if(t in e)return!0}return!1}const Jj=["january","february","march","april","may","june","july","august","september","october","november","december"],T1e=Jj.map(e=>e.substr(0,3)),Zj=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],F1e=Zj.map(e=>e.substr(0,3));function M1e(e){if(vx(e)&&(e=+e),Te(e))return e>4&&U(xy("quarter",e)),e-1;throw new Error(xy("quarter",e))}function N1e(e){if(vx(e)&&(e=+e),Te(e))return e-1;{const t=e.toLowerCase(),n=Jj.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=T1e.indexOf(r);if(i!==-1)return i;throw new Error(xy("month",e))}}function O1e(e){if(vx(e)&&(e=+e),Te(e))return e%7;{const t=e.toLowerCase(),n=Zj.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=F1e.indexOf(r);if(i!==-1)return i;throw new Error(xy("day",e))}}function R3(e,t){const n=[];if(t&&e.day!==void 0&&B(e).length>1&&(U(b1e(e)),e=fe(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?N1e(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?M1e(e.quarter):e.quarter;n.push(Te(r)?r*3:`${r}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?O1e(e.day):e.day;n.push(Te(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i>"u"?0:i)}return n}function wl(e){const n=R3(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function R1e(e){const n=R3(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function D1e(e){const t=R3(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const eU={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},D3=B(eU);function P1e(e){return!!eU[e]}function Hl(e){return J(e)?e.binned:tU(e)}function tU(e){return e&&e.startsWith("binned")}function P3(e){return e.startsWith("utc")}function L1e(e){return e.substring(3)}const z1e={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Ax(e){return D3.filter(t=>rU(e,t))}function nU(e){const t=Ax(e);return t[t.length-1]}function rU(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function I1e(e,t,{end:n}={end:!1}){const r=E3(t),i=P3(e)?"utc":"";function o(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let s;const a={};for(const u of D3)rU(e,u)&&(a[u]=o(u),s=u);return n&&(a[s]+="+1"),R1e(a)}function iU(e){if(!e)return;const t=Ax(e);return`timeUnitSpecifier(${We(t)}, ${We(z1e)})`}function B1e(e,t,n){if(!e)return;const r=iU(e);return`${n||P3(e)?"utc":"time"}Format(${t}, ${r})`}function Ut(e){if(!e)return;let t;return K(e)?tU(e)?t={unit:e.substring(6),binned:!0}:t={unit:e}:J(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),P3(t.unit)&&(t.utc=!0,t.unit=L1e(t.unit)),t}function j1e(e){const{utc:t,...n}=Ut(e);return n.unit?(t?"utc":"")+B(n).map(r=>nt(`${r==="unit"?"":`_${r}_`}${n[r]}`)).join(""):(t?"utc":"")+"timeunit"+B(n).map(r=>nt(`_${r}_${n[r]}`)).join("")}function oU(e,t=n=>n){const n=Ut(e),r=nU(n.unit);if(r&&r!=="day"){const i={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:o,part:s}=sU(r,n.step),a={...i,[s]:+i[s]+o};return`${t(wl(a))} - ${t(wl(i))}`}}const U1e={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function W1e(e){return!!U1e[e]}function sU(e,t=1){if(W1e(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function q1e(e){return e==null?void 0:e.param}function L3(e){return!!(e!=null&&e.field)&&e.equal!==void 0}function z3(e){return!!(e!=null&&e.field)&&e.lt!==void 0}function I3(e){return!!(e!=null&&e.field)&&e.lte!==void 0}function B3(e){return!!(e!=null&&e.field)&&e.gt!==void 0}function j3(e){return!!(e!=null&&e.field)&&e.gte!==void 0}function U3(e){if(e!=null&&e.field){if(I(e.range)&&e.range.length===2)return!0;if(ne(e.range))return!0}return!1}function W3(e){return!!(e!=null&&e.field)&&(I(e.oneOf)||I(e.in))}function H1e(e){return!!(e!=null&&e.field)&&e.valid!==void 0}function aU(e){return W3(e)||L3(e)||U3(e)||z3(e)||B3(e)||I3(e)||j3(e)}function no(e,t){return zx(e,{timeUnit:t,wrapTime:!0})}function G1e(e,t){return e.map(n=>no(n,t))}function uU(e,t=!0){const{field:n}=e,r=Ut(e.timeUnit),{unit:i,binned:o}=r||{},s=Y(e,{expr:"datum"}),a=i?`time(${o?s:I1e(i,n)})`:s;if(L3(e))return`${a}===${no(e.equal,i)}`;if(z3(e)){const u=e.lt;return`${a}<${no(u,i)}`}else if(B3(e)){const u=e.gt;return`${a}>${no(u,i)}`}else if(I3(e)){const u=e.lte;return`${a}<=${no(u,i)}`}else if(j3(e)){const u=e.gte;return`${a}>=${no(u,i)}`}else{if(W3(e))return`indexof([${G1e(e.oneOf,i).join(",")}], ${a}) !== -1`;if(H1e(e))return q3(a,e.valid);if(U3(e)){const{range:u}=e,l=ne(u)?{signal:`${u.signal}[0]`}:u[0],c=ne(u)?{signal:`${u.signal}[1]`}:u[1];if(l!==null&&c!==null&&t)return"inrange("+a+", ["+no(l,i)+", "+no(c,i)+"])";const f=[];return l!==null&&f.push(`${a} >= ${no(l,i)}`),c!==null&&f.push(`${a} <= ${no(c,i)}`),f.length>0?f.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${We(e)}`)}function q3(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function V1e(e){return aU(e)&&e.timeUnit?{...e,timeUnit:Ut(e.timeUnit)}:e}const Rg={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function Y1e(e){return e==="quantitative"||e==="temporal"}function lU(e){return e==="ordinal"||e==="nominal"}const El=Rg.quantitative,H3=Rg.ordinal,Cf=Rg.temporal,G3=Rg.nominal,od=Rg.geojson;function X1e(e){if(e)switch(e=e.toLowerCase(),e){case"q":case El:return"quantitative";case"t":case Cf:return"temporal";case"o":case H3:return"ordinal";case"n":case G3:return"nominal";case od:return"geojson"}}const ur={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},JS={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function Q1e(e,t){const n=JS[e],r=JS[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const K1e={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function cD(e){return K1e[e]}const cU=new Set(["linear","log","pow","sqrt","symlog"]),fU=new Set([...cU,"time","utc"]);function dU(e){return cU.has(e)}const hU=new Set(["quantile","quantize","threshold"]),J1e=new Set([...fU,...hU,"sequential","identity"]),Z1e=new Set(["ordinal","bin-ordinal","point","band"]);function Wt(e){return Z1e.has(e)}function Pr(e){return J1e.has(e)}function Oi(e){return fU.has(e)}function Af(e){return hU.has(e)}const eye={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0};function tye(e){return!K(e)&&!!e.name}function pU(e){return e==null?void 0:e.param}function nye(e){return e==null?void 0:e.unionWith}function rye(e){return J(e)&&"field"in e}const iye={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:Jke,domain:Zke,range:e$e,rangeMax:t$e,rangeMin:n$e,scheme:r$e,...oye}=iye,sye=B(oye);function ZS(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return Oi(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return Oi(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return Oi(e);case"nice":return Oi(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Pr(e)&&!Se(["log","time","utc","threshold","quantile"],e)}}function gU(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Wc(e)?void 0:n1e(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function aye(e,t){return Se([H3,G3],t)?e===void 0||Wt(e):t===Cf?Se([ur.TIME,ur.UTC,void 0],e):t===El?dU(e)||Af(e)||e===void 0:!0}function uye(e,t,n=!1){if(!Rs(e))return!1;switch(e){case rt:case Ht:case ru:case id:case fi:case Xi:return Oi(t)||t==="band"?!0:t==="point"?!n:!1;case Ns:case su:case Os:case iu:case ou:case jl:return Oi(t)||Af(t)||Se(["band","point","ordinal"],t);case dr:case zo:case Io:return t!=="band";case au:case hr:return t==="ordinal"||Af(t)}}const Yn={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},mU=Yn.arc,Tx=Yn.area,Fx=Yn.bar,lye=Yn.image,Mx=Yn.line,Nx=Yn.point,cye=Yn.rect,by=Yn.rule,yU=Yn.text,V3=Yn.tick,fye=Yn.trail,Y3=Yn.circle,X3=Yn.square,vU=Yn.geoshape;function cu(e){return["line","area","trail"].includes(e)}function Lp(e){return["rect","bar","image","arc"].includes(e)}const dye=new Set(B(Yn));function Ao(e){return e.type}const hye=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],pye=["fill","fillOpacity"],gye=[...hye,...pye],mye={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},fD=B(mye),yye={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],line:["point"],tick:["bandSize","thickness"]},vye={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},xye={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},xU=B(xye);function Sl(e){return e&&e.band!=null}const bye={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},bU=5,wye={binSpacing:1,continuousBandSize:bU,minBandSize:.25,timeUnitBandPosition:.5},Eye={binSpacing:0,continuousBandSize:bU,minBandSize:.25,timeUnitBandPosition:.5},Sye={thickness:1};function _ye(e){return Ao(e)?e.type:e}function Q3(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:o}=e,s=J3(e);return W(n)&&!Dj(n.aggregate)&&i&&Oi(i.get("type"))?kye({fieldDef:n,channel:t,markDef:r,ref:s,config:o}):s}function kye({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return cu(n.type)?r:De("invalid",n,i)===null?[$ye(e,t),r]:r}function $ye(e,t){const n=K3(e,!0),i=Ul(t)==="y"?{field:{group:"height"}}:{value:0};return{test:n,...i}}function K3(e,t=!0){return q3(K(e)?e:Y(e,{expr:"datum"}),!t)}function Cye(e){const{datum:t}=e;return ql(t)?wl(t):`${We(t)}`}function Ku(e,t,n,r){const i={};if(t&&(i.scale=t),Uo(e)){const{datum:o}=e;ql(o)?i.signal=wl(o):ne(o)?i.signal=o.signal:Og(o)?i.signal=o.expr:i.value=o}else i.field=Y(e,n);if(r){const{offset:o,band:s}=r;o&&(i.offset=o),s&&(i.band=s)}return i}function wy({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,endSuffix:o="end",bandPosition:s=.5}){const a=!ne(s)&&0<s&&s<1?"datum":void 0,u=Y(t,{expr:a,suffix:i}),l=n!==void 0?Y(n,{expr:a}):Y(t,{suffix:o,expr:a}),c={};if(s===0||s===1){c.scale=e;const f=s===0?u:l;c.field=f}else{const f=ne(s)?`(1-${s.signal}) * ${u} + ${s.signal} * ${l}`:`${1-s} * ${u} + ${s} * ${l}`;c.signal=`scale("${e}", ${f})`}return r&&(c.offset=r),c}function Aye({scaleName:e,fieldDef:t}){const n=Y(t,{expr:"datum"}),r=Y(t,{expr:"datum",suffix:"end"});return`abs(scale("${e}", ${r}) - scale("${e}", ${n}))`}function J3({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l,bandPosition:c}){if(t){if(de(t)){const f=s==null?void 0:s.get("type");if(qn(t)){c??(c=Ua({fieldDef:t,fieldDef2:n,markDef:r,config:i}));const{bin:d,timeUnit:h,type:p}=t;if(Ye(d)||c&&h&&p===Cf)return a!=null&&a.impute?Ku(t,o,{binSuffix:"mid"},{offset:u}):c&&!Wt(f)?wy({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):Ku(t,o,zg(t,e)?{binSuffix:"range"}:{},{offset:u});if(Xt(d)){if(W(n))return wy({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});U(Qj(e===rt?Yi:Lo))}}return Ku(t,o,Wt(f)?{binSuffix:"range"}:{},{offset:u,band:f==="band"?c??t.bandPosition??.5:void 0})}else if(Wi(t)){const f=t.value,d=u?{offset:u}:{};return{...Wh(e,f),...d}}}return ge(l)&&(l=l()),l&&{...l,...u?{offset:u}:{}}}function Wh(e,t){return Se(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:Se(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Je(t)}function _l(e){return e&&e!=="number"&&e!=="time"}function wU(e,t,n){return`${e}(${t}${n?`, ${We(n)}`:""})`}const Tye="  ";function Z3({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){var u,l;if(_l(n))return Ri({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});const s=EU(e,r,i),a=Tf(e);if(t===void 0&&n===void 0&&o.customFormatTypes){if(a==="quantitative"){if(i&&o.normalizedNumberFormatType)return Ri({fieldOrDatumDef:e,format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,expr:r,config:o});if(o.numberFormatType)return Ri({fieldOrDatumDef:e,format:o.numberFormat,formatType:o.numberFormatType,expr:r,config:o})}if(a==="temporal"&&o.timeFormatType&&W(e)&&e.timeUnit===void 0)return Ri({fieldOrDatumDef:e,format:o.timeFormat,formatType:o.timeFormatType,expr:r,config:o})}if(Mf(e)){const c=Mye({field:s,timeUnit:W(e)?(u=Ut(e.timeUnit))==null?void 0:u.unit:void 0,format:t,formatType:o.timeFormatType,rawTimeFormat:o.timeFormat,isUTCScale:Gl(e)&&((l=e.scale)==null?void 0:l.type)===ur.UTC});return c?{signal:c}:void 0}if(t=e_({type:a,specifiedFormat:t,config:o,normalizeStack:i}),W(e)&&Ye(e.bin)){const c=Y(e,{expr:r,binSuffix:"end"});return{signal:Dg(s,c,t,n,o)}}else return t||Tf(e)==="quantitative"?{signal:`${kU(s,t)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function EU(e,t,n){return W(e)?n?`${Y(e,{expr:t,suffix:"end"})}-${Y(e,{expr:t,suffix:"start"})}`:Y(e,{expr:t}):Cye(e)}function Ri({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:s}){if(s??(s=EU(e,r,i)),s!=="datum.value"&&W(e)&&Ye(e.bin)){const a=Y(e,{expr:r,binSuffix:"end"});return{signal:Dg(s,a,t,n,o)}}return{signal:wU(n,s,t)}}function SU(e,t,n,r,i,o){var s;if(!(K(r)&&_l(r))&&!(n===void 0&&r===void 0&&i.customFormatTypes&&Tf(e)==="quantitative"&&(i.normalizedNumberFormatType&&Ff(e)&&e.stack==="normalize"||i.numberFormatType))){if(Ff(e)&&e.stack==="normalize"&&i.normalizedNumberFormat)return e_({type:"quantitative",config:i,normalizeStack:!0});if(Mf(e)){const a=W(e)?(s=Ut(e.timeUnit))==null?void 0:s.unit:void 0;return a===void 0&&i.customFormatTypes&&i.timeFormatType?void 0:Fye({specifiedFormat:n,timeUnit:a,config:i,omitTimeFormatConfig:o})}return e_({type:t,specifiedFormat:n,config:i})}}function _U(e,t,n){var r;if(e&&(ne(e)||e==="number"||e==="time"))return e;if(Mf(t)&&n!=="time"&&n!=="utc")return W(t)&&((r=Ut(t==null?void 0:t.timeUnit))!=null&&r.utc)?"utc":"time"}function e_({type:e,specifiedFormat:t,config:n,normalizeStack:r}){if(K(t))return t;if(e===El)return r?n.normalizedNumberFormat:n.numberFormat}function Fye({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:r}){return e||(t?{signal:iU(t)}:r?void 0:n.timeFormat)}function kU(e,t){return`format(${e}, "${t||""}")`}function dD(e,t,n,r){return _l(n)?wU(n,e,t):kU(e,(K(t)?t:void 0)??r.numberFormat)}function Dg(e,t,n,r,i){if(n===void 0&&r===void 0&&i.customFormatTypes&&i.numberFormatType)return Dg(e,t,i.numberFormat,i.numberFormatType,i);const o=dD(e,n,r,i),s=dD(t,n,r,i);return`${q3(e,!1)} ? "null" : ${o} + "${Tye}" + ${s}`}function Mye({field:e,timeUnit:t,format:n,formatType:r,rawTimeFormat:i,isUTCScale:o}){return!t||n?!t&&r?`${r}(${e}, '${n}')`:(n=K(n)?n:i,`${o?"utc":"time"}Format(${e}, '${n}')`):B1e(t,e,o)}const Ox="min",Nye={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function hD(e){return e in Nye}function $U(e){return!!(e!=null&&e.encoding)}function xo(e){return e&&(e.op==="count"||!!e.field)}function CU(e){return e&&I(e)}function Pg(e){return"row"in e||"column"in e}function eT(e){return!!e&&"header"in e}function Rx(e){return"facet"in e}function Oye(e){return e.param}function Rye(e){return e&&!K(e)&&"repeat"in e}function pD(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:t}}function tT(e){return"sort"in e}function Ua({fieldDef:e,fieldDef2:t,markDef:n,config:r}){if(de(e)&&e.bandPosition!==void 0)return e.bandPosition;if(W(e)){const{timeUnit:i,bin:o}=e;if(i&&!t)return $s("timeUnitBandPosition",n,r);if(Ye(o))return .5}}function AU({channel:e,fieldDef:t,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:s}){var l,c,f;const a=pr(e),u=De(s?"size":a,r,i,{vgChannel:a});if(u!==void 0)return u;if(W(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:$s("timeUnitBandSize",r,i)};if(Ye(h)&&!Wt(o))return{band:1}}if(Lp(r.type))return o?Wt(o)?((l=i[r.type])==null?void 0:l.discreteBandSize)||{band:1}:(c=i[r.type])==null?void 0:c.continuousBandSize:(f=i[r.type])==null?void 0:f.discreteBandSize}function TU(e,t,n,r){return Ye(e.bin)||e.timeUnit&&qn(e)&&e.type==="temporal"?Ua({fieldDef:e,fieldDef2:t,markDef:n,config:r})!==void 0:!1}function FU(e){return e&&!!e.sort&&!e.field}function Dx(e){return e&&"condition"in e}function Px(e){const t=e==null?void 0:e.condition;return!!t&&!I(t)&&W(t)}function Lg(e){const t=e==null?void 0:e.condition;return!!t&&!I(t)&&de(t)}function Dye(e){const t=e==null?void 0:e.condition;return!!t&&(I(t)||Wi(t))}function W(e){return e&&(!!e.field||e.aggregate==="count")}function Tf(e){return e==null?void 0:e.type}function Uo(e){return e&&"datum"in e}function ca(e){return qn(e)&&!Sy(e)||Ey(e)}function gD(e){return qn(e)&&e.type==="quantitative"&&!e.bin||Ey(e)}function Ey(e){return Uo(e)&&Te(e.datum)}function de(e){return W(e)||Uo(e)}function qn(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function Wi(e){return e&&"value"in e&&"value"in e}function Gl(e){return e&&("scale"in e||"sort"in e)}function Ff(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function MU(e){return e&&"legend"in e}function NU(e){return e&&("format"in e||"formatType"in e)}function Pye(e){return ar(e,["legend","axis","header","scale"])}function Lye(e){return"op"in e}function Y(e,t={}){let n=e.field;const r=t.prefix;let i=t.suffix,o="";if(Iye(e))n=wj("count");else{let s;if(!t.nofn)if(Lye(e))s=e.op;else{const{bin:a,aggregate:u,timeUnit:l}=e;Ye(a)?(s=Pj(a),i=(t.binSuffix??"")+(t.suffix??"")):u?uu(u)?(o=`["${n}"]`,n=`argmax_${u.argmax}`):ks(u)?(o=`["${n}"]`,n=`argmin_${u.argmin}`):s=String(u):l&&!Hl(l)&&(s=j1e(l),i=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}s&&(n=n?`${s}_${n}`:s)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),t.forAs?S3(n):t.expr?vj(n,t.expr)+o:ui(n)+o}function Sy(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return W(e)&&!!e.bin;case"temporal":return!1}throw new Error(Gj(e.type))}function zye(e){var t;return Gl(e)&&Af((t=e.scale)==null?void 0:t.type)}function Iye(e){return e.aggregate==="count"}function Bye(e,t){var s;const{field:n,bin:r,timeUnit:i,aggregate:o}=e;if(o==="count")return t.countTitle;if(Ye(r))return`${n} (binned)`;if(i&&!Hl(i)){const a=(s=Ut(i))==null?void 0:s.unit;if(a)return`${n} (${Ax(a).join("-")})`}else if(o)return uu(o)?`${n} for max ${o.argmax}`:ks(o)?`${n} for min ${o.argmin}`:`${Tg(o)} of ${n}`;return n}function jye(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(uu(t))return`${i} for argmax(${t.argmax})`;if(ks(t))return`${i} for argmin(${t.argmin})`;const o=r&&!Hl(r)?Ut(r):void 0,s=t||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||Ye(n)&&"bin";return s?`${s.toUpperCase()}(${i})`:i}const OU=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return jye(e);default:return Bye(e,t)}};let RU=OU;function DU(e){RU=e}function Uye(){DU(OU)}function qc(e,t,{allowDisabling:n,includeDefault:r=!0}){var a;const i=(a=nT(e))==null?void 0:a.title;if(!W(e))return i??e.title;const o=e,s=r?rT(o,t):void 0;return n?vt(i,o.title,s):i??o.title??s}function nT(e){if(Ff(e)&&e.axis)return e.axis;if(MU(e)&&e.legend)return e.legend;if(eT(e)&&e.header)return e.header}function rT(e,t){return RU(e,t)}function _y(e){if(NU(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=nT(e)??{},{format:n,formatType:r}=t;return{format:n,formatType:r}}}function Wye(e,t){var o;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(tT(e)&&I(e.sort))return"ordinal";const{aggregate:n,bin:r,timeUnit:i}=e;if(i)return"temporal";if(r||n&&!uu(n)&&!ks(n))return"quantitative";if(Gl(e)&&((o=e.scale)!=null&&o.type))switch(JS[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function To(e){if(W(e))return e;if(Px(e))return e.condition}function At(e){if(de(e))return e;if(Lg(e))return e.condition}function PU(e,t,n,r={}){if(K(e)||Te(e)||Qa(e)){const i=K(e)?"string":Te(e)?"number":"boolean";return U(q0e(t,i,e)),{value:e}}return de(e)?ky(e,t,n,r):Lg(e)?{...e,condition:ky(e.condition,t,n,r)}:e}function ky(e,t,n,r){if(NU(e)){const{format:i,formatType:o,...s}=e;if(_l(o)&&!n.customFormatTypes)return U(aD(t)),ky(s,t,n,r)}else{const i=Ff(e)?"axis":MU(e)?"legend":eT(e)?"header":null;if(i&&e[i]){const{format:o,formatType:s,...a}=e[i];if(_l(s)&&!n.customFormatTypes)return U(aD(t)),ky({...e,[i]:a},t,n,r)}}return W(e)?iT(e,t,r):qye(e)}function qye(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Te(n)?"quantitative":K(n)?"nominal":ql(n)?"temporal":void 0,{...e,type:t}}function iT(e,t,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:o,field:s}=e,a={...e};if(!n&&r&&!M3(r)&&!uu(r)&&!ks(r)&&(U(G0e(r)),delete a.aggregate),i&&(a.timeUnit=Ut(i)),s&&(a.field=`${s}`),Ye(o)&&(a.bin=Lx(o,t)),Xt(o)&&!xt(t)&&U(_1e(t)),qn(a)){const{type:u}=a,l=X1e(u);u!==l&&(a.type=l),u!=="quantitative"&&Dj(r)&&(U(H0e(u,r)),a.type="quantitative")}else if(!Tj(t)){const u=Wye(a,t);a.type=u}if(qn(a)){const{compatible:u,warning:l}=Hye(a,t)||{};u===!1&&U(l)}if(tT(a)&&K(a.sort)){const{sort:u}=a;if(hD(u))return{...a,sort:{encoding:u}};const l=u.substr(1);if(u.charAt(0)==="-"&&hD(l))return{...a,sort:{encoding:l,order:"descending"}}}if(eT(a)){const{header:u}=a;if(u){const{orient:l,...c}=u;if(l)return{...a,header:{...c,labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l}}}}return a}function Lx(e,t){return Qa(e)?{maxbins:JR(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:JR(t)}:e}const oc={compatible:!0};function Hye(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ps:case gs:case xx:return Sy(e)?oc:{compatible:!1,warning:Q0e(t)};case rt:case Ht:case ru:case id:case dr:case zo:case Io:case Fg:case Mg:case bx:case bl:case wx:case Ex:case jl:case fi:case Xi:case Sx:return oc;case Ki:case li:case Qi:case Ji:return n!==El?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:oc;case Os:case iu:case ou:case su:case Ns:case Ms:case Fs:case Yi:case Lo:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:oc;case hr:case au:return!Sy(e)&&!zye(e)?{compatible:!1,warning:K0e(t)}:oc;case kf:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:oc}}function Mf(e){const{formatType:t}=_y(e);return t==="time"||!t&&Gye(e)}function Gye(e){return e&&(e.type==="temporal"||W(e)&&!!e.timeUnit)}function zx(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var u;const o=t&&((u=Ut(t))==null?void 0:u.unit);let s=o||n==="temporal",a;return Og(e)?a=e.expr:ne(e)?a=e.signal:ql(e)?(s=!0,a=wl(e)):(K(e)||Te(e))&&s&&(a=`datetime(${We(e)})`,P1e(o)&&(Te(e)&&e<1e4||K(e)&&isNaN(Date.parse(e)))&&(a=wl({[o]:e}))),a?r&&s?`time(${a})`:a:i?void 0:We(e)}function LU(e,t){const{type:n}=e;return t.map(r=>{const i=W(e)&&!Hl(e.timeUnit)?e.timeUnit:void 0,o=zx(r,{timeUnit:i,type:n,undefinedIfExprNotRequired:!0});return o!==void 0?{signal:o}:r})}function zg(e,t){return Ye(e.bin)?Rs(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const mD={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Ig(e){return e==null?void 0:e.condition}const zU=["domain","grid","labels","ticks","title"],Vye={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},IU={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Yye={...IU,style:1,labelExpr:1,encoding:1};function yD(e){return!!Yye[e]}const Xye={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},BU=B(Xye);function Ds(e){return"mark"in e}class Ix{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Ds(t)?_ye(t.mark)===this.name:!1}}function Ju(e,t){const n=e&&e[t];return n?I(n)?vl(n,r=>!!r.field):W(n)||Px(n):!1}function jU(e,t){const n=e&&e[t];return n?I(n)?vl(n,r=>!!r.field):W(n)||Uo(n)||Lg(n):!1}function UU(e,t){if(xt(t)){const n=e[t];if((W(n)||Uo(n))&&(lU(n.type)||W(n)&&n.timeUnit)){const r=C3(t);return jU(e,r)}}return!1}function oT(e){return vl(Qme,t=>{if(Ju(e,t)){const n=e[t];if(I(n))return vl(n,r=>!!r.aggregate);{const r=To(n);return r&&!!r.aggregate}}return!1})}function WU(e,t){const n=[],r=[],i=[],o=[],s={};return sT(e,(a,u)=>{if(W(a)){const{field:l,aggregate:c,bin:f,timeUnit:d,...h}=a;if(c||d||f){const p=nT(a),g=p==null?void 0:p.title;let m=Y(a,{forAs:!0});const y={...g?[]:{title:qc(a,t,{allowDisabling:!0})},...h,field:m};if(c){let v;if(uu(c)?(v="argmax",m=Y({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${m}.${l}`):ks(c)?(v="argmin",m=Y({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const x={op:v,as:m};l&&(x.field=l),o.push(x)}}else if(n.push(m),qn(a)&&Ye(f)){if(r.push({bin:f,field:l,as:m}),n.push(Y(a,{binSuffix:"end"})),zg(a,u)&&n.push(Y(a,{binSuffix:"range"})),xt(u)){const v={field:`${m}_end`};s[`${u}2`]=v}y.bin="binned",Tj(u)||(y.type=El)}else if(d&&!Hl(d)){i.push({timeUnit:d,field:l,as:m});const v=qn(a)&&a.type!==Cf&&"time";v&&(u===Fg||u===bl?y.formatType=v:s0e(u)?y.legend={formatType:v,...y.legend}:xt(u)&&(y.axis={formatType:v,...y.axis}))}s[u]=y}else n.push(l),s[u]=e[u]}else s[u]=e[u]}),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:s}}function Qye(e,t,n){const r=u0e(t,n);if(r){if(r==="binned"){const i=e[t===Yi?rt:Ht];return!!(W(i)&&W(e[t])&&Xt(i.bin))}}else return!1;return!0}function Kye(e,t,n,r){const i={};for(const o of B(e))Aj(o)||U(X0e(o));for(let o of n0e){if(!e[o])continue;const s=e[o];if(Ng(o)){const a=t0e(o),u=i[a];if(W(u)&&Y1e(u.type)&&W(s)&&!u.timeUnit){U(W0e(a));continue}}if(o==="angle"&&t==="arc"&&!e.theta&&(U(U0e),o=fi),!Qye(e,o,t)){U(Cx(o,t));continue}if(o===Ns&&t==="line"){const a=To(e[o]);if(a!=null&&a.aggregate){U(Y0e);continue}}if(o===dr&&(n?"fill"in e:"stroke"in e)){U(Vj("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(o===Mg||o===kf&&!I(s)&&!Wi(s)||o===bl&&I(s)){if(s){if(o===kf){const a=e[o];if(FU(a)){i[o]=a;continue}}i[o]=Q(s).reduce((a,u)=>(W(u)?a.push(iT(u,o)):U(KS(u,o)),a),[])}}else{if(o===bl&&s===null)i[o]=null;else if(!W(s)&&!Uo(s)&&!Wi(s)&&!Dx(s)&&!ne(s)){U(KS(s,o));continue}i[o]=PU(s,o,r)}}return i}function Bx(e,t){const n={};for(const r of B(e)){const i=PU(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function Jye(e){const t=[];for(const n of B(e))if(Ju(e,n)){const r=e[n],i=Q(r);for(const o of i)W(o)?t.push(o):Px(o)&&t.push(o.condition)}return t}function sT(e,t,n){if(e)for(const r of B(e)){const i=e[r];if(I(i))for(const o of i)t.call(n,o,r);else t.call(n,i,r)}}function Zye(e,t,n,r){return e?B(e).reduce((i,o)=>{const s=e[o];return I(s)?s.reduce((a,u)=>t.call(r,a,u,o),i):t.call(r,i,s,o)},n):n}function qU(e,t){return B(t).reduce((n,r)=>{switch(r){case rt:case Ht:case wx:case Sx:case Ex:case Yi:case Lo:case ru:case id:case fi:case Ms:case Xi:case Fs:case Qi:case Ki:case Ji:case li:case Fg:case hr:case jl:case bl:return n;case kf:if(e==="line"||e==="trail")return n;case Mg:case bx:{const i=t[r];if(I(i)||W(i))for(const o of Q(i))o.aggregate||n.push(Y(o,{}));return n}case Ns:if(e==="trail")return n;case dr:case zo:case Io:case Os:case iu:case ou:case au:case su:{const i=To(t[r]);return i&&!i.aggregate&&n.push(Y(i,{})),n}}},[])}function eve(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let r,i;if(I(t)){for(const o of t)o.aggregate?(r||(r=[]),r.push(o)):(i||(i=[]),i.push(o));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return I(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function t_(e,t,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};const i=e.map(({fieldPrefix:s,titlePrefix:a})=>{const u=r?` of ${aT(t)}`:"";return{field:s+t.field,type:t.type,title:ne(a)?{signal:`${a}"${escape(u)}"`}:a+u}}),o=Jye(n).map(Pye);return{tooltip:[...i,...ho(o,Ee)]}}function aT(e){const{title:t,field:n}=e;return vt(t,n)}function uT(e,t,n,r,i){const{scale:o,axis:s}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=aT(n);return HU(e,a,i,{mark:u,encoding:{[t]:{field:`${l}_${n.field}`,type:n.type,...d!==void 0?{title:d}:{},...o!==void 0?{scale:o}:{},...s!==void 0?{axis:s}:{}},...K(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...r,...f}})}}function HU(e,t,n,r){const{clip:i,color:o,opacity:s}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[{...r,mark:{...n[t],...i?{clip:i}:{},...o?{color:o}:{},...s?{opacity:s}:{},...Ao(r.mark)?r.mark:{type:r.mark},style:`${a}-${String(t)}`,...Qa(e[t])?{}:e[t]}}]:[]}function GU(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",o=r[i],s=r[`${i}2`],a=r[`${i}Error`],u=r[`${i}Error2`];return{continuousAxisChannelDef:Pm(o,n),continuousAxisChannelDef2:Pm(s,n),continuousAxisChannelDefError:Pm(a,n),continuousAxisChannelDefError2:Pm(u,n),continuousAxis:i}}function Pm(e,t){if(e!=null&&e.aggregate){const{aggregate:n,...r}=e;return n!==t&&U(S1e(n,t)),r}else return e}function VU(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(Ao(n)&&n.orient)return n.orient;if(ca(i)){if(ca(o)){const s=W(i)&&i.aggregate,a=W(o)&&o.aggregate;if(!s&&a===t)return"vertical";if(!a&&s===t)return"horizontal";if(s===t&&a===t)throw new Error("Both x and y cannot have aggregate");return Mf(o)&&!Mf(i)?"horizontal":"vertical"}return"horizontal"}else{if(ca(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const $y="boxplot",tve=["box","median","outliers","rule","ticks"],nve=new Ix($y,XU);function YU(e){return Te(e)?"tukey":e}function XU(e,{config:t}){e={...e,encoding:Bx(e.encoding,t)};const{mark:n,encoding:r,params:i,projection:o,...s}=e,a=Ao(n)?n:{type:n};i&&U(Hj("boxplot"));const u=a.extent??t.boxplot.extent,l=De("size",a,t),c=a.invalid,f=YU(u),{bins:d,timeUnits:h,transform:p,continuousAxisChannelDef:g,continuousAxis:m,groupby:y,aggregate:v,encodingWithoutContinuousAxis:x,ticksOrient:b,boxOrient:w,customTooltipWithoutAggregatedField:S}=rve(e,u,t),{color:E,size:_,...k}=x,$=$n=>uT(a,m,g,$n,t.boxplot),C=$(k),R=$(x),A=$({...k,..._?{size:_}:{}}),F=t_([{fieldPrefix:f==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:f==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],g,x),T={type:"tick",color:"black",opacity:1,orient:b,invalid:c,aria:!1},M=f==="min-max"?F:t_([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,x),P=[...C({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:M}),...C({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:M}),...C({partName:"ticks",mark:T,positionPrefix:"lower_whisker",extraEncoding:M}),...C({partName:"ticks",mark:T,positionPrefix:"upper_whisker",extraEncoding:M})],N=[...f!=="tukey"?P:[],...R({partName:"box",mark:{type:"bar",...l?{size:l}:{},orient:w,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:F}),...A({partName:"median",mark:{type:"tick",invalid:c,...J(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...l?{size:l}:{},orient:b,aria:!1},positionPrefix:"mid_box",extraEncoding:F})];if(f==="min-max")return{...s,transform:(s.transform??[]).concat(p),layer:N};const O=`datum["lower_box_${g.field}"]`,j=`datum["upper_box_${g.field}"]`,X=`(${j} - ${O})`,re=`${O} - ${u} * ${X}`,be=`${j} + ${u} * ${X}`,he=`datum["${g.field}"]`,Le={joinaggregate:QU(g.field),groupby:y},Gt={transform:[{filter:`(${re} <= ${he}) && (${he} <= ${be})`},{aggregate:[{op:"min",field:g.field,as:`lower_whisker_${g.field}`},{op:"max",field:g.field,as:`upper_whisker_${g.field}`},{op:"min",field:`lower_box_${g.field}`,as:`lower_box_${g.field}`},{op:"max",field:`upper_box_${g.field}`,as:`upper_box_${g.field}`},...v],groupby:y}],layer:P},{tooltip:hi,...fu}=k,{scale:Z,axis:me}=g,ve=aT(g),q=ar(me,["title"]),Vt=HU(a,"outliers",t.boxplot,{transform:[{filter:`(${he} < ${re}) || (${he} > ${be})`}],mark:"point",encoding:{[m]:{field:g.field,type:g.type,...ve!==void 0?{title:ve}:{},...Z!==void 0?{scale:Z}:{},...Ue(q)?{}:{axis:q}},...fu,...E?{color:E}:{},...S?{tooltip:S}:{}}})[0];let Re;const on=[...d,...h,Le];return Vt?Re={transform:on,layer:[Vt,Gt]}:(Re=Gt,Re.transform.unshift(...on)),{...s,layer:[Re,{transform:p,layer:N}]}}function QU(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function rve(e,t,n){const r=VU(e,$y),{continuousAxisChannelDef:i,continuousAxis:o}=GU(e,r,$y),s=i.field,a=YU(t),u=[...QU(s),{op:"median",field:s,as:`mid_box_${s}`},{op:"min",field:s,as:(a==="min-max"?"lower_whisker_":"min_")+s},{op:"max",field:s,as:(a==="min-max"?"upper_whisker_":"max_")+s}],l=a==="min-max"||a==="tukey"?[]:[{calculate:`datum["upper_box_${s}"] - datum["lower_box_${s}"]`,as:`iqr_${s}`},{calculate:`min(datum["upper_box_${s}"] + datum["iqr_${s}"] * ${t}, datum["max_${s}"])`,as:`upper_whisker_${s}`},{calculate:`max(datum["lower_box_${s}"] - datum["iqr_${s}"] * ${t}, datum["min_${s}"])`,as:`lower_whisker_${s}`}],{[o]:c,...f}=e.encoding,{customTooltipWithoutAggregatedField:d,filteredEncoding:h}=eve(f),{bins:p,timeUnits:g,aggregate:m,groupby:y,encoding:v}=WU(h,n),x=r==="vertical"?"horizontal":"vertical",b=r,w=[...p,...g,{aggregate:[...m,...u],groupby:y},...l];return{bins:p,timeUnits:g,transform:w,groupby:y,aggregate:m,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:x,boxOrient:b,customTooltipWithoutAggregatedField:d}}const lT="errorbar",ive=["ticks","rule"],ove=new Ix(lT,KU);function KU(e,{config:t}){e={...e,encoding:Bx(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:u,tooltipEncoding:l}=JU(e,lT,t);delete o.size;const c=uT(a,i,r,o,t.errorbar),f=a.thickness,d=a.size,h={type:"tick",orient:s,aria:!1,...f!==void 0?{thickness:f}:{},...d!==void 0?{size:d}:{}},p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...f!==void 0?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return{...u,transform:n,...p.length>1?{layer:p}:{...p[0]}}}function sve(e,t){const{encoding:n}=e;if(ave(n))return{orient:VU(e,t),inputType:"raw"};const r=uve(n),i=lve(n),o=n.x,s=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(de(a)&&de(u))throw new Error(`${t} cannot have both x2 and y2`);if(de(a)){if(ca(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(de(u)){if(ca(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(de(u)&&!de(a))throw new Error(`${t} cannot have xError2 without xError`);if(de(c)&&!de(l))throw new Error(`${t} cannot have yError2 without yError`);if(de(a)&&de(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(de(a)){if(ca(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(de(l)){if(ca(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function ave(e){return(de(e.x)||de(e.y))&&!de(e.x2)&&!de(e.y2)&&!de(e.xError)&&!de(e.xError2)&&!de(e.yError)&&!de(e.yError2)}function uve(e){return de(e.x2)||de(e.y2)}function lve(e){return de(e.xError)||de(e.xError2)||de(e.yError)||de(e.yError2)}function JU(e,t,n){const{mark:r,encoding:i,params:o,projection:s,...a}=e,u=Ao(r)?r:{type:r};o&&U(Hj(t));const{orient:l,inputType:c}=sve(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:g}=GU(e,l,t),{errorBarSpecificAggregate:m,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:x}=cve(u,f,d,h,p,c,t,n),{[g]:b,[g==="x"?"x2":"y2"]:w,[g==="x"?"xError":"yError"]:S,[g==="x"?"xError2":"yError2"]:E,..._}=i,{bins:k,timeUnits:$,aggregate:C,groupby:R,encoding:A}=WU(_,n),F=[...C,...m],T=c!=="raw"?[]:R,M=t_(v,f,A,x);return{transform:[...a.transform??[],...k,...$,...F.length===0?[]:[{aggregate:F,groupby:T}],...y],groupby:T,continuousAxisChannelDef:f,continuousAxis:g,encodingWithoutContinuousAxis:A,ticksOrient:l==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:a,tooltipEncoding:M}}function cve(e,t,n,r,i,o,s,a){let u=[],l=[];const c=t.field;let f,d=!1;if(o==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&U(E1e(h,p,s)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:Tg(h)},{fieldPrefix:"upper_",titlePrefix:vD(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:vD(h,p,"-")}],d=!0;else{let g,m,y;p==="ci"?(g="mean",m="ci0",y="ci1"):(g="median",m="q1",y="q3"),u=[{op:m,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:qc({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:qc({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:qc({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&U(w1e(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:xl(xl(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function vD(e,t,n){return`${Tg(e)} ${n} ${t}`}const cT="errorband",fve=["band","borders"],dve=new Ix(cT,ZU);function ZU(e,{config:t}){e={...e,encoding:Bx(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:a,tooltipEncoding:u}=JU(e,cT,t),l=s,c=uT(l,i,r,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p={...l.interpolate?{interpolate:l.interpolate}:{},...l.tension&&l.interpolate?{tension:l.tension}:{}};return f?(d={...d,...p,ariaRoleDescription:"errorband"},h={...h,...p,aria:!1}):l.interpolate?U(lD("interpolate")):l.tension&&U(lD("tension")),{...a,transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]}}const eW={};function fT(e,t,n){const r=new Ix(e,t);eW[e]={normalizer:r,parts:n}}function hve(){return B(eW)}fT($y,XU,tve);fT(lT,KU,ive);fT(cT,ZU,fve);const pve=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],tW={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},nW={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},gve=B(tW),mve=B(nW),yve={header:1,headerRow:1,headerColumn:1,headerFacet:1},rW=B(yve),iW=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],vve={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},xve={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},qi="_vgsid_",bve={point:{on:"click",fields:[qi],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function dT(e){return e==="legend"||!!(e!=null&&e.legend)}function Hb(e){return dT(e)&&J(e)}function hT(e){return!!(e!=null&&e.select)}function oW(e){const t=[];for(const n of e||[]){if(hT(n))continue;const{expr:r,bind:i,...o}=n;if(i&&r){const s={...o,bind:i,init:r};t.push(s)}else{const s={...o,...r?{update:r}:{},...i?{bind:i}:{}};t.push(s)}}return t}function wve(e){return jx(e)||gT(e)||pT(e)}function pT(e){return"concat"in e}function jx(e){return"vconcat"in e}function gT(e){return"hconcat"in e}function sW({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function Fo(e){return J(e)&&e.step!==void 0}function xD(e){return e.view||e.width||e.height}const bD=20,Eve={align:1,bounds:1,center:1,columns:1,spacing:1},Sve=B(Eve);function _ve(e,t,n){const r=n[t],i={},{spacing:o,columns:s}=r;o!==void 0&&(i.spacing=o),s!==void 0&&(Rx(e)&&!Pg(e.facet)||pT(e))&&(i.columns=s),jx(e)&&(i.columns=1);for(const a of Sve)if(e[a]!==void 0)if(a==="spacing"){const u=e[a];i[a]=Te(u)?u:{row:u.row??o,column:u.column??o}}else i[a]=e[a];return i}function n_(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function Cy(e,t){const n=Ay(e,t);return Fo(n)?n.step:aW}function Ay(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return vt(n,{step:e.step})}const aW=20,kve={continuousWidth:200,continuousHeight:200,step:aW},$ve={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:kve,mark:vye,arc:{},area:{},bar:wye,circle:{},geoshape:{},image:{},line:{},point:{},rect:Eye,rule:{color:"black"},square:{},text:{color:"black"},tick:Sye,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:eye,projection:{},legend:vve,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:bve,style:{},title:{},facet:{spacing:bD},concat:{spacing:bD},normalizedNumberFormat:".0%"},Go=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],wD={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},ED={blue:Go[0],orange:Go[1],red:Go[2],teal:Go[3],green:Go[4],yellow:Go[5],purple:Go[6],pink:Go[7],brown:Go[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Cve(e={}){return{signals:[{name:"color",value:J(e)?{...ED,...e}:ED}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Ave(e){return{signals:[{name:"fontSize",value:J(e)?{...wD,...e}:wD}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Tve(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function uW(e){const t=B(e||{}),n={};for(const r of t){const i=e[r];n[r]=Ig(i)?zj(i):Er(i)}return n}function Fve(e){const t=B(e),n={};for(const r of t)n[r]=uW(e[r]);return n}const Mve=[...xU,...BU,...rW,"background","padding","legend","lineBreak","scale","style","title","view"];function lW(e={}){const{color:t,font:n,fontSize:r,selection:i,...o}=e,s=Uf({},fe($ve),n?Tve(n):{},t?Cve(t):{},r?Ave(r):{},o||{});i&&Wf(s,"selection",i,!0);const a=ar(s,Mve);for(const u of["background","lineBreak","padding"])s[u]&&(a[u]=Er(s[u]));for(const u of xU)s[u]&&(a[u]=er(s[u]));for(const u of BU)s[u]&&(a[u]=uW(s[u]));for(const u of rW)s[u]&&(a[u]=er(s[u]));return s.legend&&(a.legend=er(s.legend)),s.scale&&(a.scale=er(s.scale)),s.style&&(a.style=Fve(s.style)),s.title&&(a.title=er(s.title)),s.view&&(a.view=er(s.view)),a}const Nve=new Set(["view",...dye]),Ove=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Rve={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...yye};function Dve(e){e=fe(e);for(const t of Ove)delete e[t];if(e.axis)for(const t in e.axis)Ig(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of pve)delete e.legend[t];if(e.mark){for(const t of fD)delete e.mark[t];e.mark.tooltip&&J(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(oW(e.params)),delete e.params);for(const t of Nve){for(const r of fD)delete e[t][r];const n=Rve[t];if(n)for(const r of n)delete e[t][r];Lve(e,t)}for(const t of hve())delete e[t];Pve(e);for(const t in e)J(e[t])&&Ue(e[t])&&delete e[t];return Ue(e)?void 0:e}function Pve(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=Lj(e.title);Ue(t)||(e.style["group-title"]={...e.style["group-title"],...t}),Ue(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),Ue(r)?delete e.title:e.title=r}function Lve(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const o={...i,...e.style[n??t]};Ue(o)||(e.style[n??t]=o),r||delete e[t]}function Ux(e){return"layer"in e}function zve(e){return"repeat"in e}function Ive(e){return!I(e.repeat)&&e.repeat.layer}class mT{map(t,n){return Rx(t)?this.mapFacet(t,n):zve(t)?this.mapRepeat(t,n):gT(t)?this.mapHConcat(t,n):jx(t)?this.mapVConcat(t,n):pT(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(Ux(t))return this.mapLayer(t,n);if(Ds(t))return this.mapUnit(t,n);throw new Error(N3(t))}mapLayer(t,n){return{...t,layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(r=>this.map(r,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(r=>this.map(r,n))}}mapConcat(t,n){const{concat:r,...i}=t;return{...i,concat:r.map(o=>this.map(o,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const Bve={zero:1,center:1,normalize:1};function jve(e){return e in Bve}const Uve=new Set([mU,Fx,Tx,by,Nx,Y3,X3,Mx,yU,V3]),Wve=new Set([Fx,Tx,mU]);function sc(e){return W(e)&&Tf(e)==="quantitative"&&!e.bin}function SD(e,t,{orient:n,type:r}){const i=t==="x"?"y":"radius",o=t==="x"&&["bar","area"].includes(r),s=e[t],a=e[i];if(W(s)&&W(a))if(sc(s)&&sc(a)){if(s.stack)return t;if(a.stack)return i;const u=W(s)&&!!s.aggregate,l=W(a)&&!!a.aggregate;if(u!==l)return u?t:i;if(o){if(n==="vertical")return i;if(n==="horizontal")return t}}else{if(sc(s))return t;if(sc(a))return i}else{if(sc(s))return o&&n==="vertical"?void 0:t;if(sc(a))return o&&n==="horizontal"?void 0:i}}function qve(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function cW(e,t){var g,m;const n=Ao(e)?e:{type:e},r=n.type;if(!Uve.has(r))return null;const i=SD(t,"x",n)||SD(t,"theta",n);if(!i)return null;const o=t[i],s=W(o)?Y(o,{}):void 0,a=qve(i),u=[],l=new Set;if(t[a]){const y=t[a],v=W(y)?Y(y,{}):void 0;v&&v!==s&&(u.push(a),l.add(v))}const c=a==="x"?"xOffset":"yOffset",f=t[c],d=W(f)?Y(f,{}):void 0;d&&d!==s&&(u.push(c),l.add(d));const h=r0e.reduce((y,v)=>{if(v!=="tooltip"&&Ju(t,v)){const x=t[v];for(const b of Q(x)){const w=To(b);if(w.aggregate)continue;const S=Y(w,{});(!S||!l.has(S))&&y.push({channel:v,fieldDef:w})}}return y},[]);let p;return o.stack!==void 0?Qa(o.stack)?p=o.stack?"zero":null:p=o.stack:Wve.has(r)&&(p="zero"),!p||!jve(p)||oT(t)&&h.length===0?null:(g=o==null?void 0:o.scale)!=null&&g.type&&((m=o==null?void 0:o.scale)==null?void 0:m.type)!==ur.LINEAR?(o!=null&&o.stack&&U(v1e(o.scale.type)),null):de(t[Bo(i)])?(o.stack!==void 0&&U(y1e(i)),null):(W(o)&&o.aggregate&&!g0e.has(o.aggregate)&&U(x1e(o.aggregate)),{groupbyChannels:u,groupbyFields:l,fieldChannel:i,impute:o.impute===null?!1:cu(r),stackBy:h,offset:p})}function fW(e,t,n){const r=er(e),i=De("orient",r,n);if(r.orient=Yve(r.type,t,i),i!==void 0&&i!==r.orient&&U(t1e(r.orient,i)),r.type==="bar"&&r.orient){const u=De("cornerRadiusEnd",r,n);if(u!==void 0){const l=r.orient==="horizontal"&&t.x2||r.orient==="vertical"&&t.y2?["cornerRadius"]:bye[r.orient];for(const c of l)r[c]=u;r.cornerRadiusEnd!==void 0&&delete r.cornerRadiusEnd}}const o=De("opacity",r,n),s=De("fillOpacity",r,n);return o===void 0&&s===void 0&&(r.opacity=Gve(r.type,t)),De("cursor",r,n)===void 0&&(r.cursor=Hve(r,t,n)),r}function Hve(e,t,n){return t.href||e.href||De("href",e,n)?"pointer":e.cursor}function Gve(e,t){if(Se([Nx,V3,Y3,X3],e)&&!oT(t))return .7}function Vve(e,t,{graticule:n}){if(n)return!1;const r=$s("filled",e,t),i=e.type;return vt(r,i!==Nx&&i!==Mx&&i!==by)}function Yve(e,t,n){switch(e){case Nx:case Y3:case X3:case yU:case cye:case lye:return}const{x:r,y:i,x2:o,y2:s}=t;switch(e){case Fx:if(W(r)&&(Xt(r.bin)||W(i)&&i.aggregate&&!r.aggregate))return"vertical";if(W(i)&&(Xt(i.bin)||W(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o)return(W(r)&&r.type===El&&!Ye(r.bin)||Ey(r))&&W(i)&&Xt(i.bin)?"horizontal":"vertical";if(!s)return(W(i)&&i.type===El&&!Ye(i.bin)||Ey(i))&&W(r)&&Xt(r.bin)?"vertical":"horizontal"}case by:if(o&&!(W(r)&&Xt(r.bin))&&s&&!(W(i)&&Xt(i.bin)))return;case Tx:if(s)return W(i)&&Xt(i.bin)?"horizontal":"vertical";if(o)return W(r)&&Xt(r.bin)?"vertical":"horizontal";if(e===by){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case Mx:case V3:{const a=gD(r),u=gD(i);if(n)return n;if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u)return"vertical";{const l=qn(r)&&r.type===Cf,c=qn(i)&&i.type===Cf;if(l&&!c)return"vertical";if(!l&&c)return"horizontal"}return}}return"vertical"}function Xve(e){const{point:t,line:n,...r}=e;return B(r).length>1?r:r.type}function Qve(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:ar(e[t],["point","line"])});return e}function Gb(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?J(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?J(t.point)?t.point:{}:void 0}function _D(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Kve{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Ds(t)){const{mark:r,encoding:i}=t,o=Ao(r)?r:{type:r};switch(o.type){case"line":case"rule":case"trail":return!!Gb(o,n[o.type],i);case"area":return!!Gb(o,n[o.type],i)||!!_D(o,n[o.type])}}return!1}run(t,n,r){const{config:i}=n,{params:o,projection:s,mark:a,name:u,encoding:l,...c}=t,f=Bx(l,i),d=Ao(a)?a:{type:a},h=Gb(d,i[d.type],f),p=d.type==="area"&&_D(d,i[d.type]),g=[{name:u,...o?{params:o}:{},mark:Xve({...d.type==="area"&&d.opacity===void 0&&d.fillOpacity===void 0?{opacity:.7}:{},...d}),encoding:ar(f,["shape"])}],m=cW(fW(d,f,i),f);let y=f;if(m){const{fieldChannel:v,offset:x}=m;y={...f,[v]:{...f[v],...x?{stack:x}:{}}}}return y=ar(y,["y2","x2"]),p&&g.push({...s?{projection:s}:{},mark:{type:"line",...Sf(d,["clip","interpolate","tension","tooltip"]),...p},encoding:y}),h&&g.push({...s?{projection:s}:{},mark:{type:"point",opacity:1,filled:!0,...Sf(d,["clip","tooltip"]),...h},encoding:y}),r({...c,layer:g},{...n,config:Qve(i)})}}function Jve(e,t){return t?Pg(e)?hW(e,t):dW(e,t):e}function Vb(e,t){return t?hW(e,t):e}function r_(e,t,n){const r=t[e];if(Rye(r)){if(r.repeat in n)return{...t,[e]:n[r.repeat]};U(D0e(r.repeat));return}return t}function dW(e,t){if(e=r_("field",e,t),e!==void 0){if(e===null)return null;if(tT(e)&&xo(e.sort)){const n=r_("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function kD(e,t){if(W(e))return dW(e,t);{const n=r_("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function $D(e,t){if(de(e)){const n=kD(e,t);if(n)return n;if(Dx(e))return{condition:e.condition}}else{if(Lg(e)){const n=kD(e.condition,t);if(n)return{...e,condition:n};{const{condition:r,...i}=e;return i}}return e}}function hW(e,t){const n={};for(const r in e)if(ae(e,r)){const i=e[r];if(I(i))n[r]=i.map(o=>$D(o,t)).filter(o=>o);else{const o=$D(i,t);o!==void 0&&(n[r]=o)}}return n}class Zve{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Ds(t)){const{encoding:n,mark:r}=t;if(r==="line"||Ao(r)&&r.type==="line")for(const i of e0e){const o=Ul(i),s=n[o];if(n[i]&&(W(s)&&!Xt(s.bin)||Uo(s)))return!0}}return!1}run(t,n,r){const{encoding:i,mark:o}=t;return U(e1e(!!i.x2,!!i.y2)),r({...t,mark:J(o)?{...o,type:"rule"}:"rule"},n)}}class exe extends mT{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[nve,ove,dve,new Kve,new Zve]}map(t,n){if(Ds(t)){const r=Ju(t.encoding,ps),i=Ju(t.encoding,gs),o=Ju(t.encoding,xx);if(r||i||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,o=Vb(t.encoding,n.repeater),s={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(u=>u).join("_")}:{},...o?{encoding:o}:{}};if(r||i)return this.mapUnitWithParentEncodingOrProjection(s,n);const a=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(s,n.config))return u.run(s,n,a);return s}mapRepeat(t,n){return Ive(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i,...o}=t,{row:s,column:a,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return s||a?this.mapRepeat({...t,repeat:{...s?{row:s}:{},...a?{column:a}:{}},spec:{repeat:{layer:u},spec:i}},n):{...o,layer:u.map(f=>{const d={...l,layer:f},h=`${(i.name?`${i.name}_`:"")+c}child__layer_${nt(f)}`,p=this.mapLayerOrUnit(i,{...n,repeater:d,repeaterPrefix:h});return p.name=h,p})}}mapNonLayerRepeat(t,n){const{repeat:r,spec:i,data:o,...s}=t;!I(r)&&t.columns&&(t=ar(t,["columns"]),U(oD("repeat")));const a=[],{repeater:u={},repeaterPrefix:l=""}=n,c=!I(r)&&r.row||[u?u.row:null],f=!I(r)&&r.column||[u?u.column:null],d=I(r)&&r||[u?u.repeat:null];for(const p of d)for(const g of c)for(const m of f){const y={repeat:p,row:g,column:m,layer:u.layer},v=(i.name?`${i.name}_`:"")+l+"child__"+(I(r)?`${nt(p)}`:(r.row?`row_${nt(g)}`:"")+(r.column?`column_${nt(m)}`:"")),x=this.map(i,{...n,repeater:y,repeaterPrefix:v});x.name=v,a.push(ar(x,["data"]))}const h=I(r)?t.columns:r.column?r.column.length:1;return{data:i.data??o,align:"all",...s,columns:h,concat:a}}mapFacet(t,n){const{facet:r}=t;return Pg(r)&&t.columns&&(t=ar(t,["columns"]),U(oD("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:o,parentProjection:s,config:a}=n,u=AD({parentProjection:s,projection:i}),l=CD({parentEncoding:o,encoding:Vb(r,n.repeater)});return this.mapUnit({...t,...u?{projection:u}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(t,n){const{row:r,column:i,facet:o,...s}=t.encoding,{mark:a,width:u,projection:l,height:c,view:f,params:d,encoding:h,...p}=t,{facetMapping:g,layout:m}=this.getFacetMappingAndLayout({row:r,column:i,facet:o},n),y=Vb(s,n.repeater);return this.mapFacet({...p,...m,facet:g,spec:{...u?{width:u}:{},...c?{height:c}:{},...f?{view:f}:{},...l?{projection:l}:{},mark:a,encoding:y,...d?{params:d}:{}}},n)}getFacetMappingAndLayout(t,n){const{row:r,column:i,facet:o}=t;if(r||i){o&&U(J0e([...r?[ps]:[],...i?[gs]:[]]));const s={},a={};for(const u of[ps,gs]){const l=t[u];if(l){const{align:c,center:f,spacing:d,columns:h,...p}=l;s[u]=p;for(const g of["align","center","spacing"])l[g]!==void 0&&(a[g]??(a[g]={}),a[g][u]=l[g])}}return{facetMapping:s,layout:a}}else{const{align:s,center:a,spacing:u,columns:l,...c}=o;return{facetMapping:Jve(c,n.repeater),layout:{...s?{align:s}:{},...a?{center:a}:{},...u?{spacing:u}:{},...l?{columns:l}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:r,...i}){const{encoding:o,projection:s,...a}=t,u={...i,parentEncoding:CD({parentEncoding:n,encoding:o,layer:!0}),parentProjection:AD({parentProjection:r,projection:s})};return super.mapLayer({...a,...t.name?{name:[u.repeaterPrefix,t.name].filter(l=>l).join("_")}:{}},u)}}function CD({parentEncoding:e,encoding:t={},layer:n}){let r={};if(e){const i=new Set([...B(e),...B(t)]);for(const o of i){const s=t[o],a=e[o];if(de(s)){const u={...a,...s};r[o]=u}else Lg(s)?r[o]={...s,condition:{...a,...s.condition}}:s||s===null?r[o]=s:(n||Wi(a)||ne(a)||de(a)||I(a))&&(r[o]=a)}}else r=t;return!r||Ue(r)?void 0:r}function AD(e){const{parentProjection:t,projection:n}=e;return t&&n&&U(j0e({parentProjection:t,projection:n})),n??t}function yT(e){return"filter"in e}function txe(e){return(e==null?void 0:e.stop)!==void 0}function pW(e){return"lookup"in e}function nxe(e){return"data"in e}function rxe(e){return"param"in e}function ixe(e){return"pivot"in e}function oxe(e){return"density"in e}function sxe(e){return"quantile"in e}function axe(e){return"regression"in e}function uxe(e){return"loess"in e}function lxe(e){return"sample"in e}function cxe(e){return"window"in e}function fxe(e){return"joinaggregate"in e}function dxe(e){return"flatten"in e}function hxe(e){return"calculate"in e}function gW(e){return"bin"in e}function pxe(e){return"impute"in e}function gxe(e){return"timeUnit"in e}function mxe(e){return"aggregate"in e}function yxe(e){return"stack"in e}function vxe(e){return"fold"in e}function xxe(e){return"extent"in e&&!("density"in e)}function bxe(e){return e.map(t=>yT(t)?{filter:Uc(t.filter,V1e)}:t)}class wxe extends mT{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=TD(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=TD(t,n),t.encoding){const r={};for(const[i,o]of Ba(t.encoding))r[i]=mW(o,n);t={...t,encoding:r}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:r,...i}=t;return r?{...i,params:Ba(r).map(([o,s])=>{const{init:a,bind:u,empty:l,...c}=s;c.type==="single"?(c.type="point",c.toggle=!1):c.type==="multi"&&(c.type="point"),n.emptySelections[o]=l!=="none";for(const f of en(n.selectionPredicates[o]??{}))f.empty=l!=="none";return{name:o,value:a,select:c,bind:u}})}:t}}function TD(e,t){const{transform:n,...r}=e;if(n){const i=n.map(o=>{if(yT(o))return{filter:i_(o,t)};if(gW(o)&&Wl(o.bin))return{...o,bin:yW(o.bin)};if(pW(o)){const{selection:s,...a}=o.from;return s?{...o,from:{param:s,...a}}:o}return o});return{...r,transform:i}}return e}function mW(e,t){var r,i;const n=fe(e);if(W(n)&&Wl(n.bin)&&(n.bin=yW(n.bin)),Gl(n)&&((i=(r=n.scale)==null?void 0:r.domain)!=null&&i.selection)){const{selection:o,...s}=n.scale.domain;n.scale.domain={...s,...o?{param:o}:{}}}if(Dx(n))if(I(n.condition))n.condition=n.condition.map(o=>{const{selection:s,param:a,test:u,...l}=o;return a?o:{...l,test:i_(o,t)}});else{const{selection:o,param:s,test:a,...u}=mW(n.condition,t);n.condition=s?n.condition:{...u,test:i_(n.condition,t)}}return n}function yW(e){const t=e.extent;if(t!=null&&t.selection){const{selection:n,...r}=t;return{...e,extent:{...r,param:n}}}return e}function i_(e,t){const n=r=>Uc(r,i=>{var o;const s=t.emptySelections[i]??!0,a={param:i,empty:s};return(o=t.selectionPredicates)[i]??(o[i]=[]),t.selectionPredicates[i].push(a),a});return e.selection?n(e.selection):Uc(e.test||e.filter,r=>r.selection?n(r.selection):r)}class o_ extends mT{map(t,n){const r=n.selections??[];if(t.params&&!Ds(t)){const i=[];for(const o of t.params)hT(o)?r.push(o):i.push(o);t.params=i}return n.selections=r,super.map(t,n)}mapUnit(t,n){const r=n.selections;if(!r||!r.length)return t;const i=(n.path??[]).concat(t.name),o=[];for(const s of r)if(!s.views||!s.views.length)o.push(s);else for(const a of s.views)(K(a)&&(a===t.name||i.includes(a))||I(a)&&a.map(u=>i.indexOf(u)).every((u,l,c)=>u!==-1&&(l===0||u>c[l-1])))&&o.push(s);return o.length&&(t.params=o),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=o_.prototype[e];o_.prototype[e]=function(n,r){return t.call(this,n,Exe(n,r))}}function Exe(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function vW(e,t){t===void 0&&(t=lW(e.config));const n=$xe(e,t),{width:r,height:i}=e,o=Cxe(n,{width:r,height:i,autosize:e.autosize},t);return{...n,...o?{autosize:o}:{}}}const Sxe=new exe,_xe=new wxe,kxe=new o_;function $xe(e,t={}){const n={config:t};return kxe.map(Sxe.map(_xe.map(e,n),n),n)}function FD(e){return K(e)?{type:e}:e??{}}function Cxe(e,t,n){let{width:r,height:i}=t;const o=Ds(e)||Ux(e),s={};o?r=="container"&&i=="container"?(s.type="fit",s.contains="padding"):r=="container"?(s.type="fit-x",s.contains="padding"):i=="container"&&(s.type="fit-y",s.contains="padding"):(r=="container"&&(U(tD("width")),r=void 0),i=="container"&&(U(tD("height")),i=void 0));const a={type:"pad",...s,...n?FD(n.autosize):{},...FD(e.autosize)};if(a.type==="fit"&&!o&&(U(_0e),a.type="pad"),r=="container"&&!(a.type=="fit"||a.type=="fit-x")&&U(nD("width")),i=="container"&&!(a.type=="fit"||a.type=="fit-y")&&U(nD("height")),!$r(a,{type:"pad"}))return a}function Axe(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Txe(e){return e?`fit-${_x(e)}`:"fit"}const Fxe=["background","padding"];function MD(e,t){const n={};for(const r of Fxe)e&&e[r]!==void 0&&(n[r]=Er(e[r]));return t&&(n.params=e.params),n}class Ps{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Ps(fe(this.explicit),fe(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return vt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:r}){n!==void 0&&this.set(t,n,r)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:r}){n[t]!==void 0?this.set(t,n[t],!0):r[t]!==void 0&&this.set(t,r[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of B(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function so(e){return{explicit:!0,value:e}}function yr(e){return{explicit:!1,value:e}}function xW(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:Wx(t,n,r,i)}}function Wx(e,t,n,r){return e.explicit&&t.explicit&&U(c1e(n,r,e.value,t.value)),e}function Wa(e,t,n,r,i=Wx){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:$r(e.value,t.value)?e:i(e,t,n,r)}class Mxe extends Ps{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Nf(e){return"url"in e}function zp(e){return"values"in e}function bW(e){return"name"in e&&!Nf(e)&&!zp(e)&&!ka(e)}function ka(e){return e&&(wW(e)||EW(e)||vT(e))}function wW(e){return"sequence"in e}function EW(e){return"sphere"in e}function vT(e){return"graticule"in e}var Ge;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(Ge||(Ge={}));function SW(e){const{signals:t,hasLegend:n,index:r,...i}=e;return i.field=ui(i.field),i}function kl(e,t=!0,n=_n){if(I(e)){const r=e.map(i=>kl(i,t,n));return t?`[${r.join(", ")}]`:r}else if(ql(e))return n(t?wl(e):D1e(e));return t?n(We(e)):e}function Nxe(e,t){for(const n of en(e.component.selection??{})){const r=n.name;let i=`${r}${Ha}, ${n.resolve==="global"?"true":`{unit: ${Zu(e)}}`}`;for(const o of Vx)o.defined(n)&&(o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(i=o.modifyExpr(e,n,i)));t.push({name:r+c2e,on:[{events:{signal:n.name+Ha},update:`modify(${V(n.name+$l)}, ${i})`}]})}return xT(t)}function Oxe(e,t){if(e.component.selection&&B(e.component.selection).length){const n=V(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:nu("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return xT(t)}function Rxe(e,t){let n=!1;for(const r of en(e.component.selection??{})){const i=r.name,o=V(i+$l);if(t.filter(a=>a.name===i).length===0){const a=r.resolve==="global"?"union":r.resolve,u=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${jW}(${o}, ${V(a)}${u}`})}n=!0;for(const a of Vx)a.defined(r)&&a.topLevelSignals&&(t=a.topLevelSignals(e,r,t))}return n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),xT(t)}function Dxe(e,t){const n=[...t],r=Zu(e,{escape:!1});for(const i of en(e.component.selection??{})){const o={name:i.name+$l};if(i.project.hasSelectionId&&(o.transform=[{type:"collect",sort:{field:qi}}]),i.init){const a=i.project.items.map(SW);o.values=i.project.hasSelectionId?i.init.map(u=>({unit:r,[qi]:kl(u,!1)[0]})):i.init.map(u=>({unit:r,fields:a,values:kl(u,!1)}))}n.filter(a=>a.name===i.name+$l).length||n.push(o)}return n}function _W(e,t){for(const n of en(e.component.selection??{}))for(const r of Vx)r.defined(n)&&r.marks&&(t=r.marks(e,n,t));return t}function Pxe(e,t){for(const n of e.children)ht(n)&&(t=_W(n,t));return t}function Lxe(e,t,n,r){const i=GW(e,t.param,t);return{signal:Pr(n.get("type"))&&I(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}function xT(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class je{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){U(z0e);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this);const r=t.parent.removeChild(t);this._parent=n,n.addChild(this,r),t.parent=this}}class jn extends je{clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${bj()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}function Yb(e){return e.as!==void 0}function ND(e){return`${e}_end`}class bo extends je{clone(){return new bo(null,fe(this.timeUnits))}constructor(t,n){super(t),this.timeUnits=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,s)=>{const{field:a,timeUnit:u}=o;if(u){let l;if(Hl(u)){if(ht(n)){const{mark:c,markDef:f,config:d}=n,h=Ua({fieldDef:o,markDef:f,config:d});(Lp(c)||h)&&(l={timeUnit:Ut(u),field:a})}}else l={as:Y(o,{forAs:!0}),field:a,timeUnit:u};if(ht(n)){const{mark:c,markDef:f,config:d}=n,h=Ua({fieldDef:o,markDef:f,config:d});Lp(c)&&xt(s)&&h!==.5&&(l.rectBandPosition=h)}l&&(i[Ee(l)]=l)}return i},{});return Ue(r)?null:new bo(t,r)}static makeFromTransform(t,n){const{timeUnit:r,...i}={...n},o=Ut(r),s={...i,timeUnit:o};return new bo(t,{[Ee(s)]:s})}merge(t){this.timeUnits={...this.timeUnits};for(const n in t.timeUnits)this.timeUnits[n]||(this.timeUnits[n]=t.timeUnits[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[r,i]of Ba(this.timeUnits)){const o=Yb(i)?i.as:`${i.field}_end`;t.has(o)||(n[r]=i)}this.timeUnits=n}producedFields(){return new Set(en(this.timeUnits).map(t=>Yb(t)?t.as:ND(t.field)))}dependentFields(){return new Set(en(this.timeUnits).map(t=>t.field))}hash(){return`TimeUnit ${Ee(this.timeUnits)}`}assemble(){const t=[];for(const n of en(this.timeUnits)){const{rectBandPosition:r}=n,i=Ut(n.timeUnit);if(Yb(n)){const{field:o,as:s}=n,{unit:a,utc:u,...l}=i,c=[s,`${s}_end`];t.push({field:ui(o),type:"timeunit",...a?{units:Ax(a)}:{},...u?{timezone:"utc"}:{},...l,as:c}),t.push(...OD(c,r,i))}else if(n){const{field:o}=n,s=o.replaceAll("\\.","."),a=kW({timeUnit:i,field:s}),u=ND(s);t.push({type:"formula",expr:a,as:u}),t.push(...OD([s,u],r,i))}}return t}}const qx="offsetted_rect_start",Hx="offsetted_rect_end";function kW({timeUnit:e,field:t,reverse:n}){const{unit:r,utc:i}=e,o=nU(r),{part:s,step:a}=sU(o,e.step);return`${i?"utcOffset":"timeOffset"}('${s}', datum['${t}'], ${n?-a:a})`}function OD([e,t],n,r){if(n!==void 0&&n!==.5){const i=`datum['${e}']`,o=`datum['${t}']`;return[{type:"formula",expr:RD([kW({timeUnit:r,field:e,reverse:!0}),i],n+.5),as:`${e}_${qx}`},{type:"formula",expr:RD([i,o],n+.5),as:`${e}_${Hx}`}]}return[]}function RD([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`}const Bg="_tuple_fields";class zxe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const Ixe={defined:()=>!0,parse:(e,t,n)=>{const r=t.name,i=t.project??(t.project=new zxe),o={},s={},a=new Set,u=(p,g)=>{const m=g==="visual"?p.channel:p.field;let y=nt(`${r}_${m}`);for(let v=1;a.has(y);v++)y=nt(`${r}_${m}_${v}`);return a.add(y),{[g]:y}},l=t.type,c=e.config.selection[l],f=n.value!==void 0?Q(n.value):null;let{fields:d,encodings:h}=J(n.select)?n.select:{};if(!d&&!h&&f){for(const p of f)if(J(p))for(const g of B(p))Zme(g)?(h||(h=[])).push(g):l==="interval"?(U(R0e),h=c.encodings):(d??(d=[])).push(g)}!d&&!h&&(h=c.encodings,"fields"in c&&(d=c.fields));for(const p of h??[]){const g=e.fieldDef(p);if(g){let m=g.field;if(g.aggregate){U(k0e(p,g.aggregate));continue}else if(!m){U(iD(p));continue}if(g.timeUnit&&!Hl(g.timeUnit)){m=e.vgField(p);const y={timeUnit:g.timeUnit,as:m,field:g.field};s[Ee(y)]=y}if(!o[m]){const y=l==="interval"&&Rs(p)&&Pr(e.getScaleComponent(p).get("type"))?"R":g.bin?"R-RE":"E",v={field:m,channel:p,type:y,index:i.items.length};v.signals={...u(v,"data"),...u(v,"visual")},i.items.push(o[m]=v),i.hasField[m]=o[m],i.hasSelectionId=i.hasSelectionId||m===qi,$j(p)?(v.geoChannel=p,v.channel=kj(p),i.hasChannel[v.channel]=o[m]):i.hasChannel[p]=o[m]}}else U(iD(p))}for(const p of d??[]){if(i.hasField[p])continue;const g={type:"E",field:p,index:i.items.length};g.signals={...u(g,"data")},i.items.push(g),i.hasField[p]=g,i.hasSelectionId=i.hasSelectionId||p===qi}f&&(t.init=f.map(p=>i.items.map(g=>J(p)?p[g.geoChannel||g.channel]!==void 0?p[g.geoChannel||g.channel]:p[g.field]:p))),Ue(s)||(i.timeUnit=new bo(null,s))},signals:(e,t,n)=>{const r=t.name+Bg;return n.filter(o=>o.name===r).length>0||t.project.hasSelectionId?n:n.concat({name:r,value:t.project.items.map(SW)})}},ms={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!Rs(i))continue;const o=e.getScaleComponent(i),s=o?o.get("type"):void 0;if(s=="sequential"&&U(T0e),!o||!Pr(s)){U(A0e);continue}o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(s=>n.filter(a=>a.name===s.signals.data).length===0);if(!e.parent||DD(e)||r.length===0)return n;const i=n.filter(s=>s.name===t.name)[0];let o=i.update;if(o.indexOf(jW)>=0)i.update=`{${r.map(s=>`${V(ui(s.field))}: ${s.signals.data}`).join(", ")}}`;else{for(const s of r){const a=`${V(ui(s.field))}: ${s.signals.data}`;o.includes(a)||(o=`${o.substring(0,o.length-1)}, ${a}}`)}i.update=o}return n.concat(r.map(s=>({name:s.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!DD(e))for(const r of t.scales){const i=n.find(o=>o.name===r.signals.data);i.push="outer",delete i.value,delete i.update}return n}};function s_(e,t){return`domain(${V(e.scaleName(t))})`}function DD(e){return e.parent&&cd(e.parent)&&!e.parent.parent}const Hc="_brush",$W="_scale_trigger",Bd="geo_interval_init_tick",CW="_init",Bxe="_center",jxe={defined:e=>e.type==="interval",parse:(e,t,n)=>{var r;if(e.hasProjection){const i={...J(n.select)?n.select:{}};i.fields=[qi],i.encodings||(i.encodings=n.value?B(n.value):[Ki,Qi]),n.select={type:"interval",...i}}if(t.translate&&!ms.defined(t)){const i=`!event.item || event.item.mark.name !== ${V(t.name+Hc)}`;for(const o of t.events){if(!o.between){U(`${o} is not an ordered event stream for interval selections.`);continue}const s=Q((r=o.between[0]).filter??(r.filter=[]));s.indexOf(i)<0&&s.push(i)}}},signals:(e,t,n)=>{const r=t.name,i=r+Ha,o=en(t.project.hasChannel).filter(a=>a.channel===rt||a.channel===Ht),s=t.init?t.init[0]:null;if(n.push(...o.reduce((a,u)=>a.concat(Uxe(e,t,u,s&&s[u.index])),[])),e.hasProjection){const a=V(e.projectionName()),u=e.projectionName()+Bxe,{x:l,y:c}=t.project.hasChannel,f=l&&l.signals.visual,d=c&&c.signals.visual,h=l?s&&s[l.index]:`${u}[0]`,p=c?s&&s[c.index]:`${u}[1]`,g=w=>e.getSizeSignalRef(w).signal,m=`[[${f?f+"[0]":"0"}, ${d?d+"[0]":"0"}],[${f?f+"[1]":g("width")}, ${d?d+"[1]":g("height")}]]`;s&&(n.unshift({name:r+CW,init:`[scale(${a}, [${l?h[0]:h}, ${c?p[0]:p}]), scale(${a}, [${l?h[1]:h}, ${c?p[1]:p}])]`}),(!l||!c)&&(n.find(S=>S.name===u)||n.unshift({name:u,update:`invert(${a}, [${g("width")}/2, ${g("height")}/2])`})));const y=`intersect(${m}, {markname: ${V(e.getName("marks"))}}, unit.mark)`,v=`{unit: ${Zu(e)}}`,x=`vlSelectionTuples(${y}, ${v})`,b=o.map(w=>w.signals.visual);return n.concat({name:i,on:[{events:[...b.length?[{signal:b.join(" || ")}]:[],...s?[{signal:Bd}]:[]],update:x}]})}else{if(!ms.defined(t)){const l=r+$W,c=o.map(f=>{const d=f.channel,{data:h,visual:p}=f.signals,g=V(e.scaleName(d)),m=e.getScaleComponent(d).get("type"),y=Pr(m)?"+":"";return`(!isArray(${h}) || (${y}invert(${g}, ${p})[0] === ${y}${h}[0] && ${y}invert(${g}, ${p})[1] === ${y}${h}[1]))`});c.length&&n.push({name:l,value:{},on:[{events:o.map(f=>({scale:e.scaleName(f.channel)})),update:c.join(" && ")+` ? ${l} : {}`}]})}const a=o.map(l=>l.signals.data),u=`unit: ${Zu(e)}, fields: ${r+Bg}, values`;return n.concat({name:i,...s?{init:`{${u}: ${kl(s)}}`}:{},...a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${u}: [${a}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(ht(e)&&e.hasProjection&&t.init&&(n.filter(i=>i.name===Bd).length||n.unshift({name:Bd,value:null,on:[{events:"timer{1}",update:`${Bd} === null ? {} : ${Bd}`}]})),n),marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,s=i==null?void 0:i.signals.visual,a=o==null?void 0:o.signals.visual,u=`data(${V(t.name+$l)})`;if(ms.defined(t)||!i&&!o)return n;const l={x:i!==void 0?{signal:`${s}[0]`}:{value:0},y:o!==void 0?{signal:`${a}[0]`}:{value:0},x2:i!==void 0?{signal:`${s}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of B(l))l[m]=[{test:`${u}.length && ${u}[0].unit === ${Zu(e)}`,...l[m]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=t.mark,p=B(h).reduce((m,y)=>(m[y]=[{test:[i!==void 0&&`${s}[0] !== ${s}[1]`,o!==void 0&&`${a}[0] !== ${a}[1]`].filter(v=>v).join(" && "),value:h[y]},{value:null}],m),{}),g=d??(t.translate?"move":null);return[{name:`${r+Hc}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:l}},...n,{name:r+Hc,type:"rect",clip:!0,encode:{enter:{...g?{cursor:{value:g}}:{},fill:{value:"transparent"}},update:{...l,...p}}}]}};function Uxe(e,t,n,r){const i=!e.hasProjection,o=n.channel,s=n.signals.visual,a=V(i?e.scaleName(o):e.projectionName()),u=d=>`scale(${a}, ${d})`,l=e.getSizeSignalRef(o===rt?"width":"height").signal,c=`${o}(unit)`,f=t.events.reduce((d,h)=>[...d,{events:h.between[0],update:`[${c}, ${c}]`},{events:h,update:`[${s}[0], clamp(${c}, 0, ${l})]`}],[]);if(i){const d=n.signals.data,h=ms.defined(t),p=e.getScaleComponent(o),g=p?p.get("type"):void 0,m=r?{init:kl(r,!0,u)}:{value:[]};return f.push({events:{signal:t.name+$W},update:Pr(g)?`[${u(`${d}[0]`)}, ${u(`${d}[1]`)}]`:"[0, 0]"}),h?[{name:d,on:[]}]:[{name:s,...m,on:f},{name:d,...r?{init:kl(r)}:{},on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${a}, ${s})`}]}]}else{const d=o===rt?0:1,h=t.name+CW,p=r?{init:`[${h}[0][${d}], ${h}[1][${d}]]`}:{value:[]};return[{name:s,...p,on:f}]}}const Wxe={defined:e=>e.type==="point",signals:(e,t,n)=>{const r=t.name,i=r+Bg,o=t.project,s="(item().isVoronoi ? datum.datum : datum)",a=en(e.component.selection??{}).reduce((f,d)=>d.type==="interval"?f.concat(d.name+Hc):f,[]).map(f=>`indexof(item().mark.name, '${f}') < 0`).join(" && "),u=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${a?` && ${a}`:""}`;let l=`unit: ${Zu(e)}, `;if(t.project.hasSelectionId)l+=`${qi}: ${s}[${V(qi)}]`;else{const f=o.items.map(d=>{const h=e.fieldDef(d.channel);return h!=null&&h.bin?`[${s}[${V(e.vgField(d.channel,{}))}], ${s}[${V(e.vgField(d.channel,{binSuffix:"end"}))}]]`:`${s}[${V(d.field)}]`}).join(", ");l+=`fields: ${i}, values: [${f}]`}const c=t.events;return n.concat([{name:r+Ha,on:c?[{events:c,update:`${u} ? {${l}} : null`,force:!0}]:[]}])}};function sd(e,t,n,r){const i=Dx(t)&&t.condition,o=r(t);if(i){const a=Q(i).map(u=>{const l=r(u);if(Oye(u)){const{param:c,empty:f}=u;return{test:HW(e,{param:c,empty:f}),...l}}else return{test:My(e,u.test),...l}});return{[n]:[...a,...o!==void 0?[o]:[]]}}else return o!==void 0?{[n]:o}:{}}function bT(e,t="text"){const n=e.encoding[t];return sd(e,n,t,r=>Gx(r,e.config))}function Gx(e,t,n="datum"){if(e){if(Wi(e))return Je(e.value);if(de(e)){const{format:r,formatType:i}=_y(e);return Z3({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function AW(e,t={}){const{encoding:n,markDef:r,config:i,stack:o}=e,s=n.tooltip;if(I(s))return{tooltip:PD({tooltip:s},o,i,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return sd(e,s,"tooltip",u=>{const l=Gx(u,i,a);if(l)return l;if(u===null)return;let c=De("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),K(c))return{value:c};if(J(c))return ne(c)?c:c.content==="encoding"?PD(n,o,i,t):{signal:a}})}}function TW(e,t,n,{reactiveGeom:r}={}){const i={...n,...n.tooltipFormat},o={},s=r?"datum.datum":"datum",a=[];function u(c,f){const d=Ul(f),h=qn(c)?c:{...c,type:e[d].type},p=h.title||rT(h,i),g=Q(p).join(", ").replaceAll(/"/g,'\\"');let m;if(xt(f)){const y=f==="x"?"x2":"y2",v=To(e[y]);if(Xt(h.bin)&&v){const x=Y(h,{expr:s}),b=Y(v,{expr:s}),{format:w,formatType:S}=_y(h);m=Dg(x,b,w,S,i),o[y]=!0}}if((xt(f)||f===fi||f===Xi)&&t&&t.fieldChannel===f&&t.offset==="normalize"){const{format:y,formatType:v}=_y(h);m=Z3({fieldOrDatumDef:h,format:y,formatType:v,expr:s,config:i,normalizeStack:!0}).signal}m??(m=Gx(h,i,s).signal),a.push({channel:f,key:g,value:m})}sT(e,(c,f)=>{W(c)?u(c,f):Px(c)&&u(c.condition,f)});const l={};for(const{channel:c,key:f,value:d}of a)!o[c]&&!l[f]&&(l[f]=d);return l}function PD(e,t,n,{reactiveGeom:r}={}){const i=TW(e,t,n,{reactiveGeom:r}),o=Ba(i).map(([s,a])=>`"${s}": ${a}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function qxe(e){const{markDef:t,config:n}=e,r=De("aria",t,n);return r===!1?{}:{...r?{aria:r}:{},...Hxe(e),...Gxe(e)}}function Hxe(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=De("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in w0e?{}:{ariaRoleDescription:{value:t}}}function Gxe(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return sd(e,o,"description",u=>Gx(u,e.config));const s=De("description",n,r);if(s!=null)return{description:Je(s)};if(r.aria===!1)return{};const a=TW(t,i,r);if(!Ue(a))return{description:{signal:Ba(a).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function Dt(e,t,n={}){const{markDef:r,encoding:i,config:o}=t,{vgChannel:s}=n;let{defaultRef:a,defaultValue:u}=n;a===void 0&&(u??(u=De(e,r,o,{vgChannel:s,ignoreVgConfig:!0})),u!==void 0&&(a=Je(u)));const l=i[e];return sd(t,l,s??e,c=>J3({channel:e,channelDef:c,markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function FW(e,t={filled:void 0}){const{markDef:n,encoding:r,config:i}=e,{type:o}=n,s=t.filled??De("filled",n,i),a=Se(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,u=De(s===!0?"color":void 0,n,i,{vgChannel:"fill"})??i.mark[s===!0&&"color"]??a,l=De(s===!1?"color":void 0,n,i,{vgChannel:"stroke"})??i.mark[s===!1&&"color"],c=s?"fill":"stroke",f={...u?{fill:Je(u)}:{},...l?{stroke:Je(l)}:{}};return n.color&&(s?n.fill:n.stroke)&&U(Vj("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...Dt("color",e,{vgChannel:c,defaultValue:s?u:l}),...Dt("fill",e,{defaultValue:r.fill?u:void 0}),...Dt("stroke",e,{defaultValue:r.stroke?l:void 0})}}function Vxe(e){const{encoding:t,mark:n}=e,r=t.order;return!cu(n)&&Wi(r)?sd(e,r,"zindex",i=>Je(i.value)):{}}function Of({channel:e,markDef:t,encoding:n={},model:r,bandPosition:i}){const o=`${e}Offset`,s=t[o],a=n[o];if((o==="xOffset"||o==="yOffset")&&a)return{offsetType:"encoding",offset:J3({channel:o,channelDef:a,markDef:t,config:r==null?void 0:r.config,scaleName:r.scaleName(o),scale:r.getScaleComponent(o),stack:null,defaultRef:Je(s),bandPosition:i})};const u=t[o];return u?{offsetType:"visual",offset:u}:{}}function yn(e,t,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:o,config:s,stack:a}=t,u=i[e],l=i[Bo(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:h}=Of({channel:e,markDef:o,encoding:i,model:t,bandPosition:.5}),p=wT({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!u&&xt(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:Yxe({channel:e,channelDef:u,channel2Def:l,markDef:o,config:s,scaleName:c,scale:f,stack:a,offset:d,defaultRef:p,bandPosition:h==="encoding"?0:void 0});return g?{[r||e]:g}:void 0}function Yxe(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:s}=e;if(de(n)&&i&&t===i.fieldChannel){if(W(n)){let a=n.bandPosition;if(a===void 0&&s.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return wy({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:o})}return Ku(n,r,{suffix:"end"},{offset:o})}return Q3(e)}function wT({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:o,config:s}=e;return()=>{const a=Ul(n),u=ja(n),l=De(n,o,s,{vgChannel:u});if(l!==void 0)return Wh(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!Se([ur.LOG,ur.TIME,ur.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return a==="y"?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":return{...e[pr(n)],mult:.5}}}}const Xxe={left:"x",center:"xc",right:"x2"},Qxe={top:"y",middle:"yc",bottom:"y2"};function MW(e,t,n,r="middle"){if(e==="radius"||e==="theta")return ja(e);const i=e==="x"?"align":"baseline",o=De(i,t,n);let s;return ne(o)?(U(Z0e(i)),s=void 0):s=o,e==="x"?Xxe[s||(r==="top"?"left":"center")]:Qxe[s||r]}function Ty(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?NW(e,t,{defaultPos:n,defaultPos2:r}):yn(e,t,{defaultPos:n})}function NW(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=t,s=Bo(e),a=pr(e),u=Kxe(t,r,s),l=u[a]?MW(e,i,o):ja(e);return{...yn(e,t,{defaultPos:n,vgChannel:l}),...u}}function Kxe(e,t,n){const{encoding:r,mark:i,markDef:o,stack:s,config:a}=e,u=Ul(n),l=pr(n),c=ja(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),{offset:p}=n in r||n in o?Of({channel:n,markDef:o,encoding:r,model:e}):Of({channel:u,markDef:o,encoding:r,model:e});if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude)){const m=pr(n),y=e.markDef[m];return y!=null?{[m]:{value:y}}:{[c]:{field:e.getName(n)}}}const g=Jxe({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:a,scaleName:d,scale:h,stack:s,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:Lm(n,o)||Lm(n,{[n]:vy(n,o,a.style),[l]:vy(l,o,a.style)})||Lm(n,a[i])||Lm(n,a.mark)||{[c]:wT({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function Jxe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l}){return de(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Ku(t,o,{suffix:"start"},{offset:u}):Q3({channel:e,channelDef:n,scaleName:o,scale:s,stack:a,markDef:r,config:i,offset:u,defaultRef:l})}function Lm(e,t){const n=pr(e),r=ja(e);if(t[r]!==void 0)return{[r]:Wh(e,t[r])};if(t[e]!==void 0)return{[r]:Wh(e,t[e])};if(t[n]){const i=t[n];if(Sl(i))U(V0e(n));else return{[n]:Wh(e,i)}}}function qa(e,t){const{config:n,encoding:r,markDef:i}=e,o=i.type,s=Bo(t),a=pr(t),u=r[t],l=r[s],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=i.orient,h=r[a]??r.size??De("size",i,n,{vgChannel:a}),p=Fj(t),g=o==="bar"&&(t==="x"?d==="vertical":d==="horizontal");return W(u)&&(Ye(u.bin)||Xt(u.bin)||u.timeUnit&&!l)&&!(h&&!Sl(h))&&!r[p]&&!Wt(f)?t2e({fieldDef:u,fieldDef2:l,channel:t,model:e}):(de(u)&&Wt(f)||g)&&!l?e2e(u,t,e):NW(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Zxe(e,t,n,r,i,o,s){if(Sl(i))if(n){const u=n.get("type");if(u==="band"){let l=`bandwidth('${t}')`;i.band!==1&&(l=`${i.band} * ${l}`);const c=$s("minBandSize",{type:s},r);return{signal:c?`max(${Ni(c)}, ${l})`:l}}else i.band!==1&&(U(r1e(u)),i=void 0)}else return{mult:i.band,field:{group:e}};else{if(ne(i))return i;if(i)return{value:i}}if(n){const u=n.get("range");if(lu(u)&&Te(u.step))return{value:u.step-2}}if(!o){const{bandPaddingInner:u,barBandPaddingInner:l,rectBandPaddingInner:c}=r.scale,f=vt(u,s==="bar"?l:c);if(ne(f))return{signal:`(1 - (${f.signal})) * ${e}`};if(Te(f))return{signal:`${1-f} * ${e}`}}return{value:Cy(r.view,e)-2}}function e2e(e,t,n){var k,$;const{markDef:r,encoding:i,config:o,stack:s}=n,a=r.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=pr(t),f=Bo(t),d=Fj(t),h=n.scaleName(d),p=n.getScaleComponent(C3(t)),g=a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let m;(i.size||r.size)&&(g?m=Dt("size",n,{vgChannel:c,defaultRef:Je(r.size)}):U(a1e(r.type)));const y=!!m,v=AU({channel:t,fieldDef:e,markDef:r,config:o,scaleType:(k=l||p)==null?void 0:k.get("type"),useVlSizeChannel:g});m=m||{[c]:Zxe(c,h||u,p||l,o,v,!!e,r.type)};const x=(($=l||p)==null?void 0:$.get("type"))==="band"&&Sl(v)&&!y?"top":"middle",b=MW(t,r,o,x),w=b==="xc"||b==="yc",{offset:S,offsetType:E}=Of({channel:t,markDef:r,encoding:i,model:n,bandPosition:w?.5:0}),_=Q3({channel:t,channelDef:e,markDef:r,config:o,scaleName:u,scale:l,stack:s,offset:S,defaultRef:wT({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:w?E==="encoding"?0:.5:ne(v)?{signal:`(1-${v})/2`}:Sl(v)?(1-v.band)/2:0});if(c)return{[b]:_,...m};{const C=ja(f),R=m[c],A=S?{...R,offset:S}:R;return{[b]:_,[C]:I(_)?[_[0],{..._[1],offset:A}]:{..._,offset:A}}}}function LD(e,t,n,r,i,o,s){if(_j(e))return 0;const a=e==="x"||e==="y2",u=a?-t/2:t/2;if(ne(n)||ne(i)||ne(r)||o){const l=Ni(n),c=Ni(i),f=Ni(r),d=Ni(o),p=o?`(${s} < ${d} ? ${a?"":"-"}0.5 * (${d} - (${s})) : ${u})`:u,g=f?`${f} + `:"",m=l?`(${l} ? -1 : 1) * `:"",y=c?`(${c} + ${p})`:p;return{signal:g+m+y}}else return i=i||0,r+(n?-i-u:+i+u)}function t2e({fieldDef:e,fieldDef2:t,channel:n,model:r}){var $;const{config:i,markDef:o,encoding:s}=r,a=r.getScaleComponent(n),u=r.scaleName(n),l=a?a.get("type"):void 0,c=a.get("reverse"),f=AU({channel:n,fieldDef:e,markDef:o,config:i,scaleType:l}),d=($=r.component.axes[n])==null?void 0:$[0],h=(d==null?void 0:d.get("translate"))??.5,p=xt(n)?De("binSpacing",o,i)??0:0,g=Bo(n),m=ja(n),y=ja(g),v=$s("minBandSize",o,i),{offset:x}=Of({channel:n,markDef:o,encoding:s,model:r,bandPosition:0}),{offset:b}=Of({channel:g,markDef:o,encoding:s,model:r,bandPosition:0}),w=Aye({fieldDef:e,scaleName:u}),S=LD(n,p,c,h,x,v,w),E=LD(g,p,c,h,b??x,v,w),_=ne(f)?{signal:`(1-${f.signal})/2`}:Sl(f)?(1-f.band)/2:.5,k=Ua({fieldDef:e,fieldDef2:t,markDef:o,config:i});if(Ye(e.bin)||e.timeUnit){const C=e.timeUnit&&k!==.5;return{[y]:zD({fieldDef:e,scaleName:u,bandPosition:_,offset:E,useRectOffsetField:C}),[m]:zD({fieldDef:e,scaleName:u,bandPosition:ne(_)?{signal:`1-${_.signal}`}:1-_,offset:S,useRectOffsetField:C})}}else if(Xt(e.bin)){const C=Ku(e,u,{},{offset:E});if(W(t))return{[y]:C,[m]:Ku(t,u,{},{offset:S})};if(Wl(e.bin)&&e.bin.step)return{[y]:C,[m]:{signal:`scale("${u}", ${Y(e,{expr:"datum"})} + ${e.bin.step})`,offset:S}}}U(Qj(g))}function zD({fieldDef:e,scaleName:t,bandPosition:n,offset:r,useRectOffsetField:i}){return wy({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:r,...i?{startSuffix:qx,endSuffix:Hx}:{}})}const n2e=new Set(["aria","width","height"]);function di(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?FW(e):{};return{...r2e(e.markDef,t),...ID(e,"fill",n),...ID(e,"stroke",r),...Dt("opacity",e),...Dt("fillOpacity",e),...Dt("strokeOpacity",e),...Dt("strokeWidth",e),...Dt("strokeDash",e),...Vxe(e),...AW(e),...bT(e,"href"),...qxe(e)}}function ID(e,t,n){const{config:r,mark:i,markDef:o}=e;if(De("invalid",o,r)==="hide"&&n&&!cu(i)){const a=i2e(e,{invalid:!0,channels:kx});if(a)return{[t]:[{test:a,value:null},...Q(n)]}}return n?{[t]:n}:{}}function r2e(e,t){return b0e.reduce((n,r)=>(!n2e.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=Je(e[r])),n),{})}function i2e(e,{invalid:t=!1,channels:n}){const r=n.reduce((o,s)=>{const a=e.getScaleComponent(s);if(a){const u=a.get("type"),l=e.vgField(s,{expr:"datum"});l&&Pr(u)&&(o[l]=!0)}return o},{}),i=B(r);if(i.length>0){const o=t?"||":"&&";return i.map(s=>K3(s,t)).join(` ${o} `)}}function ET(e){const{config:t,markDef:n}=e;if(De("invalid",n,t)){const i=o2e(e,{channels:jo});if(i)return{defined:{signal:i}}}return{}}function o2e(e,{invalid:t=!1,channels:n}){const r=n.reduce((o,s)=>{var u;const a=e.getScaleComponent(s);if(a){const l=a.get("type"),c=e.vgField(s,{expr:"datum",binSuffix:(u=e.stack)!=null&&u.impute?"mid":void 0});c&&Pr(l)&&(o[c]=!0)}return o},{}),i=B(r);if(i.length>0){const o=t?"||":"&&";return i.map(s=>K3(s,t)).join(` ${o} `)}}function BD(e,t){if(t!==void 0)return{[e]:Je(t)}}const Xb="voronoi",OW={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(Xb)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(cu(o))return U($0e(o)),n;const s={name:e.getName(Xb),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...AW(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{const f=l.name??"";f===e.component.mark[0].name?a=c:f.indexOf(Xb)>=0&&(u=!0)}),u||n.splice(a+1,0,s),n}},RW={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!dT(e.bind),parse:(e,t,n)=>UW(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,s=t.init&&t.init[0],a=OW.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{const c=nt(`${r}_${u.field}`);n.filter(d=>d.name===c).length||n.unshift({name:c,...s?{init:kl(s[l])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${V(u.field)}] : null`}]:[],bind:o[u.field]??o[u.channel]??o})}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.filter(l=>l.name===r+Ha)[0],s=r+Bg,a=i.items.map(l=>nt(`${r}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(o.update=`${u} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}},Fy="_toggle",DW={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+Fy,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Ha,r=t.name+Fy;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${Zu(e)}}, `)+`${r} ? ${n} : null`}},s2e={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=K(t.clear)?nu(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(RW.defined(t))for(const r of t.project.items){const i=n.findIndex(o=>o.name===nt(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,o){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:o})}if(t.type==="interval")for(const i of t.project.items){const o=n.findIndex(s=>s.name===i.signals.visual);if(r(o,"[0, 0]"),o===-1){const s=n.findIndex(a=>a.name===i.signals.data);r(s,"null")}}else{let i=n.findIndex(o=>o.name===t.name+Ha);r(i,"null"),DW.defined(t)&&(i=n.findIndex(o=>o.name===t.name+Fy),r(i,"false"))}return n}},PW={defined:e=>{const t=e.resolve==="global"&&e.bind&&dT(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==qi;return t&&!n&&U(F0e),t&&n},parse:(e,t,n)=>{const r=fe(n);if(r.select=K(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},UW(t,r),J(n.select)&&(n.select.on||n.select.clear)){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const a of t.events)a.filter=Q(a.filter??[]),a.filter.includes(s)||a.filter.push(s)}const i=Hb(t.bind)?t.bind.legend:"click",o=K(i)?nu(i,"view"):Q(i);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=Hb(t.bind)&&t.bind.legend,o=s=>a=>{const u=fe(a);return u.markname=s,u};for(const s of t.project.items){if(!s.hasLegend)continue;const a=`${nt(s.field)}_legend`,u=`${r}_${a}`;if(n.filter(c=>c.name===u).length===0){const c=i.merge.map(o(`${a}_symbols`)).concat(i.merge.map(o(`${a}_labels`))).concat(i.merge.map(o(`${a}_entries`)));n.unshift({name:u,...t.init?{}:{value:null},on:[{events:c,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]})}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find(d=>d.name===r+Ha),s=r+Bg,a=i.items.filter(d=>d.hasLegend).map(d=>nt(`${r}_${nt(d.field)}_legend`)),l=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?o.on.push({events:a.map(d=>({signal:d})),update:l}):a.length>0&&(o.update=l,delete o.value,delete o.on);const c=n.find(d=>d.name===r+Fy),f=Hb(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push({...c.on[0],events:f}):c.on[0].events=f),n}};function a2e(e,t,n){var i;const r=(i=e.fieldDef(t))==null?void 0:i.field;for(const o of en(e.component.selection??{})){const s=o.project.hasField[r]??o.project.hasChannel[t];if(s&&PW.defined(o)){const a=n.get("selections")??[];a.push(o.name),n.set("selections",a,!1),s.hasLegend=!0}}}const LW="_translate_anchor",zW="_translate_delta",u2e={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=ms.defined(t),o=r+LW,{x:s,y:a}=t.project.hasChannel;let u=nu(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+Hc,l))),n.push({name:o,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(s!==void 0?`, extent_x: ${i?s_(e,rt):`slice(${s.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${i?s_(e,Ht):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:r+zW,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),s!==void 0&&jD(e,t,s,"width",n),a!==void 0&&jD(e,t,a,"height",n),n}};function jD(e,t,n,r,i){const o=t.name,s=o+LW,a=o+zW,u=n.channel,l=ms.defined(t),c=i.filter(w=>w.name===n.signals[l?"data":"visual"])[0],f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(u),h=d&&d.get("type"),p=d&&d.get("reverse"),g=l?u===rt?p?"":"-":p?"-":"":"",m=`${s}.extent_${u}`,y=`${g}${a}.${u} / ${l?`${f}`:`span(${m})`}`,v=!l||!d?"panLinear":h==="log"?"panLog":h==="symlog"?"panSymlog":h==="pow"?"panPow":"panLinear",x=l?h==="pow"?`, ${d.get("exponent")??1}`:h==="symlog"?`, ${d.get("constant")??1}`:"":"",b=`${v}(${m}, ${y}${x})`;c.on.push({events:{signal:a},update:l?b:`clampRange(${b}, 0, ${f})`})}const IW="_zoom_anchor",BW="_zoom_delta",l2e={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=ms.defined(t),o=r+BW,{x:s,y:a}=t.project.hasChannel,u=V(e.scaleName(rt)),l=V(e.scaleName(Ht));let c=nu(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+Hc,f))),n.push({name:r+IW,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),s!==void 0&&UD(e,t,s,"width",n),a!==void 0&&UD(e,t,a,"height",n),n}};function UD(e,t,n,r,i){const o=t.name,s=n.channel,a=ms.defined(t),u=i.filter(v=>v.name===n.signals[a?"data":"visual"])[0],l=e.getSizeSignalRef(r).signal,c=e.getScaleComponent(s),f=c&&c.get("type"),d=a?s_(e,s):u.name,h=o+BW,p=`${o}${IW}.${s}`,g=!a||!c?"zoomLinear":f==="log"?"zoomLog":f==="symlog"?"zoomSymlog":f==="pow"?"zoomPow":"zoomLinear",m=a?f==="pow"?`, ${c.get("exponent")??1}`:f==="symlog"?`, ${c.get("constant")??1}`:"":"",y=`${g}(${d}, ${p}, ${h}${m})`;u.on.push({events:{signal:h},update:a?y:`clampRange(${y}, 0, ${l})`})}const $l="_store",Ha="_tuple",c2e="_modify",jW="vlSelectionResolve",Vx=[Wxe,jxe,Ixe,DW,RW,ms,PW,s2e,u2e,l2e,OW];function f2e(e){let t=e.parent;for(;t&&!Fr(t);)t=t.parent;return t}function Zu(e,{escape:t}={escape:!0}){let n=t?V(e.name):e.name;const r=f2e(e);if(r){const{facet:i}=r;for(const o of Kr)i[o]&&(n+=` + '__facet_${o}_' + (facet[${V(r.vgField(o))}])`)}return n}function ST(e){return en(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function UW(e,t){(K(t.select)||!t.select.on)&&delete e.events,(K(t.select)||!t.select.clear)&&delete e.clear,(K(t.select)||!t.select.toggle)&&delete e.toggle}function a_(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...a_(e.object)),t.push(...a_(e.property))),t)}function WW(e){return e.object.type==="MemberExpression"?WW(e.object):e.object.name==="datum"}function qW(e){const t=UA(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&WW(r)&&n.add(a_(r).slice(1).join("."))}),n}class ad extends je{clone(){return new ad(null,this.model,fe(this.filter))}constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=My(this.model,this.filter,this),this._dependentFields=qW(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function d2e(e,t){const n={},r=e.config.selection;if(!t||!t.length)return n;for(const i of t){const o=nt(i.name),s=i.select,a=K(s)?s:s.type,u=J(s)?fe(s):{type:a},l=r[a];for(const d in l)d==="fields"||d==="encodings"||(d==="mark"&&(u[d]={...l[d],...u[d]}),(u[d]===void 0||u[d]===!0)&&(u[d]=fe(l[d]??u[d])));const c=n[o]={...u,name:o,type:a,init:i.value,bind:i.bind,events:K(u.on)?nu(u.on,"scope"):Q(fe(u.on))},f=fe(i);for(const d of Vx)d.defined(c)&&d.parse&&d.parse(e,c,f)}return n}function HW(e,t,n,r="datum"){const i=K(t)?t:t.param,o=nt(i),s=V(o+$l);let a;try{a=e.getSelectionComponent(o,i)}catch{return`!!${o}`}if(a.project.timeUnit){const d=n??e.component.data.raw,h=a.project.timeUnit.clone();d.parent?h.insertAsParentOf(d):d.parent=h}const u=a.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",l=a.resolve==="global"?")":`, ${V(a.resolve)})`,c=`${u}${s}, ${r}${l}`,f=`length(data(${s}))`;return t.empty===!1?`${f} && ${c}`:`!${f} || ${c}`}function GW(e,t,n){const r=nt(t),i=n.encoding;let o=n.field,s;try{s=e.getSelectionComponent(r,t)}catch{return r}if(!i&&!o)o=s.project.items[0].field,s.project.items.length>1&&U(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${V(o)}.`);else if(i&&!o){const a=s.project.items.filter(u=>u.channel===i);!a.length||a.length>1?(o=s.project.items[0].field,U((a.length?"Multiple ":"No ")+`matching ${V(i)} encoding found for selection ${V(n.param)}. Using "field": ${V(o)}.`)):o=a[0].field}return`${s.name}[${V(ui(o))}]`}function h2e(e,t){for(const[n,r]of Ba(e.component.selection??{})){const i=e.getName(`lookup_${n}`);e.component.data.outputNodes[i]=r.materialized=new jn(new ad(t,e,{param:n}),i,Ge.Lookup,e.component.data.outputNodeRefCounts)}}function My(e,t,n){return Uh(t,r=>K(r)?r:q1e(r)?HW(e,r,n):uU(r))}function p2e(e,t){if(e)return I(e)&&!Ys(e)?e.map(n=>rT(n,t)).join(", "):e}function Qb(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function yh(e,t,n,r={header:!1}){var f,d;const{disable:i,orient:o,scale:s,labelExpr:a,title:u,zindex:l,...c}=e.combine();if(!i){for(const h in c){const p=Vye[h],g=c[h];if(p&&p!==t&&p!=="both")delete c[h];else if(Ig(g)){const{condition:m,...y}=g,v=Q(m),x=mD[h];if(x){const{vgProp:b,part:w}=x,S=[...v.map(E=>{const{test:_,...k}=E;return{test:My(null,_),...k}}),y];Qb(c,w,b,S),delete c[h]}else if(x===null){const b={signal:v.map(w=>{const{test:S,...E}=w;return`${My(null,S)} ? ${eD(E)} : `}).join("")+eD(y)};c[h]=b}}else if(ne(g)){const m=mD[h];if(m){const{vgProp:y,part:v}=m;Qb(c,v,y,g),delete c[h]}}Se(["labelAlign","labelBaseline"],h)&&c[h]===null&&delete c[h]}if(t==="grid"){if(!c.grid)return;if(c.encode){const{grid:h}=c.encode;c.encode={...h?{grid:h}:{}},Ue(c.encode)&&delete c.encode}return{scale:s,orient:o,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:vt(l,0)}}else{if(!r.header&&e.mainExtracted)return;if(a!==void 0){let p=a;(d=(f=c.encode)==null?void 0:f.labels)!=null&&d.update&&ne(c.encode.labels.update.text)&&(p=xl(a,"datum.label",c.encode.labels.update.text.signal)),Qb(c,"labels","text",{signal:p})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(const p of zU)e.hasAxisPart(p)||delete c.encode[p];Ue(c.encode)&&delete c.encode}const h=p2e(u,n);return{scale:s,orient:o,grid:!1,...h?{title:h}:{},...c,...n.aria===!1?{aria:!1}:{},zindex:vt(l,0)}}}}function VW(e){const{axes:t}=e.component,n=[];for(const r of jo)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const o=r==="x"?"height":"width",s=e.getSizeSignalRef(o).signal;o!==s&&n.push({name:o,update:s})}}return n}function g2e(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>yh(i,"grid",t)),...r.map(i=>yh(i,"grid",t)),...n.map(i=>yh(i,"main",t)),...r.map(i=>yh(i,"main",t))].filter(i=>i)}function WD(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const o=n==="x"?"bottom":"left",s=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...B(s),...B(a)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${o}" ? ${Ni(s[c])} : ${Ni(a[c])}`};return l}return t[i]})])}function m2e(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:dU(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",s=ne(n)?"axisOrient":`axis${Tg(n)}`,a=[...i,...i.map(l=>o+l.substr(4))],u=["axis",s,o];return{vlOnlyAxisConfig:WD(a,r,e,n),vgAxisConfig:WD(u,r,e,n),axisConfigStyle:y2e([...u,...a],r)}}function y2e(e,t){var r;const n=[{}];for(const i of e){let o=(r=t[i])==null?void 0:r.style;if(o){o=Q(o);for(const s of o)n.push(t.style[s])}}return Object.assign.apply(null,n)}function u_(e,t,n,r={}){var o;const i=Bj(e,n,t);if(i!==void 0)return{configFrom:"style",configValue:i};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((o=r[s])==null?void 0:o[e])!==void 0)return{configFrom:s,configValue:r[s][e]};return{}}const qD={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??v2e(n,e),gridScale:({model:e,channel:t})=>x2e(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||XW(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||YW(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??w2e(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??E2e(t.type,n,W(t)&&!!t.timeUnit,W(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{const o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return n.tickCount??_2e({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},tickMinStep:k2e,title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=QW(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),o=n==="x"?"x2":"y2",s=t.fieldDef(o);return Uj(i?[pD(i)]:[],W(s)?[pD(s)]:[])},values:({axis:e,fieldOrDatumDef:t})=>$2e(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??C2e(n,t)};function v2e(e,t){return!Wt(e)&&W(t)&&!Ye(t==null?void 0:t.bin)&&!Xt(t==null?void 0:t.bin)}function x2e(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function b2e(e,t,n,r,i){const o=t==null?void 0:t.labelAngle;if(o!==void 0)return ne(o)?o:Pp(o);{const{configValue:s}=u_("labelAngle",r,t==null?void 0:t.style,i);return s!==void 0?Pp(s):n===rt&&Se([G3,H3],e.type)&&!(W(e)&&e.timeUnit)?270:void 0}}function l_(e){return`(((${e.signal} % 360) + 360) % 360)`}function YW(e,t,n,r){if(e!==void 0)if(n==="x"){if(ne(e)){const i=l_(e),o=ne(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(ne(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(ne(e)){const i=l_(e),o=ne(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(ne(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function XW(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,o=r?"bottom":"left";if(ne(e)){const s=l_(e),a=ne(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${i?`(${s} + 90)`:s} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${s} && ${s} < ${180+i}) === ${a} ? "left" : "right"`}}if((e+i)%180===0)return r?null:"center";if(ne(t)){const s=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${s} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function w2e(e,t){if(t==="x"&&Se(["quantitative","temporal"],e))return!0}function E2e(e,t,n,r){if(n&&!J(r)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function S2e(e){return e==="x"?"bottom":"left"}function _2e({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!Wt(t)&&t!=="log"){if(W(e)){if(Ye(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Se(["month","hours","day","quarter"],(i=Ut(e.timeUnit))==null?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function k2e({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(W(t)){const{timeUnit:n}=t;if(n){const r=oU(n);if(r)return{signal:r}}}}function QW(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,s=i?i.title:void 0;if(o&&s)return Wj(o,s);if(o)return o;if(s)return s;if(o!==void 0)return o;if(s!==void 0)return s}function $2e(e,t){const n=e.values;if(I(n))return LU(t,n);if(ne(n))return n}function C2e(e,t){return e==="rect"&&Sy(t)?1:0}class Rf extends je{clone(){return new Rf(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=qW(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(Gl(r)&&CU(r.sort)){const{field:o,timeUnit:s}=r,a=r.sort,u=a.map((l,c)=>`${uU({field:o,timeUnit:s,equal:l})} ? ${c} : `).join("")+a.length;t=new Rf(t,{calculate:u,as:Df(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${Ee(this.transform)}`}}function Df(e,t,n){return Y(e,{prefix:t,suffix:"sort_index",...n})}function Yx(e,t){return Se(["top","bottom"],t)?"column":Se(["left","right"],t)||e==="row"?"row":"column"}function Pf(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return vt((t||{})[e],i[e],n.header[e])}function Xx(e,t,n,r){const i={};for(const o of e){const s=Pf(o,t||{},n,r);s!==void 0&&(i[o]=s)}return i}const _T=["row","column"],kT=["header","footer"];function A2e(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=Xx(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),u=Yx(t,a),l=Pp(s);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...JW(l,u),...KW(u,l,o),...ZW(r,i,t,gve,tW)}}}function KW(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=XW(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function JW(e,t){const n=YW(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function T2e(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of kT)if(n[i])for(const o of n[i]){const s=M2e(e,t,i,n,o);s!=null&&r.push(s)}return r}function F2e(e,t){const{sort:n}=e;return xo(n)?{field:Y(n,{expr:"datum"}),order:n.order??"ascending"}:I(n)?{field:Df(e,t,{expr:"datum"}),order:"ascending"}:{field:Y(e,{expr:"datum"}),order:n??"ascending"}}function c_(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:u}=Xx(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=Z3({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=Yx(t,a);return{text:{signal:u?xl(xl(u,"datum.label",l),"datum.value",Y(e,{expr:"parent"})):l},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...JW(o,c),...KW(c,o,s),...ZW(n,e,t,mve,nW)}}function M2e(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:s}=r,a=e.config?e.config:void 0;if(s&&i.labels){const{labelOrient:f}=Xx(["labelOrient"],s.header,a,t);(t==="row"&&!Se(["top","bottom"],f)||t==="column"&&!Se(["left","right"],f))&&(o=c_(s,t,a))}const u=Fr(e)&&!Pg(e.facet),l=i.axes,c=(l==null?void 0:l.length)>0;if(o||c){const f=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:F2e(s,t)}:{},...c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{},...c?{axes:l}:{}}}}return null}const N2e={column:{start:0,end:1},row:{start:1,end:0}};function O2e(e,t){return N2e[t][e]}function R2e(e,t){const n={};for(const r of Kr){const i=e[r];if(i!=null&&i.facetFieldDef){const{titleAnchor:o,titleOrient:s}=Xx(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),a=Yx(r,s),u=O2e(o,a);u!==void 0&&(n[a]=u)}}return Ue(n)?void 0:n}function ZW(e,t,n,r,i){const o={};for(const s of r){if(!i[s])continue;const a=Pf(s,t==null?void 0:t.header,e,n);a!==void 0&&(o[i[s]]=a)}return o}function $T(e){return[...zm(e,"width"),...zm(e,"height"),...zm(e,"childWidth"),...zm(e,"childHeight")]}function zm(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const o=e.getScaleComponent(n);if(o){const s=o.get("type"),a=o.get("range");if(Wt(s)&&lu(a)){const u=e.scaleName(n);return Fr(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[HD(u,a)]:[HD(u,a),{name:i,update:eq(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const o=i.endsWith("width"),s=o?"containerSize()[0]":"containerSize()[1]",a=n_(e.config.view,o?"width":"height"),u=`isFinite(${s}) ? ${s} : ${a}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function HD(e,t){const n=`${e}_step`;return ne(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function eq(e,t,n){const r=t.get("type"),i=t.get("padding"),o=vt(t.get("paddingOuter"),i);let s=t.get("paddingInner");return s=r==="band"?s!==void 0?s:i:1,`bandspace(${n}, ${Ni(s)}, ${Ni(o)}) * ${e}_step`}function tq(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function nq(e,t){return B(e).reduce((n,r)=>{const i=e[r];return{...n,...sd(t,i,r,o=>Je(o.value))}},{})}function rq(e,t){if(Fr(t))return e==="theta"?"independent":"shared";if(cd(t))return"shared";if(OT(t))return xt(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function CT(e,t){const n=e.scale[t],r=xt(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&U(d1e(t)),"independent"):e[r][t]||"shared"}const D2e={...xve,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},iq=B(D2e);class P2e extends Ps{}const GD={symbols:L2e,gradient:z2e,labels:I2e,entries:B2e};function L2e(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){if(o!=="symbol")return;const{markDef:s,encoding:a,config:u,mark:l}=n,c=s.filled&&l!=="trail";let f={...S0e({},n,gye),...FW(n,{filled:c})};const d=i.get("symbolOpacity")??u.legend.symbolOpacity,h=i.get("symbolFillColor")??u.legend.symbolFillColor,p=i.get("symbolStrokeColor")??u.legend.symbolStrokeColor,g=d===void 0?oq(a.opacity)??s.opacity:void 0;if(f.fill){if(r==="fill"||c&&r===dr)delete f.fill;else if(f.fill.field)h?delete f.fill:(f.fill=Je(u.legend.symbolBaseFillColor??"black"),f.fillOpacity=Je(g??1));else if(I(f.fill)){const m=f_(a.fill??a.color)??s.fill??(c&&s.color);m&&(f.fill=Je(m))}}if(f.stroke){if(r==="stroke"||!c&&r===dr)delete f.stroke;else if(f.stroke.field||p)delete f.stroke;else if(I(f.stroke)){const m=vt(f_(a.stroke||a.color),s.stroke,c?s.color:void 0);m&&(f.stroke={value:m})}}if(r!==Os){const m=W(t)&&aq(n,i,t);m?f.opacity=[{test:m,...Je(g??1)},Je(u.legend.unselectedOpacity)]:g&&(f.opacity=Je(g))}return f={...f,...e},Ue(f)?void 0:f}function z2e(e,{model:t,legendType:n,legendCmpt:r}){if(n!=="gradient")return;const{config:i,markDef:o,encoding:s}=t;let a={};const l=(r.get("gradientOpacity")??i.legend.gradientOpacity)===void 0?oq(s.opacity)||o.opacity:void 0;return l&&(a.opacity=Je(l)),a={...a,...e},Ue(a)?void 0:a}function I2e(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},s=n.config,a=W(t)?aq(n,i,t):void 0,u=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o;let f;_l(c)?f=Ri({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:s}):l===void 0&&c===void 0&&s.customFormatTypes&&(t.type==="quantitative"&&s.numberFormatType?f=Ri({fieldOrDatumDef:t,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):t.type==="temporal"&&s.timeFormatType&&W(t)&&t.timeUnit===void 0&&(f=Ri({fieldOrDatumDef:t,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));const d={...u?{opacity:u}:{},...f?{text:f}:{},...e};return Ue(d)?void 0:d}function B2e(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?{...e,fill:{value:"transparent"}}:e}function oq(e){return sq(e,(t,n)=>Math.max(t,n.value))}function f_(e){return sq(e,(t,n)=>vt(t,n.value))}function sq(e,t){if(Dye(e))return Q(e.condition).reduce(t,e.value);if(Wi(e))return e.value}function aq(e,t,n){const r=t.get("selections");if(!(r!=null&&r.length))return;const i=V(n.field);return r.map(o=>`(!length(data(${V(nt(o)+$l)})) || (${o}[${i}] && indexof(${o}[${i}], datum.value) >= 0))`).join(" || ")}const VD={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return SU(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return _U(r,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??V2e(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??Y2e(n),symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>e.symbolType??U2e(t.type,n,r.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>qc(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Wc(n)&&Oi(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>j2e(t,e)};function j2e(e,t){const n=e.values;if(I(n))return LU(t,n);if(ne(n))return n}function U2e(e,t,n,r){if(t!=="shape"){const i=f_(n)??r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function W2e(e){const{legend:t}=e;return vt(t.type,q2e(e))}function q2e({channel:e,timeUnit:t,scaleType:n}){if(Wc(e)){if(Se(["quarter","month","day"],t))return"symbol";if(Oi(n))return"gradient"}return"symbol"}function H2e({legendConfig:e,legendType:t,orient:n,legend:r}){return r.direction??e[t?"gradientDirection":"symbolDirection"]??G2e(n,t)}function G2e(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function V2e({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(Oi(i))return n==="horizontal"?r==="top"||r==="bottom"?YD(t,"width",s,o):s:YD(t,"height",u,a)}function YD(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function Y2e(e){if(Se(["quantile","threshold","log","symlog"],e))return"greedy"}function uq(e){const t=ht(e)?X2e(e):Z2e(e);return e.component.legends=t,t}function X2e(e){const{encoding:t}=e,n={};for(const r of[dr,...iW]){const i=At(t[r]);!i||!e.getScaleComponent(r)||r===hr&&W(i)&&i.type===od||(n[r]=J2e(e,r))}return n}function Q2e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function K2e(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function J2e(e,t){var b;let n=e.legend(t);const{markDef:r,encoding:i,config:o}=e,s=o.legend,a=new P2e({},Q2e(e,t));a2e(e,t,a);const u=n!==void 0?!n:s.disable;if(a.set("disable",u,n!==void 0),u)return a;n=n||{};const l=e.getScaleComponent(t).get("type"),c=At(i[t]),f=W(c)?(b=Ut(c.timeUnit))==null?void 0:b.unit:void 0,d=n.orient||o.legend.orient||"right",h=W2e({legend:n,channel:t,timeUnit:f,scaleType:l}),p=H2e({legend:n,legendType:h,orient:d,legendConfig:s}),g={legend:n,channel:t,model:e,markDef:r,encoding:i,fieldOrDatumDef:c,legendConfig:s,config:o,scaleType:l,orient:d,legendType:h,direction:p};for(const w of iq){if(h==="gradient"&&w.startsWith("symbol")||h==="symbol"&&w.startsWith("gradient"))continue;const S=w in VD?VD[w](g):n[w];if(S!==void 0){const E=K2e(S,w,n,e.fieldDef(t));(E||o.legend[w]===void 0)&&a.set(w,S,E)}}const m=(n==null?void 0:n.encoding)??{},y=a.get("selections"),v={},x={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:a,legendType:h};for(const w of["labels","legend","title","symbols","gradient","entries"]){const S=nq(m[w]??{},e),E=w in GD?GD[w](S,x):S;E!==void 0&&!Ue(E)&&(v[w]={...y!=null&&y.length&&W(c)?{name:`${nt(c.field)}_legend_${w}`}:{},...y!=null&&y.length?{interactive:!!y}:{},update:E})}return Ue(v)||a.set("encode",v,!!(n!=null&&n.encoding)),a}function Z2e(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){uq(r);for(const i of B(r.component.legends))n.legend[i]=CT(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=lq(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of B(t))for(const i of e.children)i.component.legends[r]&&n.legend[r]==="shared"&&delete i.component.legends[r];return t}function lq(e,t){var o,s,a,u;if(!e)return t.clone();const n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const l of iq){const c=Wa(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return ebe(f,d);case"title":return qj(f,d);case"type":return i=!0,yr("symbol")}return Wx(f,d,l,"legend")});e.setWithExplicit(l,c)}return i&&((s=(o=e.implicit)==null?void 0:o.encode)!=null&&s.gradient&&yy(e.implicit,["encode","gradient"]),(u=(a=e.explicit)==null?void 0:a.encode)!=null&&u.gradient&&yy(e.explicit,["encode","gradient"])),e}function ebe(e,t){return t.value==="circle"?t:e}function tbe(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function cq(e){const t=e.component.legends,n={};for(const i of B(t)){const o=e.getScaleComponent(i),s=We(o.get("domains"));if(n[s])for(const a of n[s])lq(a,t[i])||n[s].push(t[i]);else n[s]=[t[i].clone()]}return en(n).flat().map(i=>nbe(i,e.config)).filter(i=>i!==void 0)}function nbe(e,t){var s,a,u;const{disable:n,labelExpr:r,selections:i,...o}=e.combine();if(!n){if(t.aria===!1&&o.aria==null&&(o.aria=!1),(s=o.encode)!=null&&s.symbols){const l=o.encode.symbols.update;l.fill&&l.fill.value!=="transparent"&&!l.stroke&&!o.stroke&&(l.stroke={value:"transparent"});for(const c of iW)o[c]&&delete l[c]}if(o.title||delete o.title,r!==void 0){let l=r;(u=(a=o.encode)==null?void 0:a.labels)!=null&&u.update&&ne(o.encode.labels.update.text)&&(l=xl(r,"datum.label",o.encode.labels.update.text.signal)),tbe(o,"labels","text",{signal:l})}return o}}function rbe(e){return cd(e)||OT(e)?ibe(e):fq(e)}function ibe(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),fq(e))}function fq(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(s=>s.signal).join(", ")}]`},o=t.data.reduce((s,a)=>{const u=ne(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return Se(s,u)||s.push(u),s},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]},...n}]}else return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const obe=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class dq extends Ps{constructor(t,n,r,i){super({...n},{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function hq(e){e.component.projection=ht(e)?sbe(e):lbe(e)}function sbe(e){if(e.hasProjection){const t=er(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),r=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=n?abe(e):void 0,o=new dq(e.projectionName(!0),{...er(e.config.projection),...t},r,i);return o.get("type")||o.set("type","equalEarth",!1),o}}function abe(e){const t=[],{encoding:n}=e;for(const r of[[Ki,Qi],[li,Ji]])(At(n[r[0]])||At(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(hr)&&e.typedFieldDef(hr).type===od&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Ge.Main)),t}function ube(e,t){const n=x3(obe,i=>!!(!ae(e.explicit,i)&&!ae(t.explicit,i)||ae(e.explicit,i)&&ae(t.explicit,i)&&$r(e.get(i),t.get(i))));if($r(e.size,t.size)){if(n)return e;if($r(e.explicit,{}))return t;if($r(t.explicit,{}))return e}return null}function lbe(e){if(e.children.length===0)return;let t;for(const r of e.children)hq(r);const n=x3(e.children,r=>{const i=r.component.projection;if(i)if(t){const o=ube(t,i);return o&&(t=o),!!o}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new dq(r,t.specifiedProjection,t.size,fe(t.data));for(const o of e.children){const s=o.component.projection;s&&(s.isFit&&i.data.push(...o.component.projection.data),o.renameProjection(s.get("name"),r),s.merged=!0)}return i}}function cbe(e,t,n,r){if(zg(t,n)){const i=ht(e)?e.axis(n)??e.legend(n)??{}:{},o=Y(t,{expr:"datum"}),s=Y(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Y(t,{binSuffix:"range",forAs:!0}),formula:Dg(o,s,i.format,i.formatType,r)}}return{}}function pq(e,t){return`${Pj(e)}_${t}`}function fbe(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function AT(e,t,n){const r=Lx(n,void 0)??{},i=pq(r,t);return e.getName(`${i}_bins`)}function dbe(e){return"as"in e}function XD(e,t,n){let r,i;dbe(e)?r=K(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Y(e,{forAs:!0}),Y(e,{binSuffix:"end",forAs:!0})];const o={...Lx(t,void 0)},s=pq(o,e.field),{signal:a,extentSignal:u}=fbe(n,s);if($x(o.extent)){const c=o.extent;i=GW(n,c.param,c),delete o.extent}const l={bin:o,field:e.field,as:[r],...a?{signal:a}:{},...u?{extentSignal:u}:{},...i?{span:i}:{}};return{key:s,binComponent:l}}class wo extends je{clone(){return new wo(null,fe(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,s)=>{if(qn(o)&&Ye(o.bin)){const{key:a,binComponent:u}=XD(o,o.bin,n);i[a]={...u,...i[a],...cbe(n,o,s,n.config)}}return i},{});return Ue(r)?null:new wo(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:o}=XD(n,n.bin,r);return new wo(t,{[i]:o})}merge(t,n){for(const r of B(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=ho([...this.bins[r].as,...t.bins[r].as],Ee)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(en(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(en(this.bins).map(t=>t.field))}hash(){return`Bin ${Ee(this.bins)}`}assemble(){return en(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,{extent:o,...s}=t.bin,a={type:"bin",field:ui(t.field),as:r,signal:t.signal,...$x(o)?{extent:null}:{extent:o},...t.span?{span:{signal:`span(${t.span})`}}:{},...s};!o&&t.extentSignal&&(n.push({type:"extent",field:ui(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),n.push(a);for(const u of i)for(let l=0;l<2;l++)n.push({type:"formula",expr:Y({field:r[l]},{expr:"datum"}),as:u[l]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function hbe(e,t,n,r){var o;const i=ht(r)?r.encoding[Bo(t)]:void 0;if(qn(n)&&ht(r)&&TU(n,i,r.markDef,r.config)){e.add(Y(n,{})),e.add(Y(n,{suffix:"end"}));const{mark:s,markDef:a,config:u}=r,l=Ua({fieldDef:n,markDef:a,config:u});Lp(s)&&l!==.5&&xt(t)&&(e.add(Y(n,{suffix:qx})),e.add(Y(n,{suffix:Hx}))),n.bin&&zg(n,t)&&e.add(Y(n,{binSuffix:"range"}))}else if($j(t)){const s=kj(t);e.add(r.getName(s))}else e.add(Y(n));return Gl(n)&&rye((o=n.scale)==null?void 0:o.range)&&e.add(n.scale.range.field),e}function pbe(e,t){for(const n of B(t)){const r=t[n];for(const i of B(r))n in e?e[n][i]=new Set([...e[n][i]??[],...r[i]]):e[n]={[i]:r[i]}}}class zi extends je{clone(){return new zi(null,new Set(this.dimensions),fe(this.measures))}constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(s=>{s.aggregate&&(r=!0)});const i={},o=new Set;return!r||(n.forEachFieldDef((s,a)=>{const{aggregate:u,field:l}=s;if(u)if(u==="count")i["*"]??(i["*"]={}),i["*"].count=new Set([Y(s,{forAs:!0})]);else{if(ks(u)||uu(u)){const c=ks(u)?"argmin":"argmax",f=u[c];i[f]??(i[f]={}),i[f][c]=new Set([Y({op:c,field:f},{forAs:!0})])}else i[l]??(i[l]={}),i[l][u]=new Set([Y(s,{forAs:!0})]);Rs(a)&&n.scaleDomain(a)==="unaggregated"&&(i[l]??(i[l]={}),i[l].min=new Set([Y({field:l,aggregate:"min"},{forAs:!0})]),i[l].max=new Set([Y({field:l,aggregate:"max"},{forAs:!0})]))}else hbe(o,a,s,n)}),o.size+B(i).length===0)?null:new zi(t,o,i)}static makeFromTransform(t,n){const r=new Set,i={};for(const o of n.aggregate){const{op:s,field:a,as:u}=o;s&&(s==="count"?(i["*"]??(i["*"]={}),i["*"].count=new Set([u||Y(o,{forAs:!0})])):(i[a]??(i[a]={}),i[a][s]=new Set([u||Y(o,{forAs:!0})])))}for(const o of n.groupby??[])r.add(o);return r.size+B(i).length===0?null:new zi(t,r,i)}merge(t){return yj(this.dimensions,t.dimensions)?(pbe(this.measures,t.measures),!0):(A1e("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...B(this.measures)])}producedFields(){const t=new Set;for(const n of B(this.measures))for(const r of B(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${Ee({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const o of B(this.measures))for(const s of B(this.measures[o]))for(const a of this.measures[o][s])r.push(a),t.push(s),n.push(o==="*"?null:ui(o));return{type:"aggregate",groupby:[...this.dimensions].map(ui),ops:t,fields:n,as:r}}}class ud extends je{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(const o of Kr){const s=n.facet[o];if(s){const{bin:a,sort:u}=s;this[o]={name:n.getName(`${o}_domain`),fields:[Y(s),...Ye(a)?[Y(s,{binSuffix:"end"})]:[]],...xo(u)?{sortField:u}:I(u)?{sortIndexField:Df(s,o)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(const n of Kr)this[n]&&(t+=` ${n.charAt(0)}:${Ee(this[n])}`);return t}get fields(){var n;const t=[];for(const r of Kr)(n=this[r])!=null&&n.fields&&t.push(...this[r].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of Kr)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of jo){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),o=r.get("range");if(Wt(i)&&lu(o)){const s=Qx(this.childModel,n),a=NT(s);a?t[n]=a:U(O3(n))}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x",facet:void 0}[t],o=[],s=[],a=[];i&&r&&r[i]&&(n?(o.push(`distinct_${r[i]}`),s.push("max")):(o.push(r[i]),s.push("distinct")),a.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=Ox,field:f}=u;o.push(f),s.push(c),a.push(Y(u,{forAs:!0}))}else l&&(o.push(l),s.push("max"),a.push(l));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...o.length?{fields:o,ops:s,as:a}:{}}]}}assembleFacetHeaderData(t){var u;const{columns:n}=this.model.layout,{layoutHeaders:r}=this.model.component,i=[],o={};for(const l of _T){for(const c of kT){const f=(r[l]&&r[l][c])??[];for(const d of f)if(((u=d.axes)==null?void 0:u.length)>0){o[l]=!0;break}}if(o[l]){const c=`length(data("${this.facet.name}"))`,f=l==="row"?n?{signal:`ceil(${c} / ${n})`}:1:n?{signal:`min(${c}, ${n})`}:{signal:c};i.push({name:`${this.facet.name}_${l}`,transform:[{type:"sequence",start:0,stop:f}]})}}const{row:s,column:a}=o;return(s||a)&&i.unshift(this.assembleRowColumnHeaderData("facet",null,t)),i}assemble(){const t=[];let n=null;const r=this.getChildIndependentFieldsWithStep(),{column:i,row:o,facet:s}=this;if(i&&o&&(r.x||r.y)){n=`cross_${this.column.name}_${this.row.name}`;const a=[].concat(r.x??[],r.y??[]),u=a.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:u}]})}for(const a of[gs,ps])this[a]&&t.push(this.assembleRowColumnHeaderData(a,n,r));if(s){const a=this.assembleFacetHeaderData(r);a&&t.push(...a)}return t}}function QD(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function gbe(e,t){const n=E3(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const r=QD(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.startsWith("utc:")){const r=QD(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return U(L0e(t)),null}function mbe(e){const t={};return A0(e.filter,n=>{if(aU(n)){let r=null;L3(n)?r=Er(n.equal):I3(n)?r=Er(n.lte):z3(n)?r=Er(n.lt):B3(n)?r=Er(n.gt):j3(n)?r=Er(n.gte):U3(n)?r=n.range[0]:W3(n)&&(r=(n.oneOf??n.in)[0]),r&&(ql(r)?t[n.field]="date":Te(r)?t[n.field]="number":K(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function ybe(e){const t={};function n(r){Mf(r)?t[r.field]="date":r.type==="quantitative"&&p0e(r.aggregate)?t[r.field]="number":_f(r.field)>1?r.field in t||(t[r.field]="flatten"):Gl(r)&&xo(r.sort)&&_f(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((ht(e)||Fr(e))&&e.forEachFieldDef((r,i)=>{if(qn(r))n(r);else{const o=Ul(i),s=e.fieldDef(o);n({...r,type:s.type})}}),ht(e)){const{mark:r,markDef:i,encoding:o}=e;if(cu(r)&&!e.encoding.order){const s=i.orient==="horizontal"?"y":"x",a=o[s];W(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function vbe(e){const t={};if(ht(e)&&e.component.selection)for(const n of B(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&_f(i.field)>1&&(t[i.field]="flatten")}return t}class vn extends je{clone(){return new vn(null,fe(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${Ee(this._parse)}`}static makeExplicit(t,n,r){var s;let i={};const o=n.data;return!ka(o)&&((s=o==null?void 0:o.format)!=null&&s.parse)&&(i=o.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const a of B(r)){const u=i.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===r[a]||u.value==="derived"||r[a]==="flatten"?delete r[a]:U(sD(a,r[a],u.value)))}for(const a of B(n)){const u=i.get(a);u!==void 0&&(u===n[a]?delete n[a]:U(sD(a,n[a],u)))}const o=new Ps(n,r);i.copyAll(o);const s={};for(const a of B(o.combine())){const u=o.get(a);u!==null&&(s[a]=u)}return B(s).length===0||i.parseNothing?null:new vn(t,s)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const n of B(this._parse)){const r=this._parse[n];_f(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(B(this._parse))}dependentFields(){return new Set(B(this._parse))}assembleTransforms(t=!1){return B(this._parse).filter(n=>t?_f(n)>1:!0).map(n=>{const r=gbe(n,this._parse[n]);return r?{type:"formula",expr:r,as:S3(n)}:null}).filter(n=>n!==null)}}class Ga extends je{clone(){return new Ga(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([qi])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:qi}}}class jg extends je{clone(){return new jg(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${Ee(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class Ug extends je{clone(){return new Ug(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${Ee(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class Cl extends je{constructor(t){super(null),t??(t={name:"source"});let n;if(ka(t)||(n=t.format?{...ar(t.format,["parse"])}:{}),zp(t))this._data={values:t.values};else if(Nf(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];Se(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else EW(t)?this._data={values:[{type:"Sphere"}]}:(bW(t)||ka(t))&&(this._data={});this._generator=ka(t),t.name&&(this._name=t.name),n&&!Ue(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var KD=function(e,t,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},xbe=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},vh;function TT(e){return e instanceof Cl||e instanceof jg||e instanceof Ug}class FT{constructor(){vh.set(this,void 0),KD(this,vh,!1,"f")}setModified(){KD(this,vh,!0,"f")}get modifiedFlag(){return xbe(this,vh,"f")}}vh=new WeakMap;class Vl extends FT{getNodeDepths(t,n,r){r.set(t,n);for(const i of t.children)this.getNodeDepths(i,n+1,r);return r}optimize(t){const r=[...this.getNodeDepths(t,0,new Map).entries()].sort((i,o)=>o[1]-i[1]);for(const i of r)this.run(i[0]);return this.modifiedFlag}}class MT extends FT{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class bbe extends MT{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of B(r))r[i].length>1&&(this.setModified(),this.mergeNodes(t,r[i]))}}class wbe extends MT{constructor(t){super(),this.requiresSelectionId=t&&ST(t)}run(t){t instanceof Ga&&(this.requiresSelectionId&&(TT(t.parent)||t.parent instanceof zi||t.parent instanceof vn)||(this.setModified(),t.remove()))}}class Ebe extends FT{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let r=new Set;t instanceof bo&&(r=t.producedFields(),b3(r,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const i of t.children)this.run(i,new Set([...n,...r]))}}class Sbe extends MT{constructor(){super()}run(t){t instanceof jn&&!t.isRequired()&&(this.setModified(),t.remove())}}class _be extends Vl{run(t){if(!TT(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof vn)if(t instanceof vn)this.setModified(),t.merge(n);else{if(w3(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class kbe extends Vl{run(t){const n=[...t.children],r=t.children.filter(i=>i instanceof vn);if(t.numChildren()>1&&r.length>=1){const i={},o=new Set;for(const s of r){const a=s.parse;for(const u of B(a))u in i?i[u]!==a[u]&&o.add(u):i[u]=a[u]}for(const s of o)delete i[s];if(!Ue(i)){this.setModified();const s=new vn(t,i);for(const a of n){if(a instanceof vn)for(const u of B(i))delete a.parse[u];t.removeChild(a),a.parent=s,a instanceof vn&&B(a.parse).length===0&&a.remove()}}}}}class $be extends Vl{run(t){t instanceof jn||t.numChildren()>0||t instanceof ud||t instanceof Cl||(this.setModified(),t.remove())}}class Cbe extends Vl{run(t){const n=t.children.filter(i=>i instanceof bo),r=n.pop();for(const i of n)this.setModified(),r.merge(i)}}class Abe extends Vl{run(t){const n=t.children.filter(i=>i instanceof zi),r={};for(const i of n){const o=Ee(i.groupBy);o in r||(r[o]=[]),r[o].push(i)}for(const i of B(r)){const o=r[i];if(o.length>1){const s=o.pop();for(const a of o)s.merge(a)&&(t.removeChild(a),a.parent=s,a.remove(),this.setModified())}}}}class Tbe extends Vl{constructor(t){super(),this.model=t}run(t){const n=!(TT(t)||t instanceof ad||t instanceof vn||t instanceof Ga),r=[],i=[];for(const o of t.children)o instanceof wo&&(n&&!w3(t.producedFields(),o.dependentFields())?r.push(o):i.push(o));if(r.length>0){const o=r.pop();for(const s of r)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof wo?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(i.length>1){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified()}}}class Fbe extends Vl{run(t){const n=[...t.children];if(!vl(n,s=>s instanceof jn)||t.numChildren()<=1)return;const i=[];let o;for(const s of n)if(s instanceof jn){let a=s;for(;a.numChildren()===1;){const[u]=a.children;if(u instanceof jn)a=u;else break}i.push(...a.children),o?(t.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=a,this.setModified()):o=a}else i.push(s);if(i.length){this.setModified();for(const s of i)s.parent.removeChild(s),s.parent=o}}}class Yl extends je{clone(){return new Yl(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=ho(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??Y(t)}hash(){return`JoinAggregateTransform ${Ee(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const o of this.transform.joinaggregate)n.push(o.op),r.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);const i=this.transform.groupby;return{type:"joinaggregate",as:r,ops:n,fields:t,...i!==void 0?{groupby:i}:{}}}}function Mbe(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Y(r);return i&&t.push(i),t},[])}function Nbe(e){return I(e)&&e.every(t=>K(t))&&e.length>1}class ys extends je{clone(){return new ys(null,fe(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:r,groupby:i,as:o,offset:s="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),u.push(vt(f.order,"ascending"));const l={field:a,order:u};let c;return Nbe(o)?c=o:K(o)?c=[o,`${o}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new ys(t,{dimensionFieldDefs:[],stackField:r,groupby:i,offset:s,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannels:o,fieldChannel:s,offset:a,impute:u}=r,l=o.map(h=>{const p=i[h];return To(p)}).filter(h=>!!h),c=Mbe(n),f=n.encoding.order;let d;if(I(f)||W(f))d=jj(f);else{const h=FU(f)?f.sort:s==="y"?"descending":"ascending";d=c.reduce((p,g)=>(p.field.includes(g)||(p.field.push(g),p.order.push(h)),p),{field:[],order:[]})}return new ys(t,{dimensionFieldDefs:l,stackField:n.vgField(s),facetby:[],stackby:c,sort:d,offset:a,impute:u,as:[n.vgField(s,{suffix:"start",forAs:!0}),n.vgField(s,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${Ee(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:r}=this._stack;return t.length>0?t.map(i=>i.bin?n?[Y(i,{binSuffix:"mid"})]:[Y(i,{}),Y(i,{binSuffix:"end"})]:[Y(i)]).flat():r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:r,stackField:i,stackby:o,sort:s,offset:a,impute:u,as:l}=this._stack;if(u)for(const c of r){const{bandPosition:f=.5,bin:d}=c;if(d){const h=Y(c,{expr:"datum"}),p=Y(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${f}*${h}+${1-f}*${p}`,as:Y(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:i,groupby:[...o,...n],key:Y(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:s,as:l,offset:a}),t}}class ld extends je{clone(){return new ld(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=ho(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??Y(t)}hash(){return`WindowTransform ${Ee(this.transform)}`}assemble(){const t=[],n=[],r=[],i=[];for(const f of this.transform.window)n.push(f.op),r.push(this.getDefaultName(f)),i.push(f.param===void 0?null:f.param),t.push(f.field===void 0?null:f.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&n.every(f=>M3(f)))return{type:"joinaggregate",as:r,ops:n,fields:t,...s!==void 0?{groupby:s}:{}};const a=[],u=[];if(this.transform.sort!==void 0)for(const f of this.transform.sort)a.push(f.field),u.push(f.order??"ascending");const l={field:a,order:u},c=this.transform.ignorePeers;return{type:"window",params:i,as:r,ops:n,fields:t,sort:l,...c!==void 0?{ignorePeers:c}:{},...s!==void 0?{groupby:s}:{},...o!==void 0?{frame:o}:{}}}}function Obe(e){function t(n){if(!(n instanceof ud)){const r=n.clone();if(r instanceof jn){const i=h_+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof zi||r instanceof ys||r instanceof ld||r instanceof Yl)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function d_(e){if(e instanceof ud)if(e.numChildren()===1&&!(e.children[0]instanceof jn)){const t=e.children[0];(t instanceof zi||t instanceof ys||t instanceof ld||t instanceof Yl)&&t.addDimensions(e.fields),t.swapWithParent(),d_(e)}else{const t=e.model.component.data.main;gq(t);const n=Obe(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(d_)}function gq(e){if(e instanceof jn&&e.type===Ge.Main&&e.numChildren()===1){const t=e.children[0];t instanceof ud||(t.swapWithParent(),gq(e))}}const h_="scale_",Im=5;function p_(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!p_(t.children))return!1}return!0}function gi(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function JD(e,t,n){let r=e.sources,i=!1;return i=gi(new Sbe,r)||i,i=gi(new wbe(t),r)||i,r=r.filter(o=>o.numChildren()>0),i=gi(new $be,r)||i,r=r.filter(o=>o.numChildren()>0),n||(i=gi(new _be,r)||i,i=gi(new Tbe(t),r)||i,i=gi(new Ebe,r)||i,i=gi(new kbe,r)||i,i=gi(new Abe,r)||i,i=gi(new Cbe,r)||i,i=gi(new bbe,r)||i,i=gi(new Fbe,r)||i),e.sources=r,i}function Rbe(e,t){p_(e.sources);let n=0,r=0;for(let i=0;i<Im&&JD(e,t,!0);i++)n++;e.sources.map(d_);for(let i=0;i<Im&&JD(e,t,!1);i++)r++;p_(e.sources),Math.max(n,r)===Im&&U(`Maximum optimization runs(${Im}) reached.`)}class Rt{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Rt(()=>t(n))}}function mq(e){ht(e)?Dbe(e):Pbe(e)}function Dbe(e){const t=e.component.scales;for(const n of B(t)){const r=zbe(e,n);if(t[n].setWithExplicit("domains",r),Bbe(e,n),e.component.data.isFaceted){let o=e;for(;!Fr(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(const a of r.value)ls(a)&&(a.data=h_+a.data.replace(h_,""))}}}function Pbe(e){for(const n of e.children)mq(n);const t=e.component.scales;for(const n of B(t)){let r,i=null;for(const o of e.children){const s=o.component.scales[n];if(s){r===void 0?r=s.getWithExplicit("domains"):r=Wa(r,s.getWithExplicit("domains"),"domains","scale",g_);const a=s.get("selectionExtent");i&&a&&i.param!==a.param&&U(O0e),i=a}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function Lbe(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:o}=ZD(t,n);if(!i){U(o);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=ZD(t,n);if(i)return"unaggregated"}return e}function zbe(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=Lbe(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:i}),t==="x"&&At(r.x2)?At(r.x)?Wa(js(n,i,e,"x"),js(n,i,e,"x2"),"domain","scale",g_):js(n,i,e,"x2"):t==="y"&&At(r.y2)?At(r.y)?Wa(js(n,i,e,"y"),js(n,i,e,"y2"),"domain","scale",g_):js(n,i,e,"y2"):js(n,i,e,t)}function Ibe(e,t,n){return e.map(r=>({signal:`{data: ${zx(r,{timeUnit:n,type:t})}}`}))}function Kb(e,t,n){var i;const r=(i=Ut(n))==null?void 0:i.unit;return t==="temporal"||r?Ibe(e,t,r):[e]}function js(e,t,n,r){const{encoding:i,markDef:o,mark:s,config:a,stack:u}=n,l=At(i[r]),{type:c}=l,f=l.timeUnit;if(nye(t)){const p=js(e,void 0,n,r),g=Kb(t.unionWith,c,f);return so([...g,...p.value])}else{if(ne(t))return so([t]);if(t&&t!=="unaggregated"&&!pU(t))return so(Kb(t,c,f))}if(u&&r===u.fieldChannel){if(u.offset==="normalize")return yr([[0,1]]);const p=n.requestDataName(Ge.Main);return yr([{data:p,field:n.vgField(r,{suffix:"start"})},{data:p,field:n.vgField(r,{suffix:"end"})}])}const d=Rs(r)&&W(l)?jbe(n,r,e):void 0;if(Uo(l)){const p=Kb([l.datum],c,f);return yr(p)}const h=l;if(t==="unaggregated"){const p=n.requestDataName(Ge.Main),{field:g}=l;return yr([{data:p,field:Y({field:g,aggregate:"min"})},{data:p,field:Y({field:g,aggregate:"max"})}])}else if(Ye(h.bin)){if(Wt(e))return yr(e==="bin-ordinal"?[]:[{data:Dp(d)?n.requestDataName(Ge.Main):n.requestDataName(Ge.Raw),field:n.vgField(r,zg(h,r)?{binSuffix:"range"}:{}),sort:d===!0||!J(d)?{field:n.vgField(r,{}),op:"min"}:d}]);{const{bin:p}=h;if(Ye(p)){const g=AT(n,h.field,p);return yr([new Rt(()=>{const m=n.getSignalName(g);return`[${m}.start, ${m}.stop]`})])}else return yr([{data:n.requestDataName(Ge.Main),field:n.vgField(r,{})}])}}else if(h.timeUnit&&Se(["time","utc"],e)){const p=i[Bo(r)];if(TU(h,p,o,a)){const g=n.requestDataName(Ge.Main),m=Ua({fieldDef:h,fieldDef2:p,markDef:o,config:a}),y=Lp(s)&&m!==.5&&xt(r);return yr([{data:g,field:n.vgField(r,y?{suffix:qx}:{})},{data:g,field:n.vgField(r,{suffix:y?Hx:"end"})}])}}return yr(d?[{data:Dp(d)?n.requestDataName(Ge.Main):n.requestDataName(Ge.Raw),field:n.vgField(r),sort:d}]:[{data:n.requestDataName(Ge.Main),field:n.vgField(r)}])}function Jb(e,t){const{op:n,field:r,order:i}=e;return{op:n??(t?"sum":Ox),...r?{field:ui(r)}:{},...i?{order:i}:{}}}function Bbe(e,t){var a;const n=e.component.scales[t],r=e.specifiedScales[t].domain,i=(a=e.fieldDef(t))==null?void 0:a.bin,o=pU(r)&&r,s=Wl(i)&&$x(i.extent)&&i.extent;(o||s)&&n.set("selectionExtent",o??s,!0)}function jbe(e,t,n){if(!Wt(n))return;const r=e.fieldDef(t),i=r.sort;if(CU(i))return{op:"min",field:Df(r,t),order:"ascending"};const{stack:o}=e,s=o?new Set([...o.groupbyFields,...o.stackBy.map(a=>a.fieldDef.field)]):void 0;if(xo(i)){const a=o&&!s.has(i.field);return Jb(i,a)}else if($U(i)){const{encoding:a,order:u}=i,l=e.fieldDef(a),{aggregate:c,field:f}=l,d=o&&!s.has(f);if(ks(c)||uu(c))return Jb({field:Y(l),order:u},d);if(M3(c)||!c)return Jb({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(Se(["ascending",void 0],i))return!0}}function ZD(e,t){const{aggregate:n,type:r}=e;return n?K(n)&&!m0e.has(n)?{valid:!1,reason:o1e(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:s1e(e)}:{valid:!0}:{valid:!1,reason:i1e(e)}}function g_(e,t,n,r){return e.explicit&&t.explicit&&U(f1e(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function Ube(e){const t=ho(e.map(s=>{if(ls(s)){const{sort:a,...u}=s;return u}return s}),Ee),n=ho(e.map(s=>{if(ls(s)){const a=s.sort;return a!==void 0&&!Dp(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(s=>s!==void 0),Ee);if(t.length===0)return;if(t.length===1){const s=e[0];if(ls(s)&&n.length>0){let a=n[0];if(n.length>1){U(uD);const u=n.filter(l=>J(l)&&"op"in l&&l.op!=="min");n.every(l=>J(l)&&"op"in l)&&u.length===1?a=u[0]:a=!0}else if(J(a)&&"field"in a){const u=a.field;s.field===u&&(a=a.order?{order:a.order}:!0)}return{...s,sort:a}}return s}const r=ho(n.map(s=>Dp(s)||!("op"in s)||K(s.op)&&s.op in d0e?s:(U(h1e(s)),!0)),Ee);let i;r.length===1?i=r[0]:r.length>1&&(U(uD),i=!0);const o=ho(e.map(s=>ls(s)?s.data:null),s=>s);return o.length===1&&o[0]!==null?{data:o[0],fields:t.map(a=>a.field),...i?{sort:i}:{}}:{fields:t,...i?{sort:i}:{}}}function NT(e){if(ls(e)&&K(e.field))return e.field;if(y0e(e)){let t;for(const n of e.fields)if(ls(n)&&K(n.field)){if(!t)t=n.field;else if(t!==n.field)return U(p1e),t}return U(g1e),t}else if(v0e(e)){U(m1e);const t=e.fields[0];return K(t)?t:void 0}}function Qx(e,t){const r=e.component.scales[t].get("domains").map(i=>(ls(i)&&(i.data=e.lookupDataSource(i.data)),i));return Ube(r)}function yq(e){return cd(e)||OT(e)?e.children.reduce((t,n)=>t.concat(yq(n)),e5(e)):e5(e)}function e5(e){return B(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:s,selectionExtent:a,domains:u,range:l,reverse:c,...f}=i,d=Wbe(i.range,o,n,e),h=Qx(e,n),p=a?Lxe(e,a,r,h):null;return t.push({name:o,type:s,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...c!==void 0?{reverse:c}:{},...f}),t},[])}function Wbe(e,t,n,r){if(xt(n)){if(lu(e))return{step:{signal:`${t}_step`}}}else if(J(e)&&ls(e))return{...e,data:r.lookupDataSource(e.data)};return e}class vq extends Ps{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:vl(this.get("domains"),t=>I(t)&&t.length===2&&Te(t[0])&&t[0]<=0&&Te(t[1])&&t[1]>=0)}}const qbe=["range","scheme"];function Hbe(e){const t=e.component.scales;for(const n of kx){const r=t[n];if(!r)continue;const i=Gbe(n,e);r.setWithExplicit("range",i)}}function t5(e,t){const n=e.fieldDef(t);if(n!=null&&n.bin){const{bin:r,field:i}=n,o=pr(t),s=e.getName(o);if(J(r)&&r.binned&&r.step!==void 0)return new Rt(()=>{const a=e.scaleName(t),u=`(domain("${a}")[1] - domain("${a}")[0]) / ${r.step}`;return`${e.getSignalName(s)} / (${u})`});if(Ye(r)){const a=AT(e,i,r);return new Rt(()=>{const u=e.getSignalName(a),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(s)} / (${l})`})}}}function Gbe(e,t){const n=t.specifiedScales[e],{size:r}=t,o=t.getScaleComponent(e).get("type");for(const f of qbe)if(n[f]!==void 0){const d=ZS(o,f),h=gU(e,f);if(!d)U(Yj(o,f,e));else if(h)U(h);else switch(f){case"range":{const p=n.range;if(I(p)){if(xt(e))return so(p.map(g=>{if(g==="width"||g==="height"){const m=t.getName(g),y=t.getSignalName.bind(t);return Rt.fromName(y,m)}return g}))}else if(J(p))return so({data:t.requestDataName(Ge.Main),field:p.field,sort:{op:"min",field:t.vgField(e)}});return so(p)}case"scheme":return so(Vbe(n[f]))}}const s=e===rt||e==="xOffset"?"width":"height",a=r[s];if(Fo(a)){if(xt(e))if(Wt(o)){const f=bq(a,t,e);if(f)return so({step:f})}else U(Xj(s));else if(Ng(e)){const f=e===ru?"x":"y";if(t.getScaleComponent(f).get("type")==="band"){const p=wq(a,o);if(p)return so(p)}}}const{rangeMin:u,rangeMax:l}=n,c=Ybe(e,t);return(u!==void 0||l!==void 0)&&ZS(o,"rangeMin")&&I(c)&&c.length===2?so([u??c[0],l??c[1]]):yr(c)}function Vbe(e){return tye(e)?{scheme:e.name,...ar(e,["name"])}:{scheme:e}}function xq(e,t,n,{center:r}={}){const i=pr(e),o=t.getName(i),s=t.getSignalName.bind(t);return e===Ht&&Pr(n)?r?[Rt.fromName(a=>`${s(a)}/2`,o),Rt.fromName(a=>`-${s(a)}/2`,o)]:[Rt.fromName(s,o),0]:r?[Rt.fromName(a=>`-${s(a)}/2`,o),Rt.fromName(a=>`${s(a)}/2`,o)]:[0,Rt.fromName(s,o)]}function Ybe(e,t){const{size:n,config:r,mark:i,encoding:o}=t,{type:s}=At(o[e]),u=t.getScaleComponent(e).get("type"),{domain:l,domainMid:c}=t.specifiedScales[e];switch(e){case rt:case Ht:{if(Se(["point","band"],u)){const f=Eq(e,n,r.view);if(Fo(f))return{step:bq(f,t,e)}}return xq(e,t,u)}case ru:case id:return Xbe(e,t,u);case Ns:{const f=t.component.scales[e].get("zero"),d=Sq(i,f,r),h=Jbe(i,n,t,r);return Af(u)?Kbe(d,h,Qbe(u,r,l,e)):[d,h]}case fi:return[0,Math.PI*2];case jl:return[0,360];case Xi:return[0,new Rt(()=>{const f=t.getSignalName(Fr(t.parent)?"child_width":"width"),d=t.getSignalName(Fr(t.parent)?"child_height":"height");return`min(${f},${d})/2`})];case su:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case au:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case hr:return"symbol";case dr:case zo:case Io:return u==="ordinal"?s==="nominal"?"category":"ordinal":c!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case Os:case iu:case ou:return[r.scale.minOpacity,r.scale.maxOpacity]}}function bq(e,t,n){const{encoding:r}=t,i=t.getScaleComponent(n),o=C3(n),s=r[o];if(sW({step:e,offsetIsDiscrete:de(s)&&lU(s.type)})==="offset"&&jU(r,o)){const u=t.getScaleComponent(o);let c=`domain('${t.scaleName(o)}').length`;if(u.get("type")==="band"){const d=u.get("paddingInner")??u.get("padding")??0,h=u.get("paddingOuter")??u.get("padding")??0;c=`bandspace(${c}, ${d}, ${h})`}const f=i.get("paddingInner")??i.get("padding");return{signal:`${e.step} * ${c} / (1-${E0e(f)})`}}else return e.step}function wq(e,t){if(sW({step:e,offsetIsDiscrete:Wt(t)})==="offset")return{step:e.step}}function Xbe(e,t,n){const r=e===ru?"x":"y",i=t.getScaleComponent(r);if(!i)return xq(r,t,n,{center:!0});const o=i.get("type"),s=t.scaleName(r),{markDef:a,config:u}=t;if(o==="band"){const l=Eq(r,t.size,t.config.view);if(Fo(l)){const c=wq(l,n);if(c)return c}return[0,{signal:`bandwidth('${s}')`}]}else{const l=t.encoding[r];if(W(l)&&l.timeUnit){const c=oU(l.timeUnit,p=>`scale('${s}', ${p})`),f=t.config.scale.bandWithNestedOffsetPaddingInner,d=Ua({fieldDef:l,markDef:a,config:u})-.5,h=d!==0?` + ${d}`:"";if(f){const p=ne(f)?`${f.signal}/2`+h:`${f/2+d}`,g=ne(f)?`(1 - ${f.signal}/2)`+h:`${1-f/2+d}`;return[{signal:`${p} * (${c})`},{signal:`${g} * (${c})`}]}return[0,{signal:c}]}return gj(`Cannot use ${e} scale if ${r} scale is not discrete.`)}}function Eq(e,t,n){const r=e===rt?"width":"height",i=t[r];return i||Ay(n,r)}function Qbe(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&I(n)?n.length+1:(U(k1e(r)),3)}}function Kbe(e,t,n){const r=()=>{const i=Ni(t),o=Ni(e),s=`(${i} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${i} + ${s}, ${s})`};return ne(t)?new Rt(r):{signal:r()}}function Sq(e,t,n){if(t)return ne(t)?{signal:`${t.signal} ? 0 : ${Sq(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(Cx("size",e))}const n5=.95;function Jbe(e,t,n,r){const i={x:t5(n,"x"),y:t5(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const o=r5(t,i,r.view);return Te(o)?o-1:new Rt(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const o=r5(t,i,r.view);return Te(o)?Math.pow(n5*o,2):new Rt(()=>`pow(${n5} * ${o.signal}, 2)`)}}throw new Error(Cx("size",e))}function r5(e,t,n){const r=Fo(e.width)?e.width.step:Cy(n,"width"),i=Fo(e.height)?e.height.step:Cy(n,"height");return t.x||t.y?new Rt(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function _q(e,t){ht(e)?Zbe(e,t):$q(e,t)}function Zbe(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:s}=e;for(const a of B(n)){const u=s[a],l=n[a],c=e.getScaleComponent(a),f=At(i[a]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=ZS(h,t),y=gU(a,t);if(d!==void 0&&(m?y&&U(y):U(Yj(h,t,a))),m&&y===void 0)if(d!==void 0){const v=f.timeUnit,x=f.type;switch(t){case"domainMax":case"domainMin":ql(u[t])||x==="temporal"||v?l.set(t,{signal:zx(u[t],{type:x,timeUnit:v})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const v=t in i5?i5[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,domainMin:u.domainMin,domainMax:u.domainMax,markDef:o,config:r,hasNestedOffsetScale:UU(i,a),hasSecondaryRangeChannel:!!i[Bo(a)]}):r.scale[t];v!==void 0&&l.set(t,v,!1)}}}const i5={bins:({model:e,fieldOrDatumDef:t})=>W(t)?ewe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>twe(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:r,domainMax:i,fieldOrDatumDef:o})=>nwe(e,t,n,r,i,o),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>rwe(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:r,config:i,hasNestedOffsetScale:o})=>iwe(e,t,n.type,r,i.scale,o),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:r,config:i,hasNestedOffsetScale:o})=>owe(e,t,n,r,i.scale,o),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=W(e)?e.sort:void 0;return swe(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i,config:o,hasSecondaryRangeChannel:s})=>awe(e,t,n,r,i,o.scale,s)};function kq(e){ht(e)?Hbe(e):$q(e,"range")}function $q(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?kq(r):_q(r,t);for(const r of B(n)){let i;for(const o of e.children){const s=o.component.scales[r];if(s){const a=s.getWithExplicit(t);i=Wa(i,a,t,"scale",xW((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function ewe(e,t){const n=t.bin;if(Ye(n)){const r=AT(e,t.field,n);return new Rt(()=>e.getSignalName(r))}else if(Xt(n)&&Wl(n)&&n.step!==void 0)return{step:n.step}}function twe(e,t){if(Se([dr,zo,Io],e)&&t!=="nominal")return"hcl"}function nwe(e,t,n,r,i,o){var s;if(!((s=To(o))!=null&&s.bin||I(n)||i!=null||r!=null||Se([ur.TIME,ur.UTC],e)))return xt(t)?!0:void 0}function rwe(e,t,n,r,i,o){if(xt(e)){if(Oi(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:s,orient:a}=i;if(s==="bar"&&!(W(r)&&(r.bin||r.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===ur.POINT)return n.pointPadding}}function iwe(e,t,n,r,i,o=!1){if(e===void 0){if(xt(t)){const{bandPaddingInner:s,barBandPaddingInner:a,rectBandPaddingInner:u,bandWithNestedOffsetPaddingInner:l}=i;return o?l:vt(s,n==="bar"?a:u)}else if(Ng(t)&&r===ur.BAND)return i.offsetBandPaddingInner}}function owe(e,t,n,r,i,o=!1){if(e===void 0){if(xt(t)){const{bandPaddingOuter:s,bandWithNestedOffsetPaddingOuter:a}=i;if(o)return a;if(n===ur.BAND)return vt(s,ne(r)?{signal:`${r.signal}/2`}:r/2)}else if(Ng(t)){if(n===ur.POINT)return .5;if(n===ur.BAND)return i.offsetBandPaddingOuter}}}function swe(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return Pr(e)&&t==="descending"?ne(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Pr(e)&&t==="descending")return!0}function awe(e,t,n,r,i,o,s){if(!!n&&n!=="unaggregated"&&Pr(i)){if(I(n)){const u=n[0],l=n[n.length-1];if(Te(u)&&u<=0&&Te(l)&&l>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!Af(i))return!0;if(!(W(t)&&t.bin)&&Se([...jo,...i0e],e)){const{orient:u,type:l}=r;return Se(["bar","area","line","trail"],l)&&(u==="horizontal"&&e==="y"||u==="vertical"&&e==="x")?!1:Se(["bar","area"],l)&&!s?!0:o==null?void 0:o.zero}return!1}function uwe(e,t,n,r,i=!1){const o=lwe(t,n,r,i),{type:s}=e;return Rs(t)?s!==void 0?uye(t,s)?W(n)&&!aye(s,n.type)?(U(l1e(s,o)),o):s:(U(u1e(t,s,o)),o):o:null}function lwe(e,t,n,r){var i;switch(t.type){case"nominal":case"ordinal":{if(Wc(e)||Wb(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&U(qb(e,"ordinal")),"ordinal";if(xt(e)||Ng(e)){if(Se(["rect","bar","image","rule"],n.type)||r)return"band"}else if(n.type==="arc"&&e in F3)return"band";const o=n[pr(e)];return Sl(o)||Ff(t)&&((i=t.axis)!=null&&i.tickBand)?"band":"point"}case"temporal":return Wc(e)?"time":Wb(e)==="discrete"?(U(qb(e,"temporal")),"ordinal"):W(t)&&t.timeUnit&&Ut(t.timeUnit).utc?"utc":"time";case"quantitative":return Wc(e)?W(t)&&Ye(t.bin)?"bin-ordinal":"linear":Wb(e)==="discrete"?(U(qb(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(Gj(t.type))}function cwe(e,{ignoreRange:t}={}){Cq(e),mq(e);for(const n of sye)_q(e,n);t||kq(e)}function Cq(e){ht(e)?e.component.scales=fwe(e):e.component.scales=hwe(e)}function fwe(e){const{encoding:t,mark:n,markDef:r}=e,i={};for(const o of kx){const s=At(t[o]);if(s&&n===vU&&o===hr&&s.type===od)continue;let a=s&&s.scale;if(s&&a!==null&&a!==!1){a??(a={});const u=UU(t,o),l=uwe(a,o,s,r,u);i[o]=new vq(e.scaleName(`${o}`,!0),{value:l,explicit:a.type===l})}}return i}const dwe=xW((e,t)=>cD(e)-cD(t));function hwe(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const o of e.children){Cq(o);for(const s of B(o.component.scales))if((t=i.scale)[s]??(t[s]=rq(s,e)),i.scale[s]==="shared"){const a=r[s],u=o.component.scales[s].getWithExplicit("type");a?Q1e(a.value,u.value)?r[s]=Wa(a,u,"type","scale",dwe):(i.scale[s]="independent",delete r[s]):r[s]=u}}for(const o of B(r)){const s=e.scaleName(o,!0),a=r[o];n[o]=new vq(s,a);for(const u of e.children){const l=u.component.scales[o];l&&(u.renameScale(l.get("name"),s),l.merged=!0)}}return n}class Zb{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function ht(e){return(e==null?void 0:e.type)==="unit"}function Fr(e){return(e==null?void 0:e.type)==="facet"}function OT(e){return(e==null?void 0:e.type)==="concat"}function cd(e){return(e==null?void 0:e.type)==="layer"}class RT{constructor(t,n,r,i,o,s,a){this.type=n,this.parent=r,this.config=o,this.correctDataNames=u=>{var l,c,f;return(l=u.from)!=null&&l.data&&(u.from.data=this.lookupDataSource(u.from.data)),(f=(c=u.from)==null?void 0:c.facet)!=null&&f.data&&(u.from.facet.data=this.lookupDataSource(u.from.facet.data)),u},this.parent=r,this.config=o,this.view=er(a),this.name=t.name??i,this.title=Ys(t.title)?{text:t.title}:t.title?er(t.title):void 0,this.scaleNameMap=r?r.scaleNameMap:new Zb,this.projectionNameMap=r?r.projectionNameMap:new Zb,this.signalNameMap=r?r.signalNameMap:new Zb,this.data=t.data,this.description=t.description,this.transforms=bxe(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:_ve(t,n,o),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:Rx(t)||(r==null?void 0:r.component.data.isFaceted)&&t.data===void 0},layoutSize:new Ps,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...s?fe(s):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){cwe(this)}parseProjection(){hq(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){uq(this)}assembleEncodeFromView(t){const{style:n,...r}=t,i={};for(const o of B(r)){const s=r[o];s!==void 0&&(i[o]=Je(s))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Je(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n}:Ue(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:r,config:i}=this,o=R2e(r.layoutHeaders,i);return{padding:t,...this.assembleDefaultLayout(),...n,...o?{titleBand:o}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of Kr)t[r].title&&n.push(A2e(this,r));for(const r of _T)n=n.concat(T2e(this,r));return n}assembleAxes(){return g2e(this.component.axes,this.config)}assembleLegends(){return cq(this)}assembleProjections(){return rbe(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},r={...Lj(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(r.text)return Se(["unit","layer"],this.type)?Se(["middle",void 0],r.anchor)&&(r.frame??(r.frame="group")):r.anchor??(r.anchor="start"),Ue(r)?void 0:r}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||Fr(this.parent)?yq(this):[];i.length>0&&(n.scales=i);const o=this.assembleAxes();o.length>0&&(n.axes=o);const s=this.assembleLegends();return s.length>0&&(n.legends=s),n}getName(t){return nt((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Ge[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(r[n]||0)+1,n}getSizeSignalRef(t){if(Fr(this.parent)){const n=tq(t),r=_x(n),i=this.component.scales[r];if(i&&!i.merged){const o=i.get("type"),s=i.get("range");if(Wt(o)&&lu(s)){const a=i.get("name"),u=Qx(this,r),l=NT(u);if(l){const c=Y({aggregate:"distinct",field:l},{expr:"datum"});return{signal:eq(a,i,c)}}else return U(O3(r)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(Aj(t)&&Rs(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(C0e(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)==null?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)==null?void 0:n.some(r=>r.hasOrientSignalRef()))}}class Aq extends RT{vgField(t,n={}){const r=this.fieldDef(t);if(r)return Y(r,n)}reduceFieldDef(t,n){return Zye(this.getMapping(),(r,i,o)=>{const s=To(i);return s?t(r,s,o):r},n)}forEachFieldDef(t,n){sT(this.getMapping(),(r,i)=>{const o=To(r);o&&t(o,i)},n)}}class Kx extends je{clone(){return new Kx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"value",r[1]??"density"]}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${Ee(this.transform)}`}assemble(){const{density:t,...n}=this.transform,r={type:"kde",field:t,...n};return this.transform.groupby&&(r.resolve="shared"),r}}class Jx extends je{clone(){return new Jx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${Ee(this.transform)}`}assemble(){const{extent:t,param:n}=this.transform;return{type:"extent",field:t,signal:n}}}class Ip extends je{clone(){return new Ip(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n){const{config:r,mark:i,markDef:o}=n;if(De("invalid",o,r)!=="filter")return null;const a=n.reduceFieldDef((u,l,c)=>{const f=Rs(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");Pr(d)&&l.aggregate!=="count"&&!cu(i)&&(u[l.field]=l)}return u},{});return B(a).length?new Ip(t,a):null}dependentFields(){return new Set(B(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${Ee(this.filter)}`}assemble(){const t=B(this.filter).reduce((n,r)=>{const i=this.filter[r],o=Y(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${o}) || (isValid(${o}) && isFinite(+${o})))`):i.type==="quantitative"&&(n.push(`isValid(${o})`),n.push(`isFinite(+${o})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class Zx extends je{clone(){return new Zx(this.parent,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((o,s)=>i[s]??o)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${Ee(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class e2 extends je{clone(){return new e2(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"key",r[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${Ee(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Gc extends je{clone(){return new Gc(null,fe(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[Ki,Qi],[li,Ji]]){const o=i.map(s=>{const a=At(n.encoding[s]);return W(a)?a.field:Uo(a)?{expr:`${a.datum}`}:Wi(a)?{expr:`${a.value}`}:void 0});(o[0]||o[1])&&(t=new Gc(t,o,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(hr)){const i=n.typedFieldDef(hr);i.type===od&&(t=new Gc(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}dependentFields(){const t=(this.fields??[]).filter(K);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${Ee(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class Bp extends je{clone(){return new Bp(null,this.projection,fe(this.fields),fe(this.as))}constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[Ki,Qi],[li,Ji]]){const i=r.map(s=>{const a=At(n.encoding[s]);return W(a)?a.field:Uo(a)?{expr:`${a.datum}`}:Wi(a)?{expr:`${a.value}`}:void 0}),o=r[0]===li?"2":"";(i[0]||i[1])&&(t=new Bp(t,n.projectionName(),i,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(K))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${Ee(this.fields)} ${Ee(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class el extends je{clone(){return new el(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new el(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,o=r.y;if(W(i)&&W(o)){const s=i.impute?i:o.impute?o:void 0;if(s===void 0)return;const a=i.impute?o:o.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=s.impute,d=qU(n.mark,r);return new el(t,{impute:s.field,key:a.field,...u?{method:u}:{},...l!==void 0?{value:l}:{},...c?{frame:c}:{},...f!==void 0?{keyvals:f}:{},...d.length?{groupby:d}:{}})}return null}hash(){return`Impute ${Ee(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:o,value:s,frame:a=[null,null]}=this.transform,u={type:"impute",field:t,key:n,...r?{keyvals:txe(r)?this.processSequence(r):r}:{},method:"value",...o?{groupby:o}:{},value:!i||i==="value"?s:null};if(i&&i!=="value"){const l={type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:a,ignorePeers:!1,...o?{groupby:o}:{}},c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class t2 extends je{clone(){return new t2(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${Ee(this.transform)}`}assemble(){const{loess:t,on:n,...r}=this.transform;return{type:"loess",x:n,y:t,...r}}}class jp extends je{clone(){return new jp(null,fe(this.transform),this.secondary)}constructor(t,n,r){super(t),this.transform=n,this.secondary=r}static make(t,n,r,i){const o=n.component.data.sources,{from:s}=r;let a=null;if(nxe(s)){let u=Mq(s.data,o);u||(u=new Cl(s.data),o.push(u));const l=n.getName(`lookup_${i}`);a=new jn(u,l,Ge.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(rxe(s)){const u=s.param;r={as:u,...r};let l;try{l=n.getSelectionComponent(nt(u),u)}catch{throw new Error(M0e(u))}if(a=l.materialized,!a)throw new Error(N0e(u))}return new jp(t,r,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Q(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${Ee({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:Q(this.transform.as)}:{}};else{let n=this.transform.as;K(n)||(U(B0e),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class n2 extends je{clone(){return new n2(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"prob",r[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${Ee(this.transform)}`}assemble(){const{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}}class r2 extends je{clone(){return new r2(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${Ee(this.transform)}`}assemble(){const{regression:t,on:n,...r}=this.transform;return{type:"regression",x:n,y:t,...r}}}class i2 extends je{clone(){return new i2(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=ho((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${Ee(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:o}=this.transform;return{type:"pivot",field:t,value:n,...i!==void 0?{limit:i}:{},...o!==void 0?{op:o}:{},...r!==void 0?{groupby:r}:{}}}}class o2 extends je{clone(){return new o2(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${Ee(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function Tq(e){let t=0;function n(r,i){if(r instanceof Cl&&!r.isGenerator&&!Nf(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof vn&&(r.parent instanceof Cl&&!i.source?(i.format={...i.format,parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof ud){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,e.push(...r.assemble());return}switch((r instanceof jg||r instanceof Ug||r instanceof Ip||r instanceof ad||r instanceof Rf||r instanceof Bp||r instanceof zi||r instanceof jp||r instanceof ld||r instanceof Yl||r instanceof e2||r instanceof Zx||r instanceof Kx||r instanceof t2||r instanceof n2||r instanceof r2||r instanceof Ga||r instanceof o2||r instanceof i2||r instanceof Jx)&&i.transform.push(r.assemble()),(r instanceof wo||r instanceof bo||r instanceof el||r instanceof ys||r instanceof Gc)&&i.transform.push(...r.assemble()),r instanceof jn&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof jn?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof jn&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const s of r.children)n(s,{name:null,source:o,transform:[]});break}}}return n}function pwe(e){const t=[],n=Tq(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function gwe(e,t){const n=[],r=Tq(n);let i=0;for(const s of e.sources){s.hasName()||(s.dataName=`source_${i++}`);const a=s.assemble();r(s,a)}for(const s of n)s.transform.length===0&&delete s.transform;let o=0;for(const[s,a]of n.entries())(a.transform??[]).length===0&&!a.source&&n.splice(o++,0,n.splice(s,1)[0]);for(const s of n)for(const a of s.transform??[])a.type==="lookup"&&(a.from=e.outputNodes[a.from].getSource());for(const s of n)s.name in t&&(s.values=t[s.name]);return n}function mwe(e){return e==="top"||e==="left"||ne(e)?"header":"footer"}function ywe(e){for(const t of Kr)vwe(e,t);o5(e,"x"),o5(e,"y")}function vwe(e,t){var s;const{facet:n,config:r,child:i,component:o}=e;if(e.channelHasField(t)){const a=n[t],u=Pf("title",null,r,t);let l=qc(a,r,{allowDisabling:!0,includeDefault:u===void 0||!!u});i.component.layoutHeaders[t].title&&(l=I(l)?l.join(", "):l,l+=` / ${i.component.layoutHeaders[t].title}`,i.component.layoutHeaders[t].title=null);const c=Pf("labelOrient",a.header,r,t),f=a.header!==null?vt((s=a.header)==null?void 0:s.labels,r.header.labels,!0):!1,d=Se(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:a.header!==null?l:null,facetFieldDef:a,[d]:t==="facet"?[]:[Fq(e,t,f)]}}}function Fq(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function o5(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:r,resolve:i}=e.component;if(i.axis[t]=CT(i,t),i.axis[t]==="shared"){const o=t==="x"?"column":"row",s=r[o];for(const a of n.component.axes[t]){const u=mwe(a.get("orient"));s[u]??(s[u]=[Fq(e,o,!1)]);const l=yh(a,"main",e.config,{header:!0});l&&s[u][0].axes.push(l),a.mainExtracted=!0}}}}function xwe(e){DT(e),Ny(e,"width"),Ny(e,"height")}function bwe(e){DT(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";Ny(e,t),Ny(e,n)}function DT(e){for(const t of e.children)t.parseLayoutSize()}function Ny(e,t){const n=tq(t),r=_x(n),i=e.component.resolve,o=e.component.layoutSize;let s;for(const a of e.children){const u=a.component.layoutSize.getWithExplicit(n),l=i.scale[r]??rq(r,e);if(l==="independent"&&u.value==="step"){s=void 0;break}if(s){if(l==="independent"&&s.value!==u.value){s=void 0;break}s=Wa(s,u,n,"")}else s=u}if(s){for(const a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,s)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function wwe(e){const{size:t,component:n}=e;for(const r of jo){const i=pr(r);if(t[i]){const o=t[i];n.layoutSize.set(i,Fo(o)?"step":o,!0)}else{const o=Ewe(e,i);n.layoutSize.set(i,o,!1)}}}function Ewe(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const o=i.get("type"),s=i.get("range");if(Wt(o)){const a=Ay(r.view,t);return lu(s)||Fo(a)?"step":a}else return n_(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return n_(r.view,t);{const o=Ay(r.view,t);return Fo(o)?o.step:o}}}function m_(e,t,n){return Y(t,{suffix:`by_${Y(e)}`,...n})}class qh extends Aq{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=BT(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!Pg(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=B(t),r={};for(const i of n){if(![ps,gs].includes(i)){U(Cx(i,"facet"));break}const o=t[i];if(o.field===void 0){U(KS(o,i));break}r[i]=this.initFacetFieldDef(o,i)}return r}initFacetFieldDef(t,n){const r=iT(t,n);return r.header?r.header=er(r.header):r.header===null&&(r.header=null),r}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=s2(this),this.child.parseData()}parseLayoutSize(){DT(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),ywe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const n of Kr)for(const r of kT){const i=this.component.layoutHeaders[n],o=i[r],{facetFieldDef:s}=i;if(s){const a=Pf("titleOrient",s.header,this.config,n);if(["right","bottom"].includes(a)){const u=Yx(n,a);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[u]="end"}}if(o!=null&&o[0]){const a=n==="row"?"height":"width",u=r==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(a)&&(t[u]??(t[u]={}),t[u][n]=.5),i.title&&(t.offset??(t.offset={}),t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),{...this.getHeaderLayoutMixins(),...r?{columns:r}:{},bounds:"full",align:i}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof qh))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof qh?{...this.channelHasField("column")?{encode:{update:{columns:{field:Y(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof qh){if(this.child.channelHasField("column")){const i=Y(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of jo){const o=this.child.component.scales[i];if(o&&!o.merged){const s=o.get("type"),a=o.get("range");if(Wt(s)&&lu(a)){const u=Qx(this.child,i),l=NT(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):U(O3(i))}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:o,ops:s,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const c of Kr){const f=this.facet[c];if(f){u.push(Y(f));const{bin:d,sort:h}=f;if(Ye(d)&&u.push(Y(f,{binSuffix:"end"})),xo(h)){const{field:p,op:g=Ox}=h,m=m_(f,h);r&&i?(o.push(m),s.push("max"),a.push(m)):(o.push(p),s.push(g),a.push(m))}else if(I(h)){const p=Df(f,c);o.push(p),s.push("max"),a.push(p)}}}const l=!!r&&!!i;return{name:t,data:n,groupby:u,...l||o.length>0?{aggregate:{...l?{cross:l}:{},...o.length?{fields:o,ops:s,as:a}:{}}}:{}}}facetSortFields(t){const{facet:n}=this,r=n[t];return r?xo(r.sort)?[m_(r,r.sort,{expr:"datum"})]:I(r.sort)?[Df(r,t,{expr:"datum"})]:[Y(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(xo(i)?i.order:!I(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){var i;const{facet:t,config:n}=this;if(t.facet)return c_(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const o of _T)if(t[o]){const s=Pf("labelOrient",(i=t[o])==null?void 0:i.header,n,o);if(r[o].includes(s))return c_(t[o],o,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=pwe(n),i=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),s=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...o?{title:o}:{},...s?{style:s}:{},from:{facet:this.assembleFacet()},sort:{field:Kr.map(u=>this.facetSortFields(u)).flat(),order:Kr.map(u=>this.facetSortOrder(u)).flat()},...r.length>0?{data:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup(Oxe(this,[]))}]}getMapping(){return this.facet}}function Swe(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const o of[n,r])if(xo(o.sort)){const{field:s,op:a=Ox}=o.sort;e=i=new Yl(e,{joinaggregate:[{op:a,field:s,as:m_(o,o.sort,{forAs:!0})}],groupby:[Y(o)]})}return i}return null}function Mq(e,t){var n,r,i,o;for(const s of t){const a=s.data;if(e.name&&s.hasName()&&e.name!==s.dataName)continue;const u=(n=e.format)==null?void 0:n.mesh,l=(r=a.format)==null?void 0:r.feature;if(u&&l)continue;const c=(i=e.format)==null?void 0:i.feature;if((c||l)&&c!==l)continue;const f=(o=a.format)==null?void 0:o.mesh;if(!((u||f)&&u!==f)){if(zp(e)&&zp(a)){if($r(e.values,a.values))return s}else if(Nf(e)&&Nf(a)){if(e.url===a.url)return s}else if(bW(e)&&e.name===s.dataName)return s}}return null}function _we(e,t){if(e.data||!e.parent){if(e.data===null){const r=new Cl({values:[]});return t.push(r),r}const n=Mq(e.data,t);if(n)return ka(e.data)||(n.data.format=mj({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new Cl(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function kwe(e,t,n){let r=0;for(const i of t.transforms){let o,s;if(hxe(i))s=e=new Rf(e,i),o="derived";else if(yT(i)){const a=mbe(i);s=e=vn.makeWithAncestors(e,{},a,n)??e,e=new ad(e,t,i.filter)}else if(gW(i))s=e=wo.makeFromTransform(e,i,t),o="number";else if(gxe(i))o="date",n.getWithExplicit(i.field).value===void 0&&(e=new vn(e,{[i.field]:o}),n.set(i.field,o,!1)),s=e=bo.makeFromTransform(e,i);else if(mxe(i))s=e=zi.makeFromTransform(e,i),o="number",ST(t)&&(e=new Ga(e));else if(pW(i))s=e=jp.make(e,t,i,r++),o="derived";else if(cxe(i))s=e=new ld(e,i),o="number";else if(fxe(i))s=e=new Yl(e,i),o="number";else if(yxe(i))s=e=ys.makeFromTransform(e,i),o="derived";else if(vxe(i))s=e=new e2(e,i),o="derived";else if(xxe(i))s=e=new Jx(e,i),o="derived";else if(dxe(i))s=e=new Zx(e,i),o="derived";else if(ixe(i))s=e=new i2(e,i),o="derived";else if(lxe(i))e=new o2(e,i);else if(pxe(i))s=e=el.makeFromTransform(e,i),o="derived";else if(oxe(i))s=e=new Kx(e,i),o="derived";else if(sxe(i))s=e=new n2(e,i),o="derived";else if(axe(i))s=e=new r2(e,i),o="derived";else if(uxe(i))s=e=new t2(e,i),o="derived";else{U(I0e(i));continue}if(s&&o!==void 0)for(const a of s.producedFields()??[])n.set(a,o,!1)}return e}function s2(e){var g;let t=_we(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:r}=e.component.data,i=e.data,s=!(i&&(ka(i)||Nf(i)||zp(i)))&&e.parent?e.parent.component.data.ancestorParse.clone():new Mxe;ka(i)?(wW(i)?t=new Ug(t,i.sequence):vT(i)&&(t=new jg(t,i.graticule)),s.parseNothing=!0):((g=i==null?void 0:i.format)==null?void 0:g.parse)===null&&(s.parseNothing=!0),t=vn.makeExplicit(t,e,s)??t,t=new Ga(t);const a=e.parent&&cd(e.parent);(ht(e)||Fr(e))&&a&&(t=wo.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=kwe(t,e,s));const u=vbe(e),l=ybe(e);t=vn.makeWithAncestors(t,{},{...u,...l},s)??t,ht(e)&&(t=Gc.parseAll(t,e),t=Bp.parseAll(t,e)),(ht(e)||Fr(e))&&(a||(t=wo.makeFromEncoding(t,e)??t),t=bo.makeFromEncoding(t,e)??t,t=Rf.parseAllForSortIndex(t,e));const c=e.getDataName(Ge.Raw),f=new jn(t,c,Ge.Raw,r);if(n[c]=f,t=f,ht(e)){const m=zi.makeFromEncoding(t,e);m&&(t=m,ST(e)&&(t=new Ga(t))),t=el.makeFromEncoding(t,e)??t,t=ys.makeFromEncoding(t,e)??t}ht(e)&&(t=Ip.make(t,e)??t);const d=e.getDataName(Ge.Main),h=new jn(t,d,Ge.Main,r);n[d]=h,t=h,ht(e)&&h2e(e,h);let p=null;if(Fr(e)){const m=e.getName("facet");t=Swe(t,e.facet)??t,p=new ud(t,e,m,h.getSource()),n[m]=p}return{...e.component.data,outputNodes:n,outputNodeRefCounts:r,raw:f,main:h,facetRoot:p,ancestorParse:s}}class $we extends RT{constructor(t,n,r,i){var o,s,a,u;super(t,"concat",n,r,i,t.resolve),(((s=(o=t.resolve)==null?void 0:o.axis)==null?void 0:s.x)==="shared"||((u=(a=t.resolve)==null?void 0:a.axis)==null?void 0:u.y)==="shared")&&U(P0e),this.children=this.getChildren(t).map((l,c)=>BT(l,this,this.getName(`concat_${c}`),void 0,i))}parseData(){this.component.data=s2(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of B(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return jx(t)?t.vconcat:gT(t)?t.hconcat:t.concat}parseLayoutSize(){bwe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=$T(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...r?{style:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}}function Cwe(e){return e===!1||e===null}const Awe={disable:1,gridScale:1,scale:1,...IU,labelExpr:1,encode:1},Nq=B(Awe);class PT extends Ps{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new PT(fe(this.explicit),fe(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Cwe(this.get(t))}hasOrientSignalRef(){return ne(this.explicit.orient)}}function Twe(e,t,n){const{encoding:r,config:i}=e,o=At(r[t])??At(r[Bo(t)]),s=e.axis(t)||{},{format:a,formatType:u}=s;if(_l(u))return{text:Ri({fieldOrDatumDef:o,field:"datum.value",format:a,formatType:u,config:i}),...n};if(a===void 0&&u===void 0&&i.customFormatTypes){if(Tf(o)==="quantitative"){if(Ff(o)&&o.stack==="normalize"&&i.normalizedNumberFormatType)return{text:Ri({fieldOrDatumDef:o,field:"datum.value",format:i.normalizedNumberFormat,formatType:i.normalizedNumberFormatType,config:i}),...n};if(i.numberFormatType)return{text:Ri({fieldOrDatumDef:o,field:"datum.value",format:i.numberFormat,formatType:i.numberFormatType,config:i}),...n}}if(Tf(o)==="temporal"&&i.timeFormatType&&W(o)&&!o.timeUnit)return{text:Ri({fieldOrDatumDef:o,field:"datum.value",format:i.timeFormat,formatType:i.timeFormatType,config:i}),...n}}return n}function Fwe(e){return jo.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[Lwe(n,e)]),t),{})}const Mwe={bottom:"top",top:"bottom",left:"right",right:"left"};function Nwe(e){const{axes:t,resolve:n}=e.component,r={top:0,bottom:0,right:0,left:0};for(const i of e.children){i.parseAxesAndHeaders();for(const o of B(i.component.axes))n.axis[o]=CT(e.component.resolve,o),n.axis[o]==="shared"&&(t[o]=Owe(t[o],i.component.axes[o]),t[o]||(n.axis[o]="independent",delete t[o]))}for(const i of jo){for(const o of e.children)if(o.component.axes[i]){if(n.axis[i]==="independent"){t[i]=(t[i]??[]).concat(o.component.axes[i]);for(const s of o.component.axes[i]){const{value:a,explicit:u}=s.getWithExplicit("orient");if(!ne(a)){if(r[a]>0&&!u){const l=Mwe[a];r[a]>r[l]&&s.set("orient",l,!1)}r[a]++}}}delete o.component.axes[i]}if(n.axis[i]==="independent"&&t[i]&&t[i].length>1)for(const[o,s]of(t[i]||[]).entries())o>0&&s.get("grid")&&!s.explicit.grid&&(s.implicit.grid=!1)}}function Owe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],o=t[r];if(!!i!=!!o)return;if(i&&o){const s=i.getWithExplicit("orient"),a=o.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;e[r]=Rwe(i,o)}}}else return t.map(n=>n.clone());return e}function Rwe(e,t){for(const n of Nq){const r=Wa(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,o)=>{switch(n){case"title":return qj(i,o);case"gridScale":return{explicit:i.explicit,value:vt(i.value,o.value)}}return Wx(i,o,n,"axis")});e.setWithExplicit(n,r)}return e}function Dwe(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(ne(n.labelAngle)?n.labelAngle:Pp(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===QW(r,i))return!0}return e===n[t]}const Pwe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Lwe(e,t){var y,v;let n=t.axis(e);const r=new PT,i=At(t.encoding[e]),{mark:o,config:s}=t,a=(n==null?void 0:n.orient)||((y=s[e==="x"?"axisX":"axisY"])==null?void 0:y.orient)||((v=s.axis)==null?void 0:v.orient)||S2e(e),u=t.getScaleComponent(e).get("type"),l=m2e(e,u,a,t.config),c=n!==void 0?!n:u_("disable",s.style,n==null?void 0:n.style,l).configValue;if(r.set("disable",c,n!==void 0),c)return r;n=n||{};const f=b2e(i,n,e,s.style,l),d=_U(n.formatType,i,u),h=SU(i,i.type,n.format,n.formatType,s,!0),p={fieldOrDatumDef:i,axis:n,channel:e,model:t,scaleType:u,orient:a,labelAngle:f,format:h,formatType:d,mark:o,config:s};for(const x of Nq){const b=x in qD?qD[x](p):yD(x)?n[x]:void 0,w=b!==void 0,S=Dwe(b,x,n,t,e);if(w&&S)r.set(x,b,S);else{const{configValue:E=void 0,configFrom:_=void 0}=yD(x)&&x!=="values"?u_(x,s.style,n.style,l):{},k=E!==void 0;w&&!k?r.set(x,b,S):(_!=="vgAxisConfig"||Pwe.has(x)&&k||Ig(E)||ne(E))&&r.set(x,E,!1)}}const g=n.encoding??{},m=zU.reduce((x,b)=>{if(!r.hasAxisPart(b))return x;const w=nq(g[b]??{},t),S=b==="labels"?Twe(t,e,w):w;return S!==void 0&&!Ue(S)&&(x[b]={update:S}),x},{});return Ue(m)||r.set("encode",m,!!n.encoding||n.labelAngle!==void 0),r}function zwe({encoding:e,size:t}){for(const n of jo){const r=pr(n);Fo(t[r])&&ca(e[n])&&(delete t[r],U(Xj(r)))}return t}const Iwe={vgMark:"arc",encodeEntry:e=>({...di(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...yn("x",e,{defaultPos:"mid"}),...yn("y",e,{defaultPos:"mid"}),...qa(e,"radius"),...qa(e,"theta")})},Bwe={vgMark:"area",encodeEntry:e=>({...di(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...Ty("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...Ty("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...ET(e)})},jwe={vgMark:"rect",encodeEntry:e=>({...di(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...qa(e,"x"),...qa(e,"y")})},Uwe={vgMark:"shape",encodeEntry:e=>({...di(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&W(n)&&n.type===od?{field:Y(n,{expr:"datum"})}:{}}]}},Wwe={vgMark:"image",encodeEntry:e=>({...di(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...qa(e,"x"),...qa(e,"y"),...bT(e,"url")})},qwe={vgMark:"line",encodeEntry:e=>({...di(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...yn("x",e,{defaultPos:"mid"}),...yn("y",e,{defaultPos:"mid"}),...Dt("size",e,{vgChannel:"strokeWidth"}),...ET(e)})},Hwe={vgMark:"trail",encodeEntry:e=>({...di(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...yn("x",e,{defaultPos:"mid"}),...yn("y",e,{defaultPos:"mid"}),...Dt("size",e),...ET(e)})};function LT(e,t){const{config:n}=e;return{...di(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...yn("x",e,{defaultPos:"mid"}),...yn("y",e,{defaultPos:"mid"}),...Dt("size",e),...Dt("angle",e),...Gwe(e,n,t)}}function Gwe(e,t,n){return n?{shape:{value:n}}:Dt("shape",e)}const Vwe={vgMark:"symbol",encodeEntry:e=>LT(e)},Ywe={vgMark:"symbol",encodeEntry:e=>LT(e,"circle")},Xwe={vgMark:"symbol",encodeEntry:e=>LT(e,"square")},Qwe={vgMark:"rect",encodeEntry:e=>({...di(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...qa(e,"x"),...qa(e,"y")})},Kwe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...di(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ty("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...Ty("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...Dt("size",e,{vgChannel:"strokeWidth"})}}},Jwe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...di(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...yn("x",e,{defaultPos:"mid"}),...yn("y",e,{defaultPos:"mid"}),...bT(e),...Dt("size",e,{vgChannel:"fontSize"}),...Dt("angle",e),...BD("align",Zwe(e.markDef,n,t)),...BD("baseline",eEe(e.markDef,n,t)),...yn("radius",e,{defaultPos:null}),...yn("theta",e,{defaultPos:null})}}};function Zwe(e,t,n){if(De("align",e,n)===void 0)return"center"}function eEe(e,t,n){if(De("baseline",e,n)===void 0)return"middle"}const tEe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",o=r==="horizontal"?"height":"width";return{...di(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...yn("x",e,{defaultPos:"mid",vgChannel:"xc"}),...yn("y",e,{defaultPos:"mid",vgChannel:"yc"}),...Dt("size",e,{defaultValue:nEe(e),vgChannel:i}),[o]:Je(De("thickness",n,t))}}};function nEe(e){const{config:t,markDef:n}=e,{orient:r}=n,i=r==="horizontal"?"width":"height",o=e.getScaleComponent(r==="horizontal"?"x":"y"),s=De("size",n,t,{vgChannel:i})??t.tick.bandSize;if(s!==void 0)return s;{const a=o?o.get("range"):void 0;return a&&lu(a)&&Te(a.step)?a.step*3/4:Cy(t.view,i)*3/4}}const Bm={arc:Iwe,area:Bwe,bar:jwe,circle:Ywe,geoshape:Uwe,image:Wwe,line:qwe,point:Vwe,rect:Qwe,rule:Kwe,square:Xwe,text:Jwe,tick:tEe,trail:Hwe};function rEe(e){if(Se([Mx,Tx,fye],e.mark)){const t=qU(e.mark,e.encoding);if(t.length>0)return iEe(e,t)}else if(e.mark===Fx){const t=QS.some(n=>De(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return oEe(e)}return zT(e)}const s5="faceted_path_";function iEe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:s5+e.requestDataName(Ge.Main),data:e.requestDataName(Ge.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:zT(e,{fromPrefix:s5})}]}const a5="stack_group_";function oEe(e){var l;const[t]=zT(e,{fromPrefix:a5}),n=e.scaleName(e.stack.fieldChannel),r=(c={})=>e.vgField(e.stack.fieldChannel,c),i=(c,f)=>{const d=[r({prefix:"min",suffix:"start",expr:f}),r({prefix:"max",suffix:"start",expr:f}),r({prefix:"min",suffix:"end",expr:f}),r({prefix:"max",suffix:"end",expr:f})];return`${c}(${d.map(h=>`scale('${n}',${h})`).join(",")})`};let o,s;e.stack.fieldChannel==="x"?(o={...Sf(t.encode.update,["y","yc","y2","height",...QS]),x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}},s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...ar(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(o={...Sf(t.encode.update,["x","xc","x2","width"]),y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}},s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...ar(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const c of QS){const f=$s(c,e.markDef,e.config);t.encode.update[c]?(o[c]=t.encode.update[c],delete t.encode.update[c]):f&&(o[c]=Je(f)),f&&(t.encode.update[c]={value:0})}const a=[];if(((l=e.stack.groupbyChannels)==null?void 0:l.length)>0)for(const c of e.stack.groupbyChannels){const f=e.fieldDef(c),d=Y(f);d&&a.push(d),(f!=null&&f.bin||f!=null&&f.timeUnit)&&a.push(Y(f,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,f)=>{if(t.encode.update[f])return{...c,[f]:t.encode.update[f]};{const d=$s(f,e.markDef,e.config);return d!==void 0?{...c,[f]:Je(d)}:c}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Ge.Main),name:a5+e.requestDataName(Ge.Main),groupby:a,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[t]}]}]}function sEe(e){var a;const{encoding:t,stack:n,mark:r,markDef:i,config:o}=e,s=t.order;if(!(!I(s)&&Wi(s)&&YS(s.value)||!s&&YS(De("order",i,o)))){if((I(s)||W(s))&&!n)return jj(s,{expr:"datum"});if(cu(r)){const u=i.orient==="horizontal"?"y":"x",l=t[u];if(W(l)){const c=l.sort;if(I(c))return{field:Y(l,{prefix:u,suffix:"sort_index",expr:"datum"})};if(xo(c))return{field:Y({aggregate:oT(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})};if($U(c)){const f=e.fieldDef(c.encoding);return{field:Y(f,{expr:"datum"}),order:c.order}}else return c===null?void 0:{field:Y(l,{binSuffix:(a=e.stack)!=null&&a.impute?"mid":void 0,expr:"datum"})}}return}}}function zT(e,t={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:o}=e,s=vt(r.clip,aEe(e),uEe(e)),a=Ij(r),u=i.key,l=sEe(e),c=lEe(e),f=De("aria",r,o),d=Bm[n].postEncodingTransform?Bm[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:Bm[n].vgMark,...s?{clip:s}:{},...a?{style:a}:{},...u?{key:u.field}:{},...l?{sort:l}:{},...c||{},...f===!1?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(Ge.Main)},encode:{update:Bm[n].encodeEntry(e)},...d?{transform:d}:{}}]}function aEe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t!=null&&t.get("selectionExtent")||n!=null&&n.get("selectionExtent")?!0:void 0}function uEe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function lEe(e){if(!e.component.selection)return null;const t=B(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=B(r.component.selection).length,r=r.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}class Oq extends Aq{constructor(t,n,r,i={},o){super(t,"unit",n,r,o,void 0,xD(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const s=Ao(t.mark)?{...t.mark}:{type:t.mark},a=s.type;s.filled===void 0&&(s.filled=Vve(s,o,{graticule:t.data&&vT(t.data)}));const u=this.encoding=Kye(t.encoding||{},a,s.filled,o);this.markDef=fW(s,u,o),this.size=zwe({encoding:u,size:xD(t)?{...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:i}),this.stack=cW(this.markDef,u),this.specifiedScales=this.initScales(a,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(l=>hT(l))}get hasProjection(){const{encoding:t}=this,n=this.mark===vU,r=t&&Xme.some(i=>de(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return kx.reduce((r,i)=>{const o=At(n[i]);return o&&(r[i]=this.initScale(o.scale??{})),r},{})}initScale(t){const{domain:n,range:r}=t,i=er(t);return I(n)&&(i.domain=n.map(Er)),I(r)&&(i.range=r.map(Er)),i}initAxes(t){return jo.reduce((n,r)=>{const i=t[r];if(de(i)||r===rt&&de(t.x2)||r===Ht&&de(t.y2)){const o=de(i)?i.axis:void 0;n[r]=o&&this.initAxis({...o})}return n},{})}initAxis(t){const n=B(t),r={};for(const i of n){const o=t[i];r[i]=Ig(o)?zj(o):Er(o)}return r}initLegends(t){return o0e.reduce((n,r)=>{const i=At(t[r]);if(i&&a0e(r)){const o=i.legend;n[r]=o&&er(o)}return n},{})}parseData(){this.component.data=s2(this)}parseLayoutSize(){wwe(this)}parseSelections(){this.component.selection=d2e(this,this.selection)}parseMarkGroup(){this.component.mark=rEe(this)}parseAxesAndHeaders(){this.component.axes=Fwe(this)}assembleSelectionTopLevelSignals(t){return Rxe(this,t)}assembleSignals(){return[...VW(this),...Nxe(this,[])]}assembleSelectionData(t){return Dxe(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return $T(this)}assembleMarks(){let t=this.component.mark??[];return(!this.parent||!cd(this.parent))&&(t=_W(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Ju(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return To(n)}typedFieldDef(t){const n=this.fieldDef(t);return qn(n)?n:null}}class IT extends RT{constructor(t,n,r,i,o){super(t,"layer",n,r,o,t.resolve,t.view);const s={...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((a,u)=>{if(Ux(a))return new IT(a,this,this.getName(`layer_${u}`),s,o);if(Ds(a))return new Oq(a,this,this.getName(`layer_${u}`),s,o);throw new Error(N3(a))})}parseData(){this.component.data=s2(this);for(const t of this.children)t.parseData()}parseLayoutSize(){xwe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of B(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){Nwe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),VW(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),$T(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const r of this.children)for(const i of Q(r.assembleGroupStyle()))t.add(i);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return Pxe(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),cq(this))}}function BT(e,t,n,r,i){if(Rx(e))return new qh(e,t,n,i);if(Ux(e))return new IT(e,t,n,r,i);if(Ds(e))return new Oq(e,t,n,r,i);if(wve(e))return new $we(e,t,n,i);throw new Error(N3(e))}function cEe(e,t={}){t.logger&&$1e(t.logger),t.fieldTitle&&DU(t.fieldTitle);try{const n=lW(Uf(t.config,e.config)),r=vW(e,n),i=BT(r,null,"",void 0,n);return i.parse(),Rbe(i.component.data,i),{spec:dEe(i,fEe(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&C1e(),t.fieldTitle&&Uye()}}function fEe(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):K(t)&&(t={type:t}),i&&o&&Axe(t.type)){if(i==="step"&&o==="step")U(rD()),t.type="pad";else if(i==="step"||o==="step"){const s=i==="step"?"width":"height";U(rD(_x(s)));const a=s==="width"?"height":"width";t.type=Txe(a)}}return{...B(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...MD(n,!1),...MD(e,!0)}}function dEe(e,t,n={},r){const i=e.config?Dve(e.config):void 0,o=[].concat(e.assembleSelectionData([]),gwe(e.component.data,n)),s=e.assembleProjections(),a=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>(h.name==="width"||h.name==="height")&&h.value!==void 0?(t[h.name]=+h.value,!1):!0);const{params:f,...d}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...d,...a?{title:a}:{},...u?{style:u}:{},...l?{encode:{update:l}}:{},data:o,...s.length>0?{projections:s}:{},...e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...oW(f)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}const hEe=Wme.version,pEe=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:_f,accessPathWithDatum:E3,compile:cEe,contains:Se,deepEqual:$r,deleteNestedProperty:yy,duplicate:fe,entries:Ba,every:x3,fieldIntersection:w3,flatAccessWithDatum:vj,getFirstDefined:vt,hasIntersection:b3,hash:Ee,internalField:wj,isBoolean:Dp,isEmpty:Ue,isEqual:Hme,isInternalField:Ej,isNullOrFalse:YS,isNumeric:vx,keys:B,logicalExpr:Uh,mergeDeep:mj,never:gj,normalize:vW,normalizeAngle:Pp,omit:ar,pick:Sf,prefixGenerator:XS,removePathFromField:S3,replaceAll:xl,replacePathInField:ui,resetIdCounter:Vme,setEqual:yj,some:vl,stringify:We,titleCase:Tg,unique:ho,uniqueId:bj,vals:en,varName:nt,version:hEe},Symbol.toStringTag,{value:"Module"}));function Rq(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var gEe="vega-themes",mEe="2.14.0",yEe="Themes for stylized Vega and Vega-Lite visualizations.",vEe=["vega","vega-lite","themes","style"],xEe="BSD-3-Clause",bEe={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},wEe=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],EEe="build/vega-themes.js",jT="build/vega-themes.module.js",SEe="build/vega-themes.min.js",_Ee="build/vega-themes.min.js",kEe="build/vega-themes.module.d.ts",$Ee={type:"git",url:"https://github.com/vega/vega-themes.git"},CEe=["src","build"],AEe={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},TEe={"@babel/core":"^7.22.9","@babel/plugin-proposal-async-generator-functions":"^7.20.7","@babel/plugin-proposal-json-strings":"^7.18.6","@babel/plugin-proposal-object-rest-spread":"^7.20.7","@babel/plugin-proposal-optional-catch-binding":"^7.18.6","@babel/plugin-transform-runtime":"^7.22.9","@babel/preset-env":"^7.22.9","@babel/preset-typescript":"^7.22.5","@release-it/conventional-changelog":"^7.0.0","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.1.0","@rollup/plugin-terser":"^0.4.3","@typescript-eslint/eslint-plugin":"^6.0.0","@typescript-eslint/parser":"^6.0.0","browser-sync":"^2.29.3",concurrently:"^8.2.0",eslint:"^8.45.0","eslint-config-prettier":"^8.8.0","eslint-plugin-prettier":"^5.0.0","gh-pages":"^5.0.0",prettier:"^3.0.0","release-it":"^16.1.0",rollup:"^3.26.2","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.2.0",typescript:"^5.1.6",vega:"^5.25.0","vega-lite":"^5.9.3"},FEe={vega:"*","vega-lite":"*"},MEe={},NEe={name:gEe,version:mEe,description:yEe,keywords:vEe,license:xEe,author:bEe,contributors:wEe,main:EEe,module:jT,unpkg:SEe,jsdelivr:_Ee,types:kEe,repository:$Ee,files:CEe,scripts:AEe,devDependencies:TEe,peerDependencies:FEe,dependencies:MEe};const ac="#fff",u5="#888",OEe={background:"#333",view:{stroke:u5},title:{color:ac,subtitleColor:ac},style:{"guide-label":{fill:ac},"guide-title":{fill:ac}},axis:{domainColor:ac,gridColor:u5,tickColor:ac}},yu="#4572a7",REe={background:"#fff",arc:{fill:yu},area:{fill:yu},line:{stroke:yu,strokeWidth:2},path:{stroke:yu},rect:{fill:yu},shape:{stroke:yu},symbol:{fill:yu,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},vu="#30a2da",ew="#cbcbcb",DEe="#999",PEe="#333",l5="#f0f0f0",c5="#333",LEe={arc:{fill:vu},area:{fill:vu},axis:{domainColor:ew,grid:!0,gridColor:ew,gridWidth:1,labelColor:DEe,labelFontSize:10,titleColor:PEe,tickColor:ew,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:l5,group:{fill:l5},legend:{labelColor:c5,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:c5,titleFontSize:14,titlePadding:10},line:{stroke:vu,strokeWidth:2},path:{stroke:vu,strokeWidth:.5},rect:{fill:vu},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:vu},bar:{binSpacing:2,fill:vu,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},xu="#000",zEe={group:{fill:"#e5e5e5"},arc:{fill:xu},area:{fill:xu},line:{stroke:xu},path:{stroke:xu},rect:{fill:xu},shape:{stroke:xu},symbol:{fill:xu,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},IEe=22,BEe="normal",f5="Benton Gothic, sans-serif",d5=11.5,jEe="normal",bu="#82c6df",tw="Benton Gothic Bold, sans-serif",h5="normal",p5=13,jd={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},UEe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:tw,fontSize:IEe,fontWeight:BEe},arc:{fill:bu},area:{fill:bu},line:{stroke:bu,strokeWidth:2},path:{stroke:bu},rect:{fill:bu},shape:{stroke:bu},symbol:{fill:bu,size:30},axis:{labelFont:f5,labelFontSize:d5,labelFontWeight:jEe,titleFont:tw,titleFontSize:p5,titleFontWeight:h5},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:f5,labelFontSize:d5,symbolType:"square",titleFont:tw,titleFontSize:p5,titleFontWeight:h5},range:{category:jd["category-6"],diverging:jd["fireandice-6"],heatmap:jd["fire-7"],ordinal:jd["fire-7"],ramp:jd["fire-7"]}},wu="#ab5787",jm="#979797",WEe={background:"#f9f9f9",arc:{fill:wu},area:{fill:wu},line:{stroke:wu},path:{stroke:wu},rect:{fill:wu},shape:{stroke:wu},symbol:{fill:wu,size:30},axis:{domainColor:jm,domainWidth:.5,gridWidth:.2,labelColor:jm,tickColor:jm,tickWidth:.2,titleColor:jm},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Eu="#3e5c69",qEe={background:"#fff",arc:{fill:Eu},area:{fill:Eu},line:{stroke:Eu},path:{stroke:Eu},rect:{fill:Eu},shape:{stroke:Eu},symbol:{fill:Eu},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},jr="#1696d2",g5="#000000",HEe="#FFFFFF",Um="Lato",nw="Lato",GEe="Lato",VEe="#DEDDDD",YEe=18,Ud={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},XEe={background:HEe,title:{anchor:"start",fontSize:YEe,font:Um},axisX:{domain:!0,domainColor:g5,domainWidth:1,grid:!1,labelFontSize:12,labelFont:nw,labelAngle:0,tickColor:g5,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Um},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:VEe,gridWidth:1,labelFontSize:12,labelFont:nw,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Um,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:nw,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Um,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Ud["six-groups-cat-1"],diverging:Ud["diverging-colors"],heatmap:Ud["diverging-colors"],ordinal:Ud["six-groups-seq"],ramp:Ud["shades-blue"]},area:{fill:jr},rect:{fill:jr},line:{color:jr,stroke:jr,strokeWidth:5},trail:{color:jr,stroke:jr,strokeWidth:0,size:1},path:{stroke:jr,strokeWidth:.5},point:{filled:!0},text:{font:GEe,color:jr,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:jr,stroke:null}},arc:{fill:jr},shape:{stroke:jr},symbol:{fill:jr,size:30}},Su="#3366CC",m5="#ccc",Wm="Arial, sans-serif",QEe={arc:{fill:Su},area:{fill:Su},path:{stroke:Su},rect:{fill:Su},shape:{stroke:Su},symbol:{stroke:Su},circle:{fill:Su},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Wm,fontSize:12},"guide-title":{font:Wm,fontSize:12},"group-title":{font:Wm,fontSize:12}},title:{font:Wm,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:m5,tickColor:m5,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},UT=e=>e*(1/3+1),y5=UT(9),v5=UT(10),x5=UT(12),Wd="Segoe UI",b5="wf_standard-font, helvetica, arial, sans-serif",w5="#252423",qd="#605E5C",E5="transparent",KEe="#C8C6C4",yi="#118DFF",JEe="#12239E",ZEe="#E66C37",eSe="#6B007B",tSe="#E044A7",nSe="#744EC2",rSe="#D9B300",iSe="#D64550",Dq=yi,Pq="#DEEFFF",S5=[Pq,Dq],oSe=[Pq,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",Dq],sSe={view:{stroke:E5},background:E5,font:Wd,header:{titleFont:b5,titleFontSize:x5,titleColor:w5,labelFont:Wd,labelFontSize:v5,labelColor:qd},axis:{ticks:!1,grid:!1,domain:!1,labelColor:qd,labelFontSize:y5,titleFont:b5,titleColor:w5,titleFontSize:x5,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:KEe,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:yi},line:{stroke:yi,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:Wd,fontSize:y5,fill:qd},arc:{fill:yi},area:{fill:yi,line:!0,opacity:.6},path:{stroke:yi},rect:{fill:yi},point:{fill:yi,filled:!0,size:75},shape:{stroke:yi},symbol:{fill:yi,strokeWidth:1.5,size:50},legend:{titleFont:Wd,titleFontWeight:"bold",titleColor:qd,labelFont:Wd,labelFontSize:v5,labelColor:qd,symbolType:"circle",symbolSize:75},range:{category:[yi,JEe,ZEe,eSe,tSe,nSe,rSe,iSe],diverging:S5,heatmap:S5,ordinal:oSe}},rw='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',_5=400,aSe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],uSe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function a2({type:e,background:t}){const n=e==="dark"?"#161616":"#ffffff",r=e==="dark"?"#f4f4f4":"#161616",i=e==="dark"?aSe:uSe,o=e==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:o},area:{fill:o},path:{stroke:o},rect:{fill:o},shape:{stroke:o},symbol:{stroke:o},circle:{fill:o},view:{fill:n,stroke:n},group:{fill:n},title:{color:r,anchor:"start",dy:-15,fontSize:16,font:rw,fontWeight:600},axis:{labelColor:r,labelFontSize:12,grid:!0,gridColor:"#525252",titleColor:r,labelAngle:0},style:{"guide-label":{font:rw,fill:r,fontWeight:_5},"guide-title":{font:rw,fill:r,fontWeight:_5}},range:{category:i,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const lSe=a2({type:"light",background:"#ffffff"}),cSe=a2({type:"light",background:"#f4f4f4"}),fSe=a2({type:"dark",background:"#262626"}),dSe=a2({type:"dark",background:"#161616"}),hSe=NEe.version,pSe=Object.freeze(Object.defineProperty({__proto__:null,carbong10:cSe,carbong100:dSe,carbong90:fSe,carbonwhite:lSe,dark:OEe,excel:REe,fivethirtyeight:LEe,ggplot2:zEe,googlecharts:QEe,latimes:UEe,powerbi:sSe,quartz:WEe,urbaninstitute:XEe,version:hSe,vox:qEe},Symbol.toStringTag,{value:"Module"}));function gSe(e,t,n,r){if(I(e))return`[${e.map(i=>t(K(i)?i:k5(i,n))).join(", ")}]`;if(J(e)){let i="";const{title:o,image:s,...a}=e;o&&(i+=`<h2>${t(o)}</h2>`),s&&(i+=`<img src="${new URL(t(s),r||location.href).href}">`);const u=Object.keys(a);if(u.length>0){i+="<table>";for(const l of u){let c=a[l];c!==void 0&&(J(c)&&(c=k5(c,n)),i+=`<tr><td class="key">${t(l)}</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function mSe(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function k5(e,t){return JSON.stringify(e,mSe(t))}var ySe=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`;const Lq="vg-tooltip-element",vSe={offsetX:10,offsetY:10,id:Lq,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:xSe,maxDepth:2,formatTooltip:gSe,baseURL:""};function xSe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function bSe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return ySe.toString().replace(Lq,e)}function wSe(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}class ESe{constructor(t){this.options={...vSe,...t};const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=bSe(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:s}=wSe(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.style.top=`${s}px`,this.el.style.left=`${o}px`}}var iw={};function SSe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ow,$5;function _Se(){return $5||($5=1,ow=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),ow}var kSe=Oe;Oe.Node=Al;Oe.create=Oe;function Oe(e){var t=this;if(t instanceof Oe||(t=new Oe),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}Oe.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};Oe.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};Oe.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};Oe.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)CSe(this,arguments[e]);return this.length};Oe.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)ASe(this,arguments[e]);return this.length};Oe.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};Oe.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};Oe.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next};Oe.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev};Oe.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};Oe.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};Oe.prototype.map=function(e,t){t=t||this;for(var n=new Oe,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n};Oe.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Oe,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n};Oe.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n};Oe.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n};Oe.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};Oe.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};Oe.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new Oe;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n};Oe.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new Oe;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n};Oe.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var o=[],r=0;i&&r<t;r++)o.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=$Se(this,i,n[r]);return o};Oe.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function $Se(e,t,n){var r=t===e.head?new Al(n,null,t,e):new Al(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function CSe(e,t){e.tail=new Al(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function ASe(e,t){e.head=new Al(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Al(e,t,n,r){if(!(this instanceof Al))return new Al(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{_Se()(Oe)}catch{}const TSe=kSe,Ru=Symbol("max"),Zo=Symbol("length"),uc=Symbol("lengthCalculator"),Hh=Symbol("allowStale"),Uu=Symbol("maxAge"),Xo=Symbol("dispose"),C5=Symbol("noDisposeOnSet"),Nt=Symbol("lruList"),xi=Symbol("cache"),zq=Symbol("updateAgeOnGet"),sw=()=>1;class FSe{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[Ru]=t.max||1/0;const n=t.length||sw;if(this[uc]=typeof n!="function"?sw:n,this[Hh]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[Uu]=t.maxAge||0,this[Xo]=t.dispose,this[C5]=t.noDisposeOnSet||!1,this[zq]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Ru]=t||1/0,Hd(this)}get max(){return this[Ru]}set allowStale(t){this[Hh]=!!t}get allowStale(){return this[Hh]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[Uu]=t,Hd(this)}get maxAge(){return this[Uu]}set lengthCalculator(t){typeof t!="function"&&(t=sw),t!==this[uc]&&(this[uc]=t,this[Zo]=0,this[Nt].forEach(n=>{n.length=this[uc](n.value,n.key),this[Zo]+=n.length})),Hd(this)}get lengthCalculator(){return this[uc]}get length(){return this[Zo]}get itemCount(){return this[Nt].length}rforEach(t,n){n=n||this;for(let r=this[Nt].tail;r!==null;){const i=r.prev;A5(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[Nt].head;r!==null;){const i=r.next;A5(this,t,r,n),r=i}}keys(){return this[Nt].toArray().map(t=>t.key)}values(){return this[Nt].toArray().map(t=>t.value)}reset(){this[Xo]&&this[Nt]&&this[Nt].length&&this[Nt].forEach(t=>this[Xo](t.key,t.value)),this[xi]=new Map,this[Nt]=new TSe,this[Zo]=0}dump(){return this[Nt].map(t=>Oy(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Nt]}set(t,n,r){if(r=r||this[Uu],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,o=this[uc](n,t);if(this[xi].has(t)){if(o>this[Ru])return Vc(this,this[xi].get(t)),!1;const u=this[xi].get(t).value;return this[Xo]&&(this[C5]||this[Xo](t,u.value)),u.now=i,u.maxAge=r,u.value=n,this[Zo]+=o-u.length,u.length=o,this.get(t),Hd(this),!0}const s=new MSe(t,n,o,i,r);return s.length>this[Ru]?(this[Xo]&&this[Xo](t,n),!1):(this[Zo]+=s.length,this[Nt].unshift(s),this[xi].set(t,this[Nt].head),Hd(this),!0)}has(t){if(!this[xi].has(t))return!1;const n=this[xi].get(t).value;return!Oy(this,n)}get(t){return aw(this,t,!0)}peek(t){return aw(this,t,!1)}pop(){const t=this[Nt].tail;return t?(Vc(this,t),t.value):null}del(t){Vc(this,this[xi].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],o=i.e||0;if(o===0)this.set(i.k,i.v);else{const s=o-n;s>0&&this.set(i.k,i.v,s)}}}prune(){this[xi].forEach((t,n)=>aw(this,n,!1))}}const aw=(e,t,n)=>{const r=e[xi].get(t);if(r){const i=r.value;if(Oy(e,i)){if(Vc(e,r),!e[Hh])return}else n&&(e[zq]&&(r.value.now=Date.now()),e[Nt].unshiftNode(r));return i.value}},Oy=(e,t)=>{if(!t||!t.maxAge&&!e[Uu])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Uu]&&n>e[Uu]},Hd=e=>{if(e[Zo]>e[Ru])for(let t=e[Nt].tail;e[Zo]>e[Ru]&&t!==null;){const n=t.prev;Vc(e,t),t=n}},Vc=(e,t)=>{if(t){const n=t.value;e[Xo]&&e[Xo](n.key,n.value),e[Zo]-=n.length,e[xi].delete(n.key),e[Nt].removeNode(t)}};class MSe{constructor(t,n,r,i,o){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=o||0}}const A5=(e,t,n,r)=>{let i=n.value;Oy(e,i)&&(Vc(e,n),e[Hh]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var NSe=FSe;const OSe=Object.freeze({loose:!0}),RSe=Object.freeze({}),DSe=e=>e?typeof e!="object"?OSe:e:RSe;var WT=DSe,y_={exports:{}};const PSe="2.0.0",Iq=256,LSe=Number.MAX_SAFE_INTEGER||9007199254740991,zSe=16,ISe=Iq-6,BSe=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var qT={MAX_LENGTH:Iq,MAX_SAFE_COMPONENT_LENGTH:zSe,MAX_SAFE_BUILD_LENGTH:ISe,MAX_SAFE_INTEGER:LSe,RELEASE_TYPES:BSe,SEMVER_SPEC_VERSION:PSe,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const jSe=typeof process=="object"&&iw&&iw.NODE_DEBUG&&/\bsemver\b/i.test(iw.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var u2=jSe;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=qT,o=u2;t=e.exports={};const s=t.re=[],a=t.safeRe=[],u=t.src=[],l=t.t={};let c=0;const f="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",i],[f,r]],h=g=>{for(const[m,y]of d)g=g.split(`${m}*`).join(`${m}{0,${y}}`).split(`${m}+`).join(`${m}{1,${y}}`);return g},p=(g,m,y)=>{const v=h(m),x=c++;o(g,x,m),l[g]=x,u[x]=m,s[x]=new RegExp(m,y?"g":void 0),a[x]=new RegExp(v,y?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),p("MAINVERSION",`(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${u[l.NUMERICIDENTIFIER]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${u[l.NUMERICIDENTIFIERLOOSE]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${u[l.PRERELEASEIDENTIFIER]}(?:\\.${u[l.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${u[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[l.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${f}+`),p("BUILD",`(?:\\+(${u[l.BUILDIDENTIFIER]}(?:\\.${u[l.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${u[l.MAINVERSION]}${u[l.PRERELEASE]}?${u[l.BUILD]}?`),p("FULL",`^${u[l.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${u[l.MAINVERSIONLOOSE]}${u[l.PRERELEASELOOSE]}?${u[l.BUILD]}?`),p("LOOSE",`^${u[l.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${u[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${u[l.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:${u[l.PRERELEASE]})?${u[l.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:${u[l.PRERELEASELOOSE]})?${u[l.BUILD]}?)?)?`),p("XRANGE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAINLOOSE]}$`),p("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),p("COERCERTL",u[l.COERCE],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${u[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${u[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${u[l.LONECARET]}${u[l.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${u[l.LONECARET]}${u[l.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${u[l.GTLT]}\\s*(${u[l.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]}|${u[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${u[l.XRANGEPLAIN]})\\s+-\\s+(${u[l.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${u[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[l.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(y_,y_.exports);var HT=y_.exports;const T5=/^[0-9]+$/,Bq=(e,t)=>{const n=T5.test(e),r=T5.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},USe=(e,t)=>Bq(t,e);var WSe={compareIdentifiers:Bq,rcompareIdentifiers:USe};const qm=u2,{MAX_LENGTH:F5,MAX_SAFE_INTEGER:Hm}=qT,{safeRe:M5,t:N5}=HT,qSe=WT,{compareIdentifiers:lc}=WSe;let HSe=class ro{constructor(t,n){if(n=qSe(n),t instanceof ro){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>F5)throw new TypeError(`version is longer than ${F5} characters`);qm("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?M5[N5.LOOSE]:M5[N5.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Hm||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Hm||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Hm||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const o=+i;if(o>=0&&o<Hm)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(qm("SemVer.compare",this.version,this.options,t),!(t instanceof ro)){if(typeof t=="string"&&t===this.version)return 0;t=new ro(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof ro||(t=new ro(t,this.options)),lc(this.major,t.major)||lc(this.minor,t.minor)||lc(this.patch,t.patch)}comparePre(t){if(t instanceof ro||(t=new ro(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(qm("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return lc(r,i)}while(++n)}compareBuild(t){t instanceof ro||(t=new ro(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(qm("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return lc(r,i)}while(++n)}inc(t,n,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(r)?1:0;if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(n){let o=[n,i];r===!1&&(o=[n]),lc(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var GT=HSe;const O5=GT,GSe=(e,t,n)=>new O5(e,n).compare(new O5(t,n));var fd=GSe;const VSe=fd,YSe=(e,t,n)=>VSe(e,t,n)===0;var XSe=YSe;const QSe=fd,KSe=(e,t,n)=>QSe(e,t,n)!==0;var JSe=KSe;const ZSe=fd,e_e=(e,t,n)=>ZSe(e,t,n)>0;var t_e=e_e;const n_e=fd,r_e=(e,t,n)=>n_e(e,t,n)>=0;var i_e=r_e;const o_e=fd,s_e=(e,t,n)=>o_e(e,t,n)<0;var a_e=s_e;const u_e=fd,l_e=(e,t,n)=>u_e(e,t,n)<=0;var c_e=l_e;const f_e=XSe,d_e=JSe,h_e=t_e,p_e=i_e,g_e=a_e,m_e=c_e,y_e=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return f_e(e,n,r);case"!=":return d_e(e,n,r);case">":return h_e(e,n,r);case">=":return p_e(e,n,r);case"<":return g_e(e,n,r);case"<=":return m_e(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var v_e=y_e,uw,R5;function x_e(){if(R5)return uw;R5=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),s("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(c){const f=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],d=c.match(f);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new a(d[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(s("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new a(c,this.options)}catch{return!1}return o(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new u(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||o(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||o(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}uw=t;const n=WT,{safeRe:r,t:i}=HT,o=v_e,s=u2,a=GT,u=jq();return uw}var lw,D5;function jq(){if(D5)return lw;D5=1;class e{constructor(F,T){if(T=r(T),F instanceof e)return F.loose===!!T.loose&&F.includePrerelease===!!T.includePrerelease?F:new e(F.raw,T);if(F instanceof i)return this.raw=F.value,this.set=[[F]],this.format(),this;if(this.options=T,this.loose=!!T.loose,this.includePrerelease=!!T.includePrerelease,this.raw=F.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(M=>this.parseRange(M.trim())).filter(M=>M.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const M=this.set[0];if(this.set=this.set.filter(P=>!p(P[0])),this.set.length===0)this.set=[M];else if(this.set.length>1){for(const P of this.set)if(P.length===1&&g(P[0])){this.set=[P];break}}}this.format()}format(){return this.range=this.set.map(F=>F.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(F){const M=((this.options.includePrerelease&&d)|(this.options.loose&&h))+":"+F,P=n.get(M);if(P)return P;const N=this.options.loose,O=N?a[u.HYPHENRANGELOOSE]:a[u.HYPHENRANGE];F=F.replace(O,C(this.options.includePrerelease)),o("hyphen replace",F),F=F.replace(a[u.COMPARATORTRIM],l),o("comparator trim",F),F=F.replace(a[u.TILDETRIM],c),o("tilde trim",F),F=F.replace(a[u.CARETTRIM],f),o("caret trim",F);let j=F.split(" ").map(he=>y(he,this.options)).join(" ").split(/\s+/).map(he=>$(he,this.options));N&&(j=j.filter(he=>(o("loose invalid filter",he,this.options),!!he.match(a[u.COMPARATORLOOSE])))),o("range list",j);const X=new Map,re=j.map(he=>new i(he,this.options));for(const he of re){if(p(he))return[he];X.set(he.value,he)}X.size>1&&X.has("")&&X.delete("");const be=[...X.values()];return n.set(M,be),be}intersects(F,T){if(!(F instanceof e))throw new TypeError("a Range is required");return this.set.some(M=>m(M,T)&&F.set.some(P=>m(P,T)&&M.every(N=>P.every(O=>N.intersects(O,T)))))}test(F){if(!F)return!1;if(typeof F=="string")try{F=new s(F,this.options)}catch{return!1}for(let T=0;T<this.set.length;T++)if(R(this.set[T],F,this.options))return!0;return!1}}lw=e;const t=NSe,n=new t({max:1e3}),r=WT,i=x_e(),o=u2,s=GT,{safeRe:a,t:u,comparatorTrimReplace:l,tildeTrimReplace:c,caretTrimReplace:f}=HT,{FLAG_INCLUDE_PRERELEASE:d,FLAG_LOOSE:h}=qT,p=A=>A.value==="<0.0.0-0",g=A=>A.value==="",m=(A,F)=>{let T=!0;const M=A.slice();let P=M.pop();for(;T&&M.length;)T=M.every(N=>P.intersects(N,F)),P=M.pop();return T},y=(A,F)=>(o("comp",A,F),A=w(A,F),o("caret",A),A=x(A,F),o("tildes",A),A=E(A,F),o("xrange",A),A=k(A,F),o("stars",A),A),v=A=>!A||A.toLowerCase()==="x"||A==="*",x=(A,F)=>A.trim().split(/\s+/).map(T=>b(T,F)).join(" "),b=(A,F)=>{const T=F.loose?a[u.TILDELOOSE]:a[u.TILDE];return A.replace(T,(M,P,N,O,j)=>{o("tilde",A,M,P,N,O,j);let X;return v(P)?X="":v(N)?X=`>=${P}.0.0 <${+P+1}.0.0-0`:v(O)?X=`>=${P}.${N}.0 <${P}.${+N+1}.0-0`:j?(o("replaceTilde pr",j),X=`>=${P}.${N}.${O}-${j} <${P}.${+N+1}.0-0`):X=`>=${P}.${N}.${O} <${P}.${+N+1}.0-0`,o("tilde return",X),X})},w=(A,F)=>A.trim().split(/\s+/).map(T=>S(T,F)).join(" "),S=(A,F)=>{o("caret",A,F);const T=F.loose?a[u.CARETLOOSE]:a[u.CARET],M=F.includePrerelease?"-0":"";return A.replace(T,(P,N,O,j,X)=>{o("caret",A,P,N,O,j,X);let re;return v(N)?re="":v(O)?re=`>=${N}.0.0${M} <${+N+1}.0.0-0`:v(j)?N==="0"?re=`>=${N}.${O}.0${M} <${N}.${+O+1}.0-0`:re=`>=${N}.${O}.0${M} <${+N+1}.0.0-0`:X?(o("replaceCaret pr",X),N==="0"?O==="0"?re=`>=${N}.${O}.${j}-${X} <${N}.${O}.${+j+1}-0`:re=`>=${N}.${O}.${j}-${X} <${N}.${+O+1}.0-0`:re=`>=${N}.${O}.${j}-${X} <${+N+1}.0.0-0`):(o("no pr"),N==="0"?O==="0"?re=`>=${N}.${O}.${j}${M} <${N}.${O}.${+j+1}-0`:re=`>=${N}.${O}.${j}${M} <${N}.${+O+1}.0-0`:re=`>=${N}.${O}.${j} <${+N+1}.0.0-0`),o("caret return",re),re})},E=(A,F)=>(o("replaceXRanges",A,F),A.split(/\s+/).map(T=>_(T,F)).join(" ")),_=(A,F)=>{A=A.trim();const T=F.loose?a[u.XRANGELOOSE]:a[u.XRANGE];return A.replace(T,(M,P,N,O,j,X)=>{o("xRange",A,M,P,N,O,j,X);const re=v(N),be=re||v(O),he=be||v(j),Le=he;return P==="="&&Le&&(P=""),X=F.includePrerelease?"-0":"",re?P===">"||P==="<"?M="<0.0.0-0":M="*":P&&Le?(be&&(O=0),j=0,P===">"?(P=">=",be?(N=+N+1,O=0,j=0):(O=+O+1,j=0)):P==="<="&&(P="<",be?N=+N+1:O=+O+1),P==="<"&&(X="-0"),M=`${P+N}.${O}.${j}${X}`):be?M=`>=${N}.0.0${X} <${+N+1}.0.0-0`:he&&(M=`>=${N}.${O}.0${X} <${N}.${+O+1}.0-0`),o("xRange return",M),M})},k=(A,F)=>(o("replaceStars",A,F),A.trim().replace(a[u.STAR],"")),$=(A,F)=>(o("replaceGTE0",A,F),A.trim().replace(a[F.includePrerelease?u.GTE0PRE:u.GTE0],"")),C=A=>(F,T,M,P,N,O,j,X,re,be,he,Le,Gt)=>(v(M)?T="":v(P)?T=`>=${M}.0.0${A?"-0":""}`:v(N)?T=`>=${M}.${P}.0${A?"-0":""}`:O?T=`>=${T}`:T=`>=${T}${A?"-0":""}`,v(re)?X="":v(be)?X=`<${+re+1}.0.0-0`:v(he)?X=`<${re}.${+be+1}.0-0`:Le?X=`<=${re}.${be}.${he}-${Le}`:A?X=`<${re}.${be}.${+he+1}-0`:X=`<=${X}`,`${T} ${X}`.trim()),R=(A,F,T)=>{for(let M=0;M<A.length;M++)if(!A[M].test(F))return!1;if(F.prerelease.length&&!T.includePrerelease){for(let M=0;M<A.length;M++)if(o(A[M].semver),A[M].semver!==i.ANY&&A[M].semver.prerelease.length>0){const P=A[M].semver;if(P.major===F.major&&P.minor===F.minor&&P.patch===F.patch)return!0}return!1}return!0};return lw}const b_e=jq(),w_e=(e,t,n)=>{try{t=new b_e(t,n)}catch{return!1}return t.test(e)};var E_e=w_e,Uq=SSe(E_e);function S_e(e,t,n){const r=e.open(t),i=1e4,o=250,{origin:s}=new URL(t);let a=~~(i/o);function u(c){c.source===r&&(a=0,e.removeEventListener("message",u,!1))}e.addEventListener("message",u,!1);function l(){a<=0||(r.postMessage(n,s),setTimeout(l,o),a-=1)}setTimeout(l,o)}var __e=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function Wq(e,...t){for(const n of t)k_e(e,n);return e}function k_e(e,t){for(const n of Object.keys(t))Wf(e,n,t[n],!0)}const wi=cme;let Up=pEe;const Gm=typeof window<"u"?window:void 0;var W5;Up===void 0&&((W5=Gm==null?void 0:Gm.vl)!=null&&W5.compile)&&(Up=Gm.vl);const $_e={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},C_e={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},xh={vega:"Vega","vega-lite":"Vega-Lite"},Ry={vega:wi.version,"vega-lite":Up?Up.version:"not available"},A_e={vega:e=>e,"vega-lite":(e,t)=>Up.compile(e,{config:t}).spec},T_e=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,F_e="chart-wrapper";function M_e(e){return typeof e=="function"}function P5(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,s=window.open("");s.document.write(i+e+o),s.document.title=`${xh[r]} JSON Source`}function N_e(e,t){if(e.$schema){const n=Rq(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${xh[n.library]}, but mode argument sets ${xh[t]??t}.`);const r=n.library;return Uq(Ry[r],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${xh[r]} ${n.version}, but the current version of ${xh[r]} is v${Ry[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function qq(e){return!!(e&&"load"in e)}function L5(e){return qq(e)?e:wi.loader(e)}function O_e(e){var n;const t=((n=e.usermeta)==null?void 0:n.embedOptions)??{};return K(t.defaultStyle)&&(t.defaultStyle=!1),t}async function R_e(e,t,n={}){let r,i;K(t)?(i=L5(n.loader),r=JSON.parse(await i.load(t))):r=t;const o=O_e(r),s=o.loader;(!i||s)&&(i=L5(n.loader??s));const a=await z5(o,i),u=await z5(n,i),l={...Wq(u,a),config:Uf(u.config??{},a.config??{})};return await P_e(e,r,l,i)}async function z5(e,t){const n=K(e.config)?JSON.parse(await t.load(e.config)):e.config??{},r=K(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return{...e,...r?{patch:r}:{},...n?{config:n}:{}}}function D_e(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}async function P_e(e,t,n={},r){const i=n.theme?Uf(pSe[n.theme],n.config??{}):n.config,o=Qa(n.actions)?n.actions:Wq({},$_e,n.actions??{}),s={...C_e,...n.i18n},a=n.renderer??"canvas",u=n.logLevel??wi.Warn,l=n.downloadFileName??"visualization",c=typeof e=="string"?document.querySelector(e):e;if(!c)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const w="vega-embed-style",{root:S,rootContainer:E}=D_e(c);if(!S.getElementById(w)){const _=document.createElement("style");_.id=w,_.innerHTML=n.defaultStyle===void 0||n.defaultStyle===!0?__e.toString():n.defaultStyle,E.appendChild(_)}}const f=N_e(t,n.mode);let d=A_e[f](t,i);if(f==="vega-lite"&&d.$schema){const w=Rq(d.$schema);Uq(Ry.vega,`^${w.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${w.version}, but current version is v${Ry.vega}.`)}c.classList.add("vega-embed"),o&&c.classList.add("has-actions"),c.innerHTML="";let h=c;if(o){const w=document.createElement("div");w.classList.add(F_e),c.appendChild(w),h=w}const p=n.patch;if(p&&(d=p instanceof Function?p(d):nv(d,p,!0,!1).newDocument),n.formatLocale&&wi.formatLocale(n.formatLocale),n.timeFormatLocale&&wi.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(const w in n.expressionFunctions){const S=n.expressionFunctions[w];"fn"in S?wi.expressionFunction(w,S.fn,S.visitor):S instanceof Function&&wi.expressionFunction(w,S)}const{ast:g}=n,m=wi.parse(d,f==="vega-lite"?{}:i,{ast:g}),y=new(n.viewClass||wi.View)(m,{loader:r,logLevel:u,renderer:a,...g?{expr:wi.expressionInterpreter??n.expr??bme}:{}});if(y.addSignalListener("autosize",(w,S)=>{const{type:E}=S;E=="fit-x"?(h.classList.add("fit-x"),h.classList.remove("fit-y")):E=="fit-y"?(h.classList.remove("fit-x"),h.classList.add("fit-y")):E=="fit"?h.classList.add("fit-x","fit-y"):h.classList.remove("fit-x","fit-y")}),n.tooltip!==!1){const{loader:w,tooltip:S}=n,E=w&&!qq(w)?w==null?void 0:w.baseURL:void 0,_=M_e(S)?S:new ESe({baseURL:E,...S===!0?{}:S}).call;y.tooltip(_)}let{hover:v}=n;if(v===void 0&&(v=f==="vega"),v){const{hoverSet:w,updateSet:S}=typeof v=="boolean"?{}:v;y.hover(w,S)}n&&(n.width!=null&&y.width(n.width),n.height!=null&&y.height(n.height),n.padding!=null&&y.padding(n.padding)),await y.initialize(h,n.bind).runAsync();let x;if(o!==!1){let w=c;if(n.defaultStyle!==!1||n.forceActionsMenu){const E=document.createElement("details");E.title=s.CLICK_TO_VIEW_ACTIONS,c.append(E),w=E;const _=document.createElement("summary");_.innerHTML=T_e,E.append(_),x=k=>{E.contains(k.target)||E.removeAttribute("open")},document.addEventListener("click",x)}const S=document.createElement("div");if(w.append(S),S.classList.add("vega-actions"),o===!0||o.export!==!1){for(const E of["svg","png"])if(o===!0||o.export===!0||o.export[E]){const _=s[`${E.toUpperCase()}_ACTION`],k=document.createElement("a"),$=J(n.scaleFactor)?n.scaleFactor[E]:n.scaleFactor;k.text=_,k.href="#",k.target="_blank",k.download=`${l}.${E}`,k.addEventListener("mousedown",async function(C){C.preventDefault();const R=await y.toImageURL(E,$);this.href=R}),S.append(k)}}if(o===!0||o.source!==!1){const E=document.createElement("a");E.text=s.SOURCE_ACTION,E.href="#",E.addEventListener("click",function(_){P5(L2(t),n.sourceHeader??"",n.sourceFooter??"",f),_.preventDefault()}),S.append(E)}if(f==="vega-lite"&&(o===!0||o.compiled!==!1)){const E=document.createElement("a");E.text=s.COMPILED_ACTION,E.href="#",E.addEventListener("click",function(_){P5(L2(d),n.sourceHeader??"",n.sourceFooter??"","vega"),_.preventDefault()}),S.append(E)}if(o===!0||o.editor!==!1){const E=n.editorUrl??"https://vega.github.io/editor/",_=document.createElement("a");_.text=s.EDITOR_ACTION,_.href="#",_.addEventListener("click",function(k){S_e(window,E,{config:i,mode:f,renderer:a,spec:L2(t)}),k.preventDefault()}),S.append(_)}}function b(){x&&document.removeEventListener("click",x),y.finalize()}return{view:y,spec:t,vgSpec:d,finalize:b,embedOptions:n}}function L_e(e){return!!e&&{}.toString.call(e)==="[object Function]"}function z_e(e,t,n){n&&(L_e(n)?n(e.data(t)):e.change(t,wi.changeset().remove(()=>!0).insert(n)))}function I_e(e,t){Object.keys(t).forEach(n=>{z_e(e,n,t[n])})}function Hq(e){const t=new Set;return e.forEach(n=>{Object.keys(n).forEach(r=>{t.add(r)})}),t}const Gq=()=>{};function cw(e,t){const n=Object.keys(t);return n.forEach(r=>{try{e.addSignalListener(r,t[r])}catch(i){console.warn("Cannot add invalid signal listener.",i)}}),n.length>0}var B_e=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!e(t[s],n[s]))return!1}return!0}return t!==t&&n!==n};const j_e=Iy(B_e);function U_e(e,t){if(e===t)return!1;const n={width:!1,height:!1,isExpensive:!1},r=Hq([e,t]);return r.has("width")&&(!("width"in e)||!("width"in t)||e.width!==t.width)&&("width"in e&&typeof e.width=="number"?n.width=e.width:n.isExpensive=!0),r.has("height")&&(!("height"in e)||!("height"in t)||e.height!==t.height)&&("height"in e&&typeof e.height=="number"?n.height=e.height:n.isExpensive=!0),r.delete("width"),r.delete("height"),[...r].some(i=>!(i in e)||!(i in t)||!j_e(e[i],t[i]))&&(n.isExpensive=!0),n.width!==!1||n.height!==!1||n.isExpensive?n:!1}function I5(e,t){const n=Object.keys(t);return n.forEach(r=>{try{e.removeSignalListener(r,t[r])}catch(i){console.warn("Cannot remove invalid signal listener.",i)}}),n.length>0}function fw(e){const{spec:t,width:n,height:r}=e;return typeof n<"u"&&typeof r<"u"?{...t,width:n,height:r}:typeof n<"u"?{...t,width:n}:typeof r<"u"?{...t,height:r}:t}function bh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Vq extends fa.PureComponent{constructor(){super(...arguments),bh(this,"containerRef",fa.createRef()),bh(this,"resultPromise",void 0),bh(this,"handleError",t=>{const{onError:n=Gq}=this.props;n(t,this.containerRef.current),console.warn(t)}),bh(this,"modifyView",t=>{this.resultPromise&&this.resultPromise.then(n=>(n&&t(n.view),!0)).catch(this.handleError)})}componentDidMount(){this.createView()}componentDidUpdate(t){const n=Hq([this.props,t]);if(n.delete("className"),n.delete("signalListeners"),n.delete("spec"),n.delete("style"),n.delete("width"),n.delete("height"),Array.from(n).some(r=>this.props[r]!==t[r]))this.clearView(),this.createView();else{const r=U_e(fw(this.props),fw(t)),{signalListeners:i}=this.props,{signalListeners:o}=t;if(r)if(r.isExpensive)this.clearView(),this.createView();else{const s=!oE(i,o);this.modifyView(a=>{r.width!==!1&&a.width(r.width),r.height!==!1&&a.height(r.height),s&&(o&&I5(a,o),i&&cw(a,i)),a.run()})}else oE(i,o)||this.modifyView(s=>{o&&I5(s,o),i&&cw(s,i),s.run()})}}componentWillUnmount(){this.clearView()}createView(){const{spec:t,onNewView:n,signalListeners:r={},width:i,height:o,...s}=this.props;if(this.containerRef.current){const a=fw(this.props);this.resultPromise=R_e(this.containerRef.current,a,s).then(u=>{if(u){const{view:l}=u;cw(l,r)&&l.run()}return u}).catch(this.handleError),n&&this.modifyView(n)}}clearView(){return this.resultPromise&&this.resultPromise.then(t=>{t&&t.finalize()}).catch(this.handleError),this.resultPromise=void 0,this}render(){const{className:t,style:n}=this.props;return fa.createElement("div",{ref:this.containerRef,className:t,style:n})}}bh(Vq,"propTypes",{className:lM.string,onError:lM.func});function v_(){return v_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v_.apply(this,arguments)}function x_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const W_e={};class Yq extends fa.PureComponent{constructor(){super(...arguments),x_(this,"vegaEmbed",fa.createRef()),x_(this,"handleNewView",t=>{this.update();const{onNewView:n=Gq}=this.props;n(t)})}componentDidMount(){this.update()}componentDidUpdate(t){oE(this.props.data,t.data)||this.update()}update(){const{data:t}=this.props;this.vegaEmbed.current&&t&&Object.keys(t).length>0&&this.vegaEmbed.current.modifyView(n=>{I_e(n,t),n.resize().run()})}render(){const{data:t,...n}=this.props;return fa.createElement(Vq,v_({ref:this.vegaEmbed},n,{onNewView:this.handleNewView}))}}x_(Yq,"defaultProps",{data:W_e});function b_(){return b_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b_.apply(this,arguments)}function q_e(e){return fa.createElement(Yq,b_({},e,{mode:"vega-lite"}))}function H_e({build:e,repo:t}){return we.jsxs("table",{children:[we.jsx("thead",{children:we.jsxs("tr",{children:[we.jsx("th",{children:"Key"}),we.jsx("th",{children:"Value"})]})}),we.jsx("tbody",{children:Object.entries(e).map(([n,r])=>{if(n.startsWith("yearmonth"))return null;if(n.startsWith("github")){const i=`https://github.com/${t}/actions/runs/${r}`;return we.jsxs("tr",{children:[we.jsx("td",{children:"link"}),we.jsx("td",{children:we.jsx("a",{href:i,children:i})})]},n)}else return we.jsxs("tr",{children:[we.jsx("td",{children:`${n}`}),we.jsx("td",{children:`${r}`})]},n)})})]})}function G_e({builds:e,repo:t}){const[n,r]=Kn.useState();return we.jsxs("div",{style:{display:"flex"},children:[we.jsx(q_e,{data:{values:e},patch:i=>{var o;return(o=i.signals)==null||o.push({name:"barClick",value:0,on:[{events:"*:mousedown",update:"datum"}]}),i},signalListeners:{barClick:(i,o)=>{r(o)}},spec:{$schema:"https://vega.github.io/schema/vega-lite/v5.json",width:1e3,height:400,mark:{type:"point",tooltip:{content:"data"}},data:{name:"values"},selection:{grid:{type:"interval",bind:"scales"}},encoding:{y:{field:"duration",type:"quantitative",axis:{title:"Duration (minutes)"}},x:{field:"updated_at",timeUnit:"yearmonthdatehoursminutes",type:"temporal",scale:{nice:"week"},axis:{title:"Date"}},color:{field:"state",type:"nominal",scale:{domain:["success","skipped","failure","canceled"],range:["#39aa56","#ff7f0e","#db4545","#9d9d9d"]}}}}}),n?we.jsx(H_e,{repo:t,build:n}):null]})}var Xq={},VT={},Tl={},Wg={};Object.defineProperty(Wg,"__esModule",{value:!0});function YT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XT(e,t,n){return t&&B5(e.prototype,t),n&&B5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function V_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w_(e,t)}function Lf(e){return Lf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Lf(e)}function w_(e,t){return w_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},w_(e,t)}function Y_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wh(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X_e(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wh(e)}function Q_e(e){var t=Y_e();return function(){var r=Lf(e),i;if(t){var o=Lf(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return X_e(this,i)}}function K_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Lf(e),e!==null););return e}function T0(){return typeof Reflect<"u"&&Reflect.get?T0=Reflect.get.bind():T0=function(t,n,r){var i=K_e(t,n);if(i){var o=Object.getOwnPropertyDescriptor(i,n);return o.get?o.get.call(arguments.length<3?t:r):o.value}},T0.apply(this,arguments)}var j5=function(){function e(){YT(this,e),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return XT(e,[{key:"addEventListener",value:function(n,r,i){n in this.listeners||(this.listeners[n]=[]),this.listeners[n].push({callback:r,options:i})}},{key:"removeEventListener",value:function(n,r){if(n in this.listeners){for(var i=this.listeners[n],o=0,s=i.length;o<s;o++)if(i[o].callback===r){i.splice(o,1);return}}}},{key:"dispatchEvent",value:function(n){if(n.type in this.listeners){for(var r=this.listeners[n.type],i=r.slice(),o=0,s=i.length;o<s;o++){var a=i[o];try{a.callback.call(this,n)}catch(u){Promise.resolve().then(function(){throw u})}a.options&&a.options.once&&this.removeEventListener(n.type,a.callback)}return!n.defaultPrevented}}}]),e}(),QT=function(e){V_e(n,e);var t=Q_e(n);function n(){var r;return YT(this,n),r=t.call(this),r.listeners||j5.call(wh(r)),Object.defineProperty(wh(r),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(wh(r),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(wh(r),"reason",{value:void 0,writable:!0,configurable:!0}),r}return XT(n,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(i){i.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,i)),T0(Lf(n.prototype),"dispatchEvent",this).call(this,i)}}]),n}(j5),Qq=function(){function e(){YT(this,e),Object.defineProperty(this,"signal",{value:new QT,writable:!0,configurable:!0})}return XT(e,[{key:"abort",value:function(n){var r;try{r=new Event("abort")}catch{typeof document<"u"?document.createEvent?(r=document.createEvent("Event"),r.initEvent("abort",!1,!1)):(r=document.createEventObject(),r.type="abort"):r={type:"abort",bubbles:!1,cancelable:!1}}var i=n;if(i===void 0)if(typeof document>"u")i=new Error("This operation was aborted"),i.name="AbortError";else try{i=new DOMException("signal is aborted without reason")}catch{i=new Error("This operation was aborted"),i.name="AbortError"}this.signal.reason=i,this.signal.dispatchEvent(r)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();typeof Symbol<"u"&&Symbol.toStringTag&&(Qq.prototype[Symbol.toStringTag]="AbortController",QT.prototype[Symbol.toStringTag]="AbortSignal");function J_e(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):typeof e.Request=="function"&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}function Z_e(e){typeof e=="function"&&(e={fetch:e});var t=e,n=t.fetch,r=t.Request,i=r===void 0?n.Request:r,o=t.AbortController,s=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,a=s===void 0?!1:s;if(!J_e({fetch:n,Request:i,AbortController:o,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:a}))return{fetch:n,Request:u};var u=i;(u&&!u.prototype.hasOwnProperty("signal")||a)&&(u=function(d,h){var p;h&&h.signal&&(p=h.signal,delete h.signal);var g=new i(d,h);return p&&Object.defineProperty(g,"signal",{writable:!1,enumerable:!1,configurable:!0,value:p}),g},u.prototype=i.prototype);var l=n,c=function(d,h){var p=u&&u.prototype.isPrototypeOf(d)?d.signal:h?h.signal:void 0;if(p){var g;try{g=new DOMException("Aborted","AbortError")}catch{g=new Error("Aborted"),g.name="AbortError"}if(p.aborted)return Promise.reject(g);var m=new Promise(function(y,v){p.addEventListener("abort",function(){return v(g)},{once:!0})});return h&&h.signal&&delete h.signal,Promise.race([m,l(d,h)])}return l(d,h)};return{fetch:c,Request:u}}Wg.AbortController=Qq;Wg.AbortSignal=QT;Wg.abortableFetch=Z_e;Object.defineProperty(Tl,"__esModule",{value:!0});Tl.AbortSignal=Tl.AbortController=void 0;const Kq=Wg;var Dy=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof Yc<"u")return Yc;throw new Error("unable to locate global object")};let eke=typeof Dy().AbortController>"u"?Kq.AbortController:Dy().AbortController;Tl.AbortController=eke;let tke=typeof Dy().AbortController>"u"?Kq.AbortSignal:Dy().AbortSignal;Tl.AbortSignal=tke;var KT={};Object.defineProperty(KT,"__esModule",{value:!0});const nke=Tl;class rke{}class ike{constructor(){this.signals=new Set,this.abortController=new nke.AbortController}addSignal(t=new rke){if(this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(t),t.aborted?this.handleAborted(t):typeof t.addEventListener=="function"&&t.addEventListener("abort",()=>{this.handleAborted(t)})}handleAborted(t){this.signals.delete(t),this.signals.size===0&&this.abortController.abort()}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}}KT.default=ike;var JT={};Object.defineProperty(JT,"__esModule",{value:!0});class oke{constructor(){this.callbacks=new Set}addCallback(t=()=>{}){this.callbacks.add(t),t(this.currentMessage)}callback(t){this.currentMessage=t,this.callbacks.forEach(n=>{n(t)})}}JT.default=oke;var Jq=Yc&&Yc.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(VT,"__esModule",{value:!0});const ske=Tl,ake=Jq(KT),uke=Jq(JT);class Py{constructor({fill:t,cache:n}){if(typeof t!="function")throw new TypeError("must pass a fill function");if(typeof n!="object")throw new TypeError("must pass a cache object");if(typeof n.get!="function"||typeof n.set!="function"||typeof n.delete!="function")throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=n,this.fillCallback=t}static isAbortException(t){return t.name==="AbortError"||t.code==="ERR_ABORTED"||t.message==="AbortError: aborted"||t.message==="Error: aborted"}evict(t,n){this.cache.get(t)===n&&this.cache.delete(t)}fill(t,n,r,i){const o=new ake.default,s=new uke.default;s.addCallback(i);const a={aborter:o,promise:this.fillCallback(n,o.signal,u=>{s.callback(u)}),settled:!1,statusReporter:s,get aborted(){return this.aborter.signal.aborted}};a.aborter.addSignal(r),a.aborter.signal.addEventListener("abort",()=>{a.settled||this.evict(t,a)}),a.promise.then(()=>{a.settled=!0},()=>{a.settled=!0,this.evict(t,a)}).catch(u=>{throw console.error(u),u}),this.cache.set(t,a)}static checkSinglePromise(t,n){function r(){if(n&&n.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return t.then(i=>(r(),i),i=>{throw r(),i})}has(t){return this.cache.has(t)}get(t,n,r,i){if(!r&&n instanceof ske.AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");const o=this.cache.get(t);return o?o.aborted&&!o.settled?(this.evict(t,o),this.get(t,n,r,i)):o.settled?o.promise:(o.aborter.addSignal(r),o.statusReporter.addCallback(i),Py.checkSinglePromise(o.promise,r)):(this.fill(t,n,r,i),Py.checkSinglePromise(this.cache.get(t).promise,r))}delete(t){const n=this.cache.get(t);n&&(n.settled||n.aborter.abort(),this.cache.delete(t))}clear(){const t=this.cache.keys();let n=0;for(let r=t.next();!r.done;r=t.next())this.delete(r.value),n+=1;return n}}VT.default=Py;var lke=Yc&&Yc.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xq,"__esModule",{value:!0});const cke=lke(VT);var fke=Xq.default=cke.default,Ur,Qe,lt,Js,Wp,Zs,qp,E_,vr,vi,Ly,Zq,Hp,S_,Gp,__,Vp,k_,zy,eH,Yp,$_;class dke extends Map{constructor(n={}){super();Cn(this,qp);Cn(this,vr);Cn(this,Ly);Cn(this,Hp);Cn(this,Gp);Cn(this,Vp);Cn(this,zy);Cn(this,Yp);Cn(this,Ur,0);Cn(this,Qe,new Map);Cn(this,lt,new Map);Cn(this,Js,void 0);Cn(this,Wp,void 0);Cn(this,Zs,void 0);if(!(n.maxSize&&n.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof n.maxAge=="number"&&n.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");sn(this,Js,n.maxSize),sn(this,Wp,n.maxAge||Number.POSITIVE_INFINITY),sn(this,Zs,n.onEviction)}get __oldCache(){return ce(this,lt)}get(n){if(ce(this,Qe).has(n)){const r=ce(this,Qe).get(n);return it(this,Hp,S_).call(this,n,r)}if(ce(this,lt).has(n)){const r=ce(this,lt).get(n);if(it(this,vr,vi).call(this,n,r)===!1)return it(this,zy,eH).call(this,n,r),r.value}}set(n,r,{maxAge:i=ce(this,Wp)}={}){const o=typeof i=="number"&&i!==Number.POSITIVE_INFINITY?Date.now()+i:void 0;return ce(this,Qe).has(n)?ce(this,Qe).set(n,{value:r,expiry:o}):it(this,Vp,k_).call(this,n,{value:r,expiry:o}),this}has(n){return ce(this,Qe).has(n)?!it(this,vr,vi).call(this,n,ce(this,Qe).get(n)):ce(this,lt).has(n)?!it(this,vr,vi).call(this,n,ce(this,lt).get(n)):!1}peek(n){if(ce(this,Qe).has(n))return it(this,Gp,__).call(this,n,ce(this,Qe));if(ce(this,lt).has(n))return it(this,Gp,__).call(this,n,ce(this,lt))}delete(n){const r=ce(this,Qe).delete(n);return r&&c2(this,Ur)._--,ce(this,lt).delete(n)||r}clear(){ce(this,Qe).clear(),ce(this,lt).clear(),sn(this,Ur,0)}resize(n){if(!(n&&n>0))throw new TypeError("`maxSize` must be a number greater than 0");const r=[...it(this,Yp,$_).call(this)],i=r.length-n;i<0?(sn(this,Qe,new Map(r)),sn(this,lt,new Map),sn(this,Ur,r.length)):(i>0&&it(this,qp,E_).call(this,r.slice(0,i)),sn(this,lt,new Map(r.slice(i))),sn(this,Qe,new Map),sn(this,Ur,0)),sn(this,Js,n)}*keys(){for(const[n]of this)yield n}*values(){for(const[,n]of this)yield n}*[Symbol.iterator](){for(const n of ce(this,Qe)){const[r,i]=n;it(this,vr,vi).call(this,r,i)===!1&&(yield[r,i.value])}for(const n of ce(this,lt)){const[r,i]=n;ce(this,Qe).has(r)||it(this,vr,vi).call(this,r,i)===!1&&(yield[r,i.value])}}*entriesDescending(){let n=[...ce(this,Qe)];for(let r=n.length-1;r>=0;--r){const i=n[r],[o,s]=i;it(this,vr,vi).call(this,o,s)===!1&&(yield[o,s.value])}n=[...ce(this,lt)];for(let r=n.length-1;r>=0;--r){const i=n[r],[o,s]=i;ce(this,Qe).has(o)||it(this,vr,vi).call(this,o,s)===!1&&(yield[o,s.value])}}*entriesAscending(){for(const[n,r]of it(this,Yp,$_).call(this))yield[n,r.value]}get size(){if(!ce(this,Ur))return ce(this,lt).size;let n=0;for(const r of ce(this,lt).keys())ce(this,Qe).has(r)||n++;return Math.min(ce(this,Ur)+n,ce(this,Js))}get maxSize(){return ce(this,Js)}entries(){return this.entriesAscending()}forEach(n,r=this){for(const[i,o]of this.entriesAscending())n.call(r,o,i,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}Ur=new WeakMap,Qe=new WeakMap,lt=new WeakMap,Js=new WeakMap,Wp=new WeakMap,Zs=new WeakMap,qp=new WeakSet,E_=function(n){if(typeof ce(this,Zs)=="function")for(const[r,i]of n)ce(this,Zs).call(this,r,i.value)},vr=new WeakSet,vi=function(n,r){return typeof r.expiry=="number"&&r.expiry<=Date.now()?(typeof ce(this,Zs)=="function"&&ce(this,Zs).call(this,n,r.value),this.delete(n)):!1},Ly=new WeakSet,Zq=function(n,r){if(it(this,vr,vi).call(this,n,r)===!1)return r.value},Hp=new WeakSet,S_=function(n,r){return r.expiry?it(this,Ly,Zq).call(this,n,r):r.value},Gp=new WeakSet,__=function(n,r){const i=r.get(n);return it(this,Hp,S_).call(this,n,i)},Vp=new WeakSet,k_=function(n,r){ce(this,Qe).set(n,r),c2(this,Ur)._++,ce(this,Ur)>=ce(this,Js)&&(sn(this,Ur,0),it(this,qp,E_).call(this,ce(this,lt)),sn(this,lt,ce(this,Qe)),sn(this,Qe,new Map))},zy=new WeakSet,eH=function(n,r){ce(this,lt).delete(n),it(this,Vp,k_).call(this,n,r)},Yp=new WeakSet,$_=function*(){for(const n of ce(this,lt)){const[r,i]=n;ce(this,Qe).has(r)||it(this,vr,vi).call(this,r,i)===!1&&(yield n)}for(const n of ce(this,Qe)){const[r,i]=n;it(this,vr,vi).call(this,r,i)===!1&&(yield n)}};function hke(e=[]){if(!e.length)return[];const t=e.map(i=>i.duration);let n=0;for(const i of t)n+=i;const r=n/t.length;return e.filter(i=>i.duration<r*2)}function pke(e){return e.name==="AbortError"||e.code==="ERR_ABORTED"||e.message==="AbortError: aborted"||e.message==="Error: aborted"}const U5=100;function gke({counter:e,repo:t}){return`https://api.github.com/repos/${t}/actions/runs?page=${Math.floor(e/U5)}&per_page=${U5}`}const mke=new fke({cache:new dke({maxSize:1e3}),async fill(e,t){const{url:n,token:r}=e,i=await fetch(n,{headers:{Accept:"application/vnd.github.v3+json",...r?{Authorization:`token ${r}`}:{}},signal:t});if(!i.ok)throw new Error(`HTTP ${i.status} ${i.statusText}`);const o=await i.json();return{total:o.total_count,result:hke(o.workflow_runs.map(s=>{var a,u;return{message:(u=(a=s.head_commit)==null?void 0:a.message)==null?void 0:u.slice(0,50),branch:s.head_branch,name:s.name,github_link:s.id,duration:Math.min(Math.abs(new Date(s.updated_at)-new Date(s.created_at))/6e4,100),state:s.conclusion,updated_at:new Date(s.updated_at),updated_at2:s.updated_at}}))}}});function yke(e){const[t,n]=Kn.useState(0),[r,i]=Kn.useState(),[o,s]=Kn.useState(),[a,u]=Kn.useState(e.repo?"Loading...":""),[l,c]=Kn.useState([]);return Kn.useEffect(()=>{(async()=>{try{if(i(void 0),e!=null&&e.repo){const f=gke({...e,counter:l.length});if(!(f&&o)||o>=l.length){const d=e.token,{total:h,result:p}=await mke.get(f+d,{url:f,token:d});p.length?(c([...l,...p]),s(h),u(`Loading builds...${l.length}/${h}`)):(u(""),n(0))}else l.length?(u(""),n(0)):i("No builds loaded")}}catch(f){pke(f)||(console.error(f),i(f))}})()},[a,e,t,l,o]),[a,r,l]}function vke(){const[e,t]=Kn.useState(""),[n,r]=Kn.useState(""),[i,o]=Kn.useState(""),[s,a]=Kn.useState(""),[u,l,c]=yke({repo:e,token:n});return we.jsxs(we.Fragment,{children:[we.jsx("h1",{children:"githubgraph-js - GitHub actions graphs"}),we.jsxs("form",{onSubmit:f=>{f.preventDefault(),t(i),r(s)},children:[we.jsxs("div",{children:[we.jsx("label",{style:{marginRight:10},children:"Repo name:"}),we.jsx("input",{value:i,onChange:f=>o(f.target.value)})]}),we.jsxs("div",{children:[we.jsx("label",{style:{marginRight:10},children:"Access token (optional, let's you make more API requests without limitations):"}),we.jsx("input",{value:s,onChange:f=>a(f.target.value)})]}),we.jsx("button",{type:"submit",children:"Submit"})]}),l?we.jsx("p",{style:{color:"red"},children:`${l}`}):u?we.jsx("p",{children:u}):c.length?we.jsx("div",{style:{marginTop:50},children:we.jsx(G_e,{builds:c,repo:e})}):null,c?we.jsx("textarea",{style:{marginTop:20},rows:10,cols:120,onChange:()=>{},value:[["branch","duration","github_link","message","name","state","updated_at"].join("	"),...c.map(f=>{var d;return`${f.branch}	${f.duration}	${f.github_link}	${(d=f.message)==null?void 0:d.replaceAll(`
`," ").replaceAll("	"," ")}	${f.name}	${f.state}	${f.updated_at2}`}).filter(f=>!!f.trim())].join(`
`)}):null,we.jsx("div",{style:{marginTop:50},children:we.jsx("a",{href:"https://github.com/cmdcolin/githubgraphjs/",children:"source code"})})]})}dw.createRoot(document.getElementById("root")).render(we.jsx(fa.StrictMode,{children:we.jsx(vke,{})}))});export default xke();
