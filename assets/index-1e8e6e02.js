var sq=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var F_e=sq((gke,sT)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Oc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var a5={exports:{}},xy={},u5={exports:{}},Ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cp=Symbol.for("react.element"),aq=Symbol.for("react.portal"),uq=Symbol.for("react.fragment"),lq=Symbol.for("react.strict_mode"),cq=Symbol.for("react.profiler"),fq=Symbol.for("react.provider"),dq=Symbol.for("react.context"),hq=Symbol.for("react.forward_ref"),pq=Symbol.for("react.suspense"),gq=Symbol.for("react.memo"),mq=Symbol.for("react.lazy"),xT=Symbol.iterator;function yq(e){return e===null||typeof e!="object"?null:(e=xT&&e[xT]||e["@@iterator"],typeof e=="function"?e:null)}var l5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},c5=Object.assign,f5={};function Ef(e,t,n){this.props=e,this.context=t,this.refs=f5,this.updater=n||l5}Ef.prototype.isReactComponent={};Ef.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ef.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function d5(){}d5.prototype=Ef.prototype;function VS(e,t,n){this.props=e,this.context=t,this.refs=f5,this.updater=n||l5}var GS=VS.prototype=new d5;GS.constructor=VS;c5(GS,Ef.prototype);GS.isPureReactComponent=!0;var bT=Array.isArray,h5=Object.prototype.hasOwnProperty,YS={current:null},p5={key:!0,ref:!0,__self:!0,__source:!0};function g5(e,t,n){var r,i={},o=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)h5.call(t,r)&&!p5.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var u=Array(a),l=0;l<a;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Cp,type:e,key:o,ref:s,props:i,_owner:YS.current}}function vq(e,t){return{$$typeof:Cp,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function XS(e){return typeof e=="object"&&e!==null&&e.$$typeof===Cp}function xq(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var wT=/\/+/g;function Lx(e,t){return typeof e=="object"&&e!==null&&e.key!=null?xq(""+e.key):t.toString(36)}function Am(e,t,n,r,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Cp:case aq:s=!0}}if(s)return s=e,i=i(s),e=r===""?"."+Lx(s,0):r,bT(i)?(n="",e!=null&&(n=e.replace(wT,"$&/")+"/"),Am(i,t,n,"",function(l){return l})):i!=null&&(XS(i)&&(i=vq(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(wT,"$&/")+"/")+e)),t.push(i)),1;if(s=0,r=r===""?".":r+":",bT(e))for(var a=0;a<e.length;a++){o=e[a];var u=r+Lx(o,a);s+=Am(o,t,n,u,i)}else if(u=yq(e),typeof u=="function")for(e=u.call(e),a=0;!(o=e.next()).done;)o=o.value,u=r+Lx(o,a++),s+=Am(o,t,n,u,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function kg(e,t,n){if(e==null)return e;var r=[],i=0;return Am(e,r,"","",function(o){return t.call(n,o,i++)}),r}function bq(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Pn={current:null},Tm={transition:null},wq={ReactCurrentDispatcher:Pn,ReactCurrentBatchConfig:Tm,ReactCurrentOwner:YS};Ee.Children={map:kg,forEach:function(e,t,n){kg(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return kg(e,function(){t++}),t},toArray:function(e){return kg(e,function(t){return t})||[]},only:function(e){if(!XS(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ee.Component=Ef;Ee.Fragment=uq;Ee.Profiler=cq;Ee.PureComponent=VS;Ee.StrictMode=lq;Ee.Suspense=pq;Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wq;Ee.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=c5({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=YS.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(u in t)h5.call(t,u)&&!p5.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&a!==void 0?a[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){a=Array(u);for(var l=0;l<u;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:Cp,type:e.type,key:i,ref:o,props:r,_owner:s}};Ee.createContext=function(e){return e={$$typeof:dq,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fq,_context:e},e.Consumer=e};Ee.createElement=g5;Ee.createFactory=function(e){var t=g5.bind(null,e);return t.type=e,t};Ee.createRef=function(){return{current:null}};Ee.forwardRef=function(e){return{$$typeof:hq,render:e}};Ee.isValidElement=XS;Ee.lazy=function(e){return{$$typeof:mq,_payload:{_status:-1,_result:e},_init:bq}};Ee.memo=function(e,t){return{$$typeof:gq,type:e,compare:t===void 0?null:t}};Ee.startTransition=function(e){var t=Tm.transition;Tm.transition={};try{e()}finally{Tm.transition=t}};Ee.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ee.useCallback=function(e,t){return Pn.current.useCallback(e,t)};Ee.useContext=function(e){return Pn.current.useContext(e)};Ee.useDebugValue=function(){};Ee.useDeferredValue=function(e){return Pn.current.useDeferredValue(e)};Ee.useEffect=function(e,t){return Pn.current.useEffect(e,t)};Ee.useId=function(){return Pn.current.useId()};Ee.useImperativeHandle=function(e,t,n){return Pn.current.useImperativeHandle(e,t,n)};Ee.useInsertionEffect=function(e,t){return Pn.current.useInsertionEffect(e,t)};Ee.useLayoutEffect=function(e,t){return Pn.current.useLayoutEffect(e,t)};Ee.useMemo=function(e,t){return Pn.current.useMemo(e,t)};Ee.useReducer=function(e,t,n){return Pn.current.useReducer(e,t,n)};Ee.useRef=function(e){return Pn.current.useRef(e)};Ee.useState=function(e){return Pn.current.useState(e)};Ee.useSyncExternalStore=function(e,t,n){return Pn.current.useSyncExternalStore(e,t,n)};Ee.useTransition=function(){return Pn.current.useTransition()};Ee.version="18.2.0";u5.exports=Ee;var pr=u5.exports;const Js=wf(pr);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eq=pr,Sq=Symbol.for("react.element"),_q=Symbol.for("react.fragment"),kq=Object.prototype.hasOwnProperty,$q=Eq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Cq={key:!0,ref:!0,__self:!0,__source:!0};function m5(e,t,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)kq.call(t,r)&&!Cq.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:Sq,type:e,key:o,ref:s,props:i,_owner:$q.current}}xy.Fragment=_q;xy.jsx=m5;xy.jsxs=m5;a5.exports=xy;var be=a5.exports,Pb={},y5={exports:{}},Ar={},v5={exports:{}},x5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,N){var j=M.length;M.push(N);e:for(;0<j;){var X=j-1>>>1,te=M[X];if(0<i(te,N))M[X]=N,M[j]=te,j=X;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var N=M[0],j=M.pop();if(j!==N){M[0]=j;e:for(var X=0,te=M.length,xe=te>>>1;X<xe;){var de=2*(X+1)-1,De=M[de],It=de+1,Zr=M[It];if(0>i(De,j))It<te&&0>i(Zr,De)?(M[X]=Zr,M[It]=j,X=It):(M[X]=De,M[de]=j,X=de);else if(It<te&&0>i(Zr,j))M[X]=Zr,M[It]=j,X=It;else break e}}return N}function i(M,N){var j=M.sortIndex-N.sortIndex;return j!==0?j:M.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var u=[],l=[],c=1,f=null,d=3,h=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(M){for(var N=n(l);N!==null;){if(N.callback===null)r(l);else if(N.startTime<=M)r(l),N.sortIndex=N.expirationTime,t(u,N);else break;N=n(l)}}function b(M){if(g=!1,x(M),!p)if(n(u)!==null)p=!0,O(w);else{var N=n(l);N!==null&&D(b,N.startTime-M)}}function w(M,N){p=!1,g&&(g=!1,m(_),_=-1),h=!0;var j=d;try{for(x(N),f=n(u);f!==null&&(!(f.expirationTime>N)||M&&!A());){var X=f.callback;if(typeof X=="function"){f.callback=null,d=f.priorityLevel;var te=X(f.expirationTime<=N);N=e.unstable_now(),typeof te=="function"?f.callback=te:f===n(u)&&r(u),x(N)}else r(u);f=n(u)}if(f!==null)var xe=!0;else{var de=n(l);de!==null&&D(b,de.startTime-N),xe=!1}return xe}finally{f=null,d=j,h=!1}}var S=!1,E=null,_=-1,$=5,k=-1;function A(){return!(e.unstable_now()-k<$)}function R(){if(E!==null){var M=e.unstable_now();k=M;var N=!0;try{N=E(!0,M)}finally{N?C():(S=!1,E=null)}}else S=!1}var C;if(typeof v=="function")C=function(){v(R)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,T=F.port2;F.port1.onmessage=R,C=function(){T.postMessage(null)}}else C=function(){y(R,0)};function O(M){E=M,S||(S=!0,C())}function D(M,N){_=y(function(){M(e.unstable_now())},N)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,O(w))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(M){switch(d){case 1:case 2:case 3:var N=3;break;default:N=d}var j=d;d=N;try{return M()}finally{d=j}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,N){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var j=d;d=M;try{return N()}finally{d=j}},e.unstable_scheduleCallback=function(M,N,j){var X=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?X+j:X):j=X,M){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=j+te,M={id:c++,callback:N,priorityLevel:M,startTime:j,expirationTime:te,sortIndex:-1},j>X?(M.sortIndex=j,t(l,M),n(u)===null&&M===n(l)&&(g?(m(_),_=-1):g=!0,D(b,j-X))):(M.sortIndex=te,t(u,M),p||h||(p=!0,O(w))),M},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(M){var N=d;return function(){var j=d;d=N;try{return M.apply(this,arguments)}finally{d=j}}}})(x5);v5.exports=x5;var Aq=v5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b5=pr,Er=Aq;function q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var w5=new Set,Fh={};function gl(e,t){Nc(e,t),Nc(e+"Capture",t)}function Nc(e,t){for(Fh[e]=t,e=0;e<t.length;e++)w5.add(t[e])}var ss=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lb=Object.prototype.hasOwnProperty,Tq=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ET={},ST={};function Fq(e){return Lb.call(ST,e)?!0:Lb.call(ET,e)?!1:Tq.test(e)?ST[e]=!0:(ET[e]=!0,!1)}function Mq(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Oq(e,t,n,r){if(t===null||typeof t>"u"||Mq(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ln(e,t,n,r,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var Yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Yt[e]=new Ln(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Yt[t]=new Ln(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Yt[e]=new Ln(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Yt[e]=new Ln(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Yt[e]=new Ln(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Yt[e]=new Ln(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Yt[e]=new Ln(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Yt[e]=new Ln(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Yt[e]=new Ln(e,5,!1,e.toLowerCase(),null,!1,!1)});var QS=/[\-:]([a-z])/g;function KS(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(QS,KS);Yt[t]=new Ln(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(QS,KS);Yt[t]=new Ln(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(QS,KS);Yt[t]=new Ln(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Yt[e]=new Ln(e,1,!1,e.toLowerCase(),null,!1,!1)});Yt.xlinkHref=new Ln("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Yt[e]=new Ln(e,1,!1,e.toLowerCase(),null,!0,!0)});function JS(e,t,n,r){var i=Yt.hasOwnProperty(t)?Yt[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Oq(t,n,i,r)&&(n=null),r||i===null?Fq(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ps=b5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$g=Symbol.for("react.element"),Ql=Symbol.for("react.portal"),Kl=Symbol.for("react.fragment"),ZS=Symbol.for("react.strict_mode"),zb=Symbol.for("react.profiler"),E5=Symbol.for("react.provider"),S5=Symbol.for("react.context"),e_=Symbol.for("react.forward_ref"),Ib=Symbol.for("react.suspense"),jb=Symbol.for("react.suspense_list"),t_=Symbol.for("react.memo"),Fs=Symbol.for("react.lazy"),_5=Symbol.for("react.offscreen"),_T=Symbol.iterator;function Qf(e){return e===null||typeof e!="object"?null:(e=_T&&e[_T]||e["@@iterator"],typeof e=="function"?e:null)}var ot=Object.assign,zx;function Md(e){if(zx===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);zx=t&&t[1]||""}return`
`+zx+e}var Ix=!1;function jx(e,t){if(!e||Ix)return"";Ix=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var u=`
`+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=s&&0<=a);break}}}finally{Ix=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Md(e):""}function Nq(e){switch(e.tag){case 5:return Md(e.type);case 16:return Md("Lazy");case 13:return Md("Suspense");case 19:return Md("SuspenseList");case 0:case 2:case 15:return e=jx(e.type,!1),e;case 11:return e=jx(e.type.render,!1),e;case 1:return e=jx(e.type,!0),e;default:return""}}function Bb(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Kl:return"Fragment";case Ql:return"Portal";case zb:return"Profiler";case ZS:return"StrictMode";case Ib:return"Suspense";case jb:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case S5:return(e.displayName||"Context")+".Consumer";case E5:return(e._context.displayName||"Context")+".Provider";case e_:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case t_:return t=e.displayName||null,t!==null?t:Bb(e.type)||"Memo";case Fs:t=e._payload,e=e._init;try{return Bb(e(t))}catch{}}return null}function Dq(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bb(t);case 8:return t===ZS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function pa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function k5(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Rq(e){var t=k5(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Cg(e){e._valueTracker||(e._valueTracker=Rq(e))}function $5(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=k5(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function f0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ub(e,t){var n=t.checked;return ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function kT(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=pa(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function C5(e,t){t=t.checked,t!=null&&JS(e,"checked",t,!1)}function Wb(e,t){C5(e,t);var n=pa(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?qb(e,t.type,n):t.hasOwnProperty("defaultValue")&&qb(e,t.type,pa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function $T(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function qb(e,t,n){(t!=="number"||f0(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Od=Array.isArray;function gc(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+pa(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Hb(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(q(91));return ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function CT(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(q(92));if(Od(n)){if(1<n.length)throw Error(q(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:pa(n)}}function A5(e,t){var n=pa(t.value),r=pa(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function AT(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function T5(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vb(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?T5(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ag,F5=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ag=Ag||document.createElement("div"),Ag.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ag.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mh(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var sh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pq=["Webkit","ms","Moz","O"];Object.keys(sh).forEach(function(e){Pq.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),sh[t]=sh[e]})});function M5(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||sh.hasOwnProperty(e)&&sh[e]?(""+t).trim():t+"px"}function O5(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=M5(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var Lq=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gb(e,t){if(t){if(Lq[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(q(62))}}function Yb(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xb=null;function n_(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Qb=null,mc=null,yc=null;function TT(e){if(e=Fp(e)){if(typeof Qb!="function")throw Error(q(280));var t=e.stateNode;t&&(t=_y(t),Qb(e.stateNode,e.type,t))}}function N5(e){mc?yc?yc.push(e):yc=[e]:mc=e}function D5(){if(mc){var e=mc,t=yc;if(yc=mc=null,TT(e),t)for(e=0;e<t.length;e++)TT(t[e])}}function R5(e,t){return e(t)}function P5(){}var Bx=!1;function L5(e,t,n){if(Bx)return e(t,n);Bx=!0;try{return R5(e,t,n)}finally{Bx=!1,(mc!==null||yc!==null)&&(P5(),D5())}}function Oh(e,t){var n=e.stateNode;if(n===null)return null;var r=_y(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(q(231,t,typeof n));return n}var Kb=!1;if(ss)try{var Kf={};Object.defineProperty(Kf,"passive",{get:function(){Kb=!0}}),window.addEventListener("test",Kf,Kf),window.removeEventListener("test",Kf,Kf)}catch{Kb=!1}function zq(e,t,n,r,i,o,s,a,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var ah=!1,d0=null,h0=!1,Jb=null,Iq={onError:function(e){ah=!0,d0=e}};function jq(e,t,n,r,i,o,s,a,u){ah=!1,d0=null,zq.apply(Iq,arguments)}function Bq(e,t,n,r,i,o,s,a,u){if(jq.apply(this,arguments),ah){if(ah){var l=d0;ah=!1,d0=null}else throw Error(q(198));h0||(h0=!0,Jb=l)}}function ml(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function z5(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function FT(e){if(ml(e)!==e)throw Error(q(188))}function Uq(e){var t=e.alternate;if(!t){if(t=ml(e),t===null)throw Error(q(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return FT(i),e;if(o===r)return FT(i),t;o=o.sibling}throw Error(q(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(q(189))}}if(n.alternate!==r)throw Error(q(190))}if(n.tag!==3)throw Error(q(188));return n.stateNode.current===n?e:t}function I5(e){return e=Uq(e),e!==null?j5(e):null}function j5(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=j5(e);if(t!==null)return t;e=e.sibling}return null}var B5=Er.unstable_scheduleCallback,MT=Er.unstable_cancelCallback,Wq=Er.unstable_shouldYield,qq=Er.unstable_requestPaint,dt=Er.unstable_now,Hq=Er.unstable_getCurrentPriorityLevel,r_=Er.unstable_ImmediatePriority,U5=Er.unstable_UserBlockingPriority,p0=Er.unstable_NormalPriority,Vq=Er.unstable_LowPriority,W5=Er.unstable_IdlePriority,by=null,to=null;function Gq(e){if(to&&typeof to.onCommitFiberRoot=="function")try{to.onCommitFiberRoot(by,e,void 0,(e.current.flags&128)===128)}catch{}}var bi=Math.clz32?Math.clz32:Qq,Yq=Math.log,Xq=Math.LN2;function Qq(e){return e>>>=0,e===0?32:31-(Yq(e)/Xq|0)|0}var Tg=64,Fg=4194304;function Nd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function g0(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Nd(a):(o&=s,o!==0&&(r=Nd(o)))}else s=n&~i,s!==0?r=Nd(s):o!==0&&(r=Nd(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-bi(t),i=1<<n,r|=e[n],t&=~i;return r}function Kq(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jq(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-bi(o),a=1<<s,u=i[s];u===-1?(!(a&n)||a&r)&&(i[s]=Kq(a,t)):u<=t&&(e.expiredLanes|=a),o&=~a}}function Zb(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function q5(){var e=Tg;return Tg<<=1,!(Tg&4194240)&&(Tg=64),e}function Ux(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ap(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-bi(t),e[t]=n}function Zq(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-bi(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}function i_(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-bi(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var ze=0;function H5(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var V5,o_,G5,Y5,X5,ew=!1,Mg=[],Zs=null,ea=null,ta=null,Nh=new Map,Dh=new Map,Ls=[],eH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function OT(e,t){switch(e){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":ea=null;break;case"mouseover":case"mouseout":ta=null;break;case"pointerover":case"pointerout":Nh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dh.delete(t.pointerId)}}function Jf(e,t,n,r,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},t!==null&&(t=Fp(t),t!==null&&o_(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function tH(e,t,n,r,i){switch(t){case"focusin":return Zs=Jf(Zs,e,t,n,r,i),!0;case"dragenter":return ea=Jf(ea,e,t,n,r,i),!0;case"mouseover":return ta=Jf(ta,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Nh.set(o,Jf(Nh.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Dh.set(o,Jf(Dh.get(o)||null,e,t,n,r,i)),!0}return!1}function Q5(e){var t=bu(e.target);if(t!==null){var n=ml(t);if(n!==null){if(t=n.tag,t===13){if(t=z5(n),t!==null){e.blockedOn=t,X5(e.priority,function(){G5(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Fm(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=tw(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Xb=r,n.target.dispatchEvent(r),Xb=null}else return t=Fp(n),t!==null&&o_(t),e.blockedOn=n,!1;t.shift()}return!0}function NT(e,t,n){Fm(e)&&n.delete(t)}function nH(){ew=!1,Zs!==null&&Fm(Zs)&&(Zs=null),ea!==null&&Fm(ea)&&(ea=null),ta!==null&&Fm(ta)&&(ta=null),Nh.forEach(NT),Dh.forEach(NT)}function Zf(e,t){e.blockedOn===t&&(e.blockedOn=null,ew||(ew=!0,Er.unstable_scheduleCallback(Er.unstable_NormalPriority,nH)))}function Rh(e){function t(i){return Zf(i,e)}if(0<Mg.length){Zf(Mg[0],e);for(var n=1;n<Mg.length;n++){var r=Mg[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Zs!==null&&Zf(Zs,e),ea!==null&&Zf(ea,e),ta!==null&&Zf(ta,e),Nh.forEach(t),Dh.forEach(t),n=0;n<Ls.length;n++)r=Ls[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Ls.length&&(n=Ls[0],n.blockedOn===null);)Q5(n),n.blockedOn===null&&Ls.shift()}var vc=ps.ReactCurrentBatchConfig,m0=!0;function rH(e,t,n,r){var i=ze,o=vc.transition;vc.transition=null;try{ze=1,s_(e,t,n,r)}finally{ze=i,vc.transition=o}}function iH(e,t,n,r){var i=ze,o=vc.transition;vc.transition=null;try{ze=4,s_(e,t,n,r)}finally{ze=i,vc.transition=o}}function s_(e,t,n,r){if(m0){var i=tw(e,t,n,r);if(i===null)Jx(e,t,r,y0,n),OT(e,r);else if(tH(i,e,t,n,r))r.stopPropagation();else if(OT(e,r),t&4&&-1<eH.indexOf(e)){for(;i!==null;){var o=Fp(i);if(o!==null&&V5(o),o=tw(e,t,n,r),o===null&&Jx(e,t,r,y0,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Jx(e,t,r,null,n)}}var y0=null;function tw(e,t,n,r){if(y0=null,e=n_(r),e=bu(e),e!==null)if(t=ml(e),t===null)e=null;else if(n=t.tag,n===13){if(e=z5(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return y0=e,null}function K5(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hq()){case r_:return 1;case U5:return 4;case p0:case Vq:return 16;case W5:return 536870912;default:return 16}default:return 16}}var Bs=null,a_=null,Mm=null;function J5(){if(Mm)return Mm;var e,t=a_,n=t.length,r,i="value"in Bs?Bs.value:Bs.textContent,o=i.length;for(e=0;e<n&&t[e]===i[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===i[o-r];r++);return Mm=i.slice(e,1<r?1-r:void 0)}function Om(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Og(){return!0}function DT(){return!1}function Tr(e){function t(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Og:DT,this.isPropagationStopped=DT,this}return ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Og)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Og)},persist:function(){},isPersistent:Og}),t}var Sf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},u_=Tr(Sf),Tp=ot({},Sf,{view:0,detail:0}),oH=Tr(Tp),Wx,qx,ed,wy=ot({},Tp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:l_,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ed&&(ed&&e.type==="mousemove"?(Wx=e.screenX-ed.screenX,qx=e.screenY-ed.screenY):qx=Wx=0,ed=e),Wx)},movementY:function(e){return"movementY"in e?e.movementY:qx}}),RT=Tr(wy),sH=ot({},wy,{dataTransfer:0}),aH=Tr(sH),uH=ot({},Tp,{relatedTarget:0}),Hx=Tr(uH),lH=ot({},Sf,{animationName:0,elapsedTime:0,pseudoElement:0}),cH=Tr(lH),fH=ot({},Sf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),dH=Tr(fH),hH=ot({},Sf,{data:0}),PT=Tr(hH),pH={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gH={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mH={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yH(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=mH[e])?!!t[e]:!1}function l_(){return yH}var vH=ot({},Tp,{key:function(e){if(e.key){var t=pH[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Om(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?gH[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:l_,charCode:function(e){return e.type==="keypress"?Om(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Om(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),xH=Tr(vH),bH=ot({},wy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),LT=Tr(bH),wH=ot({},Tp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:l_}),EH=Tr(wH),SH=ot({},Sf,{propertyName:0,elapsedTime:0,pseudoElement:0}),_H=Tr(SH),kH=ot({},wy,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$H=Tr(kH),CH=[9,13,27,32],c_=ss&&"CompositionEvent"in window,uh=null;ss&&"documentMode"in document&&(uh=document.documentMode);var AH=ss&&"TextEvent"in window&&!uh,Z5=ss&&(!c_||uh&&8<uh&&11>=uh),zT=String.fromCharCode(32),IT=!1;function eP(e,t){switch(e){case"keyup":return CH.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tP(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Jl=!1;function TH(e,t){switch(e){case"compositionend":return tP(t);case"keypress":return t.which!==32?null:(IT=!0,zT);case"textInput":return e=t.data,e===zT&&IT?null:e;default:return null}}function FH(e,t){if(Jl)return e==="compositionend"||!c_&&eP(e,t)?(e=J5(),Mm=a_=Bs=null,Jl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Z5&&t.locale!=="ko"?null:t.data;default:return null}}var MH={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jT(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!MH[e.type]:t==="textarea"}function nP(e,t,n,r){N5(r),t=v0(t,"onChange"),0<t.length&&(n=new u_("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var lh=null,Ph=null;function OH(e){hP(e,0)}function Ey(e){var t=tc(e);if($5(t))return e}function NH(e,t){if(e==="change")return t}var rP=!1;if(ss){var Vx;if(ss){var Gx="oninput"in document;if(!Gx){var BT=document.createElement("div");BT.setAttribute("oninput","return;"),Gx=typeof BT.oninput=="function"}Vx=Gx}else Vx=!1;rP=Vx&&(!document.documentMode||9<document.documentMode)}function UT(){lh&&(lh.detachEvent("onpropertychange",iP),Ph=lh=null)}function iP(e){if(e.propertyName==="value"&&Ey(Ph)){var t=[];nP(t,Ph,e,n_(e)),L5(OH,t)}}function DH(e,t,n){e==="focusin"?(UT(),lh=t,Ph=n,lh.attachEvent("onpropertychange",iP)):e==="focusout"&&UT()}function RH(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ey(Ph)}function PH(e,t){if(e==="click")return Ey(t)}function LH(e,t){if(e==="input"||e==="change")return Ey(t)}function zH(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var $i=typeof Object.is=="function"?Object.is:zH;function Lh(e,t){if($i(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Lb.call(t,i)||!$i(e[i],t[i]))return!1}return!0}function WT(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function qT(e,t){var n=WT(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=WT(n)}}function oP(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?oP(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function sP(){for(var e=window,t=f0();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=f0(e.document)}return t}function f_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function IH(e){var t=sP(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&oP(n.ownerDocument.documentElement,n)){if(r!==null&&f_(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=qT(n,o);var s=qT(n,r);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var jH=ss&&"documentMode"in document&&11>=document.documentMode,Zl=null,nw=null,ch=null,rw=!1;function HT(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;rw||Zl==null||Zl!==f0(r)||(r=Zl,"selectionStart"in r&&f_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ch&&Lh(ch,r)||(ch=r,r=v0(nw,"onSelect"),0<r.length&&(t=new u_("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Zl)))}function Ng(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ec={animationend:Ng("Animation","AnimationEnd"),animationiteration:Ng("Animation","AnimationIteration"),animationstart:Ng("Animation","AnimationStart"),transitionend:Ng("Transition","TransitionEnd")},Yx={},aP={};ss&&(aP=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function Sy(e){if(Yx[e])return Yx[e];if(!ec[e])return e;var t=ec[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in aP)return Yx[e]=t[n];return e}var uP=Sy("animationend"),lP=Sy("animationiteration"),cP=Sy("animationstart"),fP=Sy("transitionend"),dP=new Map,VT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oa(e,t){dP.set(e,t),gl(t,[e])}for(var Xx=0;Xx<VT.length;Xx++){var Qx=VT[Xx],BH=Qx.toLowerCase(),UH=Qx[0].toUpperCase()+Qx.slice(1);Oa(BH,"on"+UH)}Oa(uP,"onAnimationEnd");Oa(lP,"onAnimationIteration");Oa(cP,"onAnimationStart");Oa("dblclick","onDoubleClick");Oa("focusin","onFocus");Oa("focusout","onBlur");Oa(fP,"onTransitionEnd");Nc("onMouseEnter",["mouseout","mouseover"]);Nc("onMouseLeave",["mouseout","mouseover"]);Nc("onPointerEnter",["pointerout","pointerover"]);Nc("onPointerLeave",["pointerout","pointerover"]);gl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gl("onBeforeInput",["compositionend","keypress","textInput","paste"]);gl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WH=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dd));function GT(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Bq(r,t,void 0,e),e.currentTarget=null}function hP(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],u=a.instance,l=a.currentTarget;if(a=a.listener,u!==o&&i.isPropagationStopped())break e;GT(i,a,l),o=u}else for(s=0;s<r.length;s++){if(a=r[s],u=a.instance,l=a.currentTarget,a=a.listener,u!==o&&i.isPropagationStopped())break e;GT(i,a,l),o=u}}}if(h0)throw e=Jb,h0=!1,Jb=null,e}function Ye(e,t){var n=t[uw];n===void 0&&(n=t[uw]=new Set);var r=e+"__bubble";n.has(r)||(pP(t,e,2,!1),n.add(r))}function Kx(e,t,n){var r=0;t&&(r|=4),pP(n,e,r,t)}var Dg="_reactListening"+Math.random().toString(36).slice(2);function zh(e){if(!e[Dg]){e[Dg]=!0,w5.forEach(function(n){n!=="selectionchange"&&(WH.has(n)||Kx(n,!1,e),Kx(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Dg]||(t[Dg]=!0,Kx("selectionchange",!1,t))}}function pP(e,t,n,r){switch(K5(t)){case 1:var i=rH;break;case 4:i=iH;break;default:i=s_}n=i.bind(null,t,n,e),i=void 0,!Kb||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Jx(e,t,n,r,i){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;s=s.return}for(;a!==null;){if(s=bu(a),s===null)return;if(u=s.tag,u===5||u===6){r=o=s;continue e}a=a.parentNode}}r=r.return}L5(function(){var l=o,c=n_(n),f=[];e:{var d=dP.get(e);if(d!==void 0){var h=u_,p=e;switch(e){case"keypress":if(Om(n)===0)break e;case"keydown":case"keyup":h=xH;break;case"focusin":p="focus",h=Hx;break;case"focusout":p="blur",h=Hx;break;case"beforeblur":case"afterblur":h=Hx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=RT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=aH;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=EH;break;case uP:case lP:case cP:h=cH;break;case fP:h=_H;break;case"scroll":h=oH;break;case"wheel":h=$H;break;case"copy":case"cut":case"paste":h=dH;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=LT}var g=(t&4)!==0,y=!g&&e==="scroll",m=g?d!==null?d+"Capture":null:d;g=[];for(var v=l,x;v!==null;){x=v;var b=x.stateNode;if(x.tag===5&&b!==null&&(x=b,m!==null&&(b=Oh(v,m),b!=null&&g.push(Ih(v,b,x)))),y)break;v=v.return}0<g.length&&(d=new h(d,p,null,n,c),f.push({event:d,listeners:g}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&n!==Xb&&(p=n.relatedTarget||n.fromElement)&&(bu(p)||p[as]))break e;if((h||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?bu(p):null,p!==null&&(y=ml(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(g=RT,b="onMouseLeave",m="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(g=LT,b="onPointerLeave",m="onPointerEnter",v="pointer"),y=h==null?d:tc(h),x=p==null?d:tc(p),d=new g(b,v+"leave",h,n,c),d.target=y,d.relatedTarget=x,b=null,bu(c)===l&&(g=new g(m,v+"enter",p,n,c),g.target=x,g.relatedTarget=y,b=g),y=b,h&&p)t:{for(g=h,m=p,v=0,x=g;x;x=Nl(x))v++;for(x=0,b=m;b;b=Nl(b))x++;for(;0<v-x;)g=Nl(g),v--;for(;0<x-v;)m=Nl(m),x--;for(;v--;){if(g===m||m!==null&&g===m.alternate)break t;g=Nl(g),m=Nl(m)}g=null}else g=null;h!==null&&YT(f,d,h,g,!1),p!==null&&y!==null&&YT(f,y,p,g,!0)}}e:{if(d=l?tc(l):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var w=NH;else if(jT(d))if(rP)w=LH;else{w=RH;var S=DH}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=PH);if(w&&(w=w(e,l))){nP(f,w,n,c);break e}S&&S(e,d,l),e==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&qb(d,"number",d.value)}switch(S=l?tc(l):window,e){case"focusin":(jT(S)||S.contentEditable==="true")&&(Zl=S,nw=l,ch=null);break;case"focusout":ch=nw=Zl=null;break;case"mousedown":rw=!0;break;case"contextmenu":case"mouseup":case"dragend":rw=!1,HT(f,n,c);break;case"selectionchange":if(jH)break;case"keydown":case"keyup":HT(f,n,c)}var E;if(c_)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Jl?eP(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(Z5&&n.locale!=="ko"&&(Jl||_!=="onCompositionStart"?_==="onCompositionEnd"&&Jl&&(E=J5()):(Bs=c,a_="value"in Bs?Bs.value:Bs.textContent,Jl=!0)),S=v0(l,_),0<S.length&&(_=new PT(_,e,null,n,c),f.push({event:_,listeners:S}),E?_.data=E:(E=tP(n),E!==null&&(_.data=E)))),(E=AH?TH(e,n):FH(e,n))&&(l=v0(l,"onBeforeInput"),0<l.length&&(c=new PT("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:l}),c.data=E))}hP(f,t)})}function Ih(e,t,n){return{instance:e,listener:t,currentTarget:n}}function v0(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Oh(e,n),o!=null&&r.unshift(Ih(e,o,i)),o=Oh(e,t),o!=null&&r.push(Ih(e,o,i))),e=e.return}return r}function Nl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function YT(e,t,n,r,i){for(var o=t._reactName,s=[];n!==null&&n!==r;){var a=n,u=a.alternate,l=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&l!==null&&(a=l,i?(u=Oh(n,o),u!=null&&s.unshift(Ih(n,u,a))):i||(u=Oh(n,o),u!=null&&s.push(Ih(n,u,a)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var qH=/\r\n?/g,HH=/\u0000|\uFFFD/g;function XT(e){return(typeof e=="string"?e:""+e).replace(qH,`
`).replace(HH,"")}function Rg(e,t,n){if(t=XT(t),XT(e)!==t&&n)throw Error(q(425))}function x0(){}var iw=null,ow=null;function sw(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var aw=typeof setTimeout=="function"?setTimeout:void 0,VH=typeof clearTimeout=="function"?clearTimeout:void 0,QT=typeof Promise=="function"?Promise:void 0,GH=typeof queueMicrotask=="function"?queueMicrotask:typeof QT<"u"?function(e){return QT.resolve(null).then(e).catch(YH)}:aw;function YH(e){setTimeout(function(){throw e})}function Zx(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Rh(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Rh(t)}function na(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function KT(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var _f=Math.random().toString(36).slice(2),Xi="__reactFiber$"+_f,jh="__reactProps$"+_f,as="__reactContainer$"+_f,uw="__reactEvents$"+_f,XH="__reactListeners$"+_f,QH="__reactHandles$"+_f;function bu(e){var t=e[Xi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[as]||n[Xi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=KT(e);e!==null;){if(n=e[Xi])return n;e=KT(e)}return t}e=n,n=e.parentNode}return null}function Fp(e){return e=e[Xi]||e[as],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function tc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(q(33))}function _y(e){return e[jh]||null}var lw=[],nc=-1;function Na(e){return{current:e}}function Ke(e){0>nc||(e.current=lw[nc],lw[nc]=null,nc--)}function He(e,t){nc++,lw[nc]=e.current,e.current=t}var ga={},mn=Na(ga),Xn=Na(!1),ju=ga;function Dc(e,t){var n=e.type.contextTypes;if(!n)return ga;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Qn(e){return e=e.childContextTypes,e!=null}function b0(){Ke(Xn),Ke(mn)}function JT(e,t,n){if(mn.current!==ga)throw Error(q(168));He(mn,t),He(Xn,n)}function gP(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(q(108,Dq(e)||"Unknown",i));return ot({},n,r)}function w0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ga,ju=mn.current,He(mn,e),He(Xn,Xn.current),!0}function ZT(e,t,n){var r=e.stateNode;if(!r)throw Error(q(169));n?(e=gP(e,t,ju),r.__reactInternalMemoizedMergedChildContext=e,Ke(Xn),Ke(mn),He(mn,e)):Ke(Xn),He(Xn,n)}var zo=null,ky=!1,e2=!1;function mP(e){zo===null?zo=[e]:zo.push(e)}function KH(e){ky=!0,mP(e)}function Da(){if(!e2&&zo!==null){e2=!0;var e=0,t=ze;try{var n=zo;for(ze=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}zo=null,ky=!1}catch(i){throw zo!==null&&(zo=zo.slice(e+1)),B5(r_,Da),i}finally{ze=t,e2=!1}}return null}var rc=[],ic=0,E0=null,S0=0,Or=[],Nr=0,Bu=null,Wo=1,qo="";function lu(e,t){rc[ic++]=S0,rc[ic++]=E0,E0=e,S0=t}function yP(e,t,n){Or[Nr++]=Wo,Or[Nr++]=qo,Or[Nr++]=Bu,Bu=e;var r=Wo;e=qo;var i=32-bi(r)-1;r&=~(1<<i),n+=1;var o=32-bi(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Wo=1<<32-bi(t)+i|n<<i|r,qo=o+e}else Wo=1<<o|n<<i|r,qo=e}function d_(e){e.return!==null&&(lu(e,1),yP(e,1,0))}function h_(e){for(;e===E0;)E0=rc[--ic],rc[ic]=null,S0=rc[--ic],rc[ic]=null;for(;e===Bu;)Bu=Or[--Nr],Or[Nr]=null,qo=Or[--Nr],Or[Nr]=null,Wo=Or[--Nr],Or[Nr]=null}var br=null,yr=null,Ze=!1,li=null;function vP(e,t){var n=Dr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function eF(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,br=e,yr=na(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,br=e,yr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Bu!==null?{id:Wo,overflow:qo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Dr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,br=e,yr=null,!0):!1;default:return!1}}function cw(e){return(e.mode&1)!==0&&(e.flags&128)===0}function fw(e){if(Ze){var t=yr;if(t){var n=t;if(!eF(e,t)){if(cw(e))throw Error(q(418));t=na(n.nextSibling);var r=br;t&&eF(e,t)?vP(r,n):(e.flags=e.flags&-4097|2,Ze=!1,br=e)}}else{if(cw(e))throw Error(q(418));e.flags=e.flags&-4097|2,Ze=!1,br=e}}}function tF(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;br=e}function Pg(e){if(e!==br)return!1;if(!Ze)return tF(e),Ze=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!sw(e.type,e.memoizedProps)),t&&(t=yr)){if(cw(e))throw xP(),Error(q(418));for(;t;)vP(e,t),t=na(t.nextSibling)}if(tF(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){yr=na(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}yr=null}}else yr=br?na(e.stateNode.nextSibling):null;return!0}function xP(){for(var e=yr;e;)e=na(e.nextSibling)}function Rc(){yr=br=null,Ze=!1}function p_(e){li===null?li=[e]:li.push(e)}var JH=ps.ReactCurrentBatchConfig;function oi(e,t){if(e&&e.defaultProps){t=ot({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}var _0=Na(null),k0=null,oc=null,g_=null;function m_(){g_=oc=k0=null}function y_(e){var t=_0.current;Ke(_0),e._currentValue=t}function dw(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function xc(e,t){k0=e,g_=oc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Gn=!0),e.firstContext=null)}function Ur(e){var t=e._currentValue;if(g_!==e)if(e={context:e,memoizedValue:t,next:null},oc===null){if(k0===null)throw Error(q(308));oc=e,k0.dependencies={lanes:0,firstContext:e}}else oc=oc.next=e;return t}var wu=null;function v_(e){wu===null?wu=[e]:wu.push(e)}function bP(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,v_(t)):(n.next=i.next,i.next=n),t.interleaved=n,us(e,r)}function us(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ms=!1;function x_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wP(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ko(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ra(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ce&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,us(e,n)}return i=r.interleaved,i===null?(t.next=t,v_(r)):(t.next=i.next,i.next=t),r.interleaved=t,us(e,n)}function Nm(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,i_(e,n)}}function nF(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=t:o=o.next=t}else i=o=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function $0(e,t,n,r){var i=e.updateQueue;Ms=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var u=a,l=u.next;u.next=null,s===null?o=l:s.next=l,s=u;var c=e.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==s&&(a===null?c.firstBaseUpdate=l:a.next=l,c.lastBaseUpdate=u))}if(o!==null){var f=i.baseState;s=0,c=l=u=null,a=o;do{var d=a.lane,h=a.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(d=t,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){f=p.call(h,f,d);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(h,f,d):p,d==null)break e;f=ot({},f,d);break e;case 2:Ms=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else h={eventTime:h,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(l=c=h,u=f):c=c.next=h,s|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(1);if(c===null&&(u=f),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);Wu|=s,e.lanes=s,e.memoizedState=f}}function rF(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(q(191,i));i.call(r)}}}var EP=new b5.Component().refs;function hw(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ot({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var $y={isMounted:function(e){return(e=e._reactInternals)?ml(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Fn(),i=oa(e),o=Ko(r,i);o.payload=t,n!=null&&(o.callback=n),t=ra(e,o,i),t!==null&&(wi(t,e,i,r),Nm(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Fn(),i=oa(e),o=Ko(r,i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=ra(e,o,i),t!==null&&(wi(t,e,i,r),Nm(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Fn(),r=oa(e),i=Ko(n,r);i.tag=2,t!=null&&(i.callback=t),t=ra(e,i,r),t!==null&&(wi(t,e,r,n),Nm(t,e,r))}};function iF(e,t,n,r,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,s):t.prototype&&t.prototype.isPureReactComponent?!Lh(n,r)||!Lh(i,o):!0}function SP(e,t,n){var r=!1,i=ga,o=t.contextType;return typeof o=="object"&&o!==null?o=Ur(o):(i=Qn(t)?ju:mn.current,r=t.contextTypes,o=(r=r!=null)?Dc(e,i):ga),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=$y,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function oF(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&$y.enqueueReplaceState(t,t.state,null)}function pw(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=EP,x_(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=Ur(o):(o=Qn(t)?ju:mn.current,i.context=Dc(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(hw(e,t,o,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&$y.enqueueReplaceState(i,i.state,null),$0(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function td(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(q(309));var r=n.stateNode}if(!r)throw Error(q(147,e));var i=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;a===EP&&(a=i.refs={}),s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(q(284));if(!n._owner)throw Error(q(290,e))}return e}function Lg(e,t){throw e=Object.prototype.toString.call(t),Error(q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function sF(e){var t=e._init;return t(e._payload)}function _P(e){function t(m,v){if(e){var x=m.deletions;x===null?(m.deletions=[v],m.flags|=16):x.push(v)}}function n(m,v){if(!e)return null;for(;v!==null;)t(m,v),v=v.sibling;return null}function r(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function i(m,v){return m=sa(m,v),m.index=0,m.sibling=null,m}function o(m,v,x){return m.index=x,e?(x=m.alternate,x!==null?(x=x.index,x<v?(m.flags|=2,v):x):(m.flags|=2,v)):(m.flags|=1048576,v)}function s(m){return e&&m.alternate===null&&(m.flags|=2),m}function a(m,v,x,b){return v===null||v.tag!==6?(v=a2(x,m.mode,b),v.return=m,v):(v=i(v,x),v.return=m,v)}function u(m,v,x,b){var w=x.type;return w===Kl?c(m,v,x.props.children,b,x.key):v!==null&&(v.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Fs&&sF(w)===v.type)?(b=i(v,x.props),b.ref=td(m,v,x),b.return=m,b):(b=Im(x.type,x.key,x.props,null,m.mode,b),b.ref=td(m,v,x),b.return=m,b)}function l(m,v,x,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==x.containerInfo||v.stateNode.implementation!==x.implementation?(v=u2(x,m.mode,b),v.return=m,v):(v=i(v,x.children||[]),v.return=m,v)}function c(m,v,x,b,w){return v===null||v.tag!==7?(v=Tu(x,m.mode,b,w),v.return=m,v):(v=i(v,x),v.return=m,v)}function f(m,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return v=a2(""+v,m.mode,x),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case $g:return x=Im(v.type,v.key,v.props,null,m.mode,x),x.ref=td(m,null,v),x.return=m,x;case Ql:return v=u2(v,m.mode,x),v.return=m,v;case Fs:var b=v._init;return f(m,b(v._payload),x)}if(Od(v)||Qf(v))return v=Tu(v,m.mode,x,null),v.return=m,v;Lg(m,v)}return null}function d(m,v,x,b){var w=v!==null?v.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return w!==null?null:a(m,v,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case $g:return x.key===w?u(m,v,x,b):null;case Ql:return x.key===w?l(m,v,x,b):null;case Fs:return w=x._init,d(m,v,w(x._payload),b)}if(Od(x)||Qf(x))return w!==null?null:c(m,v,x,b,null);Lg(m,x)}return null}function h(m,v,x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return m=m.get(x)||null,a(v,m,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case $g:return m=m.get(b.key===null?x:b.key)||null,u(v,m,b,w);case Ql:return m=m.get(b.key===null?x:b.key)||null,l(v,m,b,w);case Fs:var S=b._init;return h(m,v,x,S(b._payload),w)}if(Od(b)||Qf(b))return m=m.get(x)||null,c(v,m,b,w,null);Lg(v,b)}return null}function p(m,v,x,b){for(var w=null,S=null,E=v,_=v=0,$=null;E!==null&&_<x.length;_++){E.index>_?($=E,E=null):$=E.sibling;var k=d(m,E,x[_],b);if(k===null){E===null&&(E=$);break}e&&E&&k.alternate===null&&t(m,E),v=o(k,v,_),S===null?w=k:S.sibling=k,S=k,E=$}if(_===x.length)return n(m,E),Ze&&lu(m,_),w;if(E===null){for(;_<x.length;_++)E=f(m,x[_],b),E!==null&&(v=o(E,v,_),S===null?w=E:S.sibling=E,S=E);return Ze&&lu(m,_),w}for(E=r(m,E);_<x.length;_++)$=h(E,m,_,x[_],b),$!==null&&(e&&$.alternate!==null&&E.delete($.key===null?_:$.key),v=o($,v,_),S===null?w=$:S.sibling=$,S=$);return e&&E.forEach(function(A){return t(m,A)}),Ze&&lu(m,_),w}function g(m,v,x,b){var w=Qf(x);if(typeof w!="function")throw Error(q(150));if(x=w.call(x),x==null)throw Error(q(151));for(var S=w=null,E=v,_=v=0,$=null,k=x.next();E!==null&&!k.done;_++,k=x.next()){E.index>_?($=E,E=null):$=E.sibling;var A=d(m,E,k.value,b);if(A===null){E===null&&(E=$);break}e&&E&&A.alternate===null&&t(m,E),v=o(A,v,_),S===null?w=A:S.sibling=A,S=A,E=$}if(k.done)return n(m,E),Ze&&lu(m,_),w;if(E===null){for(;!k.done;_++,k=x.next())k=f(m,k.value,b),k!==null&&(v=o(k,v,_),S===null?w=k:S.sibling=k,S=k);return Ze&&lu(m,_),w}for(E=r(m,E);!k.done;_++,k=x.next())k=h(E,m,_,k.value,b),k!==null&&(e&&k.alternate!==null&&E.delete(k.key===null?_:k.key),v=o(k,v,_),S===null?w=k:S.sibling=k,S=k);return e&&E.forEach(function(R){return t(m,R)}),Ze&&lu(m,_),w}function y(m,v,x,b){if(typeof x=="object"&&x!==null&&x.type===Kl&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case $g:e:{for(var w=x.key,S=v;S!==null;){if(S.key===w){if(w=x.type,w===Kl){if(S.tag===7){n(m,S.sibling),v=i(S,x.props.children),v.return=m,m=v;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Fs&&sF(w)===S.type){n(m,S.sibling),v=i(S,x.props),v.ref=td(m,S,x),v.return=m,m=v;break e}n(m,S);break}else t(m,S);S=S.sibling}x.type===Kl?(v=Tu(x.props.children,m.mode,b,x.key),v.return=m,m=v):(b=Im(x.type,x.key,x.props,null,m.mode,b),b.ref=td(m,v,x),b.return=m,m=b)}return s(m);case Ql:e:{for(S=x.key;v!==null;){if(v.key===S)if(v.tag===4&&v.stateNode.containerInfo===x.containerInfo&&v.stateNode.implementation===x.implementation){n(m,v.sibling),v=i(v,x.children||[]),v.return=m,m=v;break e}else{n(m,v);break}else t(m,v);v=v.sibling}v=u2(x,m.mode,b),v.return=m,m=v}return s(m);case Fs:return S=x._init,y(m,v,S(x._payload),b)}if(Od(x))return p(m,v,x,b);if(Qf(x))return g(m,v,x,b);Lg(m,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,v!==null&&v.tag===6?(n(m,v.sibling),v=i(v,x),v.return=m,m=v):(n(m,v),v=a2(x,m.mode,b),v.return=m,m=v),s(m)):n(m,v)}return y}var Pc=_P(!0),kP=_P(!1),Mp={},no=Na(Mp),Bh=Na(Mp),Uh=Na(Mp);function Eu(e){if(e===Mp)throw Error(q(174));return e}function b_(e,t){switch(He(Uh,t),He(Bh,e),He(no,Mp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Vb(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Vb(t,e)}Ke(no),He(no,t)}function Lc(){Ke(no),Ke(Bh),Ke(Uh)}function $P(e){Eu(Uh.current);var t=Eu(no.current),n=Vb(t,e.type);t!==n&&(He(Bh,e),He(no,n))}function w_(e){Bh.current===e&&(Ke(no),Ke(Bh))}var rt=Na(0);function C0(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var t2=[];function E_(){for(var e=0;e<t2.length;e++)t2[e]._workInProgressVersionPrimary=null;t2.length=0}var Dm=ps.ReactCurrentDispatcher,n2=ps.ReactCurrentBatchConfig,Uu=0,it=null,vt=null,Ct=null,A0=!1,fh=!1,Wh=0,ZH=0;function Zt(){throw Error(q(321))}function S_(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!$i(e[n],t[n]))return!1;return!0}function __(e,t,n,r,i,o){if(Uu=o,it=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Dm.current=e===null||e.memoizedState===null?rV:iV,e=n(r,i),fh){o=0;do{if(fh=!1,Wh=0,25<=o)throw Error(q(301));o+=1,Ct=vt=null,t.updateQueue=null,Dm.current=oV,e=n(r,i)}while(fh)}if(Dm.current=T0,t=vt!==null&&vt.next!==null,Uu=0,Ct=vt=it=null,A0=!1,t)throw Error(q(300));return e}function k_(){var e=Wh!==0;return Wh=0,e}function Hi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ct===null?it.memoizedState=Ct=e:Ct=Ct.next=e,Ct}function Wr(){if(vt===null){var e=it.alternate;e=e!==null?e.memoizedState:null}else e=vt.next;var t=Ct===null?it.memoizedState:Ct.next;if(t!==null)Ct=t,vt=e;else{if(e===null)throw Error(q(310));vt=e,e={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},Ct===null?it.memoizedState=Ct=e:Ct=Ct.next=e}return Ct}function qh(e,t){return typeof t=="function"?t(e):t}function r2(e){var t=Wr(),n=t.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=e;var r=vt,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,u=null,l=o;do{var c=l.lane;if((Uu&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var f={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(a=u=f,s=r):u=u.next=f,it.lanes|=c,Wu|=c}l=l.next}while(l!==null&&l!==o);u===null?s=r:u.next=a,$i(r,t.memoizedState)||(Gn=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do o=i.lane,it.lanes|=o,Wu|=o,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function i2(e){var t=Wr(),n=t.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);$i(o,t.memoizedState)||(Gn=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function CP(){}function AP(e,t){var n=it,r=Wr(),i=t(),o=!$i(r.memoizedState,i);if(o&&(r.memoizedState=i,Gn=!0),r=r.queue,$_(MP.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||Ct!==null&&Ct.memoizedState.tag&1){if(n.flags|=2048,Hh(9,FP.bind(null,n,r,i,t),void 0,null),Dt===null)throw Error(q(349));Uu&30||TP(n,t,i)}return i}function TP(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=it.updateQueue,t===null?(t={lastEffect:null,stores:null},it.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function FP(e,t,n,r){t.value=n,t.getSnapshot=r,OP(t)&&NP(e)}function MP(e,t,n){return n(function(){OP(t)&&NP(e)})}function OP(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!$i(e,n)}catch{return!0}}function NP(e){var t=us(e,1);t!==null&&wi(t,e,1,-1)}function aF(e){var t=Hi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qh,lastRenderedState:e},t.queue=e,e=e.dispatch=nV.bind(null,it,e),[t.memoizedState,e]}function Hh(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=it.updateQueue,t===null?(t={lastEffect:null,stores:null},it.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function DP(){return Wr().memoizedState}function Rm(e,t,n,r){var i=Hi();it.flags|=e,i.memoizedState=Hh(1|t,n,void 0,r===void 0?null:r)}function Cy(e,t,n,r){var i=Wr();r=r===void 0?null:r;var o=void 0;if(vt!==null){var s=vt.memoizedState;if(o=s.destroy,r!==null&&S_(r,s.deps)){i.memoizedState=Hh(t,n,o,r);return}}it.flags|=e,i.memoizedState=Hh(1|t,n,o,r)}function uF(e,t){return Rm(8390656,8,e,t)}function $_(e,t){return Cy(2048,8,e,t)}function RP(e,t){return Cy(4,2,e,t)}function PP(e,t){return Cy(4,4,e,t)}function LP(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function zP(e,t,n){return n=n!=null?n.concat([e]):null,Cy(4,4,LP.bind(null,t,e),n)}function C_(){}function IP(e,t){var n=Wr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&S_(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function jP(e,t){var n=Wr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&S_(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function BP(e,t,n){return Uu&21?($i(n,t)||(n=q5(),it.lanes|=n,Wu|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Gn=!0),e.memoizedState=n)}function eV(e,t){var n=ze;ze=n!==0&&4>n?n:4,e(!0);var r=n2.transition;n2.transition={};try{e(!1),t()}finally{ze=n,n2.transition=r}}function UP(){return Wr().memoizedState}function tV(e,t,n){var r=oa(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},WP(e))qP(t,n);else if(n=bP(e,t,n,r),n!==null){var i=Fn();wi(n,e,r,i),HP(n,t,r)}}function nV(e,t,n){var r=oa(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(WP(e))qP(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,$i(a,s)){var u=t.interleaved;u===null?(i.next=i,v_(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}n=bP(e,t,i,r),n!==null&&(i=Fn(),wi(n,e,r,i),HP(n,t,r))}}function WP(e){var t=e.alternate;return e===it||t!==null&&t===it}function qP(e,t){fh=A0=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function HP(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,i_(e,n)}}var T0={readContext:Ur,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useInsertionEffect:Zt,useLayoutEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useMutableSource:Zt,useSyncExternalStore:Zt,useId:Zt,unstable_isNewReconciler:!1},rV={readContext:Ur,useCallback:function(e,t){return Hi().memoizedState=[e,t===void 0?null:t],e},useContext:Ur,useEffect:uF,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Rm(4194308,4,LP.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Rm(4194308,4,e,t)},useInsertionEffect:function(e,t){return Rm(4,2,e,t)},useMemo:function(e,t){var n=Hi();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Hi();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=tV.bind(null,it,e),[r.memoizedState,e]},useRef:function(e){var t=Hi();return e={current:e},t.memoizedState=e},useState:aF,useDebugValue:C_,useDeferredValue:function(e){return Hi().memoizedState=e},useTransition:function(){var e=aF(!1),t=e[0];return e=eV.bind(null,e[1]),Hi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=it,i=Hi();if(Ze){if(n===void 0)throw Error(q(407));n=n()}else{if(n=t(),Dt===null)throw Error(q(349));Uu&30||TP(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,uF(MP.bind(null,r,o,e),[e]),r.flags|=2048,Hh(9,FP.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Hi(),t=Dt.identifierPrefix;if(Ze){var n=qo,r=Wo;n=(r&~(1<<32-bi(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Wh++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=ZH++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},iV={readContext:Ur,useCallback:IP,useContext:Ur,useEffect:$_,useImperativeHandle:zP,useInsertionEffect:RP,useLayoutEffect:PP,useMemo:jP,useReducer:r2,useRef:DP,useState:function(){return r2(qh)},useDebugValue:C_,useDeferredValue:function(e){var t=Wr();return BP(t,vt.memoizedState,e)},useTransition:function(){var e=r2(qh)[0],t=Wr().memoizedState;return[e,t]},useMutableSource:CP,useSyncExternalStore:AP,useId:UP,unstable_isNewReconciler:!1},oV={readContext:Ur,useCallback:IP,useContext:Ur,useEffect:$_,useImperativeHandle:zP,useInsertionEffect:RP,useLayoutEffect:PP,useMemo:jP,useReducer:i2,useRef:DP,useState:function(){return i2(qh)},useDebugValue:C_,useDeferredValue:function(e){var t=Wr();return vt===null?t.memoizedState=e:BP(t,vt.memoizedState,e)},useTransition:function(){var e=i2(qh)[0],t=Wr().memoizedState;return[e,t]},useMutableSource:CP,useSyncExternalStore:AP,useId:UP,unstable_isNewReconciler:!1};function zc(e,t){try{var n="",r=t;do n+=Nq(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function o2(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function gw(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var sV=typeof WeakMap=="function"?WeakMap:Map;function VP(e,t,n){n=Ko(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){M0||(M0=!0,kw=r),gw(e,t)},n}function GP(e,t,n){n=Ko(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){gw(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){gw(e,t),typeof r!="function"&&(ia===null?ia=new Set([this]):ia.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function lF(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new sV;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=bV.bind(null,e,t,n),t.then(e,e))}function cF(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function fF(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Ko(-1,1),t.tag=2,ra(n,t,1))),n.lanes|=1),e)}var aV=ps.ReactCurrentOwner,Gn=!1;function Sn(e,t,n,r){t.child=e===null?kP(t,null,n,r):Pc(t,e.child,n,r)}function dF(e,t,n,r,i){n=n.render;var o=t.ref;return xc(t,i),r=__(e,t,n,r,o,i),n=k_(),e!==null&&!Gn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ls(e,t,i)):(Ze&&n&&d_(t),t.flags|=1,Sn(e,t,r,i),t.child)}function hF(e,t,n,r,i){if(e===null){var o=n.type;return typeof o=="function"&&!R_(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,YP(e,t,o,r,i)):(e=Im(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Lh,n(s,r)&&e.ref===t.ref)return ls(e,t,i)}return t.flags|=1,e=sa(o,r),e.ref=t.ref,e.return=t,t.child=e}function YP(e,t,n,r,i){if(e!==null){var o=e.memoizedProps;if(Lh(o,r)&&e.ref===t.ref)if(Gn=!1,t.pendingProps=r=o,(e.lanes&i)!==0)e.flags&131072&&(Gn=!0);else return t.lanes=e.lanes,ls(e,t,i)}return mw(e,t,n,r,i)}function XP(e,t,n){var r=t.pendingProps,i=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},He(ac,dr),dr|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,He(ac,dr),dr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,He(ac,dr),dr|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,He(ac,dr),dr|=r;return Sn(e,t,i,n),t.child}function QP(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function mw(e,t,n,r,i){var o=Qn(n)?ju:mn.current;return o=Dc(t,o),xc(t,i),n=__(e,t,n,r,o,i),r=k_(),e!==null&&!Gn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ls(e,t,i)):(Ze&&r&&d_(t),t.flags|=1,Sn(e,t,n,i),t.child)}function pF(e,t,n,r,i){if(Qn(n)){var o=!0;w0(t)}else o=!1;if(xc(t,i),t.stateNode===null)Pm(e,t),SP(t,n,r),pw(t,n,r,i),r=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var u=s.context,l=n.contextType;typeof l=="object"&&l!==null?l=Ur(l):(l=Qn(n)?ju:mn.current,l=Dc(t,l));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||u!==l)&&oF(t,s,r,l),Ms=!1;var d=t.memoizedState;s.state=d,$0(t,r,s,i),u=t.memoizedState,a!==r||d!==u||Xn.current||Ms?(typeof c=="function"&&(hw(t,n,c,r),u=t.memoizedState),(a=Ms||iF(t,n,a,r,d,u,l))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),s.props=r,s.state=u,s.context=l,r=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,wP(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:oi(t.type,a),s.props=l,f=t.pendingProps,d=s.context,u=n.contextType,typeof u=="object"&&u!==null?u=Ur(u):(u=Qn(n)?ju:mn.current,u=Dc(t,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==f||d!==u)&&oF(t,s,r,u),Ms=!1,d=t.memoizedState,s.state=d,$0(t,r,s,i);var p=t.memoizedState;a!==f||d!==p||Xn.current||Ms?(typeof h=="function"&&(hw(t,n,h,r),p=t.memoizedState),(l=Ms||iF(t,n,l,r,d,p,u)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,u)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=u,r=l):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return yw(e,t,n,r,o,i)}function yw(e,t,n,r,i,o){QP(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return i&&ZT(t,n,!1),ls(e,t,o);r=t.stateNode,aV.current=t;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=Pc(t,e.child,null,o),t.child=Pc(t,null,a,o)):Sn(e,t,a,o),t.memoizedState=r.state,i&&ZT(t,n,!0),t.child}function KP(e){var t=e.stateNode;t.pendingContext?JT(e,t.pendingContext,t.pendingContext!==t.context):t.context&&JT(e,t.context,!1),b_(e,t.containerInfo)}function gF(e,t,n,r,i){return Rc(),p_(i),t.flags|=256,Sn(e,t,n,r),t.child}var vw={dehydrated:null,treeContext:null,retryLane:0};function xw(e){return{baseLanes:e,cachePool:null,transitions:null}}function JP(e,t,n){var r=t.pendingProps,i=rt.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),He(rt,i&1),e===null)return fw(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=r.children,e=r.fallback,o?(r=t.mode,o=t.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Fy(s,r,0,null),e=Tu(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=xw(n),t.memoizedState=vw,e):A_(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return uV(e,t,s,r,a,i,n);if(o){o=r.fallback,s=t.mode,i=e.child,a=i.sibling;var u={mode:"hidden",children:r.children};return!(s&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=sa(i,u),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=sa(a,o):(o=Tu(o,s,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,s=e.child.memoizedState,s=s===null?xw(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~n,t.memoizedState=vw,r}return o=e.child,e=o.sibling,r=sa(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function A_(e,t){return t=Fy({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function zg(e,t,n,r){return r!==null&&p_(r),Pc(t,e.child,null,n),e=A_(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function uV(e,t,n,r,i,o,s){if(n)return t.flags&256?(t.flags&=-257,r=o2(Error(q(422))),zg(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Fy({mode:"visible",children:r.children},i,0,null),o=Tu(o,i,s,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Pc(t,e.child,null,s),t.child.memoizedState=xw(s),t.memoizedState=vw,o);if(!(t.mode&1))return zg(e,t,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(q(419)),r=o2(o,r,void 0),zg(e,t,s,r)}if(a=(s&e.childLanes)!==0,Gn||a){if(r=Dt,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,us(e,i),wi(r,e,i,-1))}return D_(),r=o2(Error(q(421))),zg(e,t,s,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=wV.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,yr=na(i.nextSibling),br=t,Ze=!0,li=null,e!==null&&(Or[Nr++]=Wo,Or[Nr++]=qo,Or[Nr++]=Bu,Wo=e.id,qo=e.overflow,Bu=t),t=A_(t,r.children),t.flags|=4096,t)}function mF(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),dw(e.return,t,n)}function s2(e,t,n,r,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function ZP(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Sn(e,t,r.children,n),r=rt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&mF(e,n,t);else if(e.tag===19)mF(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(He(rt,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&C0(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),s2(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&C0(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}s2(t,!0,n,null,o);break;case"together":s2(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Pm(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ls(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Wu|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(q(153));if(t.child!==null){for(e=t.child,n=sa(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=sa(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function lV(e,t,n){switch(t.tag){case 3:KP(t),Rc();break;case 5:$P(t);break;case 1:Qn(t.type)&&w0(t);break;case 4:b_(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;He(_0,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(He(rt,rt.current&1),t.flags|=128,null):n&t.child.childLanes?JP(e,t,n):(He(rt,rt.current&1),e=ls(e,t,n),e!==null?e.sibling:null);He(rt,rt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return ZP(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),He(rt,rt.current),r)break;return null;case 22:case 23:return t.lanes=0,XP(e,t,n)}return ls(e,t,n)}var e4,bw,t4,n4;e4=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};bw=function(){};t4=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Eu(no.current);var o=null;switch(n){case"input":i=Ub(e,i),r=Ub(e,r),o=[];break;case"select":i=ot({},i,{value:void 0}),r=ot({},r,{value:void 0}),o=[];break;case"textarea":i=Hb(e,i),r=Hb(e,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=x0)}Gb(n,r);var s;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Fh.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var u=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&u!==a&&(u!=null||a!=null))if(l==="style")if(a){for(s in a)!a.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&a[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(o||(o=[]),o.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(o=o||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Fh.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&Ye("scroll",e),o||a===u||(o=[])):(o=o||[]).push(l,u))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}};n4=function(e,t,n,r){n!==r&&(t.flags|=4)};function nd(e,t){if(!Ze)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function en(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function cV(e,t,n){var r=t.pendingProps;switch(h_(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(t),null;case 1:return Qn(t.type)&&b0(),en(t),null;case 3:return r=t.stateNode,Lc(),Ke(Xn),Ke(mn),E_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Pg(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,li!==null&&(Aw(li),li=null))),bw(e,t),en(t),null;case 5:w_(t);var i=Eu(Uh.current);if(n=t.type,e!==null&&t.stateNode!=null)t4(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(q(166));return en(t),null}if(e=Eu(no.current),Pg(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Xi]=t,r[jh]=o,e=(t.mode&1)!==0,n){case"dialog":Ye("cancel",r),Ye("close",r);break;case"iframe":case"object":case"embed":Ye("load",r);break;case"video":case"audio":for(i=0;i<Dd.length;i++)Ye(Dd[i],r);break;case"source":Ye("error",r);break;case"img":case"image":case"link":Ye("error",r),Ye("load",r);break;case"details":Ye("toggle",r);break;case"input":kT(r,o),Ye("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ye("invalid",r);break;case"textarea":CT(r,o),Ye("invalid",r)}Gb(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Rg(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Rg(r.textContent,a,e),i=["children",""+a]):Fh.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Ye("scroll",r)}switch(n){case"input":Cg(r),$T(r,o,!0);break;case"textarea":Cg(r),AT(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=x0)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=T5(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[Xi]=t,e[jh]=r,e4(e,t,!1,!1),t.stateNode=e;e:{switch(s=Yb(n,r),n){case"dialog":Ye("cancel",e),Ye("close",e),i=r;break;case"iframe":case"object":case"embed":Ye("load",e),i=r;break;case"video":case"audio":for(i=0;i<Dd.length;i++)Ye(Dd[i],e);i=r;break;case"source":Ye("error",e),i=r;break;case"img":case"image":case"link":Ye("error",e),Ye("load",e),i=r;break;case"details":Ye("toggle",e),i=r;break;case"input":kT(e,r),i=Ub(e,r),Ye("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=ot({},r,{value:void 0}),Ye("invalid",e);break;case"textarea":CT(e,r),i=Hb(e,r),Ye("invalid",e);break;default:i=r}Gb(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var u=a[o];o==="style"?O5(e,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&F5(e,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Mh(e,u):typeof u=="number"&&Mh(e,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Fh.hasOwnProperty(o)?u!=null&&o==="onScroll"&&Ye("scroll",e):u!=null&&JS(e,o,u,s))}switch(n){case"input":Cg(e),$T(e,r,!1);break;case"textarea":Cg(e),AT(e);break;case"option":r.value!=null&&e.setAttribute("value",""+pa(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?gc(e,!!r.multiple,o,!1):r.defaultValue!=null&&gc(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=x0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return en(t),null;case 6:if(e&&t.stateNode!=null)n4(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(q(166));if(n=Eu(Uh.current),Eu(no.current),Pg(t)){if(r=t.stateNode,n=t.memoizedProps,r[Xi]=t,(o=r.nodeValue!==n)&&(e=br,e!==null))switch(e.tag){case 3:Rg(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Rg(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Xi]=t,t.stateNode=r}return en(t),null;case 13:if(Ke(rt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ze&&yr!==null&&t.mode&1&&!(t.flags&128))xP(),Rc(),t.flags|=98560,o=!1;else if(o=Pg(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(q(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(q(317));o[Xi]=t}else Rc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;en(t),o=!1}else li!==null&&(Aw(li),li=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||rt.current&1?bt===0&&(bt=3):D_())),t.updateQueue!==null&&(t.flags|=4),en(t),null);case 4:return Lc(),bw(e,t),e===null&&zh(t.stateNode.containerInfo),en(t),null;case 10:return y_(t.type._context),en(t),null;case 17:return Qn(t.type)&&b0(),en(t),null;case 19:if(Ke(rt),o=t.memoizedState,o===null)return en(t),null;if(r=(t.flags&128)!==0,s=o.rendering,s===null)if(r)nd(o,!1);else{if(bt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=C0(e),s!==null){for(t.flags|=128,nd(o,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return He(rt,rt.current&1|2),t.child}e=e.sibling}o.tail!==null&&dt()>Ic&&(t.flags|=128,r=!0,nd(o,!1),t.lanes=4194304)}else{if(!r)if(e=C0(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),nd(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Ze)return en(t),null}else 2*dt()-o.renderingStartTime>Ic&&n!==1073741824&&(t.flags|=128,r=!0,nd(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(n=o.last,n!==null?n.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=dt(),t.sibling=null,n=rt.current,He(rt,r?n&1|2:n&1),t):(en(t),null);case 22:case 23:return N_(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?dr&1073741824&&(en(t),t.subtreeFlags&6&&(t.flags|=8192)):en(t),null;case 24:return null;case 25:return null}throw Error(q(156,t.tag))}function fV(e,t){switch(h_(t),t.tag){case 1:return Qn(t.type)&&b0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Lc(),Ke(Xn),Ke(mn),E_(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return w_(t),null;case 13:if(Ke(rt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(q(340));Rc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ke(rt),null;case 4:return Lc(),null;case 10:return y_(t.type._context),null;case 22:case 23:return N_(),null;case 24:return null;default:return null}}var Ig=!1,an=!1,dV=typeof WeakSet=="function"?WeakSet:Set,ee=null;function sc(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ut(e,t,r)}else n.current=null}function ww(e,t,n){try{n()}catch(r){ut(e,t,r)}}var yF=!1;function hV(e,t){if(iw=m0,e=sP(),f_(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,u=-1,l=0,c=0,f=e,d=null;t:for(;;){for(var h;f!==n||i!==0&&f.nodeType!==3||(a=s+i),f!==o||r!==0&&f.nodeType!==3||(u=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===e)break t;if(d===n&&++l===i&&(a=s),d===o&&++c===r&&(u=s),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}n=a===-1||u===-1?null:{start:a,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ow={focusedElem:e,selectionRange:n},m0=!1,ee=t;ee!==null;)if(t=ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ee=e;else for(;ee!==null;){t=ee;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,y=p.memoizedState,m=t.stateNode,v=m.getSnapshotBeforeUpdate(t.elementType===t.type?g:oi(t.type,g),y);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(b){ut(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,ee=e;break}ee=t.return}return p=yF,yF=!1,p}function dh(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&ww(t,n,o)}i=i.next}while(i!==r)}}function Ay(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Ew(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function r4(e){var t=e.alternate;t!==null&&(e.alternate=null,r4(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Xi],delete t[jh],delete t[uw],delete t[XH],delete t[QH])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function i4(e){return e.tag===5||e.tag===3||e.tag===4}function vF(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||i4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Sw(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=x0));else if(r!==4&&(e=e.child,e!==null))for(Sw(e,t,n),e=e.sibling;e!==null;)Sw(e,t,n),e=e.sibling}function _w(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(_w(e,t,n),e=e.sibling;e!==null;)_w(e,t,n),e=e.sibling}var Bt=null,ai=!1;function ks(e,t,n){for(n=n.child;n!==null;)o4(e,t,n),n=n.sibling}function o4(e,t,n){if(to&&typeof to.onCommitFiberUnmount=="function")try{to.onCommitFiberUnmount(by,n)}catch{}switch(n.tag){case 5:an||sc(n,t);case 6:var r=Bt,i=ai;Bt=null,ks(e,t,n),Bt=r,ai=i,Bt!==null&&(ai?(e=Bt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Bt.removeChild(n.stateNode));break;case 18:Bt!==null&&(ai?(e=Bt,n=n.stateNode,e.nodeType===8?Zx(e.parentNode,n):e.nodeType===1&&Zx(e,n),Rh(e)):Zx(Bt,n.stateNode));break;case 4:r=Bt,i=ai,Bt=n.stateNode.containerInfo,ai=!0,ks(e,t,n),Bt=r,ai=i;break;case 0:case 11:case 14:case 15:if(!an&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&ww(n,t,s),i=i.next}while(i!==r)}ks(e,t,n);break;case 1:if(!an&&(sc(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){ut(n,t,a)}ks(e,t,n);break;case 21:ks(e,t,n);break;case 22:n.mode&1?(an=(r=an)||n.memoizedState!==null,ks(e,t,n),an=r):ks(e,t,n);break;default:ks(e,t,n)}}function xF(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new dV),t.forEach(function(r){var i=EV.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ei(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:Bt=a.stateNode,ai=!1;break e;case 3:Bt=a.stateNode.containerInfo,ai=!0;break e;case 4:Bt=a.stateNode.containerInfo,ai=!0;break e}a=a.return}if(Bt===null)throw Error(q(160));o4(o,s,i),Bt=null,ai=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(l){ut(i,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)s4(t,e),t=t.sibling}function s4(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ei(t,e),ji(e),r&4){try{dh(3,e,e.return),Ay(3,e)}catch(g){ut(e,e.return,g)}try{dh(5,e,e.return)}catch(g){ut(e,e.return,g)}}break;case 1:ei(t,e),ji(e),r&512&&n!==null&&sc(n,n.return);break;case 5:if(ei(t,e),ji(e),r&512&&n!==null&&sc(n,n.return),e.flags&32){var i=e.stateNode;try{Mh(i,"")}catch(g){ut(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=n!==null?n.memoizedProps:o,a=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&C5(i,o),Yb(a,s);var l=Yb(a,o);for(s=0;s<u.length;s+=2){var c=u[s],f=u[s+1];c==="style"?O5(i,f):c==="dangerouslySetInnerHTML"?F5(i,f):c==="children"?Mh(i,f):JS(i,c,f,l)}switch(a){case"input":Wb(i,o);break;case"textarea":A5(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?gc(i,!!o.multiple,h,!1):d!==!!o.multiple&&(o.defaultValue!=null?gc(i,!!o.multiple,o.defaultValue,!0):gc(i,!!o.multiple,o.multiple?[]:"",!1))}i[jh]=o}catch(g){ut(e,e.return,g)}}break;case 6:if(ei(t,e),ji(e),r&4){if(e.stateNode===null)throw Error(q(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){ut(e,e.return,g)}}break;case 3:if(ei(t,e),ji(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Rh(t.containerInfo)}catch(g){ut(e,e.return,g)}break;case 4:ei(t,e),ji(e);break;case 13:ei(t,e),ji(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(M_=dt())),r&4&&xF(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(an=(l=an)||c,ei(t,e),an=l):ei(t,e),ji(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!c&&e.mode&1)for(ee=e,c=e.child;c!==null;){for(f=ee=c;ee!==null;){switch(d=ee,h=d.child,d.tag){case 0:case 11:case 14:case 15:dh(4,d,d.return);break;case 1:sc(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,n=d.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){ut(r,n,g)}}break;case 5:sc(d,d.return);break;case 22:if(d.memoizedState!==null){wF(f);continue}}h!==null?(h.return=d,ee=h):wF(f)}c=c.sibling}e:for(c=null,f=e;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,l?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=f.stateNode,u=f.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=M5("display",s))}catch(g){ut(e,e.return,g)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(g){ut(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ei(t,e),ji(e),r&4&&xF(e);break;case 21:break;default:ei(t,e),ji(e)}}function ji(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(i4(n)){var r=n;break e}n=n.return}throw Error(q(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Mh(i,""),r.flags&=-33);var o=vF(e);_w(e,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=vF(e);Sw(e,a,s);break;default:throw Error(q(161))}}catch(u){ut(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function pV(e,t,n){ee=e,a4(e)}function a4(e,t,n){for(var r=(e.mode&1)!==0;ee!==null;){var i=ee,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Ig;if(!s){var a=i.alternate,u=a!==null&&a.memoizedState!==null||an;a=Ig;var l=an;if(Ig=s,(an=u)&&!l)for(ee=i;ee!==null;)s=ee,u=s.child,s.tag===22&&s.memoizedState!==null?EF(i):u!==null?(u.return=s,ee=u):EF(i);for(;o!==null;)ee=o,a4(o),o=o.sibling;ee=i,Ig=a,an=l}bF(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,ee=o):bF(e)}}function bF(e){for(;ee!==null;){var t=ee;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:an||Ay(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!an)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:oi(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&rF(t,o,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}rF(t,s,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Rh(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}an||t.flags&512&&Ew(t)}catch(d){ut(t,t.return,d)}}if(t===e){ee=null;break}if(n=t.sibling,n!==null){n.return=t.return,ee=n;break}ee=t.return}}function wF(e){for(;ee!==null;){var t=ee;if(t===e){ee=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ee=n;break}ee=t.return}}function EF(e){for(;ee!==null;){var t=ee;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ay(4,t)}catch(u){ut(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(u){ut(t,i,u)}}var o=t.return;try{Ew(t)}catch(u){ut(t,o,u)}break;case 5:var s=t.return;try{Ew(t)}catch(u){ut(t,s,u)}}}catch(u){ut(t,t.return,u)}if(t===e){ee=null;break}var a=t.sibling;if(a!==null){a.return=t.return,ee=a;break}ee=t.return}}var gV=Math.ceil,F0=ps.ReactCurrentDispatcher,T_=ps.ReactCurrentOwner,Ir=ps.ReactCurrentBatchConfig,Ce=0,Dt=null,pt=null,Ht=0,dr=0,ac=Na(0),bt=0,Vh=null,Wu=0,Ty=0,F_=0,hh=null,Un=null,M_=0,Ic=1/0,Ro=null,M0=!1,kw=null,ia=null,jg=!1,Us=null,O0=0,ph=0,$w=null,Lm=-1,zm=0;function Fn(){return Ce&6?dt():Lm!==-1?Lm:Lm=dt()}function oa(e){return e.mode&1?Ce&2&&Ht!==0?Ht&-Ht:JH.transition!==null?(zm===0&&(zm=q5()),zm):(e=ze,e!==0||(e=window.event,e=e===void 0?16:K5(e.type)),e):1}function wi(e,t,n,r){if(50<ph)throw ph=0,$w=null,Error(q(185));Ap(e,n,r),(!(Ce&2)||e!==Dt)&&(e===Dt&&(!(Ce&2)&&(Ty|=n),bt===4&&zs(e,Ht)),Kn(e,r),n===1&&Ce===0&&!(t.mode&1)&&(Ic=dt()+500,ky&&Da()))}function Kn(e,t){var n=e.callbackNode;Jq(e,t);var r=g0(e,e===Dt?Ht:0);if(r===0)n!==null&&MT(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&MT(n),t===1)e.tag===0?KH(SF.bind(null,e)):mP(SF.bind(null,e)),GH(function(){!(Ce&6)&&Da()}),n=null;else{switch(H5(r)){case 1:n=r_;break;case 4:n=U5;break;case 16:n=p0;break;case 536870912:n=W5;break;default:n=p0}n=g4(n,u4.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function u4(e,t){if(Lm=-1,zm=0,Ce&6)throw Error(q(327));var n=e.callbackNode;if(bc()&&e.callbackNode!==n)return null;var r=g0(e,e===Dt?Ht:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=N0(e,r);else{t=r;var i=Ce;Ce|=2;var o=c4();(Dt!==e||Ht!==t)&&(Ro=null,Ic=dt()+500,Au(e,t));do try{vV();break}catch(a){l4(e,a)}while(1);m_(),F0.current=o,Ce=i,pt!==null?t=0:(Dt=null,Ht=0,t=bt)}if(t!==0){if(t===2&&(i=Zb(e),i!==0&&(r=i,t=Cw(e,i))),t===1)throw n=Vh,Au(e,0),zs(e,r),Kn(e,dt()),n;if(t===6)zs(e,r);else{if(i=e.current.alternate,!(r&30)&&!mV(i)&&(t=N0(e,r),t===2&&(o=Zb(e),o!==0&&(r=o,t=Cw(e,o))),t===1))throw n=Vh,Au(e,0),zs(e,r),Kn(e,dt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(q(345));case 2:cu(e,Un,Ro);break;case 3:if(zs(e,r),(r&130023424)===r&&(t=M_+500-dt(),10<t)){if(g0(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Fn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=aw(cu.bind(null,e,Un,Ro),t);break}cu(e,Un,Ro);break;case 4:if(zs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-bi(r);o=1<<s,s=t[s],s>i&&(i=s),r&=~o}if(r=i,r=dt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*gV(r/1960))-r,10<r){e.timeoutHandle=aw(cu.bind(null,e,Un,Ro),r);break}cu(e,Un,Ro);break;case 5:cu(e,Un,Ro);break;default:throw Error(q(329))}}}return Kn(e,dt()),e.callbackNode===n?u4.bind(null,e):null}function Cw(e,t){var n=hh;return e.current.memoizedState.isDehydrated&&(Au(e,t).flags|=256),e=N0(e,t),e!==2&&(t=Un,Un=n,t!==null&&Aw(t)),e}function Aw(e){Un===null?Un=e:Un.push.apply(Un,e)}function mV(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!$i(o(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zs(e,t){for(t&=~F_,t&=~Ty,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-bi(t),r=1<<n;e[n]=-1,t&=~r}}function SF(e){if(Ce&6)throw Error(q(327));bc();var t=g0(e,0);if(!(t&1))return Kn(e,dt()),null;var n=N0(e,t);if(e.tag!==0&&n===2){var r=Zb(e);r!==0&&(t=r,n=Cw(e,r))}if(n===1)throw n=Vh,Au(e,0),zs(e,t),Kn(e,dt()),n;if(n===6)throw Error(q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,cu(e,Un,Ro),Kn(e,dt()),null}function O_(e,t){var n=Ce;Ce|=1;try{return e(t)}finally{Ce=n,Ce===0&&(Ic=dt()+500,ky&&Da())}}function qu(e){Us!==null&&Us.tag===0&&!(Ce&6)&&bc();var t=Ce;Ce|=1;var n=Ir.transition,r=ze;try{if(Ir.transition=null,ze=1,e)return e()}finally{ze=r,Ir.transition=n,Ce=t,!(Ce&6)&&Da()}}function N_(){dr=ac.current,Ke(ac)}function Au(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,VH(n)),pt!==null)for(n=pt.return;n!==null;){var r=n;switch(h_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&b0();break;case 3:Lc(),Ke(Xn),Ke(mn),E_();break;case 5:w_(r);break;case 4:Lc();break;case 13:Ke(rt);break;case 19:Ke(rt);break;case 10:y_(r.type._context);break;case 22:case 23:N_()}n=n.return}if(Dt=e,pt=e=sa(e.current,null),Ht=dr=t,bt=0,Vh=null,F_=Ty=Wu=0,Un=hh=null,wu!==null){for(t=0;t<wu.length;t++)if(n=wu[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}wu=null}return e}function l4(e,t){do{var n=pt;try{if(m_(),Dm.current=T0,A0){for(var r=it.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}A0=!1}if(Uu=0,Ct=vt=it=null,fh=!1,Wh=0,T_.current=null,n===null||n.return===null){bt=1,Vh=t,pt=null;break}e:{var o=e,s=n.return,a=n,u=t;if(t=Ht,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=a,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=cF(s);if(h!==null){h.flags&=-257,fF(h,s,a,o,t),h.mode&1&&lF(o,l,t),t=h,u=l;var p=t.updateQueue;if(p===null){var g=new Set;g.add(u),t.updateQueue=g}else p.add(u);break e}else{if(!(t&1)){lF(o,l,t),D_();break e}u=Error(q(426))}}else if(Ze&&a.mode&1){var y=cF(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),fF(y,s,a,o,t),p_(zc(u,a));break e}}o=u=zc(u,a),bt!==4&&(bt=2),hh===null?hh=[o]:hh.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var m=VP(o,u,t);nF(o,m);break e;case 1:a=u;var v=o.type,x=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ia===null||!ia.has(x)))){o.flags|=65536,t&=-t,o.lanes|=t;var b=GP(o,a,t);nF(o,b);break e}}o=o.return}while(o!==null)}d4(n)}catch(w){t=w,pt===n&&n!==null&&(pt=n=n.return);continue}break}while(1)}function c4(){var e=F0.current;return F0.current=T0,e===null?T0:e}function D_(){(bt===0||bt===3||bt===2)&&(bt=4),Dt===null||!(Wu&268435455)&&!(Ty&268435455)||zs(Dt,Ht)}function N0(e,t){var n=Ce;Ce|=2;var r=c4();(Dt!==e||Ht!==t)&&(Ro=null,Au(e,t));do try{yV();break}catch(i){l4(e,i)}while(1);if(m_(),Ce=n,F0.current=r,pt!==null)throw Error(q(261));return Dt=null,Ht=0,bt}function yV(){for(;pt!==null;)f4(pt)}function vV(){for(;pt!==null&&!Wq();)f4(pt)}function f4(e){var t=p4(e.alternate,e,dr);e.memoizedProps=e.pendingProps,t===null?d4(e):pt=t,T_.current=null}function d4(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=fV(n,t),n!==null){n.flags&=32767,pt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{bt=6,pt=null;return}}else if(n=cV(n,t,dr),n!==null){pt=n;return}if(t=t.sibling,t!==null){pt=t;return}pt=t=e}while(t!==null);bt===0&&(bt=5)}function cu(e,t,n){var r=ze,i=Ir.transition;try{Ir.transition=null,ze=1,xV(e,t,n,r)}finally{Ir.transition=i,ze=r}return null}function xV(e,t,n,r){do bc();while(Us!==null);if(Ce&6)throw Error(q(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(q(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(Zq(e,o),e===Dt&&(pt=Dt=null,Ht=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||jg||(jg=!0,g4(p0,function(){return bc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Ir.transition,Ir.transition=null;var s=ze;ze=1;var a=Ce;Ce|=4,T_.current=null,hV(e,n),s4(n,e),IH(ow),m0=!!iw,ow=iw=null,e.current=n,pV(n),qq(),Ce=a,ze=s,Ir.transition=o}else e.current=n;if(jg&&(jg=!1,Us=e,O0=i),o=e.pendingLanes,o===0&&(ia=null),Gq(n.stateNode),Kn(e,dt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(M0)throw M0=!1,e=kw,kw=null,e;return O0&1&&e.tag!==0&&bc(),o=e.pendingLanes,o&1?e===$w?ph++:(ph=0,$w=e):ph=0,Da(),null}function bc(){if(Us!==null){var e=H5(O0),t=Ir.transition,n=ze;try{if(Ir.transition=null,ze=16>e?16:e,Us===null)var r=!1;else{if(e=Us,Us=null,O0=0,Ce&6)throw Error(q(331));var i=Ce;for(Ce|=4,ee=e.current;ee!==null;){var o=ee,s=o.child;if(ee.flags&16){var a=o.deletions;if(a!==null){for(var u=0;u<a.length;u++){var l=a[u];for(ee=l;ee!==null;){var c=ee;switch(c.tag){case 0:case 11:case 15:dh(8,c,o)}var f=c.child;if(f!==null)f.return=c,ee=f;else for(;ee!==null;){c=ee;var d=c.sibling,h=c.return;if(r4(c),c===l){ee=null;break}if(d!==null){d.return=h,ee=d;break}ee=h}}}var p=o.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}ee=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,ee=s;else e:for(;ee!==null;){if(o=ee,o.flags&2048)switch(o.tag){case 0:case 11:case 15:dh(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,ee=m;break e}ee=o.return}}var v=e.current;for(ee=v;ee!==null;){s=ee;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,ee=x;else e:for(s=v;ee!==null;){if(a=ee,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ay(9,a)}}catch(w){ut(a,a.return,w)}if(a===s){ee=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,ee=b;break e}ee=a.return}}if(Ce=i,Da(),to&&typeof to.onPostCommitFiberRoot=="function")try{to.onPostCommitFiberRoot(by,e)}catch{}r=!0}return r}finally{ze=n,Ir.transition=t}}return!1}function _F(e,t,n){t=zc(n,t),t=VP(e,t,1),e=ra(e,t,1),t=Fn(),e!==null&&(Ap(e,1,t),Kn(e,t))}function ut(e,t,n){if(e.tag===3)_F(e,e,n);else for(;t!==null;){if(t.tag===3){_F(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ia===null||!ia.has(r))){e=zc(n,e),e=GP(t,e,1),t=ra(t,e,1),e=Fn(),t!==null&&(Ap(t,1,e),Kn(t,e));break}}t=t.return}}function bV(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Fn(),e.pingedLanes|=e.suspendedLanes&n,Dt===e&&(Ht&n)===n&&(bt===4||bt===3&&(Ht&130023424)===Ht&&500>dt()-M_?Au(e,0):F_|=n),Kn(e,t)}function h4(e,t){t===0&&(e.mode&1?(t=Fg,Fg<<=1,!(Fg&130023424)&&(Fg=4194304)):t=1);var n=Fn();e=us(e,t),e!==null&&(Ap(e,t,n),Kn(e,n))}function wV(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),h4(e,n)}function EV(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(t),h4(e,n)}var p4;p4=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Xn.current)Gn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Gn=!1,lV(e,t,n);Gn=!!(e.flags&131072)}else Gn=!1,Ze&&t.flags&1048576&&yP(t,S0,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Pm(e,t),e=t.pendingProps;var i=Dc(t,mn.current);xc(t,n),i=__(null,t,r,e,i,n);var o=k_();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Qn(r)?(o=!0,w0(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,x_(t),i.updater=$y,t.stateNode=i,i._reactInternals=t,pw(t,r,e,n),t=yw(null,t,r,!0,o,n)):(t.tag=0,Ze&&o&&d_(t),Sn(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Pm(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=_V(r),e=oi(r,e),i){case 0:t=mw(null,t,r,e,n);break e;case 1:t=pF(null,t,r,e,n);break e;case 11:t=dF(null,t,r,e,n);break e;case 14:t=hF(null,t,r,oi(r.type,e),n);break e}throw Error(q(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:oi(r,i),mw(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:oi(r,i),pF(e,t,r,i,n);case 3:e:{if(KP(t),e===null)throw Error(q(387));r=t.pendingProps,o=t.memoizedState,i=o.element,wP(e,t),$0(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=zc(Error(q(423)),t),t=gF(e,t,r,n,i);break e}else if(r!==i){i=zc(Error(q(424)),t),t=gF(e,t,r,n,i);break e}else for(yr=na(t.stateNode.containerInfo.firstChild),br=t,Ze=!0,li=null,n=kP(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Rc(),r===i){t=ls(e,t,n);break e}Sn(e,t,r,n)}t=t.child}return t;case 5:return $P(t),e===null&&fw(t),r=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,sw(r,i)?s=null:o!==null&&sw(r,o)&&(t.flags|=32),QP(e,t),Sn(e,t,s,n),t.child;case 6:return e===null&&fw(t),null;case 13:return JP(e,t,n);case 4:return b_(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Pc(t,null,r,n):Sn(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:oi(r,i),dF(e,t,r,i,n);case 7:return Sn(e,t,t.pendingProps,n),t.child;case 8:return Sn(e,t,t.pendingProps.children,n),t.child;case 12:return Sn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,He(_0,r._currentValue),r._currentValue=s,o!==null)if($i(o.value,s)){if(o.children===i.children&&!Xn.current){t=ls(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=Ko(-1,n&-n),u.tag=2;var l=o.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),dw(o.return,n,t),a.lanes|=n;break}u=u.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(q(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),dw(s,n,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Sn(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,xc(t,n),i=Ur(i),r=r(i),t.flags|=1,Sn(e,t,r,n),t.child;case 14:return r=t.type,i=oi(r,t.pendingProps),i=oi(r.type,i),hF(e,t,r,i,n);case 15:return YP(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:oi(r,i),Pm(e,t),t.tag=1,Qn(r)?(e=!0,w0(t)):e=!1,xc(t,n),SP(t,r,i),pw(t,r,i,n),yw(null,t,r,!0,e,n);case 19:return ZP(e,t,n);case 22:return XP(e,t,n)}throw Error(q(156,t.tag))};function g4(e,t){return B5(e,t)}function SV(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(e,t,n,r){return new SV(e,t,n,r)}function R_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _V(e){if(typeof e=="function")return R_(e)?1:0;if(e!=null){if(e=e.$$typeof,e===e_)return 11;if(e===t_)return 14}return 2}function sa(e,t){var n=e.alternate;return n===null?(n=Dr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Im(e,t,n,r,i,o){var s=2;if(r=e,typeof e=="function")R_(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Kl:return Tu(n.children,i,o,t);case ZS:s=8,i|=8;break;case zb:return e=Dr(12,n,t,i|2),e.elementType=zb,e.lanes=o,e;case Ib:return e=Dr(13,n,t,i),e.elementType=Ib,e.lanes=o,e;case jb:return e=Dr(19,n,t,i),e.elementType=jb,e.lanes=o,e;case _5:return Fy(n,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case E5:s=10;break e;case S5:s=9;break e;case e_:s=11;break e;case t_:s=14;break e;case Fs:s=16,r=null;break e}throw Error(q(130,e==null?e:typeof e,""))}return t=Dr(s,n,t,i),t.elementType=e,t.type=r,t.lanes=o,t}function Tu(e,t,n,r){return e=Dr(7,e,r,t),e.lanes=n,e}function Fy(e,t,n,r){return e=Dr(22,e,r,t),e.elementType=_5,e.lanes=n,e.stateNode={isHidden:!1},e}function a2(e,t,n){return e=Dr(6,e,null,t),e.lanes=n,e}function u2(e,t,n){return t=Dr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function kV(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ux(0),this.expirationTimes=Ux(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ux(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function P_(e,t,n,r,i,o,s,a,u){return e=new kV(e,t,n,a,u),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Dr(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},x_(o),e}function $V(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ql,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function m4(e){if(!e)return ga;e=e._reactInternals;e:{if(ml(e)!==e||e.tag!==1)throw Error(q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Qn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(q(171))}if(e.tag===1){var n=e.type;if(Qn(n))return gP(e,n,t)}return t}function y4(e,t,n,r,i,o,s,a,u){return e=P_(n,r,!0,e,i,o,s,a,u),e.context=m4(null),n=e.current,r=Fn(),i=oa(n),o=Ko(r,i),o.callback=t??null,ra(n,o,i),e.current.lanes=i,Ap(e,i,r),Kn(e,r),e}function My(e,t,n,r){var i=t.current,o=Fn(),s=oa(i);return n=m4(n),t.context===null?t.context=n:t.pendingContext=n,t=Ko(o,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ra(i,t,s),e!==null&&(wi(e,i,s,o),Nm(e,i,s)),s}function D0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function kF(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function L_(e,t){kF(e,t),(e=e.alternate)&&kF(e,t)}function CV(){return null}var v4=typeof reportError=="function"?reportError:function(e){console.error(e)};function z_(e){this._internalRoot=e}Oy.prototype.render=z_.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(q(409));My(e,t,null,null)};Oy.prototype.unmount=z_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;qu(function(){My(null,e,null,null)}),t[as]=null}};function Oy(e){this._internalRoot=e}Oy.prototype.unstable_scheduleHydration=function(e){if(e){var t=Y5();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ls.length&&t!==0&&t<Ls[n].priority;n++);Ls.splice(n,0,e),n===0&&Q5(e)}};function I_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ny(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function $F(){}function AV(e,t,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var l=D0(s);o.call(l)}}var s=y4(t,r,e,0,null,!1,!1,"",$F);return e._reactRootContainer=s,e[as]=s.current,zh(e.nodeType===8?e.parentNode:e),qu(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=D0(u);a.call(l)}}var u=P_(e,0,!1,null,null,!1,!1,"",$F);return e._reactRootContainer=u,e[as]=u.current,zh(e.nodeType===8?e.parentNode:e),qu(function(){My(t,u,n,r)}),u}function Dy(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var u=D0(s);a.call(u)}}My(t,s,e,i)}else s=AV(n,t,e,i,r);return D0(s)}V5=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Nd(t.pendingLanes);n!==0&&(i_(t,n|1),Kn(t,dt()),!(Ce&6)&&(Ic=dt()+500,Da()))}break;case 13:qu(function(){var r=us(e,1);if(r!==null){var i=Fn();wi(r,e,1,i)}}),L_(e,1)}};o_=function(e){if(e.tag===13){var t=us(e,134217728);if(t!==null){var n=Fn();wi(t,e,134217728,n)}L_(e,134217728)}};G5=function(e){if(e.tag===13){var t=oa(e),n=us(e,t);if(n!==null){var r=Fn();wi(n,e,t,r)}L_(e,t)}};Y5=function(){return ze};X5=function(e,t){var n=ze;try{return ze=e,t()}finally{ze=n}};Qb=function(e,t,n){switch(t){case"input":if(Wb(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_y(r);if(!i)throw Error(q(90));$5(r),Wb(r,i)}}}break;case"textarea":A5(e,n);break;case"select":t=n.value,t!=null&&gc(e,!!n.multiple,t,!1)}};R5=O_;P5=qu;var TV={usingClientEntryPoint:!1,Events:[Fp,tc,_y,N5,D5,O_]},rd={findFiberByHostInstance:bu,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},FV={bundleType:rd.bundleType,version:rd.version,rendererPackageName:rd.rendererPackageName,rendererConfig:rd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ps.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=I5(e),e===null?null:e.stateNode},findFiberByHostInstance:rd.findFiberByHostInstance||CV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bg.isDisabled&&Bg.supportsFiber)try{by=Bg.inject(FV),to=Bg}catch{}}Ar.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TV;Ar.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I_(t))throw Error(q(200));return $V(e,t,null,n)};Ar.createRoot=function(e,t){if(!I_(e))throw Error(q(299));var n=!1,r="",i=v4;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=P_(e,1,!1,null,null,n,!1,r,i),e[as]=t.current,zh(e.nodeType===8?e.parentNode:e),new z_(t)};Ar.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(q(188)):(e=Object.keys(e).join(","),Error(q(268,e)));return e=I5(t),e=e===null?null:e.stateNode,e};Ar.flushSync=function(e){return qu(e)};Ar.hydrate=function(e,t,n){if(!Ny(t))throw Error(q(200));return Dy(null,e,t,!0,n)};Ar.hydrateRoot=function(e,t,n){if(!I_(e))throw Error(q(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=v4;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=y4(t,null,e,1,n??null,i,!1,o,s),e[as]=t.current,zh(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Oy(t)};Ar.render=function(e,t,n){if(!Ny(t))throw Error(q(200));return Dy(null,e,t,!1,n)};Ar.unmountComponentAtNode=function(e){if(!Ny(e))throw Error(q(40));return e._reactRootContainer?(qu(function(){Dy(null,null,e,!1,function(){e._reactRootContainer=null,e[as]=null})}),!0):!1};Ar.unstable_batchedUpdates=O_;Ar.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ny(n))throw Error(q(200));if(e==null||e._reactInternals===void 0)throw Error(q(38));return Dy(e,t,n,!1,r)};Ar.version="18.2.0-next-9e3b772b8-20220608";function x4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(x4)}catch(e){console.error(e)}}x4(),y5.exports=Ar;var MV=y5.exports,CF=MV;Pb.createRoot=CF.createRoot,Pb.hydrateRoot=CF.hydrateRoot;function OV({onSubmit:e,initialRepo:t=""}){const[n,r]=pr.useState(t),[i,o]=pr.useState("");return be.jsxs("form",{onSubmit:s=>{s.preventDefault(),e({repo:n,token:i})},children:[be.jsxs("div",{children:[be.jsx("label",{style:{marginRight:10},children:"Repo name:"}),be.jsx("input",{value:n,onChange:s=>r(s.target.value)})]}),be.jsxs("div",{children:[be.jsx("label",{style:{marginRight:10},children:"Access token (optional, let's you make more API requests without limitations):"}),be.jsx("input",{value:i,onChange:s=>o(s.target.value)})]}),be.jsx("button",{type:"submit",children:"Submit"})]})}var b4={exports:{}},NV="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",DV=NV,RV=DV;function w4(){}function E4(){}E4.resetWarningCache=w4;var PV=function(){function e(r,i,o,s,a,u){if(u!==RV){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:E4,resetWarningCache:w4};return n.PropTypes=n,n};b4.exports=PV();var LV=b4.exports;const AF=wf(LV),TF={};function Tw(e,t){e===void 0&&(e=TF),t===void 0&&(t=TF);const n=Object.keys(e),r=Object.keys(t);return e===t||n.length===r.length&&n.every(i=>e[i]===t[i])}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var zV=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),IV=Object.prototype.hasOwnProperty;function Fw(e,t){return IV.call(e,t)}function Mw(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)Fw(e,i)&&r.push(i);return r}function vr(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Ow(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function fu(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function S4(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Nw(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Nw(e[t]))return!0}else if(typeof e=="object"){for(var r=Mw(e),i=r.length,o=0;o<i;o++)if(Nw(e[r[o]]))return!0}}return!1}function FF(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var _4=function(e){zV(t,e);function t(n,r,i,o,s){var a=this.constructor,u=e.call(this,FF(n,{name:r,index:i,operation:o,tree:s}))||this;return u.name=r,u.index=i,u.operation=o,u.tree=s,Object.setPrototypeOf(u,a.prototype),u.message=FF(n,{name:r,index:i,operation:o,tree:s}),u}return t}(Error),at=_4,jV=vr,uc={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=R0(n,this.path);r&&(r=vr(r));var i=Fu(n,{op:"remove",path:this.from}).removed;return Fu(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=R0(n,this.from);return Fu(n,{op:"add",path:this.path,value:vr(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Gh(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},BV={add:function(e,t,n){return Ow(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:uc.move,copy:uc.copy,test:uc.test,_get:uc._get};function R0(e,t){if(t=="")return e;var n={op:"_get",path:t};return Fu(e,n),n.value}function Fu(e,t,n,r,i,o){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):P0(t,0)),t.path===""){var s={newDocument:e};if(t.op==="add")return s.newDocument=t.value,s;if(t.op==="replace")return s.newDocument=t.value,s.removed=e,s;if(t.op==="move"||t.op==="copy")return s.newDocument=R0(e,t.from),t.op==="move"&&(s.removed=e),s;if(t.op==="test"){if(s.test=Gh(e,t.value),s.test===!1)throw new at("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s.newDocument=e,s}else{if(t.op==="remove")return s.removed=e,s.newDocument=null,s;if(t.op==="_get")return t.value=e,s;if(n)throw new at("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return s}}else{r||(e=vr(e));var a=t.path||"",u=a.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=P0;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=S4(h)),i&&(h=="__proto__"||h=="prototype"&&c>0&&u[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!Ow(h))throw new at("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);Ow(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new at("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var s=BV[t.op].call(t,l,h,e);if(s.test===!1)throw new at("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}}else if(c>=f){var s=uc[t.op].call(t,l,h,e);if(s.test===!1)throw new at("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new at("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function Ry(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new at("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=vr(e));for(var o=new Array(t.length),s=0,a=t.length;s<a;s++)o[s]=Fu(e,t[s],n,!0,i,s),e=o[s].newDocument;return o.newDocument=e,o}function UV(e,t,n){var r=Fu(e,t);if(r.test===!1)throw new at("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function P0(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new at("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(uc[e.op]){if(typeof e.path!="string")throw new at("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new at('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new at("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new at("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Nw(e.value))throw new at("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new at("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new at("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var s={op:"_get",path:e.from,value:void 0},a=k4([s],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new at("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new at("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function k4(e,t,n){try{if(!Array.isArray(e))throw new at("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Ry(vr(t),vr(e),n||!0);else{n=n||P0;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof at)return i;throw i}}function Gh(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,o,s;if(n&&r){if(o=e.length,o!=t.length)return!1;for(i=o;i--!==0;)if(!Gh(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var a=Object.keys(e);if(o=a.length,o!==Object.keys(t).length)return!1;for(i=o;i--!==0;)if(!t.hasOwnProperty(a[i]))return!1;for(i=o;i--!==0;)if(s=a[i],!Gh(e[s],t[s]))return!1;return!0}return e!==e&&t!==t}const WV=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:at,_areEquals:Gh,applyOperation:Fu,applyPatch:Ry,applyReducer:UV,deepClone:jV,getValueByPointer:R0,validate:k4,validator:P0},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var j_=new WeakMap,qV=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),HV=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function VV(e){return j_.get(e)}function GV(e,t){return e.observers.get(t)}function YV(e,t){e.observers.delete(t.callback)}function XV(e,t){t.unobserve()}function QV(e,t){var n=[],r,i=VV(e);if(!i)i=new qV(e),j_.set(e,i);else{var o=GV(i,t);r=o&&o.observer}if(r)return r;if(r={},i.value=vr(e),t){r.callback=t,r.next=null;var s=function(){Dw(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(s)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=n,r.object=e,r.unobserve=function(){Dw(r),clearTimeout(r.next),YV(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new HV(t,r)),r}function Dw(e,t){t===void 0&&(t=!1);var n=j_.get(e.object);B_(n.value,e.object,e.patches,"",t),e.patches.length&&Ry(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function B_(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=Mw(t),s=Mw(e),a=!1,u=s.length-1;u>=0;u--){var l=s[u],c=e[l];if(Fw(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?B_(c,f,n,r+"/"+fu(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+fu(l),value:vr(c)}),n.push({op:"replace",path:r+"/"+fu(l),value:vr(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+fu(l),value:vr(c)}),n.push({op:"remove",path:r+"/"+fu(l)}),a=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!a&&o.length==s.length))for(var u=0;u<o.length;u++){var l=o[u];!Fw(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+fu(l),value:vr(t[l])})}}}function KV(e,t,n){n===void 0&&(n=!1);var r=[];return B_(e,t,r,"",n),r}const JV=Object.freeze(Object.defineProperty({__proto__:null,compare:KV,generate:Dw,observe:QV,unobserve:XV},Symbol.toStringTag,{value:"Module"}));Object.assign({},WV,JV,{JsonPatchError:_4,deepClone:vr,escapePathComponent:fu,unescapePathComponent:S4});var ZV=/("(?:[^\\"]|\\.)*")|[:,]/g,eG=function(t,n){var r,i,o;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,o=n.replacer,function s(a,u,l){var c,f,d,h,p,g,y,m,v,x,b,w;if(a&&typeof a.toJSON=="function"&&(a=a.toJSON()),b=JSON.stringify(a,o),b===void 0)return b;if(y=i-u.length-l,b.length<=y&&(v=b.replace(ZV,function(S,E){return E||S+" "}),v.length<=y))return v;if(o!=null&&(a=JSON.parse(b),o=void 0),typeof a=="object"&&a!==null){if(m=u+r,d=[],f=0,Array.isArray(a))for(x="[",c="]",y=a.length;f<y;f++)d.push(s(a[f],m,f===y-1?0:1)||"null");else for(x="{",c="}",g=Object.keys(a),y=g.length;f<y;f++)h=g[f],p=JSON.stringify(h)+": ",w=s(a[h],m,p.length+(f===y-1?0:1)),w!==void 0&&d.push(p+w);if(d.length>0)return[x,r+d.join(`,
`+m),c].join(`
`+u)}return b}(t,"",0)};const l2=wf(eG);function lr(e,t,n){return e.fields=t||[],e.fname=n,e}function ct(e){return e==null?null:e.fname}function dn(e){return e==null?null:e.fields}function $4(e){return e.length===1?tG(e[0]):nG(e)}const tG=e=>function(t){return t[e]},nG=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function z(e){throw Error(e)}function xo(e){const t=[],n=e.length;let r=null,i=0,o="",s,a,u;e=e+"";function l(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(u=e[a],u==="\\")o+=e.substring(s,a++),s=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;s===i&&u==='"'||s===i&&u==="'"?(s=a+1,r=u):u==="."&&!i?a>s?l():s=a+1:u==="["?(a>s&&l(),i=s=a+1):u==="]"&&(i||z("Access path missing open bracket: "+e),i>0&&l(),i=0,s=a+1)}return i&&z("Access path missing closing bracket: "+e),r&&z("Access path missing closing quote: "+e),a>s&&(a++,l()),t}function nr(e,t,n){const r=xo(e);return e=r.length===1?r[0]:e,lr((n&&n.get||$4)(r),[e],t||e)}const Op=nr("id"),yn=lr(e=>e,[],"identity"),Is=lr(()=>0,[],"zero"),kf=lr(()=>1,[],"one"),qr=lr(()=>!0,[],"true"),Cs=lr(()=>!1,[],"false");function rG(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const C4=0,U_=1,W_=2,A4=3,T4=4;function q_(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:rG,r=e||C4;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=U_&&n(t||"error","ERROR",arguments),this},warn(){return r>=W_&&n(t||"warn","WARN",arguments),this},info(){return r>=A4&&n(t||"log","INFO",arguments),this},debug(){return r>=T4&&n(t||"log","DEBUG",arguments),this}}}var I=Array.isArray;function J(e){return e===Object(e)}const MF=e=>e!=="__proto__";function $f(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((r,i)=>{for(const o in i)if(o==="signals")r.signals=iG(r.signals,i.signals);else{const s=o==="legend"?{layout:1}:o==="style"?!0:null;Cf(r,o,i[o],s)}return r},{})}function Cf(e,t,n,r){if(!MF(t))return;let i,o;if(J(n)&&!I(n)){o=J(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?Cf(o,i,n[i]):MF(i)&&(o[i]=n[i])}else e[t]=n}function iG(e,t){if(e==null)return t;const n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function _e(e){return e[e.length-1]}function ln(e){return e==null||e===""?null:+e}const F4=e=>t=>e*Math.exp(t),M4=e=>t=>Math.log(e*t),O4=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),N4=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,L0=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Py(e,t,n,r){const i=n(e[0]),o=n(_e(e)),s=(o-i)*t;return[r(i-s),r(o-s)]}function D4(e,t){return Py(e,t,ln,yn)}function R4(e,t){var n=Math.sign(e[0]);return Py(e,t,M4(n),F4(n))}function P4(e,t,n){return Py(e,t,L0(n),L0(1/n))}function L4(e,t,n){return Py(e,t,O4(n),N4(n))}function Ly(e,t,n,r,i){const o=r(e[0]),s=r(_e(e)),a=t!=null?r(t):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function H_(e,t,n){return Ly(e,t,n,ln,yn)}function V_(e,t,n){const r=Math.sign(e[0]);return Ly(e,t,n,M4(r),F4(r))}function z0(e,t,n,r){return Ly(e,t,n,L0(r),L0(1/r))}function G_(e,t,n,r){return Ly(e,t,n,O4(r),N4(r))}function z4(e){return 1+~~(new Date(e).getMonth()/3)}function I4(e){return 1+~~(new Date(e).getUTCMonth()/3)}function K(e){return e!=null?I(e)?e:[e]:[]}function j4(e,t,n){let r=e[0],i=e[1],o;return i<r&&(o=i,i=r,r=o),o=i-r,o>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-o),r+o]}function pe(e){return typeof e=="function"}const oG="descending";function Y_(e,t,n){n=n||{},t=K(t)||[];const r=[],i=[],o={},s=n.comparator||sG;return K(e).forEach((a,u)=>{a!=null&&(r.push(t[u]===oG?-1:1),i.push(a=pe(a)?a:nr(a,null,n)),(dn(a)||[]).forEach(l=>o[l]=1))}),i.length===0?null:lr(s(i,r),Object.keys(o))}const zy=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),sG=(e,t)=>e.length===1?aG(e[0],t[0]):uG(e,t,e.length),aG=(e,t)=>function(n,r){return zy(e(n),e(r))*t},uG=(e,t,n)=>(t.push(0),function(r,i){let o,s=0,a=-1;for(;s===0&&++a<n;)o=e[a],s=zy(o(r),o(i));return s*t[a]});function vn(e){return pe(e)?e:()=>e}function X_(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function he(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function lo(e,t){let n=0,r,i,o,s;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(o=s=i;n<r;++n)i=e[n],i!=null&&(i<o&&(o=i),i>s&&(s=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(o=s=i;n<r;++n)i=t(e[n]),i!=null&&(i<o&&(o=i),i>s&&(s=i))}return[o,s]}function B4(e,t){const n=e.length;let r=-1,i,o,s,a,u;if(t==null){for(;++r<n;)if(o=e[r],o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=e[r],o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}else{for(;++r<n;)if(o=t(e[r],r,e),o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=t(e[r],r,e),o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}return[a,u]}const lG=Object.prototype.hasOwnProperty;function ae(e,t){return lG.call(e,t)}const Ug={};function Af(e){let t={},n;function r(o){return ae(t,o)&&t[o]!==Ug}const i={size:0,empty:0,object:t,has:r,get(o){return r(o)?t[o]:void 0},set(o,s){return r(o)||(++i.size,t[o]===Ug&&--i.empty),t[o]=s,this},delete(o){return r(o)&&(--i.size,++i.empty,t[o]=Ug),this},clear(){i.size=i.empty=0,i.object=t={}},test(o){return arguments.length?(n=o,i):n},clean(){const o={};let s=0;for(const a in t){const u=t[a];u!==Ug&&(!n||!n(u))&&(o[a]=u,++s)}i.size=s,i.empty=0,i.object=t=o}};return e&&Object.keys(e).forEach(o=>{i.set(o,e[o])}),i}function U4(e,t,n,r,i,o){if(!n&&n!==0)return o;const s=+n;let a=e[0],u=_e(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=s?r:c<=s?i:o}function G(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),he(r,n)}function lc(e,t,n,r){let i=t[0],o=t[t.length-1],s;return i>o&&(s=i,i=o,o=s),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=o:e<o)}function Ra(e){return typeof e=="boolean"}function aa(e){return Object.prototype.toString.call(e)==="[object Date]"}function W4(e){return e&&pe(e[Symbol.iterator])}function je(e){return typeof e=="number"}function q4(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Q(e){return typeof e=="string"}function Q_(e,t,n){e&&(e=t?K(e).map(a=>a.replace(/\\(.)/g,"$1")):K(e));const r=e&&e.length,i=n&&n.get||$4,o=a=>i(t?[a]:xo(a));let s;if(!r)s=function(){return""};else if(r===1){const a=o(e[0]);s=function(u){return""+a(u)}}else{const a=e.map(o);s=function(u){let l=""+a[0](u),c=0;for(;++c<r;)l+="|"+a[c](u);return l}}return lr(s,e,"key")}function H4(e,t){const n=e[0],r=_e(e),i=+t;return i?i===1?r:n+i*(r-n):n}const cG=1e4;function V4(e){e=+e||cG;let t,n,r;const i=()=>{t={},n={},r=0},o=(s,a)=>(++r>e&&(n=t,t={},r=1),t[s]=a);return i(),{clear:i,has:s=>ae(t,s)||ae(n,s),get:s=>ae(t,s)?t[s]:ae(n,s)?o(s,n[s]):void 0,set:(s,a)=>ae(t,s)?t[s]=a:o(s,a)}}function G4(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const s=r||new t.constructor(i+o);let a=0,u=0,l=0;for(;a<i&&u<o;++l)s[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<i;++a,++l)s[l]=t[a];for(;u<o;++u,++l)s[l]=n[u];return s}function Rd(e,t){let n="";for(;--t>=0;)n+=e;return n}function Y4(e,t,n,r){const i=n||" ",o=e+"",s=t-o.length;return s<=0?o:r==="left"?Rd(i,s)+o:r==="center"?Rd(i,~~(s/2))+o+Rd(i,Math.ceil(s/2)):o+Rd(i,s)}function Np(e){return e&&_e(e)-e[0]||0}function V(e){return I(e)?"["+e.map(V)+"]":J(e)||Q(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function K_(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const fG=e=>je(e)||aa(e)?e:Date.parse(e);function J_(e,t){return t=t||fG,e==null||e===""?null:t(e)}function Z_(e){return e==null||e===""?null:e+""}function Ci(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function X4(e,t,n,r){const i=r??"…",o=e+"",s=o.length,a=Math.max(0,t-i.length);return s<=t?o:n==="left"?i+o.slice(s-a):n==="center"?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function Os(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const o=t(e[i]);o&&n(o,i,e)}}else e.forEach(n)}var OF={},c2={},f2=34,id=10,d2=13;function Q4(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function dG(e,t){var n=Q4(e);return function(r,i){return t(n(r),i,e)}}function NF(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function jn(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function hG(e){return e<0?"-"+jn(-e,6):e>9999?"+"+jn(e,6):jn(e,4)}function pG(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":hG(e.getUTCFullYear())+"-"+jn(e.getUTCMonth()+1,2)+"-"+jn(e.getUTCDate(),2)+(i?"T"+jn(t,2)+":"+jn(n,2)+":"+jn(r,2)+"."+jn(i,3)+"Z":r?"T"+jn(t,2)+":"+jn(n,2)+":"+jn(r,2)+"Z":n||t?"T"+jn(t,2)+":"+jn(n,2)+"Z":"")}function gG(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,g=i(f,function(y,m){if(h)return h(y,m-1);p=y,h=d?dG(y,d):Q4(y)});return g.columns=p||[],g}function i(f,d){var h=[],p=f.length,g=0,y=0,m,v=p<=0,x=!1;f.charCodeAt(p-1)===id&&--p,f.charCodeAt(p-1)===d2&&--p;function b(){if(v)return c2;if(x)return x=!1,OF;var S,E=g,_;if(f.charCodeAt(E)===f2){for(;g++<p&&f.charCodeAt(g)!==f2||f.charCodeAt(++g)===f2;);return(S=g)>=p?v=!0:(_=f.charCodeAt(g++))===id?x=!0:_===d2&&(x=!0,f.charCodeAt(g)===id&&++g),f.slice(E+1,S-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(S=g++))===id)x=!0;else if(_===d2)x=!0,f.charCodeAt(g)===id&&++g;else if(_!==n)continue;return f.slice(E,S)}return v=!0,f.slice(E,p)}for(;(m=b())!==c2;){for(var w=[];m!==OF&&m!==c2;)w.push(m),m=b();d&&(w=d(w,y++))==null||h.push(w)}return h}function o(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function s(f,d){return d==null&&(d=NF(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function a(f,d){return d==null&&(d=NF(f)),o(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?pG(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:s,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function mG(e){return e}function yG(e){if(e==null)return mG;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*r+o,f[1]=(n+=a[1])*i+s;l<c;)f[l]=a[l],++l;return f}}function vG(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function xG(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return DF(e,n)})}:DF(e,t)}function DF(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,o=K4(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:o}:r==null?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function K4(e,t){var n=yG(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&vG(f,p)}function o(c){return n(c)}function s(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=s(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=s(c.arcs);break;case"MultiLineString":d=c.arcs.map(s);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function bG(e,t){var n={},r={},i={},o=[],s=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++s],t[s]=l,t[c]=d)}),t.forEach(function(l){var c=a(l),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=r[d]){delete r[p.start];var g=p===h?h:h.concat(p);r[g.start=h.start]=i[g.end=p.end]=g}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var y=p===h?h:p.concat(h);r[y.start=p.start]=i[y.end=h.end]=y}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),o.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||o.push([l])}),o}function wG(e){return K4(e,EG.apply(this,arguments))}function EG(e,t,n){var r,i,o;if(arguments.length>1)r=SG(e,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:bG(e,r)}}function SG(e,t,n){var r=[],i=[],o;function s(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:o})}function a(f){f.forEach(s)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}function Jo(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function _G(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Dp(e){let t,n,r;e.length!==2?(t=Jo,n=(a,u)=>Jo(e(a),u),r=(a,u)=>e(a)-u):(t=e===Jo||e===_G?e:kG,n=e,r=e);function i(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){const f=i(a,u,l,c-1);return f>l&&r(a[f-1],u)>-r(a[f],u)?f-1:f}return{left:i,center:s,right:o}}function kG(){return 0}function J4(e){return e===null?NaN:+e}function*$G(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const Z4=Dp(Jo),I0=Z4.right,CG=Z4.left;Dp(J4).center;const Rp=I0;function AG(e,t){let n=0,r,i=0,o=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i));else{let s=-1;for(let a of e)(a=t(a,++s,e))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i))}if(n>1)return o/(n-1)}function TG(e,t){const n=AG(e,t);return n&&Math.sqrt(n)}class Mn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],s=t+o,a=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);a&&(n[r++]=a),t=s}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,s=0;if(n>0){for(s=t[--n];n>0&&(r=s,i=t[--n],s=r+i,o=i-(s-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=s+i,i==r-s&&(s=r))}return s}}class RF extends Map{constructor(t,n=nL){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(Rw(this,t))}has(t){return super.has(Rw(this,t))}set(t,n){return super.set(eL(this,t),n)}delete(t){return super.delete(tL(this,t))}}class j0 extends Set{constructor(t,n=nL){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(Rw(this,t))}add(t){return super.add(eL(this,t))}delete(t){return super.delete(tL(this,t))}}function Rw({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function eL({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function tL({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function nL(e){return e!==null&&typeof e=="object"?e.valueOf():e}function FG(e,t){return Array.from(t,n=>e[n])}function MG(e=Jo){if(e===Jo)return rL;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function rL(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const OG=Math.sqrt(50),NG=Math.sqrt(10),DG=Math.sqrt(2);function B0(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=OG?10:o>=NG?5:o>=DG?2:1;let a,u,l;return i<0?(l=Math.pow(10,-i)/s,a=Math.round(e*l),u=Math.round(t*l),a/l<e&&++a,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*s,a=Math.round(e/l),u=Math.round(t/l),a*l<e&&++a,u*l>t&&--u),u<a&&.5<=n&&n<2?B0(e,t,n*2):[a,u,l]}function Pw(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,o,s]=r?B0(t,e,n):B0(e,t,n);if(!(o>=i))return[];const a=o-i+1,u=new Array(a);if(r)if(s<0)for(let l=0;l<a;++l)u[l]=(o-l)/-s;else for(let l=0;l<a;++l)u[l]=(o-l)*s;else if(s<0)for(let l=0;l<a;++l)u[l]=(i+l)/-s;else for(let l=0;l<a;++l)u[l]=(i+l)*s;return u}function Lw(e,t,n){return t=+t,e=+e,n=+n,B0(e,t,n)[2]}function ma(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?Lw(t,e,n):Lw(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Mu(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function zw(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function iL(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?rL:MG(i);r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(r,Math.floor(t+(u-l)*f/u+d));iL(e,t,h,p,i)}const o=e[t];let s=n,a=r;for(od(e,n,t),i(e[r],o)>0&&od(e,n,r);s<a;){for(od(e,s,a),++s,--a;i(e[s],o)<0;)++s;for(;i(e[a],o)>0;)--a}i(e[n],o)===0?od(e,n,a):(++a,od(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function od(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Iw(e,t,n){if(e=Float64Array.from($G(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return zw(e);if(t>=1)return Mu(e);var r,i=(r-1)*t,o=Math.floor(i),s=Mu(iL(e,o).subarray(0,o+1)),a=zw(e.subarray(o+1));return s+(a-s)*(i-o)}}function oL(e,t,n=J4){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e),a=+n(e[o+1],o+1,e);return s+(a-s)*(i-o)}}function RG(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function sL(e,t){return Iw(e,.5,t)}function*PG(e){for(const t of e)yield*t}function aL(e){return Array.from(PG(e))}function xr(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function uL(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function LG(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function U0(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function jc(e){return e=U0(Math.abs(e)),e?e[1]:NaN}function zG(e,t){return function(n,r){for(var i=n.length,o=[],s=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),o.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}function IG(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var jG=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Hu(e){if(!(t=jG.exec(e)))throw new Error("invalid format: "+e);var t;return new ek({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Hu.prototype=ek.prototype;function ek(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ek.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function BG(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var lL;function UG(e,t){var n=U0(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(lL=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+U0(e,Math.max(0,t+o-1))[0]}function PF(e,t){var n=U0(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const LF={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:LG,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>PF(e*100,t),r:PF,s:UG,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function zF(e){return e}var IF=Array.prototype.map,jF=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function cL(e){var t=e.grouping===void 0||e.thousands===void 0?zF:zG(IF.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?zF:IG(IF.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=Hu(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,y=f.zero,m=f.width,v=f.comma,x=f.precision,b=f.trim,w=f.type;w==="n"?(v=!0,w="g"):LF[w]||(x===void 0&&(x=12),b=!0,w="g"),(y||d==="0"&&h==="=")&&(y=!0,d="0",h="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",E=g==="$"?r:/[%p]/.test(w)?s:"",_=LF[w],$=/[defgprs%]/.test(w);x=x===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function k(A){var R=S,C=E,F,T,O;if(w==="c")C=_(A)+C,A="";else{A=+A;var D=A<0||1/A<0;if(A=isNaN(A)?u:_(Math.abs(A),x),b&&(A=BG(A)),D&&+A==0&&p!=="+"&&(D=!1),R=(D?p==="("?p:a:p==="-"||p==="("?"":p)+R,C=(w==="s"?jF[8+lL/3]:"")+C+(D&&p==="("?")":""),$){for(F=-1,T=A.length;++F<T;)if(O=A.charCodeAt(F),48>O||O>57){C=(O===46?i+A.slice(F+1):A.slice(F))+C,A=A.slice(0,F);break}}}v&&!y&&(A=t(A,1/0));var M=R.length+A.length+C.length,N=M<m?new Array(m-M+1).join(d):"";switch(v&&y&&(A=t(N+A,N.length?m-C.length:1/0),N=""),h){case"<":A=R+A+C+N;break;case"=":A=R+N+A+C;break;case"^":A=N.slice(0,M=N.length>>1)+R+A+C+N.slice(M);break;default:A=N+R+A+C;break}return o(A)}return k.toString=function(){return f+""},k}function c(f,d){var h=l((f=Hu(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(jc(d)/3)))*3,g=Math.pow(10,-p),y=jF[8+p/3];return function(m){return h(g*m)+y}}return{format:l,formatPrefix:c}}var Wg,Iy,tk;WG({thousands:",",grouping:[3],currency:["$",""]});function WG(e){return Wg=cL(e),Iy=Wg.format,tk=Wg.formatPrefix,Wg}function fL(e){return Math.max(0,-jc(Math.abs(e)))}function dL(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(jc(t)/3)))*3-jc(Math.abs(e)))}function hL(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,jc(t)-jc(e))+1}const h2=new Date,p2=new Date;function _t(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{const s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=(o,s)=>(t(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,a)=>{const u=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return u;let l;do u.push(l=new Date(+o)),t(o,a),e(o);while(l<o&&o<s);return u},i.filter=o=>_t(s=>{if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););}),n&&(i.count=(o,s)=>(h2.setTime(+o),p2.setTime(+s),e(h2),e(p2),Math.floor(n(h2,p2))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?s=>r(s)%o===0:s=>i.count(0,s)%o===0):i)),i}const Bc=_t(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Bc.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?_t(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Bc);Bc.range;const Ho=1e3,Rr=Ho*60,Vo=Rr*60,cs=Vo*24,nk=cs*7,BF=cs*30,g2=cs*365,Go=_t(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ho)},(e,t)=>(t-e)/Ho,e=>e.getUTCSeconds());Go.range;const jy=_t(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ho)},(e,t)=>{e.setTime(+e+t*Rr)},(e,t)=>(t-e)/Rr,e=>e.getMinutes());jy.range;const By=_t(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Rr)},(e,t)=>(t-e)/Rr,e=>e.getUTCMinutes());By.range;const Uy=_t(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ho-e.getMinutes()*Rr)},(e,t)=>{e.setTime(+e+t*Vo)},(e,t)=>(t-e)/Vo,e=>e.getHours());Uy.range;const Wy=_t(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Vo)},(e,t)=>(t-e)/Vo,e=>e.getUTCHours());Wy.range;const Zo=_t(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Rr)/cs,e=>e.getDate()-1);Zo.range;const ua=_t(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/cs,e=>e.getUTCDate()-1);ua.range;const pL=_t(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/cs,e=>Math.floor(e/cs));pL.range;function yl(e){return _t(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Rr)/nk)}const Tf=yl(0),W0=yl(1),qG=yl(2),HG=yl(3),Uc=yl(4),VG=yl(5),GG=yl(6);Tf.range;W0.range;qG.range;HG.range;Uc.range;VG.range;GG.range;function vl(e){return _t(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/nk)}const Ff=vl(0),q0=vl(1),YG=vl(2),XG=vl(3),Wc=vl(4),QG=vl(5),KG=vl(6);Ff.range;q0.range;YG.range;XG.range;Wc.range;QG.range;KG.range;const Yh=_t(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Yh.range;const Xh=_t(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Xh.range;const co=_t(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());co.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:_t(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});co.range;const fo=_t(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());fo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:_t(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});fo.range;function gL(e,t,n,r,i,o){const s=[[Go,1,Ho],[Go,5,5*Ho],[Go,15,15*Ho],[Go,30,30*Ho],[o,1,Rr],[o,5,5*Rr],[o,15,15*Rr],[o,30,30*Rr],[i,1,Vo],[i,3,3*Vo],[i,6,6*Vo],[i,12,12*Vo],[r,1,cs],[r,2,2*cs],[n,1,nk],[t,1,BF],[t,3,3*BF],[e,1,g2]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=Dp(([,,y])=>y).right(s,d);if(h===s.length)return e.every(ma(l/g2,c/g2,f));if(h===0)return Bc.every(Math.max(ma(l,c,f),1));const[p,g]=s[d/s[h-1][2]<s[h][2]/d?h-1:h];return p.every(g)}return[a,u]}const[JG,ZG]=gL(fo,Xh,Ff,pL,Wy,By),[eY,tY]=gL(co,Yh,Tf,Zo,Uy,jy),Vt="year",rr="quarter",hn="month",wt="week",ir="date",un="day",ho="dayofyear",Sr="hours",_r="minutes",Hr="seconds",Ai="milliseconds",rk=[Vt,rr,hn,wt,ir,un,ho,Sr,_r,Hr,Ai],m2=rk.reduce((e,t,n)=>(e[t]=1+n,e),{});function ik(e){const t=K(e).slice(),n={};return t.length||z("Missing time unit."),t.forEach(i=>{ae(m2,i)?n[i]=1:z(`Invalid time unit: ${i}.`)}),(n[wt]||n[un]?1:0)+(n[rr]||n[hn]||n[ir]?1:0)+(n[ho]?1:0)>1&&z(`Incompatible time units: ${e}`),t.sort((i,o)=>m2[i]-m2[o]),t}const nY={[Vt]:"%Y ",[rr]:"Q%q ",[hn]:"%b ",[ir]:"%d ",[wt]:"W%U ",[un]:"%a ",[ho]:"%j ",[Sr]:"%H:00",[_r]:"00:%M",[Hr]:":%S",[Ai]:".%L",[`${Vt}-${hn}`]:"%Y-%m ",[`${Vt}-${hn}-${ir}`]:"%Y-%m-%d ",[`${Sr}-${_r}`]:"%H:%M"};function mL(e,t){const n=he({},nY,t),r=ik(e),i=r.length;let o="",s=0,a,u;for(s=0;s<i;)for(a=r.length;a>s;--a)if(u=r.slice(s,a).join("-"),n[u]!=null){o+=n[u],s=a;break}return o.trim()}const pu=new Date;function ok(e){return pu.setFullYear(e),pu.setMonth(0),pu.setDate(1),pu.setHours(0,0,0,0),pu}function yL(e){return xL(new Date(e))}function vL(e){return jw(new Date(e))}function xL(e){return Zo.count(ok(e.getFullYear())-1,e)}function jw(e){return Tf.count(ok(e.getFullYear())-1,e)}function Bw(e){return ok(e).getDay()}function rY(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(-1,t,n,r,i,o,s);return a.setFullYear(e),a}return new Date(e,t,n,r,i,o,s)}function bL(e){return EL(new Date(e))}function wL(e){return Uw(new Date(e))}function EL(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return ua.count(t-1,e)}function Uw(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Ff.count(t-1,e)}function Ww(e){return pu.setTime(Date.UTC(e,0,1)),pu.getUTCDay()}function iY(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,r,i,o,s));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,r,i,o,s))}function SL(e,t,n,r,i){const o=t||1,s=_e(e),a=(m,v,x)=>(x=x||m,oY(n[x],r[x],m===s&&o,v)),u=new Date,l=Ci(e),c=l[Vt]?a(Vt):vn(2012),f=l[hn]?a(hn):l[rr]?a(rr):Is,d=l[wt]&&l[un]?a(un,1,wt+un):l[wt]?a(wt,1):l[un]?a(un,1):l[ir]?a(ir,1):l[ho]?a(ho,1):kf,h=l[Sr]?a(Sr):Is,p=l[_r]?a(_r):Is,g=l[Hr]?a(Hr):Is,y=l[Ai]?a(Ai):Is;return function(m){u.setTime(+m);const v=c(u);return i(v,f(u),d(u,v),h(u),p(u),g(u),y(u))}}function oY(e,t,n,r){const i=n<=1?e:r?(o,s)=>r+n*Math.floor((e(o,s)-r)/n):(o,s)=>n*Math.floor(e(o,s)/n);return t?(o,s)=>t(i(o,s),s):i}function qc(e,t,n){return t+e*7-(n+6)%7}const sY={[Vt]:e=>e.getFullYear(),[rr]:e=>Math.floor(e.getMonth()/3),[hn]:e=>e.getMonth(),[ir]:e=>e.getDate(),[Sr]:e=>e.getHours(),[_r]:e=>e.getMinutes(),[Hr]:e=>e.getSeconds(),[Ai]:e=>e.getMilliseconds(),[ho]:e=>xL(e),[wt]:e=>jw(e),[wt+un]:(e,t)=>qc(jw(e),e.getDay(),Bw(t)),[un]:(e,t)=>qc(1,e.getDay(),Bw(t))},aY={[rr]:e=>3*e,[wt]:(e,t)=>qc(e,0,Bw(t))};function _L(e,t){return SL(e,t||1,sY,aY,rY)}const uY={[Vt]:e=>e.getUTCFullYear(),[rr]:e=>Math.floor(e.getUTCMonth()/3),[hn]:e=>e.getUTCMonth(),[ir]:e=>e.getUTCDate(),[Sr]:e=>e.getUTCHours(),[_r]:e=>e.getUTCMinutes(),[Hr]:e=>e.getUTCSeconds(),[Ai]:e=>e.getUTCMilliseconds(),[ho]:e=>EL(e),[wt]:e=>Uw(e),[un]:(e,t)=>qc(1,e.getUTCDay(),Ww(t)),[wt+un]:(e,t)=>qc(Uw(e),e.getUTCDay(),Ww(t))},lY={[rr]:e=>3*e,[wt]:(e,t)=>qc(e,0,Ww(t))};function kL(e,t){return SL(e,t||1,uY,lY,iY)}const cY={[Vt]:co,[rr]:Yh.every(3),[hn]:Yh,[wt]:Tf,[ir]:Zo,[un]:Zo,[ho]:Zo,[Sr]:Uy,[_r]:jy,[Hr]:Go,[Ai]:Bc},fY={[Vt]:fo,[rr]:Xh.every(3),[hn]:Xh,[wt]:Ff,[ir]:ua,[un]:ua,[ho]:ua,[Sr]:Wy,[_r]:By,[Hr]:Go,[Ai]:Bc};function Mf(e){return cY[e]}function Of(e){return fY[e]}function $L(e,t,n){return e?e.offset(t,n):void 0}function CL(e,t,n){return $L(Mf(e),t,n)}function AL(e,t,n){return $L(Of(e),t,n)}function TL(e,t,n,r){return e?e.range(t,n,r):void 0}function FL(e,t,n,r){return TL(Mf(e),t,n,r)}function ML(e,t,n,r){return TL(Of(e),t,n,r)}const Pd=1e3,Ld=Pd*60,zd=Ld*60,qy=zd*24,dY=qy*7,UF=qy*30,qw=qy*365,OL=[Vt,hn,ir,Sr,_r,Hr,Ai],Id=OL.slice(0,-1),jd=Id.slice(0,-1),Bd=jd.slice(0,-1),hY=Bd.slice(0,-1),pY=[Vt,wt],WF=[Vt,hn],NL=[Vt],sd=[[Id,1,Pd],[Id,5,5*Pd],[Id,15,15*Pd],[Id,30,30*Pd],[jd,1,Ld],[jd,5,5*Ld],[jd,15,15*Ld],[jd,30,30*Ld],[Bd,1,zd],[Bd,3,3*zd],[Bd,6,6*zd],[Bd,12,12*zd],[hY,1,qy],[pY,1,dY],[WF,1,UF],[WF,3,3*UF],[NL,1,qw]];function DL(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(Np(t))/n;let i=Dp(a=>a[2]).right(sd,r),o,s;return i===sd.length?(o=NL,s=ma(t[0]/qw,t[1]/qw,n)):i?(i=sd[r/sd[i-1][2]<sd[i][2]/r?i-1:i],o=i[0],s=i[1]):(o=OL,s=Math.max(ma(t[0],t[1],n),1)),{units:o,step:s}}function y2(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function v2(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ad(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function RL(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,u=e.shortMonths,l=ud(i),c=ld(i),f=ud(o),d=ld(o),h=ud(s),p=ld(s),g=ud(a),y=ld(a),m=ud(u),v=ld(u),x={a:D,A:M,b:N,B:j,c:null,d:XF,e:XF,f:LY,g:GY,G:XY,H:DY,I:RY,j:PY,L:PL,m:zY,M:IY,p:X,q:te,Q:JF,s:ZF,S:jY,u:BY,U:UY,V:WY,w:qY,W:HY,x:null,X:null,y:VY,Y:YY,Z:QY,"%":KF},b={a:xe,A:de,b:De,B:It,c:null,d:QF,e:QF,f:eX,g:cX,G:dX,H:KY,I:JY,j:ZY,L:zL,m:tX,M:nX,p:Zr,q:Qa,Q:JF,s:ZF,S:rX,u:iX,U:oX,V:sX,w:aX,W:uX,x:null,X:null,y:lX,Y:fX,Z:hX,"%":KF},w={a:k,A,b:R,B:C,c:F,d:GF,e:GF,f:FY,g:VF,G:HF,H:YF,I:YF,j:$Y,L:TY,m:kY,M:CY,p:$,q:_Y,Q:OY,s:NY,S:AY,u:xY,U:bY,V:wY,w:vY,W:EY,x:T,X:O,y:VF,Y:HF,Z:SY,"%":MY};x.x=S(n,x),x.X=S(r,x),x.c=S(t,x),b.x=S(n,b),b.X=S(r,b),b.c=S(t,b);function S(Z,ge){return function(ye){var W=[],jt=-1,Oe=0,Jt=Z.length,xn,Ka,vT;for(ye instanceof Date||(ye=new Date(+ye));++jt<Jt;)Z.charCodeAt(jt)===37&&(W.push(Z.slice(Oe,jt)),(Ka=qF[xn=Z.charAt(++jt)])!=null?xn=Z.charAt(++jt):Ka=xn==="e"?" ":"0",(vT=ge[xn])&&(xn=vT(ye,Ka)),W.push(xn),Oe=jt+1);return W.push(Z.slice(Oe,jt)),W.join("")}}function E(Z,ge){return function(ye){var W=ad(1900,void 0,1),jt=_(W,Z,ye+="",0),Oe,Jt;if(jt!=ye.length)return null;if("Q"in W)return new Date(W.Q);if("s"in W)return new Date(W.s*1e3+("L"in W?W.L:0));if(ge&&!("Z"in W)&&(W.Z=0),"p"in W&&(W.H=W.H%12+W.p*12),W.m===void 0&&(W.m="q"in W?W.q:0),"V"in W){if(W.V<1||W.V>53)return null;"w"in W||(W.w=1),"Z"in W?(Oe=v2(ad(W.y,0,1)),Jt=Oe.getUTCDay(),Oe=Jt>4||Jt===0?q0.ceil(Oe):q0(Oe),Oe=ua.offset(Oe,(W.V-1)*7),W.y=Oe.getUTCFullYear(),W.m=Oe.getUTCMonth(),W.d=Oe.getUTCDate()+(W.w+6)%7):(Oe=y2(ad(W.y,0,1)),Jt=Oe.getDay(),Oe=Jt>4||Jt===0?W0.ceil(Oe):W0(Oe),Oe=Zo.offset(Oe,(W.V-1)*7),W.y=Oe.getFullYear(),W.m=Oe.getMonth(),W.d=Oe.getDate()+(W.w+6)%7)}else("W"in W||"U"in W)&&("w"in W||(W.w="u"in W?W.u%7:"W"in W?1:0),Jt="Z"in W?v2(ad(W.y,0,1)).getUTCDay():y2(ad(W.y,0,1)).getDay(),W.m=0,W.d="W"in W?(W.w+6)%7+W.W*7-(Jt+5)%7:W.w+W.U*7-(Jt+6)%7);return"Z"in W?(W.H+=W.Z/100|0,W.M+=W.Z%100,v2(W)):y2(W)}}function _(Z,ge,ye,W){for(var jt=0,Oe=ge.length,Jt=ye.length,xn,Ka;jt<Oe;){if(W>=Jt)return-1;if(xn=ge.charCodeAt(jt++),xn===37){if(xn=ge.charAt(jt++),Ka=w[xn in qF?ge.charAt(jt++):xn],!Ka||(W=Ka(Z,ye,W))<0)return-1}else if(xn!=ye.charCodeAt(W++))return-1}return W}function $(Z,ge,ye){var W=l.exec(ge.slice(ye));return W?(Z.p=c.get(W[0].toLowerCase()),ye+W[0].length):-1}function k(Z,ge,ye){var W=h.exec(ge.slice(ye));return W?(Z.w=p.get(W[0].toLowerCase()),ye+W[0].length):-1}function A(Z,ge,ye){var W=f.exec(ge.slice(ye));return W?(Z.w=d.get(W[0].toLowerCase()),ye+W[0].length):-1}function R(Z,ge,ye){var W=m.exec(ge.slice(ye));return W?(Z.m=v.get(W[0].toLowerCase()),ye+W[0].length):-1}function C(Z,ge,ye){var W=g.exec(ge.slice(ye));return W?(Z.m=y.get(W[0].toLowerCase()),ye+W[0].length):-1}function F(Z,ge,ye){return _(Z,t,ge,ye)}function T(Z,ge,ye){return _(Z,n,ge,ye)}function O(Z,ge,ye){return _(Z,r,ge,ye)}function D(Z){return s[Z.getDay()]}function M(Z){return o[Z.getDay()]}function N(Z){return u[Z.getMonth()]}function j(Z){return a[Z.getMonth()]}function X(Z){return i[+(Z.getHours()>=12)]}function te(Z){return 1+~~(Z.getMonth()/3)}function xe(Z){return s[Z.getUTCDay()]}function de(Z){return o[Z.getUTCDay()]}function De(Z){return u[Z.getUTCMonth()]}function It(Z){return a[Z.getUTCMonth()]}function Zr(Z){return i[+(Z.getUTCHours()>=12)]}function Qa(Z){return 1+~~(Z.getUTCMonth()/3)}return{format:function(Z){var ge=S(Z+="",x);return ge.toString=function(){return Z},ge},parse:function(Z){var ge=E(Z+="",!1);return ge.toString=function(){return Z},ge},utcFormat:function(Z){var ge=S(Z+="",b);return ge.toString=function(){return Z},ge},utcParse:function(Z){var ge=E(Z+="",!0);return ge.toString=function(){return Z},ge}}}var qF={"-":"",_:" ",0:"0"},zt=/^\s*\d+/,gY=/^%/,mY=/[\\^$*+?|[\]().{}]/g;function Te(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function yY(e){return e.replace(mY,"\\$&")}function ud(e){return new RegExp("^(?:"+e.map(yY).join("|")+")","i")}function ld(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function vY(e,t,n){var r=zt.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function xY(e,t,n){var r=zt.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function bY(e,t,n){var r=zt.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function wY(e,t,n){var r=zt.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function EY(e,t,n){var r=zt.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function HF(e,t,n){var r=zt.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function VF(e,t,n){var r=zt.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function SY(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function _Y(e,t,n){var r=zt.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function kY(e,t,n){var r=zt.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function GF(e,t,n){var r=zt.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function $Y(e,t,n){var r=zt.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function YF(e,t,n){var r=zt.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function CY(e,t,n){var r=zt.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function AY(e,t,n){var r=zt.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function TY(e,t,n){var r=zt.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function FY(e,t,n){var r=zt.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function MY(e,t,n){var r=gY.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function OY(e,t,n){var r=zt.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function NY(e,t,n){var r=zt.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function XF(e,t){return Te(e.getDate(),t,2)}function DY(e,t){return Te(e.getHours(),t,2)}function RY(e,t){return Te(e.getHours()%12||12,t,2)}function PY(e,t){return Te(1+Zo.count(co(e),e),t,3)}function PL(e,t){return Te(e.getMilliseconds(),t,3)}function LY(e,t){return PL(e,t)+"000"}function zY(e,t){return Te(e.getMonth()+1,t,2)}function IY(e,t){return Te(e.getMinutes(),t,2)}function jY(e,t){return Te(e.getSeconds(),t,2)}function BY(e){var t=e.getDay();return t===0?7:t}function UY(e,t){return Te(Tf.count(co(e)-1,e),t,2)}function LL(e){var t=e.getDay();return t>=4||t===0?Uc(e):Uc.ceil(e)}function WY(e,t){return e=LL(e),Te(Uc.count(co(e),e)+(co(e).getDay()===4),t,2)}function qY(e){return e.getDay()}function HY(e,t){return Te(W0.count(co(e)-1,e),t,2)}function VY(e,t){return Te(e.getFullYear()%100,t,2)}function GY(e,t){return e=LL(e),Te(e.getFullYear()%100,t,2)}function YY(e,t){return Te(e.getFullYear()%1e4,t,4)}function XY(e,t){var n=e.getDay();return e=n>=4||n===0?Uc(e):Uc.ceil(e),Te(e.getFullYear()%1e4,t,4)}function QY(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Te(t/60|0,"0",2)+Te(t%60,"0",2)}function QF(e,t){return Te(e.getUTCDate(),t,2)}function KY(e,t){return Te(e.getUTCHours(),t,2)}function JY(e,t){return Te(e.getUTCHours()%12||12,t,2)}function ZY(e,t){return Te(1+ua.count(fo(e),e),t,3)}function zL(e,t){return Te(e.getUTCMilliseconds(),t,3)}function eX(e,t){return zL(e,t)+"000"}function tX(e,t){return Te(e.getUTCMonth()+1,t,2)}function nX(e,t){return Te(e.getUTCMinutes(),t,2)}function rX(e,t){return Te(e.getUTCSeconds(),t,2)}function iX(e){var t=e.getUTCDay();return t===0?7:t}function oX(e,t){return Te(Ff.count(fo(e)-1,e),t,2)}function IL(e){var t=e.getUTCDay();return t>=4||t===0?Wc(e):Wc.ceil(e)}function sX(e,t){return e=IL(e),Te(Wc.count(fo(e),e)+(fo(e).getUTCDay()===4),t,2)}function aX(e){return e.getUTCDay()}function uX(e,t){return Te(q0.count(fo(e)-1,e),t,2)}function lX(e,t){return Te(e.getUTCFullYear()%100,t,2)}function cX(e,t){return e=IL(e),Te(e.getUTCFullYear()%100,t,2)}function fX(e,t){return Te(e.getUTCFullYear()%1e4,t,4)}function dX(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Wc(e):Wc.ceil(e),Te(e.getUTCFullYear()%1e4,t,4)}function hX(){return"+0000"}function KF(){return"%"}function JF(e){return+e}function ZF(e){return Math.floor(+e/1e3)}var Dl,sk,jL,ak,BL;pX({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function pX(e){return Dl=RL(e),sk=Dl.format,jL=Dl.parse,ak=Dl.utcFormat,BL=Dl.utcParse,Dl}function Ud(e){const t={};return n=>t[n]||(t[n]=e(n))}function gX(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=mX(r,i);const s=o<r.length?r.slice(o):"";for(;--o>i;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+s}}function mX(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function UL(e){const t=Ud(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=Hu(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return gX(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,o,s){s=Hu(s??",f");const a=ma(r,i,o),u=Math.max(Math.abs(r),Math.abs(i));let l;if(s.precision==null)switch(s.type){case"s":return isNaN(l=dL(a,u))||(s.precision=l),n(s,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=hL(a,u))||(s.precision=l-(s.type==="e"));break}case"f":case"%":{isNaN(l=fL(a))||(s.precision=l-(s.type==="%")*2);break}}return t(s)}}}let Hw;WL();function WL(){return Hw=UL({format:Iy,formatPrefix:tk})}function qL(e){return UL(cL(e))}function H0(e){return arguments.length?Hw=qL(e):Hw}function eM(e,t,n){n=n||{},J(n)||z(`Invalid time multi-format specifier: ${n}`);const r=t(Hr),i=t(_r),o=t(Sr),s=t(ir),a=t(wt),u=t(hn),l=t(rr),c=t(Vt),f=e(n[Ai]||".%L"),d=e(n[Hr]||":%S"),h=e(n[_r]||"%I:%M"),p=e(n[Sr]||"%I %p"),g=e(n[ir]||n[un]||"%a %d"),y=e(n[wt]||"%b %d"),m=e(n[hn]||"%B"),v=e(n[rr]||"%B"),x=e(n[Vt]||"%Y");return b=>(r(b)<b?f:i(b)<b?d:o(b)<b?h:s(b)<b?p:u(b)<b?a(b)<b?g:y:c(b)<b?l(b)<b?m:v:x)(b)}function HL(e){const t=Ud(e.format),n=Ud(e.utcFormat);return{timeFormat:r=>Q(r)?t(r):eM(t,Mf,r),utcFormat:r=>Q(r)?n(r):eM(n,Of,r),timeParse:Ud(e.parse),utcParse:Ud(e.utcParse)}}let Vw;VL();function VL(){return Vw=HL({format:sk,parse:jL,utcFormat:ak,utcParse:BL})}function GL(e){return HL(RL(e))}function Qh(e){return arguments.length?Vw=GL(e):Vw}const Gw=(e,t)=>he({},e,t);function YL(e,t){const n=e?qL(e):H0(),r=t?GL(t):Qh();return Gw(n,r)}function uk(e,t){const n=arguments.length;return n&&n!==2&&z("defaultLocale expects either zero or two arguments."),n?Gw(H0(e),Qh(t)):Gw(H0(),Qh())}function yX(){return WL(),VL(),uk()}const vX=/^(data:|([A-Za-z]+:)?\/\/)/,xX=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,bX=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,tM="file://";function wX(e,t){return n=>({options:n||{},sanitize:SX,load:EX,fileAccess:!!t,file:_X(t),http:$X(e)})}async function EX(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function SX(e,t){t=he({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,s;const a=xX.test(e.replace(bX,""));(e==null||typeof e!="string"||!a)&&z("Sanitize failure, invalid URI: "+V(e));const u=vX.test(e);return(s=t.baseURL)&&!u&&(!e.startsWith("/")&&!s.endsWith("/")&&(e="/"+e),e=s+e),o=(i=e.startsWith(tM))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(tM.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function _X(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,o)=>{i?r(i):n(o)})}):kX}async function kX(){z("No file system access.")}function $X(e){return e?async function(t,n){const r=he({},this.options.http,n),i=n&&n.response,o=await e(t,r);return o.ok?pe(o[i])?o[i]():o.text():z(o.status+""+o.statusText)}:CX}async function CX(){z("No HTTP fetch method available.")}const AX=e=>e!=null&&e===e,TX=e=>e==="true"||e==="false"||e===!0||e===!1,FX=e=>!Number.isNaN(Date.parse(e)),XL=e=>!Number.isNaN(+e)&&!(e instanceof Date),MX=e=>XL(e)&&Number.isInteger(+e),Yw={boolean:K_,integer:ln,number:ln,date:J_,string:Z_,unknown:yn},qg=[TX,MX,XL,FX],OX=["boolean","integer","number","date"];function QL(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=qg.length,i=qg.map((o,s)=>s+1);for(let o=0,s=0,a,u;o<n;++o)for(u=t?e[o][t]:e[o],a=0;a<r;++a)if(i[a]&&AX(u)&&!qg[a](u)&&(i[a]=0,++s,s===qg.length))return"string";return OX[i.reduce((o,s)=>o===0?s:o,0)-1]}function KL(e,t){return t.reduce((n,r)=>(n[r]=QL(e,r),n),{})}function nM(e){const t=function(n,r){const i={delimiter:e};return lk(n,r?he(r,i):i)};return t.responseType="text",t}function lk(e,t){return t.header&&(e=t.header.map(V).join(t.delimiter)+`
`+e),gG(t.delimiter).parse(e+"")}lk.responseType="text";function NX(e){return typeof Buffer=="function"&&pe(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function ck(e,t){const n=t&&t.property?nr(t.property):yn;return J(e)&&!NX(e)?DX(n(e),t):n(JSON.parse(e))}ck.responseType="json";function DX(e,t){return!I(e)&&W4(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const RX={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function JL(e,t){let n,r,i,o;return e=ck(e,t),t&&t.feature?(n=xG,i=t.feature):t&&t.mesh?(n=wG,i=t.mesh,o=RX[t.filter]):z("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):z("Invalid TopoJSON object: "+i),r&&r.features||[r]}JL.responseType="json";const jm={dsv:lk,csv:nM(","),tsv:nM("	"),json:ck,topojson:JL};function fk(e,t){return arguments.length>1?(jm[e]=t,this):ae(jm,e)?jm[e]:null}function ZL(e){const t=fk(e);return t&&t.responseType||"text"}function e6(e,t,n,r){t=t||{};const i=fk(t.type||"json");return i||z("Unknown data format type: "+t.type),e=i(e,t),t.parse&&PX(e,t.parse,n,r),ae(e,"columns")&&delete e.columns,e}function PX(e,t,n,r){if(!e.length)return;const i=Qh();n=n||i.timeParse,r=r||i.utcParse;let o=e.columns||Object.keys(e[0]),s,a,u,l,c,f;t==="auto"&&(t=KL(e,o)),o=Object.keys(t);const d=o.map(h=>{const p=t[h];let g,y;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),y=g[1],(y[0]==="'"&&y[y.length-1]==="'"||y[0]==='"'&&y[y.length-1]==='"')&&(y=y.slice(1,-1)),(g[0]==="utc"?r:n)(y);if(!Yw[p])throw Error("Illegal format pattern: "+h+":"+p);return Yw[p]});for(u=0,c=e.length,f=o.length;u<c;++u)for(s=e[u],l=0;l<f;++l)a=o[l],s[a]=d[l](s[a])}const Hy=wX(typeof fetch<"u"&&fetch,null);function Vy(e){const t=e||yn,n=[],r={};return n.add=i=>{const o=t(i);return r[o]||(r[o]=1,n.push(i)),n},n.remove=i=>{const o=t(i);if(r[o]){r[o]=0;const s=n.indexOf(i);s>=0&&n.splice(s,1)}return n},n}async function Bm(e,t){try{await t(e)}catch(n){e.error(n)}}const t6=Symbol("vega_id");let LX=1;function Gy(e){return!!(e&&oe(e))}function oe(e){return e[t6]}function n6(e,t){return e[t6]=t,e}function Ne(e){const t=e===Object(e)?e:{data:e};return oe(t)?t:n6(t,LX++)}function dk(e){return Yy(e,Ne({}))}function Yy(e,t){for(const n in e)t[n]=e[n];return t}function r6(e,t){return n6(t,oe(e))}function xl(e,t){return e?t?(n,r)=>e(n,r)||oe(t(n))-oe(t(r)):(n,r)=>e(n,r)||oe(n)-oe(r):null}function i6(e){return e&&e.constructor===bl}function bl(){const e=[],t=[],n=[],r=[],i=[];let o=null,s=!1;return{constructor:bl,insert(a){const u=K(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){const u=pe(a)?r:t,l=K(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){const c={field:u,value:vn(l)};return pe(a)?(c.filter=a,i.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return pe(a)?i.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return o=a,this},reflow(){return s=!0,this},pulse(a,u){const l={},c={};let f,d,h,p,g,y;for(f=0,d=u.length;f<d;++f)l[oe(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[oe(g)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],u.forEach(v=>{p(v)&&(l[oe(v)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],y=oe(g),l[y]?l[y]=1:a.add.push(Ne(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[oe(g)]<0&&a.rem.push(g);function m(v,x,b){b?v[x]=b(v):a.encode=x,s||(c[oe(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,y=l[oe(g)],y>0&&(m(g,p,h.value),a.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,u.forEach(v=>{p(v)&&l[oe(v)]>0&&m(v,h.field,h.value)}),a.modifies(h.field);if(s)a.mod=t.length||r.length?u.filter(v=>l[oe(v)]>0):u.slice();else for(y in c)a.mod.push(c[y]);return(o||o==null&&(t.length||r.length))&&a.clean(!0),a}}}const Um="_:mod:_";function Xy(){Object.defineProperty(this,Um,{writable:!0,value:{}})}Xy.prototype={set(e,t,n,r){const i=this,o=i[e],s=i[Um];return t!=null&&t>=0?(o[t]!==n||r)&&(o[t]=n,s[t+":"+e]=-1,s[e]=-1):(o!==n||r)&&(i[e]=n,s[e]=I(n)?1+n.length:-1),i},modified(e,t){const n=this[Um];if(arguments.length){if(I(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Um]={},this}};let zX=0;const IX="pulse",jX=new Xy,BX=1,UX=2;function We(e,t,n,r){this.id=++zX,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function rM(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}We.prototype={targets(){return this._targets||(this._targets=Vy(Op))},set(e){return this.value!==e?(this.value=e,1):0},skip:rM(BX),modified:rM(UX),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new Xy,i=this._argops=this._argops||[],o=[];let s,a,u,l;const c=(f,d,h)=>{h instanceof We?(h!==this&&(t&&h.targets().add(this),o.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(s in e)if(a=e[s],s===IX)K(a).forEach(f=>{f instanceof We?f!==this&&(f.targets().add(this),o.push(f)):z("Pulse parameters must be operator instances.")}),this.source=a;else if(I(a))for(r.set(s,-1,Array(u=a.length)),l=0;l<u;++l)c(s,l,a[l]);else c(s,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){const t=this._argval||jX,n=this._argops;let r,i,o,s;if(n){const a=n.length;for(i=0;i<a;++i)r=n[i],o=r.op,s=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,s);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function WX(e,t,n,r){let i=1,o;return e instanceof We?o=e:e&&e.prototype instanceof We?o=new e:pe(e)?o=new We(null,e):(i=0,o=new We(e,t)),this.rank(o),i&&(r=n,n=t),n&&this.connect(o,o.parameters(n,r)),this.touch(o),o}function qX(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let HX=0;function Qy(e,t,n){this.id=++HX,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function As(e,t,n){return new Qy(e,t,n)}Qy.prototype={_filter:qr,_apply:yn,targets(){return this._targets||(this._targets=Vy(Op))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=As(e);return this.targets().add(t),t},apply(e){const t=As(null,e);return this.targets().add(t),t},merge(){const e=As();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=As();return this.targets().add(As(null,null,X_(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(As(null,null,()=>n=!0)),t.targets().add(As(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=qr,this._targets=null}};function VX(e,t,n,r){const i=this,o=As(n,r),s=function(l){l.dataflow=i;try{o.receive(l)}catch(c){i.error(c)}finally{i.run()}};let a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=K(e);const u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,s);return o}function GX(e,t){const n=this.locale();return e6(e,t,n.timeParse,n.utcParse)}function YX(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function XX(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:ZL(t&&t.type)});try{i=n.parse(i,t)}catch(o){r=-2,n.warn("Data ingestion failed",e,o)}}catch(o){r=-1,n.warn("Loading failed",e,o)}return{data:i,status:r}}async function QX(e,t,n){const r=this,i=r._pending||KX(r);i.requests+=1;const o=await r.request(t,n);return r.pulse(e,r.changeset().remove(qr).insert(o.data||[])),i.done(),o}function KX(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const JX={skip:!0};function ZX(e,t,n,r,i){return(e instanceof We?tQ:eQ)(this,e,t,n,r,i),this}function eQ(e,t,n,r,i,o){const s=he({},o,JX);let a,u;pe(n)||(n=vn(n)),r===void 0?a=l=>e.touch(n(l)):pe(r)?(u=new We(null,r,i,!1),a=l=>{u.evaluate(l);const c=n(l),f=u.value;i6(f)?e.pulse(c,f,o):e.update(c,f,s)}):a=l=>e.update(n(l),r,s),t.apply(a)}function tQ(e,t,n,r,i,o){if(r===void 0)t.targets().add(n);else{const s=o||{},a=new We(null,nQ(n,r),i,!1);a.modified(s.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function nQ(e,t){return t=pe(t)?t:vn(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function rQ(e){e.rank=++this._rank}function iQ(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&z("Cycle detected in dataflow graph.")}const V0={},Vi=1<<0,Ns=1<<1,Po=1<<2,oQ=Vi|Ns,iM=Vi|Po,Rl=Vi|Ns|Po,oM=1<<3,cd=1<<4,sM=1<<5,aM=1<<6;function la(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function x2(e,t){const n=[];return Os(e,t,r=>n.push(r)),n}function uM(e,t){const n={};return e.visit(t,r=>{n[oe(r)]=1}),r=>n[oe(r)]?null:r}function Hg(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}la.prototype={StopPropagation:V0,ADD:Vi,REM:Ns,MOD:Po,ADD_REM:oQ,ADD_MOD:iM,ALL:Rl,REFLOW:oM,SOURCE:cd,NO_SOURCE:sM,NO_FIELDS:aM,fork(e){return new la(this.dataflow).init(this,e)},clone(){const e=this.fork(Rl);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Rl|cd)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new la(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&aM)&&(n.fields=e.fields),t&Vi?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Ns?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Po?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&sM?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Rl;return t&Vi&&this.add.length||t&Ns&&this.rem.length||t&Po&&this.mod.length},reflow(e){if(e)return this.fork(Rl).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Po,uM(this,Vi))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return I(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?I(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Vi&&(n.addF=Hg(n.addF,t)),e&Ns&&(n.remF=Hg(n.remF,t)),e&Po&&(n.modF=Hg(n.modF,t)),e&cd&&(n.srcF=Hg(n.srcF,t)),n},materialize(e){e=e||Rl;const t=this;return e&Vi&&t.addF&&(t.add=x2(t.add,t.addF),t.addF=null),e&Ns&&t.remF&&(t.rem=x2(t.rem,t.remF),t.remF=null),e&Po&&t.modF&&(t.mod=x2(t.mod,t.modF),t.modF=null),e&cd&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&cd)return Os(n.source,n.srcF,r),n;e&Vi&&Os(n.add,n.addF,r),e&Ns&&Os(n.rem,n.remF,r),e&Po&&Os(n.mod,n.modF,r);const i=n.source;if(e&oM&&i){const o=n.add.length+n.mod.length;o===i.length||(o?Os(i,uM(n,iM),r):Os(i,n.srcF,r))}return n}};function hk(e,t,n,r){const i=this;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const s of n)if(s.stamp===t){if(s.fields){const a=i.fields||(i.fields={});for(const u in s.fields)a[u]=1}s.changed(i.ADD)&&(o|=i.ADD),s.changed(i.REM)&&(o|=i.REM),s.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}G(hk,la,{fork(e){const t=new la(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?I(e)?e.some(r=>n[r]):n[e]:0},filter(){z("MultiPulse does not support filtering.")},materialize(){z("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});async function sQ(e,t,n){const r=this,i=[];if(r._pulse)return o6(r);if(r._pending&&await r._pending,t&&await Bm(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new la(r,o,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=Vy(Op);let s=0,a,u,l;try{for(;r._heap.size()>0;){if(a=r._heap.pop(),a.rank!==a.qrank){r._enqueue(a,!0);continue}u=a.run(r._getPulse(a,e)),u.then?u=await u:u.async&&(i.push(u.async),u=V0),u!==V0&&a._targets&&a._targets.forEach(c=>r._enqueue(c)),++s}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${s} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await Bm(r,c[f].callback)}return n&&await Bm(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function aQ(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function uQ(e,t,n){return this._pulse?o6(this):(this.evaluate(e,t,n),this)}function lQ(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function o6(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function cQ(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function fQ(e,t){const n=e.source,r=this._clock;return n&&I(n)?new hk(this,r,n.map(i=>i.pulse),t):this._input[e.id]||dQ(this._pulse,n&&n.pulse)}function dQ(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==V0&&(e.source=t.source),e)}const pk={skip:!1,force:!1};function hQ(e,t){const n=t||pk;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function pQ(e,t,n){const r=n||pk;return(e.set(t)||r.force)&&this.touch(e,r),this}function gQ(e,t,n){this.touch(e,n||pk);const r=new la(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function mQ(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),s6(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,yQ(t,0,e)):r=n,r}}}function s6(e,t,n,r){let i,o;const s=e[n];for(;n>t;){if(o=n-1>>1,i=e[o],r(s,i)<0){e[n]=i,n=o;continue}break}return e[n]=s}function yQ(e,t,n){const r=t,i=e.length,o=e[t];let s=(t<<1)+1,a;for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],t=s,s=(t<<1)+1;return e[t]=o,s6(e,r,t,n)}function wc(){this.logger(q_()),this.logLevel(U_),this._clock=0,this._rank=0,this._locale=uk();try{this._loader=Hy()}catch{}this._touched=Vy(Op),this._input={},this._pulse=null,this._heap=mQ((e,t)=>e.qrank-t.qrank),this._postrun=[]}function fd(e){return function(){return this._log[e].apply(this,arguments)}}wc.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:fd("error"),warn:fd("warn"),info:fd("info"),debug:fd("debug"),logLevel:fd("level"),cleanThreshold:1e4,add:WX,connect:qX,rank:rQ,rerank:iQ,pulse:gQ,touch:hQ,update:pQ,changeset:bl,ingest:YX,parse:GX,preload:QX,request:XX,events:VX,on:ZX,evaluate:sQ,run:uQ,runAsync:aQ,runAfter:lQ,_enqueue:cQ,_getPulse:fQ};function P(e,t){We.call(this,e,null,t)}G(P,We,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Hc={};function a6(e){const t=u6(e);return t&&t.Definition||null}function u6(e){return e=e&&e.toLowerCase(),ae(Hc,e)?Hc[e]:null}function*l6(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function gk(e,t,n){const r=Float64Array.from(l6(e,n));return r.sort(Jo),t.map(i=>oL(r,i))}function mk(e,t){return gk(e,[.25,.5,.75],t)}function yk(e,t){const n=e.length,r=TG(e,t),i=mk(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function c6(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let o=e.extent[0],s=e.extent[1],a,u,l,c,f,d;const h=e.span||s-o||Math.abs(o)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/a)>t;)a*=n;for(f=0,d=i.length;f<d;++f)c=a/i[f],c>=l&&h/c<=t&&(a=c)}c=Math.log(a);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/a+g)*a,o=o<c?c-a:c,s=Math.ceil(s/a)*a),{start:o,stop:s===o?o+a:s,step:a}}var Vr=Math.random;function vQ(e){Vr=e}function f6(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(l6(e,r)),o=i.length,s=t;let a,u,l,c;for(l=0,c=Array(s);l<s;++l){for(a=0,u=0;u<o;++u)a+=i[~~(Vr()*o)];c[l]=a/o}return c.sort(Jo),[Iw(c,n/2),Iw(c,1-n/2)]}function d6(e,t,n,r){r=r||(d=>d);const i=e.length,o=new Float64Array(i);let s=0,a=1,u=r(e[0]),l=u,c=u+t,f;for(;a<i;++a){if(f=r(e[a]),f>=c){for(l=(u+l)/2;s<a;++s)o[s]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;s<a;++s)o[s]=l;return n?xQ(o,t+t/4):o}function xQ(e,t){const n=e.length;let r=0,i=1,o,s;for(;e[r]===e[i];)++i;for(;i<n;){for(o=i+1;e[i]===e[o];)++o;if(e[i]-e[i-1]<t){for(s=i+(r+o-i-i>>1);s<i;)e[s++]=e[i];for(;s>i;)e[s--]=e[r]}r=i,i=o}return e}function bQ(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function wQ(e,t){t==null&&(t=e,e=0);let n,r,i;const o={min(s){return arguments.length?(n=s||0,i=r-n,o):n},max(s){return arguments.length?(r=s||0,i=r-n,o):r},sample(){return n+Math.floor(i*Vr())},pdf(s){return s===Math.floor(s)&&s>=n&&s<r?1/i:0},cdf(s){const a=Math.floor(s);return a<n?0:a>=r?1:(a-n+1)/i},icdf(s){return s>=0&&s<=1?n-1+Math.floor(s*i):NaN}};return o.min(e).max(t)}const h6=Math.sqrt(2*Math.PI),EQ=Math.SQRT2;let dd=NaN;function Ky(e,t){e=e||0,t=t??1;let n=0,r=0,i,o;if(dd===dd)n=dd,dd=NaN;else{do n=Vr()*2-1,r=Vr()*2-1,i=n*n+r*r;while(i===0||i>1);o=Math.sqrt(-2*Math.log(i)/i),n*=o,dd=r*o}return e+n*t}function vk(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*h6)}function Jy(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let o;if(i>37)o=0;else{const s=Math.exp(-i*i/2);let a;i<7.07106781186547?(a=.0352624965998911*i+.700383064443688,a=a*i+6.37396220353165,a=a*i+33.912866078383,a=a*i+112.079291497871,a=a*i+221.213596169931,a=a*i+220.206867912376,o=s*a,a=.0883883476483184*i+1.75566716318264,a=a*i+16.064177579207,a=a*i+86.7807322029461,a=a*i+296.564248779674,a=a*i+637.333633378831,a=a*i+793.826512519948,a=a*i+440.413735824752,o=o/a):(a=i+.65,a=i+4/a,a=i+3/a,a=i+2/a,a=i+1/a,o=s/a/2.506628274631)}return r>0?1-o:o}function Zy(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*EQ*SQ(2*e-1)}function SQ(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function xk(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>Ky(n,r),pdf:o=>vk(o,n,r),cdf:o=>Jy(o,n,r),icdf:o=>Zy(o,n,r)};return i.mean(e).stdev(t)}function bk(e,t){const n=xk();let r=0;const i={data(o){return arguments.length?(e=o,r=o?o.length:0,i.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=yk(e)),i):t},sample(){return e[~~(Vr()*r)]+t*n.sample()},pdf(o){let s=0,a=0;for(;a<r;++a)s+=n.pdf((o-e[a])/t);return s/t/r},cdf(o){let s=0,a=0;for(;a<r;++a)s+=n.cdf((o-e[a])/t);return s/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function wk(e,t){return e=e||0,t=t??1,Math.exp(e+Ky()*t)}function Ek(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*h6*e)}function Sk(e,t,n){return Jy(Math.log(e),t,n)}function _k(e,t,n){return Math.exp(Zy(e,t,n))}function p6(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>wk(n,r),pdf:o=>Ek(o,n,r),cdf:o=>Sk(o,n,r),icdf:o=>_k(o,n,r)};return i.mean(e).stdev(t)}function g6(e,t){let n=0,r;function i(s){const a=[];let u=0,l;for(l=0;l<n;++l)u+=a[l]=s[l]==null?1:+s[l];for(l=0;l<n;++l)a[l]/=u;return a}const o={weights(s){return arguments.length?(r=i(t=s||[]),o):t},distributions(s){return arguments.length?(s?(n=s.length,e=s):(n=0,e=[]),o.weights(t)):e},sample(){const s=Vr();let a=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(s<u){a=e[l];break}return a.sample()},pdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].pdf(s);return a},cdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].cdf(s);return a},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function kk(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Vr()}function $k(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function Ck(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Ak(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function m6(e,t){let n,r;const i={min(o){return arguments.length?(n=o||0,i):n},max(o){return arguments.length?(r=o??1,i):r},sample:()=>kk(n,r),pdf:o=>$k(o,n,r),cdf:o=>Ck(o,n,r),icdf:o=>Ak(o,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function Tk(e,t,n){let r=0,i=0;for(const o of e){const s=n(o);t(o)==null||s==null||isNaN(s)||(r+=(s-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function Pp(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function ev(e,t,n,r){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,o=new Float64Array(i),s=new Float64Array(i);let a=0,u=0,l=0,c,f,d;for(d of e)o[a]=c=+t(d),s[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<i;++a)o[a]-=u,s[a]-=l;return[o,s,u,l]}function Lp(e,t,n,r){let i=-1,o,s;for(const a of e)o=t(a),s=n(a),o!=null&&(o=+o)>=o&&s!=null&&(s=+s)>=s&&r(o,s,++i)}function Nf(e,t,n,r,i){let o=0,s=0;return Lp(e,t,n,(a,u)=>{const l=u-i(a),c=u-r;o+=l*l,s+=c*c}),1-o/s}function Fk(e,t,n){let r=0,i=0,o=0,s=0,a=0;Lp(e,t,n,(c,f)=>{++a,r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const u=Pp(r,i,o,s),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Nf(e,t,n,i,l)}}function y6(e,t,n){let r=0,i=0,o=0,s=0,a=0;Lp(e,t,n,(c,f)=>{++a,c=Math.log(c),r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const u=Pp(r,i,o,s),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Nf(e,t,n,i,l)}}function v6(e,t,n){const[r,i,o,s]=ev(e,t,n);let a=0,u=0,l=0,c=0,f=0,d,h,p;Lp(e,t,n,(v,x)=>{d=r[f++],h=Math.log(x),p=d*x,a+=(x*h-a)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,y]=Pp(u/s,a/s,l/s,c/s),m=v=>Math.exp(g+y*(v-o));return{coef:[Math.exp(g-y*o),y],predict:m,rSquared:Nf(e,t,n,s,m)}}function x6(e,t,n){let r=0,i=0,o=0,s=0,a=0,u=0;Lp(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,r+=(h-r)/u,i+=(p-i)/u,o+=(h*p-o)/u,s+=(h*h-s)/u,a+=(d-a)/u});const l=Pp(r,i,o,s),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Nf(e,t,n,a,c)}}function Mk(e,t,n){const[r,i,o,s]=ev(e,t,n),a=r.length;let u=0,l=0,c=0,f=0,d=0,h,p,g,y;for(h=0;h<a;)p=r[h],g=i[h++],y=p*p,u+=(y-u)/h,l+=(y*p-l)/h,c+=(y*y-c)/h,f+=(p*g-f)/h,d+=(y*g-d)/h;const m=c-u*u,v=u*m-l*l,x=(d*u-f*l)/v,b=(f*m-d*l)/v,w=-x*u,S=E=>(E=E-o,x*E*E+b*E+w+s);return{coef:[w-b*o+x*o*o+s,b-2*x*o,x],predict:S,rSquared:Nf(e,t,n,s,S)}}function b6(e,t,n,r){if(r===0)return Tk(e,t,n);if(r===1)return Fk(e,t,n);if(r===2)return Mk(e,t,n);const[i,o,s,a]=ev(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,g,y;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d)*o[p];for(l.push(g),y=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d+h);y[h]=g}c.push(y)}c.push(l);const m=kQ(c),v=x=>{x-=s;let b=a+m[0]+m[1]*x+m[2]*x*x;for(d=3;d<f;++d)b+=m[d]*Math.pow(x,d);return b};return{coef:_Q(f,m,-s,a),predict:v,rSquared:Nf(e,t,n,a,v)}}function _Q(e,t,n,r){const i=Array(e);let o,s,a,u;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(a=t[o],u=1,i[o]+=a,s=1;s<=o;++s)u*=(o+1-s)/s,i[o-s]+=a*Math.pow(n,s)*u;return i[0]+=r,i}function kQ(e){const t=e.length-1,n=[];let r,i,o,s,a;for(r=0;r<t;++r){for(s=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][s])&&(s=i);for(o=r;o<t+1;++o)a=e[o][r],e[o][r]=e[o][s],e[o][s]=a;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(a=0,o=i+1;o<t;++o)a+=e[o][i]*n[o];n[i]=(e[t][i]-a)/e[i][i]}return n}const lM=2,cM=1e-12;function w6(e,t,n,r){const[i,o,s,a]=ev(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=lM;){const p=[0,l-1];for(let y=0;y<u;++y){const m=i[y],v=p[0],x=p[1],b=m-i[v]>i[x]-m?v:x;let w=0,S=0,E=0,_=0,$=0;const k=1/Math.abs(i[b]-m||1);for(let C=v;C<=x;++C){const F=i[C],T=o[C],O=$Q(Math.abs(m-F)*k)*d[C],D=F*O;w+=O,S+=D,E+=T*O,_+=T*D,$+=F*D}const[A,R]=Pp(S/w,E/w,_/w,$/w);c[y]=A+R*m,f[y]=Math.abs(o[y]-c[y]),CQ(i,y+1,p)}if(h===lM)break;const g=sL(f);if(Math.abs(g)<cM)break;for(let y=0,m,v;y<u;++y)m=f[y]/(6*g),d[y]=m>=1?cM:(v=1-m*m)*v}return AQ(i,c,s,a)}function $Q(e){return(e=1-e*e*e)*e*e}function CQ(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}function AQ(e,t,n,r){const i=e.length,o=[];let s=0,a=0,u=[],l;for(;s<i;++s)l=e[s]+n,u[0]===l?u[1]+=(t[s]-u[1])/++a:(a=0,u[1]+=r,u=[l,t[s]],o.push(u));return u[1]+=r,o}const TQ=.5*Math.PI/180;function tv(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=g=>[g,e(g)],o=t[0],s=t[1],a=s-o,u=a/r,l=[i(o)],c=[];if(n===r){for(let g=1;g<r;++g)l.push(i(o+g/n*a));return l.push(i(s)),l}else{c.push(i(s));for(let g=n;--g>0;)c.push(i(o+g/n*a))}let f=l[0],d=c[c.length-1];const h=1/a,p=FQ(f[1],c);for(;d;){const g=i((f[0]+d[0])/2);g[0]-f[0]>=u&&MQ(f,g,d,h,p)>TQ?c.push(g):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function FQ(e,t){let n=e,r=e;const i=t.length;for(let o=0;o<i;++o){const s=t[o][1];s<n&&(n=s),s>r&&(r=s)}return 1/(r-n)}function MQ(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),s=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-s)}function OQ(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function Xw(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:OQ(e)}function E6(e,t,n){return n||e+(t?"_"+t:"")}const b2=()=>{},NQ={init:b2,add:b2,rem:b2,idx:0},Kh={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},zp=Object.keys(Kh).filter(e=>e!=="__count__");function DQ(e,t){return n=>he({name:e,out:n||e},NQ,t)}[...zp,"__count__"].forEach(e=>{Kh[e]=DQ(e,Kh[e])});function S6(e,t){return Kh[e](t)}function _6(e,t){return e.idx-t.idx}function RQ(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{r.req&&r.req.forEach(i=>{t[i]||n(t[i]=Kh[i]())})};return e.forEach(n),Object.values(t).sort(_6)}function PQ(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function LQ(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function zQ(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function IQ(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function k6(e,t){const n=t||yn,r=RQ(e),i=e.slice().sort(_6);function o(s){this._ops=r,this._out=i,this.cell=s,this.init()}return o.prototype.init=PQ,o.prototype.add=LQ,o.prototype.rem=zQ,o.prototype.set=IQ,o.prototype.get=n,o.fields=e.map(s=>s.out),o}function Ok(e){this._key=e?nr(e):oe,this.reset()}const Kt=Ok.prototype;Kt.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Kt.add=function(e){this._add.push(e)};Kt.rem=function(e){this._rem.push(e)};Kt.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),s={};let a,u,l;for(a=0;a<i;++a)s[n(t[a])]=1;for(a=0,u=0;a<r;++a)s[n(l=e[a])]?s[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o};Kt.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,o;for(;--r>=0;)o=e(t[r])+"",ae(n,o)||(n[o]=1,++i);return i};Kt.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=B4(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Kt.argmin=function(e){return this.extent(e)[0]||{}};Kt.argmax=function(e){return this.extent(e)[1]||{}};Kt.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Kt.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Kt.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=mk(this.values(),e),this._get=e),this._q};Kt.q1=function(e){return this.quartile(e)[0]};Kt.q2=function(e){return this.quartile(e)[1]};Kt.q3=function(e){return this.quartile(e)[2]};Kt.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=f6(this.values(),1e3,.05,e),this._get=e),this._ci};Kt.ci0=function(e){return this.ci(e)[0]};Kt.ci1=function(e){return this.ci(e)[1]};function ya(e){P.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}ya.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:zp},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};G(ya,P,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):Object.create(null),t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function o(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}o(e._prev),o(t);function s(a,u,l){const c=n[l],f=r[l++];for(const d in f){const h=a?a+"|"+d:d;u[c]=f[d],l<i?s(h,u,l):t[h]||e.cell(h,u)}}s("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(y){const m=K(dn(y)),v=m.length;let x=0,b;for(;x<v;++x)r[b=m[x]]||(r[b]=1,t.push(b))}this._dims=K(e.groupby),this._dnames=this._dims.map(y=>{const m=ct(y);return i(y),n.push(m),m}),this.cellkey=e.key?e.key:Xw(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],s=e.ops||["count"],a=e.as||[],u=o.length,l={};let c,f,d,h,p,g;for(u!==s.length&&z("Unmatched number of fields and aggregate ops."),g=0;g<u;++g){if(c=o[g],f=s[g],c==null&&f!=="count"&&z("Null aggregate field specified."),h=ct(c),p=E6(f,h,a[g]),n.push(p),f==="count"){this._counts.push(p);continue}d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(S6(f,p))}return this._measures=this._measures.map(y=>k6(y,y.field)),Object.create(null)},cellkey:Xw(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let o=0;o<i;++o)n.agg[o]=new r[o](n)}return n.store&&(n.data=new Ok),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let s=0;s<i;++s)o[n[s]]=r[s](e);return t?r6(t.tuple,o):Ne(o)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,o=r.length;i<o;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,s=e.rem,a=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&s.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?s:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const jQ=1e-14;function Nk(e){P.call(this,null,e)}Nk.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};G(Nk,P,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,o=r.step,s=e.as||["bin0","bin1"],a=s[0],u=s[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(dn(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[a]=f,c[u]=f==null?null:i+o*(1+(f-i)/o)}:c=>c[a]=r(c)),t.modifies(n?s:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=c6(e),r=n.step;let i=n.start,o=i+Math.ceil((n.stop-i)/r)*r,s,a;(s=e.anchor)!=null&&(a=s-(i+r*Math.floor((s-i)/r)),i+=a,o+=a);const u=function(l){let c=ln(t(l));return c==null?null:c<i?-1/0:c>o?1/0:(c=Math.max(i,Math.min(c,o-r)),i+r*Math.floor(jQ+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=lr(u,dn(t),e.name||"bin_"+ct(t))}});function $6(e,t,n){const r=e;let i=t||[],o=n||[],s={},a=0;return{add:u=>o.push(u),remove:u=>s[r(u)]=++a,size:()=>i.length,data:(u,l)=>(a&&(i=i.filter(c=>!s[r(c)]),s={},a=0),l&&u&&i.sort(u),o.length&&(i=u?G4(u,i,o.sort(u)):i.concat(o),o=[]),i)}}function Dk(e){P.call(this,[],e)}Dk.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};G(Dk,P,{transform(e,t){const n=t.fork(t.ALL),r=$6(oe,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(xl(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function C6(e){We.call(this,null,BQ,e)}G(C6,We);function BQ(e){return this.value&&!e.modified()?this.value:Y_(e.fields,e.orders)}function Rk(e){P.call(this,null,e)}Rk.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function UQ(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}G(Rk,P,{transform(e,t){const n=f=>d=>{for(var h=UQ(a(d),e.case,o)||[],p,g=0,y=h.length;g<y;++g)s.test(p=h[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,s=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],s=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,l;for(a in n)u=r[a],l=n[a]||0,!u&&l?(r[a]=u=Ne({}),u[i]=a,u[o]=l,s.add.push(u)):l===0?(u&&s.rem.push(u),n[a]=null,r[a]=null):u[o]!==l&&(u[o]=l,s.mod.push(u));return s.modifies(t)}});function Pk(e){P.call(this,null,e)}Pk.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};G(Pk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],s=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return s?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=WQ(a,i,o,e.filter||qr)):n.mod=a,n.source=this.value,n.modifies(r)}});function WQ(e,t,n,r){for(var i=[],o={},s=e.length,a=0,u,l;a<s;++a)for(o[t]=l=e[a],u=0;u<s;++u)o[n]=e[u],r(o)&&(i.push(Ne(o)),o={},o[t]=l);return i}const fM={kde:bk,mixture:g6,normal:xk,lognormal:p6,uniform:m6},qQ="distributions",dM="function",HQ="field";function A6(e,t){const n=e[dM];ae(fM,n)||z("Unknown distribution function: "+n);const r=fM[n]();for(const i in e)i===HQ?r.data((e.from||t()).map(e[i])):i===qQ?r[i](e[i].map(o=>A6(o,t))):typeof r[i]===dM&&r[i](e[i]);return r}function Lk(e){P.call(this,null,e)}const T6=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],VQ={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:T6},{name:"weights",type:"number",array:!0}]};Lk.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:T6.concat(VQ)},{name:"as",type:"string",array:!0,default:["value","density"]}]};G(Lk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=A6(e.distribution,GQ(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let s=e.method||"pdf";s!=="pdf"&&s!=="cdf"&&z("Invalid density method: "+s),!e.extent&&!r.data&&z("Missing density extent parameter."),s=r[s];const a=e.as||["value","density"],u=e.extent||lo(r.data()),l=tv(s,u,i,o).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],Ne(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function GQ(e){return()=>e.materialize(e.SOURCE).source}function F6(e,t){return e?e.map((n,r)=>t[r]||ct(n)):null}function zk(e,t,n){const r=[],i=f=>f(u);let o,s,a,u,l,c;if(t==null)r.push(e.map(n));else for(o={},s=0,a=e.length;s<a;++s)u=e[s],l=t.map(i),c=o[l],c||(o[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}const M6="bin";function Ik(e){P.call(this,null,e)}Ik.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:M6}]};const YQ=(e,t)=>Np(lo(e,t))/30;G(Ik,P,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=zk(t.source,e.groupby,yn),i=e.smooth||!1,o=e.field,s=e.step||YQ(n,o),a=xl((p,g)=>o(p)-o(g)),u=e.as||M6,l=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const p=r[d].sort(a);h=-1;for(const g of d6(p,s,i,o))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:s},t.reflow(!0).modifies(u)}});function O6(e){We.call(this,null,XQ,e),this.modified(!0)}G(O6,We);function XQ(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:lr(n=>t(n,e),dn(t),ct(t))}function jk(e){P.call(this,[void 0,void 0],e)}jk.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};G(jk,P,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],s=n[1];if((i||o==null)&&(o=1/0,s=-1/0),t.visit(i?t.SOURCE:t.ADD,a=>{const u=ln(r(a));u!=null&&(u<o&&(o=u),u>s&&(s=u))}),!Number.isFinite(o)||!Number.isFinite(s)){let a=ct(r);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}});function Bk(e,t){We.call(this,e),this.parent=t,this.count=0}G(Bk,We,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function nv(e){P.call(this,{},e),this._keys=Af();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}G(nv,P,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let o=ae(i,e)&&i[e],s,a;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(a=r||(a=this._group[e])&&a.tuple,s=n.dataflow,o=new Bk(n.fork(n.NO_SOURCE),this),s.add(o).connect(t(s,e,a)),i[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,s=e.modified("key"),a=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=oe(u),c=o.get(l);c!==void 0&&(o.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);o.set(oe(u),l),a(l).add(u)}),s||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=oe(u),c=o.get(l),f=r(u);c===f?a(f).mod(u):(o.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(o.get(oe(u))).mod(u)}),s&&t.visit(t.REFLOW,u=>{const l=oe(u),c=o.get(l),f=r(u);c!==f&&(o.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function N6(e){We.call(this,null,QQ,e)}G(N6,We);function QQ(e){return this.value&&!e.modified()?this.value:I(e.name)?K(e.name).map(t=>nr(t)):nr(e.name,e.as)}function Uk(e){P.call(this,Af(),e)}Uk.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};G(Uk,P,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,s=i.rem,a=i.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=oe(f);r.has(d)?r.delete(d):s.push(f)}),t.visit(t.ADD,f=>{u(f,e)?o.push(f):r.set(oe(f),1)});function c(f){const d=oe(f),h=u(f,e),p=r.get(d);h&&p?(r.delete(d),o.push(f)):!h&&!p?(r.set(d,1),s.push(f)):l&&h&&!p&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function Wk(e){P.call(this,[],e)}Wk.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};G(Wk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=F6(r,e.as||[]),o=e.index||null,s=i.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=r.map(p=>p(a)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=dk(a),f=0;f<s;++f)d[i[f]]=(h=u[f][c])==null?null:h;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}});function qk(e){P.call(this,[],e)}qk.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};G(qk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(ct),o=e.as||["key","value"],s=o[0],a=o[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=dk(l),f[s]=i[c],f[a]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});function Hk(e){P.call(this,null,e)}Hk.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};G(Hk,P,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,s=>s[r]=n(s,e))}});function D6(e){P.call(this,[],e)}G(D6,P,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,o=e.size-i.length,s,a,u;if(o>0){for(s=[];--o>=0;)s.push(u=Ne(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(s):s}else a=i.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,i=i.slice(-o);return n.source=this.value=i,n}});const Vg={value:"value",median:sL,mean:RG,min:zw,max:Mu},KQ=[];function Vk(e){P.call(this,[],e)}Vk.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function JQ(e){var t=e.method||Vg.value,n;if(Vg[t]==null)z("Unrecognized imputation method: "+t);else return t===Vg.value?(n=e.value!==void 0?e.value:0,()=>n):Vg[t]}function ZQ(e){const t=e.field;return n=>n?t(n):NaN}G(Vk,P,{transform(e,t){var n=t.fork(t.ALL),r=JQ(e),i=ZQ(e),o=ct(e.field),s=ct(e.key),a=(e.groupby||[]).map(ct),u=eK(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,g,y,m,v,x,b,w;for(y=0,x=u.length;y<x;++y)for(d=u[y],p=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(g=u.domain[v],w={_impute:!0},m=0,b=p.length;m<b;++m)w[a[m]]=p[m];w[s]=g,w[o]=Number.isNaN(h)?h=r(d,i):h,l.push(Ne(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function eK(e,t,n,r){var i=m=>m(y),o=[],s=r?r.slice():[],a={},u={},l,c,f,d,h,p,g,y;for(s.forEach((m,v)=>a[m]=v+1),d=0,g=e.length;d<g;++d)y=e[d],p=n(y),h=a[p]||(a[p]=s.push(p)),c=(l=t?t.map(i):KQ)+"",(f=u[c])||(f=u[c]=[],o.push(f),f.values=l),f[h-1]=y;return o.domain=s,o}function Gk(e){ya.call(this,e)}Gk.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:zp},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};G(Gk,ya,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(i=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{he(o,i[n.cellkey(o)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function Yk(e){P.call(this,null,e)}Yk.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};G(Yk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=zk(r,e.groupby,e.field),o=(e.groupby||[]).map(ct),s=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&z("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=lo(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=bk(h,s)[a],g=e.counts?h.length:1,y=c||lo(h);tv(p,y,f,d).forEach(m=>{const v={};for(let x=0;x<o.length;++x)v[o[x]]=h.dims[x];v[u[0]]=m[0],v[u[1]]=m[1]*g,l.push(Ne(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function R6(e){We.call(this,null,tK,e)}G(R6,We);function tK(e){return this.value&&!e.modified()?this.value:Q_(e.fields,e.flat)}function P6(e){P.call(this,[],e),this._pending=null}G(P6,P,{transform(e,t){const n=t.dataflow;return this._pending?w2(this,t,this._pending):nK(e)?t.StopPropagation:e.values?w2(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=K(i.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(r=>w2(this,t,K(r.data)))}});function nK(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function w2(e,t,n){n.forEach(Ne);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function Xk(e){P.call(this,{},e)}Xk.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};G(Xk,P,{transform(e,t){const n=e.fields,r=e.index,i=e.values,o=e.default==null?null:e.default,s=e.modified(),a=n.length;let u=s?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return i?(d=i.length,a>1&&!c&&z('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&z('The "as" parameter has too few output field names.'),c=c||i.map(ct),f=function(p){for(var g=0,y=0,m,v;g<a;++g)if(v=r.get(n[g](p)),v==null)for(m=0;m<d;++m,++y)p[c[y]]=o;else for(m=0;m<d;++m,++y)p[c[y]]=i[m](v)}):(c||z("Missing output field names."),f=function(p){for(var g=0,y;g<a;++g)y=r.get(n[g](p)),p[c[g]]=y??o}),s?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function L6(e){We.call(this,null,rK,e)}G(L6,We);function rK(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,o,s;for(o=0;o<n;++o)s=t[o],s[0]<r&&(r=s[0]),s[1]>i&&(i=s[1]);return[r,i]}function z6(e){We.call(this,null,iK,e)}G(z6,We);function iK(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function I6(e){P.call(this,null,e)}G(I6,P,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Qk(e){ya.call(this,e)}Qk.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:zp,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};G(Qk,ya,{_transform:ya.prototype.transform,transform(e,t){return this._transform(oK(e,t),t)}});function oK(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",o=dn(n).concat(dn(r)),s=aK(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:s.map(()=>i),fields:s.map(a=>sK(a,n,r,o)),as:s.map(a=>a+""),modified:e.modified.bind(e)}}function sK(e,t,n,r){return lr(i=>t(i)===e?n(i):NaN,r,e+"")}function aK(e,t,n){const r={},i=[];return n.visit(n.SOURCE,o=>{const s=e(o);r[s]||(r[s]=1,i.push(s))}),i.sort(zy),t?i.slice(0,t):i}function j6(e){nv.call(this,e)}G(j6,nv,{transform(e,t){const n=e.subflow,r=e.field,i=o=>this.subflow(oe(o),n,t,o);return(e.modified("field")||r&&t.modified(dn(r)))&&z("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,o=>{const s=i(o);r(o).forEach(a=>s.mod(a))}),t.visit(t.ADD,o=>{const s=i(o);r(o).forEach(a=>s.add(Ne(a)))}),t.visit(t.REM,o=>{const s=i(o);r(o).forEach(a=>s.rem(a))})):(t.visit(t.MOD,o=>i(o).mod(o)),t.visit(t.ADD,o=>i(o).add(o)),t.visit(t.REM,o=>i(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function Kk(e){P.call(this,null,e)}Kk.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};G(Kk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=F6(e.fields,e.as||[]),o=r?(a,u)=>uK(a,u,r,i):Yy;let s;return this.value?s=this.value:(t=t.addAll(),s=this.value={}),t.visit(t.REM,a=>{const u=oe(a);n.rem.push(s[u]),s[u]=null}),t.visit(t.ADD,a=>{const u=o(a,Ne({}));s[oe(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(o(a,s[oe(a)]))}),n}});function uK(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}function B6(e){P.call(this,null,e)}G(B6,P,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Jk(e){P.call(this,null,e)}Jk.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const lK=1e-14;G(Jk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,o=zk(i,e.groupby,e.field),s=(e.groupby||[]).map(ct),a=[],u=e.step||.01,l=e.probs||xr(u/2,1-lK,u),c=l.length;return o.forEach(f=>{const d=gk(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<s.length;++g)p[s[g]]=f.dims[g];p[r[0]]=l[h],p[r[1]]=d[h],a.push(Ne(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function U6(e){P.call(this,null,e)}G(U6,P,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const o=oe(i);n.rem.push(r[o]),r[o]=null}),t.visit(t.ADD,i=>{const o=dk(i);r[oe(i)]=o,n.add.push(o)}),t.visit(t.MOD,i=>{const o=r[oe(i)];for(const s in i)o[s]=i[s],n.modifies(s);n.mod.push(o)})),n}});function Zk(e){P.call(this,[],e),this.count=0}Zk.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};G(Zk,P,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce((c,f)=>(c[oe(f)]=1,c),{});let s=this.value,a=this.count,u=0;function l(c){let f,d;s.length<i?s.push(c):(d=~~((a+1)*Vr()),d<s.length&&d>=u&&(f=s[d],o[oe(f)]&&n.rem.push(f),s[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=oe(c);o[f]&&(o[f]=-1,n.rem.push(c)),--a}),s=s.filter(c=>o[oe(c)]!==-1)),(t.rem.length||r)&&s.length<i&&t.source&&(u=a=s.length,t.visit(t.SOURCE,c=>{o[oe(c)]||l(c)}),u=-1),r&&s.length>i){const c=s.length-i;for(let f=0;f<c;++f)o[oe(s[f])]=-1,n.rem.push(s[f]);s=s.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[oe(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=s.filter(c=>!o[oe(c)])),this.count=a,this.value=n.source=s,n}});function e$(e){P.call(this,null,e)}e$.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};G(e$,P,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=xr(e.start,e.stop,e.step||1).map(i=>{const o={};return o[r]=i,Ne(o)}),n.add=t.add.concat(this.value),n}});function W6(e){P.call(this,null,e),this.modified(!0)}G(W6,P,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function t$(e){P.call(this,null,e)}const q6=["unit0","unit1"];t$.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:rk,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:q6}]};G(t$,P,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",o=this._floor(e,t),s=(i?Of:Mf)(o.unit).offset,a=e.as||q6,u=a[0],l=a[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(dn(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let y,m;g==null?(p[u]=null,r&&(p[l]=null)):(p[u]=y=m=o(g),r&&(p[l]=m=s(y,c)),y<f&&(f=y),m>d&&(d=m))}),o.start=f,o.stop=d,t.modifies(r?a:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:DL({extent:e.extent||lo(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=ik(r),s=this.value||{},a=(n?kL:_L)(o,i);return a.unit=_e(o),a.units=o,a.step=i,a.start=s.start,a.stop=s.stop,this.value=a}});function H6(e){P.call(this,Af(),e)}G(H6,P,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,o=a=>i.set(r(a),a);let s=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,a=>i.delete(r(a))),t.visit(t.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function V6(e){P.call(this,null,e)}G(V6,P,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(xl(e.sort)):t.source).map(e.field))}});function cK(e,t,n,r){const i=Jh[e](t,n);return{init:i.init||Is,update:function(o,s){s[r]=i.next(o)}}}const Jh={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=Jh.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||z("ntile num must be greater than zero.");const n=Jh.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||z("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=fK(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function fK(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const dK=Object.keys(Jh);function G6(e){const t=K(e.ops),n=K(e.fields),r=K(e.params),i=K(e.as),o=this.outputs=[],s=this.windows=[],a={},u={},l=[],c=[];let f=!0;function d(h){K(dn(h)).forEach(p=>a[p]=1)}d(e.sort),t.forEach((h,p)=>{const g=n[p],y=ct(g),m=E6(h,y,i[p]);if(d(g),o.push(m),ae(Jh,h))s.push(cK(h,n[p],r[p],m));else{if(g==null&&h!=="count"&&z("Null aggregate field specified."),h==="count"){l.push(m);return}f=!1;let v=u[y];v||(v=u[y]=[],v.field=g,c.push(v)),v.push(S6(h,m))}}),(l.length||c.length)&&(this.cell=hK(c,l,f)),this.inputs=Object.keys(a)}const Y6=G6.prototype;Y6.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};Y6.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let s;if(n){for(s=e.p0;s<e.i0;++s)n.rem(i[s]);for(s=e.p1;s<e.i1;++s)n.add(i[s]);n.set(t)}for(s=0;s<o;++s)r[s].update(e,t)};function hK(e,t,n){e=e.map(u=>k6(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),s=0;s<i;++s)o[s]=new e[s](r);if(r.store)var a=r.data=new Ok;return r.add=function(u){if(r.num+=1,!n){a&&a.add(u);for(let l=0;l<i;++l)o[l].add(o[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){a&&a.rem(u);for(let l=0;l<i;++l)o[l].rem(o[l].get(u),u)}},r.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=o.length;l<c;++l)o[l].set(u)},r.init=function(){r.num=0,a&&a.reset();for(let u=0;u<i;++u)o[u].init()},r}function n$(e){P.call(this,{},e),this._mlen=0,this._mods=[]}n$.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:dK.concat(zp)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};G(n$,P,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=xl(e.sort),i=Xw(e.groupby),o=a=>this.group(i(a));let s=this.state;(!s||n)&&(s=this.state=new G6(e)),n||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,a=>o(a).add(a))):(t.visit(t.REM,a=>o(a).remove(a)),t.visit(t.ADD,a=>o(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)pK(this._mods[a],s,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(s.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=$6(oe),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function pK(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,s=r.frame||[null,0],a=e.data(n),u=a.length,l=o?Dp(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||vn(-1)};t.init();for(let f=0;f<u;++f)gK(c,s,f,u),o&&mK(c,l),t.update(c,a[f])}function gK(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function mK(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,s=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<s&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}const yK=Object.freeze(Object.defineProperty({__proto__:null,aggregate:ya,bin:Nk,collect:Dk,compare:C6,countpattern:Rk,cross:Pk,density:Lk,dotbin:Ik,expression:O6,extent:jk,facet:nv,field:N6,filter:Uk,flatten:Wk,fold:qk,formula:Hk,generate:D6,impute:Vk,joinaggregate:Gk,kde:Yk,key:R6,load:P6,lookup:Xk,multiextent:L6,multivalues:z6,params:I6,pivot:Qk,prefacet:j6,project:Kk,proxy:B6,quantile:Jk,relay:U6,sample:Zk,sequence:e$,sieve:W6,subflow:Bk,timeunit:t$,tupleindex:H6,values:V6,window:n$},Symbol.toStringTag,{value:"Module"}));function Re(e){return function(){return e}}const hM=Math.abs,tn=Math.atan2,Ja=Math.cos,vK=Math.max,E2=Math.min,Bi=Math.sin,Su=Math.sqrt,rn=1e-12,Vc=Math.PI,G0=Vc/2,X6=2*Vc;function xK(e){return e>1?0:e<-1?Vc:Math.acos(e)}function pM(e){return e>=1?G0:e<=-1?-G0:Math.asin(e)}const Qw=Math.PI,Kw=2*Qw,du=1e-6,bK=Kw-du;function Q6(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function wK(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Q6;const n=10**t;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let r$=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Q6:wK(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,o,s){this._append`C${+t},${+n},${+r},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(t,n,r,i,o){if(t=+t,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,u=r-t,l=i-n,c=s-t,f=a-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>du)if(!(Math.abs(f*u-l*c)>du)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let h=r-s,p=i-a,g=u*u+l*l,y=h*h+p*p,m=Math.sqrt(g),v=Math.sqrt(d),x=o*Math.tan((Qw-Math.acos((g+d-y)/(2*m*v)))/2),b=x/v,w=x/m;Math.abs(b-1)>du&&this._append`L${t+b*c},${n+b*f}`,this._append`A${o},${o},0,0,${+(f*h>c*p)},${this._x1=t+w*u},${this._y1=n+w*l}`}}arc(t,n,r,i,o,s){if(t=+t,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),u=r*Math.sin(i),l=t+a,c=n+u,f=1^s,d=s?i-o:o-i;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>du||Math.abs(this._y1-c)>du)&&this._append`L${l},${c}`,r&&(d<0&&(d=d%Kw+Kw),d>bK?this._append`A${r},${r},0,1,${f},${t-a},${n-u}A${r},${r},0,1,${f},${this._x1=l},${this._y1=c}`:d>du&&this._append`A${r},${r},0,${+(d>=Qw)},${f},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function rv(){return new r$}rv.prototype=r$.prototype;function iv(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new r$(t)}function EK(e){return e.innerRadius}function SK(e){return e.outerRadius}function _K(e){return e.startAngle}function kK(e){return e.endAngle}function $K(e){return e&&e.padAngle}function CK(e,t,n,r,i,o,s,a){var u=n-e,l=r-t,c=s-i,f=a-o,d=f*u-c*l;if(!(d*d<rn))return d=(c*(t-o)-f*(e-i))/d,[e+d*u,t+d*l]}function Gg(e,t,n,r,i,o,s){var a=e-n,u=t-r,l=(s?o:-o)/Su(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,p=n+c,g=r+f,y=(d+p)/2,m=(h+g)/2,v=p-d,x=g-h,b=v*v+x*x,w=i-o,S=d*g-p*h,E=(x<0?-1:1)*Su(vK(0,w*w*b-S*S)),_=(S*x-v*E)/b,$=(-S*v-x*E)/b,k=(S*x+v*E)/b,A=(-S*v+x*E)/b,R=_-y,C=$-m,F=k-y,T=A-m;return R*R+C*C>F*F+T*T&&(_=k,$=A),{cx:_,cy:$,x01:-c,y01:-f,x11:_*(i/w-1),y11:$*(i/w-1)}}function AK(){var e=EK,t=SK,n=Re(0),r=null,i=_K,o=kK,s=$K,a=null,u=iv(l);function l(){var c,f,d=+e.apply(this,arguments),h=+t.apply(this,arguments),p=i.apply(this,arguments)-G0,g=o.apply(this,arguments)-G0,y=hM(g-p),m=g>p;if(a||(a=c=u()),h<d&&(f=h,h=d,d=f),!(h>rn))a.moveTo(0,0);else if(y>X6-rn)a.moveTo(h*Ja(p),h*Bi(p)),a.arc(0,0,h,p,g,!m),d>rn&&(a.moveTo(d*Ja(g),d*Bi(g)),a.arc(0,0,d,g,p,m));else{var v=p,x=g,b=p,w=g,S=y,E=y,_=s.apply(this,arguments)/2,$=_>rn&&(r?+r.apply(this,arguments):Su(d*d+h*h)),k=E2(hM(h-d)/2,+n.apply(this,arguments)),A=k,R=k,C,F;if($>rn){var T=pM($/d*Bi(_)),O=pM($/h*Bi(_));(S-=T*2)>rn?(T*=m?1:-1,b+=T,w-=T):(S=0,b=w=(p+g)/2),(E-=O*2)>rn?(O*=m?1:-1,v+=O,x-=O):(E=0,v=x=(p+g)/2)}var D=h*Ja(v),M=h*Bi(v),N=d*Ja(w),j=d*Bi(w);if(k>rn){var X=h*Ja(x),te=h*Bi(x),xe=d*Ja(b),de=d*Bi(b),De;if(y<Vc)if(De=CK(D,M,xe,de,X,te,N,j)){var It=D-De[0],Zr=M-De[1],Qa=X-De[0],Z=te-De[1],ge=1/Bi(xK((It*Qa+Zr*Z)/(Su(It*It+Zr*Zr)*Su(Qa*Qa+Z*Z)))/2),ye=Su(De[0]*De[0]+De[1]*De[1]);A=E2(k,(d-ye)/(ge-1)),R=E2(k,(h-ye)/(ge+1))}else A=R=0}E>rn?R>rn?(C=Gg(xe,de,D,M,h,R,m),F=Gg(X,te,N,j,h,R,m),a.moveTo(C.cx+C.x01,C.cy+C.y01),R<k?a.arc(C.cx,C.cy,R,tn(C.y01,C.x01),tn(F.y01,F.x01),!m):(a.arc(C.cx,C.cy,R,tn(C.y01,C.x01),tn(C.y11,C.x11),!m),a.arc(0,0,h,tn(C.cy+C.y11,C.cx+C.x11),tn(F.cy+F.y11,F.cx+F.x11),!m),a.arc(F.cx,F.cy,R,tn(F.y11,F.x11),tn(F.y01,F.x01),!m))):(a.moveTo(D,M),a.arc(0,0,h,v,x,!m)):a.moveTo(D,M),!(d>rn)||!(S>rn)?a.lineTo(N,j):A>rn?(C=Gg(N,j,X,te,d,-A,m),F=Gg(D,M,xe,de,d,-A,m),a.lineTo(C.cx+C.x01,C.cy+C.y01),A<k?a.arc(C.cx,C.cy,A,tn(C.y01,C.x01),tn(F.y01,F.x01),!m):(a.arc(C.cx,C.cy,A,tn(C.y01,C.x01),tn(C.y11,C.x11),!m),a.arc(0,0,d,tn(C.cy+C.y11,C.cx+C.x11),tn(F.cy+F.y11,F.cx+F.x11),m),a.arc(F.cx,F.cy,A,tn(F.y11,F.x11),tn(F.y01,F.x01),!m))):a.arc(0,0,d,w,b,m)}if(a.closePath(),c)return a=null,c+""||null}return l.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Vc/2;return[Ja(f)*c,Bi(f)*c]},l.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Re(+c),l):e},l.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Re(+c),l):t},l.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Re(+c),l):n},l.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Re(+c),l):r},l.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:Re(+c),l):i},l.endAngle=function(c){return arguments.length?(o=typeof c=="function"?c:Re(+c),l):o},l.padAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Re(+c),l):s},l.context=function(c){return arguments.length?(a=c??null,l):a},l}function K6(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function J6(e){this._context=e}J6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function i$(e){return new J6(e)}function Z6(e){return e[0]}function ez(e){return e[1]}function tz(e,t){var n=Re(!0),r=null,i=i$,o=null,s=iv(a);e=typeof e=="function"?e:e===void 0?Z6:Re(e),t=typeof t=="function"?t:t===void 0?ez:Re(t);function a(u){var l,c=(u=K6(u)).length,f,d=!1,h;for(r==null&&(o=i(h=s())),l=0;l<=c;++l)!(l<c&&n(f=u[l],l,u))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(f,l,u),+t(f,l,u));if(h)return o=null,h+""||null}return a.x=function(u){return arguments.length?(e=typeof u=="function"?u:Re(+u),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:Re(+u),a):t},a.defined=function(u){return arguments.length?(n=typeof u=="function"?u:Re(!!u),a):n},a.curve=function(u){return arguments.length?(i=u,r!=null&&(o=i(r)),a):i},a.context=function(u){return arguments.length?(u==null?r=o=null:o=i(r=u),a):r},a}function nz(e,t,n){var r=null,i=Re(!0),o=null,s=i$,a=null,u=iv(l);e=typeof e=="function"?e:e===void 0?Z6:Re(+e),t=typeof t=="function"?t:Re(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?ez:Re(+n);function l(f){var d,h,p,g=(f=K6(f)).length,y,m=!1,v,x=new Array(g),b=new Array(g);for(o==null&&(a=s(v=u())),d=0;d<=g;++d){if(!(d<g&&i(y=f[d],d,f))===m)if(m=!m)h=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=d-1;p>=h;--p)a.point(x[p],b[p]);a.lineEnd(),a.areaEnd()}m&&(x[d]=+e(y,d,f),b[d]=+t(y,d,f),a.point(r?+r(y,d,f):x[d],n?+n(y,d,f):b[d]))}if(v)return a=null,v+""||null}function c(){return tz().defined(i).curve(s).context(o)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:Re(+f),r=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Re(+f),l):e},l.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Re(+f),l):r},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:Re(+f),n=null,l):t},l.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Re(+f),l):t},l.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Re(+f),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(r).y(t)},l.defined=function(f){return arguments.length?(i=typeof f=="function"?f:Re(!!f),l):i},l.curve=function(f){return arguments.length?(s=f,o!=null&&(a=s(o)),l):s},l.context=function(f){return arguments.length?(f==null?o=a=null:a=s(o=f),l):o},l}const TK={draw(e,t){const n=Su(t/Vc);e.moveTo(n,0),e.arc(0,0,n,0,X6)}};function FK(e,t){let n=null,r=iv(i);e=typeof e=="function"?e:Re(e||TK),t=typeof t=="function"?t:Re(t===void 0?64:+t);function i(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return i.type=function(o){return arguments.length?(e=typeof o=="function"?o:Re(o),i):e},i.size=function(o){return arguments.length?(t=typeof o=="function"?o:Re(+o),i):t},i.context=function(o){return arguments.length?(n=o??null,i):n},i}function va(){}function Y0(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function ov(e){this._context=e}ov.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Y0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Y0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function MK(e){return new ov(e)}function rz(e){this._context=e}rz.prototype={areaStart:va,areaEnd:va,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Y0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function OK(e){return new rz(e)}function iz(e){this._context=e}iz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Y0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function NK(e){return new iz(e)}function oz(e,t){this._basis=new ov(e),this._beta=t}oz.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,s=t[n]-i,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+u*o),this._beta*t[a]+(1-this._beta)*(i+u*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const DK=function e(t){function n(r){return t===1?new ov(r):new oz(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function X0(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function o$(e,t){this._context=e,this._k=(1-t)/6}o$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:X0(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:X0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const RK=function e(t){function n(r){return new o$(r,t)}return n.tension=function(r){return e(+r)},n}(0);function s$(e,t){this._context=e,this._k=(1-t)/6}s$.prototype={areaStart:va,areaEnd:va,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:X0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const PK=function e(t){function n(r){return new s$(r,t)}return n.tension=function(r){return e(+r)},n}(0);function a$(e,t){this._context=e,this._k=(1-t)/6}a$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:X0(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const LK=function e(t){function n(r){return new a$(r,t)}return n.tension=function(r){return e(+r)},n}(0);function u$(e,t,n){var r=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>rn){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>rn){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,s=(s*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,s,e._x2,e._y2)}function sz(e,t){this._context=e,this._alpha=t}sz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:u$(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const zK=function e(t){function n(r){return t?new sz(r,t):new o$(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function az(e,t){this._context=e,this._alpha=t}az.prototype={areaStart:va,areaEnd:va,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:u$(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const IK=function e(t){function n(r){return t?new az(r,t):new s$(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function uz(e,t){this._context=e,this._alpha=t}uz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:u$(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const jK=function e(t){function n(r){return t?new uz(r,t):new a$(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function lz(e){this._context=e}lz.prototype={areaStart:va,areaEnd:va,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function BK(e){return new lz(e)}function gM(e){return e<0?-1:1}function mM(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(gM(o)+gM(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function yM(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function S2(e,t,n){var r=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,i+a*t,o-a,s-a*n,o,s)}function Q0(e){this._context=e}Q0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:S2(this,this._t0,yM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,S2(this,yM(this,n=mM(this,e,t)),n);break;default:S2(this,this._t0,n=mM(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function cz(e){this._context=new fz(e)}(cz.prototype=Object.create(Q0.prototype)).point=function(e,t){Q0.prototype.point.call(this,t,e)};function fz(e){this._context=e}fz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function UK(e){return new Q0(e)}function WK(e){return new cz(e)}function dz(e){this._context=e}dz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=vM(e),i=vM(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function vM(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),s=new Array(n);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,s[t]-=r*s[t-1];for(i[n-1]=s[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function qK(e){return new dz(e)}function sv(e,t){this._context=e,this._t=t}sv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function HK(e){return new sv(e,.5)}function VK(e){return new sv(e,0)}function GK(e){return new sv(e,1)}function ca(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const YK=()=>typeof Image<"u"?Image:null;function bo(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Pa(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Jw=Symbol("implicit");function l$(){var e=new RF,t=[],n=[],r=Jw;function i(o){let s=e.get(o);if(s===void 0){if(r!==Jw)return r;e.set(o,s=t.push(o)-1)}return n[s%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new RF;for(const s of o)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return l$(t,n).unknown(r)},bo.apply(i,arguments),i}function Df(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ip(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function La(){}var Vu=.7,Gc=1/Vu,Ec="\\s*([+-]?\\d+)\\s*",Zh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ro="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",XK=/^#([0-9a-f]{3,8})$/,QK=new RegExp(`^rgb\\(${Ec},${Ec},${Ec}\\)$`),KK=new RegExp(`^rgb\\(${ro},${ro},${ro}\\)$`),JK=new RegExp(`^rgba\\(${Ec},${Ec},${Ec},${Zh}\\)$`),ZK=new RegExp(`^rgba\\(${ro},${ro},${ro},${Zh}\\)$`),eJ=new RegExp(`^hsl\\(${Zh},${ro},${ro}\\)$`),tJ=new RegExp(`^hsla\\(${Zh},${ro},${ro},${Zh}\\)$`),xM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Df(La,ep,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:bM,formatHex:bM,formatHex8:nJ,formatHsl:rJ,formatRgb:wM,toString:wM});function bM(){return this.rgb().formatHex()}function nJ(){return this.rgb().formatHex8()}function rJ(){return hz(this).formatHsl()}function wM(){return this.rgb().formatRgb()}function ep(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=XK.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?EM(t):n===3?new Tt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Yg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Yg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=QK.exec(e))?new Tt(t[1],t[2],t[3],1):(t=KK.exec(e))?new Tt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=JK.exec(e))?Yg(t[1],t[2],t[3],t[4]):(t=ZK.exec(e))?Yg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=eJ.exec(e))?kM(t[1],t[2]/100,t[3]/100,1):(t=tJ.exec(e))?kM(t[1],t[2]/100,t[3]/100,t[4]):xM.hasOwnProperty(e)?EM(xM[e]):e==="transparent"?new Tt(NaN,NaN,NaN,0):null}function EM(e){return new Tt(e>>16&255,e>>8&255,e&255,1)}function Yg(e,t,n,r){return r<=0&&(e=t=n=NaN),new Tt(e,t,n,r)}function c$(e){return e instanceof La||(e=ep(e)),e?(e=e.rgb(),new Tt(e.r,e.g,e.b,e.opacity)):new Tt}function xa(e,t,n,r){return arguments.length===1?c$(e):new Tt(e,t,n,r??1)}function Tt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Df(Tt,xa,Ip(La,{brighter(e){return e=e==null?Gc:Math.pow(Gc,e),new Tt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Vu:Math.pow(Vu,e),new Tt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Tt(Ou(this.r),Ou(this.g),Ou(this.b),K0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:SM,formatHex:SM,formatHex8:iJ,formatRgb:_M,toString:_M}));function SM(){return`#${_u(this.r)}${_u(this.g)}${_u(this.b)}`}function iJ(){return`#${_u(this.r)}${_u(this.g)}${_u(this.b)}${_u((isNaN(this.opacity)?1:this.opacity)*255)}`}function _M(){const e=K0(this.opacity);return`${e===1?"rgb(":"rgba("}${Ou(this.r)}, ${Ou(this.g)}, ${Ou(this.b)}${e===1?")":`, ${e})`}`}function K0(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ou(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function _u(e){return e=Ou(e),(e<16?"0":"")+e.toString(16)}function kM(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new di(e,t,n,r)}function hz(e){if(e instanceof di)return new di(e.h,e.s,e.l,e.opacity);if(e instanceof La||(e=ep(e)),!e)return new di;if(e instanceof di)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(t===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-t)/a+2:s=(t-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new di(s,a,u,e.opacity)}function J0(e,t,n,r){return arguments.length===1?hz(e):new di(e,t,n,r??1)}function di(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Df(di,J0,Ip(La,{brighter(e){return e=e==null?Gc:Math.pow(Gc,e),new di(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Vu:Math.pow(Vu,e),new di(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Tt(_2(e>=240?e-240:e+120,i,r),_2(e,i,r),_2(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new di($M(this.h),Xg(this.s),Xg(this.l),K0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=K0(this.opacity);return`${e===1?"hsl(":"hsla("}${$M(this.h)}, ${Xg(this.s)*100}%, ${Xg(this.l)*100}%${e===1?")":`, ${e})`}`}}));function $M(e){return e=(e||0)%360,e<0?e+360:e}function Xg(e){return Math.max(0,Math.min(1,e||0))}function _2(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const pz=Math.PI/180,gz=180/Math.PI,Z0=18,mz=.96422,yz=1,vz=.82521,xz=4/29,Sc=6/29,bz=3*Sc*Sc,oJ=Sc*Sc*Sc;function wz(e){if(e instanceof io)return new io(e.l,e.a,e.b,e.opacity);if(e instanceof Yo)return Ez(e);e instanceof Tt||(e=c$(e));var t=A2(e.r),n=A2(e.g),r=A2(e.b),i=k2((.2225045*t+.7168786*n+.0606169*r)/yz),o,s;return t===n&&n===r?o=s=i:(o=k2((.4360747*t+.3850649*n+.1430804*r)/mz),s=k2((.0139322*t+.0971045*n+.7141733*r)/vz)),new io(116*i-16,500*(o-i),200*(i-s),e.opacity)}function e1(e,t,n,r){return arguments.length===1?wz(e):new io(e,t,n,r??1)}function io(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Df(io,e1,Ip(La,{brighter(e){return new io(this.l+Z0*(e??1),this.a,this.b,this.opacity)},darker(e){return new io(this.l-Z0*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=mz*$2(t),e=yz*$2(e),n=vz*$2(n),new Tt(C2(3.1338561*t-1.6168667*e-.4906146*n),C2(-.9787684*t+1.9161415*e+.033454*n),C2(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function k2(e){return e>oJ?Math.pow(e,1/3):e/bz+xz}function $2(e){return e>Sc?e*e*e:bz*(e-xz)}function C2(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function A2(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function sJ(e){if(e instanceof Yo)return new Yo(e.h,e.c,e.l,e.opacity);if(e instanceof io||(e=wz(e)),e.a===0&&e.b===0)return new Yo(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*gz;return new Yo(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function t1(e,t,n,r){return arguments.length===1?sJ(e):new Yo(e,t,n,r??1)}function Yo(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Ez(e){if(isNaN(e.h))return new io(e.l,0,0,e.opacity);var t=e.h*pz;return new io(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Df(Yo,t1,Ip(La,{brighter(e){return new Yo(this.h,this.c,this.l+Z0*(e??1),this.opacity)},darker(e){return new Yo(this.h,this.c,this.l-Z0*(e??1),this.opacity)},rgb(){return Ez(this).rgb()}}));var Sz=-.14861,f$=1.78277,d$=-.29227,av=-.90649,tp=1.97294,CM=tp*av,AM=tp*f$,TM=f$*d$-av*Sz;function aJ(e){if(e instanceof Nu)return new Nu(e.h,e.s,e.l,e.opacity);e instanceof Tt||(e=c$(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(TM*r+CM*t-AM*n)/(TM+CM-AM),o=r-i,s=(tp*(n-i)-d$*o)/av,a=Math.sqrt(s*s+o*o)/(tp*i*(1-i)),u=a?Math.atan2(s,o)*gz-120:NaN;return new Nu(u<0?u+360:u,a,i,e.opacity)}function Zw(e,t,n,r){return arguments.length===1?aJ(e):new Nu(e,t,n,r??1)}function Nu(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Df(Nu,Zw,Ip(La,{brighter(e){return e=e==null?Gc:Math.pow(Gc,e),new Nu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Vu:Math.pow(Vu,e),new Nu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*pz,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Tt(255*(t+n*(Sz*r+f$*i)),255*(t+n*(d$*r+av*i)),255*(t+n*(tp*r)),this.opacity)}}));function _z(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}function kz(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return _z((n-r/t)*t,s,i,o,a)}}function $z(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return _z((n-r/t)*t,i,o,s,a)}}const uv=e=>()=>e;function Cz(e,t){return function(n){return e+n*t}}function uJ(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function lv(e,t){var n=t-e;return n?Cz(e,n>180||n<-180?n-360*Math.round(n/360):n):uv(isNaN(e)?t:e)}function lJ(e){return(e=+e)==1?Ft:function(t,n){return n-t?uJ(t,n,e):uv(isNaN(t)?n:t)}}function Ft(e,t){var n=t-e;return n?Cz(e,n):uv(isNaN(e)?t:e)}const eE=function e(t){var n=lJ(t);function r(i,o){var s=n((i=xa(i)).r,(o=xa(o)).r),a=n(i.g,o.g),u=n(i.b,o.b),l=Ft(i.opacity,o.opacity);return function(c){return i.r=s(c),i.g=a(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function Az(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s)a=xa(t[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=e(r),i=e(i),o=e(o),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=o(u),a+""}}}var cJ=Az(kz),fJ=Az($z);function h$(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function Tz(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function dJ(e,t){return(Tz(t)?h$:Fz)(e,t)}function Fz(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=za(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}function Mz(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ci(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Oz(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=za(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var tE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,T2=new RegExp(tE.source,"g");function hJ(e){return function(){return e}}function pJ(e){return function(t){return e(t)+""}}function Nz(e,t){var n=tE.lastIndex=T2.lastIndex=0,r,i,o,s=-1,a=[],u=[];for(e=e+"",t=t+"";(r=tE.exec(e))&&(i=T2.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:ci(r,i)})),n=T2.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?pJ(u[0].x):hJ(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function za(e,t){var n=typeof t,r;return t==null||n==="boolean"?uv(t):(n==="number"?ci:n==="string"?(r=ep(t))?(t=r,eE):Nz:t instanceof ep?eE:t instanceof Date?Mz:Tz(t)?h$:Array.isArray(t)?Fz:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Oz:ci)(e,t)}function gJ(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function mJ(e,t){var n=lv(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function jp(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var FM=180/Math.PI,nE={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Dz(e,t,n,r,i,o){var s,a,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*FM,skewX:Math.atan(u)*FM,scaleX:s,scaleY:a}}var Qg;function yJ(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?nE:Dz(t.a,t.b,t.c,t.d,t.e,t.f)}function vJ(e){return e==null||(Qg||(Qg=document.createElementNS("http://www.w3.org/2000/svg","g")),Qg.setAttribute("transform",e),!(e=Qg.transform.baseVal.consolidate()))?nE:(e=e.matrix,Dz(e.a,e.b,e.c,e.d,e.e,e.f))}function Rz(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:ci(l,f)},{i:g-2,x:ci(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function s(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:ci(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:ci(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(i(h)+"scale(",null,",",null,")");p.push({i:g-4,x:ci(l,f)},{i:g-2,x:ci(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),s(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,g=d.length,y;++p<g;)f[(y=d[p]).i]=y.x(h);return f.join("")}}}var xJ=Rz(yJ,"px, ","px)","deg)"),bJ=Rz(vJ,", ",")",")"),wJ=1e-12;function MM(e){return((e=Math.exp(e))+1/e)/2}function EJ(e){return((e=Math.exp(e))-1/e)/2}function SJ(e){return((e=Math.exp(2*e))-1)/(e+1)}const _J=function e(t,n,r){function i(o,s){var a=o[0],u=o[1],l=o[2],c=s[0],f=s[1],d=s[2],h=c-a,p=f-u,g=h*h+p*p,y,m;if(g<wJ)m=Math.log(d/l)/t,y=function(E){return[a+E*h,u+E*p,l*Math.exp(t*E*m)]};else{var v=Math.sqrt(g),x=(d*d-l*l+r*g)/(2*l*n*v),b=(d*d-l*l-r*g)/(2*d*n*v),w=Math.log(Math.sqrt(x*x+1)-x),S=Math.log(Math.sqrt(b*b+1)-b);m=(S-w)/t,y=function(E){var _=E*m,$=MM(w),k=l/(n*v)*($*SJ(t*_+w)-EJ(w));return[a+k*h,u+k*p,l*$/MM(t*_+w)]}}return y.duration=m*1e3*t/Math.SQRT2,y}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,u=a*a;return e(s,a,u)},i}(Math.SQRT2,2,4);function Pz(e){return function(t,n){var r=e((t=J0(t)).h,(n=J0(n)).h),i=Ft(t.s,n.s),o=Ft(t.l,n.l),s=Ft(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=o(a),t.opacity=s(a),t+""}}}const kJ=Pz(lv);var $J=Pz(Ft);function CJ(e,t){var n=Ft((e=e1(e)).l,(t=e1(t)).l),r=Ft(e.a,t.a),i=Ft(e.b,t.b),o=Ft(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=r(s),e.b=i(s),e.opacity=o(s),e+""}}function Lz(e){return function(t,n){var r=e((t=t1(t)).h,(n=t1(n)).h),i=Ft(t.c,n.c),o=Ft(t.l,n.l),s=Ft(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=o(a),t.opacity=s(a),t+""}}}const AJ=Lz(lv);var TJ=Lz(Ft);function zz(e){return function t(n){n=+n;function r(i,o){var s=e((i=Zw(i)).h,(o=Zw(o)).h),a=Ft(i.s,o.s),u=Ft(i.l,o.l),l=Ft(i.opacity,o.opacity);return function(c){return i.h=s(c),i.s=a(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}const FJ=zz(lv);var MJ=zz(Ft);function p$(e,t){t===void 0&&(t=e,e=za);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(s){var a=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return o[a](s-a)}}function OJ(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const NJ=Object.freeze(Object.defineProperty({__proto__:null,interpolate:za,interpolateArray:dJ,interpolateBasis:kz,interpolateBasisClosed:$z,interpolateCubehelix:FJ,interpolateCubehelixLong:MJ,interpolateDate:Mz,interpolateDiscrete:gJ,interpolateHcl:AJ,interpolateHclLong:TJ,interpolateHsl:kJ,interpolateHslLong:$J,interpolateHue:mJ,interpolateLab:CJ,interpolateNumber:ci,interpolateNumberArray:h$,interpolateObject:Oz,interpolateRgb:eE,interpolateRgbBasis:cJ,interpolateRgbBasisClosed:fJ,interpolateRound:jp,interpolateString:Nz,interpolateTransformCss:xJ,interpolateTransformSvg:bJ,interpolateZoom:_J,piecewise:p$,quantize:OJ},Symbol.toStringTag,{value:"Module"}));function DJ(e){return function(){return e}}function rE(e){return+e}var OM=[0,1];function Yn(e){return e}function iE(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:DJ(isNaN(t)?NaN:.5)}function RJ(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function PJ(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=iE(i,r),o=n(s,o)):(r=iE(r,i),o=n(o,s)),function(a){return o(r(a))}}function LJ(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=iE(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(a){var u=Rp(e,a,1,r)-1;return o[u](i[u](a))}}function Bp(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function cv(){var e=OM,t=OM,n=za,r,i,o,s=Yn,a,u,l;function c(){var d=Math.min(e.length,t.length);return s!==Yn&&(s=RJ(e[0],e[d-1])),a=d>2?LJ:PJ,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(u||(u=a(e.map(r),t,n)))(r(s(d)))}return f.invert=function(d){return s(i((l||(l=a(t,e.map(r),ci)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,rE),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=jp,c()},f.clamp=function(d){return arguments.length?(s=d?!0:Yn,c()):s!==Yn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return r=d,i=h,c()}}function Iz(){return cv()(Yn,Yn)}function jz(e,t,n,r){var i=ma(e,t,n),o;switch(r=Hu(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=dL(i,s))&&(r.precision=o),tk(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=hL(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=fL(i))&&(r.precision=o-(r.type==="%")*2);break}}return Iy(r)}function wl(e){var t=e.domain;return e.ticks=function(n){var r=t();return Pw(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return jz(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,s=r[i],a=r[o],u,l,c=10;for(a<s&&(l=s,s=a,a=l,l=i,i=o,o=l);c-- >0;){if(l=Lw(s,a,n),l===u)return r[i]=s,r[o]=a,t(r);if(l>0)s=Math.floor(s/l)*l,a=Math.ceil(a/l)*l;else if(l<0)s=Math.ceil(s*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function Bz(){var e=Iz();return e.copy=function(){return Bp(e,Bz())},bo.apply(e,arguments),wl(e)}function Uz(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,rE),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Uz(e).unknown(t)},e=arguments.length?Array.from(e,rE):[0,1],wl(n)}function Wz(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],s;return o<i&&(s=n,n=r,r=s,s=i,i=o,o=s),e[n]=t.floor(i),e[r]=t.ceil(o),e}function NM(e){return Math.log(e)}function DM(e){return Math.exp(e)}function zJ(e){return-Math.log(-e)}function IJ(e){return-Math.exp(-e)}function jJ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function BJ(e){return e===10?jJ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function UJ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function RM(e){return(t,n)=>-e(-t,n)}function g$(e){const t=e(NM,DM),n=t.domain;let r=10,i,o;function s(){return i=UJ(r),o=BJ(r),n()[0]<0?(i=RM(i),o=RM(o),e(zJ,IJ)):e(NM,DM),t}return t.base=function(a){return arguments.length?(r=+a,s()):r},t.domain=function(a){return arguments.length?(n(a),s()):n()},t.ticks=a=>{const u=n();let l=u[0],c=u[u.length-1];const f=c<l;f&&([l,c]=[c,l]);let d=i(l),h=i(c),p,g;const y=a==null?10:+a;let m=[];if(!(r%1)&&h-d<y){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1;p<r;++p)if(g=d<0?p/o(-d):p*o(d),!(g<l)){if(g>c)break;m.push(g)}}else for(;d<=h;++d)for(p=r-1;p>=1;--p)if(g=d>0?p/o(-d):p*o(d),!(g<l)){if(g>c)break;m.push(g)}m.length*2<y&&(m=Pw(l,c,y))}else m=Pw(d,h,Math.min(h-d,y)).map(o);return f?m.reverse():m},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=r===10?"s":","),typeof u!="function"&&(!(r%1)&&(u=Hu(u)).precision==null&&(u.trim=!0),u=Iy(u)),a===1/0)return u;const l=Math.max(1,r*a/t.ticks().length);return c=>{let f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=()=>n(Wz(n(),{floor:a=>o(Math.floor(i(a))),ceil:a=>o(Math.ceil(i(a)))})),t}function qz(){const e=g$(cv()).domain([1,10]);return e.copy=()=>Bp(e,qz()).base(e.base()),bo.apply(e,arguments),e}function PM(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function LM(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function m$(e){var t=1,n=e(PM(t),LM(t));return n.constant=function(r){return arguments.length?e(PM(t=+r),LM(t)):t},wl(n)}function Hz(){var e=m$(cv());return e.copy=function(){return Bp(e,Hz()).constant(e.constant())},bo.apply(e,arguments)}function zM(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function WJ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function qJ(e){return e<0?-e*e:e*e}function y$(e){var t=e(Yn,Yn),n=1;function r(){return n===1?e(Yn,Yn):n===.5?e(WJ,qJ):e(zM(n),zM(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},wl(t)}function v$(){var e=y$(cv());return e.copy=function(){return Bp(e,v$()).exponent(e.exponent())},bo.apply(e,arguments),e}function HJ(){return v$.apply(null,arguments).exponent(.5)}function Vz(){var e=[],t=[],n=[],r;function i(){var s=0,a=Math.max(1,t.length);for(n=new Array(a-1);++s<a;)n[s-1]=oL(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?r:t[Rp(n,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Jo),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(r=s,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return Vz().domain(e).range(t).unknown(r)},bo.apply(o,arguments)}function Gz(){var e=0,t=1,n=1,r=[.5],i=[0,1],o;function s(u){return u!=null&&u<=u?i[Rp(r,u,0,n)]:o}function a(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return s}return s.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},s.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,a()):i.slice()},s.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},s.unknown=function(u){return arguments.length&&(o=u),s},s.thresholds=function(){return r.slice()},s.copy=function(){return Gz().domain([e,t]).range(i).unknown(o)},bo.apply(wl(s),arguments)}function Yz(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[Rp(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return Yz().domain(e).range(t).unknown(n)},bo.apply(i,arguments)}function VJ(e){return new Date(e)}function GJ(e){return e instanceof Date?+e:+new Date(+e)}function x$(e,t,n,r,i,o,s,a,u,l){var c=Iz(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),y=l("%I %p"),m=l("%a %d"),v=l("%b %d"),x=l("%B"),b=l("%Y");function w(S){return(u(S)<S?h:a(S)<S?p:s(S)<S?g:o(S)<S?y:r(S)<S?i(S)<S?m:v:n(S)<S?x:b)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,GJ)):d().map(VJ)},c.ticks=function(S){var E=d();return e(E[0],E[E.length-1],S??10)},c.tickFormat=function(S,E){return E==null?w:l(E)},c.nice=function(S){var E=d();return(!S||typeof S.range!="function")&&(S=t(E[0],E[E.length-1],S??10)),S?d(Wz(E,S)):c},c.copy=function(){return Bp(c,x$(e,t,n,r,i,o,s,a,u,l))},c}function YJ(){return bo.apply(x$(eY,tY,co,Yh,Tf,Zo,Uy,jy,Go,sk).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function XJ(){return bo.apply(x$(JG,ZG,fo,Xh,Ff,ua,Wy,By,Go,ak).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function fv(){var e=0,t=1,n,r,i,o,s=Yn,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:s(i===0?.5:(f=(o(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(s=f,l):s};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,s=f(h,p),l):[s(0),s(1)]}}return l.range=c(za),l.rangeRound=c(jp),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return o=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function Ia(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function b$(){var e=wl(fv()(Yn));return e.copy=function(){return Ia(e,b$())},Pa.apply(e,arguments)}function Xz(){var e=g$(fv()).domain([1,10]);return e.copy=function(){return Ia(e,Xz()).base(e.base())},Pa.apply(e,arguments)}function Qz(){var e=m$(fv());return e.copy=function(){return Ia(e,Qz()).constant(e.constant())},Pa.apply(e,arguments)}function w$(){var e=y$(fv());return e.copy=function(){return Ia(e,w$()).exponent(e.exponent())},Pa.apply(e,arguments)}function QJ(){return w$.apply(null,arguments).exponent(.5)}function dv(){var e=0,t=.5,n=1,r=1,i,o,s,a,u,l=Yn,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-o)*(r*g<r*o?a:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),o=c(t=+t),s=c(n=+n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function p(g){return function(y){var m,v,x;return arguments.length?([m,v,x]=y,l=p$(g,[m,v,x]),h):[l(0),l(.5),l(1)]}}return h.range=p(za),h.rangeRound=p(jp),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,i=g(e),o=g(t),s=g(n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,h}}function Kz(){var e=wl(dv()(Yn));return e.copy=function(){return Ia(e,Kz())},Pa.apply(e,arguments)}function Jz(){var e=g$(dv()).domain([.1,1,10]);return e.copy=function(){return Ia(e,Jz()).base(e.base())},Pa.apply(e,arguments)}function Zz(){var e=m$(dv());return e.copy=function(){return Ia(e,Zz()).constant(e.constant())},Pa.apply(e,arguments)}function E$(){var e=y$(dv());return e.copy=function(){return Ia(e,E$()).exponent(e.exponent())},Pa.apply(e,arguments)}function KJ(){return E$.apply(null,arguments).exponent(.5)}function S$(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const JJ="identity",Yc="linear",fs="log",Up="pow",Wp="sqrt",hv="symlog",Gu="time",Yu="utc",oo="sequential",Rf="diverging",Xc="quantile",pv="quantize",gv="threshold",_$="ordinal",oE="point",eI="band",k$="bin-ordinal",kt="continuous",qp="discrete",Hp="discretizing",Qr="interpolating",$$="temporal";function ZJ(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function eZ(e){return function(t){const n=e.range();let r=t[0],i=t[1],o=-1,s,a,u,l;for(i<r&&(a=r,r=i,i=a),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(o<0&&(o=u),s=u);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[s]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function C$(){const e=l$().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,o,s=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=S$(f,a,u);let g=r[d-0];i=(h-g)/(p||1),s&&(i=Math.floor(i)),g+=(h-g-i*(f-a))*l,o=i*(1-a),s&&(g=Math.round(g),o=Math.round(o));const y=xr(f).map(m=>g+i*m);return n(d?y.reverse():y)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],s=!0,c()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(s=!!f,c()):s},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],y=+f[1],m,v,x;if(!(g!==g||y!==y)&&(y<g&&(x=g,g=y,y=x),!(y<h[0]||g>r[1-d])))return m=Math.max(0,I0(h,g)-1),v=g===y?m:I0(h,y)-1,g-h[m]>o+1e-10&&++m,d&&(x=m,m=p-v,v=p-x),m>v?void 0:t().slice(m,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return C$().domain(t()).range(r).round(s).paddingInner(a).paddingOuter(u).align(l)},c()}function tI(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return tI(t())},e}function tZ(){return tI(C$().paddingInner(1))}var nZ=Array.prototype.map;function rZ(e){return nZ.call(e,ln)}const iZ=Array.prototype.slice;function nI(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(Rp(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=rZ(r),n):e.slice()},n.range=function(r){return arguments.length?(t=iZ.call(r),n):t.slice()},n.tickFormat=function(r,i){return jz(e[0],_e(e),r??10,i)},n.copy=function(){return nI().domain(n.domain()).range(n.range())},n}const n1=new Map,rI=Symbol("vega_scale");function iI(e){return e[rI]=!0,e}function oZ(e){return e&&e[rI]===!0}function sZ(e,t,n){const r=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?ZJ(o):o.invertExtent?eZ(o):void 0),o.type=e,iI(o)};return r.metadata=Ci(K(n)),r}function Fe(e,t,n){return arguments.length>1?(n1.set(e,sZ(e,t,n)),this):oI(e)?n1.get(e):void 0}Fe(JJ,Uz);Fe(Yc,Bz,kt);Fe(fs,qz,[kt,fs]);Fe(Up,v$,kt);Fe(Wp,HJ,kt);Fe(hv,Hz,kt);Fe(Gu,YJ,[kt,$$]);Fe(Yu,XJ,[kt,$$]);Fe(oo,b$,[kt,Qr]);Fe(`${oo}-${Yc}`,b$,[kt,Qr]);Fe(`${oo}-${fs}`,Xz,[kt,Qr,fs]);Fe(`${oo}-${Up}`,w$,[kt,Qr]);Fe(`${oo}-${Wp}`,QJ,[kt,Qr]);Fe(`${oo}-${hv}`,Qz,[kt,Qr]);Fe(`${Rf}-${Yc}`,Kz,[kt,Qr]);Fe(`${Rf}-${fs}`,Jz,[kt,Qr,fs]);Fe(`${Rf}-${Up}`,E$,[kt,Qr]);Fe(`${Rf}-${Wp}`,KJ,[kt,Qr]);Fe(`${Rf}-${hv}`,Zz,[kt,Qr]);Fe(Xc,Vz,[Hp,Xc]);Fe(pv,Gz,Hp);Fe(gv,Yz,Hp);Fe(k$,nI,[qp,Hp]);Fe(_$,l$,qp);Fe(eI,C$,qp);Fe(oE,tZ,qp);function oI(e){return n1.has(e)}function El(e,t){const n=n1.get(e);return n&&n.metadata[t]}function A$(e){return El(e,kt)}function Qc(e){return El(e,qp)}function sE(e){return El(e,Hp)}function sI(e){return El(e,fs)}function aZ(e){return El(e,$$)}function aI(e){return El(e,Qr)}function uI(e){return El(e,Xc)}const uZ=["clamp","base","constant","exponent"];function lI(e,t){const n=t[0],r=_e(t)-n;return function(i){return e(n+i*r)}}function mv(e,t,n){return p$(T$(t||"rgb",n),e)}function cI(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function fI(e,t,n){const r=n-t;let i,o,s;return!r||!Number.isFinite(r)?vn(.5):(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),s=Fe(o)().domain([t,n]).range([0,1]),uZ.forEach(a=>e[a]?s[a](e[a]()):0),s)}function T$(e,t){const n=NJ[lZ(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function lZ(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const cZ={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},fZ={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function dI(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function hI(e,t){for(const n in e)F$(n,t(e[n]))}const IM={};hI(fZ,dI);hI(cZ,e=>mv(dI(e)));function F$(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(IM[e]=t,this):IM[e]}const Wm="symbol",dZ="discrete",hZ="gradient",pZ=e=>I(e)?e.map(t=>String(t)):String(e),gZ=(e,t)=>e[1]-t[1],mZ=(e,t)=>t[1]-e[1];function M$(e,t,n){let r;return je(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(Np(e.domain())/n||1)))),J(t)&&(r=t.step,t=t.interval),Q(t)&&(t=e.type===Gu?Mf(t):e.type==Yu?Of(t):z("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function pI(e,t,n){let r=e.range(),i=r[0],o=_e(r),s=gZ;if(i>o&&(r=o,o=i,i=r,s=mZ),i=Math.floor(i),o=Math.ceil(o),t=t.map(a=>[a,e(a)]).filter(a=>i<=a[1]&&a[1]<=o).sort(s).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],_e(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function O$(e,t){return e.bins?pI(e,e.bins):e.ticks?e.ticks(t):e.domain()}function gI(e,t,n,r,i,o){const s=t.type;let a=pZ;if(s===Gu||i===Gu)a=e.timeFormat(r);else if(s===Yu||i===Yu)a=e.utcFormat(r);else if(sI(s)){const u=e.formatFloat(r);if(o||t.bins)a=u;else{const l=mI(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(a=e.format(r));return a}function mI(e,t,n){const r=O$(e,t),i=e.base(),o=Math.log(i),s=Math.max(1,i*t/r.length),a=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/o));return l*i<i-.5&&(l*=i),l<=s};return n?r.filter(a):a}const aE={[Xc]:"quantiles",[pv]:"thresholds",[gv]:"domain"},yI={[Xc]:"quantiles",[pv]:"domain"};function vI(e,t){return e.bins?xZ(e.bins):e.type===fs?mI(e,t,!0):aE[e.type]?vZ(e[aE[e.type]]()):O$(e,t)}function yZ(e,t,n){const r=t[yI[t.type]](),i=r.length;let o=i>1?r[1]-r[0]:r[0],s;for(s=1;s<i;++s)o=Math.min(o,r[s]-r[s-1]);return e.formatSpan(0,o,3*10,n)}function vZ(e){const t=[-1/0].concat(e);return t.max=1/0,t}function xZ(e){const t=e.slice(0,-1);return t.max=_e(e),t}const bZ=e=>aE[e.type]||e.bins;function xI(e,t,n,r,i,o,s){const a=yI[t.type]&&o!==Gu&&o!==Yu?yZ(e,t,i):gI(e,t,n,i,o,s);return r===Wm&&bZ(t)?wZ(a):r===dZ?EZ(a):SZ(a)}const wZ=e=>(t,n,r)=>{const i=jM(r[n+1],jM(r.max,1/0)),o=BM(t,e),s=BM(i,e);return o&&s?o+" – "+s:s?"< "+s:"≥ "+o},jM=(e,t)=>e??t,EZ=e=>(t,n)=>n?e(t):null,SZ=e=>t=>e(t),BM=(e,t)=>Number.isFinite(e)?t(e):null;function _Z(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+_e(t),o=i-r;if(e.type===gv){const s=n?o/n:.1;r-=s,i+=s,o=i-r}return s=>(s-r)/o}function kZ(e,t,n,r){const i=r||t.type;return Q(n)&&aZ(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===Gu?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===Yu?e.utcFormat("%A, %d %B %Y, %X UTC"):xI(e,t,5,null,n,r,!0)}function bI(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=kZ(e,t,n.format,n.formatType);if(sE(t.type)){const o=vI(t).slice(1).map(i),s=o.length;return`${s} boundar${s===1?"y":"ies"}: ${o.join(", ")}`}else if(Qc(t.type)){const o=t.domain(),s=o.length,a=s>r?o.slice(0,r-2).map(i).join(", ")+", ending with "+o.slice(-1).map(i):o.map(i).join(", ");return`${s} value${s===1?"":"s"}: ${a}`}else{const o=t.domain();return`values from ${i(o[0])} to ${i(_e(o))}`}}let wI=0;function $Z(){wI=0}const r1="p_";function N$(e){return e&&e.gradient}function EI(e,t,n){const r=e.gradient;let i=e.id,o=r==="radial"?r1:"";return i||(i=e.id="gradient_"+wI++,r==="radial"?(e.x1=Ui(e.x1,.5),e.y1=Ui(e.y1,.5),e.r1=Ui(e.r1,0),e.x2=Ui(e.x2,.5),e.y2=Ui(e.y2,.5),e.r2=Ui(e.r2,.5),o=r1):(e.x1=Ui(e.x1,0),e.y1=Ui(e.y1,0),e.x2=Ui(e.x2,1),e.y2=Ui(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function Ui(e,t){return e??t}function SI(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,o){return n.push({offset:i,color:o}),r}}}const UM={basis:{curve:MK},"basis-closed":{curve:OK},"basis-open":{curve:NK},bundle:{curve:DK,tension:"beta",value:.85},cardinal:{curve:RK,tension:"tension",value:0},"cardinal-open":{curve:LK,tension:"tension",value:0},"cardinal-closed":{curve:PK,tension:"tension",value:0},"catmull-rom":{curve:zK,tension:"alpha",value:.5},"catmull-rom-closed":{curve:IK,tension:"alpha",value:.5},"catmull-rom-open":{curve:jK,tension:"alpha",value:.5},linear:{curve:i$},"linear-closed":{curve:BK},monotone:{horizontal:WK,vertical:UK},natural:{curve:qK},step:{curve:HK},"step-after":{curve:GK},"step-before":{curve:VK}};function D$(e,t,n){var r=ae(UM,e)&&UM[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const CZ={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},AZ=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,TZ=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,FZ=/^((\s+,?\s*)|(,\s*))/,MZ=/^[01]/;function Kc(e){const t=[];return(e.match(AZ)||[]).forEach(r=>{let i=r[0];const o=i.toLowerCase(),s=CZ[o],a=OZ(o,s,r.slice(1).trim()),u=a.length;if(u<s||u&&u%s!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...a.slice(0,s)]),u!==s){o==="m"&&(i=i==="M"?"L":"l");for(let l=s;l<u;l+=s)t.push([i,...a.slice(l,l+s)])}}),t}function OZ(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let o=0;o<t;++o){const s=e==="a"&&(o===3||o===4)?MZ:TZ,a=n.slice(i).match(s);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const u=n.slice(i).match(FZ);u!==null&&(i+=u[0].length)}return r}const ba=Math.PI/180,NZ=1e-14,gu=Math.PI/2,Qi=Math.PI*2,Pl=Math.sqrt(3)/2;var F2={},M2={},_I=[].join;function DZ(e,t,n,r,i,o,s,a,u){const l=_I.call(arguments);if(F2[l])return F2[l];const c=s*ba,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(a-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(a-e)*.5;let g=h*h/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const y=d/n,m=f/n,v=-f/r,x=d/r,b=y*a+m*u,w=v*a+x*u,S=y*e+m*t,E=v*e+x*t;let $=1/((S-b)*(S-b)+(E-w)*(E-w))-.25;$<0&&($=0);let k=Math.sqrt($);o==i&&(k=-k);const A=.5*(b+S)-k*(E-w),R=.5*(w+E)+k*(S-b),C=Math.atan2(w-R,b-A);let T=Math.atan2(E-R,S-A)-C;T<0&&o===1?T+=Qi:T>0&&o===0&&(T-=Qi);const O=Math.ceil(Math.abs(T/(gu+.001))),D=[];for(let M=0;M<O;++M){const N=C+M*T/O,j=C+(M+1)*T/O;D[M]=[A,R,N,j,n,r,f,d]}return F2[l]=D}function RZ(e){const t=_I.call(e);if(M2[t])return M2[t];var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7];const c=l*s,f=-u*a,d=u*s,h=l*a,p=Math.cos(i),g=Math.sin(i),y=Math.cos(o),m=Math.sin(o),v=.5*(o-i),x=Math.sin(v*.5),b=8/3*x*x/Math.sin(v),w=n+p-b*g,S=r+g+b*p,E=n+y,_=r+m,$=E+b*m,k=_-b*y;return M2[t]=[c*w+f*S,d*w+h*S,c*$+f*k,d*$+h*k,c*E+f*_,d*E+h*_]}const Fr=["l",0,0,0,0,0,0,0];function PZ(e,t,n){const r=Fr[0]=e[0];if(r==="a"||r==="A")Fr[1]=t*e[1],Fr[2]=n*e[2],Fr[3]=e[3],Fr[4]=e[4],Fr[5]=e[5],Fr[6]=t*e[6],Fr[7]=n*e[7];else if(r==="h"||r==="H")Fr[1]=t*e[1];else if(r==="v"||r==="V")Fr[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)Fr[i]=(i%2==1?t:n)*e[i];return Fr}function np(e,t,n,r,i,o){var s,a=null,u=0,l=0,c=0,f=0,d,h,p,g,y=0,m=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),o==null&&(o=i),e.beginPath&&e.beginPath();for(var v=0,x=t.length;v<x;++v){switch(s=t[v],(i!==1||o!==1)&&(s=PZ(s,i,o)),s[0]){case"l":u+=s[1],l+=s[2],e.lineTo(u+n,l+r);break;case"L":u=s[1],l=s[2],e.lineTo(u+n,l+r);break;case"h":u+=s[1],e.lineTo(u+n,l+r);break;case"H":u=s[1],e.lineTo(u+n,l+r);break;case"v":l+=s[1],e.lineTo(u+n,l+r);break;case"V":l=s[1],e.lineTo(u+n,l+r);break;case"m":u+=s[1],l+=s[2],y=u,m=l,e.moveTo(u+n,l+r);break;case"M":u=s[1],l=s[2],y=u,m=l,e.moveTo(u+n,l+r);break;case"c":d=u+s[5],h=l+s[6],c=u+s[3],f=l+s[4],e.bezierCurveTo(u+s[1]+n,l+s[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=s[5],l=s[6],c=s[3],f=s[4],e.bezierCurveTo(s[1]+n,s[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+s[3],h=l+s[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+s[1]+n,l+s[2]+r,d+n,h+r),c=u+s[1],f=l+s[2],u=d,l=h;break;case"S":d=s[3],h=s[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,s[1]+n,s[2]+r,d+n,h+r),u=d,l=h,c=s[1],f=s[2];break;case"q":d=u+s[3],h=l+s[4],c=u+s[1],f=l+s[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=s[3],h=s[4],e.quadraticCurveTo(s[1]+n,s[2]+r,d+n,h+r),u=d,l=h,c=s[1],f=s[2];break;case"t":d=u+s[1],h=l+s[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-p,f=2*l-g):a[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+s[1],f=l+s[2];break;case"T":d=s[1],h=s[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":WM(e,u+n,l+r,[s[1],s[2],s[3],s[4],s[5],s[6]+u+n,s[7]+l+r]),u+=s[6],l+=s[7];break;case"A":WM(e,u+n,l+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),u=s[6],l=s[7];break;case"z":case"Z":u=y,l=m,e.closePath();break}a=s}}function WM(e,t,n,r){const i=DZ(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){const s=RZ(i[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}const qM=.5773502691896257,HM={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Qi)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pl*n,i=r-n*qM,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pl*n,i=r-n*qM;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pl*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pl*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pl*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pl*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function kI(e){return ae(HM,e)?HM[e]:LZ(e)}var O2={};function LZ(e){if(!ae(O2,e)){const t=Kc(e);O2[e]={draw:function(n,r){np(n,t,0,0,Math.sqrt(r)/2)}}}return O2[e]}const $s=.448084975506;function zZ(e){return e.x}function IZ(e){return e.y}function jZ(e){return e.width}function BZ(e){return e.height}function Mo(e){return typeof e=="function"?e:()=>+e}function Kg(e,t,n){return Math.max(t,Math.min(e,n))}function $I(){var e=zZ,t=IZ,n=jZ,r=BZ,i=Mo(0),o=i,s=i,a=i,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),y=+n.call(this,c),m=+r.call(this,c),v=Math.min(y,m)/2,x=Kg(+i.call(this,c),0,v),b=Kg(+o.call(this,c),0,v),w=Kg(+s.call(this,c),0,v),S=Kg(+a.call(this,c),0,v);if(u||(u=h=rv()),x<=0&&b<=0&&w<=0&&S<=0)u.rect(p,g,y,m);else{var E=p+y,_=g+m;u.moveTo(p+x,g),u.lineTo(E-b,g),u.bezierCurveTo(E-$s*b,g,E,g+$s*b,E,g+b),u.lineTo(E,_-S),u.bezierCurveTo(E,_-$s*S,E-$s*S,_,E-S,_),u.lineTo(p+w,_),u.bezierCurveTo(p+$s*w,_,p,_-$s*w,p,_-w),u.lineTo(p,g+x),u.bezierCurveTo(p,g+$s*x,p+$s*x,g,p+x,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=Mo(c),l):e},l.y=function(c){return arguments.length?(t=Mo(c),l):t},l.width=function(c){return arguments.length?(n=Mo(c),l):n},l.height=function(c){return arguments.length?(r=Mo(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=Mo(c),o=f!=null?Mo(f):i,a=d!=null?Mo(d):i,s=h!=null?Mo(h):o,l):i},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function CI(){var e,t,n,r,i=null,o,s,a,u;function l(f,d,h){const p=h/2;if(o){var g=a-d,y=f-s;if(g||y){var m=Math.sqrt(g*g+y*y),v=(g/=m)*u,x=(y/=m)*u,b=Math.atan2(y,g);i.moveTo(s-v,a-x),i.lineTo(f-g*p,d-y*p),i.arc(f,d,p,b-Math.PI,b),i.lineTo(s+v,a+x),i.arc(s,a,u,b,b+Math.PI)}else i.arc(f,d,p,0,Qi);i.closePath()}else o=1;s=f,a=d,u=p}function c(f){var d,h=f.length,p,g=!1,y;for(i==null&&(i=y=rv()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===g&&(g=!g)&&(o=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(y)return i=null,y+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function Vp(e,t){return e??t}const Gp=e=>e.x||0,Yp=e=>e.y||0,UZ=e=>e.width||0,WZ=e=>e.height||0,qZ=e=>(e.x||0)+(e.width||0),HZ=e=>(e.y||0)+(e.height||0),VZ=e=>e.startAngle||0,GZ=e=>e.endAngle||0,YZ=e=>e.padAngle||0,XZ=e=>e.innerRadius||0,QZ=e=>e.outerRadius||0,KZ=e=>e.cornerRadius||0,JZ=e=>Vp(e.cornerRadiusTopLeft,e.cornerRadius)||0,ZZ=e=>Vp(e.cornerRadiusTopRight,e.cornerRadius)||0,eee=e=>Vp(e.cornerRadiusBottomRight,e.cornerRadius)||0,tee=e=>Vp(e.cornerRadiusBottomLeft,e.cornerRadius)||0,nee=e=>Vp(e.size,64),ree=e=>e.size||1,yv=e=>e.defined!==!1,iee=e=>kI(e.shape||"circle"),oee=AK().startAngle(VZ).endAngle(GZ).padAngle(YZ).innerRadius(XZ).outerRadius(QZ).cornerRadius(KZ),see=nz().x(Gp).y1(Yp).y0(HZ).defined(yv),aee=nz().y(Yp).x1(Gp).x0(qZ).defined(yv),uee=tz().x(Gp).y(Yp).defined(yv),lee=$I().x(Gp).y(Yp).width(UZ).height(WZ).cornerRadius(JZ,ZZ,eee,tee),cee=FK().type(iee).size(nee),fee=CI().x(Gp).y(Yp).defined(yv).size(ree);function R$(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function dee(e,t){return oee.context(e)(t)}function hee(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?aee:see).curve(D$(r,n.orient,n.tension)).context(e)(t)}function pee(e,t){const n=t[0],r=n.interpolate||"linear";return uee.curve(D$(r,n.orient,n.tension)).context(e)(t)}function Pf(e,t,n,r){return lee.context(e)(t,n,r)}function gee(e,t){return(t.mark.shape||t.shape).context(e)(t)}function mee(e,t){return cee.context(e)(t)}function yee(e,t){return fee.context(e)(t)}var AI=1;function TI(){AI=1}function P$(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+AI++),s=i.clipping[o]||(i.clipping[o]={id:o});return pe(r)?s.path=r(null):R$(n)?s.path=Pf(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function gt(e){this.clear(),e&&this.union(e)}gt.prototype={clone(){return new gt(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*r-u*i+l,u*r+a*i+c,a*r-u*s+l,u*r+a*s+c,a*o-u*i+l,u*o+a*i+c,a*o-u*s+l,u*o+a*s+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function vv(e){this.mark=e,this.bounds=this.bounds||new gt}function xv(e){vv.call(this,e),this.items=this.items||[]}G(xv,vv);function L$(e){this._pending=0,this._loader=e||Hy()}function VM(e){e._pending+=1}function hd(e){e._pending-=1}L$.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return VM(t),t._loader.sanitize(e,{context:"href"}).then(n=>(hd(t),n)).catch(()=>(hd(t),null))},loadImage(e){const t=this,n=YK();return VM(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const o=new n,s=ae(r,"crossOrigin")?r.crossOrigin:"anonymous";return s!=null&&(o.crossOrigin=s),o.onload=()=>hd(t),o.onerror=()=>hd(t),o.src=i,o}).catch(r=>(hd(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function gs(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?vee(t,r):0))}return e}function vee(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const xee=Qi-1e-8;let bv,qm,Hm,ku,uE,Vm,lE,cE;const Ws=(e,t)=>bv.add(e,t),Gm=(e,t)=>Ws(qm=e,Hm=t),GM=e=>Ws(e,bv.y1),YM=e=>Ws(bv.x1,e),mu=(e,t)=>uE*e+lE*t,yu=(e,t)=>Vm*e+cE*t,N2=(e,t)=>Ws(mu(e,t),yu(e,t)),D2=(e,t)=>Gm(mu(e,t),yu(e,t));function Xp(e,t){return bv=e,t?(ku=t*ba,uE=cE=Math.cos(ku),Vm=Math.sin(ku),lE=-Vm):(uE=cE=1,ku=Vm=lE=0),bee}const bee={beginPath(){},closePath(){},moveTo:D2,lineTo:D2,rect(e,t,n,r){ku?(N2(e+n,t),N2(e+n,t+r),N2(e,t+r),D2(e,t)):(Ws(e+n,t+r),Gm(e,t))},quadraticCurveTo(e,t,n,r){const i=mu(e,t),o=yu(e,t),s=mu(n,r),a=yu(n,r);XM(qm,i,s,GM),XM(Hm,o,a,YM),Gm(s,a)},bezierCurveTo(e,t,n,r,i,o){const s=mu(e,t),a=yu(e,t),u=mu(n,r),l=yu(n,r),c=mu(i,o),f=yu(i,o);QM(qm,s,u,c,GM),QM(Hm,a,l,f,YM),Gm(c,f)},arc(e,t,n,r,i,o){if(r+=ku,i+=ku,qm=n*Math.cos(i)+e,Hm=n*Math.sin(i)+t,Math.abs(i-r)>xee)Ws(e-n,t-n),Ws(e+n,t+n);else{const s=l=>Ws(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(s(r),s(i),i!==r)if(r=r%Qi,r<0&&(r+=Qi),i=i%Qi,i<0&&(i+=Qi),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=Qi,a=r-r%gu,u=0;u<4&&a>i;++u,a-=gu)s(a);else for(a=r-r%gu+gu,u=0;u<4&&a<i;++u,a=a+gu)s(a)}}};function XM(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function QM(e,t,n,r,i){const o=r-e+3*t-3*n,s=e+n-2*t,a=e-t;let u=0,l=0,c;Math.abs(o)>NZ?(c=s*s+a*o,c>=0&&(c=Math.sqrt(c),u=(-s+c)/o,l=(-s-c)/o)):u=.5*a/s,0<u&&u<1&&i(KM(u,e,t,n,r)),0<l&&l<1&&i(KM(l,e,t,n,r))}function KM(e,t,n,r,i){const o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*r+a*e*i}var fa=(fa=ca(1,1))?fa.getContext("2d"):null;const fE=new gt;function z$(e){return function(t,n){if(!fa)return!0;e(fa,t),fE.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:s}=fE;for(let a=i;a<=s;++a)for(let u=r;u<=o;++u)if(fa.isPointInPath(u,a))return!0;return!1}}function I$(e,t){return t.contains(e.x||0,e.y||0)}function FI(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(fE.set(n,r,n+i,r+o))}function MI(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:r;return cc(t,n,r,i,o)}function cc(e,t,n,r,i){const{x1:o,y1:s,x2:a,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,p,g,y;for(y=0;y<4;++y){if(y===0&&(h=-l,p=-(o-t)),y===1&&(h=l,p=a-t),y===2&&(h=-c,p=-(s-n)),y===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function Jc(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ni(e,t){return e??t}function JM(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function wee(e,t,n){const r=n.width(),i=n.height();let o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+ni(t.x1,.5)*r,n.y1+ni(t.y1,.5)*i,Math.max(r,i)*ni(t.r1,0),n.x1+ni(t.x2,.5)*r,n.y1+ni(t.y2,.5)*i,Math.max(r,i)*ni(t.r2,.5));else{const s=ni(t.x1,0),a=ni(t.y1,0),u=ni(t.x2,1),l=ni(t.y2,0);if(s===u||a===l||r===i)o=e.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+u*r,n.y1+l*i);else{const c=ca(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=JM(f.createLinearGradient(s,a,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return JM(o,t.stops)}function OI(e,t,n){return N$(n)?wee(e,n,t.bounds):n}function i1(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=OI(e,t,t.fill),!0):!1}var Eee=[];function Zc(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=OI(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Eee),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function See(e,t){return e.zindex-t.zindex||e.index-t.index}function j$(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,o;for(i=0,o=t.length;i<o;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(See)}function Ti(e,t){var n=e.items,r,i;if(!n||!n.length)return;const o=j$(e);if(o&&o.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=o}for(r=0,i=n.length;r<i;++r)t(n[r])}function o1(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const o=j$(e);for(o&&o.length&&(n=o),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===o){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function B$(e){return function(t,n,r){Ti(n,i=>{(!r||r.intersects(i.bounds))&&NI(e,t,i,i)})}}function _ee(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&NI(e,t,n.items[0],n.items)}}function NI(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Jc(t,n),n.fill&&i1(t,n,i)&&t.fill(),n.stroke&&Zc(t,n,i)&&t.stroke()))}function wv(e){return e=e||qr,function(t,n,r,i,o,s){return r*=t.pixelRatio,i*=t.pixelRatio,o1(n,a=>{const u=a.bounds;if(!(u&&!u.contains(o,s)||!u)&&e(t,a,r,i,o,s))return a})}}function Qp(e,t){return function(n,r,i,o){var s=Array.isArray(r)?r[0]:r,a=t??s.fill,u=s.stroke&&n.isPointInStroke,l,c;return u&&(l=s.strokeWidth,c=s.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:a&&n.isPointInPath(i,o)||u&&n.isPointInStroke(i,o)}}function U$(e){return wv(Qp(e))}function Du(e,t){return"translate("+e+","+t+")"}function W$(e){return"rotate("+e+")"}function kee(e,t){return"scale("+e+","+t+")"}function DI(e){return Du(e.x||0,e.y||0)}function $ee(e){return Du(e.x||0,e.y||0)+(e.angle?" "+W$(e.angle):"")}function Cee(e){return Du(e.x||0,e.y||0)+(e.angle?" "+W$(e.angle):"")+(e.scaleX||e.scaleY?" "+kee(e.scaleX||1,e.scaleY||1):"")}function q$(e,t,n){function r(s,a){s("transform",$ee(a)),s("d",t(null,a))}function i(s,a){return t(Xp(s,a.angle),a),gs(s,a).translate(a.x||0,a.y||0)}function o(s,a){var u=a.x||0,l=a.y||0,c=a.angle||0;s.translate(u,l),c&&s.rotate(c*=ba),s.beginPath(),t(s,a),c&&s.rotate(-c),s.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:B$(o),pick:U$(o),isect:n||z$(o)}}var Aee=q$("arc",dee);function Tee(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,o=1/0,s,a;--i>=0;)e[i].defined!==!1&&(a=Math.abs(e[i][r]-n),a<o&&(o=a,s=e[i]));return s}function Fee(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,o,s;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],o=e[r].y-t[1],s=i*i+o*o,s<n))return e[r];return null}function Mee(e,t){for(var n=e.length,r,i,o;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],o=r*r+i*i,r=e[n].size||1,o<r*r))return e[n];return null}function H$(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(Xp(u),c),gs(u,c[0]))}function o(u,l){u.beginPath(),t(u,l)}const s=Qp(o);function a(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,s(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:_ee(o),pick:a,isect:I$,tip:n}}var Oee=H$("area",hee,Tee);function Nee(e,t){var n=t.clip;e.save(),pe(n)?(e.beginPath(),n(e),e.clip()):RI(e,t.group)}function RI(e,t){e.beginPath(),R$(t)?Pf(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function PI(e){const t=ni(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Dee(e,t){e("transform",DI(t))}function LI(e,t){const n=PI(t);e("d",Pf(null,t,n,n))}function Ree(e,t){e("class","background"),e("aria-hidden",!0),LI(e,t)}function Pee(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?LI(e,t):e("d","")}function Lee(e,t,n){const r=t.clip?P$(n,t,t):null;e("clip-path",r)}function zee(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),gs(e,t),e.translate(t.x||0,t.y||0)}function rp(e,t,n,r){const i=PI(t);e.beginPath(),Pf(e,t,(n||0)+i,(r||0)+i)}const Iee=Qp(rp),jee=Qp(rp,!1),Bee=Qp(rp,!0);function Uee(e,t,n){Ti(t,r=>{const i=r.x||0,o=r.y||0,s=r.strokeForeground,a=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&a&&(rp(e,r,i,o),Jc(e,r),r.fill&&i1(e,r,a)&&e.fill(),r.stroke&&!s&&Zc(e,r,a)&&e.stroke()),e.save(),e.translate(i,o),r.clip&&RI(e,r),n&&n.translate(-i,-o),Ti(r,u=>{this.draw(e,u,n)}),n&&n.translate(i,o),e.restore(),s&&r.stroke&&a&&(rp(e,r,i,o),Jc(e,r),Zc(e,r,a)&&e.stroke())})}function Wee(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const s=n*e.pixelRatio,a=r*e.pixelRatio;return o1(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,o))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(i<c||i>h||o<f||o>p))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,g&&R$(u)&&!Bee(e,u,s,a))return e.restore(),null;const y=u.strokeForeground,m=t.interactive!==!1;return m&&y&&u.stroke&&jee(e,u,s,a)?(e.restore(),u):(l=o1(u,v=>qee(v,c,f)?this.pick(v,n,r,c,f):null),!l&&m&&(u.fill||!y&&u.stroke)&&Iee(e,u,s,a)&&(l=u),e.restore(),l||null)})}function qee(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Hee={type:"group",tag:"g",nested:!1,attr:Dee,bound:zee,draw:Uee,pick:Wee,isect:FI,content:Lee,background:Ree,foreground:Pee},ip={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function V$(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function G$(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Y$(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function Ev(e,t){return e==="center"?t/2:e==="right"?t:0}function Sv(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function Vee(e,t,n){const r=V$(t,n),i=G$(t,r),o=Y$(t,r),s=(t.x||0)-Ev(t.align,i),a=(t.y||0)-Sv(t.baseline,o),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,ip["xmlns:xlink"],"xlink:href"),e("transform",Du(s,a)),e("width",i),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function Gee(e,t){const n=t.image,r=G$(t,n),i=Y$(t,n),o=(t.x||0)-Ev(t.align,r),s=(t.y||0)-Sv(t.baseline,i);return e.set(o,s,o+r,s+i)}function Yee(e,t,n){Ti(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=V$(r,this);let o=G$(r,i),s=Y$(r,i);if(o===0||s===0)return;let a=(r.x||0)-Ev(r.align,o),u=(r.y||0)-Sv(r.baseline,s),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,u+=(s-d)/2,s=d):(d=s*c,a+=(o-d)/2,o=d))),(i.complete||i.toDataURL)&&(Jc(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,a,u,o,s))})}var Xee={type:"image",tag:"image",nested:!1,attr:Vee,bound:Gee,draw:Yee,pick:wv(),isect:qr,get:V$,xOffset:Ev,yOffset:Sv},Qee=H$("line",pee,Fee);function Kee(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",Cee(t)),e("d",t.path)}function Ym(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*ba,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Kc(n)).path=n),a&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(a),np(e,u,0,0,o,s),e.rotate(-a),e.translate(-r,-i)):np(e,u,r,i,o,s)}function Jee(e,t){return Ym(Xp(e,t.angle),t)?e.set(0,0,0,0):gs(e,t,!0)}var Zee={type:"path",tag:"path",nested:!1,attr:Kee,bound:Jee,draw:B$(Ym),pick:U$(Ym),isect:z$(Ym)};function ete(e,t){e("d",Pf(null,t))}function tte(e,t){var n,r;return gs(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function ZM(e,t){e.beginPath(),Pf(e,t)}var nte={type:"rect",tag:"path",nested:!1,attr:ete,bound:tte,draw:B$(ZM),pick:U$(ZM),isect:FI};function rte(e,t){e("transform",DI(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function ite(e,t){var n,r;return gs(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function zI(e,t,n){var r,i,o,s;return t.stroke&&Zc(e,t,n)?(r=t.x||0,i=t.y||0,o=t.x2!=null?t.x2:r,s=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,s),!0):!1}function ote(e,t,n){Ti(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&zI(e,r,i)&&(Jc(e,r),e.stroke())}})}function ste(e,t,n,r){return e.isPointInStroke?zI(e,t,1)&&e.isPointInStroke(n,r):!1}var ate={type:"rule",tag:"line",nested:!1,attr:rte,bound:ite,draw:ote,pick:wv(ste),isect:MI},ute=q$("shape",gee),lte=q$("symbol",mee,I$);const eO=V4();var Ei={height:wo,measureWidth:X$,estimateWidth:dE,width:dE,canvas:II};II(!0);function II(e){Ei.width=e&&fa?X$:dE}function dE(e,t){return jI(Ea(e,t),wo(e))}function jI(e,t){return~~(.8*e.length*t)}function X$(e,t){return wo(e)<=0||!(t=Ea(e,t))?0:BI(t,_v(e))}function BI(e,t){const n=`(${t}) ${e}`;let r=eO.get(n);return r===void 0&&(fa.font=t,r=fa.measureText(e).width,eO.set(n,r)),r}function wo(e){return e.fontSize!=null?+e.fontSize||0:11}function wa(e){return e.lineHeight!=null?e.lineHeight:wo(e)+2}function cte(e){return I(e)?e.length>1?e:e[0]:e}function Kp(e){return cte(e.lineBreak&&e.text&&!I(e.text)?e.text.split(e.lineBreak):e.text)}function Q$(e){const t=Kp(e);return(I(t)?t.length-1:0)*wa(e)}function Ea(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?dte(e,n):n}function fte(e){if(Ei.width===X$){const t=_v(e);return n=>BI(n,t)}else{const t=wo(e);return n=>jI(n,t)}}function dte(e,t){var n=+e.limit,r=fte(e);if(r(t)<n)return t;var i=e.ellipsis||"…",o=e.dir==="rtl",s=0,a=t.length,u;if(n-=r(i),o){for(;s<a;)u=s+a>>>1,r(t.slice(u))>n?s=u+1:a=u;return i+t.slice(s)}else{for(;s<a;)u=1+(s+a>>>1),r(t.slice(0,u))<n?s=u:a=u-1;return t.slice(0,s)+i}}function Jp(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function _v(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+wo(e)+"px "+Jp(e,t)}function K$(e){var t=e.baseline,n=wo(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*wa(e):t==="line-bottom"?.29*n-.5*wa(e):0)}const hte={left:"start",center:"middle",right:"end"},gh=new gt;function kv(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-gu,t+=r*Math.cos(i),n+=r*Math.sin(i)),gh.x1=t,gh.y1=n,gh}function pte(e,t){var n=t.dx||0,r=(t.dy||0)+K$(t),i=kv(t),o=i.x1,s=i.y1,a=t.angle||0,u;e("text-anchor",hte[t.align]||"start"),a?(u=Du(o,s)+" "+W$(a),(n||r)&&(u+=" "+Du(n,r))):u=Du(o+n,s+r),e("transform",u)}function J$(e,t,n){var r=Ei.height(t),i=t.align,o=kv(t),s=o.x1,a=o.y1,u=t.dx||0,l=(t.dy||0)+K$(t)-Math.round(.8*r),c=Kp(t),f;if(I(c)?(r+=wa(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Ei.width(t,h)),0)):f=Ei.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=s,l+=a,u+f,l+r),t.angle&&!n)e.rotate(t.angle*ba,s,a);else if(n===2)return e.rotatedPoints(t.angle*ba,s,a);return e}function gte(e,t,n){Ti(t,r=>{var i=r.opacity==null?1:r.opacity,o,s,a,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=_v(r),e.textAlign=r.align||"left",o=kv(r),s=o.x1,a=o.y1,r.angle&&(e.save(),e.translate(s,a),e.rotate(r.angle*ba),s=a=0),s+=r.dx||0,a+=(r.dy||0)+K$(r),c=Kp(r),Jc(e,r),I(c))for(l=wa(r),u=0;u<c.length;++u)f=Ea(r,c[u]),r.fill&&i1(e,r,i)&&e.fillText(f,s,a),r.stroke&&Zc(e,r,i)&&e.strokeText(f,s,a),a+=l;else f=Ea(r,c),r.fill&&i1(e,r,i)&&e.fillText(f,s,a),r.stroke&&Zc(e,r,i)&&e.strokeText(f,s,a);r.angle&&e.restore()}})}function mte(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=kv(t),a=s.x1,u=s.y1,l=J$(gh,t,1),c=-t.angle*ba,f=Math.cos(c),d=Math.sin(c),h=f*i-d*o+(a-f*a+d*u),p=d*i+f*o+(u-d*a-f*u);return l.contains(h,p)}function yte(e,t){const n=J$(gh,e,2);return cc(t,n[0],n[1],n[2],n[3])||cc(t,n[0],n[1],n[4],n[5])||cc(t,n[4],n[5],n[6],n[7])||cc(t,n[2],n[3],n[6],n[7])}var vte={type:"text",tag:"text",nested:!1,attr:pte,bound:J$,draw:gte,pick:wv(mte),isect:yte},xte=H$("trail",yee,Mee),kr={arc:Aee,area:Oee,group:Hee,image:Xee,line:Qee,path:Zee,rect:nte,rule:ate,shape:ute,symbol:lte,text:vte,trail:xte};function hE(e,t,n){var r=kr[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new gt),e,n)}var tO={mark:null};function UI(e,t,n){var r=kr[e.marktype],i=r.bound,o=e.items,s=o&&o.length,a,u,l,c;if(r.nested)return s?l=o[0]:(tO.mark=e,l=tO),c=hE(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new gt,s)for(a=0,u=o.length;a<u;++a)t.union(hE(o[a],i,n));return e.bounds=t}const bte=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function WI(e,t){return JSON.stringify(e,bte,t)}function qI(e){const t=typeof e=="string"?JSON.parse(e):e;return HI(t)}function HI(e){var t=e.marktype,n=e.items,r,i,o;if(n)for(i=0,o=n.length;i<o;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&HI(n[i]);return t&&UI(e),e}function Z$(e){arguments.length?this.root=qI(e):(this.root=VI({marktype:"group",name:"root",role:"frame"}),this.root.items=[new xv(this.root)])}Z$.prototype={toJSON(e){return WI(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=VI(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function VI(e,t){const n={bounds:new gt,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function qs(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function eC(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Hn(e,t,n,r){var i=e.childNodes[t],o;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(o=i||null,i=qs(e.ownerDocument,n,r),e.insertBefore(i,o)),i}function hi(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function GI(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function $v(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function wte(e,t,n,r){var i=e&&e.mark,o,s;if(i&&(o=kr[i.marktype]).tip){for(s=$v(t,n),s[0]-=r[0],s[1]-=r[1];e=e.mark.group;)s[0]-=e.x||0,s[1]-=e.y||0;e=o.tip(i.items,s)}return e}function Sa(e,t){this._active=null,this._handlers={},this._loader=e||Hy(),this._tooltip=t||Ete}function Ete(e,t,n,r){e.element().setAttribute("title",r||"")}Sa.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),o=qs(null,"a");for(const s in r)o.setAttribute(s,r[s]);o.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=wte(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),s=i.height();let a=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,u+=e.y||0;return{x:a,y:u,width:o,height:s,left:a,top:u,right:a+o,bottom:u+s}}};function Eo(e){this._el=null,this._bgcolor=null,this._loader=new L$(e)}Eo.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(o=>{o&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const Ste="keydown",_te="keypress",kte="keyup",YI="dragenter",Xm="dragleave",XI="dragover",pE="mousedown",$te="mouseup",s1="mousemove",mh="mouseout",QI="mouseover",a1="click",Cte="dblclick",Ate="wheel",KI="mousewheel",u1="touchstart",l1="touchmove",c1="touchend",Tte=[Ste,_te,kte,YI,Xm,XI,pE,$te,s1,mh,QI,a1,Cte,Ate,KI,u1,l1,c1],gE=s1,op=mh,mE=a1;function Zp(e,t){Sa.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const Fte=e=>e===u1||e===l1||e===c1?[u1,l1,c1]:[e];function nO(e,t){Fte(t).forEach(n=>Mte(e,n))}function Mte(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function rO(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=o,this.fire(t,r),this.fire(e,r))}}function iO(e){return function(t){this.fire(e,t),this._active=null}}G(Zp,Sa,{initialize(e,t,n){return this._canvas=e&&eC(e,"canvas"),[a1,pE,s1,mh,Xm].forEach(r=>nO(this,r)),Sa.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Tte,DOMMouseScroll(e){this.fire(KI,e)},mousemove:rO(s1,QI,mh),dragover:rO(XI,YI,Xm),mouseout:iO(mh),dragleave:iO(Xm),mousedown(e){this._down=this._active,this.fire(pE,e)},click(e){this._down===this._active&&(this.fire(a1,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(u1,e,!0)},touchmove(e){this.fire(l1,e,!0)},touchend(e){this.fire(c1,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===mE&&r&&r.href?this.handleHref(t,r,r.href):(e===gE||e===op)&&this.handleTooltip(t,r,e!==op),i)for(let o=0,s=i.length;o<s;++o)i[o].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(nO(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=$v(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const o=this.context();return kr[e.marktype].pick.call(this,o,e,t,n,r,i)}});function Ote(){return typeof window<"u"&&window.devicePixelRatio||1}var Nte=Ote();function Dte(e,t,n,r,i,o){const s=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=s?Nte:i;e.width=t*u,e.height=n*u;for(const l in o)a[l]=o[l];return s&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*r[0],u*r[1]),e}function f1(e){Eo.call(this,e),this._options={},this._redraw=!1,this._dirty=new gt,this._tempb=new gt}const oO=Eo.prototype,Rte=(e,t,n)=>new gt().set(0,0,t,n).translate(-e[0],-e[1]);function Pte(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}G(f1,Eo,{initialize(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:ca(1,1,this._options.type),e&&this._canvas&&(hi(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),oO.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(oO.resize.call(this,e,t,n,r),this._canvas)Dte(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||z("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,s=Rte(n,r,i);t.save();const a=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):Pte(t,s.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,a),t.restore(),o.clear(),this},draw(e,t,n){const r=kr[t.marktype];t.clip&&Nee(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,o=this.context();i.type!=="pdf"&&!i.externalContext&&o.clearRect(e,t,n,r),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});function tC(e,t){Sa.call(this,e,t);const n=this;n._hrefHandler=yE(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=yE(n,(r,i)=>{n.handleTooltip(r,i,r.type!==op)})}const yE=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};G(tC,Sa,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(mE,this._hrefHandler),r.removeEventListener(gE,this._tooltipHandler),r.removeEventListener(op,this._tooltipHandler)),this._svg=r=e&&eC(e,"svg"),r&&(r.addEventListener(mE,this._hrefHandler),r.addEventListener(gE,this._tooltipHandler),r.addEventListener(op,this._tooltipHandler)),Sa.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const o={type:e,handler:t,listener:yE(this,t)};(r[n]||(r[n]=[])).push(o),this._svg&&this._svg.addEventListener(n,o.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const JI="aria-hidden",nC="aria-label",rC="role",iC="aria-roledescription",ZI="graphics-object",oC="graphics-symbol",e8=(e,t,n)=>({[rC]:e,[iC]:t,[nC]:n||void 0}),Lte=Ci(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),sO={axis:{desc:"axis",caption:jte},legend:{desc:"legend",caption:Bte},"title-text":{desc:"title",caption:e=>`Title text '${uO(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${uO(e)}'`}},aO={ariaRole:rC,ariaRoleDescription:iC,description:nC};function t8(e,t){const n=t.aria===!1;if(e(JI,n||void 0),n||t.description==null)for(const r in aO)e(aO[r],void 0);else{const r=t.mark.marktype;e(nC,t.description),e(rC,t.ariaRole||(r==="group"?ZI:oC)),e(iC,t.ariaRoleDescription||`${r} mark`)}}function n8(e){return e.aria===!1?{[JI]:!0}:Lte[e.role]?null:sO[e.role]?Ite(e,sO[e.role]):zte(e)}function zte(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return e8(n?ZI:oC,`${t} mark container`,e.description)}function Ite(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return e8(t.role||oC,t.desc,n.description||r(n))}catch{return null}}function uO(e){return K(e.text).join(" ")}function jte(e){const t=e.datum,n=e.orient,r=t.title?r8(e):null,i=e.context,o=i.scales[t.scale].value,s=i.dataflow.locale(),a=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Qc(a)?"discrete":a} scale with ${bI(s,o,e)}`}function Bte(e){const t=e.datum,n=t.title?r8(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),s=e.context,a=s.scales[i[o[0]]].value,u=s.dataflow.locale();return Wte(r)+(n?` titled '${n}'`:"")+` for ${Ute(o)} with ${bI(u,a,e)}`}function r8(e){try{return K(_e(e.items).items[0].text).join(" ")}catch{return null}}function Ute(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+_e(e)}function Wte(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const i8=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),qte=e=>i8(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function sC(){let e="",t="",n="";const r=[],i=()=>t=n="",o=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},s=(u,l)=>(l!=null&&(t+=` ${u}="${qte(l)}"`),a),a={open(u){o(u),t="<"+u;for(var l=arguments.length,c=new Array(l>1?l-1:0),f=1;f<l;f++)c[f-1]=arguments[f];for(const d of c)for(const h in d)s(h,d[h]);return a},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),a},attr:s,text:u=>(n+=i8(u),a),toString:()=>e};return a}const o8=e=>s8(sC(),e)+"";function s8(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const r of n)r.nodeType===3?e.text(r.nodeValue):s8(e,r)}return e.close()}const d1={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},h1={blend:"mix-blend-mode"},a8={fill:"none","stroke-miterlimit":10},pd=0,lO="http://www.w3.org/2000/xmlns/",xt=ip.xmlns;function aC(e){Eo.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const R2=Eo.prototype;G(aC,Eo,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Hn(e,0,"svg",xt),this._svg.setAttributeNS(lO,"xmlns",xt),this._svg.setAttributeNS(lO,"xmlns:xlink",ip["xmlns:xlink"]),this._svg.setAttribute("version",ip.version),this._svg.setAttribute("class","marks"),hi(e,1),this._root=Hn(this._svg,pd,"g",xt),Hs(this._root,a8),hi(this._svg,pd+1)),this.background(this._bgcolor),R2.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),R2.background.apply(this,arguments)},resize(e,t,n,r){return R2.resize.call(this,e,t,n,r),this._svg&&(Hs(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Hn(e,pd,"rect",xt),Hs(n,{width:this._width,height:this._height,fill:t}));const r=o8(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),hi(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,o,s,a,u;for(s=0,a=e.length;s<a;++s)if(n=e[s],r=n.mark,r.marktype!==i&&(i=r.marktype,o=kr[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,cO(n,t),r.items.forEach(l=>{l.dirty=t})),!r.zdirty){if(n.exit){o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=o.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,cO(n,t)):this._update(o,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=kr[t.marktype],o=t.interactive===!1?"none":null,s=i.tag==="g",a=fO(t,e,n,"g",r);a.setAttribute("class",GI(t));const u=n8(t);for(const d in u)En(a,d,u[d]);s||En(a,"pointer-events",o),En(a,"clip-path",t.clip?P$(this,t,t.group):null);let l=null,c=0;const f=d=>{const h=this.isDirty(d),p=fO(d,a,l,i.tag,r);h&&(this._update(i,p,d),s&&Gte(this,p,d)),l=p,++c};return i.nested?t.items.length&&f(t.items[0]):Ti(t,f),hi(a,c),a},_update(e,t,n){Xo=t,sn=t.__values__,t8(yh,n),e.attr(yh,n,this);const r=Xte[e.type];r&&r.call(this,e,t,n),Xo&&this.style(Xo,n)},style(e,t){if(t!=null){for(const n in d1){let r=n==="font"?Jp(t):t[n];if(r===sn[n])continue;const i=d1[n];r==null?e.removeAttribute(i):(N$(r)&&(r=EI(r,this._defs.gradient,u8())),e.setAttribute(i,r+"")),sn[n]=r}for(const n in h1)Qm(e,h1[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Hn(e,pd+1,"defs",xt)),r=Hte(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Hn(e,pd+1,"defs",xt)),r=Vte(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):hi(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function cO(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function Hte(e,t,n){let r,i,o;if(t.gradient==="radial"){let s=Hn(e,n++,"pattern",xt);Hs(s,{id:r1+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),s=Hn(s,0,"rect",xt),Hs(s,{width:1,height:1,fill:`url(${u8()}#${t.id})`}),e=Hn(e,n++,"radialGradient",xt),Hs(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Hn(e,n++,"linearGradient",xt),Hs(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=Hn(e,r,"stop",xt),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return hi(e,r),n}function Vte(e,t,n){let r;return e=Hn(e,n,"clipPath",xt),e.setAttribute("id",t.id),t.path?(r=Hn(e,0,"path",xt),r.setAttribute("d",t.path)):(r=Hn(e,0,"rect",xt),Hs(r,{x:0,y:0,width:t.width,height:t.height})),hi(e,1),n+1}function Gte(e,t,n){t=t.lastChild.previousSibling;let r,i=0;Ti(n,o=>{r=e.mark(t,o,r),++i}),hi(t,1+i)}function fO(e,t,n,r,i){let o=e._svg,s;if(!o&&(s=t.ownerDocument,o=qs(s,r,xt),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},r==="g"))){const a=qs(s,"path",xt);o.appendChild(a),a.__data__=e;const u=qs(s,"g",xt);o.appendChild(u),u.__data__=e;const l=qs(s,"path",xt);o.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(o.ownerSVGElement!==i||Yte(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function Yte(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Xo=null,sn=null;const Xte={group(e,t,n){const r=Xo=t.childNodes[2];sn=r.__values__,e.foreground(yh,n,this),sn=t.__values__,Xo=t.childNodes[1],e.content(yh,n,this);const i=Xo=t.childNodes[0];e.background(yh,n,this);const o=n.mark.interactive===!1?"none":null;if(o!==sn.events&&(En(r,"pointer-events",o),En(i,"pointer-events",o),sn.events=o),n.strokeForeground&&n.stroke){const s=n.fill;En(r,"display",null),this.style(i,n),En(i,"stroke",null),s&&(n.fill=null),sn=r.__values__,this.style(r,n),s&&(n.fill=s),Xo=null}else En(r,"display","none")},image(e,t,n){n.smooth===!1?(Qm(t,"image-rendering","optimizeSpeed"),Qm(t,"image-rendering","pixelated")):Qm(t,"image-rendering",null)},text(e,t,n){const r=Kp(n);let i,o,s,a;I(r)?(o=r.map(u=>Ea(n,u)),i=o.join(`
`),i!==sn.text&&(hi(t,0),s=t.ownerDocument,a=wa(n),o.forEach((u,l)=>{const c=qs(s,"tspan",xt);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),sn.text=i)):(o=Ea(n,r),o!==sn.text&&(t.textContent=o,sn.text=o)),En(t,"font-family",Jp(n)),En(t,"font-size",wo(n)+"px"),En(t,"font-style",n.fontStyle),En(t,"font-variant",n.fontVariant),En(t,"font-weight",n.fontWeight)}};function yh(e,t,n){t!==sn[e]&&(n?Qte(Xo,e,t,n):En(Xo,e,t),sn[e]=t)}function Qm(e,t,n){n!==sn[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),sn[t]=n)}function Hs(e,t){for(const n in t)En(e,n,t[n])}function En(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Qte(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function u8(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function uC(e){Eo.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}G(uC,Eo,{svg(){return this._text},_render(e){const t=sC();t.open("svg",he({},ip,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",a8,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=kr[t.marktype],r=n.tag,i=[t8,n.attr];e.open("g",{class:GI(t),"clip-path":t.clip?P$(this,t,t.group):null},n8(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const o=s=>{const a=this.href(s);if(a&&e.open("a",a),e.open(r,this.attr(t,s,i,r!=="g"?r:null)),r==="text"){const u=Kp(s);if(I(u)){const l={x:0,dy:wa(s)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(Ea(s,u[c])).close()}else e.text(Ea(s,u))}else if(r==="g"){const u=s.strokeForeground,l=s.fill,c=s.stroke;u&&c&&(s.stroke=null),e.open("path",this.attr(t,s,n.background,"bgrect")).close(),e.open("g",this.attr(t,s,n.content)),Ti(s,f=>this.mark(e,f)),e.close(),u&&c?(l&&(s.fill=null),s.stroke=c,e.open("path",this.attr(t,s,n.foreground,"bgrect")).close(),l&&(s.fill=l)):e.open("path",this.attr(t,s,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):Ti(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},o=(s,a,u,l)=>{i[l||s]=a};return Array.isArray(n)?n.forEach(s=>s(o,t,this)):n(o,t,this),r&&Kte(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const o=t[i],s=o.stops;o.gradient==="radial"?(e.open("pattern",{id:r1+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):e.open("linearGradient",{id:i,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let a=0;a<s.length;++a)e.open("stop",{offset:s[a].offset,"stop-color":s[a].color}).close();e.close()}for(const i in n){const o=n[i];e.open("clipPath",{id:i}),o.path?e.open("path",{d:o.path}).close():e.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),e.close()}e.close()}}});function Kte(e,t,n,r,i){let o;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=Jp(t),e["font-size"]=wo(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const s in d1){let a=t[s];const u=d1[s];a==="transparent"&&(u==="fill"||u==="stroke")||a!=null&&(N$(a)&&(a=EI(a,i.gradient,"")),e[u]=a)}for(const s in h1){const a=t[s];a!=null&&(o=o||[],o.push(`${h1[s]}: ${a};`))}return o&&(e.style=o.join(" ")),e}const l8="canvas",c8="png",f8="svg",d8="none",Vs={Canvas:l8,PNG:c8,SVG:f8,None:d8},ef={};ef[l8]=ef[c8]={renderer:f1,headless:f1,handler:Zp};ef[f8]={renderer:aC,headless:uC,handler:tC};ef[d8]={};function Cv(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(ef[e]=t,this):ef[e]}function h8(e,t,n){const r=[],i=new gt().union(t),o=e.marktype;return o?p8(e,i,n,r):o==="group"?g8(e,i,n,r):z("Intersect scene must be mark node or group item.")}function p8(e,t,n,r){if(Jte(e,t,n)){const i=e.items,o=e.marktype,s=i.length;let a=0;if(o==="group")for(;a<s;++a)g8(i[a],t,n,r);else for(const u=kr[o].isect;a<s;++a){const l=i[a];m8(l,t,u)&&r.push(l)}}return r}function Jte(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function g8(e,t,n,r){n&&n(e.mark)&&m8(e,t,kr.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const s=e.x||0,a=e.y||0;t.translate(-s,-a);for(let u=0;u<o;++u)p8(i[u],t,n,r);t.translate(s,a)}return r}function m8(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const P2=new gt;function y8(e){const t=e.clip;if(pe(t))t(Xp(P2.clear()));else if(t)P2.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(P2)}const Zte=1e-9;function lC(e,t,n){return e===t?!0:n==="path"?v8(e,t):e instanceof Date&&t instanceof Date?+e==+t:je(e)&&je(t)?Math.abs(e-t)<=Zte:!e||!t||!J(e)&&!J(t)?e==t:ene(e,t)}function v8(e,t){return lC(Kc(e),Kc(t))}function ene(e,t){var n=Object.keys(e),r=Object.keys(t),i,o;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),o=n.length-1;o>=0;o--)if(n[o]!=r[o])return!1;for(o=n.length-1;o>=0;o--)if(i=n[o],!lC(e[i],t[i],i))return!1;return typeof e==typeof t}function tne(){TI(),$Z()}const tf="top",pi="left",mi="right",_a="bottom",nne="top-left",rne="top-right",ine="bottom-left",one="bottom-right",cC="start",vE="middle",_n="end",sne="x",ane="y",Av="group",fC="axis",dC="title",une="frame",lne="scope",hC="legend",x8="row-header",b8="row-footer",w8="row-title",E8="column-header",S8="column-footer",_8="column-title",cne="padding",fne="symbol",k8="fit",$8="fit-x",C8="fit-y",dne="pad",pC="none",Jg="all",xE="each",gC="flush",Gs="column",Ys="row";function A8(e){P.call(this,null,e)}G(A8,P,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=kr[i],s=o.bound;let a=r.bounds,u;if(o.nested)r.items.length&&n.dirty(r.items[0]),a=Zg(r,s),r.items.forEach(l=>{l.bounds.clear().union(a)});else if(i===Av||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),r.items.forEach(l=>a.union(Zg(l,s))),r.role){case fC:case hC:case dC:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(Zg(l,s))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(Zg(l,s))}),u&&(a.clear(),r.items.forEach(l=>a.union(l.bounds)));return y8(r),t.modifies("bounds")}});function Zg(e,t,n){return t(e.bounds.clear(),e,n)}const dO=":vega_identifier:";function mC(e){P.call(this,0,e)}mC.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};G(mC,P,{transform(e,t){const n=hne(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,o=>o[r]=o[r]||++i),n.set(this.value=i),t}});function hne(e){return e._signals[dO]||(e._signals[dO]=e.add(0))}function T8(e){P.call(this,null,e)}G(T8,P,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,pne(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===Av?xv:vv;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function pne(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function F8(e){P.call(this,null,e)}const hO={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!M8(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},M8=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),pO=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,o;n<r;i=o,++n)if(M8(i,o=e[n].bounds,t))return!0},gne=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},mne=(e,t,n)=>{var r=e.range(),i=new gt;return t===tf||t===_a?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),o=>i.encloses(o.bounds)},gO=e=>(e.forEach(t=>t.opacity=1),e),mO=(e,t)=>e.reflow(t.modified()).modifies("opacity");G(F8,P,{transform(e,t){const n=hO[e.method]||hO.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,o,s;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(gO(i),t=mO(t,e)),t;if(i=i.filter(gne),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),o=gO(i),t=mO(t,e),o.length>=3&&pO(o,r)){do o=n(o,r);while(o.length>=3&&pO(o,r));o.length<3&&!_e(i).opacity&&(o.length>1&&(_e(o).opacity=0),_e(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(s=mne(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{s(u)||(u.opacity=0)}));const a=o[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function O8(e){P.call(this,null,e)}G(O8,P,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const on=new gt;function fc(e,t,n){return e[t]===n?0:(e[t]=n,1)}function yne(e){var t=e.items[0].orient;return t===pi||t===mi}function vne(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function xne(e,t,n,r){var i=t.items[0],o=i.datum,s=i.translate!=null?i.translate:.5,a=i.orient,u=vne(o),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=o.title&&i.items[u[2]].items[0],g=i.titlePadding,y=i.bounds,m=p&&Q$(p),v=0,x=0,b,w;switch(on.clear().union(y),y.clear(),(b=u[0])>-1&&y.union(i.items[b].bounds),(b=u[1])>-1&&y.union(i.items[b].bounds),a){case tf:v=f||0,x=-c,w=Math.max(d,Math.min(h,-y.y1)),y.add(0,-w).add(l,0),p&&em(e,p,w,g,m,0,-1,y);break;case pi:v=-c,x=f||0,w=Math.max(d,Math.min(h,-y.x1)),y.add(-w,0).add(0,l),p&&em(e,p,w,g,m,1,-1,y);break;case mi:v=n+c,x=f||0,w=Math.max(d,Math.min(h,y.x2)),y.add(0,0).add(w,l),p&&em(e,p,w,g,m,1,1,y);break;case _a:v=f||0,x=r+c,w=Math.max(d,Math.min(h,y.y2)),y.add(0,0).add(l,w),p&&em(e,p,w,g,0,0,1,y);break;default:v=i.x,x=i.y}return gs(y.translate(v,x),i),fc(i,"x",v+s)|fc(i,"y",x+s)&&(i.bounds=on,e.dirty(i),i.bounds=y,e.dirty(i)),i.mark.bounds.clear().union(y)}function em(e,t,n,r,i,o,s,a){const u=t.bounds;if(t.auto){const l=s*(n+i+r);let c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}const yO=(e,t)=>Math.floor(Math.min(e,t)),vO=(e,t)=>Math.ceil(Math.max(e,t));function bne(e){var t=e.items,n=t.length,r=0,i,o;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],o=i.items,i.marktype===Av)switch(i.role){case fC:case hC:case dC:break;case x8:s.rowheaders.push(...o);break;case b8:s.rowfooters.push(...o);break;case E8:s.colheaders.push(...o);break;case S8:s.colfooters.push(...o);break;case w8:s.rowtitle=o[0];break;case _8:s.coltitle=o[0];break;default:s.marks.push(...o)}return s}function wne(e){return new gt().set(0,0,e.width||0,e.height||0)}function Ene(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Je(e,t,n){const r=J(e)?e[t]:e;return r??(n!==void 0?n:0)}function xO(e){return e<0?Math.ceil(-e):0}function N8(e,t,n){var r=!n.nodirty,i=n.bounds===gC?wne:Ene,o=on.set(0,0,0,0),s=Je(n.align,Gs),a=Je(n.align,Ys),u=Je(n.padding,Gs),l=Je(n.padding,Ys),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,y=Array(d),m=Array(f),v=0,x=Array(d),b=Array(d),w=Array(d),S,E,_,$,k,A,R,C,F,T,O;for(E=0;E<c;++E)p[E]=0;for(E=0;E<f;++E)m[E]=0;for(E=0;E<d;++E)A=t[E],k=w[E]=i(A),A.x=A.x||0,x[E]=0,A.y=A.y||0,b[E]=0,_=E%c,$=~~(E/c),g=Math.max(g,R=Math.ceil(k.x2)),v=Math.max(v,C=Math.ceil(k.y2)),p[_]=Math.max(p[_],R),m[$]=Math.max(m[$],C),h[E]=u+xO(k.x1),y[E]=l+xO(k.y1),r&&e.dirty(t[E]);for(E=0;E<d;++E)E%c===0&&(h[E]=0),E<c&&(y[E]=0);if(s===xE)for(_=1;_<c;++_){for(O=0,E=_;E<d;E+=c)O<h[E]&&(O=h[E]);for(E=_;E<d;E+=c)h[E]=O+p[_-1]}else if(s===Jg){for(O=0,E=0;E<d;++E)E%c&&O<h[E]&&(O=h[E]);for(E=0;E<d;++E)E%c&&(h[E]=O+g)}else for(s=!1,_=1;_<c;++_)for(E=_;E<d;E+=c)h[E]+=p[_-1];if(a===xE)for($=1;$<f;++$){for(O=0,E=$*c,S=E+c;E<S;++E)O<y[E]&&(O=y[E]);for(E=$*c;E<S;++E)y[E]=O+m[$-1]}else if(a===Jg){for(O=0,E=c;E<d;++E)O<y[E]&&(O=y[E]);for(E=c;E<d;++E)y[E]=O+v}else for(a=!1,$=1;$<f;++$)for(E=$*c,S=E+c;E<S;++E)y[E]+=m[$-1];for(F=0,E=0;E<d;++E)F=h[E]+(E%c?F:0),x[E]+=F-t[E].x;for(_=0;_<c;++_)for(T=0,E=_;E<d;E+=c)T+=y[E],b[E]+=T-t[E].y;if(s&&Je(n.center,Gs)&&f>1)for(E=0;E<d;++E)k=s===Jg?g:p[E%c],F=k-w[E].x2-t[E].x-x[E],F>0&&(x[E]+=F/2);if(a&&Je(n.center,Ys)&&c!==1)for(E=0;E<d;++E)k=a===Jg?v:m[~~(E/c)],T=k-w[E].y2-t[E].y-b[E],T>0&&(b[E]+=T/2);for(E=0;E<d;++E)o.union(w[E].translate(x[E],b[E]));switch(F=Je(n.anchor,sne),T=Je(n.anchor,ane),Je(n.anchor,Gs)){case _n:F-=o.width();break;case vE:F-=o.width()/2}switch(Je(n.anchor,Ys)){case _n:T-=o.height();break;case vE:T-=o.height()/2}for(F=Math.round(F),T=Math.round(T),o.clear(),E=0;E<d;++E)t[E].mark.bounds.clear();for(E=0;E<d;++E)A=t[E],A.x+=x[E]+=F,A.y+=b[E]+=T,o.union(A.mark.bounds.union(A.bounds.translate(x[E],b[E]))),r&&e.dirty(A);return o}function Sne(e,t,n){var r=bne(t),i=r.marks,o=n.bounds===gC?_ne:kne,s=n.offset,a=n.columns||i.length,u=a<=0?1:Math.ceil(i.length/a),l=u*a,c,f,d,h,p,g,y;const m=N8(e,i,n);m.empty()&&m.set(0,0,0,0),r.rowheaders&&(g=Je(n.headerBand,Ys,null),c=tm(e,r.rowheaders,i,a,u,-Je(s,"rowHeader"),yO,0,o,"x1",0,a,1,g)),r.colheaders&&(g=Je(n.headerBand,Gs,null),f=tm(e,r.colheaders,i,a,a,-Je(s,"columnHeader"),yO,1,o,"y1",0,1,a,g)),r.rowfooters&&(g=Je(n.footerBand,Ys,null),d=tm(e,r.rowfooters,i,a,u,Je(s,"rowFooter"),vO,0,o,"x2",a-1,a,1,g)),r.colfooters&&(g=Je(n.footerBand,Gs,null),h=tm(e,r.colfooters,i,a,a,Je(s,"columnFooter"),vO,1,o,"y2",l-a,1,a,g)),r.rowtitle&&(p=Je(n.titleAnchor,Ys),y=Je(s,"rowTitle"),y=p===_n?d+y:c-y,g=Je(n.titleBand,Ys,.5),bO(e,r.rowtitle,y,0,m,g)),r.coltitle&&(p=Je(n.titleAnchor,Gs),y=Je(s,"columnTitle"),y=p===_n?h+y:f-y,g=Je(n.titleBand,Gs,.5),bO(e,r.coltitle,y,1,m,g))}function _ne(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function kne(e,t){return e.bounds[t]}function tm(e,t,n,r,i,o,s,a,u,l,c,f,d,h){var p=n.length,g=0,y=0,m,v,x,b,w,S,E,_,$;if(!p)return g;for(m=c;m<p;m+=f)n[m]&&(g=s(g,u(n[m],l)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=o,v=0,b=t.length;v<b;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(m=c,v=0,b=t.length;v<b;++v,m+=f){for(S=t[v],w=S.mark.bounds,x=m;x>=0&&(E=n[x])==null;x-=d);a?(_=h==null?E.x:Math.round(E.bounds.x1+h*E.bounds.width()),$=g):(_=g,$=h==null?E.y:Math.round(E.bounds.y1+h*E.bounds.height())),w.union(S.bounds.translate(_-(S.x||0),$-(S.y||0))),S.x=_,S.y=$,e.dirty(S),y=s(y,w[l])}return y}function bO(e,t,n,r,i,o){if(t){e.dirty(t);var s=n,a=n;r?s=Math.round(i.x1+o*i.width()):a=Math.round(i.y1+o*i.height()),t.bounds.translate(s-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=s,t.y=a,e.dirty(t)}}function $ne(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function Cne(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function Ane(e,t,n,r,i,o,s){const a=$ne(n,t),u=Cne(e,a("offset",0)),l=a("anchor",cC),c=l===_n?1:l===vE?.5:0,f={align:xE,bounds:a("bounds",gC),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case pi:f.anchor={x:Math.floor(r.x1)-u,column:_n,y:c*(s||r.height()+2*r.y1),row:l};break;case mi:f.anchor={x:Math.ceil(r.x2)+u,y:c*(s||r.height()+2*r.y1),row:l};break;case tf:f.anchor={y:Math.floor(i.y1)-u,row:_n,x:c*(o||i.width()+2*i.x1),column:l};break;case _a:f.anchor={y:Math.ceil(i.y2)+u,x:c*(o||i.width()+2*i.x1),column:l};break;case nne:f.anchor={x:u,y:u};break;case rne:f.anchor={x:o-u,y:u,column:_n};break;case ine:f.anchor={x:u,y:s-u,row:_n};break;case one:f.anchor={x:o-u,y:s-u,column:_n,row:_n};break}return f}function Tne(e,t){var n=t.items[0],r=n.datum,i=n.orient,o=n.bounds,s=n.x,a=n.y,u,l;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),Mne(e,n,n.items[0].items[0]),o=Fne(n,o),u=2*n.padding,l=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),l=Math.ceil(o.height()+l)),r.type===fne&&One(n.items[0].items[0].items[0].items),i!==pC&&(n.x=s=0,n.y=a=0),n.width=u,n.height=l,gs(o.set(s,a,s+u,a+l),n),n.mark.bounds.clear().union(o),n}function Fne(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function Mne(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(!t.datum.title)(i||o)&&gd(e,n,i,o);else{var s=t.items[1].items[0],a=s.anchor,u=t.titlePadding||0,l=r-s.x,c=r-s.y;switch(s.orient){case pi:i+=Math.ceil(s.bounds.width())+u;break;case mi:case _a:break;default:o+=s.bounds.height()+u}switch((i||o)&&gd(e,n,i,o),s.orient){case pi:c+=Ll(t,n,s,a,1,1);break;case mi:l+=Ll(t,n,s,_n,0,0)+u,c+=Ll(t,n,s,a,1,1);break;case _a:l+=Ll(t,n,s,a,0,0),c+=Ll(t,n,s,_n,-1,0,1)+u;break;default:l+=Ll(t,n,s,a,0,0)}(l||c)&&gd(e,s,l,c),(l=Math.round(s.bounds.x1-r))<0&&(gd(e,n,-l,0),gd(e,s,-l,0))}}function Ll(e,t,n,r,i,o,s){const a=e.datum.type!=="symbol",u=n.datum.vgrad,l=a&&(o||!u)&&!s?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&o?c:0,d=u&&o?0:c,h=i<=0?0:Q$(n);return Math.round(r===cC?f:r===_n?d-h:.5*(c-h))}function gd(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function One(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function Nne(e,t,n,r,i){var o=t.items[0],s=o.frame,a=o.orient,u=o.anchor,l=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],h=a===pi||a===mi?r:n,p=0,g=0,y=0,m=0,v=0,x;if(s!==Av?a===pi?(p=i.y2,h=i.y1):a===mi?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):a===pi&&(p=r,h=0),x=u===cC?p:u===_n?h:(p+h)/2,d&&d.text){switch(a){case tf:case _a:v=f.bounds.height()+c;break;case pi:m=f.bounds.width()+c;break;case mi:m=-f.bounds.width()-c;break}on.clear().union(d.bounds),on.translate(m-(d.x||0),v-(d.y||0)),fc(d,"x",m)|fc(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(on),d.mark.bounds.clear().union(on),e.dirty(d)),on.clear().union(d.bounds)}else on.clear();switch(on.union(f.bounds),a){case tf:g=x,y=i.y1-on.height()-l;break;case pi:g=i.x1-on.width()-l,y=x;break;case mi:g=i.x2+on.width()+l,y=x;break;case _a:g=x,y=i.y2+l;break;default:g=o.x,y=o.y}return fc(o,"x",g)|fc(o,"y",y)&&(on.translate(g,y),e.dirty(o),o.bounds.clear().union(on),t.bounds.clear().union(on),e.dirty(o)),o.bounds}function D8(e){P.call(this,null,e)}G(D8,P,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&Sne(n,r,e.layout),Rne(n,r,e)}),Dne(e.mark.group)?t.reflow():t}});function Dne(e){return e&&e.mark.role!=="legend-entry"}function Rne(e,t,n){var r=t.items,i=Math.max(0,t.width||0),o=Math.max(0,t.height||0),s=new gt().set(0,0,i,o),a=s.clone(),u=s.clone(),l=[],c,f,d,h,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case fC:h=yne(f)?a:u,h.union(xne(e,f,i,o));break;case dC:c=f;break;case hC:l.push(Tne(e,f));break;case une:case lne:case x8:case b8:case w8:case E8:case S8:case _8:a.union(f.bounds),u.union(f.bounds);break;default:s.union(f.bounds)}if(l.length){const y={};l.forEach(m=>{d=m.orient||mi,d!==pC&&(y[d]||(y[d]=[])).push(m)});for(const m in y){const v=y[m];N8(e,v,Ane(v,m,n.legends,a,u,i,o))}l.forEach(m=>{const v=m.bounds;if(v.equals(m._bounds)||(m.bounds=m._bounds,e.dirty(m),m.bounds=v,e.dirty(m)),n.autosize&&(n.autosize.type===k8||n.autosize.type===$8||n.autosize.type===C8))switch(m.orient){case pi:case mi:s.add(v.x1,0).add(v.x2,0);break;case tf:case _a:s.add(0,v.y1).add(0,v.y2)}else s.union(v)})}s.union(a).union(u),c&&s.union(Nne(e,c,i,o,s)),t.clip&&s.set(0,0,t.width||0,t.height||0),Pne(e,t,s,n)}function Pne(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let s=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===cne){const p=e.padding();s-=p.left+p.right,a-=p.top+p.bottom}o===pC?(l=0,f=0,u=s,c=a):o===k8?(u=Math.max(0,s-l-d),c=Math.max(0,a-f-h)):o===$8?(u=Math.max(0,s-l-d),a=c+f+h):o===C8?(s=u+l+d,c=Math.max(0,a-f-h)):o===dne&&(s=u+l+d,a=c+f+h),e._resizeView(s,a,u,c,[l,f],i.resize)}const Lne=Object.freeze(Object.defineProperty({__proto__:null,bound:A8,identifier:mC,mark:T8,overlap:F8,render:O8,viewlayout:D8},Symbol.toStringTag,{value:"Module"}));function R8(e){P.call(this,null,e)}G(R8,P,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,s=e.count==null?e.values?e.values.length:10:e.count,a=M$(o,s,e.minstep),u=e.format||gI(n,o,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?pI(o,e.values,a):O$(o,a);return i&&(r.rem=i),i=l.map((c,f)=>Ne({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(Ne({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function P8(e){P.call(this,null,e)}function zne(){return Ne({})}function Ine(e){const t=Af().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}G(P8,P,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||zne,o=e.key||oe,s=this.value;return I(r.encode)&&(r.encode=null),s&&(e.modified("key")||t.modified(o))&&z("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=Ine(o)),t.visit(t.ADD,a=>{const u=o(a);let l=s.get(u);l?l.exit?(s.empty--,r.add.push(l)):r.mod.push(l):(l=i(a),s.set(u,l),r.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{const u=o(a),l=s.get(u);l&&(l.datum=a,r.mod.push(l))}),t.visit(t.REM,a=>{const u=o(a),l=s.get(u);a===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),r}});function L8(e){P.call(this,null,e)}G(L8,P,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(I(o))if(n.changed()||o.every(f=>i[f]))o=o[0],n.encode=null;else return t.StopPropagation;var s=o==="enter",a=i.update||Cs,u=i.enter||Cs,l=i.exit||Cs,c=(o&&!s?i[o]:a)||Cs;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==Cs&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Cs&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),s||c!==Cs){const f=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function z8(e){P.call(this,[],e)}G(z8,P,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.type||Wm,s=e.scale,a=+e.limit,u=M$(s,e.count==null?5:e.count,e.minstep),l=!!e.values||o===Wm,c=e.format||xI(n,s,u,o,e.formatSpecifier,e.formatType,l),f=e.values||vI(s,u),d,h,p,g,y;return i&&(r.rem=i),o===Wm?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,a-1),y=!0):i=f,pe(p=e.size)?(!e.values&&s(i[0])===0&&(i=i.slice(1)),g=i.reduce((m,v)=>Math.max(m,p(v,e)),0)):p=vn(g=p||8),i=i.map((m,v)=>Ne({index:v,label:c(m,v,i),value:m,offset:g,size:p(m,e)})),y&&(y=f[i.length],i.push(Ne({index:i.length,label:`…${f.length-i.length} entries`,value:y,offset:g,size:p(y,e)})))):o===hZ?(d=s.domain(),h=fI(s,d[0],_e(d)),f.length<3&&!e.values&&d[0]!==_e(d)&&(f=[d[0],_e(d)]),i=f.map((m,v)=>Ne({index:v,label:c(m,v,f),value:m,perc:h(m)}))):(p=f.length-1,h=_Z(s),i=f.map((m,v)=>Ne({index:v,label:c(m,v,f),value:m,perc:v?h(m):0,perc2:v===p?1:h(f[v+1])}))),r.source=i,r.add=i,this.value=i,r}});const jne=e=>e.source.x,Bne=e=>e.source.y,Une=e=>e.target.x,Wne=e=>e.target.y;function yC(e){P.call(this,{},e)}yC.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};G(yC,P,{transform(e,t){var n=e.sourceX||jne,r=e.sourceY||Bne,i=e.targetX||Une,o=e.targetY||Wne,s=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=wO.get(u+"-"+a)||wO.get(u);return l||z("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[s]=l(n(c),r(c),i(c),o(c))}),t.reflow(e.modified()).modifies(s)}});const I8=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,qne=(e,t,n,r)=>I8(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),j8=(e,t,n,r)=>{var i=n-e,o=r-t,s=Math.hypot(i,o)/2,a=180*Math.atan2(o,i)/Math.PI;return"M"+e+","+t+"A"+s+","+s+" "+a+" 0 1 "+n+","+r},Hne=(e,t,n,r)=>j8(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),B8=(e,t,n,r)=>{const i=n-e,o=r-t,s=.2*(i+o),a=.2*(o-i);return"M"+e+","+t+"C"+(e+s)+","+(t+a)+" "+(n+a)+","+(r-s)+" "+n+","+r},Vne=(e,t,n,r)=>B8(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Gne=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,Yne=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,Xne=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*s+","+t*a+"L"+r*s+","+r*a},Qne=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},Kne=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},Jne=(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*o+"C"+u*i+","+u*o+" "+u*s+","+u*a+" "+r*s+","+r*a},wO=Af({line:I8,"line-radial":qne,arc:j8,"arc-radial":Hne,curve:B8,"curve-radial":Vne,"orthogonal-horizontal":Gne,"orthogonal-vertical":Yne,"orthogonal-radial":Xne,"diagonal-horizontal":Qne,"diagonal-vertical":Kne,"diagonal-radial":Jne});function vC(e){P.call(this,null,e)}vC.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};G(vC,P,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],o=e.field||kf,s=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(o),c=l.length,f=s,d=(a-s)/uL(l),h=xr(c),p,g,y;for(e.sort&&h.sort((m,v)=>l[m]-l[v]),p=0;p<c;++p)y=l[h[p]],g=u[h[p]],g[r]=f,g[i]=f+=y*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const Zne=5;function ere(e){const t=e.type;return!e.bins&&(t===Yc||t===Up||t===Wp)}function U8(e){return A$(e)&&e!==oo}const tre=Ci(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function W8(e){P.call(this,null,e),this.modified(!0)}G(W8,P,{transform(e,t){var n=t.dataflow,r=this.value,i=nre(e);(!r||i!==r.type)&&(this.value=r=Fe(i)());for(i in e)if(!tre[i]){if(i==="padding"&&U8(r.type))continue;pe(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return ure(r,e,are(r,e,ire(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function nre(e){var t=e.type,n="",r;return t===oo?oo+"-"+Yc:(rre(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?oo+"-":r===3?Rf+"-":""),(n+t||Yc).toLowerCase())}function rre(e){const t=e.type;return A$(t)&&t!==Gu&&t!==Yu&&(e.scheme||e.range&&e.range.length&&e.range.every(Q))}function ire(e,t,n){const r=ore(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,o=e.type,s=t.zero||t.zero===void 0&&ere(e),a,u;if(!i)return 0;if(U8(o)&&t.padding&&i[0]!==_e(i)&&(i=sre(o,i,t.range,t.padding,t.exponent,t.constant)),(s||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(i=i.slice()).length-1||1,s&&(i[0]>0&&(i[0]=0),i[a]<0&&(i[a]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>i[a]?a+1:u<i[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return e.domain(q8(o,i,n)),o===_$&&e.unknown(t.domainImplicit?Jw:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&M$(e,t.nice)||null),i.length}function ore(e,t,n){return t?(e.domain(q8(e.type,t,n)),t.length):-1}function sre(e,t,n,r,i,o){var s=Math.abs(_e(n)-n[0]),a=s/(s-2*r),u=e===fs?V_(t,null,a):e===Wp?z0(t,null,a,.5):e===Up?z0(t,null,a,i||1):e===hv?G_(t,null,a,o||1):H_(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function q8(e,t,n){if(sI(e)){var r=Math.abs(t.reduce((i,o)=>i+(o<0?-1:o>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+V(t))}return t}function are(e,t,n){let r=t.bins;if(r&&!I(r)){const i=e.domain(),o=i[0],s=_e(i),a=r.step;let u=r.start==null?o:r.start,l=r.stop==null?s:r.stop;a||z("Scale bins parameter missing step property."),u<o&&(u=a*Math.ceil(o/a)),l>s&&(l=a*Math.floor(s/a)),r=xr(u,l+a/2,a)}return r?e.bins=r:e.bins&&delete e.bins,e.type===k$&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function ure(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(t.rangeStep!=null)o=lre(r,t,n);else if(t.scheme&&(o=cre(r,t,n),pe(o))){if(e.interpolator)return e.interpolator(o);z(`Scale type ${r} does not support interpolating color schemes.`)}if(o&&aI(r))return e.interpolator(mv(bE(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(T$(t.interpolate,t.interpolateGamma)):pe(e.round)?e.round(i):pe(e.rangeRound)&&e.interpolate(i?jp:za),o&&e.range(bE(o,t.reverse))}function lre(e,t,n){e!==eI&&e!==oE&&z("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===oE?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*S$(n,i,r)]}function cre(e,t,n){var r=t.schemeExtent,i,o;return I(t.scheme)?o=mv(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),o=F$(i),o||z(`Unrecognized scheme name: ${t.scheme}`)),n=e===gv?n+1:e===k$?n-1:e===Xc||e===pv?+t.schemeCount||Zne:n,aI(e)?EO(o,r,t.reverse):pe(o)?cI(EO(o,r),n):e===_$?o:o.slice(0,n)}function EO(e,t,n){return pe(e)&&(t||n)?lI(e,bE(t||[0,1],n)):e}function bE(e,t){return t?e.slice().reverse():e}function H8(e){P.call(this,null,e)}G(H8,P,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(xl(e.sort)),this.modified(n),t}});const SO="zero",V8="center",G8="normalize",Y8=["y0","y1"];function xC(e){P.call(this,null,e)}xC.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:SO,values:[SO,V8,G8]},{name:"as",type:"string",array:!0,length:2,default:Y8}]};G(xC,P,{transform(e,t){var n=e.as||Y8,r=n[0],i=n[1],o=xl(e.sort),s=e.field||kf,a=e.offset===V8?fre:e.offset===G8?dre:hre,u,l,c,f;for(u=pre(t.source,e.groupby,o,s),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,s,r,i);return t.reflow(e.modified()).modifies(n)}});function fre(e,t,n,r,i){for(var o=(t-e.sum)/2,s=e.length,a=0,u;a<s;++a)u=e[a],u[r]=o,u[i]=o+=Math.abs(n(u))}function dre(e,t,n,r,i){for(var o=1/e.sum,s=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[r]=s,c[i]=s=o*(l+=Math.abs(n(c)))}function hre(e,t,n,r,i){for(var o=0,s=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=+n(c),l<0?(c[r]=s,c[i]=s+=l):(c[r]=o,c[i]=o+=l)}function pre(e,t,n,r){var i=[],o=g=>g(c),s,a,u,l,c,f,d,h,p;if(t==null)i.push(e.slice());else for(s={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(o),d=s[f],d||(s[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,l=i.length;f<l;++f){for(d=i[f],a=0,h=0,u=d.length;a<u;++a)h+=Math.abs(r(d[a]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}const gre=Object.freeze(Object.defineProperty({__proto__:null,axisticks:R8,datajoin:P8,encode:L8,legendentries:z8,linkpath:yC,pie:vC,scale:W8,sortitems:H8,stack:xC},Symbol.toStringTag,{value:"Module"}));var ue=1e-6,p1=1e-12,ve=Math.PI,lt=ve/2,g1=ve/4,Nn=ve*2,ft=180/ve,me=ve/180,Se=Math.abs,Lf=Math.atan,Gr=Math.atan2,le=Math.cos,nm=Math.ceil,X8=Math.exp,wE=Math.hypot,m1=Math.log,L2=Math.pow,se=Math.sin,Pr=Math.sign||function(e){return e>0?1:e<0?-1:0},Dn=Math.sqrt,bC=Math.tan;function Q8(e){return e>1?0:e<-1?ve:Math.acos(e)}function or(e){return e>1?lt:e<-1?-lt:Math.asin(e)}function Wt(){}function y1(e,t){e&&kO.hasOwnProperty(e.type)&&kO[e.type](e,t)}var _O={Feature:function(e,t){y1(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)y1(n[r].geometry,t)}},kO={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){EE(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)EE(n[r],t,0)},Polygon:function(e,t){$O(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)$O(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)y1(n[r],t)}};function EE(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function $O(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)EE(e[n],t,1);t.polygonEnd()}function Uo(e,t){e&&_O.hasOwnProperty(e.type)?_O[e.type](e,t):y1(e,t)}var v1=new Mn,x1=new Mn,K8,J8,SE,_E,kE,po={point:Wt,lineStart:Wt,lineEnd:Wt,polygonStart:function(){v1=new Mn,po.lineStart=mre,po.lineEnd=yre},polygonEnd:function(){var e=+v1;x1.add(e<0?Nn+e:e),this.lineStart=this.lineEnd=this.point=Wt},sphere:function(){x1.add(Nn)}};function mre(){po.point=vre}function yre(){Z8(K8,J8)}function vre(e,t){po.point=Z8,K8=e,J8=t,e*=me,t*=me,SE=e,_E=le(t=t/2+g1),kE=se(t)}function Z8(e,t){e*=me,t*=me,t=t/2+g1;var n=e-SE,r=n>=0?1:-1,i=r*n,o=le(t),s=se(t),a=kE*s,u=_E*o+a*le(i),l=a*r*se(i);v1.add(Gr(l,u)),SE=e,_E=o,kE=s}function xre(e){return x1=new Mn,Uo(e,po),x1*2}function b1(e){return[Gr(e[1],e[0]),or(e[2])]}function Xu(e){var t=e[0],n=e[1],r=le(n);return[r*le(t),r*se(t),se(n)]}function rm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function nf(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function z2(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function im(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function w1(e){var t=Dn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var nt,Wn,st,gr,hu,e9,t9,_c,vh,Ds,ds,Io={point:$E,lineStart:CO,lineEnd:AO,polygonStart:function(){Io.point=r9,Io.lineStart=bre,Io.lineEnd=wre,vh=new Mn,po.polygonStart()},polygonEnd:function(){po.polygonEnd(),Io.point=$E,Io.lineStart=CO,Io.lineEnd=AO,v1<0?(nt=-(st=180),Wn=-(gr=90)):vh>ue?gr=90:vh<-ue&&(Wn=-90),ds[0]=nt,ds[1]=st},sphere:function(){nt=-(st=180),Wn=-(gr=90)}};function $E(e,t){Ds.push(ds=[nt=e,st=e]),t<Wn&&(Wn=t),t>gr&&(gr=t)}function n9(e,t){var n=Xu([e*me,t*me]);if(_c){var r=nf(_c,n),i=[r[1],-r[0],0],o=nf(i,r);w1(o),o=b1(o);var s=e-hu,a=s>0?1:-1,u=o[0]*ft*a,l,c=Se(s)>180;c^(a*hu<u&&u<a*e)?(l=o[1]*ft,l>gr&&(gr=l)):(u=(u+360)%360-180,c^(a*hu<u&&u<a*e)?(l=-o[1]*ft,l<Wn&&(Wn=l)):(t<Wn&&(Wn=t),t>gr&&(gr=t))),c?e<hu?hr(nt,e)>hr(nt,st)&&(st=e):hr(e,st)>hr(nt,st)&&(nt=e):st>=nt?(e<nt&&(nt=e),e>st&&(st=e)):e>hu?hr(nt,e)>hr(nt,st)&&(st=e):hr(e,st)>hr(nt,st)&&(nt=e)}else Ds.push(ds=[nt=e,st=e]);t<Wn&&(Wn=t),t>gr&&(gr=t),_c=n,hu=e}function CO(){Io.point=n9}function AO(){ds[0]=nt,ds[1]=st,Io.point=$E,_c=null}function r9(e,t){if(_c){var n=e-hu;vh.add(Se(n)>180?n+(n>0?360:-360):n)}else e9=e,t9=t;po.point(e,t),n9(e,t)}function bre(){po.lineStart()}function wre(){r9(e9,t9),po.lineEnd(),Se(vh)>ue&&(nt=-(st=180)),ds[0]=nt,ds[1]=st,_c=null}function hr(e,t){return(t-=e)<0?t+360:t}function Ere(e,t){return e[0]-t[0]}function TO(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Sre(e){var t,n,r,i,o,s,a;if(gr=st=-(nt=Wn=1/0),Ds=[],Uo(e,Io),n=Ds.length){for(Ds.sort(Ere),t=1,r=Ds[0],o=[r];t<n;++t)i=Ds[t],TO(r,i[0])||TO(r,i[1])?(hr(r[0],i[1])>hr(r[0],r[1])&&(r[1]=i[1]),hr(i[0],r[1])>hr(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,n=o.length-1,t=0,r=o[n];t<=n;r=i,++t)i=o[t],(a=hr(r[1],i[0]))>s&&(s=a,nt=i[0],st=r[1])}return Ds=ds=null,nt===1/0||Wn===1/0?[[NaN,NaN],[NaN,NaN]]:[[nt,Wn],[st,gr]]}var Wd,E1,S1,_1,k1,$1,C1,A1,CE,AE,TE,i9,o9,kn,$n,Cn,yi={sphere:Wt,point:wC,lineStart:FO,lineEnd:MO,polygonStart:function(){yi.lineStart=$re,yi.lineEnd=Cre},polygonEnd:function(){yi.lineStart=FO,yi.lineEnd=MO}};function wC(e,t){e*=me,t*=me;var n=le(t);eg(n*le(e),n*se(e),se(t))}function eg(e,t,n){++Wd,S1+=(e-S1)/Wd,_1+=(t-_1)/Wd,k1+=(n-k1)/Wd}function FO(){yi.point=_re}function _re(e,t){e*=me,t*=me;var n=le(t);kn=n*le(e),$n=n*se(e),Cn=se(t),yi.point=kre,eg(kn,$n,Cn)}function kre(e,t){e*=me,t*=me;var n=le(t),r=n*le(e),i=n*se(e),o=se(t),s=Gr(Dn((s=$n*o-Cn*i)*s+(s=Cn*r-kn*o)*s+(s=kn*i-$n*r)*s),kn*r+$n*i+Cn*o);E1+=s,$1+=s*(kn+(kn=r)),C1+=s*($n+($n=i)),A1+=s*(Cn+(Cn=o)),eg(kn,$n,Cn)}function MO(){yi.point=wC}function $re(){yi.point=Are}function Cre(){s9(i9,o9),yi.point=wC}function Are(e,t){i9=e,o9=t,e*=me,t*=me,yi.point=s9;var n=le(t);kn=n*le(e),$n=n*se(e),Cn=se(t),eg(kn,$n,Cn)}function s9(e,t){e*=me,t*=me;var n=le(t),r=n*le(e),i=n*se(e),o=se(t),s=$n*o-Cn*i,a=Cn*r-kn*o,u=kn*i-$n*r,l=wE(s,a,u),c=or(l),f=l&&-c/l;CE.add(f*s),AE.add(f*a),TE.add(f*u),E1+=c,$1+=c*(kn+(kn=r)),C1+=c*($n+($n=i)),A1+=c*(Cn+(Cn=o)),eg(kn,$n,Cn)}function Tre(e){Wd=E1=S1=_1=k1=$1=C1=A1=0,CE=new Mn,AE=new Mn,TE=new Mn,Uo(e,yi);var t=+CE,n=+AE,r=+TE,i=wE(t,n,r);return i<p1&&(t=$1,n=C1,r=A1,E1<ue&&(t=S1,n=_1,r=k1),i=wE(t,n,r),i<p1)?[NaN,NaN]:[Gr(n,t)*ft,or(r/i)*ft]}function FE(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function ME(e,t){return Se(e)>ve&&(e-=Math.round(e/Nn)*Nn),[e,t]}ME.invert=ME;function a9(e,t,n){return(e%=Nn)?t||n?FE(NO(e),DO(t,n)):NO(e):t||n?DO(t,n):ME}function OO(e){return function(t,n){return t+=e,Se(t)>ve&&(t-=Math.round(t/Nn)*Nn),[t,n]}}function NO(e){var t=OO(e);return t.invert=OO(-e),t}function DO(e,t){var n=le(e),r=se(e),i=le(t),o=se(t);function s(a,u){var l=le(u),c=le(a)*l,f=se(a)*l,d=se(u),h=d*n+c*r;return[Gr(f*i-h*o,c*n-d*r),or(h*i+f*o)]}return s.invert=function(a,u){var l=le(u),c=le(a)*l,f=se(a)*l,d=se(u),h=d*i-f*o;return[Gr(f*i+d*o,c*n+h*r),or(h*n-c*r)]},s}function Fre(e){e=a9(e[0]*me,e[1]*me,e.length>2?e[2]*me:0);function t(n){return n=e(n[0]*me,n[1]*me),n[0]*=ft,n[1]*=ft,n}return t.invert=function(n){return n=e.invert(n[0]*me,n[1]*me),n[0]*=ft,n[1]*=ft,n},t}function Mre(e,t,n,r,i,o){if(n){var s=le(t),a=se(t),u=r*n;i==null?(i=t+r*Nn,o=t-u/2):(i=RO(s,i),o=RO(s,o),(r>0?i<o:i>o)&&(i+=r*Nn));for(var l,c=i;r>0?c>o:c<o;c-=u)l=b1([s,-a*le(c),-a*se(c)]),e.point(l[0],l[1])}}function RO(e,t){t=Xu(t),t[0]-=e,w1(t);var n=Q8(-t[1]);return((-t[2]<0?-n:n)+Nn-ue)%Nn}function u9(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Wt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Km(e,t){return Se(e[0]-t[0])<ue&&Se(e[1]-t[1])<ue}function om(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function l9(e,t,n,r,i){var o=[],s=[],a,u;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,y=p[0],m=p[g],v;if(Km(y,m)){if(!y[2]&&!m[2]){for(i.lineStart(),a=0;a<g;++a)i.point((y=p[a])[0],y[1]);i.lineEnd();return}m[0]+=2*ue}o.push(v=new om(y,p,null,!0)),s.push(v.o=new om(y,null,v,!1)),o.push(v=new om(m,p,null,!1)),s.push(v.o=new om(m,null,v,!0))}}),!!o.length){for(s.sort(t),PO(o),PO(s),a=0,u=s.length;a<u;++a)s[a].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,u=c.length;a<u;++a)i.point((f=c[a])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,a=c.length-1;a>=0;--a)i.point((f=c[a])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function PO(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function I2(e){return Se(e[0])<=ve?e[0]:Pr(e[0])*((Se(e[0])+ve)%Nn-ve)}function Ore(e,t){var n=I2(t),r=t[1],i=se(r),o=[se(n),-le(n),0],s=0,a=0,u=new Mn;i===1?r=lt+ue:i===-1&&(r=-lt-ue);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],p=I2(h),g=h[1]/2+g1,y=se(g),m=le(g),v=0;v<d;++v,p=b,y=S,m=E,h=x){var x=f[v],b=I2(x),w=x[1]/2+g1,S=se(w),E=le(w),_=b-p,$=_>=0?1:-1,k=$*_,A=k>ve,R=y*S;if(u.add(Gr(R*$*se(k),m*E+R*le(k))),s+=A?_+$*Nn:_,A^p>=n^b>=n){var C=nf(Xu(h),Xu(x));w1(C);var F=nf(o,C);w1(F);var T=(A^_>=0?-1:1)*or(F[2]);(r>T||r===T&&(C[0]||C[1]))&&(a+=A^_>=0?1:-1)}}return(s<-ue||s<ue&&u<-p1)^a&1}function c9(e,t,n,r){return function(i){var o=t(i),s=u9(),a=t(s),u=!1,l,c,f,d={point:h,lineStart:g,lineEnd:y,polygonStart:function(){d.point=m,d.lineStart=v,d.lineEnd=x,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=y,c=aL(c);var b=Ore(l,r);c.length?(u||(i.polygonStart(),u=!0),l9(c,Dre,b,n,i)):b&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(b,w){e(b,w)&&i.point(b,w)}function p(b,w){o.point(b,w)}function g(){d.point=p,o.lineStart()}function y(){d.point=h,o.lineEnd()}function m(b,w){f.push([b,w]),a.point(b,w)}function v(){a.lineStart(),f=[]}function x(){m(f[0][0],f[0][1]),a.lineEnd();var b=a.clean(),w=s.result(),S,E=w.length,_,$,k;if(f.pop(),l.push(f),f=null,!!E){if(b&1){if($=w[0],(_=$.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),S=0;S<_;++S)i.point((k=$[S])[0],k[1]);i.lineEnd()}return}E>1&&b&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(Nre))}}return d}}function Nre(e){return e.length>1}function Dre(e,t){return((e=e.x)[0]<0?e[1]-lt-ue:lt-e[1])-((t=t.x)[0]<0?t[1]-lt-ue:lt-t[1])}const LO=c9(function(){return!0},Rre,Lre,[-ve,-lt]);function Rre(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,s){var a=o>0?ve:-ve,u=Se(o-t);Se(u-ve)<ue?(e.point(t,n=(n+s)/2>0?lt:-lt),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(o,n),i=0):r!==a&&u>=ve&&(Se(t-r)<ue&&(t-=r*ue),Se(o-a)<ue&&(o-=a*ue),n=Pre(t,n,o,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),i=0),e.point(t=o,n=s),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function Pre(e,t,n,r){var i,o,s=se(e-n);return Se(s)>ue?Lf((se(t)*(o=le(r))*se(n)-se(r)*(i=le(t))*se(e))/(i*o*s)):(t+r)/2}function Lre(e,t,n,r){var i;if(e==null)i=n*lt,r.point(-ve,i),r.point(0,i),r.point(ve,i),r.point(ve,0),r.point(ve,-i),r.point(0,-i),r.point(-ve,-i),r.point(-ve,0),r.point(-ve,i);else if(Se(e[0]-t[0])>ue){var o=e[0]<t[0]?ve:-ve;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function zre(e){var t=le(e),n=6*me,r=t>0,i=Se(t)>ue;function o(c,f,d,h){Mre(h,e,n,d,c,f)}function s(c,f){return le(c)*le(f)>t}function a(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(y,m){var v=[y,m],x,b=s(y,m),w=r?b?0:l(y,m):b?l(y+(y<0?ve:-ve),m):0;if(!f&&(p=h=b)&&c.lineStart(),b!==h&&(x=u(f,v),(!x||Km(f,x)||Km(v,x))&&(v[2]=1)),b!==h)g=0,b?(c.lineStart(),x=u(v,f),c.point(x[0],x[1])):(x=u(f,v),c.point(x[0],x[1],2),c.lineEnd()),f=x;else if(i&&f&&r^b){var S;!(w&d)&&(S=u(v,f,!0))&&(g=0,r?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}b&&(!f||!Km(f,v))&&c.point(v[0],v[1]),f=v,h=b,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function u(c,f,d){var h=Xu(c),p=Xu(f),g=[1,0,0],y=nf(h,p),m=rm(y,y),v=y[0],x=m-v*v;if(!x)return!d&&c;var b=t*m/x,w=-t*v/x,S=nf(g,y),E=im(g,b),_=im(y,w);z2(E,_);var $=S,k=rm(E,$),A=rm($,$),R=k*k-A*(rm(E,E)-1);if(!(R<0)){var C=Dn(R),F=im($,(-k-C)/A);if(z2(F,E),F=b1(F),!d)return F;var T=c[0],O=f[0],D=c[1],M=f[1],N;O<T&&(N=T,T=O,O=N);var j=O-T,X=Se(j-ve)<ue,te=X||j<ue;if(!X&&M<D&&(N=D,D=M,M=N),te?X?D+M>0^F[1]<(Se(F[0]-T)<ue?D:M):D<=F[1]&&F[1]<=M:j>ve^(T<=F[0]&&F[0]<=O)){var xe=im($,(-k+C)/A);return z2(xe,E),[F,b1(xe)]}}}function l(c,f){var d=r?e:ve-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return c9(s,a,o,r?[0,-e]:[-ve,e-ve])}function Ire(e,t,n,r,i,o){var s=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,d=u-s,h=l-a,p;if(p=n-s,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-s,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=o-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=s+c*d,e[1]=a+c*h),f<1&&(t[0]=s+f*d,t[1]=a+f*h),!0}}}}}var qd=1e9,sm=-qd;function f9(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function o(l,c,f,d){var h=0,p=0;if(l==null||(h=s(l,f))!==(p=s(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function s(l,c){return Se(l[0]-e)<ue?c>0?0:3:Se(l[0]-n)<ue?c>0?2:1:Se(l[1]-t)<ue?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=s(l,1),d=s(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=u9(),d,h,p,g,y,m,v,x,b,w,S,E={point:_,lineStart:R,lineEnd:C,polygonStart:k,polygonEnd:A};function _(T,O){i(T,O)&&c.point(T,O)}function $(){for(var T=0,O=0,D=h.length;O<D;++O)for(var M=h[O],N=1,j=M.length,X=M[0],te,xe,de=X[0],De=X[1];N<j;++N)te=de,xe=De,X=M[N],de=X[0],De=X[1],xe<=r?De>r&&(de-te)*(r-xe)>(De-xe)*(e-te)&&++T:De<=r&&(de-te)*(r-xe)<(De-xe)*(e-te)&&--T;return T}function k(){c=f,d=[],h=[],S=!0}function A(){var T=$(),O=S&&T,D=(d=aL(d)).length;(O||D)&&(l.polygonStart(),O&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),D&&l9(d,a,T,o,l),l.polygonEnd()),c=l,d=h=p=null}function R(){E.point=F,h&&h.push(p=[]),w=!0,b=!1,v=x=NaN}function C(){d&&(F(g,y),m&&b&&f.rejoin(),d.push(f.result())),E.point=_,b&&c.lineEnd()}function F(T,O){var D=i(T,O);if(h&&p.push([T,O]),w)g=T,y=O,m=D,w=!1,D&&(c.lineStart(),c.point(T,O));else if(D&&b)c.point(T,O);else{var M=[v=Math.max(sm,Math.min(qd,v)),x=Math.max(sm,Math.min(qd,x))],N=[T=Math.max(sm,Math.min(qd,T)),O=Math.max(sm,Math.min(qd,O))];Ire(M,N,e,t,n,r)?(b||(c.lineStart(),c.point(M[0],M[1])),c.point(N[0],N[1]),D||c.lineEnd(),S=!1):D&&(c.lineStart(),c.point(T,O),S=!1)}v=T,x=O,b=D}return E}}function zO(e,t,n){var r=xr(e,t-ue,n).concat(t);return function(i){return r.map(function(o){return[i,o]})}}function IO(e,t,n){var r=xr(e,t-ue,n).concat(t);return function(i){return r.map(function(o){return[o,i]})}}function jre(){var e,t,n,r,i,o,s,a,u=10,l=u,c=90,f=360,d,h,p,g,y=2.5;function m(){return{type:"MultiLineString",coordinates:v()}}function v(){return xr(nm(r/c)*c,n,c).map(p).concat(xr(nm(a/f)*f,s,f).map(g)).concat(xr(nm(t/u)*u,e,u).filter(function(x){return Se(x%c)>ue}).map(d)).concat(xr(nm(o/l)*l,i,l).filter(function(x){return Se(x%f)>ue}).map(h))}return m.lines=function(){return v().map(function(x){return{type:"LineString",coordinates:x}})},m.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(s).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},m.extent=function(x){return arguments.length?m.extentMajor(x).extentMinor(x):m.extentMinor()},m.extentMajor=function(x){return arguments.length?(r=+x[0][0],n=+x[1][0],a=+x[0][1],s=+x[1][1],r>n&&(x=r,r=n,n=x),a>s&&(x=a,a=s,s=x),m.precision(y)):[[r,a],[n,s]]},m.extentMinor=function(x){return arguments.length?(t=+x[0][0],e=+x[1][0],o=+x[0][1],i=+x[1][1],t>e&&(x=t,t=e,e=x),o>i&&(x=o,o=i,i=x),m.precision(y)):[[t,o],[e,i]]},m.step=function(x){return arguments.length?m.stepMajor(x).stepMinor(x):m.stepMinor()},m.stepMajor=function(x){return arguments.length?(c=+x[0],f=+x[1],m):[c,f]},m.stepMinor=function(x){return arguments.length?(u=+x[0],l=+x[1],m):[u,l]},m.precision=function(x){return arguments.length?(y=+x,d=zO(o,i,90),h=IO(t,e,y),p=zO(a,s,90),g=IO(r,n,y),m):y},m.extentMajor([[-180,-90+ue],[180,90-ue]]).extentMinor([[-180,-80-ue],[180,80+ue]])}const sp=e=>e;var j2=new Mn,OE=new Mn,d9,h9,NE,DE,js={point:Wt,lineStart:Wt,lineEnd:Wt,polygonStart:function(){js.lineStart=Bre,js.lineEnd=Wre},polygonEnd:function(){js.lineStart=js.lineEnd=js.point=Wt,j2.add(Se(OE)),OE=new Mn},result:function(){var e=j2/2;return j2=new Mn,e}};function Bre(){js.point=Ure}function Ure(e,t){js.point=p9,d9=NE=e,h9=DE=t}function p9(e,t){OE.add(DE*e-NE*t),NE=e,DE=t}function Wre(){p9(d9,h9)}const jO=js;var rf=1/0,T1=rf,ap=-rf,F1=ap,qre={point:Hre,lineStart:Wt,lineEnd:Wt,polygonStart:Wt,polygonEnd:Wt,result:function(){var e=[[rf,T1],[ap,F1]];return ap=F1=-(T1=rf=1/0),e}};function Hre(e,t){e<rf&&(rf=e),e>ap&&(ap=e),t<T1&&(T1=t),t>F1&&(F1=t)}const M1=qre;var RE=0,PE=0,Hd=0,O1=0,N1=0,dc=0,LE=0,zE=0,Vd=0,g9,m9,Ki,Ji,gi={point:Qu,lineStart:BO,lineEnd:UO,polygonStart:function(){gi.lineStart=Yre,gi.lineEnd=Xre},polygonEnd:function(){gi.point=Qu,gi.lineStart=BO,gi.lineEnd=UO},result:function(){var e=Vd?[LE/Vd,zE/Vd]:dc?[O1/dc,N1/dc]:Hd?[RE/Hd,PE/Hd]:[NaN,NaN];return RE=PE=Hd=O1=N1=dc=LE=zE=Vd=0,e}};function Qu(e,t){RE+=e,PE+=t,++Hd}function BO(){gi.point=Vre}function Vre(e,t){gi.point=Gre,Qu(Ki=e,Ji=t)}function Gre(e,t){var n=e-Ki,r=t-Ji,i=Dn(n*n+r*r);O1+=i*(Ki+e)/2,N1+=i*(Ji+t)/2,dc+=i,Qu(Ki=e,Ji=t)}function UO(){gi.point=Qu}function Yre(){gi.point=Qre}function Xre(){y9(g9,m9)}function Qre(e,t){gi.point=y9,Qu(g9=Ki=e,m9=Ji=t)}function y9(e,t){var n=e-Ki,r=t-Ji,i=Dn(n*n+r*r);O1+=i*(Ki+e)/2,N1+=i*(Ji+t)/2,dc+=i,i=Ji*e-Ki*t,LE+=i*(Ki+e),zE+=i*(Ji+t),Vd+=i*3,Qu(Ki=e,Ji=t)}const WO=gi;function v9(e){this._context=e}v9.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Nn);break}}},result:Wt};var IE=new Mn,B2,x9,b9,Gd,Yd,D1={point:Wt,lineStart:function(){D1.point=Kre},lineEnd:function(){B2&&w9(x9,b9),D1.point=Wt},polygonStart:function(){B2=!0},polygonEnd:function(){B2=null},result:function(){var e=+IE;return IE=new Mn,e}};function Kre(e,t){D1.point=w9,x9=Gd=e,b9=Yd=t}function w9(e,t){Gd-=e,Yd-=t,IE.add(Dn(Gd*Gd+Yd*Yd)),Gd=e,Yd=t}const qO=D1;let HO,R1,VO,GO;class YO{constructor(t){this._append=t==null?E9:Jre(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==VO||this._append!==R1){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,VO=r,R1=this._append,GO=this._,this._=i}this._+=GO;break}}}result(){const t=this._;return this._="",t.length?t:null}}function E9(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Jre(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return E9;if(t!==HO){const n=10**t;HO=t,R1=function(i){let o=1;this._+=i[0];for(const s=i.length;o<s;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}return R1}function S9(e,t){let n=3,r=4.5,i,o;function s(a){return a&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),Uo(a,i(o))),o.result()}return s.area=function(a){return Uo(a,i(jO)),jO.result()},s.measure=function(a){return Uo(a,i(qO)),qO.result()},s.bounds=function(a){return Uo(a,i(M1)),M1.result()},s.centroid=function(a){return Uo(a,i(WO)),WO.result()},s.projection=function(a){return arguments.length?(i=a==null?(e=null,sp):(e=a).stream,s):e},s.context=function(a){return arguments.length?(o=a==null?(t=null,new YO(n)):new v9(t=a),typeof r!="function"&&o.pointRadius(r),s):t},s.pointRadius=function(a){return arguments.length?(r=typeof a=="function"?a:(o.pointRadius(+a),+a),s):r},s.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);n=u}return t===null&&(o=new YO(n)),s},s.projection(e).digits(n).context(t)}function Tv(e){return function(t){var n=new jE;for(var r in e)n[r]=e[r];return n.stream=t,n}}function jE(){}jE.prototype={constructor:jE,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function EC(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Uo(n,e.stream(M1)),t(M1.result()),r!=null&&e.clipExtent(r),e}function Fv(e,t,n){return EC(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),a=+t[0][0]+(i-s*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(o-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,u])},n)}function SC(e,t,n){return Fv(e,[[0,0],t],n)}function _C(e,t,n){return EC(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),s=(i-o*(r[1][0]+r[0][0]))/2,a=-o*r[0][1];e.scale(150*o).translate([s,a])},n)}function kC(e,t,n){return EC(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),s=-o*r[0][0],a=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,a])},n)}var XO=16,Zre=le(30*me);function QO(e,t){return+t?tie(e,t):eie(e)}function eie(e){return Tv({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function tie(e,t){function n(r,i,o,s,a,u,l,c,f,d,h,p,g,y){var m=l-r,v=c-i,x=m*m+v*v;if(x>4*t&&g--){var b=s+d,w=a+h,S=u+p,E=Dn(b*b+w*w+S*S),_=or(S/=E),$=Se(Se(S)-1)<ue||Se(o-f)<ue?(o+f)/2:Gr(w,b),k=e($,_),A=k[0],R=k[1],C=A-r,F=R-i,T=v*C-m*F;(T*T/x>t||Se((m*C+v*F)/x-.5)>.3||s*d+a*h+u*p<Zre)&&(n(r,i,o,s,a,u,A,R,$,b/=E,w/=E,S,g,y),y.point(A,R),n(A,R,$,b,w,S,l,c,f,d,h,p,g,y))}}return function(r){var i,o,s,a,u,l,c,f,d,h,p,g,y={point:m,lineStart:v,lineEnd:b,polygonStart:function(){r.polygonStart(),y.lineStart=w},polygonEnd:function(){r.polygonEnd(),y.lineStart=v}};function m(_,$){_=e(_,$),r.point(_[0],_[1])}function v(){f=NaN,y.point=x,r.lineStart()}function x(_,$){var k=Xu([_,$]),A=e(_,$);n(f,d,c,h,p,g,f=A[0],d=A[1],c=_,h=k[0],p=k[1],g=k[2],XO,r),r.point(f,d)}function b(){y.point=m,r.lineEnd()}function w(){v(),y.point=S,y.lineEnd=E}function S(_,$){x(i=_,$),o=f,s=d,a=h,u=p,l=g,y.point=x}function E(){n(f,d,c,h,p,g,o,s,i,a,u,l,XO,r),y.lineEnd=b,b()}return y}}var nie=Tv({point:function(e,t){this.stream.point(e*me,t*me)}});function rie(e){return Tv({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function iie(e,t,n,r,i){function o(s,a){return s*=r,a*=i,[t+e*s,n-e*a]}return o.invert=function(s,a){return[(s-t)/e*r,(n-a)/e*i]},o}function KO(e,t,n,r,i,o){if(!o)return iie(e,t,n,r,i);var s=le(o),a=se(o),u=s*e,l=a*e,c=s/e,f=a/e,d=(a*n-s*t)/e,h=(a*t+s*n)/e;function p(g,y){return g*=r,y*=i,[u*g-l*y+t,n-l*g-u*y]}return p.invert=function(g,y){return[r*(c*g-f*y+d),i*(h-f*g-c*y)]},p}function So(e){return _9(function(){return e})()}function _9(e){var t,n=150,r=480,i=250,o=0,s=0,a=0,u=0,l=0,c,f=0,d=1,h=1,p=null,g=LO,y=null,m,v,x,b=sp,w=.5,S,E,_,$,k;function A(T){return _(T[0]*me,T[1]*me)}function R(T){return T=_.invert(T[0],T[1]),T&&[T[0]*ft,T[1]*ft]}A.stream=function(T){return $&&k===T?$:$=nie(rie(c)(g(S(b(k=T)))))},A.preclip=function(T){return arguments.length?(g=T,p=void 0,F()):g},A.postclip=function(T){return arguments.length?(b=T,y=m=v=x=null,F()):b},A.clipAngle=function(T){return arguments.length?(g=+T?zre(p=T*me):(p=null,LO),F()):p*ft},A.clipExtent=function(T){return arguments.length?(b=T==null?(y=m=v=x=null,sp):f9(y=+T[0][0],m=+T[0][1],v=+T[1][0],x=+T[1][1]),F()):y==null?null:[[y,m],[v,x]]},A.scale=function(T){return arguments.length?(n=+T,C()):n},A.translate=function(T){return arguments.length?(r=+T[0],i=+T[1],C()):[r,i]},A.center=function(T){return arguments.length?(o=T[0]%360*me,s=T[1]%360*me,C()):[o*ft,s*ft]},A.rotate=function(T){return arguments.length?(a=T[0]%360*me,u=T[1]%360*me,l=T.length>2?T[2]%360*me:0,C()):[a*ft,u*ft,l*ft]},A.angle=function(T){return arguments.length?(f=T%360*me,C()):f*ft},A.reflectX=function(T){return arguments.length?(d=T?-1:1,C()):d<0},A.reflectY=function(T){return arguments.length?(h=T?-1:1,C()):h<0},A.precision=function(T){return arguments.length?(S=QO(E,w=T*T),F()):Dn(w)},A.fitExtent=function(T,O){return Fv(A,T,O)},A.fitSize=function(T,O){return SC(A,T,O)},A.fitWidth=function(T,O){return _C(A,T,O)},A.fitHeight=function(T,O){return kC(A,T,O)};function C(){var T=KO(n,0,0,d,h,f).apply(null,t(o,s)),O=KO(n,r-T[0],i-T[1],d,h,f);return c=a9(a,u,l),E=FE(t,O),_=FE(c,E),S=QO(E,w),F()}function F(){return $=k=null,A}return function(){return t=e.apply(this,arguments),A.invert=t.invert&&R,C()}}function $C(e){var t=0,n=ve/3,r=_9(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*me,n=o[1]*me):[t*ft,n*ft]},i}function oie(e){var t=le(e);function n(r,i){return[r*t,se(i)/t]}return n.invert=function(r,i){return[r/t,or(i*t)]},n}function sie(e,t){var n=se(e),r=(n+se(t))/2;if(Se(r)<ue)return oie(e);var i=1+n*(2*r-n),o=Dn(i)/r;function s(a,u){var l=Dn(i-2*r*se(u))/r;return[l*se(a*=r),o-l*le(a)]}return s.invert=function(a,u){var l=o-u,c=Gr(a,Se(l))*Pr(l);return l*r<0&&(c-=ve*Pr(a)*Pr(l)),[c/r,or((i-(a*a+l*l)*r*r)/(2*r))]},s}function P1(){return $C(sie).scale(155.424).center([0,33.6442])}function k9(){return P1().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function aie(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function uie(){var e,t,n=k9(),r,i=P1().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,s=P1().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,r.point(h,p),u||(o.point(h,p),u)||(a.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,y=(d[1]-p[1])/h;return(y>=.12&&y<.234&&g>=-.425&&g<-.214?i:y>=.166&&y<.234&&g>=-.214&&g<-.115?s:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=aie([n.stream(t=d),i.stream(d),s.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),s.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),s.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),o=i.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+ue,g+.12*h+ue],[p-.214*h-ue,g+.234*h-ue]]).stream(l),a=s.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+ue,g+.166*h+ue],[p-.115*h-ue,g+.234*h-ue]]).stream(l),f()},c.fitExtent=function(d,h){return Fv(c,d,h)},c.fitSize=function(d,h){return SC(c,d,h)},c.fitWidth=function(d,h){return _C(c,d,h)},c.fitHeight=function(d,h){return kC(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function $9(e){return function(t,n){var r=le(t),i=le(n),o=e(r*i);return o===1/0?[2,0]:[o*i*se(t),o*se(n)]}}function tg(e){return function(t,n){var r=Dn(t*t+n*n),i=e(r),o=se(i),s=le(i);return[Gr(t*o,r*s),or(r&&n*o/r)]}}var C9=$9(function(e){return Dn(2/(1+e))});C9.invert=tg(function(e){return 2*or(e/2)});function lie(){return So(C9).scale(124.75).clipAngle(180-.001)}var A9=$9(function(e){return(e=Q8(e))&&e/se(e)});A9.invert=tg(function(e){return e});function cie(){return So(A9).scale(79.4188).clipAngle(180-.001)}function Mv(e,t){return[e,m1(bC((lt+t)/2))]}Mv.invert=function(e,t){return[e,2*Lf(X8(t))-lt]};function fie(){return T9(Mv).scale(961/Nn)}function T9(e){var t=So(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,s=null,a,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?s=a=u=l=null:(s=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):s==null?null:[[s,a],[u,l]]};function c(){var f=ve*r(),d=t(Fre(t.rotate()).invert([0,0]));return o(s==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Mv?[[Math.max(d[0]-f,s),a],[Math.min(d[0]+f,u),l]]:[[s,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return c()}function am(e){return bC((lt+e)/2)}function die(e,t){var n=le(e),r=e===t?se(e):m1(n/le(t))/m1(am(t)/am(e)),i=n*L2(am(e),r)/r;if(!r)return Mv;function o(s,a){i>0?a<-lt+ue&&(a=-lt+ue):a>lt-ue&&(a=lt-ue);var u=i/L2(am(a),r);return[u*se(r*s),i-u*le(r*s)]}return o.invert=function(s,a){var u=i-a,l=Pr(r)*Dn(s*s+u*u),c=Gr(s,Se(u))*Pr(u);return u*r<0&&(c-=ve*Pr(s)*Pr(u)),[c/r,2*Lf(L2(i/l,1/r))-lt]},o}function hie(){return $C(die).scale(109.5).parallels([30,30])}function L1(e,t){return[e,t]}L1.invert=L1;function pie(){return So(L1).scale(152.63)}function gie(e,t){var n=le(e),r=e===t?se(e):(n-le(t))/(t-e),i=n/r+e;if(Se(r)<ue)return L1;function o(s,a){var u=i-a,l=r*s;return[u*se(l),i-u*le(l)]}return o.invert=function(s,a){var u=i-a,l=Gr(s,Se(u))*Pr(u);return u*r<0&&(l-=ve*Pr(s)*Pr(u)),[l/r,i-Pr(r)*Dn(s*s+u*u)]},o}function mie(){return $C(gie).scale(131.154).center([0,13.9389])}var xh=1.340264,bh=-.081106,wh=893e-6,Eh=.003796,z1=Dn(3)/2,yie=12;function F9(e,t){var n=or(z1*se(t)),r=n*n,i=r*r*r;return[e*le(n)/(z1*(xh+3*bh*r+i*(7*wh+9*Eh*r))),n*(xh+bh*r+i*(wh+Eh*r))]}F9.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,o=0,s,a,u;o<yie&&(a=n*(xh+bh*r+i*(wh+Eh*r))-t,u=xh+3*bh*r+i*(7*wh+9*Eh*r),n-=s=a/u,r=n*n,i=r*r*r,!(Se(s)<p1));++o);return[z1*e*(xh+3*bh*r+i*(7*wh+9*Eh*r))/le(n),or(se(n)/z1)]};function vie(){return So(F9).scale(177.158)}function M9(e,t){var n=le(t),r=le(e)*n;return[n*se(e)/r,se(t)/r]}M9.invert=tg(Lf);function xie(){return So(M9).scale(144.049).clipAngle(60)}function bie(){var e=1,t=0,n=0,r=1,i=1,o=0,s,a,u=null,l,c,f,d=1,h=1,p=Tv({point:function(b,w){var S=x([b,w]);this.stream.point(S[0],S[1])}}),g=sp,y,m;function v(){return d=e*r,h=e*i,y=m=null,x}function x(b){var w=b[0]*d,S=b[1]*h;if(o){var E=S*s-w*a;w=w*s+S*a,S=E}return[w+t,S+n]}return x.invert=function(b){var w=b[0]-t,S=b[1]-n;if(o){var E=S*s+w*a;w=w*s-S*a,S=E}return[w/d,S/h]},x.stream=function(b){return y&&m===b?y:y=p(g(m=b))},x.postclip=function(b){return arguments.length?(g=b,u=l=c=f=null,v()):g},x.clipExtent=function(b){return arguments.length?(g=b==null?(u=l=c=f=null,sp):f9(u=+b[0][0],l=+b[0][1],c=+b[1][0],f=+b[1][1]),v()):u==null?null:[[u,l],[c,f]]},x.scale=function(b){return arguments.length?(e=+b,v()):e},x.translate=function(b){return arguments.length?(t=+b[0],n=+b[1],v()):[t,n]},x.angle=function(b){return arguments.length?(o=b%360*me,a=se(o),s=le(o),v()):o*ft},x.reflectX=function(b){return arguments.length?(r=b?-1:1,v()):r<0},x.reflectY=function(b){return arguments.length?(i=b?-1:1,v()):i<0},x.fitExtent=function(b,w){return Fv(x,b,w)},x.fitSize=function(b,w){return SC(x,b,w)},x.fitWidth=function(b,w){return _C(x,b,w)},x.fitHeight=function(b,w){return kC(x,b,w)},x}function O9(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}O9.invert=function(e,t){var n=t,r=25,i;do{var o=n*n,s=o*o;n-=i=(n*(1.007226+o*(.015085+s*(-.044475+.028874*o-.005916*s)))-t)/(1.007226+o*(.015085*3+s*(-.044475*7+.028874*9*o-.005916*11*s)))}while(Se(i)>ue&&--r>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function wie(){return So(O9).scale(175.295)}function N9(e,t){return[le(t)*se(e),se(t)]}N9.invert=tg(or);function Eie(){return So(N9).scale(249.5).clipAngle(90+ue)}function D9(e,t){var n=le(t),r=1+le(e)*n;return[n*se(e)/r,se(t)/r]}D9.invert=tg(function(e){return 2*Lf(e)});function Sie(){return So(D9).scale(250).clipAngle(142)}function R9(e,t){return[m1(bC((lt+t)/2)),-e]}R9.invert=function(e,t){return[-t,2*Lf(X8(e))-lt]};function _ie(){var e=T9(R9),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var kie=Math.abs,BE=Math.cos,I1=Math.sin,$ie=1e-6,P9=Math.PI,UE=P9/2,JO=Cie(2);function ZO(e){return e>1?UE:e<-1?-UE:Math.asin(e)}function Cie(e){return e>0?Math.sqrt(e):0}function Aie(e,t){var n=e*I1(t),r=30,i;do t-=i=(t+I1(t)-n)/(1+BE(t));while(kie(i)>$ie&&--r>0);return t/2}function Tie(e,t,n){function r(i,o){return[e*i*BE(o=Aie(n,o)),t*I1(o)]}return r.invert=function(i,o){return o=ZO(o/t),[i/(e*BE(o)),ZO((2*o+I1(2*o))/n)]},r}var Fie=Tie(JO/UE,JO,P9);function Mie(){return So(Fie).scale(169.529)}const Oie=S9(),WE=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Nie(e,t){return function n(){const r=t();return r.type=e,r.path=S9().projection(r),r.copy=r.copy||function(){const i=n();return WE.forEach(o=>{r[o]&&i[o](r[o]())}),i.path.pointRadius(r.path.pointRadius()),i},iI(r)}}function CC(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(j1[e]=Nie(e,t),this):j1[e]||null}function L9(e){return e&&e.path||Oie}const j1={albers:k9,albersusa:uie,azimuthalequalarea:lie,azimuthalequidistant:cie,conicconformal:hie,conicequalarea:P1,conicequidistant:mie,equalEarth:vie,equirectangular:pie,gnomonic:xie,identity:bie,mercator:fie,mollweide:Mie,naturalEarth1:wie,orthographic:Eie,stereographic:Sie,transversemercator:_ie};for(const e in j1)CC(e,j1[e]);function Die(){}const Oo=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function z9(){var e=1,t=1,n=a;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return o(u,l,d=>{n(d,u,l),Rie(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(Pie((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function o(u,l,c){var f=new Array,d=new Array,h,p,g,y,m,v;for(h=p=-1,y=u[0]>=l,Oo[y<<1].forEach(x);++h<e-1;)g=y,y=u[h+1]>=l,Oo[g|y<<1].forEach(x);for(Oo[y<<0].forEach(x);++p<t-1;){for(h=-1,y=u[p*e+e]>=l,m=u[p*e]>=l,Oo[y<<1|m<<2].forEach(x);++h<e-1;)g=y,y=u[p*e+e+h+1]>=l,v=m,m=u[p*e+h+1]>=l,Oo[g|y<<1|m<<2|v<<3].forEach(x);Oo[y|m<<3].forEach(x)}for(h=-1,m=u[p*e]>=l,Oo[m<<2].forEach(x);++h<e-1;)v=m,m=u[p*e+h+1]>=l,Oo[m<<2|v<<3].forEach(x);Oo[m<<3].forEach(x);function x(b){var w=[b[0][0]+h,b[0][1]+p],S=[b[1][0]+h,b[1][1]+p],E=s(w),_=s(S),$,k;($=d[E])?(k=f[_])?(delete d[$.end],delete f[k.start],$===k?($.ring.push(S),c($.ring)):f[$.start]=d[k.end]={start:$.start,end:k.end,ring:$.ring.concat(k.ring)}):(delete d[$.end],$.ring.push(S),d[$.end=_]=$):($=f[_])?(k=d[E])?(delete f[$.start],delete d[k.end],$===k?($.ring.push(S),c($.ring)):f[k.start]=d[$.end]={start:k.start,end:$.end,ring:k.ring.concat($.ring)}):(delete f[$.start],$.ring.unshift(w),f[$.start=E]=$):f[E]=d[_]={start:E,end:_,ring:[w,S]}}}function s(u){return u[0]*2+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,y,m=l[g*e+p];d>0&&d<e&&p===d&&(y=l[g*e+p-1],f[0]=d+(c-y)/(m-y)-.5),h>0&&h<t&&g===h&&(y=l[(g-1)*e+p],f[1]=h+(c-y)/(m-y)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||z("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?a:Die,r):n===a},r}function Rie(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function Pie(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=Lie(e,t[n]))return i;return 0}function Lie(e,t){for(var n=t[0],r=t[1],i=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var u=e[o],l=u[0],c=u[1],f=e[a],d=f[0],h=f[1];if(zie(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function zie(e,t,n){var r;return Iie(e,t,n)&&jie(e[r=+(e[0]===t[0])],n[r],t[r])}function Iie(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function jie(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function I9(e,t,n){return function(r){var i=lo(r),o=n?Math.min(i[0],0):i[0],s=i[1],a=s-o,u=t?ma(o,s,e):a/(e+1);return xr(o+u,s,u)}}function AC(e){P.call(this,null,e)}AC.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};G(AC,P,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||yn,o=z9().smooth(e.smooth!==!1),s=e.thresholds||Bie(r,i,e),a=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=o.size([c.width,c.height])(c.values,I(s)?s:s(c.values));Uie(f,c,l,e),f.forEach(d=>{u.push(Yy(l,Ne(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Bie(e,t,n){const r=I9(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>Mu(t(i).values)))}function Uie(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;if(pe(i)&&(i=i(n,r)),pe(o)&&(o=o(n,r)),(i===1||i==null)&&!o)return;const s=(je(i)?i:i[0])||1,a=(je(i)?i:i[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach(j9(t,s,a,u,l))}function j9(e,t,n,r,i){const o=e.x1||0,s=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+r,f[1]=(f[1]-s)*n+i}return function(f){return f.coordinates.forEach(u),f}}function eN(e,t,n){const r=e>=0?e:yk(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function U2(e){return pe(e)?e:vn(+e)}function B9(){var e=u=>u[0],t=u=>u[1],n=kf,r=[-1,-1],i=960,o=500,s=2;function a(u,l){const c=eN(r[0],u,e)>>s,f=eN(r[1],u,t)>>s,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>s),g=2*h+(o>>s),y=new Float32Array(p*g),m=new Float32Array(p*g);let v=y;u.forEach(b=>{const w=d+(+e(b)>>s),S=h+(+t(b)>>s);w>=0&&w<p&&S>=0&&S<g&&(y[w+S*p]+=+n(b))}),c>0&&f>0?(zl(p,g,y,m,c),Il(p,g,m,y,f),zl(p,g,y,m,c),Il(p,g,m,y,f),zl(p,g,y,m,c),Il(p,g,m,y,f)):c>0?(zl(p,g,y,m,c),zl(p,g,m,y,c),zl(p,g,y,m,c),v=m):f>0&&(Il(p,g,y,m,f),Il(p,g,m,y,f),Il(p,g,y,m,f),v=m);const x=l?Math.pow(2,-2*s):1/uL(v);for(let b=0,w=p*g;b<w;++b)v[b]*=x;return{values:v,scale:1<<s,width:p,height:g,x1:d,y1:h,x2:d+(i>>s),y2:h+(o>>s)}}return a.x=function(u){return arguments.length?(e=U2(u),a):e},a.y=function(u){return arguments.length?(t=U2(u),a):t},a.weight=function(u){return arguments.length?(n=U2(u),a):n},a.size=function(u){if(!arguments.length)return[i,o];var l=+u[0],c=+u[1];return l>=0&&c>=0||z("invalid size"),i=l,o=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||z("invalid cell size"),s=Math.floor(Math.log(u)/Math.LN2),a):1<<s},a.bandwidth=function(u){return arguments.length?(u=K(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&z("invalid bandwidth"),r=u,a):r},a}function zl(e,t,n,r,i){const o=(i<<1)+1;for(let s=0;s<t;++s)for(let a=0,u=0;a<e+i;++a)a<e&&(u+=n[a+s*e]),a>=i&&(a>=o&&(u-=n[a-o+s*e]),r[a-i+s*e]=u/Math.min(a+1,e-1+o-a,o))}function Il(e,t,n,r,i){const o=(i<<1)+1;for(let s=0;s<e;++s)for(let a=0,u=0;a<t+i;++a)a<t&&(u+=n[s+a*e]),a>=i&&(a>=o&&(u-=n[s+(a-o)*e]),r[s+(a-i)*e]=u/Math.min(a+1,t-1+o-a,o))}function TC(e){P.call(this,null,e)}TC.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Wie=["x","y","weight","size","cellSize","bandwidth"];function U9(e,t){return Wie.forEach(n=>t[n]!=null?e[n](t[n]):0),e}G(TC,P,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=qie(r,e.groupby),o=(e.groupby||[]).map(ct),s=U9(B9(),e),a=e.as||"grid",u=[];function l(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return u=i.map(c=>Ne(l({[a]:s(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function qie(e,t){var n=[],r=c=>c(a),i,o,s,a,u,l;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function FC(e){P.call(this,null,e)}FC.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};G(FC,P,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=z9().smooth(e.smooth!==!1),i=e.values,o=e.thresholds||I9(e.count||10,e.nice,!!i),s=e.size,a,u;return i||(i=t.materialize(t.SOURCE).source,a=U9(B9(),e)(i,!0),u=j9(a,a.scale||1,a.scale||1,0,0),s=[a.width,a.height],i=a.values),o=I(o)?o:o(i),i=r.size(s)(i,o),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(Ne),n}});const qE="Feature",MC="FeatureCollection",Hie="MultiPoint";function OC(e){P.call(this,null,e)}OC.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};G(OC,P,{transform(e,t){var n=this._features,r=this._points,i=e.fields,o=i&&i[0],s=i&&i[1],a=e.geojson||!i&&yn,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(dn(a))||o&&t.modified(dn(o))||s&&t.modified(dn(s)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),a&&t.visit(u,c=>n.push(a(c))),o&&s&&(t.visit(u,c=>{var f=o(c),d=s(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:qE,geometry:{type:Hie,coordinates:r}})),this.value={type:MC,features:n}}});function NC(e){P.call(this,null,e)}NC.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};G(NC,P,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||yn,o=e.as||"path",s=n.SOURCE;!r||e.modified()?(this.value=r=L9(e.projection),n.materialize().reflow()):s=i===yn||t.modified(i.fields)?n.ADD_MOD:n.ADD;const a=Vie(r,e.pointRadius);return n.visit(s,u=>u[o]=r(i(u))),r.pointRadius(a),n.modifies(o)}});function Vie(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function DC(e){P.call(this,null,e)}DC.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};G(DC,P,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],o=e.as||["x","y"],s=o[0],a=o[1],u;function l(c){const f=n([r(c),i(c)]);f?(c[s]=f[0],c[a]=f[1]):(c[s]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(o)}});function RC(e){P.call(this,null,e)}RC.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};G(RC,P,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return(!r||e.modified())&&(this.value=r=Gie(L9(e.projection),e.field||nr("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,s=>s[i]=r),n.modifies(i)}});function Gie(e,t,n){const r=n==null?i=>e(t(i)):i=>{var o=e.pointRadius(),s=e.pointRadius(n)(t(i));return e.pointRadius(o),s};return r.context=i=>(e.context(i),r),r}function PC(e){P.call(this,[],e),this.generator=jre()}PC.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};G(PC,P,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const o in e)pe(r[o])&&r[o](e[o]);return i=r(),n.length?t.mod.push(r6(n[0],i)):t.add.push(Ne(i)),n[0]=i,t}});function LC(e){P.call(this,null,e)}LC.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};G(LC,P,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||yn,o=Xie(e.opacity,e),s=Yie(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?Mu(n.map(l=>Mu(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=he({},l,u);r||(f.$max=Mu(c.values||[])),l[a]=Qie(c,f,s.dep?s:vn(s(f)),o.dep?o:vn(o(f)))}),t.reflow(!0).modifies(a)}});function Yie(e,t){let n;return pe(e)?(n=r=>xa(e(r,t)),n.dep=W9(e)):n=vn(xa(e||"#888")),n}function Xie(e,t){let n;return pe(e)?(n=r=>e(r,t),n.dep=W9(e)):e?n=vn(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function W9(e){if(!pe(e))return!1;const t=Ci(dn(e));return t.$x||t.$y||t.$value||t.$max}function Qie(e,t,n,r){const i=e.width,o=e.height,s=e.x1||0,a=e.y1||0,u=e.x2||i,l=e.y2||o,c=e.values,f=c?y=>c[y]:Is,d=ca(u-s,l-a),h=d.getContext("2d"),p=h.getImageData(0,0,u-s,l-a),g=p.data;for(let y=a,m=0;y<l;++y){t.$y=y-a;for(let v=s,x=y*i;v<u;++v,m+=4){t.$x=v-s,t.$value=f(v+x);const b=n(t);g[m+0]=b.r,g[m+1]=b.g,g[m+2]=b.b,g[m+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}function q9(e){P.call(this,null,e),this.modified(!0)}G(q9,P,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Jie(e.type),WE.forEach(r=>{e[r]!=null&&tN(n,r,e[r])})):WE.forEach(r=>{e.modified(r)&&tN(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Kie(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Kie(e,t){const n=Zie(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Jie(e){const t=CC((e||"mercator").toLowerCase());return t||z("Unrecognized projection type: "+e),t()}function tN(e,t,n){pe(e[t])&&e[t](n)}function Zie(e){return e=K(e),e.length===1?e[0]:{type:MC,features:e.reduce((t,n)=>t.concat(eoe(n)),[])}}function eoe(e){return e.type===MC?e.features:K(e).filter(t=>t!=null).map(t=>t.type===qE?t:{type:qE,geometry:t})}const toe=Object.freeze(Object.defineProperty({__proto__:null,contour:FC,geojson:OC,geopath:NC,geopoint:DC,geoshape:RC,graticule:PC,heatmap:LC,isocontour:AC,kde2d:TC,projection:q9},Symbol.toStringTag,{value:"Module"}));function noe(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var o,s=n.length,a,u=0,l=0;for(o=0;o<s;++o)a=n[o],u+=a.x,l+=a.y;for(u=(u/s-e)*r,l=(l/s-t)*r,o=0;o<s;++o)a=n[o],a.x-=u,a.y-=l}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(e=+o,i):e},i.y=function(o){return arguments.length?(t=+o,i):t},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function roe(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return H9(this.cover(t,n),t,n,e)}function H9(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o=e._root,s={data:r},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,g,y,m,v;if(!o)return e._root=s,e;for(;o.length;)if((g=t>=(f=(a+l)/2))?a=f:l=f,(y=n>=(d=(u+c)/2))?u=d:c=d,i=o,!(o=o[m=y<<1|g]))return i[m]=s,e;if(h=+e._x.call(null,o.data),p=+e._y.call(null,o.data),t===h&&n===p)return s.next=o,i?i[m]=s:e._root=s,e;do i=i?i[m]=new Array(4):e._root=new Array(4),(g=t>=(f=(a+l)/2))?a=f:l=f,(y=n>=(d=(u+c)/2))?u=d:c=d;while((m=y<<1|g)===(v=(p>=d)<<1|h>=f));return i[v]=o,i[m]=s,e}function ioe(e){var t,n,r=e.length,i,o,s=new Array(r),a=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(s[n]=i,a[n]=o,i<u&&(u=i),i>c&&(c=i),o<l&&(l=o),o>f&&(f=o));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)H9(this,s[n],a[n],e[n]);return this}function ooe(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var s=i-n||1,a=this._root,u,l;n>e||e>=i||r>t||t>=o;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=a,a=u,s*=2,l){case 0:i=n+s,o=r+s;break;case 1:n=i-s,o=r+s;break;case 2:i=n+s,r=o-s;break;case 3:n=i-s,r=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function soe(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function aoe(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function An(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function uoe(e,t,n){var r,i=this._x0,o=this._y0,s,a,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new An(h,i,o,c,f)),n==null?n=1/0:(i=e-n,o=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(s=p.x0)>c||(a=p.y0)>f||(u=p.x1)<i||(l=p.y1)<o))if(h.length){var y=(s+u)/2,m=(a+l)/2;d.push(new An(h[3],y,m,u,l),new An(h[2],s,m,y,l),new An(h[1],y,a,u,m),new An(h[0],s,a,y,m)),(g=(t>=m)<<1|e>=y)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var v=e-+this._x.call(null,h.data),x=t-+this._y.call(null,h.data),b=v*v+x*x;if(b<n){var w=Math.sqrt(n=b);i=e-w,o=t-w,c=e+w,f=t+w,r=h.data}}return r}function loe(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,o,s=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,g,y,m;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(s+u)/2))?s=d:u=d,(g=f>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[y=g<<1|p]))return this;if(!n.length)break;(t[y+1&3]||t[y+2&3]||t[y+3&3])&&(r=t,m=y)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):t?(o?t[y]=o:delete t[y],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[m]=n:this._root=n),this):(this._root=o,this)}function coe(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function foe(){return this._root}function doe(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function hoe(e){var t=[],n,r=this._root,i,o,s,a,u;for(r&&t.push(new An(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,o=n.x0,s=n.y0,a=n.x1,u=n.y1)&&r.length){var l=(o+a)/2,c=(s+u)/2;(i=r[3])&&t.push(new An(i,l,c,a,u)),(i=r[2])&&t.push(new An(i,o,c,l,u)),(i=r[1])&&t.push(new An(i,l,s,a,c)),(i=r[0])&&t.push(new An(i,o,s,l,c))}return this}function poe(e){var t=[],n=[],r;for(this._root&&t.push(new An(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var o,s=r.x0,a=r.y0,u=r.x1,l=r.y1,c=(s+u)/2,f=(a+l)/2;(o=i[0])&&t.push(new An(o,s,a,c,f)),(o=i[1])&&t.push(new An(o,c,a,u,f)),(o=i[2])&&t.push(new An(o,s,f,c,l)),(o=i[3])&&t.push(new An(o,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function goe(e){return e[0]}function moe(e){return arguments.length?(this._x=e,this):this._x}function yoe(e){return e[1]}function voe(e){return arguments.length?(this._y=e,this):this._y}function zC(e,t,n){var r=new IC(t??goe,n??yoe,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function IC(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function nN(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var zn=zC.prototype=IC.prototype;zn.copy=function(){var e=new IC(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=nN(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=nN(r));return e};zn.add=roe;zn.addAll=ioe;zn.cover=ooe;zn.data=soe;zn.extent=aoe;zn.find=uoe;zn.remove=loe;zn.removeAll=coe;zn.root=foe;zn.size=doe;zn.visit=hoe;zn.visitAfter=poe;zn.x=moe;zn.y=voe;function Tn(e){return function(){return e}}function Xs(e){return(e()-.5)*1e-6}function xoe(e){return e.x+e.vx}function boe(e){return e.y+e.vy}function woe(e){var t,n,r,i=1,o=1;typeof e!="function"&&(e=Tn(e==null?1:+e));function s(){for(var l,c=t.length,f,d,h,p,g,y,m=0;m<o;++m)for(f=zC(t,xoe,boe).visitAfter(a),l=0;l<c;++l)d=t[l],g=n[d.index],y=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(v);function v(x,b,w,S,E){var _=x.data,$=x.r,k=g+$;if(_){if(_.index>d.index){var A=h-_.x-_.vx,R=p-_.y-_.vy,C=A*A+R*R;C<k*k&&(A===0&&(A=Xs(r),C+=A*A),R===0&&(R=Xs(r),C+=R*R),C=(k-(C=Math.sqrt(C)))/C*i,d.vx+=(A*=C)*(k=($*=$)/(y+$)),d.vy+=(R*=C)*k,_.vx-=A*(k=1-k),_.vy-=R*k)}return}return b>h+k||S<h-k||w>p+k||E<p-k}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return s.initialize=function(l,c){t=l,r=c,u()},s.iterations=function(l){return arguments.length?(o=+l,s):o},s.strength=function(l){return arguments.length?(i=+l,s):i},s.radius=function(l){return arguments.length?(e=typeof l=="function"?l:Tn(+l),u(),s):e},s}function Eoe(e){return e.index}function rN(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Soe(e){var t=Eoe,n=f,r,i=Tn(30),o,s,a,u,l,c=1;e==null&&(e=[]);function f(y){return 1/Math.min(a[y.source.index],a[y.target.index])}function d(y){for(var m=0,v=e.length;m<c;++m)for(var x=0,b,w,S,E,_,$,k;x<v;++x)b=e[x],w=b.source,S=b.target,E=S.x+S.vx-w.x-w.vx||Xs(l),_=S.y+S.vy-w.y-w.vy||Xs(l),$=Math.sqrt(E*E+_*_),$=($-o[x])/$*y*r[x],E*=$,_*=$,S.vx-=E*(k=u[x]),S.vy-=_*k,w.vx+=E*(k=1-k),w.vy+=_*k}function h(){if(s){var y,m=s.length,v=e.length,x=new Map(s.map((w,S)=>[t(w,S,s),w])),b;for(y=0,a=new Array(m);y<v;++y)b=e[y],b.index=y,typeof b.source!="object"&&(b.source=rN(x,b.source)),typeof b.target!="object"&&(b.target=rN(x,b.target)),a[b.source.index]=(a[b.source.index]||0)+1,a[b.target.index]=(a[b.target.index]||0)+1;for(y=0,u=new Array(v);y<v;++y)b=e[y],u[y]=a[b.source.index]/(a[b.source.index]+a[b.target.index]);r=new Array(v),p(),o=new Array(v),g()}}function p(){if(s)for(var y=0,m=e.length;y<m;++y)r[y]=+n(e[y],y,e)}function g(){if(s)for(var y=0,m=e.length;y<m;++y)o[y]=+i(e[y],y,e)}return d.initialize=function(y,m){s=y,l=m,h()},d.links=function(y){return arguments.length?(e=y,h(),d):e},d.id=function(y){return arguments.length?(t=y,d):t},d.iterations=function(y){return arguments.length?(c=+y,d):c},d.strength=function(y){return arguments.length?(n=typeof y=="function"?y:Tn(+y),p(),d):n},d.distance=function(y){return arguments.length?(i=typeof y=="function"?y:Tn(+y),g(),d):i},d}var _oe={value:()=>{}};function V9(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Jm(n)}function Jm(e){this._=e}function koe(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Jm.prototype=V9.prototype={constructor:Jm,on:function(e,t){var n=this._,r=koe(e+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(e=r[o]).type)&&(i=$oe(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=r[o]).type)n[i]=iN(n[i],e.name,t);else if(t==null)for(i in n)n[i]=iN(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Jm(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function $oe(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function iN(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=_oe,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var of=0,Xd=0,md=0,G9=1e3,B1,Qd,U1=0,Ku=0,Ov=0,up=typeof performance=="object"&&performance.now?performance:Date,Y9=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function jC(){return Ku||(Y9(Coe),Ku=up.now()+Ov)}function Coe(){Ku=0}function W1(){this._call=this._time=this._next=null}W1.prototype=X9.prototype={constructor:W1,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?jC():+n)+(t==null?0:+t),!this._next&&Qd!==this&&(Qd?Qd._next=this:B1=this,Qd=this),this._call=e,this._time=n,HE()},stop:function(){this._call&&(this._call=null,this._time=1/0,HE())}};function X9(e,t,n){var r=new W1;return r.restart(e,t,n),r}function Aoe(){jC(),++of;for(var e=B1,t;e;)(t=Ku-e._time)>=0&&e._call.call(void 0,t),e=e._next;--of}function oN(){Ku=(U1=up.now())+Ov,of=Xd=0;try{Aoe()}finally{of=0,Foe(),Ku=0}}function Toe(){var e=up.now(),t=e-U1;t>G9&&(Ov-=t,U1=e)}function Foe(){for(var e,t=B1,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:B1=n);Qd=e,HE(r)}function HE(e){if(!of){Xd&&(Xd=clearTimeout(Xd));var t=e-Ku;t>24?(e<1/0&&(Xd=setTimeout(oN,e-up.now()-Ov)),md&&(md=clearInterval(md))):(md||(U1=up.now(),md=setInterval(Toe,G9)),of=1,Y9(oN))}}function Moe(e,t,n){var r=new W1,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(o,s,a){s=+s,a=a==null?jC():+a,r._restart(function u(l){l+=i,r._restart(u,i+=s,a),o(l)},s,a)},r.restart(e,t,n),r)}const Ooe=1664525,Noe=1013904223,sN=4294967296;function Doe(){let e=1;return()=>(e=(Ooe*e+Noe)%sN)/sN}function Roe(e){return e.x}function Poe(e){return e.y}var Loe=10,zoe=Math.PI*(3-Math.sqrt(5));function Ioe(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,u=X9(f),l=V9("tick","end"),c=Doe();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(g){var y,m=e.length,v;g===void 0&&(g=1);for(var x=0;x<g;++x)for(n+=(o-n)*i,a.forEach(function(b){b(n)}),y=0;y<m;++y)v=e[y],v.fx==null?v.x+=v.vx*=s:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=s:(v.y=v.fy,v.vy=0);return t}function h(){for(var g=0,y=e.length,m;g<y;++g){if(m=e[g],m.index=g,m.fx!=null&&(m.x=m.fx),m.fy!=null&&(m.y=m.fy),isNaN(m.x)||isNaN(m.y)){var v=Loe*Math.sqrt(.5+g),x=g*zoe;m.x=v*Math.cos(x),m.y=v*Math.sin(x)}(isNaN(m.vx)||isNaN(m.vy))&&(m.vx=m.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),a.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(o=+g,t):o},velocityDecay:function(g){return arguments.length?(s=1-g,t):1-s},randomSource:function(g){return arguments.length?(c=g,a.forEach(p),t):c},force:function(g,y){return arguments.length>1?(y==null?a.delete(g):a.set(g,p(y)),t):a.get(g)},find:function(g,y,m){var v=0,x=e.length,b,w,S,E,_;for(m==null?m=1/0:m*=m,v=0;v<x;++v)E=e[v],b=g-E.x,w=y-E.y,S=b*b+w*w,S<m&&(_=E,m=S);return _},on:function(g,y){return arguments.length>1?(l.on(g,y),t):l.on(g)}}}function joe(){var e,t,n,r,i=Tn(-30),o,s=1,a=1/0,u=.81;function l(h){var p,g=e.length,y=zC(e,Roe,Poe).visitAfter(f);for(r=h,p=0;p<g;++p)t=e[p],y.visit(d)}function c(){if(e){var h,p=e.length,g;for(o=new Array(p),h=0;h<p;++h)g=e[h],o[g.index]=+i(g,h,e)}}function f(h){var p=0,g,y,m=0,v,x,b;if(h.length){for(v=x=b=0;b<4;++b)(g=h[b])&&(y=Math.abs(g.value))&&(p+=g.value,m+=y,v+=y*g.x,x+=y*g.y);h.x=v/m,h.y=x/m}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=o[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,y){if(!h.value)return!0;var m=h.x-t.x,v=h.y-t.y,x=y-p,b=m*m+v*v;if(x*x/u<b)return b<a&&(m===0&&(m=Xs(n),b+=m*m),v===0&&(v=Xs(n),b+=v*v),b<s&&(b=Math.sqrt(s*b)),t.vx+=m*h.value*r/b,t.vy+=v*h.value*r/b),!0;if(h.length||b>=a)return;(h.data!==t||h.next)&&(m===0&&(m=Xs(n),b+=m*m),v===0&&(v=Xs(n),b+=v*v),b<s&&(b=Math.sqrt(s*b)));do h.data!==t&&(x=o[h.data.index]*r/b,t.vx+=m*x,t.vy+=v*x);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(i=typeof h=="function"?h:Tn(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.distanceMax=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function Boe(e){var t=Tn(.1),n,r,i;typeof e!="function"&&(e=Tn(e==null?0:+e));function o(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Tn(+a),s(),o):t},o.x=function(a){return arguments.length?(e=typeof a=="function"?a:Tn(+a),s(),o):e},o}function Uoe(e){var t=Tn(.1),n,r,i;typeof e!="function"&&(e=Tn(e==null?0:+e));function o(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Tn(+a),s(),o):t},o.y=function(a){return arguments.length?(e=typeof a=="function"?a:Tn(+a),s(),o):e},o}const aN={center:noe,collide:woe,nbody:joe,link:Soe,x:Boe,y:Uoe},Kd="forces",VE=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Woe=["static","iterations"],Q9=["x","y","vx","vy"];function BC(e){P.call(this,null,e)}BC.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:Q9}]};G(BC,P,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(VE),o=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&K9(n,e,0,t)):(this.value=n=Hoe(t.source,e),n.on("tick",qoe(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(Woe)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,u=0,l=a.length,c;u<l;++u)if(c=a[u],!(c.name!==Kd||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,o=r.length,s;i<o;++i)if(r[i].name==="links"&&(s=r[i].op.source)){n.pulse(s,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(Q9)}});function qoe(e,t){return()=>e.touch(t).run()}function Hoe(e,t){const n=Ioe(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),K9(n,t,!0).on("end",()=>o=!0)}function K9(e,t,n,r){var i=K(t.forces),o,s,a,u;for(o=0,s=VE.length;o<s;++o)a=VE[o],a!==Kd&&t.modified(a)&&e[a](t[a]);for(o=0,s=i.length;o<s;++o)u=Kd+o,a=n||t.modified(Kd,o)?Goe(i[o]):r&&Voe(i[o],r)?e.force(u):null,a&&e.force(u,a);for(s=e.numForces||0;o<s;++o)e.force(Kd+o,null);return e.numForces=i.length,e}function Voe(e,t){var n,r;for(n in e)if(pe(r=e[n])&&t.modified(dn(r)))return 1;return 0}function Goe(e){var t,n;ae(aN,e.force)||z("Unrecognized force: "+e.force),t=aN[e.force]();for(n in e)pe(t[n])&&Yoe(t[n],e[n],e);return t}function Yoe(e,t,n){e(pe(t)?r=>t(r,n):t)}const Xoe=Object.freeze(Object.defineProperty({__proto__:null,force:BC},Symbol.toStringTag,{value:"Module"}));function Qoe(e,t){return e.parent===t.parent?1:2}function Koe(e){return e.reduce(Joe,0)/e.length}function Joe(e,t){return e+t.x}function Zoe(e){return 1+e.reduce(ese,0)}function ese(e,t){return Math.max(e,t.y)}function tse(e){for(var t;t=e.children;)e=t[0];return e}function nse(e){for(var t;t=e.children;)e=t[t.length-1];return e}function rse(){var e=Qoe,t=1,n=1,r=!1;function i(o){var s,a=0;o.eachAfter(function(d){var h=d.children;h?(d.x=Koe(h),d.y=Zoe(h)):(d.x=s?a+=e(d,s):0,d.y=0,s=d)});var u=tse(o),l=nse(o),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return o.eachAfter(r?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return i.separation=function(o){return arguments.length?(e=o,i):e},i.size=function(o){return arguments.length?(r=!1,t=+o[0],n=+o[1],i):r?null:[t,n]},i.nodeSize=function(o){return arguments.length?(r=!0,t=+o[0],n=+o[1],i):r?[t,n]:null},i}function ise(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function ose(){return this.eachAfter(ise)}function sse(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function ase(e,t){for(var n=this,r=[n],i,o,s=-1;n=r.pop();)if(e.call(t,n,++s,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function use(e,t){for(var n=this,r=[n],i=[],o,s,a,u=-1;n=r.pop();)if(i.push(n),o=n.children)for(s=0,a=o.length;s<a;++s)r.push(o[s]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function lse(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function cse(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function fse(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function dse(e){for(var t=this,n=hse(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function hse(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function pse(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function gse(){return Array.from(this)}function mse(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function yse(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*vse(){var e=this,t,n=[e],r,i,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function UC(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=wse)):t===void 0&&(t=bse);for(var n=new sf(e),r,i=[n],o,s,a,u;r=i.pop();)if((s=t(r.data))&&(u=(s=Array.from(s)).length))for(r.children=s,a=u-1;a>=0;--a)i.push(o=s[a]=new sf(s[a])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(J9)}function xse(){return UC(this).eachBefore(Ese)}function bse(e){return e.children}function wse(e){return Array.isArray(e)?e[1]:null}function Ese(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function J9(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function sf(e){this.data=e,this.depth=this.height=0,this.parent=null}sf.prototype=UC.prototype={constructor:sf,count:ose,each:sse,eachAfter:use,eachBefore:ase,find:lse,sum:cse,sort:fse,path:dse,ancestors:pse,descendants:gse,leaves:mse,links:yse,copy:xse,[Symbol.iterator]:vse};function Zm(e){return e==null?null:Z9(e)}function Z9(e){if(typeof e!="function")throw new Error;return e}function vu(){return 0}function Yl(e){return function(){return e}}const Sse=1664525,_se=1013904223,uN=4294967296;function kse(){let e=1;return()=>(e=(Sse*e+_se)%uN)/uN}function $se(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Cse(e,t){let n=e.length,r,i;for(;n;)i=t()*n--|0,r=e[n],e[n]=e[i],e[i]=r;return e}function Ase(e,t){for(var n=0,r=(e=Cse(Array.from(e),t)).length,i=[],o,s;n<r;)o=e[n],s&&e7(s,o)?++n:(s=Fse(i=Tse(i,o)),n=0);return s}function Tse(e,t){var n,r;if(W2(t,e))return[t];for(n=0;n<e.length;++n)if(um(t,e[n])&&W2(Jd(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(um(Jd(e[n],e[r]),t)&&um(Jd(e[n],t),e[r])&&um(Jd(e[r],t),e[n])&&W2(t7(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function um(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function e7(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function W2(e,t){for(var n=0;n<t.length;++n)if(!e7(e,t[n]))return!1;return!0}function Fse(e){switch(e.length){case 1:return Mse(e[0]);case 2:return Jd(e[0],e[1]);case 3:return t7(e[0],e[1],e[2])}}function Mse(e){return{x:e.x,y:e.y,r:e.r}}function Jd(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,s=t.y,a=t.r,u=o-n,l=s-r,c=a-i,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(r+s+l/f*c)/2,r:(f+i+a)/2}}function t7(e,t,n){var r=e.x,i=e.y,o=e.r,s=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-s,h=r-l,p=i-a,g=i-c,y=u-o,m=f-o,v=r*r+i*i-o*o,x=v-s*s-a*a+u*u,b=v-l*l-c*c+f*f,w=h*p-d*g,S=(p*b-g*x)/(w*2)-r,E=(g*y-p*m)/w,_=(h*x-d*b)/(w*2)-i,$=(d*m-h*y)/w,k=E*E+$*$-1,A=2*(o+S*E+_*$),R=S*S+_*_-o*o,C=-(Math.abs(k)>1e-6?(A+Math.sqrt(A*A-4*k*R))/(2*k):R/A);return{x:r+S+E*C,y:i+_+$*C,r:C}}function lN(e,t,n){var r=e.x-t.x,i,o,s=e.y-t.y,a,u,l=r*r+s*s;l?(o=t.r+n.r,o*=o,u=e.r+n.r,u*=u,o>u?(i=(l+u-o)/(2*l),a=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-a*s,n.y=e.y-i*s+a*r):(i=(l+o-u)/(2*l),a=Math.sqrt(Math.max(0,o/l-i*i)),n.x=t.x+i*r-a*s,n.y=t.y+i*s+a*r)):(n.x=t.x+n.r,n.y=t.y)}function cN(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function fN(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function lm(e){this._=e,this.next=null,this.previous=null}function Ose(e,t){if(!(o=(e=$se(e)).length))return 0;var n,r,i,o,s,a,u,l,c,f,d;if(n=e[0],n.x=0,n.y=0,!(o>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;lN(r,n,i=e[2]),n=new lm(n),r=new lm(r),i=new lm(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(u=3;u<o;++u){lN(n._,r._,i=e[u]),i=new lm(i),l=r.next,c=n.previous,f=r._.r,d=n._.r;do if(f<=d){if(cN(l._,i._)){r=l,n.next=r,r.previous=n,--u;continue e}f+=l._.r,l=l.next}else{if(cN(c._,i._)){n=c,n.next=r,r.previous=n,--u;continue e}d+=c._.r,c=c.previous}while(l!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,s=fN(n);(i=i.next)!==r;)(a=fN(i))<s&&(n=i,s=a);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=Ase(n,t),u=0;u<o;++u)n=e[u],n.x-=i.x,n.y-=i.y;return i.r}function Nse(e){return Math.sqrt(e.value)}function Dse(){var e=null,t=1,n=1,r=vu;function i(o){const s=kse();return o.x=t/2,o.y=n/2,e?o.eachBefore(dN(e)).eachAfter(q2(r,.5,s)).eachBefore(hN(1)):o.eachBefore(dN(Nse)).eachAfter(q2(vu,1,s)).eachAfter(q2(r,o.r/Math.min(t,n),s)).eachBefore(hN(Math.min(t,n)/(2*o.r))),o}return i.radius=function(o){return arguments.length?(e=Zm(o),i):e},i.size=function(o){return arguments.length?(t=+o[0],n=+o[1],i):[t,n]},i.padding=function(o){return arguments.length?(r=typeof o=="function"?o:Yl(+o),i):r},i}function dN(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function q2(e,t,n){return function(r){if(i=r.children){var i,o,s=i.length,a=e(r)*t||0,u;if(a)for(o=0;o<s;++o)i[o].r+=a;if(u=Ose(i,n),a)for(o=0;o<s;++o)i[o].r-=a;r.r=u+a}}}function hN(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function n7(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function ng(e,t,n,r,i){for(var o=e.children,s,a=-1,u=o.length,l=e.value&&(r-t)/e.value;++a<u;)s=o[a],s.y0=n,s.y1=i,s.x0=t,s.x1=t+=s.value*l}function Rse(){var e=1,t=1,n=0,r=!1;function i(s){var a=s.height+1;return s.x0=s.y0=n,s.x1=e,s.y1=t/a,s.eachBefore(o(t,a)),r&&s.eachBefore(n7),s}function o(s,a){return function(u){u.children&&ng(u,u.x0,s*(u.depth+1)/a,u.x1,s*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(s){return arguments.length?(r=!!s,i):r},i.size=function(s){return arguments.length?(e=+s[0],t=+s[1],i):[e,t]},i.padding=function(s){return arguments.length?(n=+s,i):n},i}var Pse={depth:-1},pN={},H2={};function Lse(e){return e.id}function zse(e){return e.parentId}function gN(){var e=Lse,t=zse,n;function r(i){var o=Array.from(i),s=e,a=t,u,l,c,f,d,h,p,g,y=new Map;if(n!=null){const m=o.map((b,w)=>Ise(n(b,w,i))),v=m.map(mN),x=new Set(m).add("");for(const b of v)x.has(b)||(x.add(b),m.push(b),v.push(mN(b)),o.push(H2));s=(b,w)=>m[w],a=(b,w)=>v[w]}for(c=0,u=o.length;c<u;++c)l=o[c],h=o[c]=new sf(l),(p=s(l,c,i))!=null&&(p+="")&&(g=h.id=p,y.set(g,y.has(g)?pN:h)),(p=a(l,c,i))!=null&&(p+="")&&(h.parent=p);for(c=0;c<u;++c)if(h=o[c],p=h.parent){if(d=y.get(p),!d)throw new Error("missing: "+p);if(d===pN)throw new Error("ambiguous: "+p);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(n!=null){for(;f.data===H2&&f.children.length===1;)f=f.children[0],--u;for(let m=o.length-1;m>=0&&(h=o[m],h.data===H2);--m)h.data=null}if(f.parent=Pse,f.eachBefore(function(m){m.depth=m.parent.depth+1,--u}).eachBefore(J9),f.parent=null,u>0)throw new Error("cycle");return f}return r.id=function(i){return arguments.length?(e=Zm(i),r):e},r.parentId=function(i){return arguments.length?(t=Zm(i),r):t},r.path=function(i){return arguments.length?(n=Zm(i),r):n},r}function Ise(e){e=`${e}`;let t=e.length;return GE(e,t-1)&&!GE(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function mN(e){let t=e.length;if(t<2)return"";for(;--t>1&&!GE(e,t););return e.slice(0,t)}function GE(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function jse(e,t){return e.parent===t.parent?1:2}function V2(e){var t=e.children;return t?t[0]:e.t}function G2(e){var t=e.children;return t?t[t.length-1]:e.t}function Bse(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Use(e){for(var t=0,n=0,r=e.children,i=r.length,o;--i>=0;)o=r[i],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function Wse(e,t,n){return e.a.parent===t.parent?e.a:n}function e0(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}e0.prototype=Object.create(sf.prototype);function qse(e){for(var t=new e0(e,0),n,r=[t],i,o,s,a;n=r.pop();)if(o=n._.children)for(n.children=new Array(a=o.length),s=a-1;s>=0;--s)r.push(i=n.children[s]=new e0(o[s],s)),i.parent=n;return(t.parent=new e0(null,0)).children=[t],t}function Hse(){var e=jse,t=1,n=1,r=null;function i(l){var c=qse(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(s),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var p=f===d?1:e(f,d)/2,g=p-f.x,y=t/(d.x+p+g),m=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+g)*y,v.y=v.depth*m})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){Use(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,h=l,p=c,g=d.parent.children[0],y=d.m,m=h.m,v=p.m,x=g.m,b;p=G2(p),d=V2(d),p&&d;)g=V2(g),h=G2(h),h.a=l,b=p.z+v-d.z-y+e(p._,d._),b>0&&(Bse(Wse(p,l,f),l,b),y+=b,m+=b),v+=p.m,y+=d.m,x+=g.m,m+=h.m;p&&!G2(h)&&(h.t=p,h.m+=v-m),d&&!V2(g)&&(g.t=d,g.m+=y-x,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function Nv(e,t,n,r,i){for(var o=e.children,s,a=-1,u=o.length,l=e.value&&(i-n)/e.value;++a<u;)s=o[a],s.x0=t,s.x1=r,s.y0=n,s.y1=n+=s.value*l}var r7=(1+Math.sqrt(5))/2;function i7(e,t,n,r,i,o){for(var s=[],a=t.children,u,l,c=0,f=0,d=a.length,h,p,g=t.value,y,m,v,x,b,w,S;c<d;){h=i-n,p=o-r;do y=a[f++].value;while(!y&&f<d);for(m=v=y,w=Math.max(p/h,h/p)/(g*e),S=y*y*w,b=Math.max(v/S,S/m);f<d;++f){if(y+=l=a[f].value,l<m&&(m=l),l>v&&(v=l),S=y*y*w,x=Math.max(v/S,S/m),x>b){y-=l;break}b=x}s.push(u={value:y,dice:h<p,children:a.slice(c,f)}),u.dice?ng(u,n,r,i,g?r+=p*y/g:o):Nv(u,n,r,g?n+=h*y/g:i,o),g-=y,c=f}return s}const o7=function e(t){function n(r,i,o,s,a){i7(t,r,i,o,s,a)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(r7);function Vse(){var e=o7,t=!1,n=1,r=1,i=[0],o=vu,s=vu,a=vu,u=vu,l=vu;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(n7),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,y=d.x1-h,m=d.y1-h;y<p&&(p=y=(p+y)/2),m<g&&(g=m=(g+m)/2),d.x0=p,d.y0=g,d.x1=y,d.y1=m,d.children&&(h=i[d.depth+1]=o(d)/2,p+=l(d)-h,g+=s(d)-h,y-=a(d)-h,m-=u(d)-h,y<p&&(p=y=(p+y)/2),m<g&&(g=m=(g+m)/2),e(d,p,g,y,m))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=Z9(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:Yl(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(s=typeof d=="function"?d:Yl(+d),c):s},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:Yl(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:Yl(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:Yl(+d),c):l},c}function Gse(e,t,n,r,i){var o=e.children,s,a=o.length,u,l=new Array(a+1);for(l[0]=u=s=0;s<a;++s)l[s+1]=u+=o[s].value;c(0,a,e.value,t,n,r,i);function c(f,d,h,p,g,y,m){if(f>=d-1){var v=o[f];v.x0=p,v.y0=g,v.x1=y,v.y1=m;return}for(var x=l[f],b=h/2+x,w=f+1,S=d-1;w<S;){var E=w+S>>>1;l[E]<b?w=E+1:S=E}b-l[w-1]<l[w]-b&&f+1<w&&--w;var _=l[w]-x,$=h-_;if(y-p>m-g){var k=h?(p*$+y*_)/h:y;c(f,w,_,p,g,k,m),c(w,d,$,k,g,y,m)}else{var A=h?(g*$+m*_)/h:m;c(f,w,_,p,g,y,A),c(w,d,$,p,A,y,m)}}}function Yse(e,t,n,r,i){(e.depth&1?Nv:ng)(e,t,n,r,i)}const Xse=function e(t){function n(r,i,o,s,a){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,g=r.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?ng(l,i,o,s,g?o+=(a-o)*l.value/g:a):Nv(l,i,o,g?i+=(s-i)*l.value/g:s,a),g-=l.value}else r._squarify=u=i7(t,r,i,o,s,a),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(r7);function YE(e,t,n){const r={};return e.each(i=>{const o=i.data;n(o)&&(r[t(o)]=i)}),e.lookup=r,e}function WC(e){P.call(this,null,e)}WC.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Qse=e=>e.values;G(WC,P,{transform(e,t){t.source||z("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each(s=>{s.children&&Gy(s.data)&&i.rem.push(s.data)}),this.value=o=UC({values:K(e.keys).reduce((s,a)=>(s.key(a),s),Kse()).entries(i.source)},Qse),n&&o.each(s=>{s.children&&(s=Ne(s.data),i.add.push(s),i.source.push(s))}),YE(o,oe,oe)),i.source.root=o,i}});function Kse(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,o){if(o>=e.length)return i;const s=i.length,a=e[o++],u={},l={};let c=-1,f,d,h;for(;++c<s;)f=a(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],o);return l}function r(i,o){if(++o>e.length)return i;const s=[];for(const a in i)s.push({key:a,values:r(i[a],o)});return s}return t}function ms(e){P.call(this,null,e)}const Jse=(e,t)=>e.parent===t.parent?1:2;G(ms,P,{transform(e,t){(!t.source||!t.source.root)&&z(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(xl(e.sort,s=>s.data)),Zse(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Jse:kf);try{this.value=n(i)}catch(s){z(s)}return i.each(s=>eae(s,r,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function Zse(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}function eae(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}const XE=["x","y","r","depth","children"];function qC(e){ms.call(this,e)}qC.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:XE.length,default:XE}]};G(qC,ms,{layout:Dse,params:["radius","size","padding"],fields:XE});const QE=["x0","y0","x1","y1","depth","children"];function HC(e){ms.call(this,e)}HC.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:QE.length,default:QE}]};G(HC,ms,{layout:Rse,params:["size","round","padding"],fields:QE});function VC(e){P.call(this,null,e)}VC.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};G(VC,P,{transform(e,t){t.source||z("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?YE(gN().id(e.key).parentId(e.parentKey)(i.source),e.key,qr):YE(gN()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const yN={tidy:Hse,cluster:rse},KE=["x","y","depth","children"];function GC(e){ms.call(this,e)}GC.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:KE.length,default:KE}]};G(GC,ms,{layout(e){const t=e||"tidy";if(ae(yN,t))return yN[t]();z("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:KE});function YC(e){P.call(this,[],e)}YC.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};G(YC,P,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||z("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,s=>o[oe(s)]=1),r.each(s=>{const a=s.data,u=s.parent&&s.parent.data;u&&o[oe(a)]&&o[oe(u)]&&i.add.push(Ne({source:u,target:a}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,s=>o[oe(s)]=1),n.forEach(s=>{(o[oe(s.source)]||o[oe(s.target)])&&i.mod.push(s)})),i}});const vN={binary:Gse,dice:ng,slice:Nv,slicedice:Yse,squarify:o7,resquarify:Xse},JE=["x0","y0","x1","y1","depth","children"];function XC(e){ms.call(this,e)}XC.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:JE.length,default:JE}]};G(XC,ms,{layout(){const e=Vse();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ae(vN,t)?e.tile(vN[t]):z("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:JE});const tae=Object.freeze(Object.defineProperty({__proto__:null,nest:WC,pack:qC,partition:HC,stratify:VC,tree:GC,treelinks:YC,treemap:XC},Symbol.toStringTag,{value:"Module"})),Y2=4278190080;function nae(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function rae(e,t,n,r,i){const o=e.width,s=e.height,a=r||i,u=ca(o,s).getContext("2d"),l=ca(o,s).getContext("2d"),c=a&&ca(o,s).getContext("2d");n.forEach(_=>t0(u,_,!1)),t0(l,t,!1),a&&t0(c,t,!0);const f=X2(u,o,s),d=X2(l,o,s),h=a&&X2(c,o,s),p=e.bitmap(),g=a&&e.bitmap();let y,m,v,x,b,w,S,E;for(m=0;m<s;++m)for(y=0;y<o;++y)b=m*o+y,w=f[b]&Y2,E=d[b]&Y2,S=a&&h[b]&Y2,(w||S||E)&&(v=e(y),x=e(m),!i&&(w||E)&&p.set(v,x),a&&(w||S)&&g.set(v,x));return[p,g]}function X2(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function t0(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(o=>t0(e,o.items,n))}):kr[r].draw(e,{items:n?t.map(iae):t})}function iae(e){const t=Yy(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const No=5,bn=31,lp=32,Rs=new Uint32Array(lp+1),fi=new Uint32Array(lp+1);fi[0]=0;Rs[0]=~fi[0];for(let e=1;e<=lp;++e)fi[e]=fi[e-1]<<1|1,Rs[e]=~fi[e];function oae(e,t){const n=new Uint32Array(~~((e*t+lp)/lp));function r(o,s){n[o]|=s}function i(o,s){n[o]&=s}return{array:n,get:(o,s)=>{const a=s*e+o;return n[a>>>No]&1<<(a&bn)},set:(o,s)=>{const a=s*e+o;r(a>>>No,1<<(a&bn))},clear:(o,s)=>{const a=s*e+o;i(a>>>No,~(1<<(a&bn)))},getRange:(o,s,a,u)=>{let l=u,c,f,d,h;for(;l>=s;--l)if(c=l*e+o,f=l*e+a,d=c>>>No,h=f>>>No,d===h){if(n[d]&Rs[c&bn]&fi[(f&bn)+1])return!0}else{if(n[d]&Rs[c&bn]||n[h]&fi[(f&bn)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(o,s,a,u)=>{let l,c,f,d,h;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>No,d=c>>>No,f===d)r(f,Rs[l&bn]&fi[(c&bn)+1]);else for(r(f,Rs[l&bn]),r(d,fi[(c&bn)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(o,s,a,u)=>{let l,c,f,d,h;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>No,d=c>>>No,f===d)i(f,fi[l&bn]|Rs[(c&bn)+1]);else for(i(f,fi[l&bn]),i(d,Rs[(c&bn)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(o,s,a,u)=>o<0||s<0||u>=t||a>=e}}function sae(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),s=a=>~~((a+n)/r);return s.invert=a=>a*r-n,s.bitmap=()=>oae(i,o),s.ratio=r,s.padding=n,s.width=e,s.height=t,s}function aae(e,t,n,r){const i=e.width,o=e.height;return function(s){const a=s.datum.datum.items[r].items,u=a.length,l=s.datum.fontSize,c=Ei.width(s.datum,s.datum.text);let f=0,d,h,p,g,y,m,v;for(let x=0;x<u;++x)d=a[x].x,p=a[x].y,h=a[x].x2===void 0?d:a[x].x2,g=a[x].y2===void 0?p:a[x].y2,y=(d+h)/2,m=(p+g)/2,v=Math.abs(h-d+g-p),v>=f&&(f=v,s.x=y,s.y=m);return y=c/2,m=l/2,d=s.x-y,h=s.x+y,p=s.y-m,g=s.y+m,s.align="center",d<0&&h<=i?s.align="left":0<=d&&i<h&&(s.align="right"),s.baseline="middle",p<0&&g<=o?s.baseline="top":0<=p&&o<g&&(s.baseline="bottom"),!0}}function q1(e,t,n,r,i,o){let s=n/2;return e-s<0||e+s>i||t-(s=r/2)<0||t+s>o}function Qs(e,t,n,r,i,o,s,a){const u=i*o/(r*2),l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return s.outOfBounds(l,f,c,d)||s.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function uae(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1];function u(l,c,f,d,h){const p=e.invert(l),g=e.invert(c);let y=f,m=o,v;if(!q1(p,g,d,h,i,o)&&!Qs(e,p,g,h,d,y,s,a)&&!Qs(e,p,g,h,d,h,s,null)){for(;m-y>=1;)v=(y+m)/2,Qs(e,p,g,h,d,v,s,a)?m=v:y=v;if(y>f)return[p,g,y,!0]}}return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=Ei.width(l.datum,l.datum.text);let p=n?d:0,g=!1,y=!1,m=0,v,x,b,w,S,E,_,$,k,A,R,C,F,T,O,D,M;for(let N=0;N<f;++N){for(v=c[N].x,b=c[N].y,x=c[N].x2===void 0?v:c[N].x2,w=c[N].y2===void 0?b:c[N].y2,v>x&&(M=v,v=x,x=M),b>w&&(M=b,b=w,w=M),k=e(v),R=e(x),A=~~((k+R)/2),C=e(b),T=e(w),F=~~((C+T)/2),_=A;_>=k;--_)for($=F;$>=C;--$)D=u(_,$,p,h,d),D&&([l.x,l.y,p,g]=D);for(_=A;_<=R;++_)for($=F;$<=T;++$)D=u(_,$,p,h,d),D&&([l.x,l.y,p,g]=D);!g&&!n&&(O=Math.abs(x-v+w-b),S=(v+x)/2,E=(b+w)/2,O>=m&&!q1(S,E,h,d,i,o)&&!Qs(e,S,E,d,h,d,s,null)&&(m=O,l.x=S,l.y=E,y=!0))}return g||y?(S=h/2,E=d/2,s.setRange(e(l.x-S),e(l.y-E),e(l.x+S),e(l.y+E)),l.align="center",l.baseline="middle",!0):!1}}const lae=[-1,-1,1,1],cae=[-1,1,-1,1];function fae(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=Ei.width(l.datum,l.datum.text),p=[];let g=n?d:0,y=!1,m=!1,v=0,x,b,w,S,E,_,$,k,A,R,C,F;for(let T=0;T<f;++T){for(x=c[T].x,w=c[T].y,b=c[T].x2===void 0?x:c[T].x2,S=c[T].y2===void 0?w:c[T].y2,p.push([e((x+b)/2),e((w+S)/2)]);p.length;)if([$,k]=p.pop(),!(s.get($,k)||a.get($,k)||u.get($,k))){u.set($,k);for(let O=0;O<4;++O)E=$+lae[O],_=k+cae[O],u.outOfBounds(E,_,E,_)||p.push([E,_]);if(E=e.invert($),_=e.invert(k),A=g,R=o,!q1(E,_,h,d,i,o)&&!Qs(e,E,_,d,h,A,s,a)&&!Qs(e,E,_,d,h,d,s,null)){for(;R-A>=1;)C=(A+R)/2,Qs(e,E,_,d,h,C,s,a)?R=C:A=C;A>g&&(l.x=E,l.y=_,g=A,y=!0)}}!y&&!n&&(F=Math.abs(b-x+S-w),E=(x+b)/2,_=(w+S)/2,F>=v&&!q1(E,_,h,d,i,o)&&!Qs(e,E,_,d,h,d,s,null)&&(v=F,l.x=E,l.y=_,m=!0))}return y||m?(E=h/2,_=d/2,s.setRange(e(l.x-E),e(l.y-_),e(l.x+E),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}const dae=["right","center","left"],hae=["bottom","middle","top"];function pae(e,t,n,r){const i=e.width,o=e.height,s=t[0],a=t[1],u=r.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>o)return!1;let d=l.textWidth??0,h,p,g,y,m,v,x,b,w,S,E,_,$,k,A;for(let R=0;R<u;++R){if(h=(n[R]&3)-1,p=(n[R]>>>2&3)-1,g=h===0&&p===0||r[R]<0,y=h&&p?Math.SQRT1_2:1,m=r[R]<0?-1:1,v=c[1+h]+r[R]*h*y,E=c[4+p]+m*f*p/2+r[R]*p*y,b=E-f/2,w=E+f/2,_=e(v),k=e(b),A=e(w),!d)if(xN(_,_,k,A,s,a,v,v,b,w,c,g))d=Ei.width(l.datum,l.datum.text);else continue;if(S=v+m*d*h/2,v=S-d/2,x=S+d/2,_=e(v),$=e(x),xN(_,$,k,A,s,a,v,x,b,w,c,g))return l.x=h?h*m<0?x:v:S,l.y=p?p*m<0?w:b:E,l.align=dae[h*m+1],l.baseline=hae[p*m+1],s.setRange(_,k,$,A),!0}return!1}}function xN(e,t,n,r,i,o,s,a,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o||i).getRange(e,n,t,r))}const Q2=0,K2=4,J2=8,Z2=0,eb=1,tb=2,gae={"top-left":Q2+Z2,top:Q2+eb,"top-right":Q2+tb,left:K2+Z2,middle:K2+eb,right:K2+tb,"bottom-left":J2+Z2,bottom:J2+eb,"bottom-right":J2+tb},mae={naive:aae,"reduced-search":uae,floodfill:fae};function yae(e,t,n,r,i,o,s,a,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=vae(r,f),h=xae(i,f),p=bae(e[0].datum),g=p==="group"&&e[0].datum.items[u].marktype,y=g==="area",m=wae(p,g,a,u),v=l===null||l===1/0,x=y&&c==="naive";let b=-1,w=-1;const S=e.map(k=>{const A=v?Ei.width(k,k.text):void 0;return b=Math.max(b,A),w=Math.max(w,k.fontSize),{datum:k,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:m(k),textWidth:A}});l=l===null||l===1/0?Math.max(b,w)+Math.max(...r):l;const E=sae(t[0],t[1],l);let _;if(!x){n&&S.sort((R,C)=>n(R.datum,C.datum));let k=!1;for(let R=0;R<h.length&&!k;++R)k=h[R]===5||d[R]<0;const A=(p&&s||y)&&e.map(R=>R.datum);_=o.length||A?rae(E,A||[],o,k,y):nae(E,s&&S)}const $=y?mae[c](E,_,s,u):pae(E,_,h,d);return S.forEach(k=>k.opacity=+$(k)),S}function vae(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function xae(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=gae[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function bae(e){return e&&e.mark&&e.mark.marktype}function wae(e,t,n,r){const i=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>i(o.datum):t==="line"?o=>{const s=o.datum.items[r].items;return i(s.length?s[n==="start"?0:s.length-1]:{x:NaN,y:NaN})}:o=>{const s=o.datum.bounds;return[s.x1,(s.x1+s.x2)/2,s.x2,s.y1,(s.y1+s.y2)/2,s.y2]}:i}const ZE=["x","y","opacity","align","baseline"],s7=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function QC(e){P.call(this,null,e)}QC.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:s7},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:ZE.length,default:ZE}]};G(QC,P,{transform(e,t){function n(o){const s=e[o];return pe(s)&&t.modified(s.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&z("Size parameter should be specified as a [width, height] array.");const i=e.as||ZE;return yae(t.materialize(t.SOURCE).source||[],e.size,e.sort,K(e.offset==null?1:e.offset),K(e.anchor||s7),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{const s=o.datum;s[i[0]]=o.x,s[i[1]]=o.y,s[i[2]]=o.opacity,s[i[3]]=o.align,s[i[4]]=o.baseline}),t.reflow(r).modifies(i)}});const Eae=Object.freeze(Object.defineProperty({__proto__:null,label:QC},Symbol.toStringTag,{value:"Module"}));function a7(e,t){var n=[],r=function(c){return c(a)},i,o,s,a,u,l;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function KC(e){P.call(this,null,e)}KC.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};G(KC,P,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=a7(r,e.groupby),o=(e.groupby||[]).map(ct),s=o.length,a=e.as||[ct(e.x),ct(e.y)],u=[];i.forEach(l=>{w6(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<s;++d)f[o[d]]=l.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],u.push(Ne(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const eS={constant:Tk,linear:Fk,log:y6,exp:v6,pow:x6,quad:Mk,poly:b6},Sae=(e,t)=>e==="poly"?t:e==="quad"?2:1;function JC(e){P.call(this,null,e)}JC.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(eS)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};G(JC,P,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=a7(r,e.groupby),o=(e.groupby||[]).map(ct),s=e.method||"linear",a=e.order==null?3:e.order,u=Sae(s,a),l=e.as||[ct(e.x),ct(e.y)],c=eS[s],f=[];let d=e.extent;ae(eS,s)||z("Invalid regression method: "+s),d!=null&&s==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,a);if(e.params){f.push(Ne({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const y=d||lo(h,e.x),m=v=>{const x={};for(let b=0;b<o.length;++b)x[o[b]]=h.dims[b];x[l[0]]=v[0],x[l[1]]=v[1],f.push(Ne(x))};s==="linear"||s==="constant"?y.forEach(v=>m([v,g.predict(v)])):tv(g.predict,y,25,200).forEach(m)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const _ae=Object.freeze(Object.defineProperty({__proto__:null,loess:KC,regression:JC},Symbol.toStringTag,{value:"Module"})),es=11102230246251565e-32,nn=134217729,kae=(3+8*es)*es;function nb(e,t,n,r,i){let o,s,a,u,l=t[0],c=r[0],f=0,d=0;c>l==c>-l?(o=l,l=t[++f]):(o=c,c=r[++d]);let h=0;if(f<e&&d<n)for(c>l==c>-l?(s=l+o,a=o-(s-l),l=t[++f]):(s=c+o,a=o-(s-c),c=r[++d]),o=s,a!==0&&(i[h++]=a);f<e&&d<n;)c>l==c>-l?(s=o+l,u=s-o,a=o-(s-u)+(l-u),l=t[++f]):(s=o+c,u=s-o,a=o-(s-u)+(c-u),c=r[++d]),o=s,a!==0&&(i[h++]=a);for(;f<e;)s=o+l,u=s-o,a=o-(s-u)+(l-u),l=t[++f],o=s,a!==0&&(i[h++]=a);for(;d<n;)s=o+c,u=s-o,a=o-(s-u)+(c-u),c=r[++d],o=s,a!==0&&(i[h++]=a);return(o!==0||h===0)&&(i[h++]=o),h}function $ae(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}function rg(e){return new Float64Array(e)}const Cae=(3+16*es)*es,Aae=(2+12*es)*es,Tae=(9+64*es)*es*es,jl=rg(4),bN=rg(8),wN=rg(12),EN=rg(16),wn=rg(4);function Fae(e,t,n,r,i,o,s){let a,u,l,c,f,d,h,p,g,y,m,v,x,b,w,S,E,_;const $=e-i,k=n-i,A=t-o,R=r-o;b=$*R,d=nn*$,h=d-(d-$),p=$-h,d=nn*R,g=d-(d-R),y=R-g,w=p*y-(b-h*g-p*g-h*y),S=A*k,d=nn*A,h=d-(d-A),p=A-h,d=nn*k,g=d-(d-k),y=k-g,E=p*y-(S-h*g-p*g-h*y),m=w-E,f=w-m,jl[0]=w-(m+f)+(f-E),v=b+m,f=v-b,x=b-(v-f)+(m-f),m=x-S,f=x-m,jl[1]=x-(m+f)+(f-S),_=v+m,f=_-v,jl[2]=v-(_-f)+(m-f),jl[3]=_;let C=$ae(4,jl),F=Aae*s;if(C>=F||-C>=F||(f=e-$,a=e-($+f)+(f-i),f=n-k,l=n-(k+f)+(f-i),f=t-A,u=t-(A+f)+(f-o),f=r-R,c=r-(R+f)+(f-o),a===0&&u===0&&l===0&&c===0)||(F=Tae*s+kae*Math.abs(C),C+=$*c+R*a-(A*l+k*u),C>=F||-C>=F))return C;b=a*R,d=nn*a,h=d-(d-a),p=a-h,d=nn*R,g=d-(d-R),y=R-g,w=p*y-(b-h*g-p*g-h*y),S=u*k,d=nn*u,h=d-(d-u),p=u-h,d=nn*k,g=d-(d-k),y=k-g,E=p*y-(S-h*g-p*g-h*y),m=w-E,f=w-m,wn[0]=w-(m+f)+(f-E),v=b+m,f=v-b,x=b-(v-f)+(m-f),m=x-S,f=x-m,wn[1]=x-(m+f)+(f-S),_=v+m,f=_-v,wn[2]=v-(_-f)+(m-f),wn[3]=_;const T=nb(4,jl,4,wn,bN);b=$*c,d=nn*$,h=d-(d-$),p=$-h,d=nn*c,g=d-(d-c),y=c-g,w=p*y-(b-h*g-p*g-h*y),S=A*l,d=nn*A,h=d-(d-A),p=A-h,d=nn*l,g=d-(d-l),y=l-g,E=p*y-(S-h*g-p*g-h*y),m=w-E,f=w-m,wn[0]=w-(m+f)+(f-E),v=b+m,f=v-b,x=b-(v-f)+(m-f),m=x-S,f=x-m,wn[1]=x-(m+f)+(f-S),_=v+m,f=_-v,wn[2]=v-(_-f)+(m-f),wn[3]=_;const O=nb(T,bN,4,wn,wN);b=a*c,d=nn*a,h=d-(d-a),p=a-h,d=nn*c,g=d-(d-c),y=c-g,w=p*y-(b-h*g-p*g-h*y),S=u*l,d=nn*u,h=d-(d-u),p=u-h,d=nn*l,g=d-(d-l),y=l-g,E=p*y-(S-h*g-p*g-h*y),m=w-E,f=w-m,wn[0]=w-(m+f)+(f-E),v=b+m,f=v-b,x=b-(v-f)+(m-f),m=x-S,f=x-m,wn[1]=x-(m+f)+(f-S),_=v+m,f=_-v,wn[2]=v-(_-f)+(m-f),wn[3]=_;const D=nb(O,wN,4,wn,EN);return EN[D-1]}function cm(e,t,n,r,i,o){const s=(t-o)*(n-i),a=(e-i)*(r-o),u=s-a;if(s===0||a===0||s>0!=a>0)return u;const l=Math.abs(s+a);return Math.abs(u)>=Cae*l?u:-Fae(e,t,n,r,i,o,l)}const SN=Math.pow(2,-52),fm=new Uint32Array(512);class H1{static from(t,n=Rae,r=Pae){const i=t.length,o=new Float64Array(i*2);for(let s=0;s<i;s++){const a=t[s];o[2*s]=n(a),o[2*s+1]=r(a)}return new H1(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:o}=this,s=t.length>>1;let a=1/0,u=1/0,l=-1/0,c=-1/0;for(let k=0;k<s;k++){const A=t[2*k],R=t[2*k+1];A<a&&(a=A),R<u&&(u=R),A>l&&(l=A),R>c&&(c=R),this._ids[k]=k}const f=(a+l)/2,d=(u+c)/2;let h=1/0,p,g,y;for(let k=0;k<s;k++){const A=rb(f,d,t[2*k],t[2*k+1]);A<h&&(p=k,h=A)}const m=t[2*p],v=t[2*p+1];h=1/0;for(let k=0;k<s;k++){if(k===p)continue;const A=rb(m,v,t[2*k],t[2*k+1]);A<h&&A>0&&(g=k,h=A)}let x=t[2*g],b=t[2*g+1],w=1/0;for(let k=0;k<s;k++){if(k===p||k===g)continue;const A=Nae(m,v,x,b,t[2*k],t[2*k+1]);A<w&&(y=k,w=A)}let S=t[2*y],E=t[2*y+1];if(w===1/0){for(let R=0;R<s;R++)this._dists[R]=t[2*R]-t[0]||t[2*R+1]-t[1];hc(this._ids,this._dists,0,s-1);const k=new Uint32Array(s);let A=0;for(let R=0,C=-1/0;R<s;R++){const F=this._ids[R];this._dists[F]>C&&(k[A++]=F,C=this._dists[F])}this.hull=k.subarray(0,A),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(cm(m,v,x,b,S,E)<0){const k=g,A=x,R=b;g=y,x=S,b=E,y=k,S=A,E=R}const _=Dae(m,v,x,b,S,E);this._cx=_.x,this._cy=_.y;for(let k=0;k<s;k++)this._dists[k]=rb(t[2*k],t[2*k+1],_.x,_.y);hc(this._ids,this._dists,0,s-1),this._hullStart=p;let $=3;r[p]=n[y]=g,r[g]=n[p]=y,r[y]=n[g]=p,i[p]=0,i[g]=1,i[y]=2,o.fill(-1),o[this._hashKey(m,v)]=p,o[this._hashKey(x,b)]=g,o[this._hashKey(S,E)]=y,this.trianglesLen=0,this._addTriangle(p,g,y,-1,-1,-1);for(let k=0,A,R;k<this._ids.length;k++){const C=this._ids[k],F=t[2*C],T=t[2*C+1];if(k>0&&Math.abs(F-A)<=SN&&Math.abs(T-R)<=SN||(A=F,R=T,C===p||C===g||C===y))continue;let O=0;for(let X=0,te=this._hashKey(F,T);X<this._hashSize&&(O=o[(te+X)%this._hashSize],!(O!==-1&&O!==r[O]));X++);O=n[O];let D=O,M;for(;M=r[D],cm(F,T,t[2*D],t[2*D+1],t[2*M],t[2*M+1])>=0;)if(D=M,D===O){D=-1;break}if(D===-1)continue;let N=this._addTriangle(D,C,r[D],-1,-1,i[D]);i[C]=this._legalize(N+2),i[D]=N,$++;let j=r[D];for(;M=r[j],cm(F,T,t[2*j],t[2*j+1],t[2*M],t[2*M+1])<0;)N=this._addTriangle(j,C,M,i[C],-1,i[j]),i[C]=this._legalize(N+2),r[j]=j,$--,j=M;if(D===O)for(;M=n[D],cm(F,T,t[2*M],t[2*M+1],t[2*D],t[2*D+1])<0;)N=this._addTriangle(M,C,D,-1,i[D],i[M]),this._legalize(N+2),i[M]=N,r[D]=D,$--,D=M;this._hullStart=n[C]=D,r[D]=n[j]=C,r[C]=j,o[this._hashKey(F,T)]=C,o[this._hashKey(t[2*D],t[2*D+1])]=D}this.hull=new Uint32Array($);for(let k=0,A=this._hullStart;k<$;k++)this.hull[k]=A,A=r[A];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(Mae(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let o=0,s=0;for(;;){const a=r[t],u=t-t%3;if(s=u+(t+2)%3,a===-1){if(o===0)break;t=fm[--o];continue}const l=a-a%3,c=u+(t+1)%3,f=l+(a+2)%3,d=n[s],h=n[t],p=n[c],g=n[f];if(Oae(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[a]=d;const m=r[f];if(m===-1){let x=this._hullStart;do{if(this._hullTri[x]===f){this._hullTri[x]=t;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(t,m),this._link(a,r[s]),this._link(s,f);const v=l+(a+1)%3;o<fm.length&&(fm[o++]=v)}else{if(o===0)break;t=fm[--o]}}return s}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,o,s){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}function Mae(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function rb(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function Oae(e,t,n,r,i,o,s,a){const u=e-s,l=t-a,c=n-s,f=r-a,d=i-s,h=o-a,p=u*u+l*l,g=c*c+f*f,y=d*d+h*h;return u*(f*y-g*h)-l*(c*y-g*d)+p*(c*h-f*d)<0}function Nae(e,t,n,r,i,o){const s=n-e,a=r-t,u=i-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u),h=(l*c-a*f)*d,p=(s*f-u*c)*d;return h*h+p*p}function Dae(e,t,n,r,i,o){const s=n-e,a=r-t,u=i-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u),h=e+(l*c-a*f)*d,p=t+(s*f-u*c)*d;return{x:h,y:p}}function hc(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const o=e[i],s=t[o];let a=i-1;for(;a>=n&&t[e[a]]>s;)e[a+1]=e[a--];e[a+1]=o}else{const i=n+r>>1;let o=n+1,s=r;yd(e,i,o),t[e[n]]>t[e[r]]&&yd(e,n,r),t[e[o]]>t[e[r]]&&yd(e,o,r),t[e[n]]>t[e[o]]&&yd(e,n,o);const a=e[o],u=t[a];for(;;){do o++;while(t[e[o]]<u);do s--;while(t[e[s]]>u);if(s<o)break;yd(e,o,s)}e[n+1]=e[s],e[s]=a,r-o+1>=s-n?(hc(e,t,o,r),hc(e,t,n,s-1)):(hc(e,t,n,s-1),hc(e,t,o,r))}}function yd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Rae(e){return e[0]}function Pae(e){return e[1]}const _N=1e-6;class $u{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,o=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>_N||Math.abs(this._y1-o)>_N)&&(this._+="L"+i+","+o),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=o}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class tS{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let Lae=class{constructor(t,[n,r,i,o]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this;let o,s;const a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let g=0,y=0,m=r.length,v,x;g<m;g+=3,y+=2){const b=r[g]*2,w=r[g+1]*2,S=r[g+2]*2,E=t[b],_=t[b+1],$=t[w],k=t[w+1],A=t[S],R=t[S+1],C=$-E,F=k-_,T=A-E,O=R-_,D=(C*O-F*T)*2;if(Math.abs(D)<1e-9){if(o===void 0){o=s=0;for(const N of n)o+=t[N*2],s+=t[N*2+1];o/=n.length,s/=n.length}const M=1e9*Math.sign((o-E)*O-(s-_)*T);v=(E+A)/2-M*O,x=(_+R)/2+M*T}else{const M=1/D,N=C*C+F*F,j=T*T+O*O;v=E+(O*N-F*j)*M,x=_+(C*j-T*N)*M}a[y]=v,a[y+1]=x}let u=n[n.length-1],l,c=u*4,f,d=t[2*u],h,p=t[2*u+1];i.fill(0);for(let g=0;g<n.length;++g)u=n[g],l=c,f=d,h=p,c=u*4,d=t[2*u],p=t[2*u+1],i[l+2]=i[c]=h-p,i[l+3]=i[c+1]=d-f}render(t){const n=t==null?t=new $u:void 0,{delaunay:{halfedges:r,inedges:i,hull:o},circumcenters:s,vectors:a}=this;if(o.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=s[h],y=s[h+1],m=s[p],v=s[p+1];this._renderSegment(g,y,m,v,t)}let u,l=o[o.length-1];for(let c=0;c<o.length;++c){u=l,l=o[c];const f=Math.floor(i[l]/3)*2,d=s[f],h=s[f+1],p=u*4,g=this._project(d,h,a[p+2],a[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new $u:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new $u:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(i[s]!==i[s-2]||i[s+1]!==i[s-1])&&n.lineTo(i[s],i[s+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new tS;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,o){let s;const a=this._regioncode(t,n),u=this._regioncode(r,i);a===0&&u===0?(o.moveTo(t,n),o.lineTo(r,i)):(s=this._clipSegment(t,n,r,i,a,u))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i){e:for(let o=0,s=n.length;o<s;o+=2)for(let a=0,u=i.length;a<u;a+=2)if(n[o]===i[a]&&n[o+1]===i[a+1]&&n[(o+2)%s]===i[(a+u-2)%u]&&n[(o+3)%s]===i[(a+u-1)%u]){yield r;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:o}}=this,s=r[t];if(s===-1)return null;const a=[];let u=s;do{const l=Math.floor(u/3);if(a.push(n[l*2],n[l*2+1]),u=u%3===2?u-2:u+1,o[u]!==t)break;u=i[u]}while(u!==s&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return this._simplify(r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n))}_clipFinite(t,n){const r=n.length;let i=null,o,s,a=n[r-2],u=n[r-1],l,c=this._regioncode(a,u),f,d=0;for(let h=0;h<r;h+=2)if(o=a,s=u,a=n[h],u=n[h+1],l=c,c=this._regioncode(a,u),l===0&&c===0)f=d,d=0,i?i.push(a,u):i=[a,u];else{let p,g,y,m,v;if(l===0){if((p=this._clipSegment(o,s,a,u,l,c))===null)continue;[g,y,m,v]=p}else{if((p=this._clipSegment(a,u,o,s,c,l))===null)continue;[m,v,g,y]=p,f=d,d=this._edgecode(g,y),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(g,y):i=[g,y]}f=d,d=this._edgecode(m,v),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(m,v):i=[m,v]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,o,s){const a=o<s;for(a&&([t,n,r,i,o,s]=[r,i,t,n,s,o]);;){if(o===0&&s===0)return a?[r,i,t,n]:[t,n,r,i];if(o&s)return null;let u,l,c=o||s;c&8?(u=t+(r-t)*(this.ymax-n)/(i-n),l=this.ymax):c&4?(u=t+(r-t)*(this.ymin-n)/(i-n),l=this.ymin):c&2?(l=n+(i-n)*(this.xmax-t)/(r-t),u=this.xmax):(l=n+(i-n)*(this.xmin-t)/(r-t),u=this.xmin),o?(t=u,n=l,o=this._regioncode(t,n)):(r=u,i=l,s=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,o,s){let a=Array.from(n),u;if((u=this._project(a[0],a[1],r,i))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],o,s))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let l=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,r,i,o){for(;n!==r;){let s,a;switch(n){case 5:n=4;continue;case 4:n=6,s=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,s=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,s=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,s=this.xmin,a=this.ymin;break}(i[o]!==s||i[o+1]!==a)&&this.contains(t,s,a)&&(i.splice(o,0,s,a),o+=2)}return o}_project(t,n,r,i){let o=1/0,s,a,u;if(i<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/i)<o&&(u=this.ymin,a=t+(o=s)*r)}else if(i>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/i)<o&&(u=this.ymax,a=t+(o=s)*r)}if(r>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/r)<o&&(a=this.xmax,u=n+(o=s)*i)}else if(r<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/r)<o&&(a=this.xmin,u=n+(o=s)*i)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const r=(n+2)%t.length,i=(n+4)%t.length;(t[n]===t[r]&&t[r]===t[i]||t[n+1]===t[r+1]&&t[r+1]===t[i+1])&&(t.splice(r,2),n-=2)}t.length||(t=null)}return t}};const zae=2*Math.PI,Bl=Math.pow;function Iae(e){return e[0]}function jae(e){return e[1]}function Bae(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],o=2*t[r+1],s=2*t[r+2];if((n[s]-n[i])*(n[o+1]-n[i+1])-(n[o]-n[i])*(n[s+1]-n[i+1])>1e-10)return!1}return!0}function Uae(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class ZC{static from(t,n=Iae,r=jae,i){return new ZC("length"in t?Wae(t,n,r,i):Float64Array.from(qae(t,n,r,i)))}constructor(t){this._delaunator=new H1(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&Bae(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=Uae(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new H1(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=o[u%3===2?u-2:u+1];(r[u]===-1||s[c]===-1)&&(s[c]=u)}for(let u=0,l=i.length;u<l;++u)a[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],s[i[0]]=1,i.length===2&&(s[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(t){return new Lae(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:o,triangles:s,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=s[l],l=l%3===2?l-2:l+1,s[l]!==t)return;if(l=o[l],l===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let o;for(;(o=this._step(r,t,n))>=0&&o!==r&&o!==i;)r=o;return o}_step(t,n,r){const{inedges:i,hull:o,_hullIndex:s,halfedges:a,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=Bl(n-l[t*2],2)+Bl(r-l[t*2+1],2);const d=i[t];let h=d;do{let p=u[h];const g=Bl(n-l[p*2],2)+Bl(r-l[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3===2?h-2:h+1,u[h]!==t)break;if(h=a[h],h===-1){if(h=o[(s[t]+1)%o.length],h!==p&&Bl(n-l[h*2],2)+Bl(r-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new $u:void 0,{points:r,halfedges:i,triangles:o}=this;for(let s=0,a=i.length;s<a;++s){const u=i[s];if(u<s)continue;const l=o[s]*2,c=o[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const r=t==null?t=new $u:void 0,{points:i}=this;for(let o=0,s=i.length;o<s;o+=2){const a=i[o],u=i[o+1];t.moveTo(a+n,u),t.arc(a,u,n,0,zae)}return r&&r.value()}renderHull(t){const n=t==null?t=new $u:void 0,{hull:r,points:i}=this,o=r[0]*2,s=r.length;t.moveTo(i[o],i[o+1]);for(let a=1;a<s;++a){const u=2*r[a];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new tS;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new $u:void 0,{points:i,triangles:o}=this,s=o[t*=3]*2,a=o[t+1]*2,u=o[t+2]*2;return n.moveTo(i[s],i[s+1]),n.lineTo(i[a],i[a+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new tS;return this.renderTriangle(t,n),n.value()}}function Wae(e,t,n,r){const i=e.length,o=new Float64Array(i*2);for(let s=0;s<i;++s){const a=e[s];o[s*2]=t.call(r,a,s,e),o[s*2+1]=n.call(r,a,s,e)}return o}function*qae(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}function eA(e){P.call(this,null,e)}eA.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const Hae=[-1e5,-1e5,1e5,1e5];G(eA,P,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:Hae;const o=this.value=ZC.from(r,e.x,e.y).voronoi(i);for(let s=0,a=r.length;s<a;++s){const u=o.cellPolygon(s);r[s][n]=u?Vae(u):null}return t.reflow(e.modified()).modifies(n)}});function Vae(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}const Gae=Object.freeze(Object.defineProperty({__proto__:null,voronoi:eA},Symbol.toStringTag,{value:"Module"}));var ib=Math.PI/180,Zd=1<<11>>5,n0=1<<11;function Yae(){var e=[256,256],t,n,r,i,o,s,a,u=u7,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(ca()),g=eue((e[0]>>5)*e[1]),y=null,m=l.length,v=-1,x=[],b=l.map(S=>({text:t(S),font:n(S),style:i(S),weight:o(S),rotate:s(S),size:~~(r(S)+1e-14),padding:a(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S})).sort((S,E)=>E.size-S.size);++v<m;){var w=b[v];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,Xae(p,w,b,v),w.hasText&&h(g,w,y)&&(x.push(w),y?Kae(y,w):y=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return x};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(Zd<<5)/g,p.height=n0/g;var y=p.getContext("2d");return y.fillStyle=y.strokeStyle="red",y.textAlign="center",{context:y,ratio:g}}function h(p,g,y){for(var m=g.x,v=g.y,x=Math.sqrt(e[0]*e[0]+e[1]*e[1]),b=u(e),w=c()<.5?1:-1,S=-w,E,_,$;(E=b(S+=w))&&(_=~~E[0],$=~~E[1],!(Math.min(Math.abs(_),Math.abs($))>=x));)if(g.x=m+_,g.y=v+$,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!y||!Qae(g,p,e[0]))&&(!y||Jae(g,y))){for(var k=g.sprite,A=g.width>>5,R=e[0]>>5,C=g.x-(A<<4),F=C&127,T=32-F,O=g.y1-g.y0,D=(g.y+g.y0)*R+(C>>5),M,N=0;N<O;N++){M=0;for(var j=0;j<=A;j++)p[D+j]|=M<<T|(j<A?(M=k[N*A+j])>>>F:0);D+=R}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Za(p),f):n},f.fontStyle=function(p){return arguments.length?(i=Za(p),f):i},f.fontWeight=function(p){return arguments.length?(o=Za(p),f):o},f.rotate=function(p){return arguments.length?(s=Za(p),f):s},f.text=function(p){return arguments.length?(t=Za(p),f):t},f.spiral=function(p){return arguments.length?(u=tue[p]||p,f):u},f.fontSize=function(p){return arguments.length?(r=Za(p),f):r},f.padding=function(p){return arguments.length?(a=Za(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}function Xae(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,(Zd<<5)/o,n0/o);var s=0,a=0,u=0,l=n.length,c,f,d,h,p;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=i.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*ib),y=Math.cos(t.rotate*ib),m=c*y,v=c*g,x=d*y,b=d*g;c=Math.max(Math.abs(m+b),Math.abs(m-b))+31>>5<<5,d=~~Math.max(Math.abs(v+x),Math.abs(v-x))}else c=c+31>>5<<5;if(d>u&&(u=d),s+c>=Zd<<5&&(s=0,a+=u,u=0),a+d>=n0)break;i.translate((s+(c>>1))/o,(a+(d>>1))/o),t.rotate&&i.rotate(t.rotate*ib),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=s,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,s+=c}for(var w=i.getImageData(0,0,(Zd<<5)/o,n0/o).data,S=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)S[h]=0;if(s=t.xoff,s==null)return;a=t.yoff;var E=0,_=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var $=f*p+(h>>5),k=w[(a+p)*(Zd<<5)+(s+h)<<2]?1<<31-h%32:0;S[$]|=k,E|=k}E?_=p:(t.y0++,d--,p--,a++)}t.y1=t.y0+_,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function Qae(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,o=e.x-(i<<4),s=o&127,a=32-s,u=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<a|(d<i?(c=r[f*i+d])>>>s:0))&t[l+d])return!0;l+=n}return!1}function Kae(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function Jae(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function u7(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Zae(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(o){var s=o<0?-1:1;switch(Math.sqrt(1+4*s*o)-s&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function eue(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Za(e){return typeof e=="function"?e:function(){return e}}var tue={archimedean:u7,rectangular:Zae};const l7=["x","y","font","fontSize","fontStyle","fontWeight","angle"],nue=["text","font","rotate","fontSize","fontStyle","fontWeight"];function tA(e){P.call(this,Yae(),e)}tA.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:l7}]};G(tA,P,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&z("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return pe(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||nue.some(n)))return;const i=t.materialize(t.SOURCE).source,o=this.value,s=e.as||l7;let a=e.fontSize||14,u;if(pe(a)?u=e.fontSizeRange:a=vn(a),u){const p=a,g=Fe("sqrt")().domain(lo(i,p)).range(u);a=y=>g(p(y))}i.forEach(p=>{p[s[0]]=NaN,p[s[1]]=NaN,p[s[3]]=0});const l=o.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Vr).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,g,y;p<h;++p)g=l[p],y=g.datum,y[s[0]]=g.x+f,y[s[1]]=g.y+d,y[s[2]]=g.font,y[s[3]]=g.size,y[s[4]]=g.style,y[s[5]]=g.weight,y[s[6]]=g.rotate;return t.reflow(r).modifies(s)}});const rue=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:tA},Symbol.toStringTag,{value:"Module"})),iue=e=>new Uint8Array(e),oue=e=>new Uint16Array(e),Sh=e=>new Uint32Array(e);function sue(){let e=8,t=[],n=Sh(0),r=dm(0,e),i=dm(0,e);return{data:()=>t,seen:()=>n=aue(n,t.length),add(o){for(let s=0,a=t.length,u=o.length,l;s<u;++s)l=o[s],l._index=a++,t.push(l)},remove(o,s){const a=t.length,u=Array(a-o),l=t;let c,f,d;for(f=0;!s[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],s[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:o=>i[o]=r[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,s){r[o]|=s},clear(o,s){r[o]&=~s},resize(o,s){const a=r.length;(o>a||s>e)&&(e=Math.max(s,e),r=dm(o,e,r),i=dm(o,e))}}}function aue(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function dm(e,t,n){const r=(t<257?iue:t<65537?oue:Sh)(e);return n&&r.set(n),r}function kN(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,o){const s=this,a=s.bisect(s.range,i.value),u=i.index,l=a[0],c=a[1],f=u.length;let d;for(d=0;d<l;++d)o[u[d]]|=r;for(d=c;d<f;++d)o[u[d]]|=r;return s}}}function $N(){let e=Sh(0),t=[],n=0;function r(a,u,l){if(!u.length)return[];const c=n,f=u.length,d=Sh(f);let h=Array(f),p,g,y;for(y=0;y<f;++y)h[y]=a(u[y]),d[y]=y;if(h=uue(h,d),c)p=t,g=e,t=Array(c+f),e=Sh(c+f),lue(l,p,g,c,h,d,f,t,e);else{if(l>0)for(y=0;y<f;++y)d[y]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function i(a,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a}function o(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]}function s(a,u){let l;return u?l=u.length:(u=t,l=n),[CG(u,a[0],0,l),I0(u,a[1],0,l)]}return{insert:r,remove:i,bisect:s,reindex:o,index:()=>e,size:()=>n}}function uue(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],o=e[r];return i<o?-1:i>o?1:0}),FG(e,t)}function lue(e,t,n,r,i,o,s,a,u){let l=0,c=0,f;for(f=0;l<r&&c<s;++f)t[l]<i[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=i[c],u[f]=o[c++]+e);for(;l<r;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<s;++c,++f)a[f]=i[c],u[f]=o[c]+e}function nA(e){P.call(this,sue(),e),this._indices=null,this._dims=null}nA.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};G(nA,P,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],s=r.length;let a=0,u,l;for(;a<s;++a)u=n[a].fname,l=i[u]||(i[u]=$N()),o.push(kN(l,a,r[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,s=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let g,y,m,v,x,b,w,S,E;if(l.set(u),t.rem.length&&(x=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(b={},v=t.mod,w=0,S=v.length;w<S;++w)b[v[w]._index]=1;for(w=0;w<h;++w)E=r[w],(!s[w]||e.modified("fields",w)||t.modified(E.fields))&&(m=E.fname,(g=p[m])||(o[m]=y=$N(),p[m]=g=y.insert(E,t.source,0)),s[w]=kN(y,w,i[w]).onAdd(g,u));for(w=0,S=a.data().length;w<S;++w)x[w]||(l[w]!==u[w]?f.push(w):b[w]&&u[w]!==c&&d.push(w));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,o=this._dims,s=this._indices,a=e.fields,u={},l=n.add,c=i.size()+r.length,f=o.length;let d=i.size(),h,p,g;i.resize(c,f),i.add(r);const y=i.curr(),m=i.prev(),v=i.all();for(h=0;h<f;++h)p=a[h].fname,g=u[p]||(u[p]=s[p].insert(a[h],r,d)),o[h].onAdd(g,y);for(;d<c;++d)m[d]=v,y[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),s=e.mod;let a,u,l;for(a=0,u=s.length;a<u;++a)l=s[a]._index,i[l]!==o&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,o=i.curr(),s=i.prev(),a=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,s[h]=p=o[h],o[h]=a,p!==a&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const o=i.remove(t,n);for(const s in r)r[s].reindex(o)})},update(e,t,n){const r=this._dims,i=e.query,o=t.stamp,s=r.length;let a=0,u,l;for(n.filters=0,l=0;l<s;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,a=0;l<s;++l)e.modified("query",l)&&(a|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return a},incrementAll(e,t,n,r){const i=this.value,o=i.seen(),s=i.curr(),a=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let y,m,v;if(f<h)for(y=f,m=Math.min(h,d);y<m;++y)v=u[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(f>h)for(y=h,m=Math.min(f,p);y<m;++y)v=u[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;if(d>p)for(y=Math.max(f,p),m=d;y<m;++y)v=u[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(d<p)for(y=Math.max(h,d),m=p;y<m;++y)v=u[y],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,o=i.curr(),s=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],h=e.one;let p,g,y;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)y=s[p],o[y]^=h,n.push(y);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)y=s[p],o[y]^=h,r.push(y);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)y=s[p],o[y]^=h,n.push(y);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)y=s[p],o[y]^=h,r.push(y);e.range=t.slice()}});function rA(e){P.call(this,null,e)}rA.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};G(rA,P,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if(!(i&n))return t.StopPropagation;const o=t.fork(t.ALL),s=r.data(),a=r.curr(),u=r.prev(),l=c=>a[c]&n?null:s[c];return o.filter(o.MOD,l),i&i-1?(o.filter(o.ADD,c=>{const f=a[c]&n;return!f&&f^u[c]&n?s[c]:null}),o.filter(o.REM,c=>{const f=a[c]&n;return f&&!(f^(f^u[c]&n))?s[c]:null})):(o.filter(o.ADD,l),o.filter(o.REM,c=>(a[c]&n)===i?s[c]:null)),o.filter(o.SOURCE,c=>l(c._index))}});const cue=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:nA,resolvefilter:rA},Symbol.toStringTag,{value:"Module"})),fue="RawCode",Ju="Literal",due="Property",hue="Identifier",pue="ArrayExpression",gue="BinaryExpression",c7="CallExpression",mue="ConditionalExpression",yue="LogicalExpression",vue="MemberExpression",xue="ObjectExpression",bue="UnaryExpression";function Oi(e){this.type=e}Oi.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=wue(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function wue(e){switch(e.type){case pue:return e.elements;case gue:case yue:return[e.left,e.right];case c7:return[e.callee].concat(e.arguments);case mue:return[e.test,e.consequent,e.alternate];case vue:return[e.object,e.property];case xue:return e.properties;case due:return[e.key,e.value];case bue:return[e.argument];case hue:case Ju:case fue:default:return[]}}var _o,ne,L,pn,Le,Dv=1,ig=2,Zu=3,ja=4,Rv=5,Sl=6,Bn=7,og=8,Eue=9;_o={};_o[Dv]="Boolean";_o[ig]="<end>";_o[Zu]="Identifier";_o[ja]="Keyword";_o[Rv]="Null";_o[Sl]="Numeric";_o[Bn]="Punctuator";_o[og]="String";_o[Eue]="RegularExpression";var Sue="ArrayExpression",_ue="BinaryExpression",kue="CallExpression",$ue="ConditionalExpression",f7="Identifier",Cue="Literal",Aue="LogicalExpression",Tue="MemberExpression",Fue="ObjectExpression",Mue="Property",Oue="UnaryExpression",Mt="Unexpected token %0",Nue="Unexpected number",Due="Unexpected string",Rue="Unexpected identifier",Pue="Unexpected reserved word",Lue="Unexpected end of input",nS="Invalid regular expression",ob="Invalid regular expression: missing /",d7="Octal literals are not allowed in strict mode.",zue="Duplicate data property in object literal not allowed in strict mode",qt="ILLEGAL",cp="Disabled.",Iue=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),jue=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Pv(e,t){if(!e)throw new Error("ASSERT: "+t)}function jo(e){return e>=48&&e<=57}function iA(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function _h(e){return"01234567".indexOf(e)>=0}function Bue(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function fp(e){return e===10||e===13||e===8232||e===8233}function sg(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Iue.test(String.fromCharCode(e))}function V1(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&jue.test(String.fromCharCode(e))}const Uue={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function h7(){for(;L<pn;){const e=ne.charCodeAt(L);if(Bue(e)||fp(e))++L;else break}}function rS(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)L<pn&&iA(ne[L])?(r=ne[L++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Ae({},Mt,qt);return String.fromCharCode(i)}function Wue(){var e,t,n,r;for(e=ne[L],t=0,e==="}"&&Ae({},Mt,qt);L<pn&&(e=ne[L++],!!iA(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Ae({},Mt,qt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function p7(){var e,t;for(e=ne.charCodeAt(L++),t=String.fromCharCode(e),e===92&&(ne.charCodeAt(L)!==117&&Ae({},Mt,qt),++L,e=rS("u"),(!e||e==="\\"||!sg(e.charCodeAt(0)))&&Ae({},Mt,qt),t=e);L<pn&&(e=ne.charCodeAt(L),!!V1(e));)++L,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ne.charCodeAt(L)!==117&&Ae({},Mt,qt),++L,e=rS("u"),(!e||e==="\\"||!V1(e.charCodeAt(0)))&&Ae({},Mt,qt),t+=e);return t}function que(){var e,t;for(e=L++;L<pn;){if(t=ne.charCodeAt(L),t===92)return L=e,p7();if(V1(t))++L;else break}return ne.slice(e,L)}function Hue(){var e,t,n;return e=L,t=ne.charCodeAt(L)===92?p7():que(),t.length===1?n=Zu:Uue.hasOwnProperty(t)?n=ja:t==="null"?n=Rv:t==="true"||t==="false"?n=Dv:n=Zu,{type:n,value:t,start:e,end:L}}function sb(){var e=L,t=ne.charCodeAt(L),n,r=ne[L],i,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++L,{type:Bn,value:String.fromCharCode(t),start:e,end:L};default:if(n=ne.charCodeAt(L+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return L+=2,{type:Bn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:L};case 33:case 61:return L+=2,ne.charCodeAt(L)===61&&++L,{type:Bn,value:ne.slice(e,L),start:e,end:L}}}if(s=ne.substr(L,4),s===">>>=")return L+=4,{type:Bn,value:s,start:e,end:L};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return L+=3,{type:Bn,value:o,start:e,end:L};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return L+=2,{type:Bn,value:i,start:e,end:L};if(i==="//"&&Ae({},Mt,qt),"<>=!+-*%&|^/".indexOf(r)>=0)return++L,{type:Bn,value:r,start:e,end:L};Ae({},Mt,qt)}function Vue(e){let t="";for(;L<pn&&iA(ne[L]);)t+=ne[L++];return t.length===0&&Ae({},Mt,qt),sg(ne.charCodeAt(L))&&Ae({},Mt,qt),{type:Sl,value:parseInt("0x"+t,16),start:e,end:L}}function Gue(e){let t="0"+ne[L++];for(;L<pn&&_h(ne[L]);)t+=ne[L++];return(sg(ne.charCodeAt(L))||jo(ne.charCodeAt(L)))&&Ae({},Mt,qt),{type:Sl,value:parseInt(t,8),octal:!0,start:e,end:L}}function CN(){var e,t,n;if(n=ne[L],Pv(jo(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=L,e="",n!=="."){if(e=ne[L++],n=ne[L],e==="0"){if(n==="x"||n==="X")return++L,Vue(t);if(_h(n))return Gue(t);n&&jo(n.charCodeAt(0))&&Ae({},Mt,qt)}for(;jo(ne.charCodeAt(L));)e+=ne[L++];n=ne[L]}if(n==="."){for(e+=ne[L++];jo(ne.charCodeAt(L));)e+=ne[L++];n=ne[L]}if(n==="e"||n==="E")if(e+=ne[L++],n=ne[L],(n==="+"||n==="-")&&(e+=ne[L++]),jo(ne.charCodeAt(L)))for(;jo(ne.charCodeAt(L));)e+=ne[L++];else Ae({},Mt,qt);return sg(ne.charCodeAt(L))&&Ae({},Mt,qt),{type:Sl,value:parseFloat(e),start:t,end:L}}function Yue(){var e="",t,n,r,i,o=!1;for(t=ne[L],Pv(t==="'"||t==='"',"String literal must starts with a quote"),n=L,++L;L<pn;)if(r=ne[L++],r===t){t="";break}else if(r==="\\")if(r=ne[L++],!r||!fp(r.charCodeAt(0)))switch(r){case"u":case"x":ne[L]==="{"?(++L,e+=Wue()):e+=rS(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:_h(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),L<pn&&_h(ne[L])&&(o=!0,i=i*8+"01234567".indexOf(ne[L++]),"0123".indexOf(r)>=0&&L<pn&&_h(ne[L])&&(i=i*8+"01234567".indexOf(ne[L++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&ne[L]===`
`&&++L;else{if(fp(r.charCodeAt(0)))break;e+=r}return t!==""&&Ae({},Mt,qt),{type:og,value:e,octal:o,start:n,end:L}}function Xue(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Ae({},nS)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Ae({},nS)}try{return new RegExp(e,t)}catch{return null}}function Que(){var e,t,n,r,i;for(e=ne[L],Pv(e==="/","Regular expression literal must start with a slash"),t=ne[L++],n=!1,r=!1;L<pn;)if(e=ne[L++],t+=e,e==="\\")e=ne[L++],fp(e.charCodeAt(0))&&Ae({},ob),t+=e;else if(fp(e.charCodeAt(0)))Ae({},ob);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Ae({},ob),i=t.substr(1,t.length-2),{value:i,literal:t}}function Kue(){var e,t,n;for(t="",n="";L<pn&&(e=ne[L],!!V1(e.charCodeAt(0)));)++L,e==="\\"&&L<pn?Ae({},Mt,qt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Ae({},nS,n),{value:n,literal:t}}function Jue(){var e,t,n,r;return Le=null,h7(),e=L,t=Que(),n=Kue(),r=Xue(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:L}}function Zue(e){return e.type===Zu||e.type===ja||e.type===Dv||e.type===Rv}function g7(){if(h7(),L>=pn)return{type:ig,start:L,end:L};const e=ne.charCodeAt(L);return sg(e)?Hue():e===40||e===41||e===59?sb():e===39||e===34?Yue():e===46?jo(ne.charCodeAt(L+1))?CN():sb():jo(e)?CN():sb()}function Vn(){const e=Le;return L=e.end,Le=g7(),L=e.end,e}function m7(){const e=L;Le=g7(),L=e}function ele(e){const t=new Oi(Sue);return t.elements=e,t}function AN(e,t,n){const r=new Oi(e==="||"||e==="&&"?Aue:_ue);return r.operator=e,r.left=t,r.right=n,r}function tle(e,t){const n=new Oi(kue);return n.callee=e,n.arguments=t,n}function nle(e,t,n){const r=new Oi($ue);return r.test=e,r.consequent=t,r.alternate=n,r}function oA(e){const t=new Oi(f7);return t.name=e,t}function eh(e){const t=new Oi(Cue);return t.value=e.value,t.raw=ne.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function TN(e,t,n){const r=new Oi(Tue);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function rle(e){const t=new Oi(Fue);return t.properties=e,t}function FN(e,t,n){const r=new Oi(Mue);return r.key=t,r.value=n,r.kind=e,r}function ile(e,t){const n=new Oi(Oue);return n.operator=e,n.argument=t,n.prefix=!0,n}function Ae(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,s)=>(Pv(s<r.length,"Message reference must be in range"),r[s]));throw n=new Error(i),n.index=L,n.description=i,n}function Lv(e){e.type===ig&&Ae(e,Lue),e.type===Sl&&Ae(e,Nue),e.type===og&&Ae(e,Due),e.type===Zu&&Ae(e,Rue),e.type===ja&&Ae(e,Pue),Ae(e,Mt,e.value)}function gn(e){const t=Vn();(t.type!==Bn||t.value!==e)&&Lv(t)}function Xe(e){return Le.type===Bn&&Le.value===e}function ab(e){return Le.type===ja&&Le.value===e}function ole(){const e=[];for(L=Le.start,gn("[");!Xe("]");)Xe(",")?(Vn(),e.push(null)):(e.push(el()),Xe("]")||gn(","));return Vn(),ele(e)}function MN(){L=Le.start;const e=Vn();return e.type===og||e.type===Sl?(e.octal&&Ae(e,d7),eh(e)):oA(e.value)}function sle(){var e,t,n,r;if(L=Le.start,e=Le,e.type===Zu)return n=MN(),gn(":"),r=el(),FN("init",n,r);if(e.type===ig||e.type===Bn)Lv(e);else return t=MN(),gn(":"),r=el(),FN("init",t,r)}function ale(){var e=[],t,n,r,i={},o=String;for(L=Le.start,gn("{");!Xe("}");)t=sle(),t.key.type===f7?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Ae({},zue):i[r]=!0,e.push(t),Xe("}")||gn(",");return gn("}"),rle(e)}function ule(){gn("(");const e=sA();return gn(")"),e}const lle={if:1};function cle(){var e,t,n;if(Xe("("))return ule();if(Xe("["))return ole();if(Xe("{"))return ale();if(e=Le.type,L=Le.start,e===Zu||lle[Le.value])n=oA(Vn().value);else if(e===og||e===Sl)Le.octal&&Ae(Le,d7),n=eh(Vn());else{if(e===ja)throw new Error(cp);e===Dv?(t=Vn(),t.value=t.value==="true",n=eh(t)):e===Rv?(t=Vn(),t.value=null,n=eh(t)):Xe("/")||Xe("/=")?(n=eh(Jue()),m7()):Lv(Vn())}return n}function fle(){const e=[];if(gn("("),!Xe(")"))for(;L<pn&&(e.push(el()),!Xe(")"));)gn(",");return gn(")"),e}function dle(){L=Le.start;const e=Vn();return Zue(e)||Lv(e),oA(e.value)}function hle(){return gn("."),dle()}function ple(){gn("[");const e=sA();return gn("]"),e}function gle(){var e,t,n;for(e=cle();;)if(Xe("."))n=hle(),e=TN(".",e,n);else if(Xe("("))t=fle(),e=tle(e,t);else if(Xe("["))n=ple(),e=TN("[",e,n);else break;return e}function ON(){const e=gle();if(Le.type===Bn&&(Xe("++")||Xe("--")))throw new Error(cp);return e}function r0(){var e,t;if(Le.type!==Bn&&Le.type!==ja)t=ON();else{if(Xe("++")||Xe("--"))throw new Error(cp);if(Xe("+")||Xe("-")||Xe("~")||Xe("!"))e=Vn(),t=r0(),t=ile(e.value,t);else{if(ab("delete")||ab("void")||ab("typeof"))throw new Error(cp);t=ON()}}return t}function NN(e){let t=0;if(e.type!==Bn&&e.type!==ja)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function mle(){var e,t,n,r,i,o,s,a,u,l;if(e=Le,u=r0(),r=Le,i=NN(r),i===0)return u;for(r.prec=i,Vn(),t=[e,Le],s=r0(),o=[u,r,s];(i=NN(Le))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),t.pop(),n=AN(a,u,s),o.push(n);r=Vn(),r.prec=i,o.push(r),t.push(Le),n=r0(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=AN(o[l-1].value,o[l-2],n),l-=2;return n}function el(){var e,t,n;return e=mle(),Xe("?")&&(Vn(),t=el(),gn(":"),n=el(),e=nle(e,t,n)),e}function sA(){const e=el();if(Xe(","))throw new Error(cp);return e}function aA(e){ne=e,L=0,pn=ne.length,Le=null,m7();const t=sA();if(Le.type!==ig)throw new Error("Unexpect token after expression.");return t}var y7={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function v7(e){function t(s,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+s+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(s,a,u){return l=>t(s,l,a,u)}const r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&z("Missing arguments to clamp function."),s.length>3&&z("Too many arguments to clamp function.");const a=s.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:o,test:n("test",o),if:function(s){s.length<3&&z("Missing arguments to if function."),s.length>3&&z("Too many arguments to if function.");const a=s.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function yle(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function x7(e){e=e||{};const t=e.allowed?Ci(e.allowed):{},n=e.forbidden?Ci(e.forbidden):{},r=e.constants||y7,i=(e.functions||v7)(f),o=e.globalvar,s=e.fieldvar,a=pe(o)?o:p=>`${o}["${p}"]`;let u={},l={},c=0;function f(p){if(Q(p))return p;const g=d[p.type];return g==null&&z("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:ae(n,g)?z("Illegal identifier: "+g):ae(r,g)?r[g]:ae(t,g)?g:(u[g]=1,a(g))},MemberExpression:p=>{const g=!p.computed,y=f(p.object);g&&(c+=1);const m=f(p.property);return y===s&&(l[yle(m)]=1),g&&(c-=1),y+(g?"."+m:"["+m+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&z("Illegal callee type: "+p.callee.type);const g=p.callee.name,y=p.arguments,m=ae(i,g)&&i[g];return m||z("Unrecognized function: "+g),pe(m)?m(y):m+"("+y.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=i,h.constants=r,h}function ub(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function vle(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function xle(e){let t,n,r;e.length!==2?(t=ub,n=(a,u)=>ub(e(a),u),r=(a,u)=>e(a)-u):(t=e===ub||e===vle?e:ble,n=e,r=e);function i(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){const f=i(a,u,l,c-1);return f>l&&r(a[f-1],u)>-r(a[f],u)?f-1:f}return{left:i,center:s,right:o}}function ble(){return 0}function wle(e,...t){e=new j0(e),t=t.map(Ele);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e}function Ele(e){return e instanceof j0?e:new j0(e)}function Sle(...e){const t=new j0;for(const n of e)for(const r of n)t.add(r);return t}const uA="intersect",DN="union",_le="vlMulti",kle="vlPoint",RN="or",$le="and",Yi="_vgsid_",dp=nr(Yi),Cle="E",Ale="R",Tle="R-E",Fle="R-LE",Mle="R-RE",G1="index:unit";function PN(e,t){for(var n=t.fields,r=t.values,i=n.length,o=0,s,a;o<i;++o)if(a=n[o],a.getter=nr.getter||nr(a.field),s=a.getter(e),aa(s)&&(s=ln(s)),aa(r[o])&&(r[o]=ln(r[o])),aa(r[o][0])&&(r[o]=r[o].map(ln)),a.type===Cle){if(I(r[o])?r[o].indexOf(s)<0:s!==r[o])return!1}else if(a.type===Ale){if(!lc(s,r[o]))return!1}else if(a.type===Mle){if(!lc(s,r[o],!0,!1))return!1}else if(a.type===Tle){if(!lc(s,r[o],!1,!1))return!1}else if(a.type===Fle&&!lc(s,r[o],!1,!0))return!1;return!0}function Ole(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],o=r?r[G1]&&r[G1].value:void 0,s=n===uA,a=i.length,u=0,l,c,f,d,h;u<a;++u)if(l=i[u],o&&s){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=PN(t,l),c[d]=h?-1:++f,h&&o.size===1)return!0;if(!h&&f===o.get(d).count)return!1}else if(h=PN(t,l),s^h)return h;return a&&s}const b7=xle(dp),Nle=b7.left,Dle=b7.right;function Rle(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r[G1]&&r[G1].value:void 0,s=n===uA,a=dp(t),u=Nle(i,a);if(u===i.length||dp(i[u])!==a)return!1;if(o&&s){if(o.size===1)return!0;if(Dle(i,a)-u<o.size)return!1}return!0}function Ple(e,t){return e.map(n=>he(t.fields?{values:t.fields.map(r=>(r.getter||(r.getter=nr(r.field)))(n.datum))}:{[Yi]:dp(n.datum)},t))}function Lle(e,t,n,r){for(var i=this.context.data[e],o=i?i.values.value:[],s={},a={},u={},l,c,f,d,h,p,g,y,m,v,x=o.length,b=0,w,S;b<x;++b)if(l=o[b],d=l.unit,c=l.fields,f=l.values,c&&f){for(w=0,S=c.length;w<S;++w)h=c[w],g=s[h.field]||(s[h.field]={}),y=g[d]||(g[d]=[]),u[h.field]=m=h.type.charAt(0),v=lb[`${m}_union`],g[d]=v(y,K(f[w]));n&&(y=a[d]||(a[d]=[]),y.push(K(f).reduce((E,_,$)=>(E[c[$].field]=_,E),{})))}else h=Yi,p=dp(l),g=s[h]||(s[h]={}),y=g[d]||(g[d]=[]),y.push(p),n&&(y=a[d]||(a[d]=[]),y.push({[Yi]:p}));if(t=t||DN,s[Yi]?s[Yi]=lb[`${Yi}_${t}`](...Object.values(s[Yi])):Object.keys(s).forEach(E=>{s[E]=Object.keys(s[E]).map(_=>s[E][_]).reduce((_,$)=>_===void 0?$:lb[`${u[E]}_${t}`](_,$))}),o=Object.keys(a),n&&o.length){const E=r?kle:_le;s[E]=t===DN?{[RN]:o.reduce((_,$)=>(_.push(...a[$]),_),[])}:{[$le]:o.map(_=>({[RN]:a[_]}))}}return s}var lb={[`${Yi}_union`]:Sle,[`${Yi}_intersect`]:wle,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=ln(t[0]),r=ln(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=ln(t[0]),r=ln(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const zle=":",Ile="@";function lA(e,t,n,r){t[0].type!==Ju&&z("First argument to selection functions must be a string literal.");const i=t[0].value,o=t.length>=2&&_e(t).value,s="unit",a=Ile+s,u=zle+i;o===uA&&!ae(r,a)&&(r[a]=n.getData(i).indataRef(n,s)),ae(r,u)||(r[u]=n.getData(i).tuplesRef())}function w7(e){const t=this.context.data[e];return t?t.values.value:[]}function jle(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function Ble(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(qr).insert(t)),1}function Ule(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const ag=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},Wle=ag("format"),E7=ag("timeFormat"),qle=ag("utcFormat"),Hle=ag("timeParse"),Vle=ag("utcParse"),hm=new Date(2e3,0,1);function zv(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(hm.setYear(2e3),hm.setMonth(e),hm.setDate(t),E7.call(this,hm,n))}function Gle(e){return zv.call(this,e,1,"%B")}function Yle(e){return zv.call(this,e,1,"%b")}function Xle(e){return zv.call(this,0,2+e,"%A")}function Qle(e){return zv.call(this,0,2+e,"%a")}const Kle=":",Jle="@",iS="%",S7="$";function cA(e,t,n,r){t[0].type!==Ju&&z("First argument to data functions must be a string literal.");const i=t[0].value,o=Kle+i;if(!ae(o,r))try{r[o]=n.getData(i).tuplesRef()}catch{}}function Zle(e,t,n,r){t[0].type!==Ju&&z("First argument to indata must be a string literal."),t[1].type!==Ju&&z("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,s=Jle+o;ae(s,r)||(r[s]=n.getData(i).indataRef(n,o))}function Jn(e,t,n,r){if(t[0].type===Ju)LN(n,r,t[0].value);else for(e in n.scales)LN(n,r,e)}function LN(e,t,n){const r=iS+n;if(!ae(t,r))try{t[r]=e.scaleRef(n)}catch{}}function ys(e,t){if(pe(e))return e;if(Q(e)){const n=t.scales[e];return n&&oZ(n.value)?n.value:void 0}}function ece(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=Jn,n._range=Jn,n._scale=Jn;const r=i=>"_["+(i.type===Ju?V(iS+i.value):V(iS)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function fA(e,t){return function(n,r,i){if(n){const o=ys(n,(i||this).context);return o&&o.path[e](r)}else return t(r)}}const tce=fA("area",xre),nce=fA("bounds",Sre),rce=fA("centroid",Tre);function ice(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function dA(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function oce(){return dA(this.context.dataflow,"warn",arguments)}function sce(){return dA(this.context.dataflow,"info",arguments)}function ace(){return dA(this.context.dataflow,"debug",arguments)}function cb(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function oS(e){const t=xa(e),n=cb(t.r),r=cb(t.g),i=cb(t.b);return .2126*n+.7152*r+.0722*i}function uce(e,t){const n=oS(e),r=oS(t),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function lce(){const e=[].slice.call(arguments);return e.unshift({}),he(...e)}function _7(e,t){return e===t||e!==e&&t!==t?!0:I(e)?I(t)&&e.length===t.length?cce(e,t):!1:J(e)&&J(t)?k7(e,t):!1}function cce(e,t){for(let n=0,r=e.length;n<r;++n)if(!_7(e[n],t[n]))return!1;return!0}function k7(e,t){for(const n in e)if(!_7(e[n],t[n]))return!1;return!0}function zN(e){return t=>k7(e,t)}function fce(e,t,n,r,i,o){const s=this.context.dataflow,a=this.context.data[e],u=a.input,l=s.stamp();let c=a.changes,f,d;if(s._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(a.changes=c=s.changeset(),c.stamp=l,s.runAfter(()=>{a.modified=!0,s.pulse(u,c).run()},!0,1)),n&&(f=n===!0?qr:I(n)||Gy(n)?n:zN(n),c.remove(f)),t&&c.insert(t),r&&(f=zN(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in o)c.modify(i,d,o[d]);return 1}function dce(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)}function hce(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const IN={};function pce(e,t){const n=IN[t]||(IN[t]=nr(t));return I(e)?e.map(n):n(e)}function hA(e){return I(e)||ArrayBuffer.isView(e)?e:null}function pA(e){return hA(e)||(Q(e)?e:null)}function gce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return hA(e).join(...n)}function mce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return pA(e).indexOf(...n)}function yce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return pA(e).lastIndexOf(...n)}function vce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return pA(e).slice(...n)}function xce(e,t,n){return pe(n)&&z("Function argument passed to replace."),String(e).replace(t,n)}function bce(e){return hA(e).slice().reverse()}function wce(e,t,n){return S$(e||0,t||0,n||0)}function Ece(e,t){const n=ys(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Sce(e,t){const n=ys(e,(t||this).context);return n?n.copy():void 0}function _ce(e,t){const n=ys(e,(t||this).context);return n?n.domain():[]}function kce(e,t,n){const r=ys(e,(n||this).context);return r?I(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function $ce(e,t){const n=ys(e,(t||this).context);return n&&n.range?n.range():[]}function Cce(e,t,n){const r=ys(e,(n||this).context);return r?r(t):void 0}function Ace(e,t,n,r,i){e=ys(e,(i||this).context);const o=SI(t,n);let s=e.domain(),a=s[0],u=_e(s),l=yn;return u-a?l=fI(e,a,u):e=(e.interpolator?Fe("sequential")().interpolator(e.interpolator()):Fe("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(s=e.ticks(+r||15),a!==s[0]&&s.unshift(a),u!==_e(s)&&s.push(u)),s.forEach(c=>o.stop(l(c),e(c))),o}function Tce(e,t,n){const r=ys(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function Fce(e){let t=null;return function(n){return n?np(n,t=t||Kc(e)):e}}const $7=e=>e.data;function C7(e,t){const n=w7.call(t,e);return n.root&&n.root.lookup||{}}function Mce(e,t,n){const r=C7(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map($7):void 0}function Oce(e,t){const n=C7(e,this)[t];return n?n.ancestors().map($7):void 0}const A7=()=>typeof window<"u"&&window||null;function Nce(){const e=A7();return e?e.screen:{}}function Dce(){const e=A7();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Rce(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function T7(e,t,n){if(!e)return[];const[r,i]=e,o=new gt().set(r[0],r[1],i[0],i[1]),s=n||this.context.dataflow.scenegraph().root;return h8(s,o,Pce(t))}function Pce(e){let t=null;if(e){const n=K(e.marktype),r=K(e.markname);t=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return t}function Lce(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=K(e);const i=e[e.length-1];return i===void 0||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e}function zce(e){return K(e).reduce((t,n,r)=>{let[i,o]=n;return t+=r==0?`M ${i},${o} `:r===e.length-1?" Z":`L ${i},${o} `},"")}function Ice(e,t,n){const{x:r,y:i,mark:o}=n,s=new gt().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[u,l]of t)u<s.x1&&(s.x1=u),u>s.x2&&(s.x2=u),l<s.y1&&(s.y1=l),l>s.y2&&(s.y2=l);return s.translate(r,i),T7([[s.x1,s.y1],[s.x2,s.y2]],e,o).filter(u=>jce(u.x,u.y,t))}function jce(e,t,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[s,a]=n[o],[u,l]=n[i];l>t!=a>t&&e<(s-u)*(t-l)/(a-l)+u&&r++}return r&1}const hp={random(){return Vr()},cumulativeNormal:Jy,cumulativeLogNormal:Sk,cumulativeUniform:Ck,densityNormal:vk,densityLogNormal:Ek,densityUniform:$k,quantileNormal:Zy,quantileLogNormal:_k,quantileUniform:Ak,sampleNormal:Ky,sampleLogNormal:wk,sampleUniform:kk,isArray:I,isBoolean:Ra,isDate:aa,isDefined(e){return e!==void 0},isNumber:je,isObject:J,isRegExp:q4,isString:Q,isTuple:Gy,isValid(e){return e!=null&&e===e},toBoolean:K_,toDate(e){return J_(e)},toNumber:ln,toString:Z_,indexof:mce,join:gce,lastindexof:yce,replace:xce,reverse:bce,slice:vce,flush:U4,lerp:H4,merge:lce,pad:Y4,peek:_e,pluck:pce,span:Np,inrange:lc,truncate:X4,rgb:xa,lab:e1,hcl:t1,hsl:J0,luminance:oS,contrast:uce,sequence:xr,format:Wle,utcFormat:qle,utcParse:Vle,utcOffset:AL,utcSequence:ML,timeFormat:E7,timeParse:Hle,timeOffset:CL,timeSequence:FL,timeUnitSpecifier:mL,monthFormat:Gle,monthAbbrevFormat:Yle,dayFormat:Xle,dayAbbrevFormat:Qle,quarter:z4,utcquarter:I4,week:vL,utcweek:wL,dayofyear:yL,utcdayofyear:bL,warn:oce,info:sce,debug:ace,extent(e){return lo(e)},inScope:ice,intersect:T7,clampRange:j4,pinchDistance:dce,pinchAngle:hce,screen:Nce,containerSize:Rce,windowSize:Dce,bandspace:wce,setdata:Ble,pathShape:Fce,panLinear:D4,panLog:R4,panPow:P4,panSymlog:L4,zoomLinear:H_,zoomLog:V_,zoomPow:z0,zoomSymlog:G_,encode:Ule,modify:fce,lassoAppend:Lce,lassoPath:zce,intersectLasso:Ice},Bce=["view","item","group","xy","x","y"],Uce="event.vega.",F7="this.",gA={},M7={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${V(S7+e)}]`,functions:Wce,constants:y7,visitors:gA},sS=x7(M7);function Wce(e){const t=v7(e);Bce.forEach(n=>t[n]=Uce+n);for(const n in hp)t[n]=F7+n;return he(t,ece(e,hp,gA)),t}function yt(e,t,n){return arguments.length===1?hp[e]:(hp[e]=t,n&&(gA[e]=n),sS&&(sS.functions[e]=F7+e),this)}yt("bandwidth",Ece,Jn);yt("copy",Sce,Jn);yt("domain",_ce,Jn);yt("range",$ce,Jn);yt("invert",kce,Jn);yt("scale",Cce,Jn);yt("gradient",Ace,Jn);yt("geoArea",tce,Jn);yt("geoBounds",nce,Jn);yt("geoCentroid",rce,Jn);yt("geoShape",Tce,Jn);yt("indata",jle,Zle);yt("data",w7,cA);yt("treePath",Mce,cA);yt("treeAncestors",Oce,cA);yt("vlSelectionTest",Ole,lA);yt("vlSelectionIdTest",Rle,lA);yt("vlSelectionResolve",Lle,lA);yt("vlSelectionTuples",Ple);function go(e,t){const n={};let r;try{e=Q(e)?e:V(e)+"",r=aA(e)}catch{z("Expression parse error: "+e)}r.visit(o=>{if(o.type!==c7)return;const s=o.callee.name,a=M7.visitors[s];a&&a(s,o.arguments,t,n)});const i=sS(r);return i.globals.forEach(o=>{const s=S7+o;!ae(n,s)&&t.getSignal(o)&&(n[s]=t.signalRef(o))}),{$expr:he({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function qce(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const Hce=Ci(["rule"]),jN=Ci(["group","image","rect"]);function Vce(e,t){let n="";return Hce[t]||(e.x2&&(e.x?(jN[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(jN[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function mA(e){return(e+"").toLowerCase()}function Gce(e){return mA(e)==="operator"}function Yce(e){return mA(e)==="collect"}function vd(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function Xce(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `}var Qce={operator:(e,t)=>vd(e,["_"],t.code),parameter:(e,t)=>vd(e,["datum","_"],t.code),event:(e,t)=>vd(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return vd(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const s="o["+V(o)+"]";i+=`$=${r[o].code};if(${s}!==$)${s}=$,m=1;`}return i+=Vce(r,n),i+="return m;",vd(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(V).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=(o,s)=>{const a=t[s];let u,l;return o.path?(u=`a${o.path}`,l=`b${o.path}`):((n=n||{})["f"+s]=o,u=`this.f${s}(a)`,l=`this.f${s}(b)`),Xce(u,l,-a,a)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function Kce(e){const t=this;Gce(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function Jce(e){const t=this;if(e.params){const n=t.get(e.id);n||z("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Zce(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=I(i)?i.map(o=>BN(o,n,t)):BN(i,n,t)}return t}function BN(e,t,n){if(!e||!J(e))return e;for(let r=0,i=UN.length,o;r<i;++r)if(o=UN[r],ae(e,o.key))return o.parse(e,t,n);return e}var UN=[{key:"$ref",parse:efe},{key:"$key",parse:nfe},{key:"$expr",parse:tfe},{key:"$field",parse:rfe},{key:"$encode",parse:ofe},{key:"$compare",parse:ife},{key:"$context",parse:sfe},{key:"$subflow",parse:afe},{key:"$tupleid",parse:ufe}];function efe(e,t){return t.get(e.$ref)||z("Operator not defined: "+e.$ref)}function tfe(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=lr(t.parameterExpression(e.$expr),e.$fields))}function nfe(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Q_(e.$key,e.$flat,t.expr.codegen))}function rfe(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=nr(e.$field,e.$name,t.expr.codegen))}function ife(e,t){const n="c:"+e.$compare+"_"+e.$order,r=K(e.$compare).map(i=>i&&i.$tupleid?oe:i);return t.fn[n]||(t.fn[n]=Y_(r,e.$order,t.expr.codegen))}function ofe(e,t){const n=e.$encode,r={};for(const i in n){const o=n[i];r[i]=lr(t.encodeExpression(o.$expr),o.$fields),r[i].output=o.$output}return r}function sfe(e,t){return t}function afe(e,t){const n=e.$subflow;return function(r,i,o){const s=t.fork().parse(n),a=s.get(n.operators[0].id),u=s.signals.parent;return u&&u.set(o),a.detachSubflow=()=>t.detach(s),a}}function ufe(){return oe}function lfe(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(o=>t.get(o)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(o=>t.get(o)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&z("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function cfe(e){var t=this,n=J(n=e.source)?n.$ref:n,r=t.get(n),i=null,o=e.update,s=void 0;r||z("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(s=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,r,i,o,s)}const ffe={skip:!0};function dfe(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(o=>{const s=t.signals[o];e.signals(o,s)&&(r[o]=s.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(o=>{const s=t.data[o];e.data(o,s)&&(i[o]=s.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function hfe(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(o=>{n.update(t.signals[o],i[o],ffe)}),Object.keys(r||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(qr).insert(r[o]))}),(e.subcontext||[]).forEach((o,s)=>{const a=t.subcontext[s];a&&a.setState(o)})}function O7(e,t,n,r){return new N7(e,t,n,r)}function N7(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||Qce,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function WN(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}N7.prototype=WN.prototype={fork(){const e=new WN(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),Yce(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(r.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),r.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const s=n.data[o]||(n.data[o]={});e.data[o].forEach(a=>s[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[mA(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:qce,parseOperator:Kce,parseOperatorParameters:Jce,parseParameters:Zce,parseStream:lfe,parseUpdate:cfe,getState:dfe,setState:hfe};function pfe(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),D7(t,e.description()))}function D7(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function gfe(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const fb="default";function mfe(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:fb,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,o=i?Q(i)?i:i.user:fb,s=r.item&&r.item.cursor||null;return i&&o===i.user&&s==i.item?i:{user:o,item:s}}),e.add(null,function(n){let r=n.cursor,i=this.value;return Q(r)||(i=r.item,r=r.user),aS(e,r&&r!==fb?r:i||r),i},{cursor:t})}function aS(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function Y1(e,t){var n=e._runtime.data;return ae(n,t)||z("Unrecognized data set: "+t),n[t]}function yfe(e,t){return arguments.length<2?Y1(this,e).values.value:Iv.call(this,e,bl().remove(qr).insert(t))}function Iv(e,t){i6(t)||z("Second argument to changes must be a changeset.");const n=Y1(this,e);return n.modified=!0,this.pulse(n.input,t)}function vfe(e,t){return Iv.call(this,e,bl().insert(t))}function xfe(e,t){return Iv.call(this,e,bl().remove(t))}function R7(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function P7(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function jv(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function bfe(e){var t=jv(e),n=R7(e),r=P7(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(o){e.error(o)}})}function wfe(e,t,n){var r=e._renderer,i=r&&r.canvas(),o,s,a;return i&&(a=jv(e),s=t.changedTouches?t.changedTouches[0]:t,o=$v(s,i),o[0]-=a[0],o[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=Efe(e,n,o),t}function Efe(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(s){var a=r,u;if(s){for(u=t;u;u=u.mark.group)if(u.mark.name===s){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function o(s){if(!s)return n;Q(s)&&(s=i(s));const a=n.slice();for(;s;)a[0]-=s.x||0,a[1]-=s.y||0,s=s.mark&&s.mark.group;return a}return{view:vn(e),item:vn(t||{}),group:i,xy:o,x:s=>o(s)[0],y:s=>o(s)[1]}}const qN="view",Sfe="timer",_fe="window",kfe={trap:!1};function $fe(e){const t=he({defaults:{}},e),n=(r,i)=>{i.forEach(o=>{I(r[o])&&(r[o]=Ci(r[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function L7(e,t,n,r){e._eventListeners.push({type:n,sources:K(t),handler:r})}function Cfe(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function pm(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||J(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Afe(e,t,n){var r=this,i=new Qy(n),o=function(l,c){r.runAsync(null,()=>{e===qN&&Cfe(r,t)&&l.preventDefault(),i.receive(wfe(r,l,c))})},s;if(e===Sfe)pm(r,"timer",t)&&r.timer(o,t);else if(e===qN)pm(r,"view",t)&&r.addEventListener(t,o,kfe);else if(e===_fe?pm(r,"window",t)&&typeof window<"u"&&(s=[window]):typeof document<"u"&&pm(r,"selector",t)&&(s=Array.from(document.querySelectorAll(e))),!s)r.warn("Can not resolve event source: "+e);else{for(var a=0,u=s.length;a<u;++a)s[a].addEventListener(t,o);L7(r,s,t,o)}return i}function HN(e){return e.item}function VN(e){return e.item.mark.source}function GN(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Tfe(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",HN),VN,GN(e)),this.on(this.events("view","mouseout",HN),VN,GN(t)),this}function Ffe(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,o;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(o=n[r],i=o.sources.length;--i>=0;)o.sources[i].removeEventListener(o.type,o.handler);return e&&e.call(this,this._handler,null,null,null),this}function wr(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const Mfe="vega-bind",Ofe="vega-bind-name",Nfe="vega-bind-radio";function Dfe(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:s=>{s!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,s)})}},r.debounce&&(i.update=X_(r.debounce,i.update))),(r.input==null&&r.element?Rfe:Lfe)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function Rfe(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),L7(r,t,i,o),e.set=s=>{t.value=s,t.dispatchEvent(Pfe(i))}}function Pfe(e){return typeof Event<"u"?new Event(e):{type:e}}function Lfe(e,t,n,r){const i=r.signal(n.signal),o=wr("div",{class:Mfe}),s=n.input==="radio"?o:o.appendChild(wr("label"));s.appendChild(wr("span",{class:Ofe},n.name||n.signal)),t.appendChild(o);let a=zfe;switch(n.input){case"checkbox":a=Ife;break;case"select":a=jfe;break;case"radio":a=Bfe;break;case"range":a=Ufe;break}a(e,s,n,i)}function zfe(e,t,n,r){const i=wr("input");for(const o in n)o!=="signal"&&o!=="element"&&i.setAttribute(o==="input"?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=o=>i.value=o}function Ife(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=wr("input",i);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=s=>o.checked=!!s||null}function jfe(e,t,n,r){const i=wr("select",{name:n.signal}),o=n.labels||[];n.options.forEach((s,a)=>{const u={value:s};X1(s,r)&&(u.selected=!0),i.appendChild(wr("option",u,(o[a]||s)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=s=>{for(let a=0,u=n.options.length;a<u;++a)if(X1(n.options[a],s)){i.selectedIndex=a;return}}}function Bfe(e,t,n,r){const i=wr("span",{class:Nfe}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map((s,a)=>{const u={type:"radio",name:n.signal,value:s};X1(s,r)&&(u.checked=!0);const l=wr("input",u);l.addEventListener("change",()=>e.update(s));const c=wr("label",{},(o[a]||s)+"");return c.prepend(l),i.appendChild(c),l}),e.set=s=>{const a=e.elements,u=a.length;for(let l=0;l<u;++l)X1(a[l].value,s)&&(a[l].checked=!0)}}function Ufe(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,s=n.step||ma(o,i,100),a=wr("input",{type:"range",name:n.signal,min:o,max:i,step:s});a.value=r;const u=wr("span",{},+r);t.appendChild(a),t.appendChild(u);const l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function X1(e,t){return e===t||e+""==t+""}function z7(e,t,n,r,i,o){return t=t||new r(e.loader()),t.initialize(n,R7(e),P7(e),jv(e),i,o).background(e.background())}function yA(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Wfe(e,t,n,r){const i=new r(e.loader(),yA(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,jv(e),e);return t&&t.handlers().forEach(o=>{i.on(o.type,o.handler)}),i}function qfe(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=Cv(r);e=n._el=e?db(n,e,!0):null,pfe(n),o||n.error("Unrecognized renderer type: "+r);const s=o.handler||Zp,a=e?o.renderer:o.headless;return n._renderer=a?z7(n,n._renderer,e,a):null,n._handler=Wfe(n,n._handler,e,s),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=db(n,t,!0):e.appendChild(wr("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=db(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{Dfe(n,u.element||t,u)})),n}function db(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(r){t=null,e.error(r)}return t}const xd=e=>+e||0,Hfe=e=>({top:e,bottom:e,left:e,right:e});function YN(e){return J(e)?{top:xd(e.top),bottom:xd(e.bottom),left:xd(e.left),right:xd(e.right)}:Hfe(xd(e))}async function vA(e,t,n,r){const i=Cv(t),o=i&&i.headless;return o||z("Unrecognized renderer type: "+t),await e.runAsync(),z7(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}async function Vfe(e,t){e!==Vs.Canvas&&e!==Vs.SVG&&e!==Vs.PNG&&z("Unrecognized image type: "+e);const n=await vA(this,e,t);return e===Vs.SVG?Gfe(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Gfe(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function Yfe(e,t){return(await vA(this,Vs.Canvas,e,t)).canvas()}async function Xfe(e){return(await vA(this,Vs.SVG,e)).svg()}function Qfe(e,t,n){return O7(e,Hc,hp,n).parse(t)}function Kfe(e){var t=this._runtime.scales;return ae(t,e)||z("Unrecognized scale or projection: "+e),t[e].value}var I7="width",j7="height",xA="padding",XN={skip:!0};function B7(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===xA?r.left+r.right:0)}function U7(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===xA?r.top+r.bottom:0)}function Jfe(e){var t=e._signals,n=t[I7],r=t[j7],i=t[xA];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=B7(e,a.size),o()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=U7(e,a.size),o()},{size:r});const s=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,s.rank=i.rank+1}function Zfe(e,t,n,r,i,o){this.runAfter(s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal(I7,n,XN),s._resizeWidth.skip(!0)),s.height()!==r&&(a=1,s.signal(j7,r,XN),s._resizeHeight.skip(!0)),s._viewWidth!==e&&(s._resize=1,s._viewWidth=e),s._viewHeight!==t&&(s._resize=1,s._viewHeight=t),(s._origin[0]!==i[0]||s._origin[1]!==i[1])&&(s._resize=1,s._origin=i),a&&s.run("enter"),o&&s.runAfter(u=>u.resize())},!1,1)}function ede(e){return this._runtime.getState(e||{data:tde,signals:nde,recurse:!0})}function tde(e,t){return t.modified&&I(t.input.value)&&e.indexOf("_:vega:_")}function nde(e,t){return!(e==="parent"||t instanceof Hc.proxy)}function rde(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function ide(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(Moe(n,t))}function ode(e,t,n,r){const i=e.element();i&&i.setAttribute("title",sde(r))}function sde(e){return e==null?"":I(e)?W7(e):J(e)&&!aa(e)?ade(e):e+""}function ade(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(I(n)?W7(n):q7(n))}).join(`
`)}function W7(e){return"["+e.map(q7).join(", ")+"]"}function q7(e){return I(e)?"[…]":J(e)&&!aa(e)?"{…}":e}function H7(e,t){const n=this;if(t=t||{},wc.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const o=he({},e.locale,t.locale);n.locale(YL(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Vs.Canvas,n._scenegraph=new Z$;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||ode,n._redraw=!0,n._handler=new Zp().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=$fe(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=Qfe(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:he({},o)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=B7(n,n._width),n._viewHeight=U7(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,Jfe(n),gfe(n),mfe(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function gm(e,t){return ae(e._signals,t)?e._signals[t]:z("Unrecognized signal name: "+V(t))}function V7(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function QN(e,t,n,r){let i=V7(n,r);return i||(i=yA(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function KN(e,t,n){const r=V7(t,n);return r&&t._targets.remove(r),e}G(H7,wc,{async evaluate(e,t,n){if(await wc.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,bfe(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&Bm(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&D7(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=gm(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",YN(e)):YN(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Cv(e)||z("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(wc.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(gm(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Zfe,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=yA(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,o;--r>=0;)if(o=n[r].type,i=n[r].handler,e===o&&(t===i||t===i.raw)){this._handler.off(o,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return QN(this,e,gm(this,e),t)},removeSignalListener(e,t){return KN(this,gm(this,e),t)},addDataListener(e,t){return QN(this,e,Y1(this,e).values,t)},removeDataListener(e,t){return KN(this,Y1(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=aS(this,null);this._globalCursor=!!e,t&&aS(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:ide,events:Afe,finalize:Ffe,hover:Tfe,data:yfe,change:Iv,insert:vfe,remove:xfe,scale:Kfe,initialize:qfe,toImageURL:Vfe,toCanvas:Yfe,toSVG:Xfe,getState:ede,setState:rde});const ude="view",Q1="[",K1="]",G7="{",Y7="}",lde=":",X7=",",cde="@",fde=">",dde=/[[\]{}]/,hde={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Q7,K7;function Ba(e,t,n){return Q7=t||ude,K7=n||hde,J7(e.trim()).map(uS)}function pde(e){return K7[e]}function kh(e,t,n,r,i){const o=e.length;let s=0,a;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function J7(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=kh(e,i,X7,Q1+G7,K1+Y7),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function uS(e){return e[0]==="["?gde(e):mde(e)}function gde(e){const t=e.length;let n=1,r;if(n=kh(e,n,K1,Q1,K1),n===t)throw"Empty between selector: "+e;if(r=J7(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==fde)throw"Expected '>' after between selector: "+e;r=r.map(uS);const i=uS(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function mde(e){const t={source:Q7},n=[];let r=[0,0],i=0,o=0,s=e.length,a=0,u,l;if(e[s-1]===Y7){if(a=e.lastIndexOf(G7),a>=0){try{r=yde(e.substring(a+1,s-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),s=e.length}else throw"Unmatched right brace: "+e;a=0}if(!s)throw e;if(e[0]===cde&&(i=++a),u=kh(e,a,lde),u<s&&(n.push(e.substring(o,u).trim()),o=a=++u),a=kh(e,a,Q1),a===s)n.push(e.substring(o,s).trim());else if(n.push(e.substring(o,a).trim()),l=[],o=++a,o===s)throw"Unmatched left bracket: "+e;for(;a<s;){if(a=kh(e,a,K1),a===s)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,a).trim()),a<s-1&&e[++a]!==Q1)throw"Expected left bracket: "+e;o=++a}if(!(s=n.length)||dde.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],i?t.markname=n[0].slice(1):pde(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function yde(e){const t=e.split(X7);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function vde(e){return J(e)?e:{type:e||"pad"}}const bd=e=>+e||0,xde=e=>({top:e,bottom:e,left:e,right:e});function bde(e){return J(e)?e.signal?e:{top:bd(e.top),bottom:bd(e.bottom),left:bd(e.left),right:bd(e.right)}:xde(bd(e))}const Ot=e=>J(e)&&!I(e)?he({},e):{value:e};function JN(e,t,n,r){return n!=null?(J(n)&&!I(n)||I(n)&&n.length&&J(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function Xt(e,t,n){for(const r in t)JN(e,r,t[r]);for(const r in n)JN(e,r,n[r],"update")}function zf(e,t,n){for(const r in t)n&&ae(n,r)||(e[r]=he(e[r]||{},t[r]));return e}function Xl(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const bA="mark",wA="frame",EA="scope",wde="axis",Ede="axis-domain",Sde="axis-grid",_de="axis-label",kde="axis-tick",$de="axis-title",Cde="legend",Ade="legend-band",Tde="legend-entry",Fde="legend-gradient",Z7="legend-label",Mde="legend-symbol",Ode="legend-title",Nde="title",Dde="title-text",Rde="title-subtitle";function Pde(e,t,n,r,i){const o={},s={};let a,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!Xl(u,e)&&hb(o,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===wA?i.group:n===bA?he({},i.mark,i[t]):null;for(u in c)l=Xl(u,e)||(u==="fill"||u==="stroke")&&(Xl("fill",e)||Xl("stroke",e)),l||hb(o,u,c[u]);K(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)Xl(h,e)||hb(o,h,d[h])}),e=he({},e);for(u in o)c=o[u],c.signal?(a=a||{})[u]=c:s[u]=c;return e.enter=he(s,e.enter),a&&(e.update=he(a,e.update)),e}function hb(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const ej=e=>Q(e)?V(e):e.signal?`(${e.signal})`:tj(e);function Bv(e){if(e.gradient!=null)return zde(e);let t=e.signal?`(${e.signal})`:e.color?Lde(e.color):e.field!=null?tj(e.field):e.value!==void 0?V(e.value):void 0;return e.scale!=null&&(t=Ide(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${i0(e.exponent)})`),e.mult!=null&&(t+=`*${i0(e.mult)}`),e.offset!=null&&(t+=`+${i0(e.offset)}`),e.round&&(t=`round(${t})`),t}const mm=(e,t,n,r)=>`(${e}(${[t,n,r].map(Bv).join(",")})+'')`;function Lde(e){return e.c?mm("hcl",e.h,e.c,e.l):e.h||e.s?mm("hsl",e.h,e.s,e.l):e.l||e.a?mm("lab",e.l,e.a,e.b):e.r||e.g||e.b?mm("rgb",e.r,e.g,e.b):null}function zde(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:V(n));for(;t.length&&_e(t)==null;)t.pop();return t.unshift(ej(e.gradient)),`gradient(${t.join(",")})`}function i0(e){return J(e)?"("+Bv(e)+")":e}function tj(e){return nj(J(e)?e:{datum:e})}function nj(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):z("Invalid field reference: "+V(e));return e.signal||(r=Q(r)?xo(r).map(V).join("]["):nj(r)),t+"["+r+"]"}function Ide(e,t){const n=ej(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+i0(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function jde(e){let t="";return e.forEach(n=>{const r=Bv(n);t+=n.test?`(${n.test})?${r}:`:r}),_e(t)===":"&&(t+="null"),t}function rj(e,t,n,r,i,o){const s={};o=o||{},o.encoders={$encode:s},e=Pde(e,t,n,r,i.config);for(const a in e)s[a]=Bde(e[a],t,o,i);return o}function Bde(e,t,n,r){const i={},o={};for(const s in e)e[s]!=null&&(i[s]=Wde(Ude(e[s]),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function Ude(e){return I(e)?jde(e):Bv(e)}function Wde(e,t,n,r){const i=go(e,t);return i.$fields.forEach(o=>r[o]=1),he(n,i.$params),i.$expr}const qde="outer",Hde=["value","update","init","react","bind"];function ZN(e,t){z(e+' for "outer" push: '+V(t))}function ij(e,t){const n=e.name;if(e.push===qde)t.signals[n]||ZN("No prior signal definition",n),Hde.forEach(r=>{e[r]!==void 0&&ZN("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function lS(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function Uv(e,t,n,r){return new lS(e,t,n,r)}function J1(e,t){return Uv("operator",e,t)}function ie(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function pp(e,t){return t?{$field:e,$name:t}:{$field:e}}const cS=pp("key");function eD(e,t){return{$compare:e,$order:t}}function Vde(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const Gde="ascending",Yde="descending";function Xde(e){return J(e)?(e.order===Yde?"-":"+")+Wv(e.op,e.field):""}function Wv(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const SA="scope",fS="view";function St(e){return e&&e.signal}function Qde(e){return e&&e.expr}function o0(e){if(St(e))return!0;if(J(e)){for(const t in e)if(o0(e[t]))return!0}return!1}function ui(e,t){return e??t}function Ru(e){return e&&e.signal||e}const tD="timer";function gp(e,t){return(e.merge?Jde:e.stream?Zde:e.type?ehe:z("Invalid stream specification: "+V(e)))(e,t)}function Kde(e){return e===SA?fS:e||fS}function Jde(e,t){const n=e.merge.map(i=>gp(i,t)),r=_A({merge:n},e,t);return t.addStream(r).id}function Zde(e,t){const n=gp(e.stream,t),r=_A({stream:n},e,t);return t.addStream(r).id}function ehe(e,t){let n;e.type===tD?(n=t.event(tD,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Kde(e.source),e.type);const r=_A({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function _A(e,t,n){let r=t.between;return r&&(r.length!==2&&z('Stream "between" parameter must have 2 entries: '+V(t)),e.between=[gp(r[0],n),gp(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(the(t.marktype,t.markname,t.markrole)),t.source===SA&&r.push("inScope(event.item)"),r.length&&(e.filter=go("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function the(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const nhe={code:"_.$value",ast:{type:"Identifier",value:"value"}};function rhe(e,t,n){const r=e.encode,i={target:n};let o=e.events,s=e.update,a=[];o||z("Signal update missing events specification."),Q(o)&&(o=Ba(o,t.isSubscope()?SA:fS)),o=K(o).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[ohe(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),r!=null&&(s&&z("Signal encode and update are mutually exclusive."),s="encode(item(),"+V(r)+")"),i.update=Q(s)?go(s,t):s.expr!=null?go(s.expr,t):s.value!=null?s.value:s.signal!=null?{$expr:nhe,$params:{$value:t.signalRef(s.signal)}}:z("Invalid signal update specification."),e.force&&(i.options={force:!0}),a.forEach(u=>t.addUpdate(he(ihe(u,t),i)))}function ihe(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):gp(e,t)}}function ohe(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function she(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?z("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=go(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>rhe(i,t,n.id))}const Be=e=>(t,n,r)=>Uv(e,n,t||void 0,r),oj=Be("aggregate"),ahe=Be("axisticks"),sj=Be("bound"),Ni=Be("collect"),nD=Be("compare"),uhe=Be("datajoin"),aj=Be("encode"),lhe=Be("expression"),che=Be("facet"),fhe=Be("field"),dhe=Be("key"),hhe=Be("legendentries"),phe=Be("load"),ghe=Be("mark"),mhe=Be("multiextent"),yhe=Be("multivalues"),vhe=Be("overlap"),xhe=Be("params"),uj=Be("prefacet"),bhe=Be("projection"),whe=Be("proxy"),Ehe=Be("relay"),lj=Be("render"),She=Be("scale"),_l=Be("sieve"),_he=Be("sortitems"),cj=Be("viewlayout"),khe=Be("values");let $he=0;const fj={min:"min",max:"max",count:"sum"};function Che(e,t){const n=e.type||"linear";oI(n)||z("Unrecognized scale type: "+V(n)),t.addScale(e.name,{type:n,domain:void 0})}function Ahe(e,t){const n=t.getScale(e.name).params;let r;n.domain=dj(e.domain,e,t),e.range!=null&&(n.range=pj(e,t,n)),e.interpolate!=null&&zhe(e.interpolate,n),e.nice!=null&&(n.nice=Lhe(e.nice)),e.bins!=null&&(n.bins=Phe(e.bins,t));for(r in e)ae(n,r)||r==="name"||(n[r]=Lr(e[r],t))}function Lr(e,t){return J(e)?e.signal?t.signalRef(e.signal):z("Unsupported object: "+V(e)):e}function s0(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Lr(n,t))}function qv(e){z("Can not find data set: "+V(e))}function dj(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&z("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(I(e)?The:e.fields?Mhe:Fhe)(e,t,n)}function The(e,t,n){return e.map(r=>Lr(r,n))}function Fhe(e,t,n){const r=n.getData(e.data);return r||qv(e.data),Qc(t.type)?r.valuesRef(n,e.field,hj(e.sort,!1)):uI(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Mhe(e,t,n){const r=e.data,i=e.fields.reduce((o,s)=>(s=Q(s)?{data:r,field:s}:I(s)||s.signal?Ohe(s,n):s,o.push(s),o),[]);return(Qc(t.type)?Nhe:uI(t.type)?Dhe:Rhe)(e,n,i)}function Ohe(e,t){const n="_:vega:_"+$he++,r=Ni({});if(I(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+V(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,_l({})]),{data:n,field:"data"}}function Nhe(e,t,n){const r=hj(e.sort,!0);let i,o;const s=n.map(l=>{const c=t.getData(l.data);return c||qv(l.data),c.countsRef(t,l.field,r)}),a={groupby:cS,pulse:s};r&&(i=r.op||"count",o=r.field?Wv(i,r.field):"count",a.ops=[fj[i]],a.fields=[t.fieldRef(o)],a.as=[o]),i=t.add(oj(a));const u=t.add(Ni({pulse:ie(i)}));return o=t.add(khe({field:cS,sort:t.sortRef(r),pulse:ie(u)})),ie(o)}function hj(e,t){return e&&(!e.field&&!e.op?J(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?z("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!fj[e.op]&&z("Multiple domain scales can not be sorted using "+e.op)),e}function Dhe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||qv(i.data),o.domainRef(t,i.field)});return ie(t.add(yhe({values:r})))}function Rhe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||qv(i.data),o.extentRef(t,i.field)});return ie(t.add(mhe({extents:r})))}function Phe(e,t){return e.signal||I(e)?s0(e,t):t.objectProperty(e)}function Lhe(e){return J(e)?{interval:Lr(e.interval),step:Lr(e.step)}:Lr(e)}function zhe(e,t){t.interpolate=Lr(e.type||e),e.gamma!=null&&(t.interpolateGamma=Lr(e.gamma))}function pj(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(Q(i)){if(r&&ae(r,i))return e=he({},e,{range:r[i]}),pj(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=Qc(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:z("Unrecognized scale range value: "+V(i))}else if(i.scheme){n.scheme=I(i.scheme)?s0(i.scheme,t):Lr(i.scheme,t),i.extent&&(n.schemeExtent=s0(i.extent,t)),i.count&&(n.schemeCount=Lr(i.count,t));return}else if(i.step){n.rangeStep=Lr(i.step,t);return}else{if(Qc(e.type)&&!I(i))return dj(i,e,t);I(i)||z("Unsupported range type: "+V(i))}return i.map(o=>(I(o)?s0:Lr)(o,t))}function Ihe(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=dS(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=dS(n[i],i,t));t.addProjection(e.name,r)}function dS(e,t,n){return I(e)?e.map(r=>dS(r,t,n)):J(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:z("Unsupported parameter object: "+V(e)):e}const Di="top",If="left",jf="right",ka="bottom",gj="center",jhe="vertical",Bhe="start",Uhe="middle",Whe="end",hS="index",kA="label",qhe="offset",af="perc",Hhe="perc2",jr="value",ug="guide-label",$A="guide-title",Vhe="group-title",Ghe="group-subtitle",rD="symbol",a0="gradient",pS="discrete",gS="size",Yhe="shape",Xhe="fill",Qhe="stroke",Khe="strokeWidth",Jhe="strokeDash",Zhe="opacity",CA=[gS,Yhe,Xhe,Qhe,Khe,Jhe,Zhe],lg={name:1,style:1,interactive:1},$e={value:0},Br={value:1},Hv="group",mj="rect",AA="rule",epe="symbol",kl="text";function mp(e){return e.type=Hv,e.interactive=e.interactive||!1,e}function cr(e,t){const n=(r,i)=>ui(e[r],ui(t[r],i));return n.isVertical=r=>jhe===ui(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>ui(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>ui(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>ui(e.columns,ui(t.columns,+n.isVertical(!0))),n}function yj(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function tpe(e,t,n){const r=t.config.style[n];return r&&r[e]}function Vv(e,t,n){return`item.anchor === '${Bhe}' ? ${e} : item.anchor === '${Whe}' ? ${t} : ${n}`}const TA=Vv(V(If),V(jf),V(gj));function npe(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},J(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function vj(e,t){return t?e?J(e)?Object.assign({},e,{offset:vj(e.offset,t)}):{value:e,offset:t}:t:e}function $r(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=zf(e.encode,t,lg)):e.interactive=!1,e}function rpe(e,t,n,r){const i=cr(e,n),o=i.isVertical(),s=i.gradientThickness(),a=i.gradientLength();let u,l,c,f,d;o?(l=[0,1],c=[0,0],f=s,d=a):(l=[0,0],c=[1,0],f=a,d=s);const h={enter:u={opacity:$e,x:$e,y:$e,width:Ot(f),height:Ot(d)},update:he({},u,{opacity:Br,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:$e}};return Xt(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),$r({type:mj,role:Fde,encode:h},r)}function ipe(e,t,n,r,i){const o=cr(e,n),s=o.isVertical(),a=o.gradientThickness(),u=o.gradientLength();let l,c,f,d,h="";s?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:$e,fill:{scale:t,field:jr}};p[l]={signal:h+"datum."+af,mult:u},p[c]=$e,p[f]={signal:h+"datum."+Hhe,mult:u},p[d]=Ot(a);const g={enter:p,update:he({},p,{opacity:Br}),exit:{opacity:$e}};return Xt(g,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),$r({type:mj,role:Ade,key:jr,from:i,encode:g},r)}const ope=`datum.${af}<=0?"${If}":datum.${af}>=1?"${jf}":"${gj}"`,spe=`datum.${af}<=0?"${ka}":datum.${af}>=1?"${Di}":"${Uhe}"`;function iD(e,t,n,r){const i=cr(e,t),o=i.isVertical(),s=Ot(i.gradientThickness()),a=i.gradientLength();let u=i("labelOverlap"),l,c,f,d,h="";const p={enter:l={opacity:$e},update:c={opacity:Br,text:{field:kA}},exit:{opacity:$e}};return Xt(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:ui(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=c.baseline={signal:spe},f="y",d="x",h="1-"):(l.align=c.align={signal:ope},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+af,mult:a},l[d]=c[d]=s,s.offset=ui(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+hS}:void 0,$r({type:kl,role:Z7,style:ug,key:jr,from:r,encode:p,overlap:u},n)}function ape(e,t,n,r,i){const o=cr(e,t),s=n.entries,a=!!(s&&s.interactive),u=s?s.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${qhe} : datum.${gS}`,h=l?Ot(l):{field:gS},p=`datum.${hS}`,g=`max(1, ${i})`;let y,m,v,x,b;h.mult=.5,y={enter:m={opacity:$e,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Br,x:m.x,y:m.y},exit:{opacity:$e}};let w=null,S=null;e.fill||(w=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),Xt(y,{fill:o("symbolFillColor",w),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",S),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),CA.forEach(k=>{e[k]&&(v[k]=m[k]={scale:e[k],field:jr})});const E=$r({type:epe,role:Mde,key:jr,from:f,clip:l?!0:void 0,encode:y},n.symbols),_=Ot(c);_.offset=o("labelOffset"),y={enter:m={opacity:$e,x:{signal:d,offset:_},y:h},update:v={opacity:Br,text:{field:kA},x:m.x,y:m.y},exit:{opacity:$e}},Xt(y,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const $=$r({type:kl,role:Z7,style:ug,key:jr,from:f,encode:y},n.labels);return y={enter:{noBound:{value:!l},width:$e,height:l?Ot(l):$e,opacity:$e},exit:{opacity:$e},update:v={opacity:Br,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(x=`ceil(item.mark.items.length / ${g})`,v.row.signal=`${p}%${x}`,v.column.signal=`floor(${p} / ${x})`,b={field:["row",p]}):(v.row.signal=`floor(${p} / ${g})`,v.column.signal=`${p} % ${g}`,b={field:p}),v.column.signal=`(${i})?${v.column.signal}:${p}`,r={facet:{data:r,name:"value",groupby:hS}},mp({role:EA,from:r,encode:zf(y,s,lg),marks:[E,$],name:u,interactive:a,sort:b})}function upe(e,t){const n=cr(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const FA='item.orient === "left"',MA='item.orient === "right"',Gv=`(${FA} || ${MA})`,lpe=`datum.vgrad && ${Gv}`,cpe=Vv('"top"','"bottom"','"middle"'),fpe=Vv('"right"','"left"','"center"'),dpe=`datum.vgrad && ${MA} ? (${fpe}) : (${Gv} && !(datum.vgrad && ${FA})) ? "left" : ${TA}`,hpe=`item._anchor || (${Gv} ? "middle" : "start")`,ppe=`${lpe} ? (${FA} ? -90 : 90) : 0`,gpe=`${Gv} ? (datum.vgrad ? (${MA} ? "bottom" : "top") : ${cpe}) : "top"`;function mpe(e,t,n,r){const i=cr(e,t),o={enter:{opacity:$e},update:{opacity:Br,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:$e}};return Xt(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:hpe},angle:{signal:ppe},align:{signal:dpe},baseline:{signal:gpe},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),$r({type:kl,role:Ode,style:$A,from:r,encode:o},n)}function ype(e,t){let n;return J(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+oD(e.path)+")":e.sphere&&(n="geoShape("+oD(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function oD(e){return J(e)&&e.signal?e.signal:V(e)}function xj(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===Hv?EA:t||bA}function vpe(e){return{marktype:e.type,name:e.name||void 0,role:e.role||xj(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function xpe(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function OA(e,t){const n=a6(e.type);n||z("Unrecognized transform type: "+V(e.type));const r=Uv(n.type.toLowerCase(),null,bj(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function bj(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const s=e.params[o];r[s.name]=bpe(s,t,n)}return r}function bpe(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return wpe(e,t,n);if(i===void 0){e.required&&z("Missing required "+V(t.type)+" parameter: "+V(e.name));return}else{if(r==="param")return Epe(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!St(i)?i.map(o=>sD(e,o,n)):sD(e,i,n)}function sD(e,t,n){const r=e.type;if(St(t))return uD(r)?z("Expression references can not be signals."):pb(r)?n.fieldRef(t):lD(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||pb(r);return i&&Spe(t)?n.exprRef(t.expr,t.as):i&&_pe(t)?pp(t.field,t.as):uD(r)?go(t,n):kpe(r)?ie(n.getData(t).values):pb(r)?pp(t):lD(r)?n.compareRef(t):t}}function wpe(e,t,n){return Q(t.from)||z('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Epe(e,t,n){const r=t[e.name];return e.array?(I(r)||z("Expected an array of sub-parameters. Instead: "+V(r)),r.map(i=>aD(e,i,n))):aD(e,r,n)}function aD(e,t,n){const r=e.params.length;let i;for(let s=0;s<r;++s){i=e.params[s];for(const a in i.key)if(i.key[a]!==t[a]){i=null;break}if(i)break}i||z("Unsupported parameter: "+V(t));const o=he(bj(i,t,n),i.key);return ie(n.add(xhe(o)))}const Spe=e=>e&&e.expr,_pe=e=>e&&e.field,kpe=e=>e==="data",uD=e=>e==="expr",pb=e=>e==="field",lD=e=>e==="compare";function $pe(e,t,n){let r,i,o,s,a;return e?(r=e.facet)&&(t||z("Only group marks can be faceted."),r.field!=null?s=a=u0(r,n):(e.data?a=ie(n.getData(e.data).aggregate):(o=OA(he({type:"aggregate",groupby:K(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=u0(r,n),s=a=ie(n.add(o))),i=n.keyRef(r.groupby,!0))):s=ie(n.add(Ni(null,[{}]))),s||(s=u0(e,n)),{key:i,pulse:s,parent:a}}function u0(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ie(t.getData(e.data).output)}function tl(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}tl.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],s=null,a=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=ie(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(s=t[a]);return new tl(e,o,i,r,s)};function wj(e){return Q(e)?e:null}function cD(e,t,n){const r=Wv(n.op,n.field);let i;if(t.ops){for(let o=0,s=t.as.length;o<s;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function wd(e,t,n,r,i,o,s){const a=t[n]||(t[n]={}),u=Xde(o);let l=wj(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=a[l]),!c){const d=o?{field:cS,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:ie(t.output)};u&&(d.sort=e.sortRef(o)),f=e.add(Uv(r,void 0,d)),s&&(t.index[i]=f),c=ie(f),l!=null&&(a[l]=c)}return c}tl.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),o=wj(t);let s,a,u;return o!=null&&(e=r.scope,s=i[o]),s?n&&n.field&&cD(e,s.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ie(r.output)},n&&n.field&&cD(e,u,n),a=e.add(oj(u)),s=e.add(Ni({pulse:ie(a)})),s={agg:a,ref:ie(s)},o!=null&&(i[o]=s)),s.ref},tuplesRef(){return ie(this.values)},extentRef(e,t){return wd(e,this,"extent","extent",t,!1)},domainRef(e,t){return wd(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return wd(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return wd(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return wd(e,this,"indata","tupleindex",t,!0,!0)}};function Cpe(e,t,n){const r=e.from.facet,i=r.name,o=u0(r,t);let s;r.name||z("Facet must have a name: "+V(r)),r.data||z("Facet must reference a data set: "+V(r)),r.field?s=t.add(uj({field:t.fieldRef(r.field),pulse:o})):r.groupby?s=t.add(che({key:t.keyRef(r.groupby),group:ie(t.proxy(n.parent)),pulse:o})):z("Facet must specify groupby or field: "+V(r));const a=t.fork(),u=a.add(Ni()),l=a.add(_l({pulse:ie(u)}));a.addData(i,new tl(a,u,u,l)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(e).toRuntime()}}function Ape(e,t,n){const r=t.add(uj({pulse:n.pulse})),i=t.fork();i.add(_l()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function Ej(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,s=e.modify,a=e.values,u=t.add(J1()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,o,s,a].map(f=>f??"null").join(",")+"),0)",c=go(l,t);u.update=c.$expr,u.params=c.$params}function Yv(e,t){const n=xj(e),r=e.type===Hv,i=e.from&&e.from.facet,o=e.overlap;let s=e.layout||n===EA||n===wA,a,u,l,c,f,d,h;const p=n===bA||s||i,g=$pe(e.from,r,t);u=t.add(uhe({key:g.key||(e.key?pp(e.key):void 0),pulse:g.pulse,clean:!r}));const y=ie(u);u=l=t.add(Ni({pulse:y})),u=t.add(ghe({markdef:vpe(e),interactive:xpe(e.interactive,t),clip:ype(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ie(u)}));const m=ie(u);u=c=t.add(aj(rj(e.encode,e.type,n,e.style,t,{mod:!1,pulse:m}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(S=>{const E=OA(S,t),_=E.metadata;(_.generates||_.changes)&&z("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),E.params.pulse=ie(u),t.add(u=E)}),e.sort&&(u=t.add(_he({sort:t.compareRef(e.sort),pulse:ie(u)})));const v=ie(u);(i||s)&&(s=t.add(cj({layout:t.objectProperty(e.layout),legends:t.legends,mark:m,pulse:v})),d=ie(s));const x=t.add(sj({mark:m,pulse:d||v}));h=ie(x),r&&(p&&(a=t.operators,a.pop(),s&&a.pop()),t.pushState(v,d||h,y),i?Cpe(e,t,g):p?Ape(e,t,g):t.parse(e),t.popState(),p&&(s&&a.push(s),a.push(x))),o&&(h=Tpe(o,h,t));const b=t.add(lj({pulse:h})),w=t.add(_l({pulse:ie(b)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new tl(t,l,b,w)),e.on&&e.on.forEach(S=>{(S.insert||S.remove||S.toggle)&&z("Marks only support modify triggers."),Ej(S,t,f)}))}function Tpe(e,t,n){const r=e.method,i=e.bound,o=e.separation,s={separation:St(o)?n.signalRef(o.signal):o,method:St(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(s.sort=n.compareRef({field:e.order})),i){const a=i.tolerance;s.boundTolerance=St(a)?n.signalRef(a.signal):+a,s.boundScale=n.scaleRef(i.scale),s.boundOrient=i.orient}return ie(n.add(vhe(s)))}function Fpe(e,t){const n=t.config.legend,r=e.encode||{},i=cr(e,n),o=r.legend||{},s=o.name||void 0,a=o.interactive,u=o.style,l={};let c=0,f,d,h;CA.forEach(x=>e[x]?(l[x]=e[x],c=c||e[x]):0),c||z("Missing valid scale for legend.");const p=Mpe(e,t.scaleType(c)),g={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&i.isVertical()},y=ie(t.add(Ni(null,[g]))),m={enter:{x:{value:0},y:{value:0}}},v=ie(t.add(hhe(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===a0?(h=[rpe(e,c,n,r.gradient),iD(e,n,r.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${Ru(i.gradientLength())})/100))`)):p===pS?h=[ipe(e,c,n,r.gradient,v),iD(e,n,r.labels,v)]:(f=upe(e,n),h=[ape(e,n,r,v,Ru(f.columns))],d.size=Dpe(e,t,h[0].marks)),h=[mp({role:Tde,from:y,encode:m,marks:h,layout:f,interactive:a})],g.title&&h.push(mpe(e,n,r.title,y)),Yv(mp({role:Cde,from:y,encode:zf(Npe(i,e,n),o,lg),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:a,style:u}),t)}function Mpe(e,t){let n=e.type||rD;return!e.type&&Ope(e)===1&&(e.fill||e.stroke)&&(n=A$(t)?a0:sE(t)?pS:rD),n!==a0?n:sE(t)?pS:a0}function Ope(e){return CA.reduce((t,n)=>t+(e[n]?1:0),0)}function Npe(e,t,n){const r={enter:{},update:{}};return Xt(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function Dpe(e,t,n){const r=Ru(fD("size",e,n)),i=Ru(fD("strokeWidth",e,n)),o=Ru(Rpe(n[1].encode,t,ug));return go(`max(ceil(sqrt(${r})+${i}),${o})`,t)}function fD(e,t,n){return t[e]?`scale("${t[e]}",datum)`:yj(e,n[0].encode)}function Rpe(e,t,n){return yj("fontSize",e)||tpe("fontSize",t,n)}const Ppe=`item.orient==="${If}"?-90:item.orient==="${jf}"?90:0`;function Lpe(e,t){e=Q(e)?{text:e}:e;const n=cr(e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,s=i.interactive,a=i.style,u=[],l={},c=ie(t.add(Ni(null,[l])));return u.push(jpe(e,n,zpe(e),c)),e.subtitle&&u.push(Bpe(e,n,r.subtitle,c)),Yv(mp({role:Nde,from:c,encode:Ipe(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),t)}function zpe(e){const t=e.encode;return t&&t.title||he({name:e.name,interactive:e.interactive,style:e.style},t)}function Ipe(e,t){const n={enter:{},update:{}};return Xt(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:TA},angle:{signal:Ppe},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),zf(n,t,lg)}function jpe(e,t,n,r){const i={value:0},o=e.text,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Xt(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),$r({type:kl,role:Dde,style:Vhe,from:r,encode:s},n)}function Bpe(e,t,n,r){const i={value:0},o=e.subtitle,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Xt(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),$r({type:kl,role:Rde,style:Ghe,from:r,encode:s},n)}function Upe(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(OA(r,t))}),e.on&&e.on.forEach(r=>{Ej(r,t,e.name)}),t.addDataPipeline(e.name,Wpe(e,t,n))}function Wpe(e,t,n){const r=[];let i=null,o=!1,s=!1,a,u,l,c,f;for(e.values?St(e.values)||o0(e.format)?(r.push(dD(t,e)),r.push(i=eu())):r.push(i=eu({$ingest:e.values,$format:e.format})):e.url?o0(e.url)||o0(e.format)?(r.push(dD(t,e)),r.push(i=eu())):r.push(i=eu({$request:e.url,$format:e.format})):e.source&&(i=a=K(e.source).map(d=>ie(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=eu()),r.push(c),f.generates&&(s=!0),f.modifies&&!s&&(o=!0),f.source?i=c:f.changes&&(i=null);return a&&(l=a.length-1,r[0]=Ehe({derive:o,pulse:l?a:a[0]}),(o||l)&&r.splice(1,0,eu())),i||r.push(eu()),r.push(_l({})),r}function eu(e){const t=Ni({},e);return t.metadata={source:!0},t}function dD(e,t){return phe({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const Sj=e=>e===ka||e===Di,Xv=(e,t,n)=>St(e)?Gpe(e.signal,t,n):e===If||e===Di?t:n,Nt=(e,t,n)=>St(e)?Hpe(e.signal,t,n):Sj(e)?t:n,Si=(e,t,n)=>St(e)?Vpe(e.signal,t,n):Sj(e)?n:t,_j=(e,t,n)=>St(e)?Ype(e.signal,t,n):e===Di?{value:t}:{value:n},qpe=(e,t,n)=>St(e)?Xpe(e.signal,t,n):e===jf?{value:t}:{value:n},Hpe=(e,t,n)=>kj(`${e} === '${Di}' || ${e} === '${ka}'`,t,n),Vpe=(e,t,n)=>kj(`${e} !== '${Di}' && ${e} !== '${ka}'`,t,n),Gpe=(e,t,n)=>NA(`${e} === '${If}' || ${e} === '${Di}'`,t,n),Ype=(e,t,n)=>NA(`${e} === '${Di}'`,t,n),Xpe=(e,t,n)=>NA(`${e} === '${jf}'`,t,n),kj=(e,t,n)=>(t=t!=null?Ot(t):t,n=n!=null?Ot(n):n,hD(t)&&hD(n)?(t=t?t.signal||V(t.value):null,n=n?n.signal||V(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[he({test:e},t)].concat(n||[])),hD=e=>e==null||Object.keys(e).length===1,NA=(e,t,n)=>({signal:`${e} ? (${pc(t)}) : (${pc(n)})`}),Qpe=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${If}' ? (${pc(r)}) : `:"")+(n!=null?`${e} === '${ka}' ? (${pc(n)}) : `:"")+(i!=null?`${e} === '${jf}' ? (${pc(i)}) : `:"")+(t!=null?`${e} === '${Di}' ? (${pc(t)}) : `:"")+"(null)"}),pc=e=>St(e)?e.signal:e==null?null:V(e),Kpe=(e,t)=>t===0?0:St(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},kc=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Ul(e,t,n,r){let i;if(t&&ae(t,e))return t[e];if(ae(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[$A][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[ug][i]}return null}function pD(e){const t={};for(const n of e)if(n)for(const r in n)t[r]=1;return Object.keys(t)}function Jpe(e,t){var n=t.config,r=n.style,i=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,s=e.orient,a,u,l;if(St(s)){const f=pD([n.axisX,n.axisY]),d=pD([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(l of f)a[l]=Nt(s,Ul(l,n.axisX,i,r),Ul(l,n.axisY,i,r));u={};for(l of d)u[l]=Qpe(s.signal,Ul(l,n.axisTop,i,r),Ul(l,n.axisBottom,i,r),Ul(l,n.axisLeft,i,r),Ul(l,n.axisRight,i,r))}else a=s===Di||s===ka?n.axisX:n.axisY,u=n["axis"+s[0].toUpperCase()+s.slice(1)];return a||u||o?he({},i,a,u,o):i}function Zpe(e,t,n,r){const i=cr(e,t),o=e.orient;let s,a;const u={enter:s={opacity:$e},update:a={opacity:Br},exit:{opacity:$e}};Xt(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=gD(e,0),c=gD(e,1);return s.x=a.x=Nt(o,l,$e),s.x2=a.x2=Nt(o,c),s.y=a.y=Si(o,l,$e),s.y2=a.y2=Si(o,c),$r({type:AA,role:Ede,from:r,encode:u},n)}function gD(e,t){return{scale:e.scale,range:t}}function ege(e,t,n,r,i){const o=cr(e,t),s=e.orient,a=e.gridScale,u=Xv(s,1,-1),l=tge(e.offset,u);let c,f,d;const h={enter:c={opacity:$e},update:d={opacity:Br},exit:f={opacity:$e}};Xt(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:e.scale,field:jr,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},g=Nt(s,{signal:"height"},{signal:"width"}),y=a?{scale:a,range:0,mult:u,offset:l}:{value:0,offset:l},m=a?{scale:a,range:1,mult:u,offset:l}:he(g,{mult:u,offset:l});return c.x=d.x=Nt(s,p,y),c.y=d.y=Si(s,p,y),c.x2=d.x2=Si(s,m),c.y2=d.y2=Nt(s,m),f.x=Nt(s,p),f.y=Si(s,p),$r({type:AA,role:Sde,key:jr,from:r,encode:h},n)}function tge(e,t){if(t!==1)if(!J(e))e=St(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=he({},e);for(;n.mult!=null;)if(J(n.mult))n=n.mult=he({},n.mult);else return n.mult=St(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function nge(e,t,n,r,i,o){const s=cr(e,t),a=e.orient,u=Xv(a,-1,1);let l,c,f;const d={enter:l={opacity:$e},update:f={opacity:Br},exit:c={opacity:$e}};Xt(d,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const h=Ot(i);h.mult=u;const p={scale:e.scale,field:jr,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return f.y=l.y=Nt(a,$e,p),f.y2=l.y2=Nt(a,h),c.x=Nt(a,p),f.x=l.x=Si(a,$e,p),f.x2=l.x2=Si(a,h),c.y=Si(a,p),$r({type:AA,role:kde,key:jr,from:r,encode:d},n)}function gb(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function rge(e,t,n,r,i,o){const s=cr(e,t),a=e.orient,u=e.scale,l=Xv(a,-1,1),c=Ru(s("labelFlush")),f=Ru(s("labelFlushOffset")),d=s("labelAlign"),h=s("labelBaseline");let p=c===0||!!c,g;const y=Ot(i);y.mult=l,y.offset=Ot(s("labelPadding")||0),y.offset.mult=l;const m={scale:u,field:jr,band:.5,offset:vj(o.offset,s("labelOffset"))},v=Nt(a,p?gb(u,c,'"left"','"right"','"center"'):{value:"center"},qpe(a,"left","right")),x=Nt(a,_j(a,"bottom","top"),p?gb(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),b=gb(u,c,`-(${f})`,f,0);p=p&&f;const w={opacity:$e,x:Nt(a,m,y),y:Si(a,m,y)},S={enter:w,update:g={opacity:Br,text:{field:kA},x:w.x,y:w.y,align:v,baseline:x},exit:{opacity:$e,x:w.x,y:w.y}};Xt(S,{dx:!d&&p?Nt(a,b):null,dy:!h&&p?Si(a,b):null}),Xt(S,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:d,baseline:h});const E=s("labelBound");let _=s("labelOverlap");return _=_||E?{separation:s("labelSeparation"),method:_,order:"datum.index",bound:E?{scale:u,orient:a,tolerance:E}:null}:void 0,g.align!==v&&(g.align=kc(g.align,v)),g.baseline!==x&&(g.baseline=kc(g.baseline,x)),$r({type:kl,role:_de,style:ug,key:jr,from:r,encode:S,overlap:_},n)}function ige(e,t,n,r){const i=cr(e,t),o=e.orient,s=Xv(o,-1,1);let a,u;const l={enter:a={opacity:$e,anchor:Ot(i("titleAnchor",null)),align:{signal:TA}},update:u=he({},a,{opacity:Br,text:Ot(e.title)}),exit:{opacity:$e}},c={signal:`lerp(range("${e.scale}"), ${Vv(0,1,.5)})`};return u.x=Nt(o,c),u.y=Si(o,c),a.angle=Nt(o,$e,Kpe(s,90)),a.baseline=Nt(o,_j(o,ka,Di),{value:ka}),u.angle=a.angle,u.baseline=a.baseline,Xt(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),oge(i,o,l,n),l.update.align=kc(l.update.align,a.align),l.update.angle=kc(l.update.angle,a.angle),l.update.baseline=kc(l.update.baseline,a.baseline),$r({type:kl,role:$de,style:$A,from:r,encode:l},n)}function oge(e,t,n,r){const i=(a,u)=>a!=null?(n.update[u]=kc(Ot(a),n.update[u]),!1):!Xl(u,r),o=i(e("titleX"),"x"),s=i(e("titleY"),"y");n.enter.auto=s===o?Ot(s):Nt(t,Ot(s),Ot(o))}function sge(e,t){const n=Jpe(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,s=i.interactive,a=i.style,u=cr(e,n),l=npe(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ie(t.add(Ni({},[c]))),d=ie(t.add(ahe({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(ege(e,n,r.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(nge(e,n,r.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(rge(e,n,r.labels,d,p,l))),c.domain&&h.push(Zpe(e,n,r.domain,f)),c.title&&h.push(ige(e,n,r.title,f)),Yv(mp({role:wde,from:f,encode:zf(age(u,e),i,lg),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:s,style:a}),t)}function age(e,t){const n={enter:{},update:{}};return Xt(n,{orient:e("orient"),offset:e("offset")||0,position:ui(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function $j(e,t,n){const r=K(e.signals),i=K(e.scales);return n||r.forEach(o=>ij(o,t)),K(e.projections).forEach(o=>Ihe(o,t)),i.forEach(o=>Che(o,t)),K(e.data).forEach(o=>Upe(o,t)),i.forEach(o=>Ahe(o,t)),(n||r).forEach(o=>she(o,t)),K(e.axes).forEach(o=>sge(o,t)),K(e.marks).forEach(o=>Yv(o,t)),K(e.legends).forEach(o=>Fpe(o,t)),e.title&&Lpe(e.title,t),t.parseLambdas(),t}const uge=e=>zf({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function lge(e,t){const n=t.config,r=ie(t.root=t.add(J1())),i=cge(e,n);i.forEach(l=>ij(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(Ni()),s=t.add(aj(rj(uge(e.encode),Hv,wA,e.style,t,{pulse:ie(o)}))),a=t.add(cj({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:ie(s)}));t.operators.pop(),t.pushState(ie(s),ie(a),null),$j(e,t,i),t.operators.push(a);let u=t.add(sj({mark:r,pulse:ie(a)}));return u=t.add(lj({pulse:ie(u)})),u=t.add(_l({pulse:ie(u)})),t.addData("root",new tl(t,o,o,u)),t}function Ed(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function cge(e,t){const n=s=>ui(e[s],t[s]),r=[Ed("background",n("background")),Ed("autosize",vde(n("autosize"))),Ed("padding",bde(n("padding"))),Ed("width",n("width")||0),Ed("height",n("height")||0)],i=r.reduce((s,a)=>(s[a.name]=a,s),{}),o={};return K(e.signals).forEach(s=>{ae(i,s.name)?s=he(i[s.name],s):r.push(s),o[s.name]=s}),K(t.signals).forEach(s=>{!ae(o,s.name)&&!ae(i,s.name)&&r.push(s)}),r}function Cj(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function mD(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}Cj.prototype=mD.prototype={parse(e){return $j(e,this)},fork(){return new mD(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof lS?ie(e):e;return this.add(whe({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,o){let s,a;r&&(s=r.data||(r.data={}),a=s[i]||(s[i]=[]),a.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(ie(this.add(_l({pulse:e})))),this._parent.push(t),this._lookup.push(n?ie(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return _e(this._parent)},encode(){return _e(this._encode)},lookup(){return _e(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Q(e))return pp(e,t);e.signal||z("Unsupported field reference: "+V(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=ie(this.add(fhe(i)))}return r},compareRef(e){let t=!1;const n=o=>St(o)?(t=!0,this.signalRef(o.signal)):Qde(o)?(t=!0,this.exprRef(o.expr)):o,r=K(e.field).map(n),i=K(e.order).map(n);return t?ie(this.add(nD({fields:r,orders:i}))):eD(r,i)},keyRef(e,t){let n=!1;const r=o=>St(o)?(n=!0,ie(i[o.signal])):o,i=this.signals;return e=K(e).map(r),n?ie(this.add(dhe({fields:e,flat:t}))):Vde(e,t)},sortRef(e){if(!e)return e;const t=Wv(e.op,e.field),n=e.order||Gde;return n.signal?ie(this.add(nD({fields:t,orders:this.signalRef(n.signal)}))):eD(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return ae(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&z("Duplicate signal name: "+V(e));const n=t instanceof lS?t:this.add(J1(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||z("Unrecognized signal name: "+V(e)),this.signals[e]},signalRef(e){return this.signals[e]?ie(this.signals[e]):(ae(this.lambdas,e)||(this.lambdas[e]=this.add(J1(null))),ie(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=go(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!J(e)?e:this.signalRef(e.signal||DA(e))},exprRef(e,t){const n={expr:go(e,this)};return t&&(n.expr.$name=t),ie(this.add(lhe(n)))},addBinding(e,t){this.bindings||z("Nested signals do not support binding: "+V(e)),this.bindings.push(he({signal:e},t))},addScaleProj(e,t){ae(this.scales,e)&&z("Duplicate scale or projection name: "+V(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,She(t))},addProjection(e,t){this.addScaleProj(e,bhe(t))},getScale(e){return this.scales[e]||z("Unrecognized scale name: "+V(e)),this.scales[e]},scaleRef(e){return ie(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ae(this.data,e)&&z("Duplicate data set name: "+V(e)),this.data[e]=t},getData(e){return this.data[e]||z("Undefined data set name: "+V(e)),this.data[e]},addDataPipeline(e,t){return ae(this.data,e)&&z("Duplicate data set name: "+V(e)),this.addData(e,tl.fromEntries(this,t))}};function DA(e){return(I(e)?fge:dge)(e)}function fge(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(J(i)?i.signal||DA(i):V(i))}return n+"]"}function dge(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+V(r)+":"+(J(i)?i.signal||DA(i):V(i));return t+"}"}function hge(){const e="sans-serif",r="#4c78a8",i="#000",o="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:s},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function pge(e,t,n){return J(e)||z("Input Vega specification must be an object."),t=$f(hge(),t,e.config),lge(e,new Cj(t,n)).toRuntime()}var gge="5.25.0";he(Hc,yK,Lne,gre,toe,Xoe,Eae,tae,_ae,Gae,rue,cue);const mge=Object.freeze(Object.defineProperty({__proto__:null,Bounds:gt,CanvasHandler:Zp,CanvasRenderer:f1,DATE:ir,DAY:un,DAYOFYEAR:ho,Dataflow:wc,Debug:T4,Error:U_,EventStream:Qy,Gradient:SI,GroupItem:xv,HOURS:Sr,Handler:Sa,Info:A4,Item:vv,MILLISECONDS:Ai,MINUTES:_r,MONTH:hn,Marks:kr,MultiPulse:hk,None:C4,Operator:We,Parameters:Xy,Pulse:la,QUARTER:rr,RenderType:Vs,Renderer:Eo,ResourceLoader:L$,SECONDS:Hr,SVGHandler:tC,SVGRenderer:aC,SVGStringRenderer:uC,Scenegraph:Z$,TIME_UNITS:rk,Transform:P,View:H7,WEEK:wt,Warn:W_,YEAR:Vt,accessor:lr,accessorFields:dn,accessorName:ct,array:K,ascending:zy,bandwidthNRD:yk,bin:c6,bootstrapCI:f6,boundClip:y8,boundContext:Xp,boundItem:hE,boundMark:UI,boundStroke:gs,changeset:bl,clampRange:j4,codegenExpression:x7,compare:Y_,constant:vn,cumulativeLogNormal:Sk,cumulativeNormal:Jy,cumulativeUniform:Ck,dayofyear:yL,debounce:X_,defaultLocale:uk,definition:a6,densityLogNormal:Ek,densityNormal:vk,densityUniform:$k,domChild:Hn,domClear:hi,domCreate:qs,domFind:eC,dotbin:d6,error:z,expressionFunction:yt,extend:he,extent:lo,extentIndex:B4,falsy:Cs,fastmap:Af,field:nr,flush:U4,font:_v,fontFamily:Jp,fontSize:wo,format:jm,formatLocale:H0,formats:fk,hasOwnProperty:ae,id:Op,identity:yn,inferType:QL,inferTypes:KL,ingest:Ne,inherits:G,inrange:lc,interpolate:T$,interpolateColors:mv,interpolateRange:lI,intersect:h8,intersectBoxLine:cc,intersectPath:z$,intersectPoint:I$,intersectRule:MI,isArray:I,isBoolean:Ra,isDate:aa,isFunction:pe,isIterable:W4,isNumber:je,isObject:J,isRegExp:q4,isString:Q,isTuple:Gy,key:Q_,lerp:H4,lineHeight:wa,loader:Hy,locale:YL,logger:q_,lruCache:V4,markup:sC,merge:G4,mergeConfig:$f,multiLineOffset:Q$,one:kf,pad:Y4,panLinear:D4,panLog:R4,panPow:P4,panSymlog:L4,parse:pge,parseExpression:aA,parseSelector:Ba,path:rv,pathCurves:D$,pathEqual:v8,pathParse:Kc,pathRectangle:$I,pathRender:np,pathSymbols:kI,pathTrail:CI,peek:_e,point:$v,projection:CC,quantileLogNormal:_k,quantileNormal:Zy,quantileUniform:Ak,quantiles:gk,quantizeInterpolator:cI,quarter:z4,quartiles:mk,get random(){return Vr},randomInteger:wQ,randomKDE:bk,randomLCG:bQ,randomLogNormal:p6,randomMixture:g6,randomNormal:xk,randomUniform:m6,read:e6,regressionConstant:Tk,regressionExp:v6,regressionLinear:Fk,regressionLoess:w6,regressionLog:y6,regressionPoly:b6,regressionPow:x6,regressionQuad:Mk,renderModule:Cv,repeat:Rd,resetDefaultLocale:yX,resetSVGClipId:TI,resetSVGDefIds:tne,responseType:ZL,runtimeContext:O7,sampleCurve:tv,sampleLogNormal:wk,sampleNormal:Ky,sampleUniform:kk,scale:Fe,sceneEqual:lC,sceneFromJSON:qI,scenePickVisit:o1,sceneToJSON:WI,sceneVisit:Ti,sceneZOrder:j$,scheme:F$,serializeXML:o8,setRandom:vQ,span:Np,splitAccessPath:xo,stringValue:V,textMetrics:Ei,timeBin:DL,timeFloor:_L,timeFormatLocale:Qh,timeInterval:Mf,timeOffset:CL,timeSequence:FL,timeUnitSpecifier:mL,timeUnits:ik,toBoolean:K_,toDate:J_,toNumber:ln,toSet:Ci,toString:Z_,transform:u6,transforms:Hc,truncate:X4,truthy:qr,tupleid:oe,typeParsers:Yw,utcFloor:kL,utcInterval:Of,utcOffset:AL,utcSequence:ML,utcdayofyear:bL,utcquarter:I4,utcweek:wL,version:gge,visitArray:Os,week:vL,writeConfig:Cf,zero:Is,zoomLinear:H_,zoomLog:V_,zoomPow:z0,zoomSymlog:G_},Symbol.toStringTag,{value:"Module"}));function yge(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var vge={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},xge={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},bge={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const wge=Array.prototype.slice,tu=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,wge.call(t,1))},Ege=(e,t,n,r,i,o,s)=>new Date(e,t||0,n??1,r||0,i||0,o||0,s||0);var Sge={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:Ege,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return tu("join",arguments)},indexof:function(){return tu("indexOf",arguments)},lastindexof:function(){return tu("lastIndexOf",arguments)},slice:function(){return tu("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return tu("substring",arguments,String)},split:function(){return tu("split",arguments,String)},replace:function(){return tu("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const _ge=["view","item","group","xy","x","y"],mS=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&mS.add(setImmediate);const kge={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:vge[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const i=e(t.property);if(n&&(e.memberDepth-=1),mS.has(r[i])){console.error(`Prevented interpretation of member "${i}" which could lead to insecure code execution`);return}return r[i]},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),r==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||Sge[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>xge[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>bge[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,r)=>{e.memberDepth+=1;const i=e(r.key);return e.memberDepth-=1,mS.has(e(r.value))?console.error(`Prevented interpretation of property "${i}" which could lead to insecure code execution`):n[i]=e(r.value),n},{})};function Sd(e,t,n,r,i,o){const s=a=>kge[a.type](s,a);return s.memberDepth=0,s.fn=Object.create(t),s.params=n,s.datum=r,s.event=i,s.item=o,_ge.forEach(a=>s.fn[a]=function(){return i.vega[a](...arguments)}),s(e)}var $ge={operator(e,t){const n=t.ast,r=e.functions;return i=>Sd(n,r,i)},parameter(e,t){const n=t.ast,r=e.functions;return(i,o)=>Sd(n,r,o,i)},event(e,t){const n=t.ast,r=e.functions;return i=>Sd(n,r,void 0,void 0,i)},handler(e,t){const n=t.ast,r=e.functions;return(i,o)=>{const s=o.item&&o.item.datum;return Sd(n,r,i,s,o)}},encode(e,t){const{marktype:n,channels:r}=t,i=e.functions,o=n==="group"||n==="image"||n==="rect";return(s,a)=>{const u=s.datum;let l=0,c;for(const f in r)c=Sd(r[f].ast,i,a,u,void 0,s),s[f]!==c&&(s[f]=c,l=1);return n!=="rule"&&yge(s,r,o),l}}};const Cge="vega-lite",Age='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',Tge="5.8.0",Fge=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],Mge="https://vega.github.io/vega-lite/",Oge="Vega-Lite is a concise high-level language for interactive visualization.",Nge=["vega","chart","visualization"],Dge="build/vega-lite.js",Rge="build/vega-lite.min.js",Pge="build/vega-lite.min.js",Lge="build/src/index",zge="build/src/index.d.ts",Ige={vl2pdf:"./bin/vl2pdf",vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},jge=["bin","build","src","vega-lite*","tsconfig.json"],Bge={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.mjs","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",format:"eslint . --fix && yarn prettierbase --write",lint:"eslint . && yarn prettierbase --check",jest:"NODE_OPTIONS=--experimental-vm-modules npx jest",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test","test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/","watch:test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest --watch test-runtime/ --config test-runtime/jest-config.json",release:"release-it"},Uge={type:"git",url:"https://github.com/vega/vega-lite.git"},Wge="BSD-3-Clause",qge={url:"https://github.com/vega/vega-lite/issues"},Hge={"@babel/core":"^7.21.4","@babel/preset-env":"^7.21.4","@babel/preset-typescript":"^7.21.4","@release-it/conventional-changelog":"^5.1.1","@rollup/plugin-alias":"^5.0.0","@rollup/plugin-babel":"^6.0.3","@rollup/plugin-commonjs":"^24.1.0","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.2","@rollup/plugin-terser":"^0.4.1","@types/chai":"^4.3.4","@types/d3":"^7.4.0","@types/jest":"^27.4.1","@types/pako":"^2.0.0","@typescript-eslint/eslint-plugin":"^5.59.1","@typescript-eslint/parser":"^5.59.1","ajv-formats":"^2.1.1",ajv:"^8.12.0",chai:"^4.3.7",cheerio:"^1.0.0-rc.12","conventional-changelog-cli":"^2.2.2",d3:"^7.8.4","del-cli":"^5.0.0","eslint-config-prettier":"^8.8.0","eslint-plugin-jest":"^27.2.1","eslint-plugin-prettier":"^4.2.1",eslint:"^8.39.0","highlight.js":"^11.7.0","jest-dev-server":"^6.1.1",jest:"^27.5.1",mkdirp:"^3.0.1",pako:"^2.1.0",prettier:"^2.8.8",puppeteer:"^15.0.0","release-it":"^15.10.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3",rollup:"^3.21.0",serve:"^14.2.0",terser:"^5.17.1","ts-jest":"^29.1.0","ts-json-schema-generator":"^1.2.0",typescript:"~4.9.5","vega-cli":"^5.25.0","vega-datasets":"^2.7.0","vega-embed":"^6.22.1","vega-tooltip":"^0.32.0","yaml-front-matter":"^4.1.1"},Vge={"@types/clone":"~2.1.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.5.0","vega-event-selector":"~3.0.1","vega-expression":"~5.1.0","vega-util":"~1.17.2",yargs:"~17.7.1"},Gge={vega:"^5.24.0"},Yge={node:">=16"},Xge={name:Cge,author:Age,version:Tge,collaborators:Fge,homepage:Mge,description:Oge,keywords:Nge,main:Dge,unpkg:Rge,jsdelivr:Pge,module:Lge,types:zge,bin:Ige,files:jge,scripts:Bge,repository:Uge,license:Wge,bugs:qge,devDependencies:Hge,dependencies:Vge,peerDependencies:Gge,engines:Yge};var Aj={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var r;try{r=Map}catch{r=function(){}}var i;try{i=Set}catch{i=function(){}}var o;try{o=Promise}catch{o=function(){}}function s(d,h,p,g,y){typeof h=="object"&&(p=h.depth,g=h.prototype,y=h.includeNonEnumerable,h=h.circular);var m=[],v=[],x=typeof Buffer<"u";typeof h>"u"&&(h=!0),typeof p>"u"&&(p=1/0);function b(w,S){if(w===null)return null;if(S===0)return w;var E,_;if(typeof w!="object")return w;if(n(w,r))E=new r;else if(n(w,i))E=new i;else if(n(w,o))E=new o(function(D,M){w.then(function(N){D(b(N,S-1))},function(N){M(b(N,S-1))})});else if(s.__isArray(w))E=[];else if(s.__isRegExp(w))E=new RegExp(w.source,f(w)),w.lastIndex&&(E.lastIndex=w.lastIndex);else if(s.__isDate(w))E=new Date(w.getTime());else{if(x&&Buffer.isBuffer(w))return Buffer.allocUnsafe?E=Buffer.allocUnsafe(w.length):E=new Buffer(w.length),w.copy(E),E;n(w,Error)?E=Object.create(w):typeof g>"u"?(_=Object.getPrototypeOf(w),E=Object.create(_)):(E=Object.create(g),_=g)}if(h){var $=m.indexOf(w);if($!=-1)return v[$];m.push(w),v.push(E)}n(w,r)&&w.forEach(function(D,M){var N=b(M,S-1),j=b(D,S-1);E.set(N,j)}),n(w,i)&&w.forEach(function(D){var M=b(D,S-1);E.add(M)});for(var k in w){var A;_&&(A=Object.getOwnPropertyDescriptor(_,k)),!(A&&A.set==null)&&(E[k]=b(w[k],S-1))}if(Object.getOwnPropertySymbols)for(var R=Object.getOwnPropertySymbols(w),k=0;k<R.length;k++){var C=R[k],F=Object.getOwnPropertyDescriptor(w,C);F&&!F.enumerable&&!y||(E[C]=b(w[C],S-1),F.enumerable||Object.defineProperty(E,C,{enumerable:!1}))}if(y)for(var T=Object.getOwnPropertyNames(w),k=0;k<T.length;k++){var O=T[k],F=Object.getOwnPropertyDescriptor(w,O);F&&F.enumerable||(E[O]=b(w[O],S-1),Object.defineProperty(E,O,{enumerable:!1}))}return E}return b(d,p)}s.clonePrototype=function(h){if(h===null)return null;var p=function(){};return p.prototype=h,new p};function a(d){return Object.prototype.toString.call(d)}s.__objToStr=a;function u(d){return typeof d=="object"&&a(d)==="[object Date]"}s.__isDate=u;function l(d){return typeof d=="object"&&a(d)==="[object Array]"}s.__isArray=l;function c(d){return typeof d=="object"&&a(d)==="[object RegExp]"}s.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return s.__getRegExpFlags=f,s}();e.exports&&(e.exports=t)})(Aj);var Qge=Aj.exports;const Kge=wf(Qge);var Jge=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!e(t[s],n[s]))return!1}return!0}return t!==t&&n!==n};const Tj=wf(Jge);var Zge=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(o){return function(s){return function(a,u){var l={key:a,value:s[a]},c={key:u,value:s[u]};return o(l,c)}}}(t.cmp),i=[];return function o(s){if(s&&s.toJSON&&typeof s.toJSON=="function"&&(s=s.toJSON()),s!==void 0){if(typeof s=="number")return isFinite(s)?""+s:"null";if(typeof s!="object")return JSON.stringify(s);var a,u;if(Array.isArray(s)){for(u="[",a=0;a<s.length;a++)a&&(u+=","),u+=o(s[a])||"null";return u+"]"}if(s===null)return"null";if(i.indexOf(s)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=i.push(s)-1,c=Object.keys(s).sort(r&&r(s));for(u="",a=0;a<c.length;a++){var f=c[a],d=o(s[f]);d&&(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return i.splice(l,1),"{"+u+"}"}}(e)};const RA=wf(Zge);function PA(e){return!!e.or}function LA(e){return!!e.and}function zA(e){return!!e.not}function l0(e,t){if(zA(e))l0(e.not,t);else if(LA(e))for(const n of e.and)l0(n,t);else if(PA(e))for(const n of e.or)l0(n,t);else t(e)}function $c(e,t){return zA(e)?{not:$c(e.not,t)}:LA(e)?{and:e.and.map(n=>$c(n,t))}:PA(e)?{or:e.or.map(n=>$c(n,t))}:t(e)}const Zi=Tj,fe=Kge;function Fj(e){throw new Error(e)}function uf(e,t){const n={};for(const r of t)ae(e,r)&&(n[r]=e[r]);return n}function Zn(e,t){const n={...e};for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>RA(e)).join(",")})`};const Ve=RA;function ke(e){if(je(e))return e;const t=Q(e)?e:RA(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function yS(e){return e===!1||e===null}function we(e,t){return e.includes(t)}function nl(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function IA(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function Mj(e,...t){for(const n of t)eme(e,n??{});return e}function eme(e,t){for(const n of B(t))Cf(e,n,t[n],!0)}function eo(e,t){const n=[],r={};let i;for(const o of e)i=t(o),!(i in r)&&(r[i]=1,n.push(o));return n}function tme(e,t){const n=B(e),r=B(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}function Oj(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function jA(e,t){for(const n of e)if(t.has(n))return!0;return!1}function vS(e){const t=new Set;for(const n of e){const i=xo(n).map((s,a)=>a===0?s:`[${s}]`),o=i.map((s,a)=>i.slice(0,a+1).join(""));for(const s of o)t.add(s)}return t}function BA(e,t){return e===void 0||t===void 0?!0:jA(vS(e),vS(t))}function Ie(e){return B(e).length===0}const B=Object.keys,Gt=Object.values,$a=Object.entries;function yp(e){return e===!0||e===!1}function et(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function $h(e,t){return zA(e)?`!(${$h(e.not,t)})`:LA(e)?`(${e.and.map(n=>$h(n,t)).join(") && (")})`:PA(e)?`(${e.or.map(n=>$h(n,t)).join(") || (")})`:t(e)}function Z1(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&Z1(e[n],t)&&delete e[n],Ie(e)}function cg(e){return e.charAt(0).toUpperCase()+e.substr(1)}function UA(e,t="datum"){const n=xo(e),r=[];for(let i=1;i<=n.length;i++){const o=`[${n.slice(0,i).map(V).join("][")}]`;r.push(`${t}${o}`)}return r.join(" && ")}function Nj(e,t="datum"){return`${t}[${V(xo(e).join("."))}]`}function nme(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Yr(e){return`${xo(e).map(nme).join("\\.")}`}function rl(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function WA(e){return`${xo(e).join(".")}`}function lf(e){return e?xo(e).length:0}function mt(...e){for(const t of e)if(t!==void 0)return t}let Dj=42;function Rj(e){const t=++Dj;return e?String(e)+t:t}function rme(){Dj=42}function Pj(e){return Lj(e)?e:`__${e}`}function Lj(e){return e.startsWith("__")}function vp(e){if(e!==void 0)return(e%360+360)%360}function Qv(e){return je(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const ts="row",ns="column",Kv="facet",tt="x",Rt="y",Ri="x2",ko="y2",Ua="xOffset",Bf="yOffset",Pi="radius",vs="radius2",Kr="theta",xs="theta2",Li="latitude",zi="longitude",Ii="latitude2",Xr="longitude2",sr="color",$o="fill",Co="stroke",ar="shape",bs="size",$l="angle",ws="opacity",Wa="fillOpacity",qa="strokeOpacity",Ha="strokeWidth",Va="strokeDash",fg="text",dg="order",hg="detail",Jv="key",il="tooltip",Zv="href",ex="url",tx="description",ime={x:1,y:1,x2:1,y2:1},zj={theta:1,theta2:1,radius:1,radius2:1};function Ij(e){return e in zj}const qA={longitude:1,longitude2:1,latitude:1,latitude2:1};function jj(e){switch(e){case Li:return"y";case Ii:return"y2";case zi:return"x";case Xr:return"x2"}}function Bj(e){return e in qA}const ome=B(qA),HA={...ime,...zj,...qA,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function Cc(e){return e===sr||e===$o||e===Co}const Uj={row:1,column:1,facet:1},zr=B(Uj),VA={...HA,...Uj},sme=B(VA),{order:D_e,detail:R_e,tooltip:P_e,...ame}=VA,{row:L_e,column:z_e,facet:I_e,...ume}=ame;function lme(e){return!!ume[e]}function Wj(e){return!!VA[e]}const cme=[Ri,ko,Ii,Xr,xs,vs];function qj(e){return Cl(e)!==e}function Cl(e){switch(e){case Ri:return tt;case ko:return Rt;case Ii:return Li;case Xr:return zi;case xs:return Kr;case vs:return Pi}return e}function Ca(e){if(Ij(e))switch(e){case Kr:return"startAngle";case xs:return"endAngle";case Pi:return"outerRadius";case vs:return"innerRadius"}return e}function Ao(e){switch(e){case tt:return Ri;case Rt:return ko;case Li:return Ii;case zi:return Xr;case Kr:return xs;case Pi:return vs}}function ur(e){switch(e){case tt:case Ri:return"width";case Rt:case ko:return"height"}}function fme(e){switch(e){case tt:return"xOffset";case Rt:return"yOffset";case Ri:return"x2Offset";case ko:return"y2Offset";case Kr:return"thetaOffset";case Pi:return"radiusOffset";case xs:return"theta2Offset";case vs:return"radius2Offset"}}function Hj(e){switch(e){case tt:return"xOffset";case Rt:return"yOffset"}}function Vj(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const dme=B(HA),{x:j_e,y:B_e,x2:U_e,y2:W_e,xOffset:q_e,yOffset:H_e,latitude:V_e,longitude:G_e,latitude2:Y_e,longitude2:X_e,theta:Q_e,theta2:K_e,radius:J_e,radius2:Z_e,...GA}=HA,hme=B(GA),YA={x:1,y:1},To=B(YA);function Pt(e){return e in YA}const XA={theta:1,radius:1},pme=B(XA);function nx(e){return e==="width"?tt:Rt}const Gj={xOffset:1,yOffset:1};function Uf(e){return e in Gj}const{text:eke,tooltip:tke,href:nke,url:rke,description:ike,detail:oke,key:ske,order:ake,...Yj}=GA,gme=B(Yj);function mme(e){return!!GA[e]}function yme(e){switch(e){case sr:case $o:case Co:case bs:case ar:case ws:case Ha:case Va:return!0;case Wa:case qa:case $l:return!1}}const Xj={...YA,...XA,...Gj,...Yj},rx=B(Xj);function Es(e){return!!Xj[e]}function vme(e,t){return bme(e)[t]}const Qj={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:uke,...xme}=Qj;function bme(e){switch(e){case sr:case $o:case Co:case tx:case hg:case Jv:case il:case Zv:case dg:case ws:case Wa:case qa:case Ha:case Kv:case ts:case ns:return Qj;case tt:case Rt:case Ua:case Bf:case Li:case zi:return xme;case Ri:case ko:case Ii:case Xr:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case bs:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Va:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case ar:return{point:"always",geoshape:"always"};case fg:return{text:"always"};case $l:return{point:"always",square:"always",text:"always"};case ex:return{image:"always"};case Kr:return{text:"always",arc:"always"};case Pi:return{text:"always",arc:"always"};case xs:case vs:return{arc:"always"}}}function mb(e){switch(e){case tt:case Rt:case Kr:case Pi:case Ua:case Bf:case bs:case $l:case Ha:case ws:case Wa:case qa:case Ri:case ko:case xs:case vs:return;case Kv:case ts:case ns:case ar:case Va:case fg:case il:case Zv:case ex:case tx:return"discrete";case sr:case $o:case Co:return"flexible";case Li:case zi:case Ii:case Xr:case hg:case Jv:case dg:return}}const wme={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Eme={count:1,min:1,max:1};function hs(e){return!!e&&!!e.argmin}function Ga(e){return!!e&&!!e.argmax}function QA(e){return Q(e)&&!!wme[e]}const Sme=new Set(["count","valid","missing","distinct"]);function Kj(e){return Q(e)&&Sme.has(e)}function _me(e){return Q(e)&&we(["min","max"],e)}const kme=new Set(["count","sum","distinct","valid","missing"]),$me=new Set(["mean","average","median","q1","q3","min","max"]);function Jj(e){return Ra(e)&&(e=gx(e,void 0)),"bin"+B(e).map(t=>ix(e[t])?et(`_${t}_${$a(e[t])}`):et(`_${t}_${e[t]}`)).join("")}function Ge(e){return e===!0||Al(e)&&!e.binned}function Ut(e){return e==="binned"||Al(e)&&e.binned===!0}function Al(e){return J(e)}function ix(e){return e==null?void 0:e.param}function yD(e){switch(e){case ts:case ns:case bs:case sr:case $o:case Co:case Ha:case ws:case Wa:case qa:case ar:return 6;case Va:return 4;default:return 10}}function pg(e){return!!(e!=null&&e.expr)}function qn(e){const t=B(e||{}),n={};for(const r of t)n[r]=mr(e[r]);return n}function Zj(e){const{anchor:t,frame:n,offset:r,orient:i,angle:o,limit:s,color:a,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p,...g}=e,y={...g,...a?{fill:a}:{}},m={...t?{anchor:t}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...o!==void 0?{angle:o}:{},...s!==void 0?{limit:s}:{}},v={...u?{subtitleColor:u}:{},...l?{subtitleFont:l}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...h?{subtitleLineHeight:h}:{},...p?{subtitlePadding:p}:{}},x=uf(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:y,subtitleMarkConfig:x,nonMarkTitleProperties:m,subtitle:v}}function Ps(e){return Q(e)||I(e)&&Q(e[0])}function re(e){return!!(e!=null&&e.signal)}function Ya(e){return!!e.step}function Cme(e){return I(e)?!1:"fields"in e&&!("data"in e)}function Ame(e){return I(e)?!1:"fields"in e&&"data"in e}function Qo(e){return I(e)?!1:"field"in e&&"data"in e}const Tme={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},Fme=B(Tme),Mme={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},xS=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function eB(e){const t=I(e.condition)?e.condition.map(vD):vD(e.condition);return{...mr(e),condition:t}}function mr(e){if(pg(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function vD(e){if(pg(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function Qe(e){if(pg(e)){const{expr:t,...n}=e;return{signal:t,...n}}return re(e)?e:e!==void 0?{value:e}:void 0}function Ome(e){return re(e)?e.signal:V(e)}function xD(e){return re(e)?e.signal:V(e.value)}function rs(e){return re(e)?e.signal:e==null?null:V(e)}function Nme(e,t,n){for(const r of n){const i=ol(r,t.markDef,t.config);i!==void 0&&(e[r]=Qe(i))}return e}function tB(e){return[].concat(e.type,e.style??[])}function Pe(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:o&&(!i||i===e)?void 0:ol(e,t,n,r)}function ol(e,t,n,{vgChannel:r}={}){return mt(r?ey(e,t,n.style):void 0,ey(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function ey(e,t,n){return nB(e,tB(t),n)}function nB(e,t,n){t=K(t);let r;for(const i of t){const o=n[i];o&&o[e]!==void 0&&(r=o[e])}return r}function rB(e,t){return K(e).reduce((n,r)=>(n.field.push(Y(r,t)),n.order.push(r.sort??"ascending"),n),{field:[],order:[]})}function iB(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(Zi(i,r))return;n.push(r)}),n}function oB(e,t){return Zi(e,t)||!t?e:e?[...K(e),...K(t)].join(", "):t}function sB(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((Ps(n)||re(n))&&(Ps(r)||re(r)))return{explicit:e.explicit,value:oB(n,r)};if(Ps(n)||re(n))return{explicit:e.explicit,value:n};if(Ps(r)||re(r))return{explicit:e.explicit,value:r};if(!Ps(n)&&!re(n)&&!Ps(r)&&!re(r))return{explicit:e.explicit,value:iB(n,r)};throw new Error("It should never reach here")}function KA(e){return`Invalid specification ${Ve(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const Dme='Autosize "fit" only works for single views and layered views.';function bD(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function wD(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function ED(e){return e?`Dropping "fit-${e}" because spec has discrete ${ur(e)}.`:'Dropping "fit" because spec has discrete size.'}function JA(e){return`Unknown field for ${e}. Cannot calculate view size.`}function SD(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Rme(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Pme(e){return`The "nearest" transform is not supported for ${e} marks.`}function aB(e){return`Selection not supported for ${e} yet.`}function Lme(e){return`Cannot find a selection named "${e}".`}const zme="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Ime="Legend bindings are only supported for selections over an individual field or encoding channel.";function jme(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function Bme(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const Ume="The same selection must be used to override scale domains in a layered view.",Wme='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function qme(e){return`Unknown repeated value "${e}".`}function _D(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const Hme="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Vme(e){return`Unrecognized parse "${e}".`}function kD(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const Gme="Attempt to add the same child twice.";function Yme(e){return`Ignoring an invalid transform: ${Ve(e)}.`}const Xme='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function $D(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Qme(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Ve(t)} is overridden by a child projection ${Ve(n)}.`}const Kme="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Jme(e){return`${e}Offset dropped because ${e} is continuous`}function Zme(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function e0e(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Ve(n)}}.`}function uB(e){return`Invalid field type "${e}".`}function t0e(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function n0e(e){return`Invalid aggregation operator "${e}".`}function lB(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function r0e(e){return`Position range does not support relative band size for ${e}.`}function bS(e,t){return`Dropping ${Ve(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const i0e="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function ox(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function o0e(e){return`${e} encoding has no scale, so specified scale is ignored.`}function s0e(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function a0e(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function u0e(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function l0e(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function yb(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function c0e(e){return`The ${e} for range marks cannot be an expression`}function f0e(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function d0e(e,t){return`Specified orient "${e}" overridden with "${t}".`}function h0e(e){return`Cannot use the scale property "${e}" with non-color channel.`}function p0e(e){return`Cannot use the relative band size with ${e} scale.`}function g0e(e){return`Using unaggregated domain with raw field has no effect (${Ve(e)}).`}function m0e(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function y0e(e){return`Unaggregated domain is currently unsupported for log scale (${Ve(e)}).`}function v0e(e){return`Cannot apply size to non-oriented mark "${e}".`}function x0e(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function b0e(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function cB(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function fB(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function w0e(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ve(n)} and ${Ve(r)}). Using ${Ve(n)}.`}function E0e(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ve(n)} and ${Ve(r)}). Using the union of the two domains.`}function S0e(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function _0e(e){return`Dropping sort property ${Ve(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const CD="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",k0e="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",$0e="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",C0e="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function A0e(e){return`Cannot stack "${e}" if there is already "${e}2".`}function T0e(e){return`Cannot stack non-linear scale (${e}).`}function F0e(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function ty(e,t){return`Invalid ${e}: ${Ve(t)}.`}function M0e(e){return`Dropping day from datetime ${Ve(e)} as day cannot be combined with other units.`}function O0e(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function N0e(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function D0e(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function AD(e){return`1D error band does not support ${e}.`}function dB(e){return`Channel ${e} is required for "binned" bin.`}function R0e(e){return`Channel ${e} should not be used with "binned" bin.`}function P0e(e){return`Domain for ${e} is required for threshold scale.`}globalThis&&globalThis.__classPrivateFieldSet;globalThis&&globalThis.__classPrivateFieldGet;const hB=q_(W_);let cf=hB;function L0e(e){return cf=e,cf}function z0e(){return cf=hB,cf}function U(...e){cf.warn(...e)}function I0e(...e){cf.debug(...e)}function Tl(e){if(e&&J(e)){for(const t of e3)if(t in e)return!0}return!1}const pB=["january","february","march","april","may","june","july","august","september","october","november","december"],j0e=pB.map(e=>e.substr(0,3)),gB=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],B0e=gB.map(e=>e.substr(0,3));function U0e(e){if(Qv(e)&&(e=+e),je(e))return e>4&&U(ty("quarter",e)),e-1;throw new Error(ty("quarter",e))}function W0e(e){if(Qv(e)&&(e=+e),je(e))return e-1;{const t=e.toLowerCase(),n=pB.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=j0e.indexOf(r);if(i!==-1)return i;throw new Error(ty("month",e))}}function q0e(e){if(Qv(e)&&(e=+e),je(e))return e%7;{const t=e.toLowerCase(),n=gB.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=B0e.indexOf(r);if(i!==-1)return i;throw new Error(ty("day",e))}}function ZA(e,t){const n=[];if(t&&e.day!==void 0&&B(e).length>1&&(U(M0e(e)),e=fe(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?W0e(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?U0e(e.quarter):e.quarter;n.push(je(r)?r*3:`${r}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?q0e(e.day):e.day;n.push(je(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i>"u"?0:i)}return n}function sl(e){const n=ZA(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function H0e(e){const n=ZA(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function V0e(e){const t=ZA(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const mB={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},e3=B(mB);function G0e(e){return!!mB[e]}function t3(e){return e.startsWith("utc")}function Y0e(e){return e.substr(3)}const X0e={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function sx(e){return e3.filter(t=>yB(e,t))}function Q0e(e){const t=sx(e);return t[t.length-1]}function yB(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function K0e(e,t,{end:n}={end:!1}){const r=UA(t),i=t3(e)?"utc":"";function o(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let s;const a={};for(const u of e3)yB(e,u)&&(a[u]=o(u),s=u);return n&&(a[s]+="+1"),H0e(a)}function vB(e){if(!e)return;const t=sx(e);return`timeUnitSpecifier(${Ve(t)}, ${Ve(X0e)})`}function J0e(e,t,n){if(!e)return;const r=vB(e);return`${n||t3(e)?"utc":"time"}Format(${t}, ${r})`}function Qt(e){if(!e)return;let t;return Q(e)?t={unit:e}:J(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),t3(t.unit)&&(t.utc=!0,t.unit=Y0e(t.unit)),t}function Z0e(e){const{utc:t,...n}=Qt(e);return n.unit?(t?"utc":"")+B(n).map(r=>et(`${r==="unit"?"":`_${r}_`}${n[r]}`)).join(""):(t?"utc":"")+"timeunit"+B(n).map(r=>et(`_${r}_${n[r]}`)).join("")}function e1e(e){return e==null?void 0:e.param}function n3(e){return!!(e!=null&&e.field)&&e.equal!==void 0}function r3(e){return!!(e!=null&&e.field)&&e.lt!==void 0}function i3(e){return!!(e!=null&&e.field)&&e.lte!==void 0}function o3(e){return!!(e!=null&&e.field)&&e.gt!==void 0}function s3(e){return!!(e!=null&&e.field)&&e.gte!==void 0}function a3(e){if(e!=null&&e.field){if(I(e.range)&&e.range.length===2)return!0;if(re(e.range))return!0}return!1}function u3(e){return!!(e!=null&&e.field)&&(I(e.oneOf)||I(e.in))}function t1e(e){return!!(e!=null&&e.field)&&e.valid!==void 0}function xB(e){return u3(e)||n3(e)||a3(e)||r3(e)||o3(e)||i3(e)||s3(e)}function Wi(e,t){return mx(e,{timeUnit:t,wrapTime:!0})}function n1e(e,t){return e.map(n=>Wi(n,t))}function bB(e,t=!0){var o;const{field:n}=e,r=(o=Qt(e.timeUnit))==null?void 0:o.unit,i=r?`time(${K0e(r,n)})`:Y(e,{expr:"datum"});if(n3(e))return`${i}===${Wi(e.equal,r)}`;if(r3(e)){const s=e.lt;return`${i}<${Wi(s,r)}`}else if(o3(e)){const s=e.gt;return`${i}>${Wi(s,r)}`}else if(i3(e)){const s=e.lte;return`${i}<=${Wi(s,r)}`}else if(s3(e)){const s=e.gte;return`${i}>=${Wi(s,r)}`}else{if(u3(e))return`indexof([${n1e(e.oneOf,r).join(",")}], ${i}) !== -1`;if(t1e(e))return l3(i,e.valid);if(a3(e)){const{range:s}=e,a=re(s)?{signal:`${s.signal}[0]`}:s[0],u=re(s)?{signal:`${s.signal}[1]`}:s[1];if(a!==null&&u!==null&&t)return"inrange("+i+", ["+Wi(a,r)+", "+Wi(u,r)+"])";const l=[];return a!==null&&l.push(`${i} >= ${Wi(a,r)}`),u!==null&&l.push(`${i} <= ${Wi(u,r)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${Ve(e)}`)}function l3(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function r1e(e){var t;return xB(e)&&e.timeUnit?{...e,timeUnit:(t=Qt(e.timeUnit))==null?void 0:t.unit}:e}const gg={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function i1e(e){return e==="quantitative"||e==="temporal"}function wB(e){return e==="ordinal"||e==="nominal"}const al=gg.quantitative,c3=gg.ordinal,ff=gg.temporal,f3=gg.nominal,Wf=gg.geojson;function o1e(e){if(e)switch(e=e.toLowerCase(),e){case"q":case al:return"quantitative";case"t":case ff:return"temporal";case"o":case c3:return"ordinal";case"n":case f3:return"nominal";case Wf:return"geojson"}}const er={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},wS={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function s1e(e,t){const n=wS[e],r=wS[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const a1e={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function TD(e){return a1e[e]}const EB=new Set(["linear","log","pow","sqrt","symlog"]),SB=new Set([...EB,"time","utc"]);function _B(e){return EB.has(e)}const kB=new Set(["quantile","quantize","threshold"]),u1e=new Set([...SB,...kB,"sequential","identity"]),l1e=new Set(["ordinal","bin-ordinal","point","band"]);function Lt(e){return l1e.has(e)}function Cr(e){return u1e.has(e)}function vi(e){return SB.has(e)}function df(e){return kB.has(e)}const c1e={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0};function f1e(e){return!Q(e)&&!!e.name}function $B(e){return e==null?void 0:e.param}function d1e(e){return e==null?void 0:e.unionWith}function h1e(e){return J(e)&&"field"in e}const p1e={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:lke,domain:cke,range:fke,rangeMax:dke,rangeMin:hke,scheme:pke,...g1e}=p1e,m1e=B(g1e);function ES(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return vi(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return vi(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return vi(e);case"nice":return vi(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Cr(e)&&!we(["log","time","utc","threshold","quantile"],e)}}function CB(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Cc(e)?void 0:h0e(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function y1e(e,t){return we([c3,f3],t)?e===void 0||Lt(e):t===ff?we([er.TIME,er.UTC,void 0],e):t===al?_B(e)||df(e)||e===void 0:!0}function v1e(e,t,n=!1){if(!Es(e))return!1;switch(e){case tt:case Rt:case Ua:case Bf:case Kr:case Pi:return vi(t)||t==="band"?!0:t==="point"?!n:!1;case bs:case Ha:case ws:case Wa:case qa:case $l:return vi(t)||df(t)||we(["band","point","ordinal"],t);case sr:case $o:case Co:return t!=="band";case Va:case ar:return t==="ordinal"||df(t)}}const In={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},AB=In.arc,ax=In.area,ux=In.bar,x1e=In.image,lx=In.line,cx=In.point,b1e=In.rect,ny=In.rule,TB=In.text,d3=In.tick,w1e=In.trail,h3=In.circle,p3=In.square,FB=In.geoshape;function Xa(e){return["line","area","trail"].includes(e)}function MB(e){return["rect","bar","image","arc"].includes(e)}const E1e=new Set(B(In));function mo(e){return e.type}const S1e=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],_1e=["fill","fillOpacity"],k1e=[...S1e,..._1e],$1e={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},FD=B($1e),C1e={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},A1e={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},T1e={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},OB=B(T1e);function ul(e){return e&&e.band!=null}const F1e={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},NB=5,M1e={binSpacing:1,continuousBandSize:NB,timeUnitBandPosition:.5},O1e={binSpacing:0,continuousBandSize:NB,timeUnitBandPosition:.5},N1e={thickness:1};function D1e(e){return mo(e)?e.type:e}function g3(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:o}=e,s=y3(e);return H(n)&&!Kj(n.aggregate)&&i&&vi(i.get("type"))?R1e({fieldDef:n,channel:t,markDef:r,ref:s,config:o}):s}function R1e({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return Xa(n.type)?r:Pe("invalid",n,i)===null?[P1e(e,t),r]:r}function P1e(e,t){const n=m3(e,!0),i=Cl(t)==="y"?{field:{group:"height"}}:{value:0};return{test:n,...i}}function m3(e,t=!0){return l3(Q(e)?e:Y(e,{expr:"datum"}),!t)}function L1e(e){const{datum:t}=e;return Tl(t)?sl(t):`${Ve(t)}`}function Pu(e,t,n,r){const i={};if(t&&(i.scale=t),Fo(e)){const{datum:o}=e;Tl(o)?i.signal=sl(o):re(o)?i.signal=o.signal:pg(o)?i.signal=o.expr:i.value=o}else i.field=Y(e,n);if(r){const{offset:o,band:s}=r;o&&(i.offset=o),s&&(i.band=s)}return i}function ry({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,bandPosition:o=.5}){const s=0<o&&o<1?"datum":void 0,a=Y(t,{expr:s,suffix:i}),u=n!==void 0?Y(n,{expr:s}):Y(t,{suffix:"end",expr:s}),l={};if(o===0||o===1){l.scale=e;const c=o===0?a:u;l.field=c}else{const c=re(o)?`${o.signal} * ${a} + (1-${o.signal}) * ${u}`:`${o} * ${a} + ${1-o} * ${u}`;l.signal=`scale("${e}", ${c})`}return r&&(l.offset=r),l}function y3({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l,bandPosition:c}){if(t){if(ce(t)){const f=s==null?void 0:s.get("type");if(Rn(t)){c??(c=BB({fieldDef:t,fieldDef2:n,markDef:r,config:i}));const{bin:d,timeUnit:h,type:p}=t;if(Ge(d)||c&&h&&p===ff)return a!=null&&a.impute?Pu(t,o,{binSuffix:"mid"},{offset:u}):c&&!Lt(f)?ry({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):Pu(t,o,xg(t,e)?{binSuffix:"range"}:{},{offset:u});if(Ut(d)){if(H(n))return ry({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});U(dB(e===tt?Ri:ko))}}return Pu(t,o,Lt(f)?{binSuffix:"range"}:{},{offset:u,band:f==="band"?c??t.bandPosition??.5:void 0})}else if(Fi(t)){const f=t.value,d=u?{offset:u}:{};return{...Ch(e,f),...d}}}return pe(l)&&(l=l()),l&&{...l,...u?{offset:u}:{}}}function Ch(e,t){return we(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:we(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Qe(t)}function ll(e){return e&&e!=="number"&&e!=="time"}function DB(e,t,n){return`${e}(${t}${n?`, ${Ve(n)}`:""})`}const z1e=" – ";function v3({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){var u,l;if(ll(n))return xi({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});const s=RB(e,r,i),a=hf(e);if(t===void 0&&n===void 0&&o.customFormatTypes){if(a==="quantitative"){if(i&&o.normalizedNumberFormatType)return xi({fieldOrDatumDef:e,format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,expr:r,config:o});if(o.numberFormatType)return xi({fieldOrDatumDef:e,format:o.numberFormat,formatType:o.numberFormatType,expr:r,config:o})}if(a==="temporal"&&o.timeFormatType&&H(e)&&e.timeUnit===void 0)return xi({fieldOrDatumDef:e,format:o.timeFormat,formatType:o.timeFormatType,expr:r,config:o})}if(gf(e)){const c=j1e({field:s,timeUnit:H(e)?(u=Qt(e.timeUnit))==null?void 0:u.unit:void 0,format:t,formatType:o.timeFormatType,rawTimeFormat:o.timeFormat,isUTCScale:Fl(e)&&((l=e.scale)==null?void 0:l.type)===er.UTC});return c?{signal:c}:void 0}if(t=SS({type:a,specifiedFormat:t,config:o,normalizeStack:i}),H(e)&&Ge(e.bin)){const c=Y(e,{expr:r,binSuffix:"end"});return{signal:mg(s,c,t,n,o)}}else return t||hf(e)==="quantitative"?{signal:`${zB(s,t)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function RB(e,t,n){return H(e)?n?`${Y(e,{expr:t,suffix:"end"})}-${Y(e,{expr:t,suffix:"start"})}`:Y(e,{expr:t}):L1e(e)}function xi({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:s}){if(s??(s=RB(e,r,i)),s!=="datum.value"&&H(e)&&Ge(e.bin)){const a=Y(e,{expr:r,binSuffix:"end"});return{signal:mg(s,a,t,n,o)}}return{signal:DB(n,s,t)}}function PB(e,t,n,r,i,o){var s;if(!(Q(r)&&ll(r))&&!(n===void 0&&r===void 0&&i.customFormatTypes&&hf(e)==="quantitative"&&(i.normalizedNumberFormatType&&pf(e)&&e.stack==="normalize"||i.numberFormatType))){if(pf(e)&&e.stack==="normalize"&&i.normalizedNumberFormat)return SS({type:"quantitative",config:i,normalizeStack:!0});if(gf(e)){const a=H(e)?(s=Qt(e.timeUnit))==null?void 0:s.unit:void 0;return a===void 0&&i.customFormatTypes&&i.timeFormatType?void 0:I1e({specifiedFormat:n,timeUnit:a,config:i,omitTimeFormatConfig:o})}return SS({type:t,specifiedFormat:n,config:i})}}function LB(e,t,n){var r;if(e&&(re(e)||e==="number"||e==="time"))return e;if(gf(t)&&n!=="time"&&n!=="utc")return H(t)&&((r=Qt(t==null?void 0:t.timeUnit))!=null&&r.utc)?"utc":"time"}function SS({type:e,specifiedFormat:t,config:n,normalizeStack:r}){if(Q(t))return t;if(e===al)return r?n.normalizedNumberFormat:n.numberFormat}function I1e({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:r}){return e||(t?{signal:vB(t)}:r?void 0:n.timeFormat)}function zB(e,t){return`format(${e}, "${t||""}")`}function MD(e,t,n,r){return ll(n)?DB(n,e,t):zB(e,(Q(t)?t:void 0)??r.numberFormat)}function mg(e,t,n,r,i){if(n===void 0&&r===void 0&&i.customFormatTypes&&i.numberFormatType)return mg(e,t,i.numberFormat,i.numberFormatType,i);const o=MD(e,n,r,i),s=MD(t,n,r,i);return`${l3(e,!1)} ? "null" : ${o} + "${z1e}" + ${s}`}function j1e({field:e,timeUnit:t,format:n,formatType:r,rawTimeFormat:i,isUTCScale:o}){return!t||n?!t&&r?`${r}(${e}, '${n}')`:(n=Q(n)?n:i,`${o?"utc":"time"}Format(${e}, '${n}')`):J0e(t,e,o)}const fx="min",B1e={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function OD(e){return e in B1e}function IB(e){return!!(e!=null&&e.encoding)}function so(e){return e&&(e.op==="count"||!!e.field)}function jB(e){return e&&I(e)}function yg(e){return"row"in e||"column"in e}function x3(e){return!!e&&"header"in e}function dx(e){return"facet"in e}function U1e(e){return e.param}function W1e(e){return e&&!Q(e)&&"repeat"in e}function ND(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:t}}function b3(e){return"sort"in e}function BB({fieldDef:e,fieldDef2:t,markDef:n,config:r}){if(ce(e)&&e.bandPosition!==void 0)return e.bandPosition;if(H(e)){const{timeUnit:i,bin:o}=e;if(i&&!t)return MB(n.type)?0:ol("timeUnitBandPosition",n,r);if(Ge(o))return .5}}function UB({channel:e,fieldDef:t,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:s}){var l,c,f;const a=ur(e),u=Pe(s?"size":a,r,i,{vgChannel:a});if(u!==void 0)return u;if(H(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:ol("timeUnitBandSize",r,i)};if(Ge(h)&&!Lt(o))return{band:1}}if(MB(r.type))return o?Lt(o)?((l=i[r.type])==null?void 0:l.discreteBandSize)||{band:1}:(c=i[r.type])==null?void 0:c.continuousBandSize:(f=i[r.type])==null?void 0:f.discreteBandSize}function WB(e,t,n,r){return Ge(e.bin)||e.timeUnit&&Rn(e)&&e.type==="temporal"?BB({fieldDef:e,fieldDef2:t,markDef:n,config:r})!==void 0:!1}function hx(e){return e&&"condition"in e}function px(e){const t=e==null?void 0:e.condition;return!!t&&!I(t)&&H(t)}function vg(e){const t=e==null?void 0:e.condition;return!!t&&!I(t)&&ce(t)}function q1e(e){const t=e==null?void 0:e.condition;return!!t&&(I(t)||Fi(t))}function H(e){return e&&(!!e.field||e.aggregate==="count")}function hf(e){return e==null?void 0:e.type}function Fo(e){return e&&"datum"in e}function Ks(e){return Rn(e)&&!oy(e)||iy(e)}function DD(e){return Rn(e)&&e.type==="quantitative"&&!e.bin||iy(e)}function iy(e){return Fo(e)&&je(e.datum)}function ce(e){return H(e)||Fo(e)}function Rn(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function Fi(e){return e&&"value"in e&&"value"in e}function Fl(e){return e&&("scale"in e||"sort"in e)}function pf(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function qB(e){return e&&"legend"in e}function HB(e){return e&&("format"in e||"formatType"in e)}function H1e(e){return Zn(e,["legend","axis","header","scale"])}function V1e(e){return"op"in e}function Y(e,t={}){let n=e.field;const r=t.prefix;let i=t.suffix,o="";if(Y1e(e))n=Pj("count");else{let s;if(!t.nofn)if(V1e(e))s=e.op;else{const{bin:a,aggregate:u,timeUnit:l}=e;Ge(a)?(s=Jj(a),i=(t.binSuffix??"")+(t.suffix??"")):u?Ga(u)?(o=`["${n}"]`,n=`argmax_${u.argmax}`):hs(u)?(o=`["${n}"]`,n=`argmin_${u.argmin}`):s=String(u):l&&(s=Z0e(l),i=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}s&&(n=n?`${s}_${n}`:s)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),t.forAs?WA(n):t.expr?Nj(n,t.expr)+o:Yr(n)+o}function oy(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return H(e)&&!!e.bin;case"temporal":return!1}throw new Error(uB(e.type))}function G1e(e){var t;return Fl(e)&&df((t=e.scale)==null?void 0:t.type)}function Y1e(e){return e.aggregate==="count"}function X1e(e,t){var s;const{field:n,bin:r,timeUnit:i,aggregate:o}=e;if(o==="count")return t.countTitle;if(Ge(r))return`${n} (binned)`;if(i){const a=(s=Qt(i))==null?void 0:s.unit;if(a)return`${n} (${sx(a).join("-")})`}else if(o)return Ga(o)?`${n} for max ${o.argmax}`:hs(o)?`${n} for min ${o.argmin}`:`${cg(o)} of ${n}`;return n}function Q1e(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(Ga(t))return`${i} for argmax(${t.argmax})`;if(hs(t))return`${i} for argmin(${t.argmin})`;const o=Qt(r),s=t||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||Ge(n)&&"bin";return s?`${s.toUpperCase()}(${i})`:i}const VB=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Q1e(e);default:return X1e(e,t)}};let GB=VB;function YB(e){GB=e}function K1e(){YB(VB)}function Ac(e,t,{allowDisabling:n,includeDefault:r=!0}){var a;const i=(a=w3(e))==null?void 0:a.title;if(!H(e))return i??e.title;const o=e,s=r?E3(o,t):void 0;return n?mt(i,o.title,s):i??o.title??s}function w3(e){if(pf(e)&&e.axis)return e.axis;if(qB(e)&&e.legend)return e.legend;if(x3(e)&&e.header)return e.header}function E3(e,t){return GB(e,t)}function sy(e){if(HB(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=w3(e)??{},{format:n,formatType:r}=t;return{format:n,formatType:r}}}function J1e(e,t){var o;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(b3(e)&&I(e.sort))return"ordinal";const{aggregate:n,bin:r,timeUnit:i}=e;if(i)return"temporal";if(r||n&&!Ga(n)&&!hs(n))return"quantitative";if(Fl(e)&&((o=e.scale)!=null&&o.type))switch(wS[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function yo(e){if(H(e))return e;if(px(e))return e.condition}function Et(e){if(ce(e))return e;if(vg(e))return e.condition}function XB(e,t,n,r={}){if(Q(e)||je(e)||Ra(e)){const i=Q(e)?"string":je(e)?"number":"boolean";return U(e0e(t,i,e)),{value:e}}return ce(e)?ay(e,t,n,r):vg(e)?{...e,condition:ay(e.condition,t,n,r)}:e}function ay(e,t,n,r){if(HB(e)){const{format:i,formatType:o,...s}=e;if(ll(o)&&!n.customFormatTypes)return U($D(t)),ay(s,t,n,r)}else{const i=pf(e)?"axis":qB(e)?"legend":x3(e)?"header":null;if(i&&e[i]){const{format:o,formatType:s,...a}=e[i];if(ll(s)&&!n.customFormatTypes)return U($D(t)),ay({...e,[i]:a},t,n,r)}}return H(e)?S3(e,t,r):Z1e(e)}function Z1e(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=je(n)?"quantitative":Q(n)?"nominal":Tl(n)?"temporal":void 0,{...e,type:t}}function S3(e,t,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:o,field:s}=e,a={...e};if(!n&&r&&!QA(r)&&!Ga(r)&&!hs(r)&&(U(n0e(r)),delete a.aggregate),i&&(a.timeUnit=Qt(i)),s&&(a.field=`${s}`),Ge(o)&&(a.bin=gx(o,t)),Ut(o)&&!Pt(t)&&U(R0e(t)),Rn(a)){const{type:u}=a,l=o1e(u);u!==l&&(a.type=l),u!=="quantitative"&&Kj(r)&&(U(t0e(u,r)),a.type="quantitative")}else if(!qj(t)){const u=J1e(a,t);a.type=u}if(Rn(a)){const{compatible:u,warning:l}=eye(a,t)||{};u===!1&&U(l)}if(b3(a)&&Q(a.sort)){const{sort:u}=a;if(OD(u))return{...a,sort:{encoding:u}};const l=u.substr(1);if(u.charAt(0)==="-"&&OD(l))return{...a,sort:{encoding:l,order:"descending"}}}if(x3(a)){const{header:u}=a;if(u){const{orient:l,...c}=u;if(l)return{...a,header:{...c,labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l}}}}return a}function gx(e,t){return Ra(e)?{maxbins:yD(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:yD(t)}:e}const Wl={compatible:!0};function eye(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ts:case ns:case Kv:return oy(e)?Wl:{compatible:!1,warning:a0e(t)};case tt:case Rt:case Ua:case Bf:case sr:case $o:case Co:case fg:case hg:case Jv:case il:case Zv:case ex:case $l:case Kr:case Pi:case tx:return Wl;case zi:case Xr:case Li:case Ii:return n!==al?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Wl;case ws:case Wa:case qa:case Ha:case bs:case xs:case vs:case Ri:case ko:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Wl;case ar:case Va:return!oy(e)&&!G1e(e)?{compatible:!1,warning:u0e(t)}:Wl;case dg:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Wl}}function gf(e){const{formatType:t}=sy(e);return t==="time"||!t&&tye(e)}function tye(e){return e&&(e.type==="temporal"||H(e)&&!!e.timeUnit)}function mx(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var u;const o=t&&((u=Qt(t))==null?void 0:u.unit);let s=o||n==="temporal",a;return pg(e)?a=e.expr:re(e)?a=e.signal:Tl(e)?(s=!0,a=sl(e)):(Q(e)||je(e))&&s&&(a=`datetime(${Ve(e)})`,G0e(o)&&(je(e)&&e<1e4||Q(e)&&isNaN(Date.parse(e)))&&(a=sl({[o]:e}))),a?r&&s?`time(${a})`:a:i?void 0:Ve(e)}function QB(e,t){const{type:n}=e;return t.map(r=>{const i=mx(r,{timeUnit:H(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function xg(e,t){return Ge(e.bin)?Es(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const RD={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function bg(e){return e==null?void 0:e.condition}const KB=["domain","grid","labels","ticks","title"],nye={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},JB={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},rye={...JB,style:1,labelExpr:1,encoding:1};function PD(e){return!!rye[e]}const iye={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},ZB=B(iye);function Ss(e){return"mark"in e}class yx{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Ss(t)?D1e(t.mark)===this.name:!1}}function Lu(e,t){const n=e&&e[t];return n?I(n)?nl(n,r=>!!r.field):H(n)||px(n):!1}function eU(e,t){const n=e&&e[t];return n?I(n)?nl(n,r=>!!r.field):H(n)||Fo(n)||vg(n):!1}function _S(e,t){if(Pt(t)){const n=e[t];if((H(n)||Fo(n))&&wB(n.type)){const r=Hj(t);return eU(e,r)}}return!1}function _3(e){return nl(sme,t=>{if(Lu(e,t)){const n=e[t];if(I(n))return nl(n,r=>!!r.aggregate);{const r=yo(n);return r&&!!r.aggregate}}return!1})}function tU(e,t){const n=[],r=[],i=[],o=[],s={};return k3(e,(a,u)=>{if(H(a)){const{field:l,aggregate:c,bin:f,timeUnit:d,...h}=a;if(c||d||f){const p=w3(a),g=p==null?void 0:p.title;let y=Y(a,{forAs:!0});const m={...g?[]:{title:Ac(a,t,{allowDisabling:!0})},...h,field:y};if(c){let v;if(Ga(c)?(v="argmax",y=Y({op:"argmax",field:c.argmax},{forAs:!0}),m.field=`${y}.${l}`):hs(c)?(v="argmin",y=Y({op:"argmin",field:c.argmin},{forAs:!0}),m.field=`${y}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const x={op:v,as:y};l&&(x.field=l),o.push(x)}}else if(n.push(y),Rn(a)&&Ge(f)){if(r.push({bin:f,field:l,as:y}),n.push(Y(a,{binSuffix:"end"})),xg(a,u)&&n.push(Y(a,{binSuffix:"range"})),Pt(u)){const v={field:`${y}_end`};s[`${u}2`]=v}m.bin="binned",qj(u)||(m.type=al)}else if(d){i.push({timeUnit:d,field:l,as:y});const v=Rn(a)&&a.type!==ff&&"time";v&&(u===fg||u===il?m.formatType=v:mme(u)?m.legend={formatType:v,...m.legend}:Pt(u)&&(m.axis={formatType:v,...m.axis}))}s[u]=m}else n.push(l),s[u]=e[u]}else s[u]=e[u]}),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:s}}function oye(e,t,n){const r=vme(t,n);if(r){if(r==="binned"){const i=e[t===Ri?tt:Rt];return!!(H(i)&&H(e[t])&&Ut(i.bin))}}else return!1;return!0}function sye(e,t,n,r){const i={};for(const o of B(e))Wj(o)||U(s0e(o));for(let o of dme){if(!e[o])continue;const s=e[o];if(Uf(o)){const a=Vj(o),u=i[a];if(H(u)){if(i1e(u.type)&&H(s)){U(Jme(a));continue}}else o=a,U(Zme(a))}if(o==="angle"&&t==="arc"&&!e.theta&&(U(Kme),o=Kr),!oye(e,o,t)){U(ox(o,t));continue}if(o===bs&&t==="line"){const a=yo(e[o]);if(a!=null&&a.aggregate){U(i0e);continue}}if(o===sr&&(n?"fill"in e:"stroke"in e)){U(lB("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(o===hg||o===dg&&!I(s)&&!Fi(s)||o===il&&I(s))s&&(i[o]=K(s).reduce((a,u)=>(H(u)?a.push(S3(u,o)):U(bS(u,o)),a),[]));else{if(o===il&&s===null)i[o]=null;else if(!H(s)&&!Fo(s)&&!Fi(s)&&!hx(s)&&!re(s)){U(bS(s,o));continue}i[o]=XB(s,o,r)}}return i}function vx(e,t){const n={};for(const r of B(e)){const i=XB(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function aye(e){const t=[];for(const n of B(e))if(Lu(e,n)){const r=e[n],i=K(r);for(const o of i)H(o)?t.push(o):px(o)&&t.push(o.condition)}return t}function k3(e,t,n){if(e)for(const r of B(e)){const i=e[r];if(I(i))for(const o of i)t.call(n,o,r);else t.call(n,i,r)}}function uye(e,t,n,r){return e?B(e).reduce((i,o)=>{const s=e[o];return I(s)?s.reduce((a,u)=>t.call(r,a,u,o),i):t.call(r,i,s,o)},n):n}function nU(e,t){return B(t).reduce((n,r)=>{switch(r){case tt:case Rt:case Zv:case tx:case ex:case Ri:case ko:case Ua:case Bf:case Kr:case xs:case Pi:case vs:case Li:case zi:case Ii:case Xr:case fg:case ar:case $l:case il:return n;case dg:if(e==="line"||e==="trail")return n;case hg:case Jv:{const i=t[r];if(I(i)||H(i))for(const o of K(i))o.aggregate||n.push(Y(o,{}));return n}case bs:if(e==="trail")return n;case sr:case $o:case Co:case ws:case Wa:case qa:case Va:case Ha:{const i=yo(t[r]);return i&&!i.aggregate&&n.push(Y(i,{})),n}}},[])}function lye(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let r,i;if(I(t)){for(const o of t)o.aggregate?(r||(r=[]),r.push(o)):(i||(i=[]),i.push(o));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return I(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function kS(e,t,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};const i=e.map(({fieldPrefix:s,titlePrefix:a})=>{const u=r?` of ${$3(t)}`:"";return{field:s+t.field,type:t.type,title:re(a)?{signal:`${a}"${escape(u)}"`}:a+u}}),o=aye(n).map(H1e);return{tooltip:[...i,...eo(o,ke)]}}function $3(e){const{title:t,field:n}=e;return mt(t,n)}function C3(e,t,n,r,i){const{scale:o,axis:s}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=$3(n);return rU(e,a,i,{mark:u,encoding:{[t]:{field:`${l}_${n.field}`,type:n.type,...d!==void 0?{title:d}:{},...o!==void 0?{scale:o}:{},...s!==void 0?{axis:s}:{}},...Q(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...r,...f}})}}function rU(e,t,n,r){const{clip:i,color:o,opacity:s}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[{...r,mark:{...n[t],...i?{clip:i}:{},...o?{color:o}:{},...s?{opacity:s}:{},...mo(r.mark)?r.mark:{type:r.mark},style:`${a}-${String(t)}`,...Ra(e[t])?{}:e[t]}}]:[]}function iU(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",o=r[i],s=r[`${i}2`],a=r[`${i}Error`],u=r[`${i}Error2`];return{continuousAxisChannelDef:ym(o,n),continuousAxisChannelDef2:ym(s,n),continuousAxisChannelDefError:ym(a,n),continuousAxisChannelDefError2:ym(u,n),continuousAxis:i}}function ym(e,t){if(e!=null&&e.aggregate){const{aggregate:n,...r}=e;return n!==t&&U(D0e(n,t)),r}else return e}function oU(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(mo(n)&&n.orient)return n.orient;if(Ks(i)){if(Ks(o)){const s=H(i)&&i.aggregate,a=H(o)&&o.aggregate;if(!s&&a===t)return"vertical";if(!a&&s===t)return"horizontal";if(s===t&&a===t)throw new Error("Both x and y cannot have aggregate");return gf(o)&&!gf(i)?"horizontal":"vertical"}return"horizontal"}else{if(Ks(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const uy="boxplot",cye=["box","median","outliers","rule","ticks"],fye=new yx(uy,aU);function sU(e){return je(e)?"tukey":e}function aU(e,{config:t}){e={...e,encoding:vx(e.encoding,t)};const{mark:n,encoding:r,params:i,projection:o,...s}=e,a=mo(n)?n:{type:n};i&&U(aB("boxplot"));const u=a.extent??t.boxplot.extent,l=Pe("size",a,t),c=a.invalid,f=sU(u),{bins:d,timeUnits:h,transform:p,continuousAxisChannelDef:g,continuousAxis:y,groupby:m,aggregate:v,encodingWithoutContinuousAxis:x,ticksOrient:b,boxOrient:w,customTooltipWithoutAggregatedField:S}=dye(e,u,t),{color:E,size:_,...$}=x,k=xn=>C3(a,y,g,xn,t.boxplot),A=k($),R=k(x),C=k({...$,..._?{size:_}:{}}),F=kS([{fieldPrefix:f==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:f==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],g,x),T={type:"tick",color:"black",opacity:1,orient:b,invalid:c,aria:!1},O=f==="min-max"?F:kS([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,x),D=[...A({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:O}),...A({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:O}),...A({partName:"ticks",mark:T,positionPrefix:"lower_whisker",extraEncoding:O}),...A({partName:"ticks",mark:T,positionPrefix:"upper_whisker",extraEncoding:O})],M=[...f!=="tukey"?D:[],...R({partName:"box",mark:{type:"bar",...l?{size:l}:{},orient:w,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:F}),...C({partName:"median",mark:{type:"tick",invalid:c,...J(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...l?{size:l}:{},orient:b,aria:!1},positionPrefix:"mid_box",extraEncoding:F})];if(f==="min-max")return{...s,transform:(s.transform??[]).concat(p),layer:M};const N=`datum["lower_box_${g.field}"]`,j=`datum["upper_box_${g.field}"]`,X=`(${j} - ${N})`,te=`${N} - ${u} * ${X}`,xe=`${j} + ${u} * ${X}`,de=`datum["${g.field}"]`,De={joinaggregate:uU(g.field),groupby:m},It={transform:[{filter:`(${te} <= ${de}) && (${de} <= ${xe})`},{aggregate:[{op:"min",field:g.field,as:`lower_whisker_${g.field}`},{op:"max",field:g.field,as:`upper_whisker_${g.field}`},{op:"min",field:`lower_box_${g.field}`,as:`lower_box_${g.field}`},{op:"max",field:`upper_box_${g.field}`,as:`upper_box_${g.field}`},...v],groupby:m}],layer:D},{tooltip:Zr,...Qa}=$,{scale:Z,axis:ge}=g,ye=$3(g),W=Zn(ge,["title"]),jt=rU(a,"outliers",t.boxplot,{transform:[{filter:`(${de} < ${te}) || (${de} > ${xe})`}],mark:"point",encoding:{[y]:{field:g.field,type:g.type,...ye!==void 0?{title:ye}:{},...Z!==void 0?{scale:Z}:{},...Ie(W)?{}:{axis:W}},...Qa,...E?{color:E}:{},...S?{tooltip:S}:{}}})[0];let Oe;const Jt=[...d,...h,De];return jt?Oe={transform:Jt,layer:[jt,It]}:(Oe=It,Oe.transform.unshift(...Jt)),{...s,layer:[Oe,{transform:p,layer:M}]}}function uU(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function dye(e,t,n){const r=oU(e,uy),{continuousAxisChannelDef:i,continuousAxis:o}=iU(e,r,uy),s=i.field,a=sU(t),u=[...uU(s),{op:"median",field:s,as:`mid_box_${s}`},{op:"min",field:s,as:(a==="min-max"?"lower_whisker_":"min_")+s},{op:"max",field:s,as:(a==="min-max"?"upper_whisker_":"max_")+s}],l=a==="min-max"||a==="tukey"?[]:[{calculate:`datum["upper_box_${s}"] - datum["lower_box_${s}"]`,as:`iqr_${s}`},{calculate:`min(datum["upper_box_${s}"] + datum["iqr_${s}"] * ${t}, datum["max_${s}"])`,as:`upper_whisker_${s}`},{calculate:`max(datum["lower_box_${s}"] - datum["iqr_${s}"] * ${t}, datum["min_${s}"])`,as:`lower_whisker_${s}`}],{[o]:c,...f}=e.encoding,{customTooltipWithoutAggregatedField:d,filteredEncoding:h}=lye(f),{bins:p,timeUnits:g,aggregate:y,groupby:m,encoding:v}=tU(h,n),x=r==="vertical"?"horizontal":"vertical",b=r,w=[...p,...g,{aggregate:[...y,...u],groupby:m},...l];return{bins:p,timeUnits:g,transform:w,groupby:m,aggregate:y,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:x,boxOrient:b,customTooltipWithoutAggregatedField:d}}const A3="errorbar",hye=["ticks","rule"],pye=new yx(A3,lU);function lU(e,{config:t}){e={...e,encoding:vx(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:u,tooltipEncoding:l}=cU(e,A3,t);delete o.size;const c=C3(a,i,r,o,t.errorbar),f=a.thickness,d=a.size,h={type:"tick",orient:s,aria:!1,...f!==void 0?{thickness:f}:{},...d!==void 0?{size:d}:{}},p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...f!==void 0?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return{...u,transform:n,...p.length>1?{layer:p}:{...p[0]}}}function gye(e,t){const{encoding:n}=e;if(mye(n))return{orient:oU(e,t),inputType:"raw"};const r=yye(n),i=vye(n),o=n.x,s=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(ce(a)&&ce(u))throw new Error(`${t} cannot have both x2 and y2`);if(ce(a)){if(Ks(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(ce(u)){if(Ks(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(ce(u)&&!ce(a))throw new Error(`${t} cannot have xError2 without xError`);if(ce(c)&&!ce(l))throw new Error(`${t} cannot have yError2 without yError`);if(ce(a)&&ce(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(ce(a)){if(Ks(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(ce(l)){if(Ks(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function mye(e){return(ce(e.x)||ce(e.y))&&!ce(e.x2)&&!ce(e.y2)&&!ce(e.xError)&&!ce(e.xError2)&&!ce(e.yError)&&!ce(e.yError2)}function yye(e){return ce(e.x2)||ce(e.y2)}function vye(e){return ce(e.xError)||ce(e.xError2)||ce(e.yError)||ce(e.yError2)}function cU(e,t,n){const{mark:r,encoding:i,params:o,projection:s,...a}=e,u=mo(r)?r:{type:r};o&&U(aB(t));const{orient:l,inputType:c}=gye(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:g}=iU(e,l,t),{errorBarSpecificAggregate:y,postAggregateCalculates:m,tooltipSummary:v,tooltipTitleWithFieldName:x}=xye(u,f,d,h,p,c,t,n),{[g]:b,[g==="x"?"x2":"y2"]:w,[g==="x"?"xError":"yError"]:S,[g==="x"?"xError2":"yError2"]:E,..._}=i,{bins:$,timeUnits:k,aggregate:A,groupby:R,encoding:C}=tU(_,n),F=[...A,...y],T=c!=="raw"?[]:R,O=kS(v,f,C,x);return{transform:[...a.transform??[],...$,...k,...F.length===0?[]:[{aggregate:F,groupby:T}],...m],groupby:T,continuousAxisChannelDef:f,continuousAxis:g,encodingWithoutContinuousAxis:C,ticksOrient:l==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:a,tooltipEncoding:O}}function xye(e,t,n,r,i,o,s,a){let u=[],l=[];const c=t.field;let f,d=!1;if(o==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&U(N0e(h,p,s)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:cg(h)},{fieldPrefix:"upper_",titlePrefix:LD(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:LD(h,p,"-")}],d=!0;else{let g,y,m;p==="ci"?(g="mean",y="ci0",m="ci1"):(g="median",y="q1",m="q3"),u=[{op:y,field:c,as:`lower_${c}`},{op:m,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:Ac({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Ac({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Ac({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&U(O0e(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:rl(rl(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function LD(e,t,n){return`${cg(e)} ${n} ${t}`}const T3="errorband",bye=["band","borders"],wye=new yx(T3,fU);function fU(e,{config:t}){e={...e,encoding:vx(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:a,tooltipEncoding:u}=cU(e,T3,t),l=s,c=C3(l,i,r,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p={...l.interpolate?{interpolate:l.interpolate}:{},...l.tension&&l.interpolate?{tension:l.tension}:{}};return f?(d={...d,...p,ariaRoleDescription:"errorband"},h={...h,...p,aria:!1}):l.interpolate?U(AD("interpolate")):l.tension&&U(AD("tension")),{...a,transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]}}const dU={};function F3(e,t,n){const r=new yx(e,t);dU[e]={normalizer:r,parts:n}}function Eye(){return B(dU)}F3(uy,aU,cye);F3(A3,lU,hye);F3(T3,fU,bye);const Sye=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],hU={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},pU={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},_ye=B(hU),kye=B(pU),$ye={header:1,headerRow:1,headerColumn:1,headerFacet:1},gU=B($ye),mU=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Cye={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},Aye={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Mi="_vgsid_",Tye={point:{on:"click",fields:[Mi],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function M3(e){return e==="legend"||!!(e!=null&&e.legend)}function vb(e){return M3(e)&&J(e)}function O3(e){return!!(e!=null&&e.select)}function yU(e){const t=[];for(const n of e||[]){if(O3(n))continue;const{expr:r,bind:i,...o}=n;if(i&&r){const s={...o,bind:i,init:r};t.push(s)}else{const s={...o,...r?{update:r}:{},...i?{bind:i}:{}};t.push(s)}}return t}function Fye(e){return xx(e)||D3(e)||N3(e)}function N3(e){return"concat"in e}function xx(e){return"vconcat"in e}function D3(e){return"hconcat"in e}function vU({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function vo(e){return J(e)&&e.step!==void 0}function zD(e){return e.view||e.width||e.height}const ID=20,Mye={align:1,bounds:1,center:1,columns:1,spacing:1},Oye=B(Mye);function Nye(e,t,n){const r=n[t],i={},{spacing:o,columns:s}=r;o!==void 0&&(i.spacing=o),s!==void 0&&(dx(e)&&!yg(e.facet)||N3(e))&&(i.columns=s),xx(e)&&(i.columns=1);for(const a of Oye)if(e[a]!==void 0)if(a==="spacing"){const u=e[a];i[a]=je(u)?u:{row:u.row??o,column:u.column??o}}else i[a]=e[a];return i}function $S(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function ly(e,t){const n=cy(e,t);return vo(n)?n.step:xU}function cy(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return mt(n,{step:e.step})}const xU=20,Dye={continuousWidth:200,continuousHeight:200,step:xU},Rye={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Dye,mark:A1e,arc:{},area:{},bar:M1e,circle:{},geoshape:{},image:{},line:{},point:{},rect:O1e,rule:{color:"black"},square:{},text:{color:"black"},tick:N1e,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:c1e,projection:{},legend:Cye,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Tye,style:{},title:{},facet:{spacing:ID},concat:{spacing:ID},normalizedNumberFormat:".0%"},Do=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],jD={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},BD={blue:Do[0],orange:Do[1],red:Do[2],teal:Do[3],green:Do[4],yellow:Do[5],purple:Do[6],pink:Do[7],brown:Do[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Pye(e={}){return{signals:[{name:"color",value:J(e)?{...BD,...e}:BD}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Lye(e){return{signals:[{name:"fontSize",value:J(e)?{...jD,...e}:jD}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function zye(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function bU(e){const t=B(e||{}),n={};for(const r of t){const i=e[r];n[r]=bg(i)?eB(i):mr(i)}return n}function Iye(e){const t=B(e),n={};for(const r of t)n[r]=bU(e[r]);return n}const jye=[...OB,...ZB,...gU,"background","padding","legend","lineBreak","scale","style","title","view"];function wU(e={}){const{color:t,font:n,fontSize:r,selection:i,...o}=e,s=$f({},fe(Rye),n?zye(n):{},t?Pye(t):{},r?Lye(r):{},o||{});i&&Cf(s,"selection",i,!0);const a=Zn(s,jye);for(const u of["background","lineBreak","padding"])s[u]&&(a[u]=mr(s[u]));for(const u of OB)s[u]&&(a[u]=qn(s[u]));for(const u of ZB)s[u]&&(a[u]=bU(s[u]));for(const u of gU)s[u]&&(a[u]=qn(s[u]));return s.legend&&(a.legend=qn(s.legend)),s.scale&&(a.scale=qn(s.scale)),s.style&&(a.style=Iye(s.style)),s.title&&(a.title=qn(s.title)),s.view&&(a.view=qn(s.view)),a}const Bye=new Set(["view",...E1e]),Uye=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Wye={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...C1e};function qye(e){e=fe(e);for(const t of Uye)delete e[t];if(e.axis)for(const t in e.axis)bg(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of Sye)delete e.legend[t];if(e.mark){for(const t of FD)delete e.mark[t];e.mark.tooltip&&J(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(yU(e.params)),delete e.params);for(const t of Bye){for(const r of FD)delete e[t][r];const n=Wye[t];if(n)for(const r of n)delete e[t][r];Vye(e,t)}for(const t of Eye())delete e[t];Hye(e);for(const t in e)J(e[t])&&Ie(e[t])&&delete e[t];return Ie(e)?void 0:e}function Hye(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=Zj(e.title);Ie(t)||(e.style["group-title"]={...e.style["group-title"],...t}),Ie(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),Ie(r)?delete e.title:e.title=r}function Vye(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const o={...i,...e.style[n??t]};Ie(o)||(e.style[n??t]=o),r||delete e[t]}function bx(e){return"layer"in e}function Gye(e){return"repeat"in e}function Yye(e){return!I(e.repeat)&&e.repeat.layer}class R3{map(t,n){return dx(t)?this.mapFacet(t,n):Gye(t)?this.mapRepeat(t,n):D3(t)?this.mapHConcat(t,n):xx(t)?this.mapVConcat(t,n):N3(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(bx(t))return this.mapLayer(t,n);if(Ss(t))return this.mapUnit(t,n);throw new Error(KA(t))}mapLayer(t,n){return{...t,layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(r=>this.map(r,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(r=>this.map(r,n))}}mapConcat(t,n){const{concat:r,...i}=t;return{...i,concat:r.map(o=>this.map(o,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const Xye={zero:1,center:1,normalize:1};function Qye(e){return e in Xye}const Kye=new Set([AB,ux,ax,ny,cx,h3,p3,lx,TB,d3]),Jye=new Set([ux,ax,AB]);function ql(e){return H(e)&&hf(e)==="quantitative"&&!e.bin}function UD(e,t,{orient:n,type:r}){const i=t==="x"?"y":"radius",o=t==="x",s=e[t],a=e[i];if(H(s)&&H(a))if(ql(s)&&ql(a)){if(s.stack)return t;if(a.stack)return i;const u=H(s)&&!!s.aggregate,l=H(a)&&!!a.aggregate;if(u!==l)return u?t:i;if(o&&r==="bar"){if(n==="vertical")return i;if(n==="horizontal")return t}}else{if(ql(s))return t;if(ql(a))return i}else{if(ql(s))return t;if(ql(a))return i}}function Zye(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function EU(e,t){var d,h;const n=mo(e)?e:{type:e},r=n.type;if(!Kye.has(r))return null;const i=UD(t,"x",n)||UD(t,"theta",n);if(!i)return null;const o=t[i],s=H(o)?Y(o,{}):void 0,a=Zye(i),u=[],l=new Set;if(t[a]){const p=t[a],g=H(p)?Y(p,{}):void 0;g&&g!==s&&(u.push(a),l.add(g));const y=a==="x"?"xOffset":"yOffset",m=t[y],v=H(m)?Y(m,{}):void 0;v&&v!==s&&(u.push(y),l.add(v))}const c=hme.reduce((p,g)=>{if(g!=="tooltip"&&Lu(t,g)){const y=t[g];for(const m of K(y)){const v=yo(m);if(v.aggregate)continue;const x=Y(v,{});(!x||!l.has(x))&&p.push({channel:g,fieldDef:v})}}return p},[]);let f;return o.stack!==void 0?Ra(o.stack)?f=o.stack?"zero":null:f=o.stack:Jye.has(r)&&(f="zero"),!f||!Qye(f)||_3(t)&&c.length===0?null:(d=o==null?void 0:o.scale)!=null&&d.type&&((h=o==null?void 0:o.scale)==null?void 0:h.type)!==er.LINEAR?(o!=null&&o.stack&&U(T0e(o.scale.type)),null):ce(t[Ao(i)])?(o.stack!==void 0&&U(A0e(i)),null):(H(o)&&o.aggregate&&!kme.has(o.aggregate)&&U(F0e(o.aggregate)),{groupbyChannels:u,groupbyFields:l,fieldChannel:i,impute:o.impute===null?!1:Xa(r),stackBy:c,offset:f})}function eve(e){const{point:t,line:n,...r}=e;return B(r).length>1?r:r.type}function tve(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:Zn(e[t],["point","line"])});return e}function xb(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?J(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?J(t.point)?t.point:{}:void 0}function WD(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class nve{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Ss(t)){const{mark:r,encoding:i}=t,o=mo(r)?r:{type:r};switch(o.type){case"line":case"rule":case"trail":return!!xb(o,n[o.type],i);case"area":return!!xb(o,n[o.type],i)||!!WD(o,n[o.type])}}return!1}run(t,n,r){const{config:i}=n,{params:o,projection:s,mark:a,name:u,encoding:l,...c}=t,f=vx(l,i),d=mo(a)?a:{type:a},h=xb(d,i[d.type],f),p=d.type==="area"&&WD(d,i[d.type]),g=[{name:u,...o?{params:o}:{},mark:eve({...d.type==="area"&&d.opacity===void 0&&d.fillOpacity===void 0?{opacity:.7}:{},...d}),encoding:Zn(f,["shape"])}],y=EU(d,f);let m=f;if(y){const{fieldChannel:v,offset:x}=y;m={...f,[v]:{...f[v],...x?{stack:x}:{}}}}return m=Zn(m,["y2","x2"]),p&&g.push({...s?{projection:s}:{},mark:{type:"line",...uf(d,["clip","interpolate","tension","tooltip"]),...p},encoding:m}),h&&g.push({...s?{projection:s}:{},mark:{type:"point",opacity:1,filled:!0,...uf(d,["clip","tooltip"]),...h},encoding:m}),r({...c,layer:g},{...n,config:tve(i)})}}function rve(e,t){return t?yg(e)?_U(e,t):SU(e,t):e}function bb(e,t){return t?_U(e,t):e}function CS(e,t,n){const r=t[e];if(W1e(r)){if(r.repeat in n)return{...t,[e]:n[r.repeat]};U(qme(r.repeat));return}return t}function SU(e,t){if(e=CS("field",e,t),e!==void 0){if(e===null)return null;if(b3(e)&&so(e.sort)){const n=CS("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function qD(e,t){if(H(e))return SU(e,t);{const n=CS("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function HD(e,t){if(ce(e)){const n=qD(e,t);if(n)return n;if(hx(e))return{condition:e.condition}}else{if(vg(e)){const n=qD(e.condition,t);if(n)return{...e,condition:n};{const{condition:r,...i}=e;return i}}return e}}function _U(e,t){const n={};for(const r in e)if(ae(e,r)){const i=e[r];if(I(i))n[r]=i.map(o=>HD(o,t)).filter(o=>o);else{const o=HD(i,t);o!==void 0&&(n[r]=o)}}return n}class ive{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Ss(t)){const{encoding:n,mark:r}=t;if(r==="line"||mo(r)&&r.type==="line")for(const i of cme){const o=Cl(i),s=n[o];if(n[i]&&(H(s)&&!Ut(s.bin)||Fo(s)))return!0}}return!1}run(t,n,r){const{encoding:i,mark:o}=t;return U(f0e(!!i.x2,!!i.y2)),r({...t,mark:J(o)?{...o,type:"rule"}:"rule"},n)}}class ove extends R3{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[fye,pye,wye,new nve,new ive]}map(t,n){if(Ss(t)){const r=Lu(t.encoding,ts),i=Lu(t.encoding,ns),o=Lu(t.encoding,Kv);if(r||i||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,o=bb(t.encoding,n.repeater),s={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(u=>u).join("_")}:{},...o?{encoding:o}:{}};if(r||i)return this.mapUnitWithParentEncodingOrProjection(s,n);const a=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(s,n.config))return u.run(s,n,a);return s}mapRepeat(t,n){return Yye(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i,...o}=t,{row:s,column:a,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return s||a?this.mapRepeat({...t,repeat:{...s?{row:s}:{},...a?{column:a}:{}},spec:{repeat:{layer:u},spec:i}},n):{...o,layer:u.map(f=>{const d={...l,layer:f},h=`${(i.name?`${i.name}_`:"")+c}child__layer_${et(f)}`,p=this.mapLayerOrUnit(i,{...n,repeater:d,repeaterPrefix:h});return p.name=h,p})}}mapNonLayerRepeat(t,n){const{repeat:r,spec:i,data:o,...s}=t;!I(r)&&t.columns&&(t=Zn(t,["columns"]),U(_D("repeat")));const a=[],{repeater:u={},repeaterPrefix:l=""}=n,c=!I(r)&&r.row||[u?u.row:null],f=!I(r)&&r.column||[u?u.column:null],d=I(r)&&r||[u?u.repeat:null];for(const p of d)for(const g of c)for(const y of f){const m={repeat:p,row:g,column:y,layer:u.layer},v=(i.name?`${i.name}_`:"")+l+"child__"+(I(r)?`${et(p)}`:(r.row?`row_${et(g)}`:"")+(r.column?`column_${et(y)}`:"")),x=this.map(i,{...n,repeater:m,repeaterPrefix:v});x.name=v,a.push(Zn(x,["data"]))}const h=I(r)?t.columns:r.column?r.column.length:1;return{data:i.data??o,align:"all",...s,columns:h,concat:a}}mapFacet(t,n){const{facet:r}=t;return yg(r)&&t.columns&&(t=Zn(t,["columns"]),U(_D("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:o,parentProjection:s,config:a}=n,u=GD({parentProjection:s,projection:i}),l=VD({parentEncoding:o,encoding:bb(r,n.repeater)});return this.mapUnit({...t,...u?{projection:u}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(t,n){const{row:r,column:i,facet:o,...s}=t.encoding,{mark:a,width:u,projection:l,height:c,view:f,params:d,encoding:h,...p}=t,{facetMapping:g,layout:y}=this.getFacetMappingAndLayout({row:r,column:i,facet:o},n),m=bb(s,n.repeater);return this.mapFacet({...p,...y,facet:g,spec:{...u?{width:u}:{},...c?{height:c}:{},...f?{view:f}:{},...l?{projection:l}:{},mark:a,encoding:m,...d?{params:d}:{}}},n)}getFacetMappingAndLayout(t,n){const{row:r,column:i,facet:o}=t;if(r||i){o&&U(l0e([...r?[ts]:[],...i?[ns]:[]]));const s={},a={};for(const u of[ts,ns]){const l=t[u];if(l){const{align:c,center:f,spacing:d,columns:h,...p}=l;s[u]=p;for(const g of["align","center","spacing"])l[g]!==void 0&&(a[g]??(a[g]={}),a[g][u]=l[g])}}return{facetMapping:s,layout:a}}else{const{align:s,center:a,spacing:u,columns:l,...c}=o;return{facetMapping:rve(c,n.repeater),layout:{...s?{align:s}:{},...a?{center:a}:{},...u?{spacing:u}:{},...l?{columns:l}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:r,...i}){const{encoding:o,projection:s,...a}=t,u={...i,parentEncoding:VD({parentEncoding:n,encoding:o,layer:!0}),parentProjection:GD({parentProjection:r,projection:s})};return super.mapLayer({...a,...t.name?{name:[u.repeaterPrefix,t.name].filter(l=>l).join("_")}:{}},u)}}function VD({parentEncoding:e,encoding:t={},layer:n}){let r={};if(e){const i=new Set([...B(e),...B(t)]);for(const o of i){const s=t[o],a=e[o];if(ce(s)){const u={...a,...s};r[o]=u}else vg(s)?r[o]={...s,condition:{...a,...s.condition}}:s||s===null?r[o]=s:(n||Fi(a)||re(a)||ce(a)||I(a))&&(r[o]=a)}}else r=t;return!r||Ie(r)?void 0:r}function GD(e){const{parentProjection:t,projection:n}=e;return t&&n&&U(Qme({parentProjection:t,projection:n})),n??t}function P3(e){return"filter"in e}function sve(e){return(e==null?void 0:e.stop)!==void 0}function kU(e){return"lookup"in e}function ave(e){return"data"in e}function uve(e){return"param"in e}function lve(e){return"pivot"in e}function cve(e){return"density"in e}function fve(e){return"quantile"in e}function dve(e){return"regression"in e}function hve(e){return"loess"in e}function pve(e){return"sample"in e}function gve(e){return"window"in e}function mve(e){return"joinaggregate"in e}function yve(e){return"flatten"in e}function vve(e){return"calculate"in e}function $U(e){return"bin"in e}function xve(e){return"impute"in e}function bve(e){return"timeUnit"in e}function wve(e){return"aggregate"in e}function Eve(e){return"stack"in e}function Sve(e){return"fold"in e}function _ve(e){return e.map(t=>P3(t)?{filter:$c(t.filter,r1e)}:t)}class kve extends R3{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=YD(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=YD(t,n),t.encoding){const r={};for(const[i,o]of $a(t.encoding))r[i]=CU(o,n);t={...t,encoding:r}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:r,...i}=t;return r?{...i,params:$a(r).map(([o,s])=>{const{init:a,bind:u,empty:l,...c}=s;c.type==="single"?(c.type="point",c.toggle=!1):c.type==="multi"&&(c.type="point"),n.emptySelections[o]=l!=="none";for(const f of Gt(n.selectionPredicates[o]??{}))f.empty=l!=="none";return{name:o,value:a,select:c,bind:u}})}:t}}function YD(e,t){const{transform:n,...r}=e;if(n){const i=n.map(o=>{if(P3(o))return{filter:AS(o,t)};if($U(o)&&Al(o.bin))return{...o,bin:AU(o.bin)};if(kU(o)){const{selection:s,...a}=o.from;return s?{...o,from:{param:s,...a}}:o}return o});return{...r,transform:i}}return e}function CU(e,t){var r,i;const n=fe(e);if(H(n)&&Al(n.bin)&&(n.bin=AU(n.bin)),Fl(n)&&((i=(r=n.scale)==null?void 0:r.domain)!=null&&i.selection)){const{selection:o,...s}=n.scale.domain;n.scale.domain={...s,...o?{param:o}:{}}}if(hx(n))if(I(n.condition))n.condition=n.condition.map(o=>{const{selection:s,param:a,test:u,...l}=o;return a?o:{...l,test:AS(o,t)}});else{const{selection:o,param:s,test:a,...u}=CU(n.condition,t);n.condition=s?n.condition:{...u,test:AS(n.condition,t)}}return n}function AU(e){const t=e.extent;if(t!=null&&t.selection){const{selection:n,...r}=t;return{...e,extent:{...r,param:n}}}return e}function AS(e,t){const n=r=>$c(r,i=>{var o;const s=t.emptySelections[i]??!0,a={param:i,empty:s};return(o=t.selectionPredicates)[i]??(o[i]=[]),t.selectionPredicates[i].push(a),a});return e.selection?n(e.selection):$c(e.test||e.filter,r=>r.selection?n(r.selection):r)}class TS extends R3{map(t,n){const r=n.selections??[];if(t.params&&!Ss(t)){const i=[];for(const o of t.params)O3(o)?r.push(o):i.push(o);t.params=i}return n.selections=r,super.map(t,n)}mapUnit(t,n){const r=n.selections;if(!r||!r.length)return t;const i=(n.path??[]).concat(t.name),o=[];for(const s of r)if(!s.views||!s.views.length)o.push(s);else for(const a of s.views)(Q(a)&&(a===t.name||i.includes(a))||I(a)&&a.map(u=>i.indexOf(u)).every((u,l,c)=>u!==-1&&(l===0||u>c[l-1])))&&o.push(s);return o.length&&(t.params=o),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=TS.prototype[e];TS.prototype[e]=function(n,r){return t.call(this,n,$ve(n,r))}}function $ve(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function TU(e,t){t===void 0&&(t=wU(e.config));const n=Fve(e,t),{width:r,height:i}=e,o=Mve(n,{width:r,height:i,autosize:e.autosize},t);return{...n,...o?{autosize:o}:{}}}const Cve=new ove,Ave=new kve,Tve=new TS;function Fve(e,t={}){const n={config:t};return Tve.map(Cve.map(Ave.map(e,n),n),n)}function XD(e){return Q(e)?{type:e}:e??{}}function Mve(e,t,n){let{width:r,height:i}=t;const o=Ss(e)||bx(e),s={};o?r=="container"&&i=="container"?(s.type="fit",s.contains="padding"):r=="container"?(s.type="fit-x",s.contains="padding"):i=="container"&&(s.type="fit-y",s.contains="padding"):(r=="container"&&(U(bD("width")),r=void 0),i=="container"&&(U(bD("height")),i=void 0));const a={type:"pad",...s,...n?XD(n.autosize):{},...XD(e.autosize)};if(a.type==="fit"&&!o&&(U(Dme),a.type="pad"),r=="container"&&!(a.type=="fit"||a.type=="fit-x")&&U(wD("width")),i=="container"&&!(a.type=="fit"||a.type=="fit-y")&&U(wD("height")),!Zi(a,{type:"pad"}))return a}function Ove(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Nve(e){return e?`fit-${nx(e)}`:"fit"}const Dve=["background","padding"];function QD(e,t){const n={};for(const r of Dve)e&&e[r]!==void 0&&(n[r]=mr(e[r]));return t&&(n.params=e.params),n}class _s{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new _s(fe(this.explicit),fe(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return mt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:r}){n!==void 0&&this.set(t,n,r)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:r}){n[t]!==void 0?this.set(t,n[t],!0):r[t]!==void 0&&this.set(t,r[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of B(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function Gi(e){return{explicit:!0,value:e}}function fr(e){return{explicit:!1,value:e}}function FU(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:wx(t,n,r,i)}}function wx(e,t,n,r){return e.explicit&&t.explicit&&U(w0e(n,r,e.value,t.value)),e}function Aa(e,t,n,r,i=wx){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Zi(e.value,t.value)?e:i(e,t,n,r)}class Rve extends _s{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function mf(e){return"url"in e}function xp(e){return"values"in e}function MU(e){return"name"in e&&!mf(e)&&!xp(e)&&!da(e)}function da(e){return e&&(OU(e)||NU(e)||L3(e))}function OU(e){return"sequence"in e}function NU(e){return"sphere"in e}function L3(e){return"graticule"in e}var qe;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(qe||(qe={}));function DU(e){const{signals:t,hasLegend:n,index:r,...i}=e;return i.field=Yr(i.field),i}function cl(e,t=!0,n=yn){if(I(e)){const r=e.map(i=>cl(i,t,n));return t?`[${r.join(", ")}]`:r}else if(Tl(e))return n(t?sl(e):V0e(e));return t?n(Ve(e)):e}function Pve(e,t){for(const n of Gt(e.component.selection??{})){const r=n.name;let i=`${r}${Fa}, ${n.resolve==="global"?"true":`{unit: ${zu(e)}}`}`;for(const o of Sx)o.defined(n)&&(o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(i=o.modifyExpr(e,n,i)));t.push({name:r+pxe,on:[{events:{signal:n.name+Fa},update:`modify(${V(n.name+fl)}, ${i})`}]})}return z3(t)}function Lve(e,t){if(e.component.selection&&B(e.component.selection).length){const n=V(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Ba("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return z3(t)}function zve(e,t){let n=!1;for(const r of Gt(e.component.selection??{})){const i=r.name,o=V(i+fl);if(t.filter(a=>a.name===i).length===0){const a=r.resolve==="global"?"union":r.resolve,u=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${KU}(${o}, ${V(a)}${u}`})}n=!0;for(const a of Sx)a.defined(r)&&a.topLevelSignals&&(t=a.topLevelSignals(e,r,t))}return n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),z3(t)}function Ive(e,t){const n=[...t],r=zu(e,{escape:!1});for(const i of Gt(e.component.selection??{})){const o={name:i.name+fl};if(i.project.hasSelectionId&&(o.transform=[{type:"collect",sort:{field:Mi}}]),i.init){const a=i.project.items.map(DU);o.values=i.project.hasSelectionId?i.init.map(u=>({unit:r,[Mi]:cl(u,!1)[0]})):i.init.map(u=>({unit:r,fields:a,values:cl(u,!1)}))}n.filter(a=>a.name===i.name+fl).length||n.push(o)}return n}function RU(e,t){for(const n of Gt(e.component.selection??{}))for(const r of Sx)r.defined(n)&&r.marks&&(t=r.marks(e,n,t));return t}function jve(e,t){for(const n of e.children)ht(n)&&(t=RU(n,t));return t}function Bve(e,t,n,r){const i=nW(e,t.param,t);return{signal:Cr(n.get("type"))&&I(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}function z3(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class Ue{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){U(Gme);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this);const r=t.parent.removeChild(t);this._parent=n,n.addChild(this,r),t.parent=this}}class On extends Ue{clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${Rj()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class ao extends Ue{clone(){return new ao(null,fe(this.formula))}constructor(t,n){super(t),this.formula=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o)=>{const{field:s,timeUnit:a}=o;if(a){const u=Y(o,{forAs:!0});i[ke({as:u,field:s,timeUnit:a})]={as:u,field:s,timeUnit:a}}return i},{});return Ie(r)?null:new ao(t,r)}static makeFromTransform(t,n){const{timeUnit:r,...i}={...n},o=Qt(r),s={...i,timeUnit:o};return new ao(t,{[ke(s)]:s})}merge(t){this.formula={...this.formula};for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[r,i]of $a(this.formula))t.has(i.as)||(n[r]=i);this.formula=n}producedFields(){return new Set(Gt(this.formula).map(t=>t.as))}dependentFields(){return new Set(Gt(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${ke(this.formula)}`}assemble(){const t=[];for(const n of Gt(this.formula)){const{field:r,as:i,timeUnit:o}=n,{unit:s,utc:a,...u}=Qt(o);t.push({field:Yr(r),type:"timeunit",...s?{units:sx(s)}:{},...a?{timezone:"utc"}:{},...u,as:[i,`${i}_end`]})}return t}}const wg="_tuple_fields";class Uve{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const Wve={defined:()=>!0,parse:(e,t,n)=>{const r=t.name,i=t.project??(t.project=new Uve),o={},s={},a=new Set,u=(p,g)=>{const y=g==="visual"?p.channel:p.field;let m=et(`${r}_${y}`);for(let v=1;a.has(m);v++)m=et(`${r}_${y}_${v}`);return a.add(m),{[g]:m}},l=t.type,c=e.config.selection[l],f=n.value!==void 0?K(n.value):null;let{fields:d,encodings:h}=J(n.select)?n.select:{};if(!d&&!h&&f){for(const p of f)if(J(p))for(const g of B(p))lme(g)?(h||(h=[])).push(g):l==="interval"?(U(Wme),h=c.encodings):(d??(d=[])).push(g)}!d&&!h&&(h=c.encodings,"fields"in c&&(d=c.fields));for(const p of h??[]){const g=e.fieldDef(p);if(g){let y=g.field;if(g.aggregate){U(Rme(p,g.aggregate));continue}else if(!y){U(SD(p));continue}if(g.timeUnit){y=e.vgField(p);const m={timeUnit:g.timeUnit,as:y,field:g.field};s[ke(m)]=m}if(!o[y]){const m=l==="interval"&&Es(p)&&Cr(e.getScaleComponent(p).get("type"))?"R":g.bin?"R-RE":"E",v={field:y,channel:p,type:m,index:i.items.length};v.signals={...u(v,"data"),...u(v,"visual")},i.items.push(o[y]=v),i.hasField[y]=o[y],i.hasSelectionId=i.hasSelectionId||y===Mi,Bj(p)?(v.geoChannel=p,v.channel=jj(p),i.hasChannel[v.channel]=o[y]):i.hasChannel[p]=o[y]}}else U(SD(p))}for(const p of d??[]){if(i.hasField[p])continue;const g={type:"E",field:p,index:i.items.length};g.signals={...u(g,"data")},i.items.push(g),i.hasField[p]=g,i.hasSelectionId=i.hasSelectionId||p===Mi}f&&(t.init=f.map(p=>i.items.map(g=>J(p)?p[g.geoChannel||g.channel]!==void 0?p[g.geoChannel||g.channel]:p[g.field]:p))),Ie(s)||(i.timeUnit=new ao(null,s))},signals:(e,t,n)=>{const r=t.name+wg;return n.filter(o=>o.name===r).length>0||t.project.hasSelectionId?n:n.concat({name:r,value:t.project.items.map(DU)})}},is={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!Es(i))continue;const o=e.getScaleComponent(i),s=o?o.get("type"):void 0;if(!o||!Cr(s)){U(zme);continue}o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(s=>n.filter(a=>a.name===s.signals.data).length===0);if(!e.parent||KD(e)||r.length===0)return n;const i=n.filter(s=>s.name===t.name)[0];let o=i.update;if(o.indexOf(KU)>=0)i.update=`{${r.map(s=>`${V(Yr(s.field))}: ${s.signals.data}`).join(", ")}}`;else{for(const s of r){const a=`${V(Yr(s.field))}: ${s.signals.data}`;o.includes(a)||(o=`${o.substring(0,o.length-1)}, ${a}}`)}i.update=o}return n.concat(r.map(s=>({name:s.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!KD(e))for(const r of t.scales){const i=n.filter(o=>o.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function FS(e,t){return`domain(${V(e.scaleName(t))})`}function KD(e){return e.parent&&Yf(e.parent)&&!e.parent.parent}const Tc="_brush",PU="_scale_trigger",_d="geo_interval_init_tick",LU="_init",qve="_center",Hve={defined:e=>e.type==="interval",parse:(e,t,n)=>{var r;if(e.hasProjection){const i={...J(n.select)?n.select:{}};i.fields=[Mi],i.encodings||(i.encodings=n.value?B(n.value):[zi,Li]),n.select={type:"interval",...i}}if(t.translate&&!is.defined(t)){const i=`!event.item || event.item.mark.name !== ${V(t.name+Tc)}`;for(const o of t.events){if(!o.between){U(`${o} is not an ordered event stream for interval selections.`);continue}const s=K((r=o.between[0]).filter??(r.filter=[]));s.indexOf(i)<0&&s.push(i)}}},signals:(e,t,n)=>{const r=t.name,i=r+Fa,o=Gt(t.project.hasChannel).filter(a=>a.channel===tt||a.channel===Rt),s=t.init?t.init[0]:null;if(n.push(...o.reduce((a,u)=>a.concat(Vve(e,t,u,s&&s[u.index])),[])),e.hasProjection){const a=V(e.projectionName()),u=e.projectionName()+qve,{x:l,y:c}=t.project.hasChannel,f=l&&l.signals.visual,d=c&&c.signals.visual,h=l?s&&s[l.index]:`${u}[0]`,p=c?s&&s[c.index]:`${u}[1]`,g=w=>e.getSizeSignalRef(w).signal,y=`[[${f?f+"[0]":"0"}, ${d?d+"[0]":"0"}],[${f?f+"[1]":g("width")}, ${d?d+"[1]":g("height")}]]`;s&&(n.unshift({name:r+LU,init:`[scale(${a}, [${l?h[0]:h}, ${c?p[0]:p}]), scale(${a}, [${l?h[1]:h}, ${c?p[1]:p}])]`}),(!l||!c)&&(n.find(S=>S.name===u)||n.unshift({name:u,update:`invert(${a}, [${g("width")}/2, ${g("height")}/2])`})));const m=`intersect(${y}, {markname: ${V(e.getName("marks"))}}, unit.mark)`,v=`{unit: ${zu(e)}}`,x=`vlSelectionTuples(${m}, ${v})`,b=o.map(w=>w.signals.visual);return n.concat({name:i,on:[{events:[...b.length?[{signal:b.join(" || ")}]:[],...s?[{signal:_d}]:[]],update:x}]})}else{if(!is.defined(t)){const l=r+PU,c=o.map(f=>{const d=f.channel,{data:h,visual:p}=f.signals,g=V(e.scaleName(d)),y=e.getScaleComponent(d).get("type"),m=Cr(y)?"+":"";return`(!isArray(${h}) || (${m}invert(${g}, ${p})[0] === ${m}${h}[0] && ${m}invert(${g}, ${p})[1] === ${m}${h}[1]))`});c.length&&n.push({name:l,value:{},on:[{events:o.map(f=>({scale:e.scaleName(f.channel)})),update:c.join(" && ")+` ? ${l} : {}`}]})}const a=o.map(l=>l.signals.data),u=`unit: ${zu(e)}, fields: ${r+wg}, values`;return n.concat({name:i,...s?{init:`{${u}: ${cl(s)}}`}:{},...a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${u}: [${a}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(ht(e)&&e.hasProjection&&t.init&&(n.filter(i=>i.name===_d).length||n.unshift({name:_d,value:null,on:[{events:"timer{1}",update:`${_d} === null ? {} : ${_d}`}]})),n),marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,s=i==null?void 0:i.signals.visual,a=o==null?void 0:o.signals.visual,u=`data(${V(t.name+fl)})`;if(is.defined(t)||!i&&!o)return n;const l={x:i!==void 0?{signal:`${s}[0]`}:{value:0},y:o!==void 0?{signal:`${a}[0]`}:{value:0},x2:i!==void 0?{signal:`${s}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const g of B(l))l[g]=[{test:`${u}.length && ${u}[0].unit === ${zu(e)}`,...l[g]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=t.mark,p=B(h).reduce((g,y)=>(g[y]=[{test:[i!==void 0&&`${s}[0] !== ${s}[1]`,o!==void 0&&`${a}[0] !== ${a}[1]`].filter(m=>m).join(" && "),value:h[y]},{value:null}],g),{});return[{name:`${r+Tc}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:l}},...n,{name:r+Tc,type:"rect",clip:!0,encode:{enter:{...d?{cursor:{value:d}}:{},fill:{value:"transparent"}},update:{...l,...p}}}]}};function Vve(e,t,n,r){const i=!e.hasProjection,o=n.channel,s=n.signals.visual,a=V(i?e.scaleName(o):e.projectionName()),u=d=>`scale(${a}, ${d})`,l=e.getSizeSignalRef(o===tt?"width":"height").signal,c=`${o}(unit)`,f=t.events.reduce((d,h)=>[...d,{events:h.between[0],update:`[${c}, ${c}]`},{events:h,update:`[${s}[0], clamp(${c}, 0, ${l})]`}],[]);if(i){const d=n.signals.data,h=is.defined(t),p=e.getScaleComponent(o),g=p?p.get("type"):void 0,y=r?{init:cl(r,!0,u)}:{value:[]};return f.push({events:{signal:t.name+PU},update:Cr(g)?`[${u(`${d}[0]`)}, ${u(`${d}[1]`)}]`:"[0, 0]"}),h?[{name:d,on:[]}]:[{name:s,...y,on:f},{name:d,...r?{init:cl(r)}:{},on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${a}, ${s})`}]}]}else{const d=o===tt?0:1,h=t.name+LU,p=r?{init:`[${h}[0][${d}], ${h}[1][${d}]]`}:{value:[]};return[{name:s,...p,on:f}]}}const Gve={defined:e=>e.type==="point",signals:(e,t,n)=>{const r=t.name,i=r+wg,o=t.project,s="(item().isVoronoi ? datum.datum : datum)",a=Gt(e.component.selection??{}).reduce((f,d)=>d.type==="interval"?f.concat(d.name+Tc):f,[]).map(f=>`indexof(item().mark.name, '${f}') < 0`).join(" && "),u=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${a?` && ${a}`:""}`;let l=`unit: ${zu(e)}, `;if(t.project.hasSelectionId)l+=`${Mi}: ${s}[${V(Mi)}]`;else{const f=o.items.map(d=>{const h=e.fieldDef(d.channel);return h!=null&&h.bin?`[${s}[${V(e.vgField(d.channel,{}))}], ${s}[${V(e.vgField(d.channel,{binSuffix:"end"}))}]]`:`${s}[${V(d.field)}]`}).join(", ");l+=`fields: ${i}, values: [${f}]`}const c=t.events;return n.concat([{name:r+Fa,on:c?[{events:c,update:`${u} ? {${l}} : null`,force:!0}]:[]}])}};function qf(e,t,n,r){const i=hx(t)&&t.condition,o=r(t);if(i){const a=K(i).map(u=>{const l=r(u);if(U1e(u)){const{param:c,empty:f}=u;return{test:tW(e,{param:c,empty:f}),...l}}else return{test:hy(e,u.test),...l}});return{[n]:[...a,...o!==void 0?[o]:[]]}}else return o!==void 0?{[n]:o}:{}}function I3(e,t="text"){const n=e.encoding[t];return qf(e,n,t,r=>Ex(r,e.config))}function Ex(e,t,n="datum"){if(e){if(Fi(e))return Qe(e.value);if(ce(e)){const{format:r,formatType:i}=sy(e);return v3({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function zU(e,t={}){const{encoding:n,markDef:r,config:i,stack:o}=e,s=n.tooltip;if(I(s))return{tooltip:JD({tooltip:s},o,i,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return qf(e,s,"tooltip",u=>{const l=Ex(u,i,a);if(l)return l;if(u===null)return;let c=Pe("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),Q(c))return{value:c};if(J(c))return re(c)?c:c.content==="encoding"?JD(n,o,i,t):{signal:a}})}}function IU(e,t,n,{reactiveGeom:r}={}){const i={},o=r?"datum.datum":"datum",s=[];function a(l,c){const f=Cl(c),d=Rn(l)?l:{...l,type:e[f].type},h=d.title||E3(d,n),p=K(h).join(", ");let g;if(Pt(c)){const y=c==="x"?"x2":"y2",m=yo(e[y]);if(Ut(d.bin)&&m){const v=Y(d,{expr:o}),x=Y(m,{expr:o}),{format:b,formatType:w}=sy(d);g=mg(v,x,b,w,n),i[y]=!0}}if((Pt(c)||c===Kr||c===Pi)&&t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:y,formatType:m}=sy(d);g=v3({fieldOrDatumDef:d,format:y,formatType:m,expr:o,config:n,normalizeStack:!0}).signal}g??(g=Ex(d,n,o).signal),s.push({channel:c,key:p,value:g})}k3(e,(l,c)=>{H(l)?a(l,c):px(l)&&a(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of s)!i[l]&&!u[c]&&(u[c]=f);return u}function JD(e,t,n,{reactiveGeom:r}={}){const i=IU(e,t,n,{reactiveGeom:r}),o=$a(i).map(([s,a])=>`"${s}": ${a}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function Yve(e){const{markDef:t,config:n}=e,r=Pe("aria",t,n);return r===!1?{}:{...r?{aria:r}:{},...Xve(e),...Qve(e)}}function Xve(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=Pe("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in Mme?{}:{ariaRoleDescription:{value:t}}}function Qve(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return qf(e,o,"description",u=>Ex(u,e.config));const s=Pe("description",n,r);if(s!=null)return{description:Qe(s)};if(r.aria===!1)return{};const a=IU(t,i,r);if(!Ie(a))return{description:{signal:$a(a).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function At(e,t,n={}){const{markDef:r,encoding:i,config:o}=t,{vgChannel:s}=n;let{defaultRef:a,defaultValue:u}=n;a===void 0&&(u??(u=Pe(e,r,o,{vgChannel:s,ignoreVgConfig:!0})),u!==void 0&&(a=Qe(u)));const l=i[e];return qf(t,l,s??e,c=>y3({channel:e,channelDef:c,markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function jU(e,t={filled:void 0}){const{markDef:n,encoding:r,config:i}=e,{type:o}=n,s=t.filled??Pe("filled",n,i),a=we(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,u=Pe(s===!0?"color":void 0,n,i,{vgChannel:"fill"})??i.mark[s===!0&&"color"]??a,l=Pe(s===!1?"color":void 0,n,i,{vgChannel:"stroke"})??i.mark[s===!1&&"color"],c=s?"fill":"stroke",f={...u?{fill:Qe(u)}:{},...l?{stroke:Qe(l)}:{}};return n.color&&(s?n.fill:n.stroke)&&U(lB("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...At("color",e,{vgChannel:c,defaultValue:s?u:l}),...At("fill",e,{defaultValue:r.fill?u:void 0}),...At("stroke",e,{defaultValue:r.stroke?l:void 0})}}function Kve(e){const{encoding:t,mark:n}=e,r=t.order;return!Xa(n)&&Fi(r)?qf(e,r,"zindex",i=>Qe(i.value)):{}}function bp({channel:e,markDef:t,encoding:n={},model:r,bandPosition:i}){const o=`${e}Offset`,s=t[o],a=n[o];if((o==="xOffset"||o==="yOffset")&&a)return{offsetType:"encoding",offset:y3({channel:o,channelDef:a,markDef:t,config:r==null?void 0:r.config,scaleName:r.scaleName(o),scale:r.getScaleComponent(o),stack:null,defaultRef:Qe(s),bandPosition:i})};const u=t[o];return u?{offsetType:"visual",offset:u}:{}}function cn(e,t,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:o,config:s,stack:a}=t,u=i[e],l=i[Ao(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:h}=bp({channel:e,markDef:o,encoding:i,model:t,bandPosition:.5}),p=j3({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!u&&Pt(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:Jve({channel:e,channelDef:u,channel2Def:l,markDef:o,config:s,scaleName:c,scale:f,stack:a,offset:d,defaultRef:p,bandPosition:h==="encoding"?0:void 0});return g?{[r||e]:g}:void 0}function Jve(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:s}=e;if(ce(n)&&i&&t===i.fieldChannel){if(H(n)){let a=n.bandPosition;if(a===void 0&&s.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return ry({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:o})}return Pu(n,r,{suffix:"end"},{offset:o})}return g3(e)}function j3({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:o,config:s}=e;return()=>{const a=Cl(n),u=Ca(n),l=Pe(n,o,s,{vgChannel:u});if(l!==void 0)return Ch(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!we([er.LOG,er.TIME,er.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return a==="y"?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":return{...e[ur(n)],mult:.5}}}}const Zve={left:"x",center:"xc",right:"x2"},exe={top:"y",middle:"yc",bottom:"y2"};function BU(e,t,n,r="middle"){if(e==="radius"||e==="theta")return Ca(e);const i=e==="x"?"align":"baseline",o=Pe(i,t,n);let s;return re(o)?(U(c0e(i)),s=void 0):s=o,e==="x"?Zve[s||(r==="top"?"left":"center")]:exe[s||r]}function fy(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?UU(e,t,{defaultPos:n,defaultPos2:r}):cn(e,t,{defaultPos:n})}function UU(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=t,s=Ao(e),a=ur(e),u=txe(t,r,s),l=u[a]?BU(e,i,o):Ca(e);return{...cn(e,t,{defaultPos:n,vgChannel:l}),...u}}function txe(e,t,n){const{encoding:r,mark:i,markDef:o,stack:s,config:a}=e,u=Cl(n),l=ur(n),c=Ca(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),{offset:p}=n in r||n in o?bp({channel:n,markDef:o,encoding:r,model:e}):bp({channel:u,markDef:o,encoding:r,model:e});if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude)){const y=ur(n),m=e.markDef[y];return m!=null?{[y]:{value:m}}:{[c]:{field:e.getName(n)}}}const g=nxe({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:a,scaleName:d,scale:h,stack:s,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:vm(n,o)||vm(n,{[n]:ey(n,o,a.style),[l]:ey(l,o,a.style)})||vm(n,a[i])||vm(n,a.mark)||{[c]:j3({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function nxe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l}){return ce(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Pu(t,o,{suffix:"start"},{offset:u}):g3({channel:e,channelDef:n,scaleName:o,scale:s,stack:a,markDef:r,config:i,offset:u,defaultRef:l})}function vm(e,t){const n=ur(e),r=Ca(e);if(t[r]!==void 0)return{[r]:Ch(e,t[r])};if(t[e]!==void 0)return{[r]:Ch(e,t[e])};if(t[n]){const i=t[n];if(ul(i))U(r0e(n));else return{[n]:Ch(e,i)}}}function Ta(e,t){const{config:n,encoding:r,markDef:i}=e,o=i.type,s=Ao(t),a=ur(t),u=r[t],l=r[s],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=i.orient,h=r[a]??r.size??Pe("size",i,n,{vgChannel:a}),p=o==="bar"&&(t==="x"?d==="vertical":d==="horizontal");return H(u)&&(Ge(u.bin)||Ut(u.bin)||u.timeUnit&&!l)&&!(h&&!ul(h))&&!Lt(f)?oxe({fieldDef:u,fieldDef2:l,channel:t,model:e}):(ce(u)&&Lt(f)||p)&&!l?ixe(u,t,e):UU(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function rxe(e,t,n,r,i){if(ul(i))if(n){const s=n.get("type");if(s==="band"){let a=`bandwidth('${t}')`;return i.band!==1&&(a=`${i.band} * ${a}`),{signal:`max(0.25, ${a})`}}else i.band!==1&&(U(p0e(s)),i=void 0)}else return{mult:i.band,field:{group:e}};else{if(re(i))return i;if(i)return{value:i}}if(n){const s=n.get("range");if(Ya(s)&&je(s.step))return{value:s.step-2}}return{value:ly(r.view,e)-2}}function ixe(e,t,n){const{markDef:r,encoding:i,config:o,stack:s}=n,a=r.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=ur(t),f=Ao(t),d=fme(t),h=n.scaleName(d),p=a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let g;(i.size||r.size)&&(p?g=At("size",n,{vgChannel:c,defaultRef:Qe(r.size)}):U(v0e(r.type)));const y=!!g,m=UB({channel:t,fieldDef:e,markDef:r,config:o,scaleType:l==null?void 0:l.get("type"),useVlSizeChannel:p});g=g||{[c]:rxe(c,h||u,l,o,m)};const v=(l==null?void 0:l.get("type"))==="band"&&ul(m)&&!y?"top":"middle",x=BU(t,r,o,v),b=x==="xc"||x==="yc",{offset:w,offsetType:S}=bp({channel:t,markDef:r,encoding:i,model:n,bandPosition:b?.5:0}),E=g3({channel:t,channelDef:e,markDef:r,config:o,scaleName:u,scale:l,stack:s,offset:w,defaultRef:j3({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:b?S==="encoding"?0:.5:re(m)?{signal:`(1-${m})/2`}:ul(m)?(1-m.band)/2:0});if(c)return{[x]:E,...g};{const _=Ca(f),$=g[c],k=w?{...$,offset:w}:$;return{[x]:E,[_]:I(E)?[E[0],{...E[1],offset:k}]:{...E,offset:k}}}}function kd(e,t,n,r,i){if(Ij(e))return 0;const o=e==="x"||e==="y2"?-t/2:t/2;if(re(n)||re(i)||re(r)){const s=rs(n),a=rs(i),u=rs(r),l=u?`${u} + `:"",c=s?`(${s} ? -1 : 1) * `:"",f=a?`(${a} + ${o})`:o;return{signal:l+c+f}}else return i=i||0,r+(n?-i-o:+i+o)}function oxe({fieldDef:e,fieldDef2:t,channel:n,model:r}){var b;const{config:i,markDef:o,encoding:s}=r,a=r.getScaleComponent(n),u=r.scaleName(n),l=a?a.get("type"):void 0,c=a.get("reverse"),f=UB({channel:n,fieldDef:e,markDef:o,config:i,scaleType:l}),d=(b=r.component.axes[n])==null?void 0:b[0],h=(d==null?void 0:d.get("translate"))??.5,p=Pt(n)?Pe("binSpacing",o,i)??0:0,g=Ao(n),y=Ca(n),m=Ca(g),{offset:v}=bp({channel:n,markDef:o,encoding:s,model:r,bandPosition:0}),x=re(f)?{signal:`(1-${f.signal})/2`}:ul(f)?(1-f.band)/2:.5;if(Ge(e.bin)||e.timeUnit)return{[m]:ZD({fieldDef:e,scaleName:u,bandPosition:x,offset:kd(g,p,c,h,v)}),[y]:ZD({fieldDef:e,scaleName:u,bandPosition:re(x)?{signal:`1-${x.signal}`}:1-x,offset:kd(n,p,c,h,v)})};if(Ut(e.bin)){const w=Pu(e,u,{},{offset:kd(g,p,c,h,v)});if(H(t))return{[m]:w,[y]:Pu(t,u,{},{offset:kd(n,p,c,h,v)})};if(Al(e.bin)&&e.bin.step)return{[m]:w,[y]:{signal:`scale("${u}", ${Y(e,{expr:"datum"})} + ${e.bin.step})`,offset:kd(n,p,c,h,v)}}}U(dB(g))}function ZD({fieldDef:e,scaleName:t,bandPosition:n,offset:r}){return ry({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:r})}const sxe=new Set(["aria","width","height"]);function Jr(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?jU(e):{};return{...axe(e.markDef,t),...eR(e,"fill",n),...eR(e,"stroke",r),...At("opacity",e),...At("fillOpacity",e),...At("strokeOpacity",e),...At("strokeWidth",e),...At("strokeDash",e),...Kve(e),...zU(e),...I3(e,"href"),...Yve(e)}}function eR(e,t,n){const{config:r,mark:i,markDef:o}=e;if(Pe("invalid",o,r)==="hide"&&n&&!Xa(i)){const a=uxe(e,{invalid:!0,channels:rx});if(a)return{[t]:[{test:a,value:null},...K(n)]}}return n?{[t]:n}:{}}function axe(e,t){return Fme.reduce((n,r)=>(!sxe.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=Qe(e[r])),n),{})}function uxe(e,{invalid:t=!1,channels:n}){const r=n.reduce((o,s)=>{const a=e.getScaleComponent(s);if(a){const u=a.get("type"),l=e.vgField(s,{expr:"datum"});l&&Cr(u)&&(o[l]=!0)}return o},{}),i=B(r);if(i.length>0){const o=t?"||":"&&";return i.map(s=>m3(s,t)).join(` ${o} `)}}function B3(e){const{config:t,markDef:n}=e;if(Pe("invalid",n,t)){const i=lxe(e,{channels:To});if(i)return{defined:{signal:i}}}return{}}function lxe(e,{invalid:t=!1,channels:n}){const r=n.reduce((o,s)=>{var u;const a=e.getScaleComponent(s);if(a){const l=a.get("type"),c=e.vgField(s,{expr:"datum",binSuffix:(u=e.stack)!=null&&u.impute?"mid":void 0});c&&Cr(l)&&(o[c]=!0)}return o},{}),i=B(r);if(i.length>0){const o=t?"||":"&&";return i.map(s=>m3(s,t)).join(` ${o} `)}}function tR(e,t){if(t!==void 0)return{[e]:Qe(t)}}const wb="voronoi",WU={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(wb)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(Xa(o))return U(Pme(o)),n;const s={name:e.getName(wb),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...zU(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{const f=l.name??"";f===e.component.mark[0].name?a=c:f.indexOf(wb)>=0&&(u=!0)}),u||n.splice(a+1,0,s),n}},qU={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!M3(e.bind),parse:(e,t,n)=>JU(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,s=t.init&&t.init[0],a=WU.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{const c=et(`${r}_${u.field}`);n.filter(d=>d.name===c).length||n.unshift({name:c,...s?{init:cl(s[l])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${V(u.field)}] : null`}]:[],bind:o[u.field]??o[u.channel]??o})}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.filter(l=>l.name===r+Fa)[0],s=r+wg,a=i.items.map(l=>et(`${r}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(o.update=`${u} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}},dy="_toggle",HU={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+dy,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Fa,r=t.name+dy;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${zu(e)}}, `)+`${r} ? ${n} : null`}},cxe={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=Q(t.clear)?Ba(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(qU.defined(t))for(const r of t.project.items){const i=n.findIndex(o=>o.name===et(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,o){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:o})}if(t.type==="interval")for(const i of t.project.items){const o=n.findIndex(s=>s.name===i.signals.visual);if(r(o,"[0, 0]"),o===-1){const s=n.findIndex(a=>a.name===i.signals.data);r(s,"null")}}else{let i=n.findIndex(o=>o.name===t.name+Fa);r(i,"null"),HU.defined(t)&&(i=n.findIndex(o=>o.name===t.name+dy),r(i,"false"))}return n}},VU={defined:e=>{const t=e.resolve==="global"&&e.bind&&M3(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Mi;return t&&!n&&U(Ime),t&&n},parse:(e,t,n)=>{const r=fe(n);if(r.select=Q(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},JU(t,r),J(n.select)&&(n.select.on||n.select.clear)){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const a of t.events)a.filter=K(a.filter??[]),a.filter.includes(s)||a.filter.push(s)}const i=vb(t.bind)?t.bind.legend:"click",o=Q(i)?Ba(i,"view"):K(i);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=vb(t.bind)&&t.bind.legend,o=s=>a=>{const u=fe(a);return u.markname=s,u};for(const s of t.project.items){if(!s.hasLegend)continue;const a=`${et(s.field)}_legend`,u=`${r}_${a}`;if(n.filter(c=>c.name===u).length===0){const c=i.merge.map(o(`${a}_symbols`)).concat(i.merge.map(o(`${a}_labels`))).concat(i.merge.map(o(`${a}_entries`)));n.unshift({name:u,...t.init?{}:{value:null},on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]})}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find(d=>d.name===r+Fa),s=r+wg,a=i.items.filter(d=>d.hasLegend).map(d=>et(`${r}_${et(d.field)}_legend`)),l=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?o.on.push({events:a.map(d=>({signal:d})),update:l}):a.length>0&&(o.update=l,delete o.value,delete o.on);const c=n.find(d=>d.name===r+dy),f=vb(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push({...c.on[0],events:f}):c.on[0].events=f),n}};function fxe(e,t,n){var i;const r=(i=e.fieldDef(t))==null?void 0:i.field;for(const o of Gt(e.component.selection??{})){const s=o.project.hasField[r]??o.project.hasChannel[t];if(s&&VU.defined(o)){const a=n.get("selections")??[];a.push(o.name),n.set("selections",a,!1),s.hasLegend=!0}}}const GU="_translate_anchor",YU="_translate_delta",dxe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=is.defined(t),o=r+GU,{x:s,y:a}=t.project.hasChannel;let u=Ba(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+Tc,l))),n.push({name:o,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(s!==void 0?`, extent_x: ${i?FS(e,tt):`slice(${s.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${i?FS(e,Rt):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:r+YU,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),s!==void 0&&nR(e,t,s,"width",n),a!==void 0&&nR(e,t,a,"height",n),n}};function nR(e,t,n,r,i){const o=t.name,s=o+GU,a=o+YU,u=n.channel,l=is.defined(t),c=i.filter(w=>w.name===n.signals[l?"data":"visual"])[0],f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(u),h=d&&d.get("type"),p=d&&d.get("reverse"),g=l?u===tt?p?"":"-":p?"-":"":"",y=`${s}.extent_${u}`,m=`${g}${a}.${u} / ${l?`${f}`:`span(${y})`}`,v=!l||!d?"panLinear":h==="log"?"panLog":h==="symlog"?"panSymlog":h==="pow"?"panPow":"panLinear",x=l?h==="pow"?`, ${d.get("exponent")??1}`:h==="symlog"?`, ${d.get("constant")??1}`:"":"",b=`${v}(${y}, ${m}${x})`;c.on.push({events:{signal:a},update:l?b:`clampRange(${b}, 0, ${f})`})}const XU="_zoom_anchor",QU="_zoom_delta",hxe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=is.defined(t),o=r+QU,{x:s,y:a}=t.project.hasChannel,u=V(e.scaleName(tt)),l=V(e.scaleName(Rt));let c=Ba(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+Tc,f))),n.push({name:r+XU,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),s!==void 0&&rR(e,t,s,"width",n),a!==void 0&&rR(e,t,a,"height",n),n}};function rR(e,t,n,r,i){const o=t.name,s=n.channel,a=is.defined(t),u=i.filter(v=>v.name===n.signals[a?"data":"visual"])[0],l=e.getSizeSignalRef(r).signal,c=e.getScaleComponent(s),f=c&&c.get("type"),d=a?FS(e,s):u.name,h=o+QU,p=`${o}${XU}.${s}`,g=!a||!c?"zoomLinear":f==="log"?"zoomLog":f==="symlog"?"zoomSymlog":f==="pow"?"zoomPow":"zoomLinear",y=a?f==="pow"?`, ${c.get("exponent")??1}`:f==="symlog"?`, ${c.get("constant")??1}`:"":"",m=`${g}(${d}, ${p}, ${h}${y})`;u.on.push({events:{signal:h},update:a?m:`clampRange(${m}, 0, ${l})`})}const fl="_store",Fa="_tuple",pxe="_modify",KU="vlSelectionResolve",Sx=[Gve,Hve,Wve,HU,qU,is,VU,cxe,dxe,hxe,WU];function gxe(e){let t=e.parent;for(;t&&!ki(t);)t=t.parent;return t}function zu(e,{escape:t}={escape:!0}){let n=t?V(e.name):e.name;const r=gxe(e);if(r){const{facet:i}=r;for(const o of zr)i[o]&&(n+=` + '__facet_${o}_' + (facet[${V(r.vgField(o))}])`)}return n}function U3(e){return Gt(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function JU(e,t){(Q(t.select)||!t.select.on)&&delete e.events,(Q(t.select)||!t.select.clear)&&delete e.clear,(Q(t.select)||!t.select.toggle)&&delete e.toggle}function MS(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...MS(e.object)),t.push(...MS(e.property))),t)}function ZU(e){return e.object.type==="MemberExpression"?ZU(e.object):e.object.name==="datum"}function eW(e){const t=aA(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&ZU(r)&&n.add(MS(r).slice(1).join("."))}),n}class Hf extends Ue{clone(){return new Hf(null,this.model,fe(this.filter))}constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=hy(this.model,this.filter,this),this._dependentFields=eW(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function mxe(e,t){const n={},r=e.config.selection;if(!t||!t.length)return n;for(const i of t){const o=et(i.name),s=i.select,a=Q(s)?s:s.type,u=J(s)?fe(s):{type:a},l=r[a];for(const d in l)d==="fields"||d==="encodings"||(d==="mark"&&(u[d]={...l[d],...u[d]}),(u[d]===void 0||u[d]===!0)&&(u[d]=fe(l[d]??u[d])));const c=n[o]={...u,name:o,type:a,init:i.value,bind:i.bind,events:Q(u.on)?Ba(u.on,"scope"):K(fe(u.on))},f=fe(i);for(const d of Sx)d.defined(c)&&d.parse&&d.parse(e,c,f)}return n}function tW(e,t,n,r="datum"){const i=Q(t)?t:t.param,o=et(i),s=V(o+fl);let a;try{a=e.getSelectionComponent(o,i)}catch{return`!!${o}`}if(a.project.timeUnit){const d=n??e.component.data.raw,h=a.project.timeUnit.clone();d.parent?h.insertAsParentOf(d):d.parent=h}const u=a.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",l=a.resolve==="global"?")":`, ${V(a.resolve)})`,c=`${u}${s}, ${r}${l}`,f=`length(data(${s}))`;return t.empty===!1?`${f} && ${c}`:`!${f} || ${c}`}function nW(e,t,n){const r=et(t),i=n.encoding;let o=n.field,s;try{s=e.getSelectionComponent(r,t)}catch{return r}if(!i&&!o)o=s.project.items[0].field,s.project.items.length>1&&U(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${V(o)}.`);else if(i&&!o){const a=s.project.items.filter(u=>u.channel===i);!a.length||a.length>1?(o=s.project.items[0].field,U((a.length?"Multiple ":"No ")+`matching ${V(i)} encoding found for selection ${V(n.param)}. Using "field": ${V(o)}.`)):o=a[0].field}return`${s.name}[${V(Yr(o))}]`}function yxe(e,t){for(const[n,r]of $a(e.component.selection??{})){const i=e.getName(`lookup_${n}`);e.component.data.outputNodes[i]=r.materialized=new On(new Hf(t,e,{param:n}),i,qe.Lookup,e.component.data.outputNodeRefCounts)}}function hy(e,t,n){return $h(t,r=>Q(r)?r:e1e(r)?tW(e,r,n):bB(r))}function vxe(e,t){if(e)return I(e)&&!Ps(e)?e.map(n=>E3(n,t)).join(", "):e}function Eb(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function th(e,t,n,r={header:!1}){var f,d;const{disable:i,orient:o,scale:s,labelExpr:a,title:u,zindex:l,...c}=e.combine();if(!i){for(const h in c){const p=nye[h],g=c[h];if(p&&p!==t&&p!=="both")delete c[h];else if(bg(g)){const{condition:y,...m}=g,v=K(y),x=RD[h];if(x){const{vgProp:b,part:w}=x,S=[...v.map(E=>{const{test:_,...$}=E;return{test:hy(null,_),...$}}),m];Eb(c,w,b,S),delete c[h]}else if(x===null){const b={signal:v.map(w=>{const{test:S,...E}=w;return`${hy(null,S)} ? ${xD(E)} : `}).join("")+xD(m)};c[h]=b}}else if(re(g)){const y=RD[h];if(y){const{vgProp:m,part:v}=y;Eb(c,v,m,g),delete c[h]}}we(["labelAlign","labelBaseline"],h)&&c[h]===null&&delete c[h]}if(t==="grid"){if(!c.grid)return;if(c.encode){const{grid:h}=c.encode;c.encode={...h?{grid:h}:{}},Ie(c.encode)&&delete c.encode}return{scale:s,orient:o,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:mt(l,0)}}else{if(!r.header&&e.mainExtracted)return;if(a!==void 0){let p=a;(d=(f=c.encode)==null?void 0:f.labels)!=null&&d.update&&re(c.encode.labels.update.text)&&(p=rl(a,"datum.label",c.encode.labels.update.text.signal)),Eb(c,"labels","text",{signal:p})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(const p of KB)e.hasAxisPart(p)||delete c.encode[p];Ie(c.encode)&&delete c.encode}const h=vxe(u,n);return{scale:s,orient:o,grid:!1,...h?{title:h}:{},...c,...n.aria===!1?{aria:!1}:{},zindex:mt(l,0)}}}}function rW(e){const{axes:t}=e.component,n=[];for(const r of To)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const o=r==="x"?"height":"width",s=e.getSizeSignalRef(o).signal;o!==s&&n.push({name:o,update:s})}}return n}function xxe(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>th(i,"grid",t)),...r.map(i=>th(i,"grid",t)),...n.map(i=>th(i,"main",t)),...r.map(i=>th(i,"main",t))].filter(i=>i)}function iR(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const o=n==="x"?"bottom":"left",s=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...B(s),...B(a)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${o}" ? ${rs(s[c])} : ${rs(a[c])}`};return l}return t[i]})])}function bxe(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:_B(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",s=re(n)?"axisOrient":`axis${cg(n)}`,a=[...i,...i.map(l=>o+l.substr(4))],u=["axis",s,o];return{vlOnlyAxisConfig:iR(a,r,e,n),vgAxisConfig:iR(u,r,e,n),axisConfigStyle:wxe([...u,...a],r)}}function wxe(e,t){var r;const n=[{}];for(const i of e){let o=(r=t[i])==null?void 0:r.style;if(o){o=K(o);for(const s of o)n.push(t.style[s])}}return Object.assign.apply(null,n)}function OS(e,t,n,r={}){var o;const i=nB(e,n,t);if(i!==void 0)return{configFrom:"style",configValue:i};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((o=r[s])==null?void 0:o[e])!==void 0)return{configFrom:s,configValue:r[s][e]};return{}}const oR={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??Exe(n,e),gridScale:({model:e,channel:t})=>Sxe(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||oW(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||iW(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??kxe(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??$xe(t.type,n,H(t)&&!!t.timeUnit,H(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{const o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return n.tickCount??Axe({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},tickMinStep:Txe,title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=sW(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),o=n==="x"?"x2":"y2",s=t.fieldDef(o);return iB(i?[ND(i)]:[],H(s)?[ND(s)]:[])},values:({axis:e,fieldOrDatumDef:t})=>Fxe(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??Mxe(n,t)};function Exe(e,t){return!Lt(e)&&H(t)&&!Ge(t==null?void 0:t.bin)&&!Ut(t==null?void 0:t.bin)}function Sxe(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function _xe(e,t,n,r,i){const o=t==null?void 0:t.labelAngle;if(o!==void 0)return re(o)?o:vp(o);{const{configValue:s}=OS("labelAngle",r,t==null?void 0:t.style,i);return s!==void 0?vp(s):n===tt&&we([f3,c3],e.type)&&!(H(e)&&e.timeUnit)?270:void 0}}function NS(e){return`(((${e.signal} % 360) + 360) % 360)`}function iW(e,t,n,r){if(e!==void 0)if(n==="x"){if(re(e)){const i=NS(e),o=re(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(re(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(re(e)){const i=NS(e),o=re(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(re(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function oW(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,o=r?"bottom":"left";if(re(e)){const s=NS(e),a=re(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${i?`(${s} + 90)`:s} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${s} && ${s} < ${180+i}) === ${a} ? "left" : "right"`}}if((e+i)%180===0)return r?null:"center";if(re(t)){const s=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${s} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function kxe(e,t){if(t==="x"&&we(["quantitative","temporal"],e))return!0}function $xe(e,t,n,r){if(n&&!J(r)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function Cxe(e){return e==="x"?"bottom":"left"}function Axe({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!Lt(t)&&t!=="log"){if(H(e)){if(Ge(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&we(["month","hours","day","quarter"],(i=Qt(e.timeUnit))==null?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function Txe({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(H(t)){const{timeUnit:n}=t;if(n){const r=Qt(n),i=Q0e(r.unit);if(i&&i!=="day"){const o={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},s=r.step||1,a={...o,...i==="quarter"?{month:+o.month+s*3}:{[i]:+o[i]+s}};return{signal:`${sl(a)} - ${sl(o)}`}}}}}function sW(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,s=i?i.title:void 0;if(o&&s)return oB(o,s);if(o)return o;if(s)return s;if(o!==void 0)return o;if(s!==void 0)return s}function Fxe(e,t){const n=e.values;if(I(n))return QB(t,n);if(re(n))return n}function Mxe(e,t){return e==="rect"&&oy(t)?1:0}class yf extends Ue{clone(){return new yf(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=eW(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(Fl(r)&&jB(r.sort)){const{field:o,timeUnit:s}=r,a=r.sort,u=a.map((l,c)=>`${bB({field:o,timeUnit:s,equal:l})} ? ${c} : `).join("")+a.length;t=new yf(t,{calculate:u,as:vf(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${ke(this.transform)}`}}function vf(e,t,n){return Y(e,{prefix:t,suffix:"sort_index",...n??{}})}function _x(e,t){return we(["top","bottom"],t)?"column":we(["left","right"],t)||e==="row"?"row":"column"}function xf(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return mt((t||{})[e],i[e],n.header[e])}function kx(e,t,n,r){const i={};for(const o of e){const s=xf(o,t||{},n,r);s!==void 0&&(i[o]=s)}return i}const W3=["row","column"],q3=["header","footer"];function Oxe(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=kx(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),u=_x(t,a),l=vp(s);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...uW(l,u),...aW(u,l,o),...lW(r,i,t,_ye,hU)}}}function aW(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=oW(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function uW(e,t){const n=iW(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Nxe(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of q3)if(n[i])for(const o of n[i]){const s=Rxe(e,t,i,n,o);s!=null&&r.push(s)}return r}function Dxe(e,t){const{sort:n}=e;return so(n)?{field:Y(n,{expr:"datum"}),order:n.order??"ascending"}:I(n)?{field:vf(e,t,{expr:"datum"}),order:"ascending"}:{field:Y(e,{expr:"datum"}),order:n??"ascending"}}function DS(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:u}=kx(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=v3({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=_x(t,a);return{text:{signal:u?rl(rl(u,"datum.label",l),"datum.value",Y(e,{expr:"parent"})):l},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...uW(o,c),...aW(c,o,s),...lW(n,e,t,kye,pU)}}function Rxe(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:s}=r,a=e.config?e.config:void 0;if(s&&i.labels){const{labelOrient:f}=kx(["labelOrient"],s.header,a,t);(t==="row"&&!we(["top","bottom"],f)||t==="column"&&!we(["left","right"],f))&&(o=DS(s,t,a))}const u=ki(e)&&!yg(e.facet),l=i.axes,c=(l==null?void 0:l.length)>0;if(o||c){const f=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:Dxe(s,t)}:{},...c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{},...c?{axes:l}:{}}}}return null}const Pxe={column:{start:0,end:1},row:{start:1,end:0}};function Lxe(e,t){return Pxe[t][e]}function zxe(e,t){const n={};for(const r of zr){const i=e[r];if(i!=null&&i.facetFieldDef){const{titleAnchor:o,titleOrient:s}=kx(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),a=_x(r,s),u=Lxe(o,a);u!==void 0&&(n[a]=u)}}return Ie(n)?void 0:n}function lW(e,t,n,r,i){const o={};for(const s of r){if(!i[s])continue;const a=xf(s,t==null?void 0:t.header,e,n);a!==void 0&&(o[i[s]]=a)}return o}function H3(e){return[...xm(e,"width"),...xm(e,"height"),...xm(e,"childWidth"),...xm(e,"childHeight")]}function xm(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const o=e.getScaleComponent(n);if(o){const s=o.get("type"),a=o.get("range");if(Lt(s)&&Ya(a)){const u=e.scaleName(n);return ki(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[sR(u,a)]:[sR(u,a),{name:i,update:cW(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const o=i.endsWith("width"),s=o?"containerSize()[0]":"containerSize()[1]",a=$S(e.config.view,o?"width":"height"),u=`isFinite(${s}) ? ${s} : ${a}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function sR(e,t){const n=`${e}_step`;return re(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function cW(e,t,n){const r=t.get("type"),i=t.get("padding"),o=mt(t.get("paddingOuter"),i);let s=t.get("paddingInner");return s=r==="band"?s!==void 0?s:i:1,`bandspace(${n}, ${rs(s)}, ${rs(o)}) * ${e}_step`}function fW(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function dW(e,t){return B(e).reduce((n,r)=>{const i=e[r];return{...n,...qf(t,i,r,o=>Qe(o.value))}},{})}function hW(e,t){if(ki(t))return e==="theta"?"independent":"shared";if(Yf(t))return"shared";if(J3(t))return Pt(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function V3(e,t){const n=e.scale[t],r=Pt(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&U(S0e(t)),"independent"):e[r][t]||"shared"}const Ixe={...Aye,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},pW=B(Ixe);class jxe extends _s{}const aR={symbols:Bxe,gradient:Uxe,labels:Wxe,entries:qxe};function Bxe(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){if(o!=="symbol")return;const{markDef:s,encoding:a,config:u,mark:l}=n,c=s.filled&&l!=="trail";let f={...Nme({},n,k1e),...jU(n,{filled:c})};const d=i.get("symbolOpacity")??u.legend.symbolOpacity,h=i.get("symbolFillColor")??u.legend.symbolFillColor,p=i.get("symbolStrokeColor")??u.legend.symbolStrokeColor,g=d===void 0?gW(a.opacity)??s.opacity:void 0;if(f.fill){if(r==="fill"||c&&r===sr)delete f.fill;else if(f.fill.field)h?delete f.fill:(f.fill=Qe(u.legend.symbolBaseFillColor??"black"),f.fillOpacity=Qe(g??1));else if(I(f.fill)){const y=RS(a.fill??a.color)??s.fill??(c&&s.color);y&&(f.fill=Qe(y))}}if(f.stroke){if(r==="stroke"||!c&&r===sr)delete f.stroke;else if(f.stroke.field||p)delete f.stroke;else if(I(f.stroke)){const y=mt(RS(a.stroke||a.color),s.stroke,c?s.color:void 0);y&&(f.stroke={value:y})}}if(r!==ws){const y=H(t)&&yW(n,i,t);y?f.opacity=[{test:y,...Qe(g??1)},Qe(u.legend.unselectedOpacity)]:g&&(f.opacity=Qe(g))}return f={...f,...e},Ie(f)?void 0:f}function Uxe(e,{model:t,legendType:n,legendCmpt:r}){if(n!=="gradient")return;const{config:i,markDef:o,encoding:s}=t;let a={};const l=(r.get("gradientOpacity")??i.legend.gradientOpacity)===void 0?gW(s.opacity)||o.opacity:void 0;return l&&(a.opacity=Qe(l)),a={...a,...e},Ie(a)?void 0:a}function Wxe(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},s=n.config,a=H(t)?yW(n,i,t):void 0,u=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o;let f;ll(c)?f=xi({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:s}):l===void 0&&c===void 0&&s.customFormatTypes&&(t.type==="quantitative"&&s.numberFormatType?f=xi({fieldOrDatumDef:t,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):t.type==="temporal"&&s.timeFormatType&&H(t)&&t.timeUnit===void 0&&(f=xi({fieldOrDatumDef:t,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));const d={...u?{opacity:u}:{},...f?{text:f}:{},...e};return Ie(d)?void 0:d}function qxe(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?{...e,fill:{value:"transparent"}}:e}function gW(e){return mW(e,(t,n)=>Math.max(t,n.value))}function RS(e){return mW(e,(t,n)=>mt(t,n.value))}function mW(e,t){if(q1e(e))return K(e.condition).reduce(t,e.value);if(Fi(e))return e.value}function yW(e,t,n){const r=t.get("selections");if(!(r!=null&&r.length))return;const i=V(n.field);return r.map(o=>`(!length(data(${V(et(o)+fl)})) || (${o}[${i}] && indexof(${o}[${i}], datum.value) >= 0))`).join(" || ")}const uR={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return PB(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return LB(r,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??Kxe(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??Jxe(n),symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>e.symbolType??Vxe(t.type,n,r.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>Ac(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Cc(n)&&vi(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>Hxe(t,e)};function Hxe(e,t){const n=e.values;if(I(n))return QB(t,n);if(re(n))return n}function Vxe(e,t,n,r){if(t!=="shape"){const i=RS(n)??r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function Gxe(e){const{legend:t}=e;return mt(t.type,Yxe(e))}function Yxe({channel:e,timeUnit:t,scaleType:n}){if(Cc(e)){if(we(["quarter","month","day"],t))return"symbol";if(vi(n))return"gradient"}return"symbol"}function Xxe({legendConfig:e,legendType:t,orient:n,legend:r}){return r.direction??e[t?"gradientDirection":"symbolDirection"]??Qxe(n,t)}function Qxe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function Kxe({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(vi(i))return n==="horizontal"?r==="top"||r==="bottom"?lR(t,"width",s,o):s:lR(t,"height",u,a)}function lR(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function Jxe(e){if(we(["quantile","threshold","log","symlog"],e))return"greedy"}function vW(e){const t=ht(e)?Zxe(e):r2e(e);return e.component.legends=t,t}function Zxe(e){const{encoding:t}=e,n={};for(const r of[sr,...mU]){const i=Et(t[r]);!i||!e.getScaleComponent(r)||r===ar&&H(i)&&i.type===Wf||(n[r]=n2e(e,r))}return n}function e2e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function t2e(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function n2e(e,t){var b;let n=e.legend(t);const{markDef:r,encoding:i,config:o}=e,s=o.legend,a=new jxe({},e2e(e,t));fxe(e,t,a);const u=n!==void 0?!n:s.disable;if(a.set("disable",u,n!==void 0),u)return a;n=n||{};const l=e.getScaleComponent(t).get("type"),c=Et(i[t]),f=H(c)?(b=Qt(c.timeUnit))==null?void 0:b.unit:void 0,d=n.orient||o.legend.orient||"right",h=Gxe({legend:n,channel:t,timeUnit:f,scaleType:l}),p=Xxe({legend:n,legendType:h,orient:d,legendConfig:s}),g={legend:n,channel:t,model:e,markDef:r,encoding:i,fieldOrDatumDef:c,legendConfig:s,config:o,scaleType:l,orient:d,legendType:h,direction:p};for(const w of pW){if(h==="gradient"&&w.startsWith("symbol")||h==="symbol"&&w.startsWith("gradient"))continue;const S=w in uR?uR[w](g):n[w];if(S!==void 0){const E=t2e(S,w,n,e.fieldDef(t));(E||o.legend[w]===void 0)&&a.set(w,S,E)}}const y=(n==null?void 0:n.encoding)??{},m=a.get("selections"),v={},x={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:a,legendType:h};for(const w of["labels","legend","title","symbols","gradient","entries"]){const S=dW(y[w]??{},e),E=w in aR?aR[w](S,x):S;E!==void 0&&!Ie(E)&&(v[w]={...m!=null&&m.length&&H(c)?{name:`${et(c.field)}_legend_${w}`}:{},...m!=null&&m.length?{interactive:!!m}:{},update:E})}return Ie(v)||a.set("encode",v,!!(n!=null&&n.encoding)),a}function r2e(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){vW(r);for(const i of B(r.component.legends))n.legend[i]=V3(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=xW(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of B(t))for(const i of e.children)i.component.legends[r]&&n.legend[r]==="shared"&&delete i.component.legends[r];return t}function xW(e,t){var o,s,a,u;if(!e)return t.clone();const n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const l of pW){const c=Aa(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return i2e(f,d);case"title":return sB(f,d);case"type":return i=!0,fr("symbol")}return wx(f,d,l,"legend")});e.setWithExplicit(l,c)}return i&&((s=(o=e.implicit)==null?void 0:o.encode)!=null&&s.gradient&&Z1(e.implicit,["encode","gradient"]),(u=(a=e.explicit)==null?void 0:a.encode)!=null&&u.gradient&&Z1(e.explicit,["encode","gradient"])),e}function i2e(e,t){return t.value==="circle"?t:e}function o2e(e,t,n,r){var i,o;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=r}function bW(e){const t=e.component.legends,n={};for(const i of B(t)){const o=e.getScaleComponent(i),s=Ve(o.get("domains"));if(n[s])for(const a of n[s])xW(a,t[i])||n[s].push(t[i]);else n[s]=[t[i].clone()]}return Gt(n).flat().map(i=>s2e(i,e.config)).filter(i=>i!==void 0)}function s2e(e,t){var s,a,u;const{disable:n,labelExpr:r,selections:i,...o}=e.combine();if(!n){if(t.aria===!1&&o.aria==null&&(o.aria=!1),(s=o.encode)!=null&&s.symbols){const l=o.encode.symbols.update;l.fill&&l.fill.value!=="transparent"&&!l.stroke&&!o.stroke&&(l.stroke={value:"transparent"});for(const c of mU)o[c]&&delete l[c]}if(o.title||delete o.title,r!==void 0){let l=r;(u=(a=o.encode)==null?void 0:a.labels)!=null&&u.update&&re(o.encode.labels.update.text)&&(l=rl(r,"datum.label",o.encode.labels.update.text.signal)),o2e(o,"labels","text",{signal:l})}return o}}function a2e(e){return Yf(e)||J3(e)?u2e(e):wW(e)}function u2e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),wW(e))}function wW(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(s=>s.signal).join(", ")}]`},o=t.data.reduce((s,a)=>{const u=re(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return we(s,u)||s.push(u),s},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]},...n}]}else return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const l2e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class EW extends _s{constructor(t,n,r,i){super({...n},{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function SW(e){e.component.projection=ht(e)?c2e(e):h2e(e)}function c2e(e){if(e.hasProjection){const t=qn(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),r=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=n?f2e(e):void 0,o=new EW(e.projectionName(!0),{...qn(e.config.projection)??{},...t??{}},r,i);return o.get("type")||o.set("type","equalEarth",!1),o}}function f2e(e){const t=[],{encoding:n}=e;for(const r of[[zi,Li],[Xr,Ii]])(Et(n[r[0]])||Et(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(ar)&&e.typedFieldDef(ar).type===Wf&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(qe.Main)),t}function d2e(e,t){const n=IA(l2e,i=>!!(!ae(e.explicit,i)&&!ae(t.explicit,i)||ae(e.explicit,i)&&ae(t.explicit,i)&&Zi(e.get(i),t.get(i))));if(Zi(e.size,t.size)){if(n)return e;if(Zi(e.explicit,{}))return t;if(Zi(t.explicit,{}))return e}return null}function h2e(e){if(e.children.length===0)return;let t;for(const r of e.children)SW(r);const n=IA(e.children,r=>{const i=r.component.projection;if(i)if(t){const o=d2e(t,i);return o&&(t=o),!!o}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new EW(r,t.specifiedProjection,t.size,fe(t.data));for(const o of e.children){const s=o.component.projection;s&&(s.isFit&&i.data.push(...o.component.projection.data),o.renameProjection(s.get("name"),r),s.merged=!0)}return i}}function p2e(e,t,n,r){if(xg(t,n)){const i=ht(e)?e.axis(n)??e.legend(n)??{}:{},o=Y(t,{expr:"datum"}),s=Y(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Y(t,{binSuffix:"range",forAs:!0}),formula:mg(o,s,i.format,i.formatType,r)}}return{}}function _W(e,t){return`${Jj(e)}_${t}`}function g2e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function G3(e,t,n){const r=gx(n,void 0)??{},i=_W(r,t);return e.getName(`${i}_bins`)}function m2e(e){return"as"in e}function cR(e,t,n){let r,i;m2e(e)?r=Q(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Y(e,{forAs:!0}),Y(e,{binSuffix:"end",forAs:!0})];const o={...gx(t,void 0)},s=_W(o,e.field),{signal:a,extentSignal:u}=g2e(n,s);if(ix(o.extent)){const c=o.extent;i=nW(n,c.param,c),delete o.extent}const l={bin:o,field:e.field,as:[r],...a?{signal:a}:{},...u?{extentSignal:u}:{},...i?{span:i}:{}};return{key:s,binComponent:l}}class uo extends Ue{clone(){return new uo(null,fe(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,s)=>{if(Rn(o)&&Ge(o.bin)){const{key:a,binComponent:u}=cR(o,o.bin,n);i[a]={...u,...i[a],...p2e(n,o,s,n.config)}}return i},{});return Ie(r)?null:new uo(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:o}=cR(n,n.bin,r);return new uo(t,{[i]:o})}merge(t,n){for(const r of B(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=eo([...this.bins[r].as,...t.bins[r].as],ke)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(Gt(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Gt(this.bins).map(t=>t.field))}hash(){return`Bin ${ke(this.bins)}`}assemble(){return Gt(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,{extent:o,...s}=t.bin,a={type:"bin",field:Yr(t.field),as:r,signal:t.signal,...ix(o)?{extent:null}:{extent:o},...t.span?{span:{signal:`span(${t.span})`}}:{},...s};!o&&t.extentSignal&&(n.push({type:"extent",field:Yr(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),n.push(a);for(const u of i)for(let l=0;l<2;l++)n.push({type:"formula",expr:Y({field:r[l]},{expr:"datum"}),as:u[l]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function y2e(e,t,n,r){var o;const i=ht(r)?r.encoding[Ao(t)]:void 0;if(Rn(n)&&ht(r)&&WB(n,i,r.markDef,r.config))e.add(Y(n,{})),e.add(Y(n,{suffix:"end"})),n.bin&&xg(n,t)&&e.add(Y(n,{binSuffix:"range"}));else if(Bj(t)){const s=jj(t);e.add(r.getName(s))}else e.add(Y(n));return Fl(n)&&h1e((o=n.scale)==null?void 0:o.range)&&e.add(n.scale.range.field),e}function v2e(e,t){for(const n of B(t)){const r=t[n];for(const i of B(r))n in e?e[n][i]=new Set([...e[n][i]??[],...r[i]]):e[n]={[i]:r[i]}}}class _i extends Ue{clone(){return new _i(null,new Set(this.dimensions),fe(this.measures))}constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(s=>{s.aggregate&&(r=!0)});const i={},o=new Set;return!r||(n.forEachFieldDef((s,a)=>{const{aggregate:u,field:l}=s;if(u)if(u==="count")i["*"]??(i["*"]={}),i["*"].count=new Set([Y(s,{forAs:!0})]);else{if(hs(u)||Ga(u)){const c=hs(u)?"argmin":"argmax",f=u[c];i[f]??(i[f]={}),i[f][c]=new Set([Y({op:c,field:f},{forAs:!0})])}else i[l]??(i[l]={}),i[l][u]=new Set([Y(s,{forAs:!0})]);Es(a)&&n.scaleDomain(a)==="unaggregated"&&(i[l]??(i[l]={}),i[l].min=new Set([Y({field:l,aggregate:"min"},{forAs:!0})]),i[l].max=new Set([Y({field:l,aggregate:"max"},{forAs:!0})]))}else y2e(o,a,s,n)}),o.size+B(i).length===0)?null:new _i(t,o,i)}static makeFromTransform(t,n){const r=new Set,i={};for(const o of n.aggregate){const{op:s,field:a,as:u}=o;s&&(s==="count"?(i["*"]??(i["*"]={}),i["*"].count=new Set([u||Y(o,{forAs:!0})])):(i[a]??(i[a]={}),i[a][s]=new Set([u||Y(o,{forAs:!0})])))}for(const o of n.groupby??[])r.add(o);return r.size+B(i).length===0?null:new _i(t,r,i)}merge(t){return Oj(this.dimensions,t.dimensions)?(v2e(this.measures,t.measures),!0):(I0e("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...B(this.measures)])}producedFields(){const t=new Set;for(const n of B(this.measures))for(const r of B(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${ke({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const o of B(this.measures))for(const s of B(this.measures[o]))for(const a of this.measures[o][s])r.push(a),t.push(s),n.push(o==="*"?null:Yr(o));return{type:"aggregate",groupby:[...this.dimensions].map(Yr),ops:t,fields:n,as:r}}}class Vf extends Ue{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(const o of zr){const s=n.facet[o];if(s){const{bin:a,sort:u}=s;this[o]={name:n.getName(`${o}_domain`),fields:[Y(s),...Ge(a)?[Y(s,{binSuffix:"end"})]:[]],...so(u)?{sortField:u}:I(u)?{sortIndexField:vf(s,o)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(const n of zr)this[n]&&(t+=` ${n.charAt(0)}:${ke(this[n])}`);return t}get fields(){var n;const t=[];for(const r of zr)(n=this[r])!=null&&n.fields&&t.push(...this[r].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of zr)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of To){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),o=r.get("range");if(Lt(i)&&Ya(o)){const s=$x(this.childModel,n),a=K3(s);a?t[n]=a:U(JA(n))}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x",facet:void 0}[t],o=[],s=[],a=[];i&&r&&r[i]&&(n?(o.push(`distinct_${r[i]}`),s.push("max")):(o.push(r[i]),s.push("distinct")),a.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=fx,field:f}=u;o.push(f),s.push(c),a.push(Y(u,{forAs:!0}))}else l&&(o.push(l),s.push("max"),a.push(l));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...o.length?{fields:o,ops:s,as:a}:{}}]}}assembleFacetHeaderData(t){var u;const{columns:n}=this.model.layout,{layoutHeaders:r}=this.model.component,i=[],o={};for(const l of W3){for(const c of q3){const f=(r[l]&&r[l][c])??[];for(const d of f)if(((u=d.axes)==null?void 0:u.length)>0){o[l]=!0;break}}if(o[l]){const c=`length(data("${this.facet.name}"))`,f=l==="row"?n?{signal:`ceil(${c} / ${n})`}:1:n?{signal:`min(${c}, ${n})`}:{signal:c};i.push({name:`${this.facet.name}_${l}`,transform:[{type:"sequence",start:0,stop:f}]})}}const{row:s,column:a}=o;return(s||a)&&i.unshift(this.assembleRowColumnHeaderData("facet",null,t)),i}assemble(){const t=[];let n=null;const r=this.getChildIndependentFieldsWithStep(),{column:i,row:o,facet:s}=this;if(i&&o&&(r.x||r.y)){n=`cross_${this.column.name}_${this.row.name}`;const a=[].concat(r.x??[],r.y??[]),u=a.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:u}]})}for(const a of[ns,ts])this[a]&&t.push(this.assembleRowColumnHeaderData(a,n,r));if(s){const a=this.assembleFacetHeaderData(r);a&&t.push(...a)}return t}}function fR(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function x2e(e,t){const n=UA(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const r=fR(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.startsWith("utc:")){const r=fR(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return U(Vme(t)),null}function b2e(e){const t={};return l0(e.filter,n=>{if(xB(n)){let r=null;n3(n)?r=mr(n.equal):i3(n)?r=mr(n.lte):r3(n)?r=mr(n.lt):o3(n)?r=mr(n.gt):s3(n)?r=mr(n.gte):a3(n)?r=n.range[0]:u3(n)&&(r=(n.oneOf??n.in)[0]),r&&(Tl(r)?t[n.field]="date":je(r)?t[n.field]="number":Q(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function w2e(e){const t={};function n(r){gf(r)?t[r.field]="date":r.type==="quantitative"&&_me(r.aggregate)?t[r.field]="number":lf(r.field)>1?r.field in t||(t[r.field]="flatten"):Fl(r)&&so(r.sort)&&lf(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((ht(e)||ki(e))&&e.forEachFieldDef((r,i)=>{if(Rn(r))n(r);else{const o=Cl(i),s=e.fieldDef(o);n({...r,type:s.type})}}),ht(e)){const{mark:r,markDef:i,encoding:o}=e;if(Xa(r)&&!e.encoding.order){const s=i.orient==="horizontal"?"y":"x",a=o[s];H(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function E2e(e){const t={};if(ht(e)&&e.component.selection)for(const n of B(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&lf(i.field)>1&&(t[i.field]="flatten")}return t}class fn extends Ue{clone(){return new fn(null,fe(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${ke(this._parse)}`}static makeExplicit(t,n,r){var s;let i={};const o=n.data;return!da(o)&&((s=o==null?void 0:o.format)!=null&&s.parse)&&(i=o.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const a of B(r)){const u=i.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===r[a]||u.value==="derived"||r[a]==="flatten"?delete r[a]:U(kD(a,r[a],u.value)))}for(const a of B(n)){const u=i.get(a);u!==void 0&&(u===n[a]?delete n[a]:U(kD(a,n[a],u)))}const o=new _s(n,r);i.copyAll(o);const s={};for(const a of B(o.combine())){const u=o.get(a);u!==null&&(s[a]=u)}return B(s).length===0||i.parseNothing?null:new fn(t,s)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const n of B(this._parse)){const r=this._parse[n];lf(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(B(this._parse))}dependentFields(){return new Set(B(this._parse))}assembleTransforms(t=!1){return B(this._parse).filter(n=>t?lf(n)>1:!0).map(n=>{const r=x2e(n,this._parse[n]);return r?{type:"formula",expr:r,as:WA(n)}:null}).filter(n=>n!==null)}}class Ma extends Ue{clone(){return new Ma(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Mi])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Mi}}}class Eg extends Ue{clone(){return new Eg(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${ke(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class Sg extends Ue{clone(){return new Sg(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${ke(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class dl extends Ue{constructor(t){super(null),t??(t={name:"source"});let n;if(da(t)||(n=t.format?{...Zn(t.format,["parse"])}:{}),xp(t))this._data={values:t.values};else if(mf(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];we(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else NU(t)?this._data={values:[{type:"Sphere"}]}:(MU(t)||da(t))&&(this._data={});this._generator=da(t),t.name&&(this._name=t.name),n&&!Ie(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var dR=globalThis&&globalThis.__classPrivateFieldSet||function(e,t,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},S2e=globalThis&&globalThis.__classPrivateFieldGet||function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},nh;function Y3(e){return e instanceof dl||e instanceof Eg||e instanceof Sg}class X3{constructor(){nh.set(this,void 0),dR(this,nh,!1,"f")}setModified(){dR(this,nh,!0,"f")}get modifiedFlag(){return S2e(this,nh,"f")}}nh=new WeakMap;class Ml extends X3{getNodeDepths(t,n,r){r.set(t,n);for(const i of t.children)this.getNodeDepths(i,n+1,r);return r}optimize(t){const r=[...this.getNodeDepths(t,0,new Map).entries()].sort((i,o)=>o[1]-i[1]);for(const i of r)this.run(i[0]);return this.modifiedFlag}}class Q3 extends X3{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class _2e extends Q3{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of B(r))r[i].length>1&&(this.setModified(),this.mergeNodes(t,r[i]))}}class k2e extends Q3{constructor(t){super(),this.requiresSelectionId=t&&U3(t)}run(t){t instanceof Ma&&(this.requiresSelectionId&&(Y3(t.parent)||t.parent instanceof _i||t.parent instanceof fn)||(this.setModified(),t.remove()))}}class $2e extends X3{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let r=new Set;t instanceof ao&&(r=t.producedFields(),jA(r,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const i of t.children)this.run(i,new Set([...n,...r]))}}class C2e extends Q3{constructor(){super()}run(t){t instanceof On&&!t.isRequired()&&(this.setModified(),t.remove())}}class A2e extends Ml{run(t){if(!Y3(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof fn)if(t instanceof fn)this.setModified(),t.merge(n);else{if(BA(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class T2e extends Ml{run(t){const n=[...t.children],r=t.children.filter(i=>i instanceof fn);if(t.numChildren()>1&&r.length>=1){const i={},o=new Set;for(const s of r){const a=s.parse;for(const u of B(a))u in i?i[u]!==a[u]&&o.add(u):i[u]=a[u]}for(const s of o)delete i[s];if(!Ie(i)){this.setModified();const s=new fn(t,i);for(const a of n){if(a instanceof fn)for(const u of B(i))delete a.parse[u];t.removeChild(a),a.parent=s,a instanceof fn&&B(a.parse).length===0&&a.remove()}}}}}class F2e extends Ml{run(t){t instanceof On||t.numChildren()>0||t instanceof Vf||t instanceof dl||(this.setModified(),t.remove())}}class M2e extends Ml{run(t){const n=t.children.filter(i=>i instanceof ao),r=n.pop();for(const i of n)this.setModified(),r.merge(i)}}class O2e extends Ml{run(t){const n=t.children.filter(i=>i instanceof _i),r={};for(const i of n){const o=ke(i.groupBy);o in r||(r[o]=[]),r[o].push(i)}for(const i of B(r)){const o=r[i];if(o.length>1){const s=o.pop();for(const a of o)s.merge(a)&&(t.removeChild(a),a.parent=s,a.remove(),this.setModified())}}}}class N2e extends Ml{constructor(t){super(),this.model=t}run(t){const n=!(Y3(t)||t instanceof Hf||t instanceof fn||t instanceof Ma),r=[],i=[];for(const o of t.children)o instanceof uo&&(n&&!BA(t.producedFields(),o.dependentFields())?r.push(o):i.push(o));if(r.length>0){const o=r.pop();for(const s of r)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof uo?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(i.length>1){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified()}}}class D2e extends Ml{run(t){const n=[...t.children];if(!nl(n,s=>s instanceof On)||t.numChildren()<=1)return;const i=[];let o;for(const s of n)if(s instanceof On){let a=s;for(;a.numChildren()===1;){const[u]=a.children;if(u instanceof On)a=u;else break}i.push(...a.children),o?(t.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=a,this.setModified()):o=a}else i.push(s);if(i.length){this.setModified();for(const s of i)s.parent.removeChild(s),s.parent=o}}}class Ol extends Ue{clone(){return new Ol(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=eo(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??Y(t)}hash(){return`JoinAggregateTransform ${ke(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const o of this.transform.joinaggregate)n.push(o.op),r.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);const i=this.transform.groupby;return{type:"joinaggregate",as:r,ops:n,fields:t,...i!==void 0?{groupby:i}:{}}}}function R2e(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Y(r);return i&&t.push(i),t},[])}function P2e(e){return I(e)&&e.every(t=>Q(t))&&e.length>1}class os extends Ue{clone(){return new os(null,fe(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:r,groupby:i,as:o,offset:s="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),u.push(mt(f.order,"ascending"));const l={field:a,order:u};let c;return P2e(o)?c=o:Q(o)?c=[o,`${o}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new os(t,{dimensionFieldDefs:[],stackField:r,groupby:i,offset:s,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannels:o,fieldChannel:s,offset:a,impute:u}=r,l=o.map(h=>{const p=i[h];return yo(p)}).filter(h=>!!h),c=R2e(n),f=n.encoding.order;let d;return I(f)||H(f)?d=rB(f):d=c.reduce((h,p)=>(h.field.push(p),h.order.push(s==="y"?"descending":"ascending"),h),{field:[],order:[]}),new os(t,{dimensionFieldDefs:l,stackField:n.vgField(s),facetby:[],stackby:c,sort:d,offset:a,impute:u,as:[n.vgField(s,{suffix:"start",forAs:!0}),n.vgField(s,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${ke(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:r}=this._stack;return t.length>0?t.map(i=>i.bin?n?[Y(i,{binSuffix:"mid"})]:[Y(i,{}),Y(i,{binSuffix:"end"})]:[Y(i)]).flat():r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:r,stackField:i,stackby:o,sort:s,offset:a,impute:u,as:l}=this._stack;if(u)for(const c of r){const{bandPosition:f=.5,bin:d}=c;if(d){const h=Y(c,{expr:"datum"}),p=Y(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${f}*${h}+${1-f}*${p}`,as:Y(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:i,groupby:[...o,...n],key:Y(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:s,as:l,offset:a}),t}}class Gf extends Ue{clone(){return new Gf(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=eo(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??Y(t)}hash(){return`WindowTransform ${ke(this.transform)}`}assemble(){const t=[],n=[],r=[],i=[];for(const f of this.transform.window)n.push(f.op),r.push(this.getDefaultName(f)),i.push(f.param===void 0?null:f.param),t.push(f.field===void 0?null:f.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&n.every(f=>QA(f)))return{type:"joinaggregate",as:r,ops:n,fields:t,...s!==void 0?{groupby:s}:{}};const a=[],u=[];if(this.transform.sort!==void 0)for(const f of this.transform.sort)a.push(f.field),u.push(f.order??"ascending");const l={field:a,order:u},c=this.transform.ignorePeers;return{type:"window",params:i,as:r,ops:n,fields:t,sort:l,...c!==void 0?{ignorePeers:c}:{},...s!==void 0?{groupby:s}:{},...o!==void 0?{frame:o}:{}}}}function L2e(e){function t(n){if(!(n instanceof Vf)){const r=n.clone();if(r instanceof On){const i=LS+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof _i||r instanceof os||r instanceof Gf||r instanceof Ol)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function PS(e){if(e instanceof Vf)if(e.numChildren()===1&&!(e.children[0]instanceof On)){const t=e.children[0];(t instanceof _i||t instanceof os||t instanceof Gf||t instanceof Ol)&&t.addDimensions(e.fields),t.swapWithParent(),PS(e)}else{const t=e.model.component.data.main;kW(t);const n=L2e(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(PS)}function kW(e){if(e instanceof On&&e.type===qe.Main&&e.numChildren()===1){const t=e.children[0];t instanceof Vf||(t.swapWithParent(),kW(e))}}const LS="scale_",bm=5;function zS(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!zS(t.children))return!1}return!0}function ti(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function hR(e,t,n){let r=e.sources,i=!1;return i=ti(new C2e,r)||i,i=ti(new k2e(t),r)||i,r=r.filter(o=>o.numChildren()>0),i=ti(new F2e,r)||i,r=r.filter(o=>o.numChildren()>0),n||(i=ti(new A2e,r)||i,i=ti(new N2e(t),r)||i,i=ti(new $2e,r)||i,i=ti(new T2e,r)||i,i=ti(new O2e,r)||i,i=ti(new M2e,r)||i,i=ti(new _2e,r)||i,i=ti(new D2e,r)||i),e.sources=r,i}function z2e(e,t){zS(e.sources);let n=0,r=0;for(let i=0;i<bm&&hR(e,t,!0);i++)n++;e.sources.map(PS);for(let i=0;i<bm&&hR(e,t,!1);i++)r++;zS(e.sources),Math.max(n,r)===bm&&U(`Maximum optimization runs(${bm}) reached.`)}class tr{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new tr(()=>t(n))}}function $W(e){ht(e)?I2e(e):j2e(e)}function I2e(e){const t=e.component.scales;for(const n of B(t)){const r=U2e(e,n);if(t[n].setWithExplicit("domains",r),q2e(e,n),e.component.data.isFaceted){let o=e;for(;!ki(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(const a of r.value)Qo(a)&&(a.data=LS+a.data.replace(LS,""))}}}function j2e(e){for(const n of e.children)$W(n);const t=e.component.scales;for(const n of B(t)){let r,i=null;for(const o of e.children){const s=o.component.scales[n];if(s){r===void 0?r=s.getWithExplicit("domains"):r=Aa(r,s.getWithExplicit("domains"),"domains","scale",IS);const a=s.get("selectionExtent");i&&a&&i.param!==a.param&&U(Ume),i=a}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function B2e(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:o}=pR(t,n);if(!i){U(o);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=pR(t,n);if(i)return"unaggregated"}return e}function U2e(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=B2e(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:i}),t==="x"&&Et(r.x2)?Et(r.x)?Aa(Ts(n,i,e,"x"),Ts(n,i,e,"x2"),"domain","scale",IS):Ts(n,i,e,"x2"):t==="y"&&Et(r.y2)?Et(r.y)?Aa(Ts(n,i,e,"y"),Ts(n,i,e,"y2"),"domain","scale",IS):Ts(n,i,e,"y2"):Ts(n,i,e,t)}function W2e(e,t,n){return e.map(r=>({signal:`{data: ${mx(r,{timeUnit:n,type:t})}}`}))}function Sb(e,t,n){var i;const r=(i=Qt(n))==null?void 0:i.unit;return t==="temporal"||r?W2e(e,t,r):[e]}function Ts(e,t,n,r){const{encoding:i}=n,o=Et(i[r]),{type:s}=o,a=o.timeUnit;if(d1e(t)){const f=Ts(e,void 0,n,r),d=Sb(t.unionWith,s,a);return Gi([...d,...f.value])}else{if(re(t))return Gi([t]);if(t&&t!=="unaggregated"&&!$B(t))return Gi(Sb(t,s,a))}const u=n.stack;if(u&&r===u.fieldChannel){if(u.offset==="normalize")return fr([[0,1]]);const f=n.requestDataName(qe.Main);return fr([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const l=Es(r)&&H(o)?H2e(n,r,e):void 0;if(Fo(o)){const f=Sb([o.datum],s,a);return fr(f)}const c=o;if(t==="unaggregated"){const f=n.requestDataName(qe.Main),{field:d}=o;return fr([{data:f,field:Y({field:d,aggregate:"min"})},{data:f,field:Y({field:d,aggregate:"max"})}])}else if(Ge(c.bin)){if(Lt(e))return fr(e==="bin-ordinal"?[]:[{data:yp(l)?n.requestDataName(qe.Main):n.requestDataName(qe.Raw),field:n.vgField(r,xg(c,r)?{binSuffix:"range"}:{}),sort:l===!0||!J(l)?{field:n.vgField(r,{}),op:"min"}:l}]);{const{bin:f}=c;if(Ge(f)){const d=G3(n,c.field,f);return fr([new tr(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return fr([{data:n.requestDataName(qe.Main),field:n.vgField(r,{})}])}}else if(c.timeUnit&&we(["time","utc"],e)&&WB(c,ht(n)?n.encoding[Ao(r)]:void 0,n.markDef,n.config)){const f=n.requestDataName(qe.Main);return fr([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return fr(l?[{data:yp(l)?n.requestDataName(qe.Main):n.requestDataName(qe.Raw),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(qe.Main),field:n.vgField(r)}])}function _b(e,t){const{op:n,field:r,order:i}=e;return{op:n??(t?"sum":fx),...r?{field:Yr(r)}:{},...i?{order:i}:{}}}function q2e(e,t){var a;const n=e.component.scales[t],r=e.specifiedScales[t].domain,i=(a=e.fieldDef(t))==null?void 0:a.bin,o=$B(r)&&r,s=Al(i)&&ix(i.extent)&&i.extent;(o||s)&&n.set("selectionExtent",o??s,!0)}function H2e(e,t,n){if(!Lt(n))return;const r=e.fieldDef(t),i=r.sort;if(jB(i))return{op:"min",field:vf(r,t),order:"ascending"};const{stack:o}=e,s=o?new Set([...o.groupbyFields,...o.stackBy.map(a=>a.fieldDef.field)]):void 0;if(so(i)){const a=o&&!s.has(i.field);return _b(i,a)}else if(IB(i)){const{encoding:a,order:u}=i,l=e.fieldDef(a),{aggregate:c,field:f}=l,d=o&&!s.has(f);if(hs(c)||Ga(c))return _b({field:Y(l),order:u},d);if(QA(c)||!c)return _b({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(we(["ascending",void 0],i))return!0}}function pR(e,t){const{aggregate:n,type:r}=e;return n?Q(n)&&!$me.has(n)?{valid:!1,reason:m0e(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:y0e(e)}:{valid:!0}:{valid:!1,reason:g0e(e)}}function IS(e,t,n,r){return e.explicit&&t.explicit&&U(E0e(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function V2e(e){const t=eo(e.map(s=>{if(Qo(s)){const{sort:a,...u}=s;return u}return s}),ke),n=eo(e.map(s=>{if(Qo(s)){const a=s.sort;return a!==void 0&&!yp(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(s=>s!==void 0),ke);if(t.length===0)return;if(t.length===1){const s=e[0];if(Qo(s)&&n.length>0){let a=n[0];if(n.length>1){U(CD);const u=n.filter(l=>J(l)&&"op"in l&&l.op!=="min");n.every(l=>J(l)&&"op"in l)&&u.length===1?a=u[0]:a=!0}else if(J(a)&&"field"in a){const u=a.field;s.field===u&&(a=a.order?{order:a.order}:!0)}return{...s,sort:a}}return s}const r=eo(n.map(s=>yp(s)||!("op"in s)||Q(s.op)&&s.op in Eme?s:(U(_0e(s)),!0)),ke);let i;r.length===1?i=r[0]:r.length>1&&(U(CD),i=!0);const o=eo(e.map(s=>Qo(s)?s.data:null),s=>s);return o.length===1&&o[0]!==null?{data:o[0],fields:t.map(a=>a.field),...i?{sort:i}:{}}:{fields:t,...i?{sort:i}:{}}}function K3(e){if(Qo(e)&&Q(e.field))return e.field;if(Cme(e)){let t;for(const n of e.fields)if(Qo(n)&&Q(n.field)){if(!t)t=n.field;else if(t!==n.field)return U(k0e),t}return U($0e),t}else if(Ame(e)){U(C0e);const t=e.fields[0];return Q(t)?t:void 0}}function $x(e,t){const r=e.component.scales[t].get("domains").map(i=>(Qo(i)&&(i.data=e.lookupDataSource(i.data)),i));return V2e(r)}function CW(e){return Yf(e)||J3(e)?e.children.reduce((t,n)=>t.concat(CW(n)),gR(e)):gR(e)}function gR(e){return B(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:s,selectionExtent:a,domains:u,range:l,reverse:c,...f}=i,d=G2e(i.range,o,n,e),h=$x(e,n),p=a?Bve(e,a,r,h):null;return t.push({name:o,type:s,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...c!==void 0?{reverse:c}:{},...f}),t},[])}function G2e(e,t,n,r){if(Pt(n)){if(Ya(e))return{step:{signal:`${t}_step`}}}else if(J(e)&&Qo(e))return{...e,data:r.lookupDataSource(e.data)};return e}class AW extends _s{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:nl(this.get("domains"),t=>I(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const Y2e=["range","scheme"];function X2e(e){const t=e.component.scales;for(const n of rx){const r=t[n];if(!r)continue;const i=Q2e(n,e);r.setWithExplicit("range",i)}}function mR(e,t){const n=e.fieldDef(t);if(n!=null&&n.bin){const{bin:r,field:i}=n,o=ur(t),s=e.getName(o);if(J(r)&&r.binned&&r.step!==void 0)return new tr(()=>{const a=e.scaleName(t),u=`(domain("${a}")[1] - domain("${a}")[0]) / ${r.step}`;return`${e.getSignalName(s)} / (${u})`});if(Ge(r)){const a=G3(e,i,r);return new tr(()=>{const u=e.getSignalName(a),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(s)} / (${l})`})}}}function Q2e(e,t){const n=t.specifiedScales[e],{size:r}=t,o=t.getScaleComponent(e).get("type");for(const f of Y2e)if(n[f]!==void 0){const d=ES(o,f),h=CB(e,f);if(!d)U(cB(o,f,e));else if(h)U(h);else switch(f){case"range":{const p=n.range;if(I(p)){if(Pt(e))return Gi(p.map(g=>{if(g==="width"||g==="height"){const y=t.getName(g),m=t.getSignalName.bind(t);return tr.fromName(m,y)}return g}))}else if(J(p))return Gi({data:t.requestDataName(qe.Main),field:p.field,sort:{op:"min",field:t.vgField(e)}});return Gi(p)}case"scheme":return Gi(K2e(n[f]))}}const s=e===tt||e==="xOffset"?"width":"height",a=r[s];if(vo(a)){if(Pt(e))if(Lt(o)){const f=TW(a,t,e);if(f)return Gi({step:f})}else U(fB(s));else if(Uf(e)){const f=e===Ua?"x":"y";if(t.getScaleComponent(f).get("type")==="band"){const p=FW(a,o);if(p)return Gi(p)}}}const{rangeMin:u,rangeMax:l}=n,c=J2e(e,t);return(u!==void 0||l!==void 0)&&ES(o,"rangeMin")&&I(c)&&c.length===2?Gi([u??c[0],l??c[1]]):fr(c)}function K2e(e){return f1e(e)?{scheme:e.name,...Zn(e,["name"])}:{scheme:e}}function J2e(e,t){const{size:n,config:r,mark:i,encoding:o}=t,s=t.getSignalName.bind(t),{type:a}=Et(o[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case tt:case Rt:{if(we(["point","band"],l)){const p=MW(e,n,r.view);if(vo(p))return{step:TW(p,t,e)}}const d=ur(e),h=t.getName(d);return e===Rt&&Cr(l)?[tr.fromName(s,h),0]:[0,tr.fromName(s,h)]}case Ua:case Bf:return Z2e(e,t,l);case bs:{const d=t.component.scales[e].get("zero"),h=OW(i,d,r),p=nbe(i,n,t,r);return df(l)?tbe(h,p,ebe(l,r,c,e)):[h,p]}case Kr:return[0,Math.PI*2];case $l:return[0,360];case Pi:return[0,new tr(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case Ha:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Va:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case ar:return"symbol";case sr:case $o:case Co:return l==="ordinal"?a==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case ws:case Wa:case qa:return[r.scale.minOpacity,r.scale.maxOpacity]}}function TW(e,t,n){const{encoding:r}=t,i=t.getScaleComponent(n),o=Hj(n),s=r[o];if(vU({step:e,offsetIsDiscrete:ce(s)&&wB(s.type)})==="offset"&&eU(r,o)){const u=t.getScaleComponent(o);let c=`domain('${t.scaleName(o)}').length`;if(u.get("type")==="band"){const d=u.get("paddingInner")??u.get("padding")??0,h=u.get("paddingOuter")??u.get("padding")??0;c=`bandspace(${c}, ${d}, ${h})`}const f=i.get("paddingInner")??i.get("padding");return{signal:`${e.step} * ${c} / (1-${Ome(f)})`}}else return e.step}function FW(e,t){if(vU({step:e,offsetIsDiscrete:Lt(t)})==="offset")return{step:e.step}}function Z2e(e,t,n){const r=e===Ua?"x":"y",o=t.getScaleComponent(r).get("type"),s=t.scaleName(r);if(o==="band"){const a=MW(r,t.size,t.config.view);if(vo(a)){const u=FW(a,n);if(u)return u}return[0,{signal:`bandwidth('${s}')`}]}else return Fj(`Cannot use ${e} scale if ${r} scale is not discrete.`)}function MW(e,t,n){const r=e===tt?"width":"height",i=t[r];return i||cy(n,r)}function ebe(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&I(n)?n.length+1:(U(P0e(r)),3)}}function tbe(e,t,n){const r=()=>{const i=rs(t),o=rs(e),s=`(${i} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${i} + ${s}, ${s})`};return re(t)?new tr(r):{signal:r()}}function OW(e,t,n){if(t)return re(t)?{signal:`${t.signal} ? 0 : ${OW(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(ox("size",e))}const yR=.95;function nbe(e,t,n,r){const i={x:mR(n,"x"),y:mR(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const o=vR(t,i,r.view);return je(o)?o-1:new tr(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const o=vR(t,i,r.view);return je(o)?Math.pow(yR*o,2):new tr(()=>`pow(${yR} * ${o.signal}, 2)`)}}throw new Error(ox("size",e))}function vR(e,t,n){const r=vo(e.width)?e.width.step:ly(n,"width"),i=vo(e.height)?e.height.step:ly(n,"height");return t.x||t.y?new tr(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function NW(e,t){ht(e)?rbe(e,t):RW(e,t)}function rbe(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:s}=e;for(const a of B(n)){const u=s[a],l=n[a],c=e.getScaleComponent(a),f=Et(i[a]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),y=ES(h,t),m=CB(a,t);if(d!==void 0&&(y?m&&U(m):U(cB(h,t,a))),y&&m===void 0)if(d!==void 0){const v=f.timeUnit,x=f.type;switch(t){case"domainMax":case"domainMin":Tl(u[t])||x==="temporal"||v?l.set(t,{signal:mx(u[t],{type:x,timeUnit:v})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const v=t in xR?xR[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,domainMin:u.domainMin,domainMax:u.domainMax,markDef:o,config:r,hasNestedOffsetScale:_S(i,a),hasSecondaryRangeChannel:!!i[Ao(a)]}):r.scale[t];v!==void 0&&l.set(t,v,!1)}}}const xR={bins:({model:e,fieldOrDatumDef:t})=>H(t)?ibe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>obe(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:r,domainMax:i,fieldOrDatumDef:o})=>sbe(e,t,n,r,i,o),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>abe(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:r,config:i,hasNestedOffsetScale:o})=>ube(e,t,n.type,r,i.scale,o),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:r,config:i,hasNestedOffsetScale:o})=>lbe(e,t,n,r,i.scale,o),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=H(e)?e.sort:void 0;return cbe(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i,config:o,hasSecondaryRangeChannel:s})=>fbe(e,t,n,r,i,o.scale,s)};function DW(e){ht(e)?X2e(e):RW(e,"range")}function RW(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?DW(r):NW(r,t);for(const r of B(n)){let i;for(const o of e.children){const s=o.component.scales[r];if(s){const a=s.getWithExplicit(t);i=Aa(i,a,t,"scale",FU((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function ibe(e,t){const n=t.bin;if(Ge(n)){const r=G3(e,t.field,n);return new tr(()=>e.getSignalName(r))}else if(Ut(n)&&Al(n)&&n.step!==void 0)return{step:n.step}}function obe(e,t){if(we([sr,$o,Co],e)&&t!=="nominal")return"hcl"}function sbe(e,t,n,r,i,o){var s;if(!((s=yo(o))!=null&&s.bin||I(n)||i!=null||r!=null||we([er.TIME,er.UTC],e)))return Pt(t)?!0:void 0}function abe(e,t,n,r,i,o){if(Pt(e)){if(vi(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:s,orient:a}=i;if(s==="bar"&&!(H(r)&&(r.bin||r.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===er.POINT)return n.pointPadding}}function ube(e,t,n,r,i,o=!1){if(e===void 0){if(Pt(t)){const{bandPaddingInner:s,barBandPaddingInner:a,rectBandPaddingInner:u,bandWithNestedOffsetPaddingInner:l}=i;return o?l:mt(s,n==="bar"?a:u)}else if(Uf(t)&&r===er.BAND)return i.offsetBandPaddingInner}}function lbe(e,t,n,r,i,o=!1){if(e===void 0){if(Pt(t)){const{bandPaddingOuter:s,bandWithNestedOffsetPaddingOuter:a}=i;if(o)return a;if(n===er.BAND)return mt(s,re(r)?{signal:`${r.signal}/2`}:r/2)}else if(Uf(t)){if(n===er.POINT)return .5;if(n===er.BAND)return i.offsetBandPaddingOuter}}}function cbe(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return Cr(e)&&t==="descending"?re(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Cr(e)&&t==="descending")return!0}function fbe(e,t,n,r,i,o,s){if(!!n&&n!=="unaggregated"&&Cr(i)){if(I(n)){const u=n[0],l=n[n.length-1];if(u<=0&&l>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!df(i))return!0;if(!(H(t)&&t.bin)&&we([...To,...pme],e)){const{orient:u,type:l}=r;return we(["bar","area","line","trail"],l)&&(u==="horizontal"&&e==="y"||u==="vertical"&&e==="x")?!1:we(["bar","area"],l)&&!s?!0:o==null?void 0:o.zero}return!1}function dbe(e,t,n,r,i=!1){const o=hbe(t,n,r,i),{type:s}=e;return Es(t)?s!==void 0?v1e(t,s)?H(n)&&!y1e(s,n.type)?(U(b0e(s,o)),o):s:(U(x0e(t,s,o)),o):o:null}function hbe(e,t,n,r){var i;switch(t.type){case"nominal":case"ordinal":{if(Cc(e)||mb(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&U(yb(e,"ordinal")),"ordinal";if(Pt(e)||Uf(e)){if(we(["rect","bar","image","rule"],n.type)||r)return"band"}else if(n.type==="arc"&&e in XA)return"band";const o=n[ur(e)];return ul(o)||pf(t)&&((i=t.axis)!=null&&i.tickBand)?"band":"point"}case"temporal":return Cc(e)?"time":mb(e)==="discrete"?(U(yb(e,"temporal")),"ordinal"):H(t)&&t.timeUnit&&Qt(t.timeUnit).utc?"utc":"time";case"quantitative":return Cc(e)?H(t)&&Ge(t.bin)?"bin-ordinal":"linear":mb(e)==="discrete"?(U(yb(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(uB(t.type))}function pbe(e,{ignoreRange:t}={}){PW(e),$W(e);for(const n of m1e)NW(e,n);t||DW(e)}function PW(e){ht(e)?e.component.scales=gbe(e):e.component.scales=ybe(e)}function gbe(e){const{encoding:t,mark:n,markDef:r}=e,i={};for(const o of rx){const s=Et(t[o]);if(s&&n===FB&&o===ar&&s.type===Wf)continue;let a=s&&s.scale;if(Uf(o)){const u=Vj(o);if(!_S(t,u)){a&&U(o0e(o));continue}}if(s&&a!==null&&a!==!1){a??(a={});const u=_S(t,o),l=dbe(a,o,s,r,u);i[o]=new AW(e.scaleName(`${o}`,!0),{value:l,explicit:a.type===l})}}return i}const mbe=FU((e,t)=>TD(e)-TD(t));function ybe(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const o of e.children){PW(o);for(const s of B(o.component.scales))if((t=i.scale)[s]??(t[s]=hW(s,e)),i.scale[s]==="shared"){const a=r[s],u=o.component.scales[s].getWithExplicit("type");a?s1e(a.value,u.value)?r[s]=Aa(a,u,"type","scale",mbe):(i.scale[s]="independent",delete r[s]):r[s]=u}}for(const o of B(r)){const s=e.scaleName(o,!0),a=r[o];n[o]=new AW(s,a);for(const u of e.children){const l=u.component.scales[o];l&&(u.renameScale(l.get("name"),s),l.merged=!0)}}return n}class kb{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function ht(e){return(e==null?void 0:e.type)==="unit"}function ki(e){return(e==null?void 0:e.type)==="facet"}function J3(e){return(e==null?void 0:e.type)==="concat"}function Yf(e){return(e==null?void 0:e.type)==="layer"}class Z3{constructor(t,n,r,i,o,s,a){this.type=n,this.parent=r,this.config=o,this.correctDataNames=u=>{var l,c,f;return(l=u.from)!=null&&l.data&&(u.from.data=this.lookupDataSource(u.from.data)),(f=(c=u.from)==null?void 0:c.facet)!=null&&f.data&&(u.from.facet.data=this.lookupDataSource(u.from.facet.data)),u},this.parent=r,this.config=o,this.view=qn(a),this.name=t.name??i,this.title=Ps(t.title)?{text:t.title}:t.title?qn(t.title):void 0,this.scaleNameMap=r?r.scaleNameMap:new kb,this.projectionNameMap=r?r.projectionNameMap:new kb,this.signalNameMap=r?r.signalNameMap:new kb,this.data=t.data,this.description=t.description,this.transforms=_ve(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:Nye(t,n,o),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:dx(t)||(r==null?void 0:r.component.data.isFaceted)&&t.data===void 0},layoutSize:new _s,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...s?fe(s):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){pbe(this)}parseProjection(){SW(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){vW(this)}assembleEncodeFromView(t){const{style:n,...r}=t,i={};for(const o of B(r)){const s=r[o];s!==void 0&&(i[o]=Qe(s))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Qe(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n??{}}:Ie(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:r,config:i}=this,o=zxe(r.layoutHeaders,i);return{padding:t,...this.assembleDefaultLayout(),...n,...o?{titleBand:o}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of zr)t[r].title&&n.push(Oxe(this,r));for(const r of W3)n=n.concat(Nxe(this,r));return n}assembleAxes(){return xxe(this.component.axes,this.config)}assembleLegends(){return bW(this)}assembleProjections(){return a2e(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},r={...Zj(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(r.text)return we(["unit","layer"],this.type)?we(["middle",void 0],r.anchor)&&(r.frame??(r.frame="group")):r.anchor??(r.anchor="start"),Ie(r)?void 0:r}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||ki(this.parent)?CW(this):[];i.length>0&&(n.scales=i);const o=this.assembleAxes();o.length>0&&(n.axes=o);const s=this.assembleLegends();return s.length>0&&(n.legends=s),n}getName(t){return et((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(qe[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(r[n]||0)+1,n}getSizeSignalRef(t){if(ki(this.parent)){const n=fW(t),r=nx(n),i=this.component.scales[r];if(i&&!i.merged){const o=i.get("type"),s=i.get("range");if(Lt(o)&&Ya(s)){const a=i.get("name"),u=$x(this,r),l=K3(u);if(l){const c=Y({aggregate:"distinct",field:l},{expr:"datum"});return{signal:cW(a,i,c)}}else return U(JA(r)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(Wj(t)&&Es(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(Lme(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)==null?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)==null?void 0:n.some(r=>r.hasOrientSignalRef()))}}class LW extends Z3{vgField(t,n={}){const r=this.fieldDef(t);if(r)return Y(r,n)}reduceFieldDef(t,n){return uye(this.getMapping(),(r,i,o)=>{const s=yo(i);return s?t(r,s,o):r},n)}forEachFieldDef(t,n){k3(this.getMapping(),(r,i)=>{const o=yo(r);o&&t(o,i)},n)}}class Cx extends Ue{clone(){return new Cx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"value",r[1]??"density"],n.groupby&&n.minsteps==null&&n.maxsteps==null&&n.steps==null&&(this.transform.steps=200)}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${ke(this.transform)}`}assemble(){const{density:t,...n}=this.transform;return{type:"kde",field:t,...n}}}class wp extends Ue{clone(){return new wp(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n){const{config:r,mark:i,markDef:o}=n;if(Pe("invalid",o,r)!=="filter")return null;const a=n.reduceFieldDef((u,l,c)=>{const f=Es(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");Cr(d)&&l.aggregate!=="count"&&!Xa(i)&&(u[l.field]=l)}return u},{});return B(a).length?new wp(t,a):null}dependentFields(){return new Set(B(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${ke(this.filter)}`}assemble(){const t=B(this.filter).reduce((n,r)=>{const i=this.filter[r],o=Y(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${o}) || (isValid(${o}) && isFinite(+${o})))`):i.type==="quantitative"&&(n.push(`isValid(${o})`),n.push(`isFinite(+${o})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class Ax extends Ue{clone(){return new Ax(this.parent,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((o,s)=>i[s]??o)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${ke(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class Tx extends Ue{clone(){return new Tx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"key",r[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${ke(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Fc extends Ue{clone(){return new Fc(null,fe(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[zi,Li],[Xr,Ii]]){const o=i.map(s=>{const a=Et(n.encoding[s]);return H(a)?a.field:Fo(a)?{expr:`${a.datum}`}:Fi(a)?{expr:`${a.value}`}:void 0});(o[0]||o[1])&&(t=new Fc(t,o,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(ar)){const i=n.typedFieldDef(ar);i.type===Wf&&(t=new Fc(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}dependentFields(){const t=(this.fields??[]).filter(Q);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${ke(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class Ep extends Ue{clone(){return new Ep(null,this.projection,fe(this.fields),fe(this.as))}constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[zi,Li],[Xr,Ii]]){const i=r.map(s=>{const a=Et(n.encoding[s]);return H(a)?a.field:Fo(a)?{expr:`${a.datum}`}:Fi(a)?{expr:`${a.value}`}:void 0}),o=r[0]===Xr?"2":"";(i[0]||i[1])&&(t=new Ep(t,n.projectionName(),i,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(Q))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${ke(this.fields)} ${ke(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Iu extends Ue{clone(){return new Iu(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new Iu(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,o=r.y;if(H(i)&&H(o)){const s=i.impute?i:o.impute?o:void 0;if(s===void 0)return;const a=i.impute?o:o.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=s.impute,d=nU(n.mark,r);return new Iu(t,{impute:s.field,key:a.field,...u?{method:u}:{},...l!==void 0?{value:l}:{},...c?{frame:c}:{},...f!==void 0?{keyvals:f}:{},...d.length?{groupby:d}:{}})}return null}hash(){return`Impute ${ke(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:o,value:s,frame:a=[null,null]}=this.transform,u={type:"impute",field:t,key:n,...r?{keyvals:sve(r)?this.processSequence(r):r}:{},method:"value",...o?{groupby:o}:{},value:!i||i==="value"?s:null};if(i&&i!=="value"){const l={type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:a,ignorePeers:!1,...o?{groupby:o}:{}},c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class Fx extends Ue{clone(){return new Fx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${ke(this.transform)}`}assemble(){const{loess:t,on:n,...r}=this.transform;return{type:"loess",x:n,y:t,...r}}}class Sp extends Ue{clone(){return new Sp(null,fe(this.transform),this.secondary)}constructor(t,n,r){super(t),this.transform=n,this.secondary=r}static make(t,n,r,i){const o=n.component.data.sources,{from:s}=r;let a=null;if(ave(s)){let u=jW(s.data,o);u||(u=new dl(s.data),o.push(u));const l=n.getName(`lookup_${i}`);a=new On(u,l,qe.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(uve(s)){const u=s.param;r={as:u,...r};let l;try{l=n.getSelectionComponent(et(u),u)}catch{throw new Error(jme(u))}if(a=l.materialized,!a)throw new Error(Bme(u))}return new Sp(t,r,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?K(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${ke({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:K(this.transform.as)}:{}};else{let n=this.transform.as;Q(n)||(U(Xme),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class Mx extends Ue{clone(){return new Mx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"prob",r[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${ke(this.transform)}`}assemble(){const{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}}class Ox extends Ue{clone(){return new Ox(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=fe(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${ke(this.transform)}`}assemble(){const{regression:t,on:n,...r}=this.transform;return{type:"regression",x:n,y:t,...r}}}class Nx extends Ue{clone(){return new Nx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=eo((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${ke(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:o}=this.transform;return{type:"pivot",field:t,value:n,...i!==void 0?{limit:i}:{},...o!==void 0?{op:o}:{},...r!==void 0?{groupby:r}:{}}}}class Dx extends Ue{clone(){return new Dx(null,fe(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${ke(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function zW(e){let t=0;function n(r,i){if(r instanceof dl&&!r.isGenerator&&!mf(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof fn&&(r.parent instanceof dl&&!i.source?(i.format={...i.format??{},parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof Vf){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,e.push(...r.assemble());return}switch((r instanceof Eg||r instanceof Sg||r instanceof wp||r instanceof Hf||r instanceof yf||r instanceof Ep||r instanceof _i||r instanceof Sp||r instanceof Gf||r instanceof Ol||r instanceof Tx||r instanceof Ax||r instanceof Cx||r instanceof Fx||r instanceof Mx||r instanceof Ox||r instanceof Ma||r instanceof Dx||r instanceof Nx)&&i.transform.push(r.assemble()),(r instanceof uo||r instanceof ao||r instanceof Iu||r instanceof os||r instanceof Fc)&&i.transform.push(...r.assemble()),r instanceof On&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof On?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof On&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const s of r.children)n(s,{name:null,source:o,transform:[]});break}}}return n}function vbe(e){const t=[],n=zW(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function xbe(e,t){const n=[],r=zW(n);let i=0;for(const s of e.sources){s.hasName()||(s.dataName=`source_${i++}`);const a=s.assemble();r(s,a)}for(const s of n)s.transform.length===0&&delete s.transform;let o=0;for(const[s,a]of n.entries())(a.transform??[]).length===0&&!a.source&&n.splice(o++,0,n.splice(s,1)[0]);for(const s of n)for(const a of s.transform??[])a.type==="lookup"&&(a.from=e.outputNodes[a.from].getSource());for(const s of n)s.name in t&&(s.values=t[s.name]);return n}function bbe(e){return e==="top"||e==="left"||re(e)?"header":"footer"}function wbe(e){for(const t of zr)Ebe(e,t);bR(e,"x"),bR(e,"y")}function Ebe(e,t){var s;const{facet:n,config:r,child:i,component:o}=e;if(e.channelHasField(t)){const a=n[t],u=xf("title",null,r,t);let l=Ac(a,r,{allowDisabling:!0,includeDefault:u===void 0||!!u});i.component.layoutHeaders[t].title&&(l=I(l)?l.join(", "):l,l+=` / ${i.component.layoutHeaders[t].title}`,i.component.layoutHeaders[t].title=null);const c=xf("labelOrient",a.header,r,t),f=a.header!==null?mt((s=a.header)==null?void 0:s.labels,r.header.labels,!0):!1,d=we(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:a.header!==null?l:null,facetFieldDef:a,[d]:t==="facet"?[]:[IW(e,t,f)]}}}function IW(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function bR(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:r,resolve:i}=e.component;if(i.axis[t]=V3(i,t),i.axis[t]==="shared"){const o=t==="x"?"column":"row",s=r[o];for(const a of n.component.axes[t]){const u=bbe(a.get("orient"));s[u]??(s[u]=[IW(e,o,!1)]);const l=th(a,"main",e.config,{header:!0});l&&s[u][0].axes.push(l),a.mainExtracted=!0}}}}function Sbe(e){eT(e),py(e,"width"),py(e,"height")}function _be(e){eT(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";py(e,t),py(e,n)}function eT(e){for(const t of e.children)t.parseLayoutSize()}function py(e,t){const n=fW(t),r=nx(n),i=e.component.resolve,o=e.component.layoutSize;let s;for(const a of e.children){const u=a.component.layoutSize.getWithExplicit(n),l=i.scale[r]??hW(r,e);if(l==="independent"&&u.value==="step"){s=void 0;break}if(s){if(l==="independent"&&s.value!==u.value){s=void 0;break}s=Aa(s,u,n,"")}else s=u}if(s){for(const a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,s)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function kbe(e){const{size:t,component:n}=e;for(const r of To){const i=ur(r);if(t[i]){const o=t[i];n.layoutSize.set(i,vo(o)?"step":o,!0)}else{const o=$be(e,i);n.layoutSize.set(i,o,!1)}}}function $be(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const o=i.get("type"),s=i.get("range");if(Lt(o)){const a=cy(r.view,t);return Ya(s)||vo(a)?"step":a}else return $S(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return $S(r.view,t);{const o=cy(r.view,t);return vo(o)?o.step:o}}}function jS(e,t,n){return Y(t,{suffix:`by_${Y(e)}`,...n??{}})}class Ah extends LW{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=oT(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!yg(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=B(t),r={};for(const i of n){if(![ts,ns].includes(i)){U(ox(i,"facet"));break}const o=t[i];if(o.field===void 0){U(bS(o,i));break}r[i]=this.initFacetFieldDef(o,i)}return r}initFacetFieldDef(t,n){const r=S3(t,n);return r.header?r.header=qn(r.header):r.header===null&&(r.header=null),r}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Rx(this),this.child.parseData()}parseLayoutSize(){eT(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),wbe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const n of zr)for(const r of q3){const i=this.component.layoutHeaders[n],o=i[r],{facetFieldDef:s}=i;if(s){const a=xf("titleOrient",s.header,this.config,n);if(["right","bottom"].includes(a)){const u=_x(n,a);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[u]="end"}}if(o!=null&&o[0]){const a=n==="row"?"height":"width",u=r==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(a)&&(t[u]??(t[u]={}),t[u][n]=.5),i.title&&(t.offset??(t.offset={}),t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),{...this.getHeaderLayoutMixins(),...r?{columns:r}:{},bounds:"full",align:i}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Ah))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof Ah?{...this.channelHasField("column")?{encode:{update:{columns:{field:Y(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof Ah){if(this.child.channelHasField("column")){const i=Y(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of To){const o=this.child.component.scales[i];if(o&&!o.merged){const s=o.get("type"),a=o.get("range");if(Lt(s)&&Ya(a)){const u=$x(this.child,i),l=K3(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):U(JA(i))}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:o,ops:s,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const c of zr){const f=this.facet[c];if(f){u.push(Y(f));const{bin:d,sort:h}=f;if(Ge(d)&&u.push(Y(f,{binSuffix:"end"})),so(h)){const{field:p,op:g=fx}=h,y=jS(f,h);r&&i?(o.push(y),s.push("max"),a.push(y)):(o.push(p),s.push(g),a.push(y))}else if(I(h)){const p=vf(f,c);o.push(p),s.push("max"),a.push(p)}}}const l=!!r&&!!i;return{name:t,data:n,groupby:u,...l||o.length>0?{aggregate:{...l?{cross:l}:{},...o.length?{fields:o,ops:s,as:a}:{}}}:{}}}facetSortFields(t){const{facet:n}=this,r=n[t];return r?so(r.sort)?[jS(r,r.sort,{expr:"datum"})]:I(r.sort)?[vf(r,t,{expr:"datum"})]:[Y(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(so(i)?i.order:!I(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){var i;const{facet:t,config:n}=this;if(t.facet)return DS(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const o of W3)if(t[o]){const s=xf("labelOrient",(i=t[o])==null?void 0:i.header,n,o);if(r[o].includes(s))return DS(t[o],o,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=vbe(n),i=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),s=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...o?{title:o}:{},...s?{style:s}:{},from:{facet:this.assembleFacet()},sort:{field:zr.map(u=>this.facetSortFields(u)).flat(),order:zr.map(u=>this.facetSortOrder(u)).flat()},...r.length>0?{data:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup(Lve(this,[]))}]}getMapping(){return this.facet}}function Cbe(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const o of[n,r])if(so(o.sort)){const{field:s,op:a=fx}=o.sort;e=i=new Ol(e,{joinaggregate:[{op:a,field:s,as:jS(o,o.sort,{forAs:!0})}],groupby:[Y(o)]})}return i}return null}function jW(e,t){var n,r,i,o;for(const s of t){const a=s.data;if(e.name&&s.hasName()&&e.name!==s.dataName)continue;const u=(n=e.format)==null?void 0:n.mesh,l=(r=a.format)==null?void 0:r.feature;if(u&&l)continue;const c=(i=e.format)==null?void 0:i.feature;if((c||l)&&c!==l)continue;const f=(o=a.format)==null?void 0:o.mesh;if(!((u||f)&&u!==f)){if(xp(e)&&xp(a)){if(Zi(e.values,a.values))return s}else if(mf(e)&&mf(a)){if(e.url===a.url)return s}else if(MU(e)&&e.name===s.dataName)return s}}return null}function Abe(e,t){if(e.data||!e.parent){if(e.data===null){const r=new dl({values:[]});return t.push(r),r}const n=jW(e.data,t);if(n)return da(e.data)||(n.data.format=Mj({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new dl(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Tbe(e,t,n){let r=0;for(const i of t.transforms){let o,s;if(vve(i))s=e=new yf(e,i),o="derived";else if(P3(i)){const a=b2e(i);s=e=fn.makeWithAncestors(e,{},a,n)??e,e=new Hf(e,t,i.filter)}else if($U(i))s=e=uo.makeFromTransform(e,i,t),o="number";else if(bve(i))o="date",n.getWithExplicit(i.field).value===void 0&&(e=new fn(e,{[i.field]:o}),n.set(i.field,o,!1)),s=e=ao.makeFromTransform(e,i);else if(wve(i))s=e=_i.makeFromTransform(e,i),o="number",U3(t)&&(e=new Ma(e));else if(kU(i))s=e=Sp.make(e,t,i,r++),o="derived";else if(gve(i))s=e=new Gf(e,i),o="number";else if(mve(i))s=e=new Ol(e,i),o="number";else if(Eve(i))s=e=os.makeFromTransform(e,i),o="derived";else if(Sve(i))s=e=new Tx(e,i),o="derived";else if(yve(i))s=e=new Ax(e,i),o="derived";else if(lve(i))s=e=new Nx(e,i),o="derived";else if(pve(i))e=new Dx(e,i);else if(xve(i))s=e=Iu.makeFromTransform(e,i),o="derived";else if(cve(i))s=e=new Cx(e,i),o="derived";else if(fve(i))s=e=new Mx(e,i),o="derived";else if(dve(i))s=e=new Ox(e,i),o="derived";else if(hve(i))s=e=new Fx(e,i),o="derived";else{U(Yme(i));continue}if(s&&o!==void 0)for(const a of s.producedFields()??[])n.set(a,o,!1)}return e}function Rx(e){var g;let t=Abe(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:r}=e.component.data,i=e.data,s=!(i&&(da(i)||mf(i)||xp(i)))&&e.parent?e.parent.component.data.ancestorParse.clone():new Rve;da(i)?(OU(i)?t=new Sg(t,i.sequence):L3(i)&&(t=new Eg(t,i.graticule)),s.parseNothing=!0):((g=i==null?void 0:i.format)==null?void 0:g.parse)===null&&(s.parseNothing=!0),t=fn.makeExplicit(t,e,s)??t,t=new Ma(t);const a=e.parent&&Yf(e.parent);(ht(e)||ki(e))&&a&&(t=uo.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=Tbe(t,e,s));const u=E2e(e),l=w2e(e);t=fn.makeWithAncestors(t,{},{...u,...l},s)??t,ht(e)&&(t=Fc.parseAll(t,e),t=Ep.parseAll(t,e)),(ht(e)||ki(e))&&(a||(t=uo.makeFromEncoding(t,e)??t),t=ao.makeFromEncoding(t,e)??t,t=yf.parseAllForSortIndex(t,e));const c=e.getDataName(qe.Raw),f=new On(t,c,qe.Raw,r);if(n[c]=f,t=f,ht(e)){const y=_i.makeFromEncoding(t,e);y&&(t=y,U3(e)&&(t=new Ma(t))),t=Iu.makeFromEncoding(t,e)??t,t=os.makeFromEncoding(t,e)??t}ht(e)&&(t=wp.make(t,e)??t);const d=e.getDataName(qe.Main),h=new On(t,d,qe.Main,r);n[d]=h,t=h,ht(e)&&yxe(e,h);let p=null;if(ki(e)){const y=e.getName("facet");t=Cbe(t,e.facet)??t,p=new Vf(t,e,y,h.getSource()),n[y]=p}return{...e.component.data,outputNodes:n,outputNodeRefCounts:r,raw:f,main:h,facetRoot:p,ancestorParse:s}}class Fbe extends Z3{constructor(t,n,r,i){var o,s,a,u;super(t,"concat",n,r,i,t.resolve),(((s=(o=t.resolve)==null?void 0:o.axis)==null?void 0:s.x)==="shared"||((u=(a=t.resolve)==null?void 0:a.axis)==null?void 0:u.y)==="shared")&&U(Hme),this.children=this.getChildren(t).map((l,c)=>oT(l,this,this.getName(`concat_${c}`),void 0,i))}parseData(){this.component.data=Rx(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of B(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return xx(t)?t.vconcat:D3(t)?t.hconcat:t.concat}parseLayoutSize(){_be(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=H3(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...r?{style:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}}function Mbe(e){return e===!1||e===null}const Obe={disable:1,gridScale:1,scale:1,...JB,labelExpr:1,encode:1},BW=B(Obe);class tT extends _s{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new tT(fe(this.explicit),fe(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Mbe(this.get(t))}hasOrientSignalRef(){return re(this.explicit.orient)}}function Nbe(e,t,n){const{encoding:r,config:i}=e,o=Et(r[t])??Et(r[Ao(t)]),s=e.axis(t)||{},{format:a,formatType:u}=s;if(ll(u))return{text:xi({fieldOrDatumDef:o,field:"datum.value",format:a,formatType:u,config:i}),...n};if(a===void 0&&u===void 0&&i.customFormatTypes){if(hf(o)==="quantitative"){if(pf(o)&&o.stack==="normalize"&&i.normalizedNumberFormatType)return{text:xi({fieldOrDatumDef:o,field:"datum.value",format:i.normalizedNumberFormat,formatType:i.normalizedNumberFormatType,config:i}),...n};if(i.numberFormatType)return{text:xi({fieldOrDatumDef:o,field:"datum.value",format:i.numberFormat,formatType:i.numberFormatType,config:i}),...n}}if(hf(o)==="temporal"&&i.timeFormatType&&H(o)&&!o.timeUnit)return{text:xi({fieldOrDatumDef:o,field:"datum.value",format:i.timeFormat,formatType:i.timeFormatType,config:i}),...n}}return n}function Dbe(e){return To.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[Bbe(n,e)]),t),{})}const Rbe={bottom:"top",top:"bottom",left:"right",right:"left"};function Pbe(e){const{axes:t,resolve:n}=e.component,r={top:0,bottom:0,right:0,left:0};for(const i of e.children){i.parseAxesAndHeaders();for(const o of B(i.component.axes))n.axis[o]=V3(e.component.resolve,o),n.axis[o]==="shared"&&(t[o]=Lbe(t[o],i.component.axes[o]),t[o]||(n.axis[o]="independent",delete t[o]))}for(const i of To){for(const o of e.children)if(o.component.axes[i]){if(n.axis[i]==="independent"){t[i]=(t[i]??[]).concat(o.component.axes[i]);for(const s of o.component.axes[i]){const{value:a,explicit:u}=s.getWithExplicit("orient");if(!re(a)){if(r[a]>0&&!u){const l=Rbe[a];r[a]>r[l]&&s.set("orient",l,!1)}r[a]++}}}delete o.component.axes[i]}if(n.axis[i]==="independent"&&t[i]&&t[i].length>1)for(const o of t[i])o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function Lbe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],o=t[r];if(!!i!=!!o)return;if(i&&o){const s=i.getWithExplicit("orient"),a=o.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;e[r]=zbe(i,o)}}}else return t.map(n=>n.clone());return e}function zbe(e,t){for(const n of BW){const r=Aa(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,o)=>{switch(n){case"title":return sB(i,o);case"gridScale":return{explicit:i.explicit,value:mt(i.value,o.value)}}return wx(i,o,n,"axis")});e.setWithExplicit(n,r)}return e}function Ibe(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(re(n.labelAngle)?n.labelAngle:vp(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===sW(r,i))return!0}return e===n[t]}const jbe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Bbe(e,t){var m,v;let n=t.axis(e);const r=new tT,i=Et(t.encoding[e]),{mark:o,config:s}=t,a=(n==null?void 0:n.orient)||((m=s[e==="x"?"axisX":"axisY"])==null?void 0:m.orient)||((v=s.axis)==null?void 0:v.orient)||Cxe(e),u=t.getScaleComponent(e).get("type"),l=bxe(e,u,a,t.config),c=n!==void 0?!n:OS("disable",s.style,n==null?void 0:n.style,l).configValue;if(r.set("disable",c,n!==void 0),c)return r;n=n||{};const f=_xe(i,n,e,s.style,l),d=LB(n.formatType,i,u),h=PB(i,i.type,n.format,n.formatType,s,!0),p={fieldOrDatumDef:i,axis:n,channel:e,model:t,scaleType:u,orient:a,labelAngle:f,format:h,formatType:d,mark:o,config:s};for(const x of BW){const b=x in oR?oR[x](p):PD(x)?n[x]:void 0,w=b!==void 0,S=Ibe(b,x,n,t,e);if(w&&S)r.set(x,b,S);else{const{configValue:E=void 0,configFrom:_=void 0}=PD(x)&&x!=="values"?OS(x,s.style,n.style,l):{},$=E!==void 0;w&&!$?r.set(x,b,S):(_!=="vgAxisConfig"||jbe.has(x)&&$||bg(E)||re(E))&&r.set(x,E,!1)}}const g=n.encoding??{},y=KB.reduce((x,b)=>{if(!r.hasAxisPart(b))return x;const w=dW(g[b]??{},t),S=b==="labels"?Nbe(t,e,w):w;return S!==void 0&&!Ie(S)&&(x[b]={update:S}),x},{});return Ie(y)||r.set("encode",y,!!n.encoding||n.labelAngle!==void 0),r}function Ube({encoding:e,size:t}){for(const n of To){const r=ur(n);vo(t[r])&&Ks(e[n])&&(delete t[r],U(fB(r)))}return t}function Wbe(e,t,n){const r=qn(e),i=Pe("orient",r,n);if(r.orient=Gbe(r.type,t,i),i!==void 0&&i!==r.orient&&U(d0e(r.orient,i)),r.type==="bar"&&r.orient){const a=Pe("cornerRadiusEnd",r,n);if(a!==void 0){const u=r.orient==="horizontal"&&t.x2||r.orient==="vertical"&&t.y2?["cornerRadius"]:F1e[r.orient];for(const l of u)r[l]=a;r.cornerRadiusEnd!==void 0&&delete r.cornerRadiusEnd}}return Pe("opacity",r,n)===void 0&&(r.opacity=Hbe(r.type,t)),Pe("cursor",r,n)===void 0&&(r.cursor=qbe(r,t,n)),r}function qbe(e,t,n){return t.href||e.href||Pe("href",e,n)?"pointer":e.cursor}function Hbe(e,t){if(we([cx,d3,h3,p3],e)&&!_3(t))return .7}function Vbe(e,t,{graticule:n}){if(n)return!1;const r=ol("filled",e,t),i=e.type;return mt(r,i!==cx&&i!==lx&&i!==ny)}function Gbe(e,t,n){switch(e){case cx:case h3:case p3:case TB:case b1e:case x1e:return}const{x:r,y:i,x2:o,y2:s}=t;switch(e){case ux:if(H(r)&&(Ut(r.bin)||H(i)&&i.aggregate&&!r.aggregate))return"vertical";if(H(i)&&(Ut(i.bin)||H(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o)return(H(r)&&r.type===al&&!Ge(r.bin)||iy(r))&&H(i)&&Ut(i.bin)?"horizontal":"vertical";if(!s)return(H(i)&&i.type===al&&!Ge(i.bin)||iy(i))&&H(r)&&Ut(r.bin)?"vertical":"horizontal"}case ny:if(o&&!(H(r)&&Ut(r.bin))&&s&&!(H(i)&&Ut(i.bin)))return;case ax:if(s)return H(i)&&Ut(i.bin)?"horizontal":"vertical";if(o)return H(r)&&Ut(r.bin)?"vertical":"horizontal";if(e===ny){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case lx:case d3:{const a=DD(r),u=DD(i);if(n)return n;if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u)return"vertical";{const l=Rn(r)&&r.type===ff,c=Rn(i)&&i.type===ff;if(l&&!c)return"vertical";if(!l&&c)return"horizontal"}return}}return"vertical"}const Ybe={vgMark:"arc",encodeEntry:e=>({...Jr(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...cn("x",e,{defaultPos:"mid"}),...cn("y",e,{defaultPos:"mid"}),...Ta(e,"radius"),...Ta(e,"theta")})},Xbe={vgMark:"area",encodeEntry:e=>({...Jr(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...fy("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...fy("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...B3(e)})},Qbe={vgMark:"rect",encodeEntry:e=>({...Jr(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ta(e,"x"),...Ta(e,"y")})},Kbe={vgMark:"shape",encodeEntry:e=>({...Jr(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&H(n)&&n.type===Wf?{field:Y(n,{expr:"datum"})}:{}}]}},Jbe={vgMark:"image",encodeEntry:e=>({...Jr(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...Ta(e,"x"),...Ta(e,"y"),...I3(e,"url")})},Zbe={vgMark:"line",encodeEntry:e=>({...Jr(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...cn("x",e,{defaultPos:"mid"}),...cn("y",e,{defaultPos:"mid"}),...At("size",e,{vgChannel:"strokeWidth"}),...B3(e)})},ewe={vgMark:"trail",encodeEntry:e=>({...Jr(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...cn("x",e,{defaultPos:"mid"}),...cn("y",e,{defaultPos:"mid"}),...At("size",e),...B3(e)})};function nT(e,t){const{config:n}=e;return{...Jr(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...cn("x",e,{defaultPos:"mid"}),...cn("y",e,{defaultPos:"mid"}),...At("size",e),...At("angle",e),...twe(e,n,t)}}function twe(e,t,n){return n?{shape:{value:n}}:At("shape",e)}const nwe={vgMark:"symbol",encodeEntry:e=>nT(e)},rwe={vgMark:"symbol",encodeEntry:e=>nT(e,"circle")},iwe={vgMark:"symbol",encodeEntry:e=>nT(e,"square")},owe={vgMark:"rect",encodeEntry:e=>({...Jr(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Ta(e,"x"),...Ta(e,"y")})},swe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...Jr(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...fy("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...fy("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...At("size",e,{vgChannel:"strokeWidth"})}}},awe={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...Jr(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...cn("x",e,{defaultPos:"mid"}),...cn("y",e,{defaultPos:"mid"}),...I3(e),...At("size",e,{vgChannel:"fontSize"}),...At("angle",e),...tR("align",uwe(e.markDef,n,t)),...tR("baseline",lwe(e.markDef,n,t)),...cn("radius",e,{defaultPos:null}),...cn("theta",e,{defaultPos:null})}}};function uwe(e,t,n){if(Pe("align",e,n)===void 0)return"center"}function lwe(e,t,n){if(Pe("baseline",e,n)===void 0)return"middle"}const cwe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",o=r==="horizontal"?"height":"width";return{...Jr(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...cn("x",e,{defaultPos:"mid",vgChannel:"xc"}),...cn("y",e,{defaultPos:"mid",vgChannel:"yc"}),...At("size",e,{defaultValue:fwe(e),vgChannel:i}),[o]:Qe(Pe("thickness",n,t))}}};function fwe(e){const{config:t,markDef:n}=e,{orient:r}=n,i=r==="horizontal"?"width":"height",o=e.getScaleComponent(r==="horizontal"?"x":"y"),s=Pe("size",n,t,{vgChannel:i})??t.tick.bandSize;if(s!==void 0)return s;{const a=o?o.get("range"):void 0;return a&&Ya(a)&&je(a.step)?a.step*3/4:ly(t.view,i)*3/4}}const wm={arc:Ybe,area:Xbe,bar:Qbe,circle:rwe,geoshape:Kbe,image:Jbe,line:Zbe,point:nwe,rect:owe,rule:swe,square:iwe,text:awe,tick:cwe,trail:ewe};function dwe(e){if(we([lx,ax,w1e],e.mark)){const t=nU(e.mark,e.encoding);if(t.length>0)return hwe(e,t)}else if(e.mark===ux){const t=xS.some(n=>Pe(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return pwe(e)}return rT(e)}const wR="faceted_path_";function hwe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:wR+e.requestDataName(qe.Main),data:e.requestDataName(qe.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:rT(e,{fromPrefix:wR})}]}const ER="stack_group_";function pwe(e){var l;const[t]=rT(e,{fromPrefix:ER}),n=e.scaleName(e.stack.fieldChannel),r=(c={})=>e.vgField(e.stack.fieldChannel,c),i=(c,f)=>{const d=[r({prefix:"min",suffix:"start",expr:f}),r({prefix:"max",suffix:"start",expr:f}),r({prefix:"min",suffix:"end",expr:f}),r({prefix:"max",suffix:"end",expr:f})];return`${c}(${d.map(h=>`scale('${n}',${h})`).join(",")})`};let o,s;e.stack.fieldChannel==="x"?(o={...uf(t.encode.update,["y","yc","y2","height",...xS]),x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}},s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...Zn(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(o={...uf(t.encode.update,["x","xc","x2","width"]),y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}},s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...Zn(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const c of xS){const f=ol(c,e.markDef,e.config);t.encode.update[c]?(o[c]=t.encode.update[c],delete t.encode.update[c]):f&&(o[c]=Qe(f)),f&&(t.encode.update[c]={value:0})}const a=[];if(((l=e.stack.groupbyChannels)==null?void 0:l.length)>0)for(const c of e.stack.groupbyChannels){const f=e.fieldDef(c),d=Y(f);d&&a.push(d),(f!=null&&f.bin||f!=null&&f.timeUnit)&&a.push(Y(f,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,f)=>{if(t.encode.update[f])return{...c,[f]:t.encode.update[f]};{const d=ol(f,e.markDef,e.config);return d!==void 0?{...c,[f]:Qe(d)}:c}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(qe.Main),name:ER+e.requestDataName(qe.Main),groupby:a,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[t]}]}]}function gwe(e){var a;const{encoding:t,stack:n,mark:r,markDef:i,config:o}=e,s=t.order;if(!(!I(s)&&Fi(s)&&yS(s.value)||!s&&yS(Pe("order",i,o)))){if((I(s)||H(s))&&!n)return rB(s,{expr:"datum"});if(Xa(r)){const u=i.orient==="horizontal"?"y":"x",l=t[u];if(H(l)){const c=l.sort;if(I(c))return{field:Y(l,{prefix:u,suffix:"sort_index",expr:"datum"})};if(so(c))return{field:Y({aggregate:_3(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})};if(IB(c)){const f=e.fieldDef(c.encoding);return{field:Y(f,{expr:"datum"}),order:c.order}}else return c===null?void 0:{field:Y(l,{binSuffix:(a=e.stack)!=null&&a.impute?"mid":void 0,expr:"datum"})}}return}}}function rT(e,t={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:o}=e,s=mt(r.clip,mwe(e),ywe(e)),a=tB(r),u=i.key,l=gwe(e),c=vwe(e),f=Pe("aria",r,o),d=wm[n].postEncodingTransform?wm[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:wm[n].vgMark,...s?{clip:!0}:{},...a?{style:a}:{},...u?{key:u.field}:{},...l?{sort:l}:{},...c||{},...f===!1?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(qe.Main)},encode:{update:wm[n].encodeEntry(e)},...d?{transform:d}:{}}]}function mwe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t!=null&&t.get("selectionExtent")||n!=null&&n.get("selectionExtent")?!0:void 0}function ywe(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function vwe(e){if(!e.component.selection)return null;const t=B(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=B(r.component.selection).length,r=r.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip}:null}class UW extends LW{constructor(t,n,r,i={},o){super(t,"unit",n,r,o,void 0,zD(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const s=mo(t.mark)?{...t.mark}:{type:t.mark},a=s.type;s.filled===void 0&&(s.filled=Vbe(s,o,{graticule:t.data&&L3(t.data)}));const u=this.encoding=sye(t.encoding||{},a,s.filled,o);this.markDef=Wbe(s,u,o),this.size=Ube({encoding:u,size:zD(t)?{...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:i}),this.stack=EU(this.markDef,u),this.specifiedScales=this.initScales(a,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(l=>O3(l))}get hasProjection(){const{encoding:t}=this,n=this.mark===FB,r=t&&ome.some(i=>ce(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return rx.reduce((r,i)=>{const o=Et(n[i]);return o&&(r[i]=this.initScale(o.scale??{})),r},{})}initScale(t){const{domain:n,range:r}=t,i=qn(t);return I(n)&&(i.domain=n.map(mr)),I(r)&&(i.range=r.map(mr)),i}initAxes(t){return To.reduce((n,r)=>{const i=t[r];if(ce(i)||r===tt&&ce(t.x2)||r===Rt&&ce(t.y2)){const o=ce(i)?i.axis:void 0;n[r]=o&&this.initAxis({...o})}return n},{})}initAxis(t){const n=B(t),r={};for(const i of n){const o=t[i];r[i]=bg(o)?eB(o):mr(o)}return r}initLegends(t){return gme.reduce((n,r)=>{const i=Et(t[r]);if(i&&yme(r)){const o=i.legend;n[r]=o&&qn(o)}return n},{})}parseData(){this.component.data=Rx(this)}parseLayoutSize(){kbe(this)}parseSelections(){this.component.selection=mxe(this,this.selection)}parseMarkGroup(){this.component.mark=dwe(this)}parseAxesAndHeaders(){this.component.axes=Dbe(this)}assembleSelectionTopLevelSignals(t){return zve(this,t)}assembleSignals(){return[...rW(this),...Pve(this,[])]}assembleSelectionData(t){return Ive(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return H3(this)}assembleMarks(){let t=this.component.mark??[];return(!this.parent||!Yf(this.parent))&&(t=RU(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Lu(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return yo(n)}typedFieldDef(t){const n=this.fieldDef(t);return Rn(n)?n:null}}class iT extends Z3{constructor(t,n,r,i,o){super(t,"layer",n,r,o,t.resolve,t.view);const s={...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((a,u)=>{if(bx(a))return new iT(a,this,this.getName(`layer_${u}`),s,o);if(Ss(a))return new UW(a,this,this.getName(`layer_${u}`),s,o);throw new Error(KA(a))})}parseData(){this.component.data=Rx(this);for(const t of this.children)t.parseData()}parseLayoutSize(){Sbe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of B(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){Pbe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),rW(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),H3(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const r of this.children)for(const i of K(r.assembleGroupStyle()))t.add(i);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return jve(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),bW(this))}}function oT(e,t,n,r,i){if(dx(e))return new Ah(e,t,n,i);if(bx(e))return new iT(e,t,n,r,i);if(Ss(e))return new UW(e,t,n,r,i);if(Fye(e))return new Fbe(e,t,n,i);throw new Error(KA(e))}function xwe(e,t={}){t.logger&&L0e(t.logger),t.fieldTitle&&YB(t.fieldTitle);try{const n=wU($f(t.config,e.config)),r=TU(e,n),i=oT(r,null,"",void 0,n);return i.parse(),z2e(i.component.data,i),{spec:wwe(i,bwe(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&z0e(),t.fieldTitle&&K1e()}}function bwe(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):Q(t)&&(t={type:t}),i&&o&&Ove(t.type)){if(i==="step"&&o==="step")U(ED()),t.type="pad";else if(i==="step"||o==="step"){const s=i==="step"?"width":"height";U(ED(nx(s)));const a=s==="width"?"height":"width";t.type=Nve(a)}}return{...B(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...QD(n,!1),...QD(e,!0)}}function wwe(e,t,n={},r){const i=e.config?qye(e.config):void 0,o=[].concat(e.assembleSelectionData([]),xbe(e.component.data,n)),s=e.assembleProjections(),a=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>(h.name==="width"||h.name==="height")&&h.value!==void 0?(t[h.name]=+h.value,!1):!0);const{params:f,...d}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...d,...a?{title:a}:{},...u?{style:u}:{},...l?{encode:{update:l}}:{},data:o,...s.length>0?{projections:s}:{},...e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...yU(f)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}const Ewe=Xge.version,Swe=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:lf,accessPathWithDatum:UA,compile:xwe,contains:we,deepEqual:Zi,deleteNestedProperty:Z1,duplicate:fe,entries:$a,every:IA,fieldIntersection:BA,flatAccessWithDatum:Nj,getFirstDefined:mt,hasIntersection:jA,hash:ke,internalField:Pj,isBoolean:yp,isEmpty:Ie,isEqual:tme,isInternalField:Lj,isNullOrFalse:yS,isNumeric:Qv,keys:B,logicalExpr:$h,mergeDeep:Mj,never:Fj,normalize:TU,normalizeAngle:vp,omit:Zn,pick:uf,prefixGenerator:vS,removePathFromField:WA,replaceAll:rl,replacePathInField:Yr,resetIdCounter:rme,setEqual:Oj,some:nl,stringify:Ve,titleCase:cg,unique:eo,uniqueId:Rj,vals:Gt,varName:et,version:Ewe},Symbol.toStringTag,{value:"Module"}));function WW(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var _we="vega-themes",kwe="2.13.0",$we="Themes for stylized Vega and Vega-Lite visualizations.",Cwe=["vega","vega-lite","themes","style"],Awe="BSD-3-Clause",Twe={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},Fwe=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],Mwe="build/vega-themes.js",sT="build/vega-themes.module.js",Owe="build/vega-themes.min.js",Nwe="build/vega-themes.min.js",Dwe="build/vega-themes.module.d.ts",Rwe={type:"git",url:"https://github.com/vega/vega-themes.git"},Pwe=["src","build"],Lwe={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},zwe={"@babel/core":"^7.21.4","@babel/plugin-transform-runtime":"^7.21.4","@babel/preset-env":"^7.21.4","@babel/preset-typescript":"^7.21.4","@release-it/conventional-changelog":"^5.1.1","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.2","@rollup/plugin-terser":"^0.4.1","@typescript-eslint/eslint-plugin":"^5.59.0","@typescript-eslint/parser":"^5.59.0","browser-sync":"^2.29.1",concurrently:"^8.0.1",eslint:"^8.38.0","eslint-config-prettier":"^8.8.0","eslint-plugin-prettier":"^4.2.1","gh-pages":"^5.0.0",prettier:"^2.8.7","release-it":"^15.10.1",rollup:"^3.20.6","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.2.0",typescript:"^5.0.4",vega:"^5.24.0","vega-lite":"^5.7.1"},Iwe={vega:"*","vega-lite":"*"},jwe={},Bwe={name:_we,version:kwe,description:$we,keywords:Cwe,license:Awe,author:Twe,contributors:Fwe,main:Mwe,module:sT,unpkg:Owe,jsdelivr:Nwe,types:Dwe,repository:Rwe,files:Pwe,scripts:Lwe,devDependencies:zwe,peerDependencies:Iwe,dependencies:jwe};const Hl="#fff",SR="#888",Uwe={background:"#333",view:{stroke:SR},title:{color:Hl,subtitleColor:Hl},style:{"guide-label":{fill:Hl},"guide-title":{fill:Hl}},axis:{domainColor:Hl,gridColor:SR,tickColor:Hl}},nu="#4572a7",Wwe={background:"#fff",arc:{fill:nu},area:{fill:nu},line:{stroke:nu,strokeWidth:2},path:{stroke:nu},rect:{fill:nu},shape:{stroke:nu},symbol:{fill:nu,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},ru="#30a2da",$b="#cbcbcb",qwe="#999",Hwe="#333",_R="#f0f0f0",kR="#333",Vwe={arc:{fill:ru},area:{fill:ru},axis:{domainColor:$b,grid:!0,gridColor:$b,gridWidth:1,labelColor:qwe,labelFontSize:10,titleColor:Hwe,tickColor:$b,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:_R,group:{fill:_R},legend:{labelColor:kR,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:kR,titleFontSize:14,titlePadding:10},line:{stroke:ru,strokeWidth:2},path:{stroke:ru,strokeWidth:.5},rect:{fill:ru},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:ru},bar:{binSpacing:2,fill:ru,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},iu="#000",Gwe={group:{fill:"#e5e5e5"},arc:{fill:iu},area:{fill:iu},line:{stroke:iu},path:{stroke:iu},rect:{fill:iu},shape:{stroke:iu},symbol:{fill:iu,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Ywe=22,Xwe="normal",$R="Benton Gothic, sans-serif",CR=11.5,Qwe="normal",ou="#82c6df",Cb="Benton Gothic Bold, sans-serif",AR="normal",TR=13,$d={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},Kwe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:Cb,fontSize:Ywe,fontWeight:Xwe},arc:{fill:ou},area:{fill:ou},line:{stroke:ou,strokeWidth:2},path:{stroke:ou},rect:{fill:ou},shape:{stroke:ou},symbol:{fill:ou,size:30},axis:{labelFont:$R,labelFontSize:CR,labelFontWeight:Qwe,titleFont:Cb,titleFontSize:TR,titleFontWeight:AR},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:$R,labelFontSize:CR,symbolType:"square",titleFont:Cb,titleFontSize:TR,titleFontWeight:AR},range:{category:$d["category-6"],diverging:$d["fireandice-6"],heatmap:$d["fire-7"],ordinal:$d["fire-7"],ramp:$d["fire-7"]}},su="#ab5787",Em="#979797",Jwe={background:"#f9f9f9",arc:{fill:su},area:{fill:su},line:{stroke:su},path:{stroke:su},rect:{fill:su},shape:{stroke:su},symbol:{fill:su,size:30},axis:{domainColor:Em,domainWidth:.5,gridWidth:.2,labelColor:Em,tickColor:Em,tickWidth:.2,titleColor:Em},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},au="#3e5c69",Zwe={background:"#fff",arc:{fill:au},area:{fill:au},line:{stroke:au},path:{stroke:au},rect:{fill:au},shape:{stroke:au},symbol:{fill:au},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Mr="#1696d2",FR="#000000",eEe="#FFFFFF",Sm="Lato",Ab="Lato",tEe="Lato",nEe="#DEDDDD",rEe=18,Cd={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},iEe={background:eEe,title:{anchor:"start",fontSize:rEe,font:Sm},axisX:{domain:!0,domainColor:FR,domainWidth:1,grid:!1,labelFontSize:12,labelFont:Ab,labelAngle:0,tickColor:FR,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Sm},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:nEe,gridWidth:1,labelFontSize:12,labelFont:Ab,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Sm,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:Ab,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Sm,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Cd["six-groups-cat-1"],diverging:Cd["diverging-colors"],heatmap:Cd["diverging-colors"],ordinal:Cd["six-groups-seq"],ramp:Cd["shades-blue"]},area:{fill:Mr},rect:{fill:Mr},line:{color:Mr,stroke:Mr,strokeWidth:5},trail:{color:Mr,stroke:Mr,strokeWidth:0,size:1},path:{stroke:Mr,strokeWidth:.5},point:{filled:!0},text:{font:tEe,color:Mr,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Mr,stroke:null}},arc:{fill:Mr},shape:{stroke:Mr},symbol:{fill:Mr,size:30}},uu="#3366CC",MR="#ccc",_m="Arial, sans-serif",oEe={arc:{fill:uu},area:{fill:uu},path:{stroke:uu},rect:{fill:uu},shape:{stroke:uu},symbol:{stroke:uu},circle:{fill:uu},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:_m,fontSize:12},"guide-title":{font:_m,fontSize:12},"group-title":{font:_m,fontSize:12}},title:{font:_m,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:MR,tickColor:MR,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},aT=e=>e*(1/3+1),OR=aT(9),NR=aT(10),DR=aT(12),Ad="Segoe UI",RR="wf_standard-font, helvetica, arial, sans-serif",PR="#252423",Td="#605E5C",LR="transparent",sEe="#C8C6C4",ri="#118DFF",aEe="#12239E",uEe="#E66C37",lEe="#6B007B",cEe="#E044A7",fEe="#744EC2",dEe="#D9B300",hEe="#D64550",qW=ri,HW="#DEEFFF",zR=[HW,qW],pEe=[HW,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",qW],gEe={view:{stroke:LR},background:LR,font:Ad,header:{titleFont:RR,titleFontSize:DR,titleColor:PR,labelFont:Ad,labelFontSize:NR,labelColor:Td},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Td,labelFontSize:OR,titleFont:RR,titleColor:PR,titleFontSize:DR,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:sEe,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:ri},line:{stroke:ri,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:Ad,fontSize:OR,fill:Td},arc:{fill:ri},area:{fill:ri,line:!0,opacity:.6},path:{stroke:ri},rect:{fill:ri},point:{fill:ri,filled:!0,size:75},shape:{stroke:ri},symbol:{fill:ri,strokeWidth:1.5,size:50},legend:{titleFont:Ad,titleFontWeight:"bold",titleColor:Td,labelFont:Ad,labelFontSize:NR,labelColor:Td,symbolType:"circle",symbolSize:75},range:{category:[ri,aEe,uEe,lEe,cEe,fEe,dEe,hEe],diverging:zR,heatmap:zR,ordinal:pEe}},mEe=Bwe.version,yEe=Object.freeze(Object.defineProperty({__proto__:null,dark:Uwe,excel:Wwe,fivethirtyeight:Vwe,ggplot2:Gwe,googlecharts:oEe,latimes:Kwe,powerbi:gEe,quartz:Jwe,urbaninstitute:iEe,version:mEe,vox:Zwe},Symbol.toStringTag,{value:"Module"}));function _p(e){return _p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_p(e)}function vEe(e,t){if(_p(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_p(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xEe(e){var t=vEe(e,"string");return _p(t)==="symbol"?t:String(t)}function bEe(e,t,n){return t=xEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wEe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,o;for(o=0;o<r.length;o++)i=r[o],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function EEe(e,t){if(e==null)return{};var n=wEe(e,t),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const SEe=["title","image"];function _Ee(e,t,n){if(I(e))return`[${e.map(r=>t(Q(r)?r:IR(r,n))).join(", ")}]`;if(J(e)){let r="";const i=e,{title:o,image:s}=i,a=EEe(i,SEe);o&&(r+=`<h2>${t(o)}</h2>`),s&&(r+=`<img src="${t(s)}">`);const u=Object.keys(a);if(u.length>0){r+="<table>";for(const l of u){let c=a[l];c!==void 0&&(J(c)&&(c=IR(c,n)),r+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function kEe(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function IR(e,t){return JSON.stringify(e,kEe(t))}var $Ee=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`;const VW="vg-tooltip-element",CEe={offsetX:10,offsetY:10,id:VW,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:AEe,maxDepth:2,formatTooltip:_Ee};function AEe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function TEe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return $Ee.toString().replace(VW,e)}function FEe(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}function jR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function BR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jR(Object(n),!0).forEach(function(r){bEe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jR(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}class MEe{constructor(t){this.options=BR(BR({},CEe),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=TEe(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:s}=FEe(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.style.top=`${s}px`,this.el.style.left=`${o}px`}}function kp(e){return kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kp(e)}function OEe(e,t){if(kp(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(kp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NEe(e){var t=OEe(e,"string");return kp(t)==="symbol"?t:String(t)}function DEe(e,t,n){return t=NEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function REe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Tb,UR;function PEe(){return UR||(UR=1,Tb=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),Tb}var LEe=Me;Me.Node=hl;Me.create=Me;function Me(e){var t=this;if(t instanceof Me||(t=new Me),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}Me.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};Me.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};Me.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};Me.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)IEe(this,arguments[e]);return this.length};Me.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)jEe(this,arguments[e]);return this.length};Me.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};Me.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};Me.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next};Me.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev};Me.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};Me.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};Me.prototype.map=function(e,t){t=t||this;for(var n=new Me,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n};Me.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Me,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n};Me.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n};Me.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n};Me.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};Me.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};Me.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new Me;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n};Me.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new Me;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n};Me.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var o=[],r=0;i&&r<t;r++)o.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=zEe(this,i,n[r]);return o};Me.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function zEe(e,t,n){var r=t===e.head?new hl(n,null,t,e):new hl(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function IEe(e,t){e.tail=new hl(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function jEe(e,t){e.head=new hl(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function hl(e,t,n,r){if(!(this instanceof hl))return new hl(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{PEe()(Me)}catch{}const BEe=LEe,xu=Symbol("max"),Bo=Symbol("length"),Vl=Symbol("lengthCalculator"),Th=Symbol("allowStale"),Cu=Symbol("maxAge"),Lo=Symbol("dispose"),WR=Symbol("noDisposeOnSet"),$t=Symbol("lruList"),ii=Symbol("cache"),GW=Symbol("updateAgeOnGet"),Fb=()=>1;class UEe{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[xu]=t.max||1/0;const n=t.length||Fb;if(this[Vl]=typeof n!="function"?Fb:n,this[Th]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[Cu]=t.maxAge||0,this[Lo]=t.dispose,this[WR]=t.noDisposeOnSet||!1,this[GW]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[xu]=t||1/0,Fd(this)}get max(){return this[xu]}set allowStale(t){this[Th]=!!t}get allowStale(){return this[Th]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[Cu]=t,Fd(this)}get maxAge(){return this[Cu]}set lengthCalculator(t){typeof t!="function"&&(t=Fb),t!==this[Vl]&&(this[Vl]=t,this[Bo]=0,this[$t].forEach(n=>{n.length=this[Vl](n.value,n.key),this[Bo]+=n.length})),Fd(this)}get lengthCalculator(){return this[Vl]}get length(){return this[Bo]}get itemCount(){return this[$t].length}rforEach(t,n){n=n||this;for(let r=this[$t].tail;r!==null;){const i=r.prev;qR(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[$t].head;r!==null;){const i=r.next;qR(this,t,r,n),r=i}}keys(){return this[$t].toArray().map(t=>t.key)}values(){return this[$t].toArray().map(t=>t.value)}reset(){this[Lo]&&this[$t]&&this[$t].length&&this[$t].forEach(t=>this[Lo](t.key,t.value)),this[ii]=new Map,this[$t]=new BEe,this[Bo]=0}dump(){return this[$t].map(t=>gy(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[$t]}set(t,n,r){if(r=r||this[Cu],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,o=this[Vl](n,t);if(this[ii].has(t)){if(o>this[xu])return Mc(this,this[ii].get(t)),!1;const u=this[ii].get(t).value;return this[Lo]&&(this[WR]||this[Lo](t,u.value)),u.now=i,u.maxAge=r,u.value=n,this[Bo]+=o-u.length,u.length=o,this.get(t),Fd(this),!0}const s=new WEe(t,n,o,i,r);return s.length>this[xu]?(this[Lo]&&this[Lo](t,n),!1):(this[Bo]+=s.length,this[$t].unshift(s),this[ii].set(t,this[$t].head),Fd(this),!0)}has(t){if(!this[ii].has(t))return!1;const n=this[ii].get(t).value;return!gy(this,n)}get(t){return Mb(this,t,!0)}peek(t){return Mb(this,t,!1)}pop(){const t=this[$t].tail;return t?(Mc(this,t),t.value):null}del(t){Mc(this,this[ii].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],o=i.e||0;if(o===0)this.set(i.k,i.v);else{const s=o-n;s>0&&this.set(i.k,i.v,s)}}}prune(){this[ii].forEach((t,n)=>Mb(this,n,!1))}}const Mb=(e,t,n)=>{const r=e[ii].get(t);if(r){const i=r.value;if(gy(e,i)){if(Mc(e,r),!e[Th])return}else n&&(e[GW]&&(r.value.now=Date.now()),e[$t].unshiftNode(r));return i.value}},gy=(e,t)=>{if(!t||!t.maxAge&&!e[Cu])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Cu]&&n>e[Cu]},Fd=e=>{if(e[Bo]>e[xu])for(let t=e[$t].tail;e[Bo]>e[xu]&&t!==null;){const n=t.prev;Mc(e,t),t=n}},Mc=(e,t)=>{if(t){const n=t.value;e[Lo]&&e[Lo](n.key,n.value),e[Bo]-=n.length,e[ii].delete(n.key),e[$t].removeNode(t)}};class WEe{constructor(t,n,r,i,o){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=o||0}}const qR=(e,t,n,r)=>{let i=n.value;gy(e,i)&&(Mc(e,n),e[Th]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var qEe=UEe;const HEe=Object.freeze({loose:!0}),VEe=Object.freeze({}),GEe=e=>e?typeof e!="object"?HEe:e:VEe;var uT=GEe,BS={exports:{}};const YEe="2.0.0",XEe=256,QEe=Number.MAX_SAFE_INTEGER||9007199254740991,KEe=16,JEe=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var lT={MAX_LENGTH:XEe,MAX_SAFE_COMPONENT_LENGTH:KEe,MAX_SAFE_INTEGER:QEe,RELEASE_TYPES:JEe,SEMVER_SPEC_VERSION:YEe,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const ZEe=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var Px=ZEe;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=lT,r=Px;t=e.exports={};const i=t.re=[],o=t.src=[],s=t.t={};let a=0;const u=(l,c,f)=>{const d=a++;r(l,d,c),s[l]=d,o[d]=c,i[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\.${o[s.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${o[s.BUILDIDENTIFIER]}(?:\\.${o[s.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`),u("FULL",`^${o[s.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`),u("LOOSE",`^${o[s.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${o[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${o[s.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`),u("XRANGE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",o[s.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${o[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${o[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${o[s.GTLT]}\\s*(${o[s.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${o[s.XRANGEPLAIN]})\\s+-\\s+(${o[s.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${o[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[s.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(BS,BS.exports);var cT=BS.exports;const HR=/^[0-9]+$/,YW=(e,t)=>{const n=HR.test(e),r=HR.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},eSe=(e,t)=>YW(t,e);var tSe={compareIdentifiers:YW,rcompareIdentifiers:eSe};const km=Px,{MAX_LENGTH:VR,MAX_SAFE_INTEGER:$m}=lT,{re:GR,t:YR}=cT,nSe=uT,{compareIdentifiers:Gl}=tSe;let rSe=class qi{constructor(t,n){if(n=nSe(n),t instanceof qi){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>VR)throw new TypeError(`version is longer than ${VR} characters`);km("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?GR[YR.LOOSE]:GR[YR.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>$m||this.major<0)throw new TypeError("Invalid major version");if(this.minor>$m||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>$m||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const o=+i;if(o>=0&&o<$m)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(km("SemVer.compare",this.version,this.options,t),!(t instanceof qi)){if(typeof t=="string"&&t===this.version)return 0;t=new qi(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof qi||(t=new qi(t,this.options)),Gl(this.major,t.major)||Gl(this.minor,t.minor)||Gl(this.patch,t.patch)}comparePre(t){if(t instanceof qi||(t=new qi(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(km("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Gl(r,i)}while(++n)}compareBuild(t){t instanceof qi||(t=new qi(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(km("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Gl(r,i)}while(++n)}inc(t,n,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);i===-1&&this.prerelease.push(0)}if(n){const i=Number(r)?1:0;Gl(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=[n,i]):this.prerelease=[n,i]}break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}};var fT=rSe;const XR=fT,iSe=(e,t,n)=>new XR(e,n).compare(new XR(t,n));var Xf=iSe;const oSe=Xf,sSe=(e,t,n)=>oSe(e,t,n)===0;var aSe=sSe;const uSe=Xf,lSe=(e,t,n)=>uSe(e,t,n)!==0;var cSe=lSe;const fSe=Xf,dSe=(e,t,n)=>fSe(e,t,n)>0;var hSe=dSe;const pSe=Xf,gSe=(e,t,n)=>pSe(e,t,n)>=0;var mSe=gSe;const ySe=Xf,vSe=(e,t,n)=>ySe(e,t,n)<0;var xSe=vSe;const bSe=Xf,wSe=(e,t,n)=>bSe(e,t,n)<=0;var ESe=wSe;const SSe=aSe,_Se=cSe,kSe=hSe,$Se=mSe,CSe=xSe,ASe=ESe,TSe=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return SSe(e,n,r);case"!=":return _Se(e,n,r);case">":return kSe(e,n,r);case">=":return $Se(e,n,r);case"<":return CSe(e,n,r);case"<=":return ASe(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var FSe=TSe,Ob,QR;function MSe(){if(QR)return Ob;QR=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}s("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(c){const f=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],d=c.match(f);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new a(d[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(s("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new a(c,this.options)}catch{return!1}return o(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new u(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||o(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||o(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}Ob=t;const n=uT,{re:r,t:i}=cT,o=FSe,s=Px,a=fT,u=XW();return Ob}var Nb,KR;function XW(){if(KR)return Nb;KR=1;class e{constructor(F,T){if(T=r(T),F instanceof e)return F.loose===!!T.loose&&F.includePrerelease===!!T.includePrerelease?F:new e(F.raw,T);if(F instanceof i)return this.raw=F.value,this.set=[[F]],this.format(),this;if(this.options=T,this.loose=!!T.loose,this.includePrerelease=!!T.includePrerelease,this.raw=F,this.set=F.split("||").map(O=>this.parseRange(O.trim())).filter(O=>O.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${F}`);if(this.set.length>1){const O=this.set[0];if(this.set=this.set.filter(D=>!p(D[0])),this.set.length===0)this.set=[O];else if(this.set.length>1){for(const D of this.set)if(D.length===1&&g(D[0])){this.set=[D];break}}}this.format()}format(){return this.range=this.set.map(F=>F.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(F){F=F.trim();const O=((this.options.includePrerelease&&d)|(this.options.loose&&h))+":"+F,D=n.get(O);if(D)return D;const M=this.options.loose,N=M?a[u.HYPHENRANGELOOSE]:a[u.HYPHENRANGE];F=F.replace(N,A(this.options.includePrerelease)),o("hyphen replace",F),F=F.replace(a[u.COMPARATORTRIM],l),o("comparator trim",F),F=F.replace(a[u.TILDETRIM],c),F=F.replace(a[u.CARETTRIM],f),F=F.split(/\s+/).join(" ");let j=F.split(" ").map(de=>m(de,this.options)).join(" ").split(/\s+/).map(de=>k(de,this.options));M&&(j=j.filter(de=>(o("loose invalid filter",de,this.options),!!de.match(a[u.COMPARATORLOOSE])))),o("range list",j);const X=new Map,te=j.map(de=>new i(de,this.options));for(const de of te){if(p(de))return[de];X.set(de.value,de)}X.size>1&&X.has("")&&X.delete("");const xe=[...X.values()];return n.set(O,xe),xe}intersects(F,T){if(!(F instanceof e))throw new TypeError("a Range is required");return this.set.some(O=>y(O,T)&&F.set.some(D=>y(D,T)&&O.every(M=>D.every(N=>M.intersects(N,T)))))}test(F){if(!F)return!1;if(typeof F=="string")try{F=new s(F,this.options)}catch{return!1}for(let T=0;T<this.set.length;T++)if(R(this.set[T],F,this.options))return!0;return!1}}Nb=e;const t=qEe,n=new t({max:1e3}),r=uT,i=MSe(),o=Px,s=fT,{re:a,t:u,comparatorTrimReplace:l,tildeTrimReplace:c,caretTrimReplace:f}=cT,{FLAG_INCLUDE_PRERELEASE:d,FLAG_LOOSE:h}=lT,p=C=>C.value==="<0.0.0-0",g=C=>C.value==="",y=(C,F)=>{let T=!0;const O=C.slice();let D=O.pop();for(;T&&O.length;)T=O.every(M=>D.intersects(M,F)),D=O.pop();return T},m=(C,F)=>(o("comp",C,F),C=w(C,F),o("caret",C),C=x(C,F),o("tildes",C),C=E(C,F),o("xrange",C),C=$(C,F),o("stars",C),C),v=C=>!C||C.toLowerCase()==="x"||C==="*",x=(C,F)=>C.trim().split(/\s+/).map(T=>b(T,F)).join(" "),b=(C,F)=>{const T=F.loose?a[u.TILDELOOSE]:a[u.TILDE];return C.replace(T,(O,D,M,N,j)=>{o("tilde",C,O,D,M,N,j);let X;return v(D)?X="":v(M)?X=`>=${D}.0.0 <${+D+1}.0.0-0`:v(N)?X=`>=${D}.${M}.0 <${D}.${+M+1}.0-0`:j?(o("replaceTilde pr",j),X=`>=${D}.${M}.${N}-${j} <${D}.${+M+1}.0-0`):X=`>=${D}.${M}.${N} <${D}.${+M+1}.0-0`,o("tilde return",X),X})},w=(C,F)=>C.trim().split(/\s+/).map(T=>S(T,F)).join(" "),S=(C,F)=>{o("caret",C,F);const T=F.loose?a[u.CARETLOOSE]:a[u.CARET],O=F.includePrerelease?"-0":"";return C.replace(T,(D,M,N,j,X)=>{o("caret",C,D,M,N,j,X);let te;return v(M)?te="":v(N)?te=`>=${M}.0.0${O} <${+M+1}.0.0-0`:v(j)?M==="0"?te=`>=${M}.${N}.0${O} <${M}.${+N+1}.0-0`:te=`>=${M}.${N}.0${O} <${+M+1}.0.0-0`:X?(o("replaceCaret pr",X),M==="0"?N==="0"?te=`>=${M}.${N}.${j}-${X} <${M}.${N}.${+j+1}-0`:te=`>=${M}.${N}.${j}-${X} <${M}.${+N+1}.0-0`:te=`>=${M}.${N}.${j}-${X} <${+M+1}.0.0-0`):(o("no pr"),M==="0"?N==="0"?te=`>=${M}.${N}.${j}${O} <${M}.${N}.${+j+1}-0`:te=`>=${M}.${N}.${j}${O} <${M}.${+N+1}.0-0`:te=`>=${M}.${N}.${j} <${+M+1}.0.0-0`),o("caret return",te),te})},E=(C,F)=>(o("replaceXRanges",C,F),C.split(/\s+/).map(T=>_(T,F)).join(" ")),_=(C,F)=>{C=C.trim();const T=F.loose?a[u.XRANGELOOSE]:a[u.XRANGE];return C.replace(T,(O,D,M,N,j,X)=>{o("xRange",C,O,D,M,N,j,X);const te=v(M),xe=te||v(N),de=xe||v(j),De=de;return D==="="&&De&&(D=""),X=F.includePrerelease?"-0":"",te?D===">"||D==="<"?O="<0.0.0-0":O="*":D&&De?(xe&&(N=0),j=0,D===">"?(D=">=",xe?(M=+M+1,N=0,j=0):(N=+N+1,j=0)):D==="<="&&(D="<",xe?M=+M+1:N=+N+1),D==="<"&&(X="-0"),O=`${D+M}.${N}.${j}${X}`):xe?O=`>=${M}.0.0${X} <${+M+1}.0.0-0`:de&&(O=`>=${M}.${N}.0${X} <${M}.${+N+1}.0-0`),o("xRange return",O),O})},$=(C,F)=>(o("replaceStars",C,F),C.trim().replace(a[u.STAR],"")),k=(C,F)=>(o("replaceGTE0",C,F),C.trim().replace(a[F.includePrerelease?u.GTE0PRE:u.GTE0],"")),A=C=>(F,T,O,D,M,N,j,X,te,xe,de,De,It)=>(v(O)?T="":v(D)?T=`>=${O}.0.0${C?"-0":""}`:v(M)?T=`>=${O}.${D}.0${C?"-0":""}`:N?T=`>=${T}`:T=`>=${T}${C?"-0":""}`,v(te)?X="":v(xe)?X=`<${+te+1}.0.0-0`:v(de)?X=`<${te}.${+xe+1}.0-0`:De?X=`<=${te}.${xe}.${de}-${De}`:C?X=`<${te}.${xe}.${+de+1}-0`:X=`<=${X}`,`${T} ${X}`.trim()),R=(C,F,T)=>{for(let O=0;O<C.length;O++)if(!C[O].test(F))return!1;if(F.prerelease.length&&!T.includePrerelease){for(let O=0;O<C.length;O++)if(o(C[O].semver),C[O].semver!==i.ANY&&C[O].semver.prerelease.length>0){const D=C[O].semver;if(D.major===F.major&&D.minor===F.minor&&D.patch===F.patch)return!0}return!1}return!0};return Nb}const OSe=XW(),NSe=(e,t,n)=>{try{t=new OSe(t,n)}catch{return!1}return t.test(e)};var DSe=NSe,QW=REe(DSe);function RSe(e,t,n){const r=e.open(t),i=1e4,o=250,{origin:s}=new URL(t);let a=~~(i/o);function u(c){c.source===r&&(a=0,e.removeEventListener("message",u,!1))}e.addEventListener("message",u,!1);function l(){a<=0||(r.postMessage(n,s),setTimeout(l,o),a-=1)}setTimeout(l,o)}var PSe=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function KW(e,...t){for(const n of t)LSe(e,n);return e}function LSe(e,t){for(const n of Object.keys(t))Cf(e,n,t[n],!0)}function JR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function ha(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JR(Object(n),!0).forEach(function(r){DEe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JR(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}const si=mge;let $p=Swe;const Cm=typeof window<"u"?window:void 0;var s5;$p===void 0&&((s5=Cm==null?void 0:Cm.vl)!=null&&s5.compile)&&($p=Cm.vl);const zSe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},ISe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},rh={vega:"Vega","vega-lite":"Vega-Lite"},my={vega:si.version,"vega-lite":$p?$p.version:"not available"},jSe={vega:e=>e,"vega-lite":(e,t)=>$p.compile(e,{config:t}).spec},BSe=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,USe="chart-wrapper";function WSe(e){return typeof e=="function"}function ZR(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,s=window.open("");s.document.write(i+e+o),s.document.title=`${rh[r]} JSON Source`}function qSe(e,t){if(e.$schema){const n=WW(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${rh[n.library]}, but mode argument sets ${rh[t]??t}.`);const r=n.library;return QW(my[r],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${rh[r]} ${n.version}, but the current version of ${rh[r]} is v${my[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function HSe(e){return!!(e&&"load"in e)}function e5(e){return HSe(e)?e:si.loader(e)}function VSe(e){var n;const t=((n=e.usermeta)==null?void 0:n.embedOptions)??{};return Q(t.defaultStyle)&&(t.defaultStyle=!1),t}async function GSe(e,t,n={}){let r,i;Q(t)?(i=e5(n.loader),r=JSON.parse(await i.load(t))):r=t;const o=VSe(r),s=o.loader;(!i||s)&&(i=e5(n.loader??s));const a=await t5(o,i),u=await t5(n,i),l=ha(ha({},KW(u,a)),{},{config:$f(u.config??{},a.config??{})});return await XSe(e,r,l,i)}async function t5(e,t){const n=Q(e.config)?JSON.parse(await t.load(e.config)):e.config??{},r=Q(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return ha(ha(ha({},e),r?{patch:r}:{}),n?{config:n}:{})}function YSe(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}async function XSe(e,t,n={},r){const i=n.theme?$f(yEe[n.theme],n.config??{}):n.config,o=Ra(n.actions)?n.actions:KW({},zSe,n.actions??{}),s=ha(ha({},ISe),n.i18n),a=n.renderer??"canvas",u=n.logLevel??si.Warn,l=n.downloadFileName??"visualization",c=typeof e=="string"?document.querySelector(e):e;if(!c)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const w="vega-embed-style",{root:S,rootContainer:E}=YSe(c);if(!S.getElementById(w)){const _=document.createElement("style");_.id=w,_.innerHTML=n.defaultStyle===void 0||n.defaultStyle===!0?PSe.toString():n.defaultStyle,E.appendChild(_)}}const f=qSe(t,n.mode);let d=jSe[f](t,i);if(f==="vega-lite"&&d.$schema){const w=WW(d.$schema);QW(my.vega,`^${w.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${w.version}, but current version is v${my.vega}.`)}c.classList.add("vega-embed"),o&&c.classList.add("has-actions"),c.innerHTML="";let h=c;if(o){const w=document.createElement("div");w.classList.add(USe),c.appendChild(w),h=w}const p=n.patch;if(p&&(d=p instanceof Function?p(d):Ry(d,p,!0,!1).newDocument),n.formatLocale&&si.formatLocale(n.formatLocale),n.timeFormatLocale&&si.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(const w in n.expressionFunctions){const S=n.expressionFunctions[w];"fn"in S?si.expressionFunction(w,S.fn,S.visitor):S instanceof Function&&si.expressionFunction(w,S)}const{ast:g}=n,y=si.parse(d,f==="vega-lite"?{}:i,{ast:g}),m=new(n.viewClass||si.View)(y,ha({loader:r,logLevel:u,renderer:a},g?{expr:si.expressionInterpreter??n.expr??$ge}:{}));if(m.addSignalListener("autosize",(w,S)=>{const{type:E}=S;E=="fit-x"?(h.classList.add("fit-x"),h.classList.remove("fit-y")):E=="fit-y"?(h.classList.remove("fit-x"),h.classList.add("fit-y")):E=="fit"?h.classList.add("fit-x","fit-y"):h.classList.remove("fit-x","fit-y")}),n.tooltip!==!1){const w=WSe(n.tooltip)?n.tooltip:new MEe(n.tooltip===!0?{}:n.tooltip).call;m.tooltip(w)}let{hover:v}=n;if(v===void 0&&(v=f==="vega"),v){const{hoverSet:w,updateSet:S}=typeof v=="boolean"?{}:v;m.hover(w,S)}n&&(n.width!=null&&m.width(n.width),n.height!=null&&m.height(n.height),n.padding!=null&&m.padding(n.padding)),await m.initialize(h,n.bind).runAsync();let x;if(o!==!1){let w=c;if(n.defaultStyle!==!1){const E=document.createElement("details");E.title=s.CLICK_TO_VIEW_ACTIONS,c.append(E),w=E;const _=document.createElement("summary");_.innerHTML=BSe,E.append(_),x=$=>{E.contains($.target)||E.removeAttribute("open")},document.addEventListener("click",x)}const S=document.createElement("div");if(w.append(S),S.classList.add("vega-actions"),o===!0||o.export!==!1){for(const E of["svg","png"])if(o===!0||o.export===!0||o.export[E]){const _=s[`${E.toUpperCase()}_ACTION`],$=document.createElement("a"),k=J(n.scaleFactor)?n.scaleFactor[E]:n.scaleFactor;$.text=_,$.href="#",$.target="_blank",$.download=`${l}.${E}`,$.addEventListener("mousedown",async function(A){A.preventDefault();const R=await m.toImageURL(E,k);this.href=R}),S.append($)}}if(o===!0||o.source!==!1){const E=document.createElement("a");E.text=s.SOURCE_ACTION,E.href="#",E.addEventListener("click",function(_){ZR(l2(t),n.sourceHeader??"",n.sourceFooter??"",f),_.preventDefault()}),S.append(E)}if(f==="vega-lite"&&(o===!0||o.compiled!==!1)){const E=document.createElement("a");E.text=s.COMPILED_ACTION,E.href="#",E.addEventListener("click",function(_){ZR(l2(d),n.sourceHeader??"",n.sourceFooter??"","vega"),_.preventDefault()}),S.append(E)}if(o===!0||o.editor!==!1){const E=n.editorUrl??"https://vega.github.io/editor/",_=document.createElement("a");_.text=s.EDITOR_ACTION,_.href="#",_.addEventListener("click",function($){RSe(window,E,{config:i,mode:f,renderer:a,spec:l2(t)}),$.preventDefault()}),S.append(_)}}function b(){x&&document.removeEventListener("click",x),m.finalize()}return{view:m,spec:t,vgSpec:d,finalize:b,embedOptions:n}}function QSe(e){return!!e&&{}.toString.call(e)==="[object Function]"}function KSe(e,t,n){n&&(QSe(n)?n(e.data(t)):e.change(t,si.changeset().remove(()=>!0).insert(n)))}function JSe(e,t){Object.keys(t).forEach(n=>{KSe(e,n,t[n])})}function JW(e){const t=new Set;return e.forEach(n=>{Object.keys(n).forEach(r=>{t.add(r)})}),t}const ZW=()=>{};function Db(e,t){const n=Object.keys(t);return n.forEach(r=>{try{e.addSignalListener(r,t[r])}catch(i){console.warn("Cannot add invalid signal listener.",i)}}),n.length>0}function ZSe(e,t){if(e===t)return!1;const n={width:!1,height:!1,isExpensive:!1},r=JW([e,t]);return r.has("width")&&(!("width"in e)||!("width"in t)||e.width!==t.width)&&("width"in e&&typeof e.width=="number"?n.width=e.width:n.isExpensive=!0),r.has("height")&&(!("height"in e)||!("height"in t)||e.height!==t.height)&&("height"in e&&typeof e.height=="number"?n.height=e.height:n.isExpensive=!0),r.delete("width"),r.delete("height"),[...r].some(i=>!(i in e)||!(i in t)||!Tj(e[i],t[i]))&&(n.isExpensive=!0),n.width!==!1||n.height!==!1||n.isExpensive?n:!1}function n5(e,t){const n=Object.keys(t);return n.forEach(r=>{try{e.removeSignalListener(r,t[r])}catch(i){console.warn("Cannot remove invalid signal listener.",i)}}),n.length>0}function Rb(e){const{spec:t,width:n,height:r}=e;return typeof n<"u"&&typeof r<"u"?{...t,width:n,height:r}:typeof n<"u"?{...t,width:n}:typeof r<"u"?{...t,height:r}:t}function ih(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class eq extends Js.PureComponent{constructor(){super(...arguments),ih(this,"containerRef",Js.createRef()),ih(this,"resultPromise",void 0),ih(this,"handleError",t=>{const{onError:n=ZW}=this.props;n(t,this.containerRef.current),console.warn(t)}),ih(this,"modifyView",t=>{this.resultPromise&&this.resultPromise.then(n=>(n&&t(n.view),!0)).catch(this.handleError)})}componentDidMount(){this.createView()}componentDidUpdate(t){const n=JW([this.props,t]);if(n.delete("className"),n.delete("signalListeners"),n.delete("spec"),n.delete("style"),n.delete("width"),n.delete("height"),Array.from(n).some(r=>this.props[r]!==t[r]))this.clearView(),this.createView();else{const r=ZSe(Rb(this.props),Rb(t)),{signalListeners:i}=this.props,{signalListeners:o}=t;if(r)if(r.isExpensive)this.clearView(),this.createView();else{const s=!Tw(i,o);this.modifyView(a=>{r.width!==!1&&a.width(r.width),r.height!==!1&&a.height(r.height),s&&(o&&n5(a,o),i&&Db(a,i)),a.run()})}else Tw(i,o)||this.modifyView(s=>{o&&n5(s,o),i&&Db(s,i),s.run()})}}componentWillUnmount(){this.clearView()}createView(){const{spec:t,onNewView:n,signalListeners:r={},width:i,height:o,...s}=this.props;if(this.containerRef.current){const a=Rb(this.props);this.resultPromise=GSe(this.containerRef.current,a,s).then(u=>{if(u){const{view:l}=u;Db(l,r)&&l.run()}return u}).catch(this.handleError),n&&this.modifyView(n)}}clearView(){return this.resultPromise&&this.resultPromise.then(t=>{t&&t.finalize()}).catch(this.handleError),this.resultPromise=void 0,this}render(){const{className:t,style:n}=this.props;return Js.createElement("div",{ref:this.containerRef,className:t,style:n})}}ih(eq,"propTypes",{className:AF.string,onError:AF.func});function US(){return US=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},US.apply(this,arguments)}function WS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const e_e={};class tq extends Js.PureComponent{constructor(){super(...arguments),WS(this,"vegaEmbed",Js.createRef()),WS(this,"handleNewView",t=>{this.update();const{onNewView:n=ZW}=this.props;n(t)})}componentDidMount(){this.update()}componentDidUpdate(t){Tw(this.props.data,t.data)||this.update()}update(){const{data:t}=this.props;this.vegaEmbed.current&&t&&Object.keys(t).length>0&&this.vegaEmbed.current.modifyView(n=>{JSe(n,t),n.resize().run()})}render(){const{data:t,...n}=this.props;return Js.createElement(eq,US({ref:this.vegaEmbed},n,{onNewView:this.handleNewView}))}}WS(tq,"defaultProps",{data:e_e});function qS(){return qS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qS.apply(this,arguments)}function t_e(e){return Js.createElement(tq,qS({},e,{mode:"vega-lite"}))}function n_e(e){const{build:t,repo:n}=e;return be.jsxs("table",{children:[be.jsx("thead",{children:be.jsxs("tr",{children:[be.jsx("th",{children:"Key"}),be.jsx("th",{children:"Value"})]})}),be.jsx("tbody",{children:Object.entries(t).map(([r,i])=>{if(r.startsWith("yearmonth"))return null;if(r.startsWith("github")){const o=`https://github.com/${n}/actions/runs/${i}`;return be.jsxs("tr",{children:[be.jsx("td",{children:"link"}),be.jsx("td",{children:be.jsx("a",{href:o,children:o})})]})}return be.jsxs("tr",{children:[be.jsx("td",{children:`${r}`}),be.jsx("td",{children:`${i}`})]},r)})})]})}function r_e(e){const[t,n]=pr.useState(),{builds:r,query:i}=e;return console.log({builds:r}),be.jsxs("div",{style:{display:"flex"},children:[be.jsx(t_e,{data:{values:r},patch:o=>(o.signals.push({name:"barClick",value:0,on:[{events:"*:mousedown",update:"datum"}]}),o),signalListeners:{barClick:(o,s)=>{n(s)}},spec:{$schema:"https://vega.github.io/schema/vega-lite/v5.json",width:1e3,height:400,mark:{type:"point",tooltip:{content:"data"}},data:{name:"values"},selection:{grid:{type:"interval",bind:"scales"}},encoding:{y:{field:"duration",type:"quantitative",axis:{title:"Duration (minutes)"}},x:{field:"updated_at",timeUnit:"yearmonthdatehoursminutes",type:"temporal",scale:{nice:"week"},axis:{title:"Date"}},color:{field:"state",type:"nominal",scale:{domain:["success","skipped","failure","canceled"],range:["#39aa56","#ff7f0e","#db4545","#9d9d9d"]}}}}}),t?be.jsx(n_e,{repo:i.repo,build:t}):null]})}var nq={},dT={},pl={},_g={};Object.defineProperty(_g,"__esModule",{value:!0});function hT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pT(e,t,n){return t&&r5(e.prototype,t),n&&r5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HS(e,t)}function bf(e){return bf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},bf(e)}function HS(e,t){return HS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},HS(e,t)}function o_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oh(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s_e(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oh(e)}function a_e(e){var t=o_e();return function(){var r=bf(e),i;if(t){var o=bf(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return s_e(this,i)}}function u_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bf(e),e!==null););return e}function c0(){return typeof Reflect<"u"&&Reflect.get?c0=Reflect.get.bind():c0=function(t,n,r){var i=u_e(t,n);if(i){var o=Object.getOwnPropertyDescriptor(i,n);return o.get?o.get.call(arguments.length<3?t:r):o.value}},c0.apply(this,arguments)}var i5=function(){function e(){hT(this,e),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return pT(e,[{key:"addEventListener",value:function(n,r,i){n in this.listeners||(this.listeners[n]=[]),this.listeners[n].push({callback:r,options:i})}},{key:"removeEventListener",value:function(n,r){if(n in this.listeners){for(var i=this.listeners[n],o=0,s=i.length;o<s;o++)if(i[o].callback===r){i.splice(o,1);return}}}},{key:"dispatchEvent",value:function(n){if(n.type in this.listeners){for(var r=this.listeners[n.type],i=r.slice(),o=0,s=i.length;o<s;o++){var a=i[o];try{a.callback.call(this,n)}catch(u){Promise.resolve().then(function(){throw u})}a.options&&a.options.once&&this.removeEventListener(n.type,a.callback)}return!n.defaultPrevented}}}]),e}(),gT=function(e){i_e(n,e);var t=a_e(n);function n(){var r;return hT(this,n),r=t.call(this),r.listeners||i5.call(oh(r)),Object.defineProperty(oh(r),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(oh(r),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(oh(r),"reason",{value:void 0,writable:!0,configurable:!0}),r}return pT(n,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(i){i.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,i)),c0(bf(n.prototype),"dispatchEvent",this).call(this,i)}}]),n}(i5),rq=function(){function e(){hT(this,e),Object.defineProperty(this,"signal",{value:new gT,writable:!0,configurable:!0})}return pT(e,[{key:"abort",value:function(n){var r;try{r=new Event("abort")}catch{typeof document<"u"?document.createEvent?(r=document.createEvent("Event"),r.initEvent("abort",!1,!1)):(r=document.createEventObject(),r.type="abort"):r={type:"abort",bubbles:!1,cancelable:!1}}var i=n;if(i===void 0)if(typeof document>"u")i=new Error("This operation was aborted"),i.name="AbortError";else try{i=new DOMException("signal is aborted without reason")}catch{i=new Error("This operation was aborted"),i.name="AbortError"}this.signal.reason=i,this.signal.dispatchEvent(r)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();typeof Symbol<"u"&&Symbol.toStringTag&&(rq.prototype[Symbol.toStringTag]="AbortController",gT.prototype[Symbol.toStringTag]="AbortSignal");function l_e(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):typeof e.Request=="function"&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}function c_e(e){typeof e=="function"&&(e={fetch:e});var t=e,n=t.fetch,r=t.Request,i=r===void 0?n.Request:r,o=t.AbortController,s=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,a=s===void 0?!1:s;if(!l_e({fetch:n,Request:i,AbortController:o,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:a}))return{fetch:n,Request:u};var u=i;(u&&!u.prototype.hasOwnProperty("signal")||a)&&(u=function(d,h){var p;h&&h.signal&&(p=h.signal,delete h.signal);var g=new i(d,h);return p&&Object.defineProperty(g,"signal",{writable:!1,enumerable:!1,configurable:!0,value:p}),g},u.prototype=i.prototype);var l=n,c=function(d,h){var p=u&&u.prototype.isPrototypeOf(d)?d.signal:h?h.signal:void 0;if(p){var g;try{g=new DOMException("Aborted","AbortError")}catch{g=new Error("Aborted"),g.name="AbortError"}if(p.aborted)return Promise.reject(g);var y=new Promise(function(m,v){p.addEventListener("abort",function(){return v(g)},{once:!0})});return h&&h.signal&&delete h.signal,Promise.race([y,l(d,h)])}return l(d,h)};return{fetch:c,Request:u}}_g.AbortController=rq;_g.AbortSignal=gT;_g.abortableFetch=c_e;Object.defineProperty(pl,"__esModule",{value:!0});pl.AbortSignal=pl.AbortController=void 0;const iq=_g;var yy=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof Oc<"u")return Oc;throw new Error("unable to locate global object")};let f_e=typeof yy().AbortController>"u"?iq.AbortController:yy().AbortController;pl.AbortController=f_e;let d_e=typeof yy().AbortController>"u"?iq.AbortSignal:yy().AbortSignal;pl.AbortSignal=d_e;var mT={};Object.defineProperty(mT,"__esModule",{value:!0});const h_e=pl;class p_e{}class g_e{constructor(){this.signals=new Set,this.abortController=new h_e.AbortController}addSignal(t=new p_e){if(this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(t),t.aborted?this.handleAborted(t):typeof t.addEventListener=="function"&&t.addEventListener("abort",()=>{this.handleAborted(t)})}handleAborted(t){this.signals.delete(t),this.signals.size===0&&this.abortController.abort()}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}}mT.default=g_e;var yT={};Object.defineProperty(yT,"__esModule",{value:!0});class m_e{constructor(){this.callbacks=new Set}addCallback(t=()=>{}){this.callbacks.add(t),t(this.currentMessage)}callback(t){this.currentMessage=t,this.callbacks.forEach(n=>{n(t)})}}yT.default=m_e;var oq=Oc&&Oc.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dT,"__esModule",{value:!0});const y_e=pl,v_e=oq(mT),x_e=oq(yT);class vy{constructor({fill:t,cache:n}){if(typeof t!="function")throw new TypeError("must pass a fill function");if(typeof n!="object")throw new TypeError("must pass a cache object");if(typeof n.get!="function"||typeof n.set!="function"||typeof n.delete!="function")throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=n,this.fillCallback=t}static isAbortException(t){return t.name==="AbortError"||t.code==="ERR_ABORTED"||t.message==="AbortError: aborted"||t.message==="Error: aborted"}evict(t,n){this.cache.get(t)===n&&this.cache.delete(t)}fill(t,n,r,i){const o=new v_e.default,s=new x_e.default;s.addCallback(i);const a={aborter:o,promise:this.fillCallback(n,o.signal,u=>{s.callback(u)}),settled:!1,statusReporter:s,get aborted(){return this.aborter.signal.aborted}};a.aborter.addSignal(r),a.aborter.signal.addEventListener("abort",()=>{a.settled||this.evict(t,a)}),a.promise.then(()=>{a.settled=!0},()=>{a.settled=!0,this.evict(t,a)}).catch(u=>{throw console.error(u),u}),this.cache.set(t,a)}static checkSinglePromise(t,n){function r(){if(n&&n.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return t.then(i=>(r(),i),i=>{throw r(),i})}has(t){return this.cache.has(t)}get(t,n,r,i){if(!r&&n instanceof y_e.AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");const o=this.cache.get(t);return o?o.aborted&&!o.settled?(this.evict(t,o),this.get(t,n,r,i)):o.settled?o.promise:(o.aborter.addSignal(r),o.statusReporter.addCallback(i),vy.checkSinglePromise(o.promise,r)):(this.fill(t,n,r,i),vy.checkSinglePromise(this.cache.get(t).promise,r))}delete(t){const n=this.cache.get(t);n&&(n.settled||n.aborter.abort(),this.cache.delete(t))}clear(){const t=this.cache.keys();let n=0;for(let r=t.next();!r.done;r=t.next())this.delete(r.value),n+=1;return n}}dT.default=vy;var b_e=Oc&&Oc.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nq,"__esModule",{value:!0});const w_e=b_e(dT);var E_e=nq.default=w_e.default;class S_e extends Map{constructor(t={}){if(super(),!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof t.maxAge=="number"&&t.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=t.maxSize,this.maxAge=t.maxAge||Number.POSITIVE_INFINITY,this.onEviction=t.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(t){if(typeof this.onEviction=="function")for(const[n,r]of t)this.onEviction(n,r.value)}_deleteIfExpired(t,n){return typeof n.expiry=="number"&&n.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(t,n.value),this.delete(t)):!1}_getOrDeleteIfExpired(t,n){if(this._deleteIfExpired(t,n)===!1)return n.value}_getItemValue(t,n){return n.expiry?this._getOrDeleteIfExpired(t,n):n.value}_peek(t,n){const r=n.get(t);return this._getItemValue(t,r)}_set(t,n){this.cache.set(t,n),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(t,n){this.oldCache.delete(t),this._set(t,n)}*_entriesAscending(){for(const t of this.oldCache){const[n,r]=t;this.cache.has(n)||this._deleteIfExpired(n,r)===!1&&(yield t)}for(const t of this.cache){const[n,r]=t;this._deleteIfExpired(n,r)===!1&&(yield t)}}get(t){if(this.cache.has(t)){const n=this.cache.get(t);return this._getItemValue(t,n)}if(this.oldCache.has(t)){const n=this.oldCache.get(t);if(this._deleteIfExpired(t,n)===!1)return this._moveToRecent(t,n),n.value}}set(t,n,{maxAge:r=this.maxAge}={}){const i=typeof r=="number"&&r!==Number.POSITIVE_INFINITY?Date.now()+r:void 0;this.cache.has(t)?this.cache.set(t,{value:n,expiry:i}):this._set(t,{value:n,expiry:i})}has(t){return this.cache.has(t)?!this._deleteIfExpired(t,this.cache.get(t)):this.oldCache.has(t)?!this._deleteIfExpired(t,this.oldCache.get(t)):!1}peek(t){if(this.cache.has(t))return this._peek(t,this.cache);if(this.oldCache.has(t))return this._peek(t,this.oldCache)}delete(t){const n=this.cache.delete(t);return n&&this._size--,this.oldCache.delete(t)||n}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(t){if(!(t&&t>0))throw new TypeError("`maxSize` must be a number greater than 0");const n=[...this._entriesAscending()],r=n.length-t;r<0?(this.cache=new Map(n),this.oldCache=new Map,this._size=n.length):(r>0&&this._emitEvictions(n.slice(0,r)),this.oldCache=new Map(n.slice(r)),this.cache=new Map,this._size=0),this.maxSize=t}*keys(){for(const[t]of this)yield t}*values(){for(const[,t]of this)yield t}*[Symbol.iterator](){for(const t of this.cache){const[n,r]=t;this._deleteIfExpired(n,r)===!1&&(yield[n,r.value])}for(const t of this.oldCache){const[n,r]=t;this.cache.has(n)||this._deleteIfExpired(n,r)===!1&&(yield[n,r.value])}}*entriesDescending(){let t=[...this.cache];for(let n=t.length-1;n>=0;--n){const r=t[n],[i,o]=r;this._deleteIfExpired(i,o)===!1&&(yield[i,o.value])}t=[...this.oldCache];for(let n=t.length-1;n>=0;--n){const r=t[n],[i,o]=r;this.cache.has(i)||this._deleteIfExpired(i,o)===!1&&(yield[i,o.value])}}*entriesAscending(){for(const[t,n]of this._entriesAscending())yield[t,n.value]}get size(){if(!this._size)return this.oldCache.size;let t=0;for(const n of this.oldCache.keys())this.cache.has(n)||t++;return Math.min(this._size+t,this.maxSize)}entries(){return this.entriesAscending()}forEach(t,n=this){for(const[r,i]of this.entriesAscending())t.call(n,i,r,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}function __e(e=[]){if(!e.length)return[];const t=e.concat();t.sort((a,u)=>a.duration-u.duration);const n=t[Math.floor(t.length/4)].duration,r=t[Math.min(Math.ceil(t.length*(3/4)),t.length-1)].duration,i=r-n,o=r+i*3,s=n-i*3;return t.filter(a=>a.duration<o&&a.duration>s&&!!a.updated_at)}function k_e(e){return e.name==="AbortError"||e.code==="ERR_ABORTED"||e.message==="AbortError: aborted"||e.message==="Error: aborted"}const o5=100;function $_e({counter:e,repo:t}){return`https://api.github.com/repos/${t}/actions/runs?page=${Math.floor(e/o5)}&per_page=${o5}`}const C_e=new E_e({cache:new S_e({maxSize:1e3}),async fill(e,t){const{url:n,token:r}=e,i=await fetch(n,{headers:{Accept:"application/vnd.github.v3+json",Authorization:r?`token ${r}`:void 0},signal:t});if(!i.ok)throw new Error(`HTTP ${i.status} ${i.statusText}`);const o=await i.json();return{total:o.total_count,result:__e(o.workflow_runs.map(s=>({message:(s.head_commit||{}).message.slice(0,50),branch:s.head_branch,name:s.name,github_link:s.id,duration:(new Date(s.updated_at)-new Date(s.created_at))/6e4,state:s.conclusion,updated_at:new Date(s.updated_at),updated_at2:s.updated_at})))}}});function A_e(e){const[t,n]=pr.useState(0),[r,i]=pr.useState(),[o,s]=pr.useState(),[a,u]=pr.useState(e.repo?"Loading...":""),[l,c]=pr.useState([]);return pr.useEffect(()=>{(async()=>{try{if(e!=null&&e.repo){const f=$_e({...e,counter:l.length});if(!(f&&o)||o>=l.length){const d=e.token,{total:h,result:p}=await C_e.get(f+d,{url:f,token:d});p.length?(c([...l,...p]),s(h),u(`Loading builds...${l.length}/${h}`)):(u(""),n(0))}else l.length?(u(""),n(0)):i("No builds loaded")}}catch(f){k_e(f)||(console.error(f),i(f))}})()},[a,e,t,l,o]),[a,r,l]}function T_e(){const[e,t]=pr.useState({repo:"",token:""}),[n,r,i]=A_e(e);return console.log({loading:n,error:r,builds:i}),be.jsxs(be.Fragment,{children:[be.jsx("h1",{children:"githubgraph-js - GitHub actions graphs"}),be.jsx(OV,{onSubmit:o=>t(o)}),r?be.jsx("p",{style:{color:"red"},children:`${r}`}):n?be.jsx("p",{children:n}):be.jsx("div",{style:{marginTop:50},children:be.jsx(r_e,{builds:i,query:e})}),i?be.jsx("textarea",{style:{marginTop:20},rows:10,cols:120,value:[["branch","duration","github_link","message","name","state","updated_at"].join("	"),...i.map(o=>`${o.branch}	${o.duration}	${o.github_link}	${o.message.replaceAll(`
`," ").replaceAll("	"," ")}	${o.name}	${o.state}	${o.updated_at2}`).filter(o=>!!o.trim())].join(`
`)}):null,be.jsx("div",{style:{marginTop:50},children:be.jsx("a",{href:"https://github.com/cmdcolin/githubgraphjs/",children:"source code"})})]})}Pb.createRoot(document.getElementById("root")).render(be.jsx(Js.StrictMode,{children:be.jsx(T_e,{})}))});export default F_e();
