(this.webpackJsonpgithubgraphjs=this.webpackJsonpgithubgraphjs||[]).push([[0],{124:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),c=a(62),o=a.n(c),i=(a(77),a(0)),l=a(14),s=a(4),u=a(3),m=a.n(u),b=a(7),d=a(25),p=a(130),h=a(63),g=a.n(h),f=a(64),E=a.n(f),j=a(52);var v=function(e){var t=e.onSubmit,a=e.initialValues,n=Object(j.b)({onSubmit:t,initialValues:a}),c=n.form,o=n.handleSubmit,i=n.pristine,l=n.submitting,s=Object(j.a)("repo",c);return r.a.createElement("form",{onSubmit:o},r.a.createElement("div",null,r.a.createElement("label",null,"Repo name"),r.a.createElement("input",s.input)),r.a.createElement("button",{type:"submit",disabled:i||l},"Submit"))};var O=new g.a({cache:new E.a({maxSize:1e3}),fill:function(e,t){return Object(b.a)(m.a.mark((function a(){var n,r,c,o;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.url,r=e.headers,a.next=3,fetch(n,{headers:r,signal:t});case 3:if((c=a.sent).ok){a.next=6;break}throw new Error("HTTP ".concat(c.status," ").concat(c.statusText));case 6:return a.next=8,c.json();case 8:return o=a.sent,a.abrupt("return",{total:o.total_count,result:o.workflow_runs.map((function(e){return{message:(e.head_commit||{}).message.slice(0,20),branch:e.head_branch,github_link:e.id,duration:(new Date(e.updated_at)-new Date(e.created_at))/6e4,state:e.state}}))});case 10:case"end":return a.stop()}}),a)})))()}});function w(e){var t=e.counter,a=e.repo;return"https://api.github.com/repos/".concat(a,"/actions/runs?page=").concat(t/100,"&per_page=").concat(100)}function k(){return r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Key"),r.a.createElement("th",null,"Value"))),r.a.createElement("tbody",null))}function x(){var e=Object(d.c)({repo:d.b}),t=Object(s.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(0),u=Object(s.a)(o,2)[1],h=function(e){var t=Object(n.useState)(0),a=Object(s.a)(t,2),r=a[0],c=a[1],o=Object(n.useState)(),u=Object(s.a)(o,2),d=u[0],p=u[1],h=Object(n.useState)(),g=Object(s.a)(h,2),f=g[0],E=g[1],j=Object(n.useState)(e.repo?"Loading...":""),v=Object(s.a)(j,2),k=v[0],x=v[1],y=Object(n.useState)([]),S=Object(s.a)(y,2),_=S[0],D=S[1];return Object(n.useEffect)((function(){Object(b.a)(m.a.mark((function t(){var a,n,r,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e||!e.repo){t.next=15;break}if((a=w(Object(l.a)({},e,{counter:_.length})))&&f&&!(f>=_.length)){t.next=14;break}return t.next=6,O.get(a,{url:a});case 6:n=t.sent,r=n.total,o=n.result,D([].concat(Object(i.a)(_),Object(i.a)(o))),E(r),x("Loading builds...".concat(_.length,"/").concat(r)),t.next=15;break;case 14:_.length?(x(void 0),c(0)):p("No builds loaded");case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),"AbortError"!==(s=t.t0).name&&"ERR_ABORTED"!==s.code&&"AbortError: aborted"!==s.message&&"Error: aborted"!==s.message&&(console.error(t.t0),p(t.t0.message));case 20:case"end":return t.stop()}var s}),t,null,[[0,17]])})))()}),[k,e,r,_,f]),[k,d,_]}(a),g=Object(s.a)(h,3),f=g[0],E=g[1],j=g[2],x=Object(n.useState)(void 0),y=Object(s.a)(x,2),S=y[0],_=y[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"githubgraph-js - GitHub actions graphs"),r.a.createElement("p",null,"Enter a repo name"),r.a.createElement(v,{initialValues:a,onSubmit:function(e){c(e),u((function(e){return e+1}))}}),E?r.a.createElement("p",{style:{color:"red"}},E):f?r.a.createElement("p",null,f):r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(p.a,{data:{values:j},patch:function(e){return e.signals.push({name:"barClick",value:0,on:[{events:"*:mousedown",update:"datum"}]}),e},signalListeners:{barClick:function(e,t){_(t)}},spec:{$schema:"https://vega.github.io/schema/vega-lite/v4.json",width:1e3,height:400,mark:{type:"point",tooltip:{content:"data"}},data:{name:"values"},selection:{grid:{type:"interval",bind:"scales"}},encoding:{y:{field:"duration",type:"quantitative",axis:{title:"Duration (minutes)"}},x:{field:"finished_at",timeUnit:"yearmonthdatehoursminutes",type:"temporal",scale:{nice:"week"},axis:{title:"Date"}},color:{field:"state",type:"nominal",scale:{domain:["passed","failed","errored","canceled"],range:["#39aa56","#ff7f0e","#db4545","#9d9d9d"]}}}}}),S?r.a.createElement(k,{repo:a.repo,com:a.com?"com":"org",build:S}):null),r.a.createElement("a",{href:"https://github.com/cmdcolin/githubgraphjs/"},"source code"))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(d.a,null,r.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},72:function(e,t,a){e.exports=a(124)},77:function(e,t,a){}},[[72,1,2]]]);
//# sourceMappingURL=main.0231b363.chunk.js.map